{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/plugins/data/public/field_formats_provider/field_formats.js","dependencies":[{"path":"src/plugins/data/public/field_formats_provider/field_formats.js","mtime":1585205041539},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiKSB7IF90eXBlb2YyID0gZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mMiA9IGZ1bmN0aW9uIF90eXBlb2YyKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mMihvYmopOyB9CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuRmllbGRGb3JtYXRSZWdpc3R5ID0gdm9pZCAwOwoKdmFyIF9sb2Rhc2ggPSByZXF1aXJlKCJsb2Rhc2giKTsKCnZhciBfY29tbW9uID0gcmVxdWlyZSgiLi4vLi4vY29tbW9uIik7CgpmdW5jdGlvbiBfdHlwZW9mKG9iaikgewogIGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIF90eXBlb2YyKFN5bWJvbC5pdGVyYXRvcikgPT09ICJzeW1ib2wiKSB7CiAgICBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsKICAgICAgcmV0dXJuIF90eXBlb2YyKG9iaik7CiAgICB9OwogIH0gZWxzZSB7CiAgICBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsKICAgICAgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogX3R5cGVvZjIob2JqKTsKICAgIH07CiAgfQoKICByZXR1cm4gX3R5cGVvZihvYmopOwp9CgpmdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7CiAgcmV0dXJuIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfbm9uSXRlcmFibGVTcHJlYWQoKTsKfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlU3ByZWFkKCkgewogIHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7Cn0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXkoaXRlcikgewogIGlmIChTeW1ib2wuaXRlcmF0b3IgaW4gT2JqZWN0KGl0ZXIpIHx8IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChpdGVyKSA9PT0gIltvYmplY3QgQXJndW1lbnRzXSIpIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpOwp9CgpmdW5jdGlvbiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgewogICAgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkoYXJyLmxlbmd0aCk7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHsKICAgICAgYXJyMltpXSA9IGFycltpXTsKICAgIH0KCiAgICByZXR1cm4gYXJyMjsKICB9Cn0KCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgewogIHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsKCiAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsKICAgIHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOwogICAgaWYgKGVudW1lcmFibGVPbmx5KSBzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgewogICAgICByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsKICAgIH0pOwogICAga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOwogIH0KCiAgcmV0dXJuIGtleXM7Cn0KCmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7CiAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsKICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OwoKICAgIGlmIChpICUgMikgewogICAgICBvd25LZXlzKHNvdXJjZSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7CiAgICAgIH0pOwogICAgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgewogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpOwogICAgfSBlbHNlIHsKICAgICAgb3duS2V5cyhzb3VyY2UpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOwogICAgICB9KTsKICAgIH0KICB9CgogIHJldHVybiB0YXJnZXQ7Cn0KCmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsKICBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpKSB7CiAgICByZXR1cm4gY2FsbDsKICB9CgogIHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOwp9CgpmdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsKICBpZiAoc2VsZiA9PT0gdm9pZCAwKSB7CiAgICB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOwogIH0KCiAgcmV0dXJuIHNlbGY7Cn0KCmZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7CiAgX2dldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LmdldFByb3RvdHlwZU9mIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsKICAgIHJldHVybiBvLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2Yobyk7CiAgfTsKICByZXR1cm4gX2dldFByb3RvdHlwZU9mKG8pOwp9CgpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsKICBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICJmdW5jdGlvbiIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24iKTsKICB9CgogIHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgewogICAgY29uc3RydWN0b3I6IHsKICAgICAgdmFsdWU6IHN1YkNsYXNzLAogICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlCiAgICB9CiAgfSk7CiAgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcyk7Cn0KCmZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7CiAgX3NldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IGZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7CiAgICBvLl9fcHJvdG9fXyA9IHA7CiAgICByZXR1cm4gbzsKICB9OwoKICByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApOwp9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7CiAgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOwogIH0KfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgewogIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsKICAgIHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07CiAgICBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7CiAgICBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7CiAgICBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsKICB9Cn0KCmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsKICBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsKICBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7CiAgcmV0dXJuIENvbnN0cnVjdG9yOwp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7CiAgaWYgKGtleSBpbiBvYmopIHsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgICB2YWx1ZTogdmFsdWUsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgd3JpdGFibGU6IHRydWUKICAgIH0pOwogIH0gZWxzZSB7CiAgICBvYmpba2V5XSA9IHZhbHVlOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKdmFyIEZpZWxkRm9ybWF0UmVnaXN0eSA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIEZpZWxkRm9ybWF0UmVnaXN0eSgpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEZpZWxkRm9ybWF0UmVnaXN0eSk7CgogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICJmaWVsZEZvcm1hdHMiLCB2b2lkIDApOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAidWlTZXR0aW5ncyIsIHZvaWQgMCk7CgogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICJkZWZhdWx0TWFwIiwgdm9pZCAwKTsKCiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgImJhc2VQYXRoIiwgdm9pZCAwKTsKCiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgImdldENvbmZpZyIsIGZ1bmN0aW9uIChrZXksIG92ZXJyaWRlKSB7CiAgICAgIHJldHVybiBfdGhpcy51aVNldHRpbmdzLmdldChrZXksIG92ZXJyaWRlKTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiZ2V0RGVmYXVsdENvbmZpZyIsIGZ1bmN0aW9uIChmaWVsZFR5cGUsIGVzVHlwZXMpIHsKICAgICAgdmFyIHR5cGUgPSBfdGhpcy5nZXREZWZhdWx0VHlwZU5hbWUoZmllbGRUeXBlLCBlc1R5cGVzKTsKCiAgICAgIHJldHVybiBfdGhpcy5kZWZhdWx0TWFwICYmIF90aGlzLmRlZmF1bHRNYXBbdHlwZV0gfHwgewogICAgICAgIGlkOiBfY29tbW9uLkZJRUxEX0ZPUk1BVF9JRFMuU1RSSU5HLAogICAgICAgIHBhcmFtczoge30KICAgICAgfTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiZ2V0VHlwZSIsIGZ1bmN0aW9uIChmb3JtYXRJZCkgewogICAgICB2YXIgZmllbGRGb3JtYXQgPSBfdGhpcy5maWVsZEZvcm1hdHMuZ2V0KGZvcm1hdElkKTsKCiAgICAgIGlmIChmaWVsZEZvcm1hdCkgewogICAgICAgIHZhciBkZWNvcmF0ZWRGaWVsZEZvcm1hdCA9IF90aGlzLmZpZWxkRm9ybWF0TWV0YVBhcmFtc0RlY29yYXRvcihmaWVsZEZvcm1hdCk7CgogICAgICAgIGlmIChkZWNvcmF0ZWRGaWVsZEZvcm1hdCkgewogICAgICAgICAgcmV0dXJuIGRlY29yYXRlZEZpZWxkRm9ybWF0OwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiZ2V0RGVmYXVsdFR5cGUiLCBmdW5jdGlvbiAoZmllbGRUeXBlLCBlc1R5cGVzKSB7CiAgICAgIHZhciBjb25maWcgPSBfdGhpcy5nZXREZWZhdWx0Q29uZmlnKGZpZWxkVHlwZSwgZXNUeXBlcyk7CgogICAgICByZXR1cm4gX3RoaXMuZ2V0VHlwZShjb25maWcuaWQpOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICJnZXRUeXBlTmFtZUJ5RXNUeXBlcyIsIGZ1bmN0aW9uIChlc1R5cGVzKSB7CiAgICAgIGlmICghQXJyYXkuaXNBcnJheShlc1R5cGVzKSkgewogICAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICAgIH0KCiAgICAgIHJldHVybiBlc1R5cGVzLmZpbmQoZnVuY3Rpb24gKHR5cGUpIHsKICAgICAgICByZXR1cm4gX3RoaXMuZGVmYXVsdE1hcFt0eXBlXSAmJiBfdGhpcy5kZWZhdWx0TWFwW3R5cGVdLmVzOwogICAgICB9KTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiZ2V0RGVmYXVsdFR5cGVOYW1lIiwgZnVuY3Rpb24gKGZpZWxkVHlwZSwgZXNUeXBlcykgewogICAgICB2YXIgZXNUeXBlID0gX3RoaXMuZ2V0VHlwZU5hbWVCeUVzVHlwZXMoZXNUeXBlcyk7CgogICAgICByZXR1cm4gZXNUeXBlIHx8IGZpZWxkVHlwZTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiZ2V0SW5zdGFuY2UiLCAoMCwgX2xvZGFzaC5tZW1vaXplKShmdW5jdGlvbiAoZm9ybWF0SWQpIHsKICAgICAgdmFyIHBhcmFtcyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307CgogICAgICB2YXIgRGVyaXZlZEZpZWxkRm9ybWF0ID0gX3RoaXMuZ2V0VHlwZShmb3JtYXRJZCk7CgogICAgICBpZiAoIURlcml2ZWRGaWVsZEZvcm1hdCkgewogICAgICAgIHRocm93IG5ldyBFcnJvcigiRmllbGQgRm9ybWF0ICciLmNvbmNhdChmb3JtYXRJZCwgIicgbm90IGZvdW5kISIpKTsKICAgICAgfQoKICAgICAgcmV0dXJuIG5ldyBEZXJpdmVkRmllbGRGb3JtYXQocGFyYW1zLCBfdGhpcy5nZXRDb25maWcpOwogICAgfSkpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiZ2V0RGVmYXVsdEluc3RhbmNlIiwgKDAsIF9sb2Rhc2gubWVtb2l6ZSkodGhpcy5nZXREZWZhdWx0SW5zdGFuY2VQbGFpbiwgdGhpcy5nZXREZWZhdWx0SW5zdGFuY2VDYWNoZVJlc29sdmVyKSk7CgogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICJyZWdpc3RlciIsIGZ1bmN0aW9uIChmaWVsZEZvcm1hdHMpIHsKICAgICAgZmllbGRGb3JtYXRzLmZvckVhY2goZnVuY3Rpb24gKGZpZWxkRm9ybWF0KSB7CiAgICAgICAgcmV0dXJuIF90aGlzLmZpZWxkRm9ybWF0cy5zZXQoZmllbGRGb3JtYXQuaWQsIGZpZWxkRm9ybWF0KTsKICAgICAgfSk7CiAgICAgIHJldHVybiBfdGhpczsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiZmllbGRGb3JtYXRNZXRhUGFyYW1zRGVjb3JhdG9yIiwgZnVuY3Rpb24gKGZpZWxkRm9ybWF0KSB7CiAgICAgIHZhciBnZXRNZXRhUGFyYW1zID0gZnVuY3Rpb24gZ2V0TWV0YVBhcmFtcyhjdXN0b21QYXJhbXMpIHsKICAgICAgICByZXR1cm4gX3RoaXMuYnVpbGRNZXRhUGFyYW1zKGN1c3RvbVBhcmFtcyk7CiAgICAgIH07CgogICAgICBpZiAoZmllbGRGb3JtYXQpIHsKICAgICAgICB2YXIgX2NsYXNzLCBfdGVtcDsKCiAgICAgICAgcmV0dXJuIF90ZW1wID0gX2NsYXNzID0KICAgICAgICAvKiNfX1BVUkVfXyovCiAgICAgICAgZnVuY3Rpb24gKF9maWVsZEZvcm1hdCkgewogICAgICAgICAgX2luaGVyaXRzKERlY29yYXRlZEZpZWxkRm9ybWF0LCBfZmllbGRGb3JtYXQpOwoKICAgICAgICAgIGZ1bmN0aW9uIERlY29yYXRlZEZpZWxkRm9ybWF0KCkgewogICAgICAgICAgICB2YXIgcGFyYW1zID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTsKICAgICAgICAgICAgdmFyIGdldENvbmZpZyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkOwoKICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIERlY29yYXRlZEZpZWxkRm9ybWF0KTsKCiAgICAgICAgICAgIHJldHVybiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfZ2V0UHJvdG90eXBlT2YoRGVjb3JhdGVkRmllbGRGb3JtYXQpLmNhbGwodGhpcywgZ2V0TWV0YVBhcmFtcyhwYXJhbXMpLCBnZXRDb25maWcpKTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gRGVjb3JhdGVkRmllbGRGb3JtYXQ7CiAgICAgICAgfShmaWVsZEZvcm1hdCksIF9kZWZpbmVQcm9wZXJ0eShfY2xhc3MsICJpZCIsIGZpZWxkRm9ybWF0LmlkKSwgX2RlZmluZVByb3BlcnR5KF9jbGFzcywgImZpZWxkVHlwZSIsIGZpZWxkRm9ybWF0LmZpZWxkVHlwZSksIF90ZW1wOwogICAgICB9CgogICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICJidWlsZE1ldGFQYXJhbXMiLCBmdW5jdGlvbiAoY3VzdG9tUGFyYW1zKSB7CiAgICAgIHJldHVybiBfb2JqZWN0U3ByZWFkKHsKICAgICAgICBwYXJzZWRVcmw6IHsKICAgICAgICAgIG9yaWdpbjogd2luZG93LmxvY2F0aW9uLm9yaWdpbiwKICAgICAgICAgIHBhdGhuYW1lOiB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUsCiAgICAgICAgICBiYXNlUGF0aDogX3RoaXMuYmFzZVBhdGgKICAgICAgICB9CiAgICAgIH0sIGN1c3RvbVBhcmFtcyk7CiAgICB9KTsKCiAgICB0aGlzLmZpZWxkRm9ybWF0cyA9IG5ldyBNYXAoKTsKICAgIHRoaXMuZGVmYXVsdE1hcCA9IHt9OwogIH0KCiAgX2NyZWF0ZUNsYXNzKEZpZWxkRm9ybWF0UmVnaXN0eSwgW3sKICAgIGtleTogImluaXQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGluaXQoX3JlZikgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHZhciB1aVNldHRpbmdzID0gX3JlZi51aVNldHRpbmdzLAogICAgICAgICAgaHR0cCA9IF9yZWYuaHR0cDsKICAgICAgdGhpcy51aVNldHRpbmdzID0gdWlTZXR0aW5nczsKICAgICAgdGhpcy5iYXNlUGF0aCA9IGh0dHAuYmFzZVBhdGguZ2V0KCk7CiAgICAgIHRoaXMucGFyc2VEZWZhdWx0VHlwZU1hcCh0aGlzLnVpU2V0dGluZ3MuZ2V0KCdmb3JtYXQ6ZGVmYXVsdFR5cGVNYXAnKSk7CiAgICAgIHRoaXMudWlTZXR0aW5ncy5nZXRVcGRhdGUkKCkuc3Vic2NyaWJlKGZ1bmN0aW9uIChfcmVmMikgewogICAgICAgIHZhciBrZXkgPSBfcmVmMi5rZXksCiAgICAgICAgICAgIG5ld1ZhbHVlID0gX3JlZjIubmV3VmFsdWU7CgogICAgICAgIGlmIChrZXkgPT09ICdmb3JtYXQ6ZGVmYXVsdFR5cGVNYXAnKSB7CiAgICAgICAgICBfdGhpczIucGFyc2VEZWZhdWx0VHlwZU1hcChuZXdWYWx1ZSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSBpZCBvZiB0aGUgZGVmYXVsdCB0eXBlIGZvciB0aGlzIGZpZWxkIHR5cGUKICAgICAqIHVzaW5nIHRoZSBmb3JtYXQ6ZGVmYXVsdFR5cGVNYXAgY29uZmlnIG1hcAogICAgICoKICAgICAqIEBwYXJhbSAge0tCTl9GSUVMRF9UWVBFU30gZmllbGRUeXBlIC0gdGhlIGZpZWxkIHR5cGUKICAgICAqIEBwYXJhbSAge0VTX0ZJRUxEX1RZUEVTW119IGVzVHlwZXMgLSBBcnJheSBvZiBFUyBkYXRhIHR5cGVzCiAgICAgKiBAcmV0dXJuIHtGaWVsZFR5cGV9CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0RGVmYXVsdEluc3RhbmNlUGxhaW4iLAoKICAgIC8qKgogICAgICogR2V0IHRoZSBkZWZhdWx0IGZpZWxkRm9ybWF0IGluc3RhbmNlIGZvciBhIGZpZWxkIGZvcm1hdC4KICAgICAqCiAgICAgKiBAcGFyYW0gIHtLQk5fRklFTERfVFlQRVN9IGZpZWxkVHlwZQogICAgICogQHBhcmFtICB7RVNfRklFTERfVFlQRVNbXX0gZXNUeXBlcwogICAgICogQHJldHVybiB7RmllbGRGb3JtYXR9CiAgICAgKi8KICAgIHZhbHVlOiBmdW5jdGlvbiBnZXREZWZhdWx0SW5zdGFuY2VQbGFpbihmaWVsZFR5cGUsIGVzVHlwZXMpIHsKICAgICAgdmFyIGNvbmYgPSB0aGlzLmdldERlZmF1bHRDb25maWcoZmllbGRUeXBlLCBlc1R5cGVzKTsKICAgICAgdmFyIERlcml2ZWRGaWVsZEZvcm1hdCA9IHRoaXMuZ2V0VHlwZShjb25mLmlkKTsKCiAgICAgIGlmICghRGVyaXZlZEZpZWxkRm9ybWF0KSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJGaWVsZCBGb3JtYXQgJyIuY29uY2F0KGNvbmYuaWQsICInIG5vdCBmb3VuZCEiKSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBuZXcgRGVyaXZlZEZpZWxkRm9ybWF0KGNvbmYucGFyYW1zLCB0aGlzLmdldENvbmZpZyk7CiAgICB9CiAgICAvKioKICAgICAqIFJldHVybnMgYSBjYWNoZSBrZXkgYnVpbHQgYnkgdGhlIGdpdmVuIHZhcmlhYmxlcyBmb3IgY2FjaGluZyBpbiBtZW1vaXplZAogICAgICogV2hlcmUgZXNUeXBlIGNvbnRhaW5zIGZpZWxkVHlwZSwgZmllbGRUeXBlIGlzIHJldHVybmVkCiAgICAgKiAtPiBraWJhbmEgdHlwZXMgaGF2ZSBhIGhpZ2hlciBwcmlvcml0eSBpbiB0aGF0IGNhc2UKICAgICAqIC0+IHdvdWxkIGxlYWQgdG8gZmFpbGluZyB0ZXN0cyB0aGF0IG1hdGNoIGUuZy4gZGF0ZSBmb3JtYXQgd2l0aC93aXRob3V0IGVzVHlwZXMKICAgICAqIGh0dHBzOi8vbG9kYXNoLmNvbS9kb2NzI21lbW9pemUKICAgICAqCiAgICAgKiBAcGFyYW0gIHtLQk5fRklFTERfVFlQRVN9IGZpZWxkVHlwZQogICAgICogQHBhcmFtICB7RVNfRklFTERfVFlQRVNbXX0gZXNUeXBlcwogICAgICogQHJldHVybiB7U3RyaW5nfQogICAgICovCgogIH0sIHsKICAgIGtleTogImdldERlZmF1bHRJbnN0YW5jZUNhY2hlUmVzb2x2ZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldERlZmF1bHRJbnN0YW5jZUNhY2hlUmVzb2x2ZXIoZmllbGRUeXBlLCBlc1R5cGVzKSB7CiAgICAgIC8vIEB0cy1pZ25vcmUKICAgICAgcmV0dXJuIEFycmF5LmlzQXJyYXkoZXNUeXBlcykgJiYgZXNUeXBlcy5pbmRleE9mKGZpZWxkVHlwZSkgPT09IC0xID8gW2ZpZWxkVHlwZV0uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShlc1R5cGVzKSkuam9pbignLScpIDogZmllbGRUeXBlOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgZmlsdGVyZWQgbGlzdCBvZiBmaWVsZCBmb3JtYXRzIGJ5IGZvcm1hdCB0eXBlCiAgICAgKgogICAgICogQHBhcmFtICB7S0JOX0ZJRUxEX1RZUEVTfSBmaWVsZFR5cGUKICAgICAqIEByZXR1cm4ge0ZpZWxkRm9ybWF0W119CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0QnlGaWVsZFR5cGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEJ5RmllbGRUeXBlKGZpZWxkVHlwZSkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHJldHVybiBfdG9Db25zdW1hYmxlQXJyYXkodGhpcy5maWVsZEZvcm1hdHMudmFsdWVzKCkpLmZpbHRlcihmdW5jdGlvbiAoZm9ybWF0KSB7CiAgICAgICAgcmV0dXJuIGZvcm1hdCAmJiBmb3JtYXQuZmllbGRUeXBlLmluZGV4T2YoZmllbGRUeXBlKSAhPT0gLTE7CiAgICAgIH0pLm1hcChmdW5jdGlvbiAoZm9ybWF0KSB7CiAgICAgICAgcmV0dXJuIF90aGlzMy5maWVsZEZvcm1hdE1ldGFQYXJhbXNEZWNvcmF0b3IoZm9ybWF0KTsKICAgICAgfSk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCB0aGUgZGVmYXVsdCBmaWVsZEZvcm1hdCBpbnN0YW5jZSBmb3IgYSBmaWVsZCBmb3JtYXQuCiAgICAgKiBJdCdzIGEgbWVtb2l6ZWQgZnVuY3Rpb24gdGhhdCBidWlsZHMgYW5kIHJlYWRzIGEgY2FjaGUKICAgICAqCiAgICAgKiBAcGFyYW0gIHtLQk5fRklFTERfVFlQRVN9IGZpZWxkVHlwZQogICAgICogQHBhcmFtICB7RVNfRklFTERfVFlQRVNbXX0gZXNUeXBlcwogICAgICogQHJldHVybiB7RmllbGRGb3JtYXR9CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAicGFyc2VEZWZhdWx0VHlwZU1hcCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcGFyc2VEZWZhdWx0VHlwZU1hcCh2YWx1ZSkgewogICAgICB0aGlzLmRlZmF1bHRNYXAgPSB2YWx1ZTsKICAgICAgKDAsIF9sb2Rhc2guZm9yT3duKSh0aGlzLCBmdW5jdGlvbiAoZm4pIHsKICAgICAgICBpZiAoKDAsIF9sb2Rhc2guaXNGdW5jdGlvbikoZm4pICYmIGZuLmNhY2hlKSB7CiAgICAgICAgICAvLyBjbGVhciBhbGwgbWVtb2l6ZSBjYWNoZXMKICAgICAgICAgIC8vIEB0cy1pZ25vcmUKICAgICAgICAgIGZuLmNhY2hlID0gbmV3IF9sb2Rhc2gubWVtb2l6ZS5DYWNoZSgpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gRmllbGRGb3JtYXRSZWdpc3R5Owp9KCk7CgpleHBvcnRzLkZpZWxkRm9ybWF0UmVnaXN0eSA9IEZpZWxkRm9ybWF0UmVnaXN0eTs="},null]}