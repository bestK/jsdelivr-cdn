{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/security/public/views/management/edit_user/components/edit_user_page.js","dependencies":[{"path":"x-pack/legacy/plugins/security/public/views/management/edit_user/components/edit_user_page.js","mtime":1585205047232},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiKSB7IF90eXBlb2YyID0gZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mMiA9IGZ1bmN0aW9uIF90eXBlb2YyKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mMihvYmopOyB9CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuRWRpdFVzZXJQYWdlID0gdm9pZCAwOwoKdmFyIF9sb2Rhc2ggPSByZXF1aXJlKCJsb2Rhc2giKTsKCnZhciBfcmVhY3QgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKCJyZWFjdCIpKTsKCnZhciBfZXVpID0gcmVxdWlyZSgiQGVsYXN0aWMvZXVpIik7Cgp2YXIgX25vdGlmeSA9IHJlcXVpcmUoInVpL25vdGlmeSIpOwoKdmFyIF9yZWFjdDIgPSByZXF1aXJlKCJAa2JuL2kxOG4vcmVhY3QiKTsKCnZhciBfdmFsaWRhdGVfdXNlciA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL2xpYi92YWxpZGF0ZV91c2VyIik7Cgp2YXIgX21hbmFnZW1lbnRfdXJscyA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL3ZpZXdzL21hbmFnZW1lbnQvbWFuYWdlbWVudF91cmxzIik7Cgp2YXIgX3VzZXJzID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vY29tcG9uZW50cy9tYW5hZ2VtZW50L3VzZXJzIik7Cgp2YXIgX2NoYW5nZV9wYXNzd29yZF9mb3JtID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vY29tcG9uZW50cy9tYW5hZ2VtZW50L2NoYW5nZV9wYXNzd29yZF9mb3JtIik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsKICBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7CiAgICByZXR1cm4gb2JqOwogIH0gZWxzZSB7CiAgICB2YXIgbmV3T2JqID0ge307CgogICAgaWYgKG9iaiAhPSBudWxsKSB7CiAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHsKICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgewogICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvciA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpIDoge307CgogICAgICAgICAgaWYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSB7CiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmosIGtleSwgZGVzYyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBuZXdPYmpba2V5XSA9IG9ialtrZXldOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIG5ld09iai5kZWZhdWx0ID0gb2JqOwogICAgcmV0dXJuIG5ld09iajsKICB9Cn0KCmZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7CiAgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgX3R5cGVvZjIoU3ltYm9sLml0ZXJhdG9yKSA9PT0gInN5bWJvbCIpIHsKICAgIF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgewogICAgICByZXR1cm4gX3R5cGVvZjIob2JqKTsKICAgIH07CiAgfSBlbHNlIHsKICAgIF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgewogICAgICByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiBfdHlwZW9mMihvYmopOwogICAgfTsKICB9CgogIHJldHVybiBfdHlwZW9mKG9iaik7Cn0KCmZ1bmN0aW9uIF9leHRlbmRzKCkgewogIF9leHRlbmRzID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiAodGFyZ2V0KSB7CiAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgewogICAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldOwoKICAgICAgZm9yICh2YXIga2V5IGluIHNvdXJjZSkgewogICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoc291cmNlLCBrZXkpKSB7CiAgICAgICAgICB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHJldHVybiB0YXJnZXQ7CiAgfTsKCiAgcmV0dXJuIF9leHRlbmRzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn0KCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgewogIHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsKCiAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsKICAgIHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOwogICAgaWYgKGVudW1lcmFibGVPbmx5KSBzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgewogICAgICByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsKICAgIH0pOwogICAga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOwogIH0KCiAgcmV0dXJuIGtleXM7Cn0KCmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7CiAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsKICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OwoKICAgIGlmIChpICUgMikgewogICAgICBvd25LZXlzKHNvdXJjZSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7CiAgICAgIH0pOwogICAgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgewogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpOwogICAgfSBlbHNlIHsKICAgICAgb3duS2V5cyhzb3VyY2UpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOwogICAgICB9KTsKICAgIH0KICB9CgogIHJldHVybiB0YXJnZXQ7Cn0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsKICBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7CiAgfQp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgewogICAgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsKICAgIGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsKICAgIGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsKICAgIGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOwogIH0KfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgewogIGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOwogIGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsKICByZXR1cm4gQ29uc3RydWN0b3I7Cn0KCmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsKICBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpKSB7CiAgICByZXR1cm4gY2FsbDsKICB9CgogIHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOwp9CgpmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgewogIF9nZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7CiAgICByZXR1cm4gby5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKG8pOwogIH07CiAgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsKfQoKZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7CiAgaWYgKHNlbGYgPT09IHZvaWQgMCkgewogICAgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsKICB9CgogIHJldHVybiBzZWxmOwp9CgpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsKICBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICJmdW5jdGlvbiIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24iKTsKICB9CgogIHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgewogICAgY29uc3RydWN0b3I6IHsKICAgICAgdmFsdWU6IHN1YkNsYXNzLAogICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlCiAgICB9CiAgfSk7CiAgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcyk7Cn0KCmZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7CiAgX3NldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IGZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7CiAgICBvLl9fcHJvdG9fXyA9IHA7CiAgICByZXR1cm4gbzsKICB9OwoKICByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApOwp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7CiAgaWYgKGtleSBpbiBvYmopIHsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgICB2YWx1ZTogdmFsdWUsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgd3JpdGFibGU6IHRydWUKICAgIH0pOwogIH0gZWxzZSB7CiAgICBvYmpba2V5XSA9IHZhbHVlOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKdmFyIEVkaXRVc2VyUGFnZVVJID0KLyojX19QVVJFX18qLwpmdW5jdGlvbiAoX0NvbXBvbmVudCkgewogIF9pbmhlcml0cyhFZGl0VXNlclBhZ2VVSSwgX0NvbXBvbmVudCk7CgogIGZ1bmN0aW9uIEVkaXRVc2VyUGFnZVVJKHByb3BzKSB7CiAgICB2YXIgX3RoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEVkaXRVc2VyUGFnZVVJKTsKCiAgICBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIF9nZXRQcm90b3R5cGVPZihFZGl0VXNlclBhZ2VVSSkuY2FsbCh0aGlzLCBwcm9wcykpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInZhbGlkYXRvciIsIHZvaWQgMCk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiaGFuZGxlRGVsZXRlIiwgZnVuY3Rpb24gKHVzZXJuYW1lcywgZXJyb3JzKSB7CiAgICAgIGlmIChlcnJvcnMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgdmFyIGNoYW5nZVVybCA9IF90aGlzLnByb3BzLmNoYW5nZVVybDsKICAgICAgICBjaGFuZ2VVcmwoX21hbmFnZW1lbnRfdXJscy5VU0VSU19QQVRIKTsKICAgICAgfQogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAic2F2ZVVzZXIiLCBmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICB2YXIgcmVzdWx0LCBfdGhpcyRwcm9wcywgY2hhbmdlVXJsLCBhcGlDbGllbnQsIF90aGlzJHN0YXRlLCB1c2VyLCBpc05ld1VzZXIsIHNlbGVjdGVkUm9sZXMsIHVzZXJUb1NhdmU7CgogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmFzeW5jKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIF90aGlzLnZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7CgogICAgICAgICAgICAgIHJlc3VsdCA9IF90aGlzLnZhbGlkYXRvci52YWxpZGF0ZUZvclNhdmUoX3RoaXMuc3RhdGUudXNlciwgX3RoaXMuc3RhdGUuaXNOZXdVc2VyKTsKCiAgICAgICAgICAgICAgaWYgKCFyZXN1bHQuaXNJbnZhbGlkKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNjsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgZm9ybUVycm9yOiByZXN1bHQKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDIzOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgIGZvcm1FcnJvcjogbnVsbAogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBfdGhpcyRwcm9wcyA9IF90aGlzLnByb3BzLCBjaGFuZ2VVcmwgPSBfdGhpcyRwcm9wcy5jaGFuZ2VVcmwsIGFwaUNsaWVudCA9IF90aGlzJHByb3BzLmFwaUNsaWVudDsKICAgICAgICAgICAgICBfdGhpcyRzdGF0ZSA9IF90aGlzLnN0YXRlLCB1c2VyID0gX3RoaXMkc3RhdGUudXNlciwgaXNOZXdVc2VyID0gX3RoaXMkc3RhdGUuaXNOZXdVc2VyLCBzZWxlY3RlZFJvbGVzID0gX3RoaXMkc3RhdGUuc2VsZWN0ZWRSb2xlczsKICAgICAgICAgICAgICB1c2VyVG9TYXZlID0gX29iamVjdFNwcmVhZCh7fSwgdXNlcik7CgogICAgICAgICAgICAgIGlmICghaXNOZXdVc2VyKSB7CiAgICAgICAgICAgICAgICBkZWxldGUgdXNlclRvU2F2ZS5wYXNzd29yZDsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGRlbGV0ZSB1c2VyVG9TYXZlLmNvbmZpcm1QYXNzd29yZDsKICAgICAgICAgICAgICB1c2VyVG9TYXZlLnJvbGVzID0gc2VsZWN0ZWRSb2xlcy5tYXAoZnVuY3Rpb24gKHNlbGVjdGVkUm9sZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIHNlbGVjdGVkUm9sZS5sYWJlbDsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMTM7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE2OwogICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAoYXBpQ2xpZW50LnNhdmVVc2VyKHVzZXJUb1NhdmUpKTsKCiAgICAgICAgICAgIGNhc2UgMTY6CiAgICAgICAgICAgICAgX25vdGlmeS50b2FzdE5vdGlmaWNhdGlvbnMuYWRkU3VjY2VzcyhfdGhpcy5wcm9wcy5pbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgICAgICAgaWQ6ICd4cGFjay5zZWN1cml0eS5tYW5hZ2VtZW50LnVzZXJzLmVkaXRVc2VyLnVzZXJTdWNjZXNzZnVsbHlTYXZlZE5vdGlmaWNhdGlvbk1lc3NhZ2UnLAogICAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdTYXZlZCB1c2VyIHttZXNzYWdlfScKICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICBtZXNzYWdlOiB1c2VyLnVzZXJuYW1lCiAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgICBjaGFuZ2VVcmwoX21hbmFnZW1lbnRfdXJscy5VU0VSU19QQVRIKTsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjM7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDIwOgogICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAyMDsKICAgICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDEzKTsKCiAgICAgICAgICAgICAgX25vdGlmeS50b2FzdE5vdGlmaWNhdGlvbnMuYWRkRGFuZ2VyKF90aGlzLnByb3BzLmludGwuZm9ybWF0TWVzc2FnZSh7CiAgICAgICAgICAgICAgICBpZDogJ3hwYWNrLnNlY3VyaXR5Lm1hbmFnZW1lbnQudXNlcnMuZWRpdFVzZXIuc2F2aW5nVXNlckVycm9yTWVzc2FnZScsCiAgICAgICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0Vycm9yIHNhdmluZyB1c2VyOiB7bWVzc2FnZX0nCiAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgbWVzc2FnZTogKDAsIF9sb2Rhc2guZ2V0KShfY29udGV4dC50MCwgJ2JvZHkubWVzc2FnZScsICdVbmtub3duIGVycm9yJykKICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICBjYXNlIDIzOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBudWxsLCBudWxsLCBbWzEzLCAyMF1dKTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInBhc3N3b3JkRmllbGRzIiwgZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRnJhZ21lbnQsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGb3JtUm93LCBfZXh0ZW5kcyh7CiAgICAgICAgbGFiZWw6IF90aGlzLnByb3BzLmludGwuZm9ybWF0TWVzc2FnZSh7CiAgICAgICAgICBpZDogJ3hwYWNrLnNlY3VyaXR5Lm1hbmFnZW1lbnQudXNlcnMuZWRpdFVzZXIucGFzc3dvcmRGb3JtUm93TGFiZWwnLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdQYXNzd29yZCcKICAgICAgICB9KQogICAgICB9LCBfdGhpcy52YWxpZGF0b3IudmFsaWRhdGVQYXNzd29yZChfdGhpcy5zdGF0ZS51c2VyKSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGaWVsZFRleHQsIHsKICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiAicGFzc3dvcmRJbnB1dCIsCiAgICAgICAgbmFtZTogInBhc3N3b3JkIiwKICAgICAgICB0eXBlOiAicGFzc3dvcmQiLAogICAgICAgIG9uQ2hhbmdlOiBfdGhpcy5vblBhc3N3b3JkQ2hhbmdlCiAgICAgIH0pKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZvcm1Sb3csIF9leHRlbmRzKHsKICAgICAgICBsYWJlbDogX3RoaXMucHJvcHMuaW50bC5mb3JtYXRNZXNzYWdlKHsKICAgICAgICAgIGlkOiAneHBhY2suc2VjdXJpdHkubWFuYWdlbWVudC51c2Vycy5lZGl0VXNlci5jb25maXJtUGFzc3dvcmRGb3JtUm93TGFiZWwnLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdDb25maXJtIHBhc3N3b3JkJwogICAgICAgIH0pCiAgICAgIH0sIF90aGlzLnZhbGlkYXRvci52YWxpZGF0ZUNvbmZpcm1QYXNzd29yZChfdGhpcy5zdGF0ZS51c2VyKSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGaWVsZFRleHQsIHsKICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiAicGFzc3dvcmRDb25maXJtYXRpb25JbnB1dCIsCiAgICAgICAgb25DaGFuZ2U6IF90aGlzLm9uQ29uZmlybVBhc3N3b3JkQ2hhbmdlLAogICAgICAgIG5hbWU6ICJjb25maXJtX3Bhc3N3b3JkIiwKICAgICAgICB0eXBlOiAicGFzc3dvcmQiCiAgICAgIH0pKSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJjaGFuZ2VQYXNzd29yZEZvcm0iLCBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfdGhpcyRzdGF0ZTIgPSBfdGhpcy5zdGF0ZSwKICAgICAgICAgIHNob3dDaGFuZ2VQYXNzd29yZEZvcm0gPSBfdGhpcyRzdGF0ZTIuc2hvd0NoYW5nZVBhc3N3b3JkRm9ybSwKICAgICAgICAgIHVzZXIgPSBfdGhpcyRzdGF0ZTIudXNlciwKICAgICAgICAgIGN1cnJlbnRVc2VyID0gX3RoaXMkc3RhdGUyLmN1cnJlbnRVc2VyOwogICAgICB2YXIgdXNlcklzTG9nZ2VkSW5Vc2VyID0gQm9vbGVhbihjdXJyZW50VXNlciAmJiB1c2VyLnVzZXJuYW1lICYmIHVzZXIudXNlcm5hbWUgPT09IGN1cnJlbnRVc2VyLnVzZXJuYW1lKTsKCiAgICAgIGlmICghc2hvd0NoYW5nZVBhc3N3b3JkRm9ybSkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRnJhZ21lbnQsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlIb3Jpem9udGFsUnVsZSwgbnVsbCksIHVzZXIudXNlcm5hbWUgPT09ICdraWJhbmEnID8gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRnJhZ21lbnQsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlDYWxsT3V0LCB7CiAgICAgICAgdGl0bGU6IF90aGlzLnByb3BzLmludGwuZm9ybWF0TWVzc2FnZSh7CiAgICAgICAgICBpZDogJ3hwYWNrLnNlY3VyaXR5Lm1hbmFnZW1lbnQudXNlcnMuZWRpdFVzZXIuY2hhbmdlUGFzc3dvcmRFeHRyYVN0ZXBUaXRsZScsCiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0V4dHJhIHN0ZXAgbmVlZGVkJwogICAgICAgIH0pLAogICAgICAgIGNvbG9yOiAid2FybmluZyIsCiAgICAgICAgaWNvblR5cGU6ICJoZWxwIgogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJwIiwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogInhwYWNrLnNlY3VyaXR5Lm1hbmFnZW1lbnQudXNlcnMuZWRpdFVzZXIuY2hhbmdlUGFzc3dvcmRVcGRhdGVLaWJhbmFUaXRsZSIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJBZnRlciB5b3UgY2hhbmdlIHRoZSBwYXNzd29yZCBmb3IgdGhlIGtpYmFuYSB1c2VyLCB5b3UgbXVzdCB1cGRhdGUgdGhlIHtraWJhbmF9IGZpbGUgYW5kIHJlc3RhcnQgS2liYW5hLiIsCiAgICAgICAgdmFsdWVzOiB7CiAgICAgICAgICBraWJhbmE6ICdraWJhbmEueW1sJwogICAgICAgIH0KICAgICAgfSkpKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgbnVsbCkpIDogbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfY2hhbmdlX3Bhc3N3b3JkX2Zvcm0uQ2hhbmdlUGFzc3dvcmRGb3JtLCB7CiAgICAgICAgdXNlcjogX3RoaXMuc3RhdGUudXNlciwKICAgICAgICBpc1VzZXJDaGFuZ2luZ093blBhc3N3b3JkOiB1c2VySXNMb2dnZWRJblVzZXIsCiAgICAgICAgb25DaGFuZ2VQYXNzd29yZDogX3RoaXMudG9nZ2xlQ2hhbmdlUGFzc3dvcmRGb3JtLAogICAgICAgIGFwaUNsaWVudDogX3RoaXMucHJvcHMuYXBpQ2xpZW50CiAgICAgIH0pKTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInRvZ2dsZUNoYW5nZVBhc3N3b3JkRm9ybSIsIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHNob3dDaGFuZ2VQYXNzd29yZEZvcm0gPSBfdGhpcy5zdGF0ZS5zaG93Q2hhbmdlUGFzc3dvcmRGb3JtOwoKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIHNob3dDaGFuZ2VQYXNzd29yZEZvcm06ICFzaG93Q2hhbmdlUGFzc3dvcmRGb3JtCiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAib25Vc2VybmFtZUNoYW5nZSIsIGZ1bmN0aW9uIChlKSB7CiAgICAgIHZhciB1c2VyID0gX29iamVjdFNwcmVhZCh7fSwgX3RoaXMuc3RhdGUudXNlciwgewogICAgICAgIHVzZXJuYW1lOiBlLnRhcmdldC52YWx1ZSB8fCAnJwogICAgICB9KTsKCiAgICAgIHZhciBmb3JtRXJyb3IgPSBfdGhpcy52YWxpZGF0b3IudmFsaWRhdGVGb3JTYXZlKHVzZXIsIF90aGlzLnN0YXRlLmlzTmV3VXNlcik7CgogICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgdXNlcjogdXNlciwKICAgICAgICBmb3JtRXJyb3I6IGZvcm1FcnJvcgogICAgICB9KTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIm9uRW1haWxDaGFuZ2UiLCBmdW5jdGlvbiAoZSkgewogICAgICB2YXIgdXNlciA9IF9vYmplY3RTcHJlYWQoe30sIF90aGlzLnN0YXRlLnVzZXIsIHsKICAgICAgICBlbWFpbDogZS50YXJnZXQudmFsdWUgfHwgJycKICAgICAgfSk7CgogICAgICB2YXIgZm9ybUVycm9yID0gX3RoaXMudmFsaWRhdG9yLnZhbGlkYXRlRm9yU2F2ZSh1c2VyLCBfdGhpcy5zdGF0ZS5pc05ld1VzZXIpOwoKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIHVzZXI6IHVzZXIsCiAgICAgICAgZm9ybUVycm9yOiBmb3JtRXJyb3IKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJvbkZ1bGxOYW1lQ2hhbmdlIiwgZnVuY3Rpb24gKGUpIHsKICAgICAgdmFyIHVzZXIgPSBfb2JqZWN0U3ByZWFkKHt9LCBfdGhpcy5zdGF0ZS51c2VyLCB7CiAgICAgICAgZnVsbF9uYW1lOiBlLnRhcmdldC52YWx1ZSB8fCAnJwogICAgICB9KTsKCiAgICAgIHZhciBmb3JtRXJyb3IgPSBfdGhpcy52YWxpZGF0b3IudmFsaWRhdGVGb3JTYXZlKHVzZXIsIF90aGlzLnN0YXRlLmlzTmV3VXNlcik7CgogICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgdXNlcjogdXNlciwKICAgICAgICBmb3JtRXJyb3I6IGZvcm1FcnJvcgogICAgICB9KTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIm9uUGFzc3dvcmRDaGFuZ2UiLCBmdW5jdGlvbiAoZSkgewogICAgICB2YXIgdXNlciA9IF9vYmplY3RTcHJlYWQoe30sIF90aGlzLnN0YXRlLnVzZXIsIHsKICAgICAgICBwYXNzd29yZDogZS50YXJnZXQudmFsdWUgfHwgJycKICAgICAgfSk7CgogICAgICB2YXIgZm9ybUVycm9yID0gX3RoaXMudmFsaWRhdG9yLnZhbGlkYXRlRm9yU2F2ZSh1c2VyLCBfdGhpcy5zdGF0ZS5pc05ld1VzZXIpOwoKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIHVzZXI6IHVzZXIsCiAgICAgICAgZm9ybUVycm9yOiBmb3JtRXJyb3IKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJvbkNvbmZpcm1QYXNzd29yZENoYW5nZSIsIGZ1bmN0aW9uIChlKSB7CiAgICAgIHZhciB1c2VyID0gX29iamVjdFNwcmVhZCh7fSwgX3RoaXMuc3RhdGUudXNlciwgewogICAgICAgIGNvbmZpcm1QYXNzd29yZDogZS50YXJnZXQudmFsdWUgfHwgJycKICAgICAgfSk7CgogICAgICB2YXIgZm9ybUVycm9yID0gX3RoaXMudmFsaWRhdG9yLnZhbGlkYXRlRm9yU2F2ZSh1c2VyLCBfdGhpcy5zdGF0ZS5pc05ld1VzZXIpOwoKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIHVzZXI6IHVzZXIsCiAgICAgICAgZm9ybUVycm9yOiBmb3JtRXJyb3IKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJvblJvbGVzQ2hhbmdlIiwgZnVuY3Rpb24gKHNlbGVjdGVkUm9sZXMpIHsKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIHNlbGVjdGVkUm9sZXM6IHNlbGVjdGVkUm9sZXMKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJjYW5ub3RTYXZlVXNlciIsIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF90aGlzJHN0YXRlMyA9IF90aGlzLnN0YXRlLAogICAgICAgICAgdXNlciA9IF90aGlzJHN0YXRlMy51c2VyLAogICAgICAgICAgaXNOZXdVc2VyID0gX3RoaXMkc3RhdGUzLmlzTmV3VXNlcjsKCiAgICAgIHZhciByZXN1bHQgPSBfdGhpcy52YWxpZGF0b3IudmFsaWRhdGVGb3JTYXZlKHVzZXIsIGlzTmV3VXNlcik7CgogICAgICByZXR1cm4gcmVzdWx0LmlzSW52YWxpZDsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIm9uQ2FuY2VsRGVsZXRlIiwgZnVuY3Rpb24gKCkgewogICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgc2hvd0RlbGV0ZUNvbmZpcm1hdGlvbjogZmFsc2UKICAgICAgfSk7CiAgICB9KTsKCiAgICBfdGhpcy52YWxpZGF0b3IgPSBuZXcgX3ZhbGlkYXRlX3VzZXIuVXNlclZhbGlkYXRvcih7CiAgICAgIHNob3VsZFZhbGlkYXRlOiBmYWxzZQogICAgfSk7CiAgICBfdGhpcy5zdGF0ZSA9IHsKICAgICAgaXNMb2FkZWQ6IGZhbHNlLAogICAgICBpc05ld1VzZXI6IHRydWUsCiAgICAgIGN1cnJlbnRVc2VyOiBudWxsLAogICAgICBzaG93Q2hhbmdlUGFzc3dvcmRGb3JtOiBmYWxzZSwKICAgICAgc2hvd0RlbGV0ZUNvbmZpcm1hdGlvbjogZmFsc2UsCiAgICAgIHVzZXI6IHsKICAgICAgICBlbWFpbDogJycsCiAgICAgICAgdXNlcm5hbWU6ICcnLAogICAgICAgIGZ1bGxfbmFtZTogJycsCiAgICAgICAgcm9sZXM6IFtdLAogICAgICAgIGVuYWJsZWQ6IHRydWUsCiAgICAgICAgcGFzc3dvcmQ6ICcnLAogICAgICAgIGNvbmZpcm1QYXNzd29yZDogJycKICAgICAgfSwKICAgICAgcm9sZXM6IFtdLAogICAgICBzZWxlY3RlZFJvbGVzOiBbXSwKICAgICAgZm9ybUVycm9yOiBudWxsCiAgICB9OwogICAgcmV0dXJuIF90aGlzOwogIH0KCiAgX2NyZWF0ZUNsYXNzKEVkaXRVc2VyUGFnZVVJLCBbewogICAga2V5OiAiY29tcG9uZW50RGlkTW91bnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudERpZE1vdW50KCkgewogICAgICB2YXIgX3RoaXMkcHJvcHMyLCB1c2VybmFtZSwgYXBpQ2xpZW50LCBzZWN1cml0eVNldHVwLCBfdGhpcyRzdGF0ZTQsIHVzZXIsIGN1cnJlbnRVc2VyLCByb2xlczsKCiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXN5bmMoZnVuY3Rpb24gY29tcG9uZW50RGlkTW91bnQkKF9jb250ZXh0MikgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIF90aGlzJHByb3BzMiA9IHRoaXMucHJvcHMsIHVzZXJuYW1lID0gX3RoaXMkcHJvcHMyLnVzZXJuYW1lLCBhcGlDbGllbnQgPSBfdGhpcyRwcm9wczIuYXBpQ2xpZW50LCBzZWN1cml0eVNldHVwID0gX3RoaXMkcHJvcHMyLnNlY3VyaXR5U2V0dXA7CiAgICAgICAgICAgICAgX3RoaXMkc3RhdGU0ID0gdGhpcy5zdGF0ZSwgdXNlciA9IF90aGlzJHN0YXRlNC51c2VyLCBjdXJyZW50VXNlciA9IF90aGlzJHN0YXRlNC5jdXJyZW50VXNlcjsKCiAgICAgICAgICAgICAgaWYgKCF1c2VybmFtZSkgewogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAyMDsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgX2NvbnRleHQyLnByZXYgPSAzOwogICAgICAgICAgICAgIF9jb250ZXh0Mi50MCA9IF9vYmplY3RTcHJlYWQ7CiAgICAgICAgICAgICAgX2NvbnRleHQyLnQxID0ge307CiAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA4OwogICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAoYXBpQ2xpZW50LmdldFVzZXIodXNlcm5hbWUpKTsKCiAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICBfY29udGV4dDIudDIgPSBfY29udGV4dDIuc2VudDsKICAgICAgICAgICAgICBfY29udGV4dDIudDMgPSB7CiAgICAgICAgICAgICAgICBwYXNzd29yZDogJycsCiAgICAgICAgICAgICAgICBjb25maXJtUGFzc3dvcmQ6ICcnCiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICB1c2VyID0gKDAsIF9jb250ZXh0Mi50MCkoX2NvbnRleHQyLnQxLCBfY29udGV4dDIudDIsIF9jb250ZXh0Mi50Myk7CiAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxMzsKICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKHNlY3VyaXR5U2V0dXAuYXV0aGMuZ2V0Q3VycmVudFVzZXIoKSk7CgogICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgIGN1cnJlbnRVc2VyID0gX2NvbnRleHQyLnNlbnQ7CiAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAyMDsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMTY6CiAgICAgICAgICAgICAgX2NvbnRleHQyLnByZXYgPSAxNjsKICAgICAgICAgICAgICBfY29udGV4dDIudDQgPSBfY29udGV4dDJbImNhdGNoIl0oMyk7CgogICAgICAgICAgICAgIF9ub3RpZnkudG9hc3ROb3RpZmljYXRpb25zLmFkZERhbmdlcih7CiAgICAgICAgICAgICAgICB0aXRsZTogdGhpcy5wcm9wcy5pbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgICAgICAgICBpZDogJ3hwYWNrLnNlY3VyaXR5Lm1hbmFnZW1lbnQudXNlcnMuZWRpdFVzZXIuZXJyb3JMb2FkaW5nVXNlclRpdGxlJywKICAgICAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdFcnJvciBsb2FkaW5nIHVzZXInCiAgICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICAgIHRleHQ6ICgwLCBfbG9kYXNoLmdldCkoX2NvbnRleHQyLnQ0LCAnYm9keS5tZXNzYWdlJykgfHwgX2NvbnRleHQyLnQ0Lm1lc3NhZ2UKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgY2FzZSAyMDoKICAgICAgICAgICAgICByb2xlcyA9IFtdOwogICAgICAgICAgICAgIF9jb250ZXh0Mi5wcmV2ID0gMjE7CiAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAyNDsKICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKGFwaUNsaWVudC5nZXRSb2xlcygpKTsKCiAgICAgICAgICAgIGNhc2UgMjQ6CiAgICAgICAgICAgICAgcm9sZXMgPSBfY29udGV4dDIuc2VudDsKICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDMwOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAyNzoKICAgICAgICAgICAgICBfY29udGV4dDIucHJldiA9IDI3OwogICAgICAgICAgICAgIF9jb250ZXh0Mi50NSA9IF9jb250ZXh0MlsiY2F0Y2giXSgyMSk7CgogICAgICAgICAgICAgIF9ub3RpZnkudG9hc3ROb3RpZmljYXRpb25zLmFkZERhbmdlcih7CiAgICAgICAgICAgICAgICB0aXRsZTogdGhpcy5wcm9wcy5pbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgICAgICAgICBpZDogJ3hwYWNrLnNlY3VyaXR5Lm1hbmFnZW1lbnQudXNlcnMuZWRpdFVzZXIuZXJyb3JMb2FkaW5nUm9sZXNUaXRsZScsCiAgICAgICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnRXJyb3IgbG9hZGluZyByb2xlcycKICAgICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgICAgdGV4dDogKDAsIF9sb2Rhc2guZ2V0KShfY29udGV4dDIudDUsICdib2R5Lm1lc3NhZ2UnKSB8fCBfY29udGV4dDIudDUubWVzc2FnZQogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgY2FzZSAzMDoKICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgIGlzTG9hZGVkOiB0cnVlLAogICAgICAgICAgICAgICAgaXNOZXdVc2VyOiAhdXNlcm5hbWUsCiAgICAgICAgICAgICAgICBjdXJyZW50VXNlcjogY3VycmVudFVzZXIsCiAgICAgICAgICAgICAgICB1c2VyOiB1c2VyLAogICAgICAgICAgICAgICAgcm9sZXM6IHJvbGVzLAogICAgICAgICAgICAgICAgc2VsZWN0ZWRSb2xlczogdXNlci5yb2xlcy5tYXAoZnVuY3Rpb24gKHJvbGUpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICBsYWJlbDogcm9sZQogICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgfSkgfHwgW10KICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgMzE6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBudWxsLCB0aGlzLCBbWzMsIDE2XSwgWzIxLCAyN11dKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB2YXIgX3RoaXMkcHJvcHMzID0gdGhpcy5wcm9wcywKICAgICAgICAgIGNoYW5nZVVybCA9IF90aGlzJHByb3BzMy5jaGFuZ2VVcmwsCiAgICAgICAgICBpbnRsID0gX3RoaXMkcHJvcHMzLmludGw7CiAgICAgIHZhciBfdGhpcyRzdGF0ZTUgPSB0aGlzLnN0YXRlLAogICAgICAgICAgdXNlciA9IF90aGlzJHN0YXRlNS51c2VyLAogICAgICAgICAgcm9sZXMgPSBfdGhpcyRzdGF0ZTUucm9sZXMsCiAgICAgICAgICBzZWxlY3RlZFJvbGVzID0gX3RoaXMkc3RhdGU1LnNlbGVjdGVkUm9sZXMsCiAgICAgICAgICBzaG93Q2hhbmdlUGFzc3dvcmRGb3JtID0gX3RoaXMkc3RhdGU1LnNob3dDaGFuZ2VQYXNzd29yZEZvcm0sCiAgICAgICAgICBpc05ld1VzZXIgPSBfdGhpcyRzdGF0ZTUuaXNOZXdVc2VyLAogICAgICAgICAgc2hvd0RlbGV0ZUNvbmZpcm1hdGlvbiA9IF90aGlzJHN0YXRlNS5zaG93RGVsZXRlQ29uZmlybWF0aW9uOwogICAgICB2YXIgcmVzZXJ2ZWQgPSB1c2VyLm1ldGFkYXRhICYmIHVzZXIubWV0YWRhdGEuX3Jlc2VydmVkOwoKICAgICAgaWYgKCF1c2VyIHx8ICFyb2xlcykgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICBpZiAoIXRoaXMuc3RhdGUuaXNMb2FkZWQpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICBjbGFzc05hbWU6ICJzZWNVc2Vyc0VkaXRQYWdlIgogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpUGFnZUNvbnRlbnQsIHsKICAgICAgICBjbGFzc05hbWU6ICJzZWNVc2Vyc0VkaXRQYWdlX19jb250ZW50IgogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpUGFnZUNvbnRlbnRIZWFkZXIsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlQYWdlQ29udGVudEhlYWRlclNlY3Rpb24sIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUaXRsZSwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgiaDEiLCBudWxsLCBpc05ld1VzZXIgPyBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAieHBhY2suc2VjdXJpdHkubWFuYWdlbWVudC51c2Vycy5lZGl0VXNlci5uZXdVc2VyVGl0bGUiLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiTmV3IHVzZXIiCiAgICAgIH0pIDogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogInhwYWNrLnNlY3VyaXR5Lm1hbmFnZW1lbnQudXNlcnMuZWRpdFVzZXIuZWRpdFVzZXJUaXRsZSIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJFZGl0IHt1c2VyTmFtZX0gdXNlciIsCiAgICAgICAgdmFsdWVzOiB7CiAgICAgICAgICB1c2VyTmFtZTogdXNlci51c2VybmFtZQogICAgICAgIH0KICAgICAgfSkpKSksIHJlc2VydmVkICYmIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlQYWdlQ29udGVudEhlYWRlclNlY3Rpb24sIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlJY29uLCB7CiAgICAgICAgdHlwZTogImxvY2siLAogICAgICAgIHNpemU6ICJsIiwKICAgICAgICBjb2xvcjogInN1YmR1ZWQiCiAgICAgIH0pKSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlQYWdlQ29udGVudEJvZHksIG51bGwsIHJlc2VydmVkICYmIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUZXh0LCB7CiAgICAgICAgc2l6ZTogInMiLAogICAgICAgIGNvbG9yOiAic3ViZHVlZCIKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgicCIsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJ4cGFjay5zZWN1cml0eS5tYW5hZ2VtZW50LnVzZXJzLmVkaXRVc2VyLm1vZGlmeWluZ1Jlc2VydmVkVXNlcnNEZXNjcmlwdGlvbiIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJSZXNlcnZlZCB1c2VycyBhcmUgYnVpbHQtaW4gYW5kIGNhbm5vdCBiZSByZW1vdmVkIG9yIG1vZGlmaWVkLiBPbmx5IHRoZSBwYXNzd29yZCBtYXkgYmUgY2hhbmdlZC4iCiAgICAgIH0pKSksIHNob3dEZWxldGVDb25maXJtYXRpb24gPyBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF91c2Vycy5Db25maXJtRGVsZXRlVXNlcnMsIHsKICAgICAgICBvbkNhbmNlbDogdGhpcy5vbkNhbmNlbERlbGV0ZSwKICAgICAgICB1c2Vyc1RvRGVsZXRlOiBbdXNlci51c2VybmFtZV0sCiAgICAgICAgY2FsbGJhY2s6IHRoaXMuaGFuZGxlRGVsZXRlLAogICAgICAgIGFwaUNsaWVudDogdGhpcy5wcm9wcy5hcGlDbGllbnQKICAgICAgfSkgOiBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRm9ybSwgdGhpcy5zdGF0ZS5mb3JtRXJyb3IsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGb3JtUm93LCBfZXh0ZW5kcyh7fSwgdGhpcy52YWxpZGF0b3IudmFsaWRhdGVVc2VybmFtZSh0aGlzLnN0YXRlLnVzZXIpLCB7CiAgICAgICAgaGVscFRleHQ6ICFpc05ld1VzZXIgJiYgIXJlc2VydmVkID8gaW50bC5mb3JtYXRNZXNzYWdlKHsKICAgICAgICAgIGlkOiAneHBhY2suc2VjdXJpdHkubWFuYWdlbWVudC51c2Vycy5lZGl0VXNlci5jaGFuZ2luZ1VzZXJOYW1lQWZ0ZXJDcmVhdGlvbkRlc2NyaXB0aW9uJywKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiVXNlcm5hbWVzIGNhbid0IGJlIGNoYW5nZWQgYWZ0ZXIgY3JlYXRpb24uIgogICAgICAgIH0pIDogbnVsbCwKICAgICAgICBsYWJlbDogaW50bC5mb3JtYXRNZXNzYWdlKHsKICAgICAgICAgIGlkOiAneHBhY2suc2VjdXJpdHkubWFuYWdlbWVudC51c2Vycy5lZGl0VXNlci51c2VybmFtZUZvcm1Sb3dMYWJlbCcsCiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1VzZXJuYW1lJwogICAgICAgIH0pCiAgICAgIH0pLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmllbGRUZXh0LCB7CiAgICAgICAgdmFsdWU6IHVzZXIudXNlcm5hbWUgfHwgJycsCiAgICAgICAgbmFtZTogInVzZXJuYW1lIiwKICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiAidXNlckZvcm1Vc2VyTmFtZUlucHV0IiwKICAgICAgICBkaXNhYmxlZDogIWlzTmV3VXNlciwKICAgICAgICBvbkNoYW5nZTogdGhpcy5vblVzZXJuYW1lQ2hhbmdlCiAgICAgIH0pKSwgaXNOZXdVc2VyID8gdGhpcy5wYXNzd29yZEZpZWxkcygpIDogbnVsbCwgcmVzZXJ2ZWQgPyBudWxsIDogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRnJhZ21lbnQsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGb3JtUm93LCB7CiAgICAgICAgbGFiZWw6IGludGwuZm9ybWF0TWVzc2FnZSh7CiAgICAgICAgICBpZDogJ3hwYWNrLnNlY3VyaXR5Lm1hbmFnZW1lbnQudXNlcnMuZWRpdFVzZXIuZnVsbE5hbWVGb3JtUm93TGFiZWwnLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdGdWxsIG5hbWUnCiAgICAgICAgfSkKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZpZWxkVGV4dCwgewogICAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJ1c2VyRm9ybUZ1bGxOYW1lSW5wdXQiLAogICAgICAgIG5hbWU6ICJmdWxsX25hbWUiLAogICAgICAgIHZhbHVlOiB1c2VyLmZ1bGxfbmFtZSB8fCAnJywKICAgICAgICBvbkNoYW5nZTogdGhpcy5vbkZ1bGxOYW1lQ2hhbmdlCiAgICAgIH0pKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZvcm1Sb3csIF9leHRlbmRzKHt9LCB0aGlzLnZhbGlkYXRvci52YWxpZGF0ZUVtYWlsKHRoaXMuc3RhdGUudXNlciksIHsKICAgICAgICBsYWJlbDogaW50bC5mb3JtYXRNZXNzYWdlKHsKICAgICAgICAgIGlkOiAneHBhY2suc2VjdXJpdHkubWFuYWdlbWVudC51c2Vycy5lZGl0VXNlci5lbWFpbEFkZHJlc3NGb3JtUm93TGFiZWwnLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdFbWFpbCBhZGRyZXNzJwogICAgICAgIH0pCiAgICAgIH0pLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmllbGRUZXh0LCB7CiAgICAgICAgImRhdGEtdGVzdC1zdWJqIjogInVzZXJGb3JtRW1haWxJbnB1dCIsCiAgICAgICAgbmFtZTogImVtYWlsIiwKICAgICAgICB2YWx1ZTogdXNlci5lbWFpbCB8fCAnJywKICAgICAgICBvbkNoYW5nZTogdGhpcy5vbkVtYWlsQ2hhbmdlCiAgICAgIH0pKSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGb3JtUm93LCB7CiAgICAgICAgbGFiZWw6IGludGwuZm9ybWF0TWVzc2FnZSh7CiAgICAgICAgICBpZDogJ3hwYWNrLnNlY3VyaXR5Lm1hbmFnZW1lbnQudXNlcnMuZWRpdFVzZXIucm9sZXNGb3JtUm93TGFiZWwnLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdSb2xlcycKICAgICAgICB9KQogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQ29tYm9Cb3gsIHsKICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiAidXNlckZvcm1Sb2xlc0Ryb3Bkb3duIiwKICAgICAgICBwbGFjZWhvbGRlcjogaW50bC5mb3JtYXRNZXNzYWdlKHsKICAgICAgICAgIGlkOiAneHBhY2suc2VjdXJpdHkubWFuYWdlbWVudC51c2Vycy5lZGl0VXNlci5hZGRSb2xlc1BsYWNlaG9sZGVyJywKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnQWRkIHJvbGVzJwogICAgICAgIH0pLAogICAgICAgIG9uQ2hhbmdlOiB0aGlzLm9uUm9sZXNDaGFuZ2UsCiAgICAgICAgaXNEaXNhYmxlZDogcmVzZXJ2ZWQsCiAgICAgICAgb3B0aW9uczogcm9sZXMubWFwKGZ1bmN0aW9uIChyb2xlKSB7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAnZGF0YS10ZXN0LXN1YmonOiAicm9sZU9wdGlvbi0iLmNvbmNhdChyb2xlLm5hbWUpLAogICAgICAgICAgICBsYWJlbDogcm9sZS5uYW1lCiAgICAgICAgICB9OwogICAgICAgIH0pLAogICAgICAgIHNlbGVjdGVkT3B0aW9uczogc2VsZWN0ZWRSb2xlcwogICAgICB9KSksIGlzTmV3VXNlciB8fCBzaG93Q2hhbmdlUGFzc3dvcmRGb3JtID8gbnVsbCA6IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGb3JtUm93LCB7CiAgICAgICAgbGFiZWw6ICJQYXNzd29yZCIKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUxpbmssIHsKICAgICAgICBvbkNsaWNrOiB0aGlzLnRvZ2dsZUNoYW5nZVBhc3N3b3JkRm9ybQogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAieHBhY2suc2VjdXJpdHkubWFuYWdlbWVudC51c2Vycy5lZGl0VXNlci5jaGFuZ2VQYXNzd29yZEJ1dHRvbkxhYmVsIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkNoYW5nZSBwYXNzd29yZCIKICAgICAgfSkpKSwgdGhpcy5jaGFuZ2VQYXNzd29yZEZvcm0oKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUhvcml6b250YWxSdWxlLCBudWxsKSwgcmVzZXJ2ZWQgJiYgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUJ1dHRvbiwgewogICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7CiAgICAgICAgICByZXR1cm4gY2hhbmdlVXJsKF9tYW5hZ2VtZW50X3VybHMuVVNFUlNfUEFUSCk7CiAgICAgICAgfQogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAieHBhY2suc2VjdXJpdHkubWFuYWdlbWVudC51c2Vycy5lZGl0VXNlci5yZXR1cm5Ub1VzZXJMaXN0QnV0dG9uTGFiZWwiLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiUmV0dXJuIHRvIHVzZXIgbGlzdCIKICAgICAgfSkpLCByZXNlcnZlZCA/IG51bGwgOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEdyb3VwLCB7CiAgICAgICAgcmVzcG9uc2l2ZTogZmFsc2UKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICAgICAgZ3JvdzogZmFsc2UKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUJ1dHRvbiwgewogICAgICAgIGRpc2FibGVkOiB0aGlzLmNhbm5vdFNhdmVVc2VyKCksCiAgICAgICAgZmlsbDogdHJ1ZSwKICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiAidXNlckZvcm1TYXZlQnV0dG9uIiwKICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgcmV0dXJuIF90aGlzMi5zYXZlVXNlcigpOwogICAgICAgIH0KICAgICAgfSwgaXNOZXdVc2VyID8gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogInhwYWNrLnNlY3VyaXR5Lm1hbmFnZW1lbnQudXNlcnMuZWRpdFVzZXIuY3JlYXRlVXNlckJ1dHRvbkxhYmVsIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkNyZWF0ZSB1c2VyIgogICAgICB9KSA6IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJ4cGFjay5zZWN1cml0eS5tYW5hZ2VtZW50LnVzZXJzLmVkaXRVc2VyLnVwZGF0ZVVzZXJCdXR0b25MYWJlbCIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJVcGRhdGUgdXNlciIKICAgICAgfSkpKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICAgICAgZ3JvdzogZmFsc2UKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUJ1dHRvbkVtcHR5LCB7CiAgICAgICAgImRhdGEtdGVzdC1zdWJqIjogInVzZXJGb3JtQ2FuY2VsQnV0dG9uIiwKICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgcmV0dXJuIGNoYW5nZVVybChfbWFuYWdlbWVudF91cmxzLlVTRVJTX1BBVEgpOwogICAgICAgIH0KICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogInhwYWNrLnNlY3VyaXR5Lm1hbmFnZW1lbnQudXNlcnMuZWRpdFVzZXIuY2FuY2VsQnV0dG9uTGFiZWwiLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiQ2FuY2VsIgogICAgICB9KSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgICAgICBncm93OiB0cnVlCiAgICAgIH0pLCBpc05ld1VzZXIgfHwgcmVzZXJ2ZWQgPyBudWxsIDogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICAgICAgZ3JvdzogZmFsc2UKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUJ1dHRvbkVtcHR5LCB7CiAgICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHsKICAgICAgICAgIF90aGlzMi5zZXRTdGF0ZSh7CiAgICAgICAgICAgIHNob3dEZWxldGVDb25maXJtYXRpb246IHRydWUKICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgImRhdGEtdGVzdC1zdWJqIjogInVzZXJGb3JtRGVsZXRlQnV0dG9uIiwKICAgICAgICBjb2xvcjogImRhbmdlciIKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogInhwYWNrLnNlY3VyaXR5Lm1hbmFnZW1lbnQudXNlcnMuZWRpdFVzZXIuZGVsZXRlVXNlckJ1dHRvbkxhYmVsIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkRlbGV0ZSB1c2VyIgogICAgICB9KSkpKSkpKSk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gRWRpdFVzZXJQYWdlVUk7Cn0oX3JlYWN0LkNvbXBvbmVudCk7Cgp2YXIgRWRpdFVzZXJQYWdlID0gKDAsIF9yZWFjdDIuaW5qZWN0STE4bikoRWRpdFVzZXJQYWdlVUkpOwpleHBvcnRzLkVkaXRVc2VyUGFnZSA9IEVkaXRVc2VyUGFnZTs="},null]}