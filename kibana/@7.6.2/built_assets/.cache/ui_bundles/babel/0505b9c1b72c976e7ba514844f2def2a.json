{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/snapshot_restore/public/app/components/policy_form/steps/step_logistics.js","dependencies":[{"path":"x-pack/legacy/plugins/snapshot_restore/public/app/components/policy_form/steps/step_logistics.js","mtime":1585205048207},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLlBvbGljeVN0ZXBMb2dpc3RpY3MgPSB2b2lkIDA7Cgp2YXIgX3JlYWN0ID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgicmVhY3QiKSk7Cgp2YXIgX2V1aSA9IHJlcXVpcmUoIkBlbGFzdGljL2V1aSIpOwoKdmFyIF9zaGFyZWRfaW1wb3J0cyA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL3NoYXJlZF9pbXBvcnRzIik7Cgp2YXIgX2NvbnN0YW50cyA9IHJlcXVpcmUoIi4uLy4uLy4uL2NvbnN0YW50cyIpOwoKdmFyIF9odHRwID0gcmVxdWlyZSgiLi4vLi4vLi4vc2VydmljZXMvaHR0cCIpOwoKdmFyIF9uYXZpZ2F0aW9uID0gcmVxdWlyZSgiLi4vLi4vLi4vc2VydmljZXMvbmF2aWdhdGlvbiIpOwoKdmFyIF9kb2N1bWVudGF0aW9uID0gcmVxdWlyZSgiLi4vLi4vLi4vc2VydmljZXMvZG9jdW1lbnRhdGlvbiIpOwoKdmFyIF9pbmRleCA9IHJlcXVpcmUoIi4uLy4uLy4uL2luZGV4Iik7Cgp2YXIgXyA9IHJlcXVpcmUoIi4uLy4uLyIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7CiAgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgewogICAgcmV0dXJuIG9iajsKICB9IGVsc2UgewogICAgdmFyIG5ld09iaiA9IHt9OwoKICAgIGlmIChvYmogIT0gbnVsbCkgewogICAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7CiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHsKICAgICAgICAgIHZhciBkZXNjID0gT2JqZWN0LmRlZmluZVByb3BlcnR5ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KSA6IHt9OwoKICAgICAgICAgIGlmIChkZXNjLmdldCB8fCBkZXNjLnNldCkgewogICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobmV3T2JqLCBrZXksIGRlc2MpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBuZXdPYmouZGVmYXVsdCA9IG9iajsKICAgIHJldHVybiBuZXdPYmo7CiAgfQp9CgpmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsKICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7CgogIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7CiAgICB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsKICAgIGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsKICAgICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7CiAgICB9KTsKICAgIGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsKICB9CgogIHJldHVybiBrZXlzOwp9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgewogIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsKCiAgICBpZiAoaSAlIDIpIHsKICAgICAgb3duS2V5cyhzb3VyY2UsIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOwogICAgICB9KTsKICAgIH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsKICAgIH0gZWxzZSB7CiAgICAgIG93bktleXMoc291cmNlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsKICAgICAgfSk7CiAgICB9CiAgfQoKICByZXR1cm4gdGFyZ2V0Owp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7CiAgaWYgKGtleSBpbiBvYmopIHsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgICB2YWx1ZTogdmFsdWUsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgd3JpdGFibGU6IHRydWUKICAgIH0pOwogIH0gZWxzZSB7CiAgICBvYmpba2V5XSA9IHZhbHVlOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7CiAgcmV0dXJuIF9hcnJheVdpdGhIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHx8IF9ub25JdGVyYWJsZVJlc3QoKTsKfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlUmVzdCgpIHsKICB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7Cn0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHsKICB2YXIgX2FyciA9IFtdOwogIHZhciBfbiA9IHRydWU7CiAgdmFyIF9kID0gZmFsc2U7CiAgdmFyIF9lID0gdW5kZWZpbmVkOwoKICB0cnkgewogICAgZm9yICh2YXIgX2kgPSBhcnJbU3ltYm9sLml0ZXJhdG9yXSgpLCBfczsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSkgewogICAgICBfYXJyLnB1c2goX3MudmFsdWUpOwoKICAgICAgaWYgKGkgJiYgX2Fyci5sZW5ndGggPT09IGkpIGJyZWFrOwogICAgfQogIH0gY2F0Y2ggKGVycikgewogICAgX2QgPSB0cnVlOwogICAgX2UgPSBlcnI7CiAgfSBmaW5hbGx5IHsKICAgIHRyeSB7CiAgICAgIGlmICghX24gJiYgX2lbInJldHVybiJdICE9IG51bGwpIF9pWyJyZXR1cm4iXSgpOwogICAgfSBmaW5hbGx5IHsKICAgICAgaWYgKF9kKSB0aHJvdyBfZTsKICAgIH0KICB9CgogIHJldHVybiBfYXJyOwp9CgpmdW5jdGlvbiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsKfQoKdmFyIFBvbGljeVN0ZXBMb2dpc3RpY3MgPSBmdW5jdGlvbiBQb2xpY3lTdGVwTG9naXN0aWNzKF9yZWYpIHsKICB2YXIgcG9saWN5ID0gX3JlZi5wb2xpY3ksCiAgICAgIHVwZGF0ZVBvbGljeSA9IF9yZWYudXBkYXRlUG9saWN5LAogICAgICBpc0VkaXRpbmcgPSBfcmVmLmlzRWRpdGluZywKICAgICAgY3VycmVudFVybCA9IF9yZWYuY3VycmVudFVybCwKICAgICAgZXJyb3JzID0gX3JlZi5lcnJvcnM7CgogIHZhciBfdXNlQXBwRGVwZW5kZW5jaWVzID0gKDAsIF9pbmRleC51c2VBcHBEZXBlbmRlbmNpZXMpKCksCiAgICAgIGkxOG4gPSBfdXNlQXBwRGVwZW5kZW5jaWVzLmNvcmUuaTE4bjsKCiAgdmFyIEZvcm1hdHRlZE1lc3NhZ2UgPSBpMThuLkZvcm1hdHRlZE1lc3NhZ2U7IC8vIExvYWQgcmVwb3NpdG9yaWVzIGZvciByZXBvc2l0b3J5IGRyb3Bkb3duIGZpZWxkCgogIHZhciBfdXNlTG9hZFJlcG9zaXRvcmllcyA9ICgwLCBfaHR0cC51c2VMb2FkUmVwb3NpdG9yaWVzKSgpLAogICAgICBlcnJvckxvYWRpbmdSZXBvc2l0b3JpZXMgPSBfdXNlTG9hZFJlcG9zaXRvcmllcy5lcnJvciwKICAgICAgaXNMb2FkaW5nUmVwb3NpdG9yaWVzID0gX3VzZUxvYWRSZXBvc2l0b3JpZXMuaXNMb2FkaW5nLAogICAgICBfdXNlTG9hZFJlcG9zaXRvcmllcyQgPSBfdXNlTG9hZFJlcG9zaXRvcmllcy5kYXRhOwoKICBfdXNlTG9hZFJlcG9zaXRvcmllcyQgPSBfdXNlTG9hZFJlcG9zaXRvcmllcyQgPT09IHZvaWQgMCA/IHsKICAgIHJlcG9zaXRvcmllczogW10sCiAgICBtYW5hZ2VkUmVwb3NpdG9yeTogewogICAgICBuYW1lOiB1bmRlZmluZWQKICAgIH0KICB9IDogX3VzZUxvYWRSZXBvc2l0b3JpZXMkOwogIHZhciByZXBvc2l0b3JpZXMgPSBfdXNlTG9hZFJlcG9zaXRvcmllcyQucmVwb3NpdG9yaWVzLAogICAgICBtYW5hZ2VkUmVwb3NpdG9yeSA9IF91c2VMb2FkUmVwb3NpdG9yaWVzJC5tYW5hZ2VkUmVwb3NpdG9yeSwKICAgICAgcmVsb2FkUmVwb3NpdG9yaWVzID0gX3VzZUxvYWRSZXBvc2l0b3JpZXMuc2VuZFJlcXVlc3Q7IC8vIFN0YXRlIGZvciB0b3VjaGVkIGlucHV0cwoKICB2YXIgX3VzZVN0YXRlID0gKDAsIF9yZWFjdC51c2VTdGF0ZSkoewogICAgbmFtZTogZmFsc2UsCiAgICBzbmFwc2hvdE5hbWU6IGZhbHNlLAogICAgcmVwb3NpdG9yeTogZmFsc2UsCiAgICBzY2hlZHVsZTogZmFsc2UKICB9KSwKICAgICAgX3VzZVN0YXRlMiA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZSwgMiksCiAgICAgIHRvdWNoZWQgPSBfdXNlU3RhdGUyWzBdLAogICAgICBzZXRUb3VjaGVkID0gX3VzZVN0YXRlMlsxXTsgLy8gU3RhdGUgZm9yIGNyb24gZWRpdG9yCgoKICB2YXIgX3VzZVN0YXRlMyA9ICgwLCBfcmVhY3QudXNlU3RhdGUpKHsKICAgIGV4cHJlc3Npb246IF9jb25zdGFudHMuREVGQVVMVF9QT0xJQ1lfU0NIRURVTEUsCiAgICBmcmVxdWVuY3k6IF9jb25zdGFudHMuREVGQVVMVF9QT0xJQ1lfRlJFUVVFTkNZCiAgfSksCiAgICAgIF91c2VTdGF0ZTQgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUzLCAyKSwKICAgICAgc2ltcGxlQ3JvbiA9IF91c2VTdGF0ZTRbMF0sCiAgICAgIHNldFNpbXBsZUNyb24gPSBfdXNlU3RhdGU0WzFdOwoKICB2YXIgX3VzZVN0YXRlNSA9ICgwLCBfcmVhY3QudXNlU3RhdGUpKEJvb2xlYW4ocG9saWN5LnNjaGVkdWxlICYmIHBvbGljeS5zY2hlZHVsZSAhPT0gX2NvbnN0YW50cy5ERUZBVUxUX1BPTElDWV9TQ0hFRFVMRSkpLAogICAgICBfdXNlU3RhdGU2ID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlNSwgMiksCiAgICAgIGlzQWR2YW5jZWRDcm9uVmlzaWJsZSA9IF91c2VTdGF0ZTZbMF0sCiAgICAgIHNldElzQWR2YW5jZWRDcm9uVmlzaWJsZSA9IF91c2VTdGF0ZTZbMV07CgogIHZhciBfdXNlU3RhdGU3ID0gKDAsIF9yZWFjdC51c2VTdGF0ZSkoe30pLAogICAgICBfdXNlU3RhdGU4ID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlNywgMiksCiAgICAgIGZpZWxkVG9QcmVmZXJyZWRWYWx1ZU1hcCA9IF91c2VTdGF0ZThbMF0sCiAgICAgIHNldEZpZWxkVG9QcmVmZXJyZWRWYWx1ZU1hcCA9IF91c2VTdGF0ZThbMV07CgogIHZhciByZW5kZXJOYW1lRmllbGQgPSBmdW5jdGlvbiByZW5kZXJOYW1lRmllbGQoKSB7CiAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aURlc2NyaWJlZEZvcm1Hcm91cCwgewogICAgICB0aXRsZTogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRpdGxlLCB7CiAgICAgICAgc2l6ZTogInMiCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImgzIiwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChGb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJ4cGFjay5zbmFwc2hvdFJlc3RvcmUucG9saWN5Rm9ybS5zdGVwTG9naXN0aWNzLm5hbWVEZXNjcmlwdGlvblRpdGxlIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIlBvbGljeSBuYW1lIgogICAgICB9KSkpLAogICAgICBkZXNjcmlwdGlvbjogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChGb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJ4cGFjay5zbmFwc2hvdFJlc3RvcmUucG9saWN5Rm9ybS5zdGVwTG9naXN0aWNzLm5hbWVEZXNjcmlwdGlvbiIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJBIHVuaXF1ZSBpZGVudGlmaWVyIGZvciB0aGlzIHBvbGljeS4iCiAgICAgIH0pLAogICAgICBpZEFyaWE6ICJuYW1lRGVzY3JpcHRpb24iLAogICAgICBmdWxsV2lkdGg6IHRydWUKICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGb3JtUm93LCB7CiAgICAgIGxhYmVsOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KEZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogInhwYWNrLnNuYXBzaG90UmVzdG9yZS5wb2xpY3lGb3JtLnN0ZXBMb2dpc3RpY3MubmFtZUxhYmVsIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIk5hbWUiCiAgICAgIH0pLAogICAgICBkZXNjcmliZWRCeUlkczogWyduYW1lRGVzY3JpcHRpb24nXSwKICAgICAgaXNJbnZhbGlkOiB0b3VjaGVkLm5hbWUgJiYgQm9vbGVhbihlcnJvcnMubmFtZSksCiAgICAgIGVycm9yOiBlcnJvcnMubmFtZSwKICAgICAgZnVsbFdpZHRoOiB0cnVlCiAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmllbGRUZXh0LCB7CiAgICAgIGRlZmF1bHRWYWx1ZTogcG9saWN5Lm5hbWUsCiAgICAgIGZ1bGxXaWR0aDogdHJ1ZSwKICAgICAgb25CbHVyOiBmdW5jdGlvbiBvbkJsdXIoKSB7CiAgICAgICAgcmV0dXJuIHNldFRvdWNoZWQoX29iamVjdFNwcmVhZCh7fSwgdG91Y2hlZCwgewogICAgICAgICAgbmFtZTogdHJ1ZQogICAgICAgIH0pKTsKICAgICAgfSwKICAgICAgb25DaGFuZ2U6IGZ1bmN0aW9uIG9uQ2hhbmdlKGUpIHsKICAgICAgICB1cGRhdGVQb2xpY3koewogICAgICAgICAgbmFtZTogZS50YXJnZXQudmFsdWUKICAgICAgICB9LCB7CiAgICAgICAgICBtYW5hZ2VkUmVwb3NpdG9yeTogbWFuYWdlZFJlcG9zaXRvcnksCiAgICAgICAgICBpc0VkaXRpbmc6IGlzRWRpdGluZywKICAgICAgICAgIHBvbGljeU5hbWU6IHBvbGljeS5uYW1lCiAgICAgICAgfSk7CiAgICAgIH0sCiAgICAgIHBsYWNlaG9sZGVyOiBpMThuLnRyYW5zbGF0ZSgneHBhY2suc25hcHNob3RSZXN0b3JlLnBvbGljeUZvcm0uc3RlcExvZ2lzdGljcy5uYW1lUGxhY2Vob2xkZXInLCB7CiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdkYWlseS1zbmFwc2hvdHMnLAogICAgICAgIGRlc2NyaXB0aW9uOiAnRXhhbXBsZSBTTE0gcG9saWN5IG5hbWUuIFNpbWlsYXIgdG8gaW5kZXggbmFtZXMsIGRvIG5vdCB1c2Ugc3BhY2VzIGluIHRyYW5zbGF0aW9uLicKICAgICAgfSksCiAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJuYW1lSW5wdXQiLAogICAgICBkaXNhYmxlZDogaXNFZGl0aW5nCiAgICB9KSkpOwogIH07CgogIHZhciByZW5kZXJSZXBvc2l0b3J5RmllbGQgPSBmdW5jdGlvbiByZW5kZXJSZXBvc2l0b3J5RmllbGQoKSB7CiAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aURlc2NyaWJlZEZvcm1Hcm91cCwgewogICAgICB0aXRsZTogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRpdGxlLCB7CiAgICAgICAgc2l6ZTogInMiCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImgzIiwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChGb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJ4cGFjay5zbmFwc2hvdFJlc3RvcmUucG9saWN5Rm9ybS5zdGVwTG9naXN0aWNzLnJlcG9zaXRvcnlEZXNjcmlwdGlvblRpdGxlIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIlJlcG9zaXRvcnkiCiAgICAgIH0pKSksCiAgICAgIGRlc2NyaXB0aW9uOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KEZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogInhwYWNrLnNuYXBzaG90UmVzdG9yZS5wb2xpY3lGb3JtLnN0ZXBMb2dpc3RpY3MucmVwb3NpdG9yeURlc2NyaXB0aW9uIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIlRoZSByZXBvc2l0b3J5IHdoZXJlIHlvdSB3YW50IHRvIHN0b3JlIHRoZSBzbmFwc2hvdHMuIgogICAgICB9KSwKICAgICAgaWRBcmlhOiAicG9saWN5UmVwb3NpdG9yeURlc2NyaXB0aW9uIiwKICAgICAgZnVsbFdpZHRoOiB0cnVlCiAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRm9ybVJvdywgewogICAgICBsYWJlbDogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChGb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJ4cGFjay5zbmFwc2hvdFJlc3RvcmUucG9saWN5Rm9ybS5zdGVwTG9naXN0aWNzLnBvbGljeVJlcG9zaXRvcnlMYWJlbCIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJSZXBvc2l0b3J5IgogICAgICB9KSwKICAgICAgZGVzY3JpYmVkQnlJZHM6IFsncG9saWN5UmVwb3NpdG9yeURlc2NyaXB0aW9uJ10sCiAgICAgIGlzSW52YWxpZDogdG91Y2hlZC5yZXBvc2l0b3J5ICYmIEJvb2xlYW4oZXJyb3JzLnJlcG9zaXRvcnkpLAogICAgICBlcnJvcjogZXJyb3JzLnJlcG9zaXRvcnksCiAgICAgIGZ1bGxXaWR0aDogdHJ1ZQogICAgfSwgcmVuZGVyUmVwb3NpdG9yeVNlbGVjdCgpKSk7CiAgfTsKCiAgdmFyIHJlbmRlclJlcG9zaXRvcnlTZWxlY3QgPSBmdW5jdGlvbiByZW5kZXJSZXBvc2l0b3J5U2VsZWN0KCkgewogICAgaWYgKGlzTG9hZGluZ1JlcG9zaXRvcmllcykgewogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfLlNlY3Rpb25Mb2FkaW5nLCB7CiAgICAgICAgaW5saW5lOiB0cnVlCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAieHBhY2suc25hcHNob3RSZXN0b3JlLnBvbGljeUZvcm0ubG9hZGluZ1JlcG9zaXRvcmllc0Rlc2NyaXB0aW9uIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkxvYWRpbmcgcmVwb3NpdG9yaWVzXHUyMDI2IgogICAgICB9KSk7CiAgICB9CgogICAgaWYgKGVycm9yTG9hZGluZ1JlcG9zaXRvcmllcykgewogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfLlNlY3Rpb25FcnJvciwgewogICAgICAgIHRpdGxlOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KEZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICAgIGlkOiAieHBhY2suc25hcHNob3RSZXN0b3JlLnBvbGljeUZvcm0ubG9hZGluZ1JlcG9zaXRvcmllc0Vycm9yTWVzc2FnZSIsCiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkVycm9yIGxvYWRpbmcgcmVwb3NpdG9yaWVzIgogICAgICAgIH0pLAogICAgICAgIGVycm9yOiB7CiAgICAgICAgICBkYXRhOiB7CiAgICAgICAgICAgIGVycm9yOiAndGVzdCcKICAgICAgICAgIH0KICAgICAgICB9IHx8IGVycm9yTG9hZGluZ1JlcG9zaXRvcmllcywKICAgICAgICBhY3Rpb25zOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQnV0dG9uLCB7CiAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgICByZXR1cm4gcmVsb2FkUmVwb3NpdG9yaWVzKCk7CiAgICAgICAgICB9LAogICAgICAgICAgY29sb3I6ICJkYW5nZXIiLAogICAgICAgICAgaWNvblR5cGU6ICJyZWZyZXNoIiwKICAgICAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJyZWxvYWRSZXBvc2l0b3JpZXNCdXR0b24iCiAgICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChGb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICBpZDogInhwYWNrLnNuYXBzaG90UmVzdG9yZS5wb2xpY3lGb3JtLnJlbG9hZFJlcG9zaXRvcmllc0J1dHRvbkxhYmVsIiwKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiUmVsb2FkIHJlcG9zaXRvcmllcyIKICAgICAgICB9KSkKICAgICAgfSk7CiAgICB9CgogICAgaWYgKHJlcG9zaXRvcmllcy5sZW5ndGggPT09IDApIHsKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXy5TZWN0aW9uRXJyb3IsIHsKICAgICAgICB0aXRsZTogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChGb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICBpZDogInhwYWNrLnNuYXBzaG90UmVzdG9yZS5wb2xpY3lGb3JtLm5vUmVwb3NpdG9yaWVzRXJyb3JUaXRsZSIsCiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIllvdSBkb24ndCBoYXZlIGFueSByZXBvc2l0b3JpZXMiCiAgICAgICAgfSksCiAgICAgICAgZXJyb3I6IHsKICAgICAgICAgIGRhdGE6IHsKICAgICAgICAgICAgZXJyb3I6IGkxOG4udHJhbnNsYXRlKCd4cGFjay5zbmFwc2hvdFJlc3RvcmUucG9saWN5Rm9ybS5ub1JlcG9zaXRvcmllc0Vycm9yTWVzc2FnZScsIHsKICAgICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1lvdSBtdXN0IHJlZ2lzdGVyIGEgcmVwb3NpdG9yeSB0byBzdG9yZSB5b3VyIHNuYXBzaG90cy4nCiAgICAgICAgICAgIH0pCiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBhY3Rpb25zOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQnV0dG9uLCB7CiAgICAgICAgICBocmVmOiAoMCwgX25hdmlnYXRpb24ubGlua1RvQWRkUmVwb3NpdG9yeSkoY3VycmVudFVybCksCiAgICAgICAgICBjb2xvcjogImRhbmdlciIsCiAgICAgICAgICBpY29uVHlwZTogInBsdXNJbkNpcmNsZSIsCiAgICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiAiYWRkUmVwb3NpdG9yeUJ1dHRvbiIKICAgICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KEZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICAgIGlkOiAieHBhY2suc25hcHNob3RSZXN0b3JlLnBvbGljeUZvcm0uYWRkUmVwb3NpdG9yeUJ1dHRvbkxhYmVsIiwKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiUmVnaXN0ZXIgYSByZXBvc2l0b3J5IgogICAgICAgIH0pKQogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIGlmICghcG9saWN5LnJlcG9zaXRvcnkpIHsKICAgICAgICB1cGRhdGVQb2xpY3koewogICAgICAgICAgcmVwb3NpdG9yeTogcmVwb3NpdG9yaWVzWzBdLm5hbWUKICAgICAgICB9LCB7CiAgICAgICAgICBtYW5hZ2VkUmVwb3NpdG9yeTogbWFuYWdlZFJlcG9zaXRvcnksCiAgICAgICAgICBpc0VkaXRpbmc6IGlzRWRpdGluZywKICAgICAgICAgIHBvbGljeU5hbWU6IHBvbGljeS5uYW1lCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNlbGVjdCwgewogICAgICBvcHRpb25zOiByZXBvc2l0b3JpZXMubWFwKGZ1bmN0aW9uIChfcmVmMikgewogICAgICAgIHZhciBuYW1lID0gX3JlZjIubmFtZTsKICAgICAgICByZXR1cm4gewogICAgICAgICAgdmFsdWU6IG5hbWUsCiAgICAgICAgICB0ZXh0OiBuYW1lCiAgICAgICAgfTsKICAgICAgfSksCiAgICAgIHZhbHVlOiBwb2xpY3kucmVwb3NpdG9yeSB8fCByZXBvc2l0b3JpZXNbMF0ubmFtZSwKICAgICAgb25CbHVyOiBmdW5jdGlvbiBvbkJsdXIoKSB7CiAgICAgICAgcmV0dXJuIHNldFRvdWNoZWQoX29iamVjdFNwcmVhZCh7fSwgdG91Y2hlZCwgewogICAgICAgICAgcmVwb3NpdG9yeTogdHJ1ZQogICAgICAgIH0pKTsKICAgICAgfSwKICAgICAgb25DaGFuZ2U6IGZ1bmN0aW9uIG9uQ2hhbmdlKGUpIHsKICAgICAgICB1cGRhdGVQb2xpY3koewogICAgICAgICAgcmVwb3NpdG9yeTogZS50YXJnZXQudmFsdWUKICAgICAgICB9LCB7CiAgICAgICAgICBtYW5hZ2VkUmVwb3NpdG9yeTogbWFuYWdlZFJlcG9zaXRvcnksCiAgICAgICAgICBpc0VkaXRpbmc6IGlzRWRpdGluZywKICAgICAgICAgIHBvbGljeU5hbWU6IHBvbGljeS5uYW1lCiAgICAgICAgfSk7CiAgICAgIH0sCiAgICAgIGZ1bGxXaWR0aDogdHJ1ZSwKICAgICAgImRhdGEtdGVzdC1zdWJqIjogInJlcG9zaXRvcnlTZWxlY3QiCiAgICB9KTsKICB9OwoKICB2YXIgcmVuZGVyU25hcHNob3ROYW1lRmllbGQgPSBmdW5jdGlvbiByZW5kZXJTbmFwc2hvdE5hbWVGaWVsZCgpIHsKICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRGVzY3JpYmVkRm9ybUdyb3VwLCB7CiAgICAgIHRpdGxlOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVGl0bGUsIHsKICAgICAgICBzaXplOiAicyIKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgiaDMiLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KEZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogInhwYWNrLnNuYXBzaG90UmVzdG9yZS5wb2xpY3lGb3JtLnN0ZXBMb2dpc3RpY3Muc25hcHNob3ROYW1lRGVzY3JpcHRpb25UaXRsZSIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJTbmFwc2hvdCBuYW1lIgogICAgICB9KSkpLAogICAgICBkZXNjcmlwdGlvbjogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChGb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJ4cGFjay5zbmFwc2hvdFJlc3RvcmUucG9saWN5Rm9ybS5zdGVwTG9naXN0aWNzLnNuYXBzaG90TmFtZURlc2NyaXB0aW9uIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIlRoZSBuYW1lIGZvciB0aGUgc25hcHNob3RzLiBBIHVuaXF1ZSBpZGVudGlmaWVyIGlzIGF1dG9tYXRpY2FsbHkgYWRkZWQgdG8gZWFjaCBuYW1lLiIKICAgICAgfSksCiAgICAgIGlkQXJpYTogInBvbGljeVNuYXBzaG90TmFtZURlc2NyaXB0aW9uIiwKICAgICAgZnVsbFdpZHRoOiB0cnVlCiAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRm9ybVJvdywgewogICAgICBsYWJlbDogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChGb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJ4cGFjay5zbmFwc2hvdFJlc3RvcmUucG9saWN5Rm9ybS5zdGVwTG9naXN0aWNzLnBvbGljeVNuYXBzaG90TmFtZUxhYmVsIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIlNuYXBzaG90IG5hbWUiCiAgICAgIH0pLAogICAgICBkZXNjcmliZWRCeUlkczogWydwb2xpY3lTbmFwc2hvdE5hbWVEZXNjcmlwdGlvbiddLAogICAgICBpc0ludmFsaWQ6IHRvdWNoZWQuc25hcHNob3ROYW1lICYmIEJvb2xlYW4oZXJyb3JzLnNuYXBzaG90TmFtZSksCiAgICAgIGVycm9yOiBlcnJvcnMuc25hcHNob3ROYW1lLAogICAgICBoZWxwVGV4dDogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChGb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJ4cGFjay5zbmFwc2hvdFJlc3RvcmUucG9saWN5Rm9ybS5zdGVwTG9naXN0aWNzLnBvbGljeVNuYXBzaG90TmFtZUhlbHBUZXh0IiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIlN1cHBvcnRzIGRhdGUgbWF0aCBleHByZXNzaW9ucy4ge2RvY0xpbmt9IiwKICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgIGRvY0xpbms6IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlMaW5rLCB7CiAgICAgICAgICAgIGhyZWY6IF9kb2N1bWVudGF0aW9uLmRvY3VtZW50YXRpb25MaW5rc1NlcnZpY2UuZ2V0RGF0ZU1hdGhJbmRleE5hbWVzVXJsKCksCiAgICAgICAgICAgIHRhcmdldDogIl9ibGFuayIKICAgICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgICAgICBpZDogInhwYWNrLnNuYXBzaG90UmVzdG9yZS5wb2xpY3lGb3JtLnN0ZXBMb2dpc3RpY3MucG9saWN5U25hcHNob3ROYW1lSGVscFRleHREb2NMaW5rIiwKICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJMZWFybiBtb3JlLiIKICAgICAgICAgIH0pKQogICAgICAgIH0KICAgICAgfSksCiAgICAgIGZ1bGxXaWR0aDogdHJ1ZQogICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZpZWxkVGV4dCwgewogICAgICBkZWZhdWx0VmFsdWU6IHBvbGljeS5zbmFwc2hvdE5hbWUsCiAgICAgIGZ1bGxXaWR0aDogdHJ1ZSwKICAgICAgb25DaGFuZ2U6IGZ1bmN0aW9uIG9uQ2hhbmdlKGUpIHsKICAgICAgICB1cGRhdGVQb2xpY3koewogICAgICAgICAgc25hcHNob3ROYW1lOiBlLnRhcmdldC52YWx1ZQogICAgICAgIH0sIHsKICAgICAgICAgIG1hbmFnZWRSZXBvc2l0b3J5OiBtYW5hZ2VkUmVwb3NpdG9yeSwKICAgICAgICAgIGlzRWRpdGluZzogaXNFZGl0aW5nLAogICAgICAgICAgcG9saWN5TmFtZTogcG9saWN5Lm5hbWUKICAgICAgICB9KTsKICAgICAgfSwKICAgICAgb25CbHVyOiBmdW5jdGlvbiBvbkJsdXIoKSB7CiAgICAgICAgcmV0dXJuIHNldFRvdWNoZWQoX29iamVjdFNwcmVhZCh7fSwgdG91Y2hlZCwgewogICAgICAgICAgc25hcHNob3ROYW1lOiB0cnVlCiAgICAgICAgfSkpOwogICAgICB9LAogICAgICBwbGFjZWhvbGRlcjogaTE4bi50cmFuc2xhdGUoJ3hwYWNrLnNuYXBzaG90UmVzdG9yZS5wb2xpY3lGb3JtLnN0ZXBMb2dpc3RpY3MucG9saWN5U25hcHNob3ROYW1lUGxhY2Vob2xkZXInLCB7CiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICc8ZGFpbHktc25hcC1cXHtub3cvZFxcfT4nLAogICAgICAgIGRlc2NyaXB0aW9uOiAnRXhhbXBsZSBkYXRlIG1hdGggc25hcHNob3QgbmFtZS4gS2VlcGluZyB0aGUgc2FtZSBzeW50YXggaXMgaW1wb3J0YW50OiA8U09NRS1UUkFOU0xBVElPTi17bm93L2R9PicKICAgICAgfSksCiAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJzbmFwc2hvdE5hbWVJbnB1dCIKICAgIH0pKSk7CiAgfTsKCiAgdmFyIHJlbmRlclNjaGVkdWxlRmllbGQgPSBmdW5jdGlvbiByZW5kZXJTY2hlZHVsZUZpZWxkKCkgewogICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlEZXNjcmliZWRGb3JtR3JvdXAsIHsKICAgICAgdGl0bGU6IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUaXRsZSwgewogICAgICAgIHNpemU6ICJzIgogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJoMyIsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAieHBhY2suc25hcHNob3RSZXN0b3JlLnBvbGljeUZvcm0uc3RlcExvZ2lzdGljcy5zY2hlZHVsZURlc2NyaXB0aW9uVGl0bGUiLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiU2NoZWR1bGUiCiAgICAgIH0pKSksCiAgICAgIGRlc2NyaXB0aW9uOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KEZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogInhwYWNrLnNuYXBzaG90UmVzdG9yZS5wb2xpY3lGb3JtLnN0ZXBMb2dpc3RpY3Muc2NoZWR1bGVEZXNjcmlwdGlvbiIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJUaGUgZnJlcXVlbmN5IGF0IHdoaWNoIHRvIHRha2UgdGhlIHNuYXBzaG90cy4iCiAgICAgIH0pLAogICAgICBpZEFyaWE6ICJwb2xpY3lTY2hlZHVsZURlc2NyaXB0aW9uIiwKICAgICAgZnVsbFdpZHRoOiB0cnVlCiAgICB9LCBpc0FkdmFuY2VkQ3JvblZpc2libGUgPyBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5GcmFnbWVudCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZvcm1Sb3csIHsKICAgICAgbGFiZWw6IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAieHBhY2suc25hcHNob3RSZXN0b3JlLnBvbGljeUZvcm0uc3RlcExvZ2lzdGljcy5wb2xpY3lTY2hlZHVsZUxhYmVsIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIlNjaGVkdWxlIgogICAgICB9KSwKICAgICAgZGVzY3JpYmVkQnlJZHM6IFsncG9saWN5U2NoZWR1bGVEZXNjcmlwdGlvbiddLAogICAgICBpc0ludmFsaWQ6IHRvdWNoZWQuc2NoZWR1bGUgJiYgQm9vbGVhbihlcnJvcnMuc2NoZWR1bGUpLAogICAgICBlcnJvcjogZXJyb3JzLnNjaGVkdWxlLAogICAgICBoZWxwVGV4dDogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChGb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJ4cGFjay5zbmFwc2hvdFJlc3RvcmUucG9saWN5Rm9ybS5zdGVwTG9naXN0aWNzLnBvbGljeVNjaGVkdWxlSGVscFRleHQiLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiVXNlIGNyb24gZXhwcmVzc2lvbi4ge2RvY0xpbmt9IiwKICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgIGRvY0xpbms6IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlMaW5rLCB7CiAgICAgICAgICAgIGhyZWY6IF9kb2N1bWVudGF0aW9uLmRvY3VtZW50YXRpb25MaW5rc1NlcnZpY2UuZ2V0Q3JvblVybCgpLAogICAgICAgICAgICB0YXJnZXQ6ICJfYmxhbmsiCiAgICAgICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KEZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICAgICAgaWQ6ICJ4cGFjay5zbmFwc2hvdFJlc3RvcmUucG9saWN5Rm9ybS5zdGVwTG9naXN0aWNzLnBvbGljeVNjaGVkdWxlSGVscFRleHREb2NMaW5rIiwKICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJMZWFybiBtb3JlLiIKICAgICAgICAgIH0pKQogICAgICAgIH0KICAgICAgfSksCiAgICAgIGZ1bGxXaWR0aDogdHJ1ZQogICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZpZWxkVGV4dCwgewogICAgICBkZWZhdWx0VmFsdWU6IHBvbGljeS5zY2hlZHVsZSwKICAgICAgZnVsbFdpZHRoOiB0cnVlLAogICAgICBvbkNoYW5nZTogZnVuY3Rpb24gb25DaGFuZ2UoZSkgewogICAgICAgIHVwZGF0ZVBvbGljeSh7CiAgICAgICAgICBzY2hlZHVsZTogZS50YXJnZXQudmFsdWUKICAgICAgICB9LCB7CiAgICAgICAgICBtYW5hZ2VkUmVwb3NpdG9yeTogbWFuYWdlZFJlcG9zaXRvcnksCiAgICAgICAgICBpc0VkaXRpbmc6IGlzRWRpdGluZywKICAgICAgICAgIHBvbGljeU5hbWU6IHBvbGljeS5uYW1lCiAgICAgICAgfSk7CiAgICAgIH0sCiAgICAgIG9uQmx1cjogZnVuY3Rpb24gb25CbHVyKCkgewogICAgICAgIHJldHVybiBzZXRUb3VjaGVkKF9vYmplY3RTcHJlYWQoe30sIHRvdWNoZWQsIHsKICAgICAgICAgIHNjaGVkdWxlOiB0cnVlCiAgICAgICAgfSkpOwogICAgICB9LAogICAgICBwbGFjZWhvbGRlcjogX2NvbnN0YW50cy5ERUZBVUxUX1BPTElDWV9TQ0hFRFVMRSwKICAgICAgImRhdGEtdGVzdC1zdWJqIjogImFkdmFuY2VkQ3JvbklucHV0IgogICAgfSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3BhY2VyLCB7CiAgICAgIHNpemU6ICJtIgogICAgfSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUZXh0LCB7CiAgICAgIHNpemU6ICJzIgogICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUxpbmssIHsKICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHsKICAgICAgICBzZXRJc0FkdmFuY2VkQ3JvblZpc2libGUoZmFsc2UpOwogICAgICAgIHVwZGF0ZVBvbGljeSh7CiAgICAgICAgICBzY2hlZHVsZTogc2ltcGxlQ3Jvbi5leHByZXNzaW9uCiAgICAgICAgfSwgewogICAgICAgICAgbWFuYWdlZFJlcG9zaXRvcnk6IG1hbmFnZWRSZXBvc2l0b3J5LAogICAgICAgICAgaXNFZGl0aW5nOiBpc0VkaXRpbmcsCiAgICAgICAgICBwb2xpY3lOYW1lOiBwb2xpY3kubmFtZQogICAgICAgIH0pOwogICAgICB9LAogICAgICAiZGF0YS10ZXN0LXN1YmoiOiAic2hvd0Jhc2ljQ3JvbkxpbmsiCiAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KEZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgaWQ6ICJ4cGFjay5zbmFwc2hvdFJlc3RvcmUucG9saWN5Rm9ybS5zdGVwTG9naXN0aWNzLnBvbGljeVNjaGVkdWxlQnV0dG9uQmFzaWNMYWJlbCIsCiAgICAgIGRlZmF1bHRNZXNzYWdlOiAiQ3JlYXRlIGJhc2ljIGludGVydmFsIgogICAgfSkpKSkgOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5GcmFnbWVudCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfc2hhcmVkX2ltcG9ydHMuQ3JvbkVkaXRvciwgewogICAgICBmaWVsZFRvUHJlZmVycmVkVmFsdWVNYXA6IGZpZWxkVG9QcmVmZXJyZWRWYWx1ZU1hcCwKICAgICAgY3JvbkV4cHJlc3Npb246IHNpbXBsZUNyb24uZXhwcmVzc2lvbiwKICAgICAgZnJlcXVlbmN5OiBzaW1wbGVDcm9uLmZyZXF1ZW5jeSwKICAgICAgb25DaGFuZ2U6IGZ1bmN0aW9uIG9uQ2hhbmdlKF9yZWYzKSB7CiAgICAgICAgdmFyIGV4cHJlc3Npb24gPSBfcmVmMy5jcm9uRXhwcmVzc2lvbiwKICAgICAgICAgICAgZnJlcXVlbmN5ID0gX3JlZjMuZnJlcXVlbmN5LAogICAgICAgICAgICBuZXdGaWVsZFRvUHJlZmVycmVkVmFsdWVNYXAgPSBfcmVmMy5maWVsZFRvUHJlZmVycmVkVmFsdWVNYXA7CiAgICAgICAgc2V0U2ltcGxlQ3Jvbih7CiAgICAgICAgICBleHByZXNzaW9uOiBleHByZXNzaW9uLAogICAgICAgICAgZnJlcXVlbmN5OiBmcmVxdWVuY3kKICAgICAgICB9KTsKICAgICAgICBzZXRGaWVsZFRvUHJlZmVycmVkVmFsdWVNYXAobmV3RmllbGRUb1ByZWZlcnJlZFZhbHVlTWFwKTsKICAgICAgICB1cGRhdGVQb2xpY3koewogICAgICAgICAgc2NoZWR1bGU6IGV4cHJlc3Npb24KICAgICAgICB9LCB7CiAgICAgICAgICBtYW5hZ2VkUmVwb3NpdG9yeTogbWFuYWdlZFJlcG9zaXRvcnksCiAgICAgICAgICBpc0VkaXRpbmc6IGlzRWRpdGluZywKICAgICAgICAgIHBvbGljeU5hbWU6IHBvbGljeS5uYW1lCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0pLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3BhY2VyLCB7CiAgICAgIHNpemU6ICJzIgogICAgfSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUZXh0LCB7CiAgICAgIHNpemU6ICJzIgogICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUxpbmssIHsKICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHsKICAgICAgICBzZXRJc0FkdmFuY2VkQ3JvblZpc2libGUodHJ1ZSk7CiAgICAgIH0sCiAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJzaG93QWR2YW5jZWRDcm9uTGluayIKICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICBpZDogInhwYWNrLnNuYXBzaG90UmVzdG9yZS5wb2xpY3lGb3JtLnN0ZXBMb2dpc3RpY3MucG9saWN5U2NoZWR1bGVCdXR0b25BZHZhbmNlZExhYmVsIiwKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJDcmVhdGUgY3JvbiBleHByZXNzaW9uIgogICAgfSkpKSkpOwogIH07CgogIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5GcmFnbWVudCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhHcm91cCwgewogICAganVzdGlmeUNvbnRlbnQ6ICJzcGFjZUJldHdlZW4iCiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICBncm93OiBmYWxzZQogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUaXRsZSwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgiaDIiLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KEZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgIGlkOiAieHBhY2suc25hcHNob3RSZXN0b3JlLnBvbGljeUZvcm0uc3RlcExvZ2lzdGljc1RpdGxlIiwKICAgIGRlZmF1bHRNZXNzYWdlOiAiTG9naXN0aWNzIgogIH0pKSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgIGdyb3c6IGZhbHNlCiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUJ1dHRvbkVtcHR5LCB7CiAgICBzaXplOiAicyIsCiAgICBmbHVzaDogInJpZ2h0IiwKICAgIGhyZWY6IF9kb2N1bWVudGF0aW9uLmRvY3VtZW50YXRpb25MaW5rc1NlcnZpY2UuZ2V0U2xtVXJsKCksCiAgICB0YXJnZXQ6ICJfYmxhbmsiLAogICAgaWNvblR5cGU6ICJoZWxwIgogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoRm9ybWF0dGVkTWVzc2FnZSwgewogICAgaWQ6ICJ4cGFjay5zbmFwc2hvdFJlc3RvcmUucG9saWN5Rm9ybS5zdGVwTG9naXN0aWNzLmRvY3NCdXR0b25MYWJlbCIsCiAgICBkZWZhdWx0TWVzc2FnZTogIkxvZ2lzdGljcyBkb2NzIgogIH0pKSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3BhY2VyLCB7CiAgICBzaXplOiAibCIKICB9KSwgcmVuZGVyTmFtZUZpZWxkKCksIHJlbmRlclNuYXBzaG90TmFtZUZpZWxkKCksIHJlbmRlclJlcG9zaXRvcnlGaWVsZCgpLCByZW5kZXJTY2hlZHVsZUZpZWxkKCkpOwp9OwoKZXhwb3J0cy5Qb2xpY3lTdGVwTG9naXN0aWNzID0gUG9saWN5U3RlcExvZ2lzdGljczs="},null]}