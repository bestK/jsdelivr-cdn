{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/legacy/ui/public/agg_types/agg_config.js","dependencies":[{"path":"src/legacy/ui/public/agg_types/agg_config.js","mtime":1585205040735},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkFnZ0NvbmZpZyA9IHZvaWQgMDsKCnZhciBfbG9kYXNoID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJsb2Rhc2giKSk7Cgp2YXIgX2kxOG4gPSByZXF1aXJlKCJAa2JuL2kxOG4iKTsKCnZhciBfbmV3X3BsYXRmb3JtID0gcmVxdWlyZSgidWkvbmV3X3BsYXRmb3JtIik7Cgp2YXIgX2FnZ19ncm91cHMgPSByZXF1aXJlKCIuLi92aXMvZWRpdG9ycy9kZWZhdWx0L2FnZ19ncm91cHMiKTsKCnZhciBfYWdnX3BhcmFtcyA9IHJlcXVpcmUoIi4vYWdnX3BhcmFtcyIpOwoKdmFyIF9wdWJsaWMgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9wbHVnaW5zL2RhdGEvcHVibGljIik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgewogIHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7CiAgICBkZWZhdWx0OiBvYmoKICB9Owp9CgpmdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7CiAgcmV0dXJuIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfbm9uSXRlcmFibGVTcHJlYWQoKTsKfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlU3ByZWFkKCkgewogIHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7Cn0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXkoaXRlcikgewogIGlmIChTeW1ib2wuaXRlcmF0b3IgaW4gT2JqZWN0KGl0ZXIpIHx8IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChpdGVyKSA9PT0gIltvYmplY3QgQXJndW1lbnRzXSIpIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpOwp9CgpmdW5jdGlvbiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgewogICAgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkoYXJyLmxlbmd0aCk7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHsKICAgICAgYXJyMltpXSA9IGFycltpXTsKICAgIH0KCiAgICByZXR1cm4gYXJyMjsKICB9Cn0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsKICBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7CiAgfQp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgewogICAgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsKICAgIGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsKICAgIGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsKICAgIGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOwogIH0KfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgewogIGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOwogIGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsKICByZXR1cm4gQ29uc3RydWN0b3I7Cn0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsKICBpZiAoa2V5IGluIG9iaikgewogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7CiAgICAgIHZhbHVlOiB2YWx1ZSwKICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICB3cml0YWJsZTogdHJ1ZQogICAgfSk7CiAgfSBlbHNlIHsKICAgIG9ialtrZXldID0gdmFsdWU7CiAgfQoKICByZXR1cm4gb2JqOwp9Cgp2YXIgdW5rbm93blNjaGVtYSA9IHsKICBuYW1lOiAndW5rbm93bicsCiAgdGl0bGU6ICdVbmtub3duJywKICBoaWRlQ3VzdG9tTGFiZWw6IHRydWUsCiAgYWdnRmlsdGVyOiBbXSwKICBtaW46IDEsCiAgbWF4OiAxLAogIHBhcmFtczogW10sCiAgZGVmYXVsdHM6IHt9LAogIGVkaXRvcjogZmFsc2UsCiAgZ3JvdXA6IF9hZ2dfZ3JvdXBzLkFnZ0dyb3VwTmFtZXMuTWV0cmljcwp9OwoKdmFyIGdldFR5cGVGcm9tUmVnaXN0cnkgPSBmdW5jdGlvbiBnZXRUeXBlRnJvbVJlZ2lzdHJ5KHR5cGUpIHsKICAvLyBXZSBuZWVkIHRvIGlubGluZSByZXF1aXJlIGhlcmUsIHNpbmNlIHdlJ3JlIGhhdmluZyBhIGN5Y2xpYyBkZXBlbmRlbmN5CiAgLy8gZnJvbSBzb21ld2hlcmUgaW5zaWRlIGFnZ190eXBlcyBiYWNrIHRvIEFnZ0NvbmZpZy4KICB2YXIgYWdnVHlwZXMgPSByZXF1aXJlKCcuLi9hZ2dfdHlwZXMnKS5hZ2dUeXBlczsKCiAgdmFyIHJlZ2lzdGVyZWRUeXBlID0gYWdnVHlwZXMubWV0cmljcy5maW5kKGZ1bmN0aW9uIChhZ2cpIHsKICAgIHJldHVybiBhZ2cubmFtZSA9PT0gdHlwZTsKICB9KSB8fCBhZ2dUeXBlcy5idWNrZXRzLmZpbmQoZnVuY3Rpb24gKGFnZykgewogICAgcmV0dXJuIGFnZy5uYW1lID09PSB0eXBlOwogIH0pOwoKICBpZiAoIXJlZ2lzdGVyZWRUeXBlKSB7CiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Vua25vd24gdHlwZScpOwogIH0KCiAgcmV0dXJuIHJlZ2lzdGVyZWRUeXBlOwp9OwoKdmFyIGdldFNjaGVtYUZyb21SZWdpc3RyeSA9IGZ1bmN0aW9uIGdldFNjaGVtYUZyb21SZWdpc3RyeShzY2hlbWFzLCBzY2hlbWEpIHsKICB2YXIgcmVnaXN0ZXJlZFNjaGVtYSA9IHNjaGVtYXMgPyBzY2hlbWFzLmJ5TmFtZVtzY2hlbWFdIDogbnVsbDsKCiAgaWYgKCFyZWdpc3RlcmVkU2NoZW1hKSB7CiAgICByZWdpc3RlcmVkU2NoZW1hID0gT2JqZWN0LmFzc2lnbih7fSwgdW5rbm93blNjaGVtYSk7CiAgICByZWdpc3RlcmVkU2NoZW1hLm5hbWUgPSBzY2hlbWE7CiAgfQoKICByZXR1cm4gcmVnaXN0ZXJlZFNjaGVtYTsKfTsKCnZhciBBZ2dDb25maWcgPQovKiNfX1BVUkVfXyovCmZ1bmN0aW9uICgpIHsKICBfY3JlYXRlQ2xhc3MoQWdnQ29uZmlnLCBudWxsLCBbewogICAga2V5OiAiZW5zdXJlSWRzIiwKCiAgICAvKioKICAgICAqIEVuc3VyZSB0aGF0IGFsbCBvZiB0aGUgb2JqZWN0cyBpbiB0aGUgbGlzdCBoYXZlIGlkcywgdGhlIG9iamVjdHMKICAgICAqIGFuZCBsaXN0IGFyZSBtb2RpZmllZCBieSByZWZlcmVuY2UuCiAgICAgKgogICAgICogQHBhcmFtICB7YXJyYXlbb2JqZWN0XX0gbGlzdCAtIGEgbGlzdCBvZiBvYmplY3RzLCBvYmplY3RzIGNhbiBiZSBhbnl0aGluZyByZWFsbHkKICAgICAqIEByZXR1cm4ge2FycmF5fSAtIHRoZSBsaXN0IHRoYXQgd2FzIHBhc3NlZCBpbgogICAgICovCiAgICB2YWx1ZTogZnVuY3Rpb24gZW5zdXJlSWRzKGxpc3QpIHsKICAgICAgdmFyIGhhdmUgPSBbXTsKICAgICAgdmFyIGhhdmVOb3QgPSBbXTsKICAgICAgbGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChvYmopIHsKICAgICAgICAob2JqLmlkID8gaGF2ZSA6IGhhdmVOb3QpLnB1c2gob2JqKTsKICAgICAgfSk7CiAgICAgIHZhciBuZXh0SWQgPSBBZ2dDb25maWcubmV4dElkKGhhdmUpOwogICAgICBoYXZlTm90LmZvckVhY2goZnVuY3Rpb24gKG9iaikgewogICAgICAgIG9iai5pZCA9IFN0cmluZyhuZXh0SWQrKyk7CiAgICAgIH0pOwogICAgICByZXR1cm4gbGlzdDsKICAgIH0KICAgIC8qKgogICAgICogQ2FsY3VsYXRlIHRoZSBuZXh0IGlkIGJhc2VkIG9uIHRoZSBpZHMgaW4gdGhpcyBsaXN0CiAgICAgKgogICAgICogQHJldHVybiB7YXJyYXl9IGxpc3QgLSBhIGxpc3Qgb2Ygb2JqZWN0cyB3aXRoIGlkIHByb3BlcnRpZXMKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJuZXh0SWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG5leHRJZChsaXN0KSB7CiAgICAgIHJldHVybiAxICsgbGlzdC5yZWR1Y2UoZnVuY3Rpb24gKG1heCwgb2JqKSB7CiAgICAgICAgcmV0dXJuIE1hdGgubWF4KG1heCwgK29iai5pZCB8fCAwKTsKICAgICAgfSwgMCk7CiAgICB9CiAgfV0pOwoKICBmdW5jdGlvbiBBZ2dDb25maWcoYWdnQ29uZmlncywgb3B0cykgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEFnZ0NvbmZpZyk7CgogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICJhZ2dDb25maWdzIiwgdm9pZCAwKTsKCiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgImlkIiwgdm9pZCAwKTsKCiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgImVuYWJsZWQiLCB2b2lkIDApOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAicGFyYW1zIiwgdm9pZCAwKTsKCiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgInBhcmVudCIsIHZvaWQgMCk7CgogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICJfX3NjaGVtYSIsIHZvaWQgMCk7CgogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICJfX3R5cGUiLCB2b2lkIDApOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiX190eXBlRGVjb3JhdGlvbnMiLCB2b2lkIDApOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAic3ViQWdncyIsIFtdKTsKCiAgICB0aGlzLmFnZ0NvbmZpZ3MgPSBhZ2dDb25maWdzOwogICAgdGhpcy5pZCA9IFN0cmluZyhvcHRzLmlkIHx8IEFnZ0NvbmZpZy5uZXh0SWQoYWdnQ29uZmlncy5hZ2dzKSk7CiAgICB0aGlzLmVuYWJsZWQgPSB0eXBlb2Ygb3B0cy5lbmFibGVkID09PSAnYm9vbGVhbicgPyBvcHRzLmVuYWJsZWQgOiB0cnVlOyAvLyBzdGFydCB3aXRoIGVtcHR5IHBhcmFtcyBzbyB0aGF0IGNoZWNrcyBpbiB0eXBlL3NjaGVtYSBzZXR0ZXJzIGRvbid0IGZyZWFrCiAgICAvLyBiZWNhdXNlIHRoaXMucGFyYW1zIGlzIHVuZGVmaW5lZAoKICAgIHRoaXMucGFyYW1zID0ge307IC8vIHNldHRlcnMKCiAgICB0aGlzLnNldFR5cGUob3B0cy50eXBlKTsKCiAgICBpZiAob3B0cy5zY2hlbWEpIHsKICAgICAgdGhpcy5zZXRTY2hlbWEob3B0cy5zY2hlbWEpOwogICAgfSAvLyBzZXQgdGhlIHBhcmFtcyB0byB0aGUgdmFsdWVzIGZyb20gb3B0cywgb3IganVzdCB0byB0aGUgZGVmYXVsdHMKCgogICAgdGhpcy5zZXRQYXJhbXMob3B0cy5wYXJhbXMgfHwge30pOyAvLyBAdHMtaWdub3JlCgogICAgdGhpcy5fX3R5cGUgPSB0aGlzLl9fdHlwZTsgLy8gQHRzLWlnbm9yZQoKICAgIHRoaXMuX19zY2hlbWEgPSB0aGlzLl9fc2NoZW1hOwogIH0KICAvKioKICAgKiBXcml0ZSB0aGUgY3VycmVudCB2YWx1ZXMgdG8gdGhpcy5wYXJhbXMsIGZpbGxpbmcgaW4gdGhlIGRlZmF1bHRzIGFzIHdlIGdvCiAgICoKICAgKiBAcGFyYW0gIHtvYmplY3R9IFtmcm9tXSAtIG9wdGlvbmFsIG9iamVjdCB0byByZWFkIHZhbHVlcyBmcm9tLAogICAqICAgICAgICAgICAgICAgICAgICAgICAgIHVzZWQgd2hlbiBpbml0aWFsaXppbmcKICAgKiBAcmV0dXJuIHt1bmRlZmluZWR9CiAgICovCgoKICBfY3JlYXRlQ2xhc3MoQWdnQ29uZmlnLCBbewogICAga2V5OiAic2V0UGFyYW1zIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRQYXJhbXMoZnJvbSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgZnJvbSA9IGZyb20gfHwgdGhpcy5wYXJhbXMgfHwge307CiAgICAgIHZhciB0byA9IHRoaXMucGFyYW1zID0ge307CiAgICAgIHRoaXMuZ2V0QWdnUGFyYW1zKCkuZm9yRWFjaChmdW5jdGlvbiAoYWdnUGFyYW0pIHsKICAgICAgICB2YXIgdmFsID0gZnJvbVthZ2dQYXJhbS5uYW1lXTsKCiAgICAgICAgaWYgKHZhbCA9PSBudWxsKSB7CiAgICAgICAgICBpZiAoYWdnUGFyYW0uZGVmYXVsdCA9PSBudWxsKSByZXR1cm47CgogICAgICAgICAgaWYgKCFfbG9kYXNoLmRlZmF1bHQuaXNGdW5jdGlvbihhZ2dQYXJhbS5kZWZhdWx0KSkgewogICAgICAgICAgICB2YWwgPSBhZ2dQYXJhbS5kZWZhdWx0OwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdmFsID0gYWdnUGFyYW0uZGVmYXVsdChfdGhpcyk7CiAgICAgICAgICAgIGlmICh2YWwgPT0gbnVsbCkgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKGFnZ1BhcmFtLmRlc2VyaWFsaXplKSB7CiAgICAgICAgICB2YXIgaXNUeXBlZCA9IF9sb2Rhc2guZGVmYXVsdC5pc0Z1bmN0aW9uKGFnZ1BhcmFtLnZhbHVlVHlwZSk7CgogICAgICAgICAgdmFyIGlzVHlwZSA9IGlzVHlwZWQgJiYgdmFsIGluc3RhbmNlb2YgYWdnUGFyYW0udmFsdWVUeXBlOwoKICAgICAgICAgIHZhciBpc09iamVjdCA9ICFpc1R5cGVkICYmIF9sb2Rhc2guZGVmYXVsdC5pc09iamVjdCh2YWwpOwoKICAgICAgICAgIHZhciBpc0Rlc2VyaWFsaXplZCA9IGlzVHlwZSB8fCBpc09iamVjdDsKCiAgICAgICAgICBpZiAoIWlzRGVzZXJpYWxpemVkKSB7CiAgICAgICAgICAgIHZhbCA9IGFnZ1BhcmFtLmRlc2VyaWFsaXplKHZhbCwgX3RoaXMpOwogICAgICAgICAgfQoKICAgICAgICAgIHRvW2FnZ1BhcmFtLm5hbWVdID0gdmFsOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdG9bYWdnUGFyYW0ubmFtZV0gPSBfbG9kYXNoLmRlZmF1bHQuY2xvbmVEZWVwKHZhbCk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogImdldFBhcmFtIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRQYXJhbShrZXkpIHsKICAgICAgcmV0dXJuIF9sb2Rhc2guZGVmYXVsdC5nZXQodGhpcy5wYXJhbXMsIGtleSk7CiAgICB9CiAgfSwgewogICAga2V5OiAid3JpdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHdyaXRlKGFnZ3MpIHsKICAgICAgcmV0dXJuICgwLCBfYWdnX3BhcmFtcy53cml0ZVBhcmFtcykodGhpcy50eXBlLnBhcmFtcywgdGhpcywgYWdncyk7CiAgICB9CiAgfSwgewogICAga2V5OiAiaXNGaWx0ZXJhYmxlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpc0ZpbHRlcmFibGUoKSB7CiAgICAgIHJldHVybiBfbG9kYXNoLmRlZmF1bHQuaXNGdW5jdGlvbih0aGlzLnR5cGUuY3JlYXRlRmlsdGVyKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjcmVhdGVGaWx0ZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZUZpbHRlcihrZXkpIHsKICAgICAgdmFyIHBhcmFtcyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307CiAgICAgIHZhciBjcmVhdGVGaWx0ZXIgPSB0aGlzLnR5cGUuY3JlYXRlRmlsdGVyOwoKICAgICAgaWYgKCFjcmVhdGVGaWx0ZXIpIHsKICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJUaGUgXCIiLmNvbmNhdCh0aGlzLnR5cGUudGl0bGUsICJcIiBhZ2dyZWdhdGlvbiBkb2VzIG5vdCBzdXBwb3J0IGZpbHRlcmluZy4iKSk7CiAgICAgIH0KCiAgICAgIHZhciBmaWVsZCA9IHRoaXMuZ2V0RmllbGQoKTsKICAgICAgdmFyIGxhYmVsID0gdGhpcy5nZXRGaWVsZERpc3BsYXlOYW1lKCk7CgogICAgICBpZiAoZmllbGQgJiYgIWZpZWxkLmZpbHRlcmFibGUpIHsKICAgICAgICB2YXIgbWVzc2FnZSA9ICJUaGUgXCIiLmNvbmNhdChsYWJlbCwgIlwiIGZpZWxkIGNhbiBub3QgYmUgdXNlZCBmb3IgZmlsdGVyaW5nLiIpOwoKICAgICAgICBpZiAoZmllbGQuc2NyaXB0ZWQpIHsKICAgICAgICAgIG1lc3NhZ2UgPSAiVGhlIFwiIi5jb25jYXQobGFiZWwsICJcIiBmaWVsZCBpcyBzY3JpcHRlZCBhbmQgY2FuIG5vdCBiZSB1c2VkIGZvciBmaWx0ZXJpbmcuIik7CiAgICAgICAgfQoKICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKG1lc3NhZ2UpOwogICAgICB9CgogICAgICByZXR1cm4gY3JlYXRlRmlsdGVyKHRoaXMsIGtleSwgcGFyYW1zKTsKICAgIH0KICAgIC8qKgogICAgICogIEhvb2sgZm9yIHByZS1mbGlnaHQgbG9naWMsIHNlZSBBZ2dUeXBlI29uU2VhcmNoUmVxdWVzdFN0YXJ0CiAgICAgKiAgQHBhcmFtIHtDb3VyaWVyLlNlYXJjaFNvdXJjZX0gc2VhcmNoU291cmNlCiAgICAgKiAgQHBhcmFtIHtDb3VyaWVyLkZldGNoT3B0aW9uc30gb3B0aW9ucwogICAgICogIEByZXR1cm4ge1Byb21pc2U8dW5kZWZpbmVkPn0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJvblNlYXJjaFJlcXVlc3RTdGFydCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25TZWFyY2hSZXF1ZXN0U3RhcnQoc2VhcmNoU291cmNlLCBvcHRpb25zKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgaWYgKCF0aGlzLnR5cGUpIHsKICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7CiAgICAgIH0KCiAgICAgIHJldHVybiBQcm9taXNlLmFsbCh0aGlzLnR5cGUucGFyYW1zLm1hcChmdW5jdGlvbiAocGFyYW0pIHsKICAgICAgICByZXR1cm4gcGFyYW0ubW9kaWZ5QWdnQ29uZmlnT25TZWFyY2hSZXF1ZXN0U3RhcnQoX3RoaXMyLCBzZWFyY2hTb3VyY2UsIG9wdGlvbnMpOwogICAgICB9KSk7CiAgICB9CiAgICAvKioKICAgICAqIENvbnZlcnQgdGhpcyBhZ2dDb25maWcgdG8gaXRzIGRzbCBzeW50YXguCiAgICAgKgogICAgICogQWRkcyBwYXJhbXMgYW5kIGFkaG9jIHN1YmFnZ3MgdG8gYSBwb2pvLCB0aGVuIHJldHVybnMgaXQKICAgICAqCiAgICAgKiBAcGFyYW0gIHtBZ2dDb25maWdzfSBhZ2dDb25maWdzIC0gdGhlIGNvbmZpZyBvYmplY3QgdG8gY29udmVydAogICAgICogQHJldHVybiB7dm9pZHxPYmplY3R9IC0gaWYgdGhlIGNvbmZpZyBoYXMgYSBkc2wgcmVwcmVzZW50YXRpb24sIGl0IGlzCiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5lZCwgZWxzZSB1bmRlZmluZWQgaXMgcmV0dXJuZWQKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJ0b0RzbCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdG9Ec2woYWdnQ29uZmlncykgewogICAgICBpZiAodGhpcy50eXBlLmhhc05vRHNsKSByZXR1cm47CiAgICAgIHZhciBvdXRwdXQgPSB0aGlzLndyaXRlKGFnZ0NvbmZpZ3MpOwogICAgICB2YXIgY29uZmlnRHNsID0ge307CiAgICAgIGNvbmZpZ0RzbFt0aGlzLnR5cGUuZHNsTmFtZSB8fCB0aGlzLnR5cGUubmFtZV0gPSBvdXRwdXQucGFyYW1zOyAvLyBpZiB0aGUgY29uZmlnIHJlcXVpcmVzIHN1YkFnZ3MsIHdyaXRlIHRoZW0gdG8gdGhlIGRzbCBhcyB3ZWxsCgogICAgICBpZiAodGhpcy5zdWJBZ2dzLmxlbmd0aCAmJiAhb3V0cHV0LnN1YkFnZ3MpIG91dHB1dC5zdWJBZ2dzID0gdGhpcy5zdWJBZ2dzOwoKICAgICAgaWYgKG91dHB1dC5zdWJBZ2dzKSB7CiAgICAgICAgdmFyIHN1YkRzbEx2bCA9IGNvbmZpZ0RzbC5hZ2dzIHx8IChjb25maWdEc2wuYWdncyA9IHt9KTsKICAgICAgICBvdXRwdXQuc3ViQWdncy5mb3JFYWNoKGZ1bmN0aW9uIG5lc3RBZGhvY1N1YkFnZ3Moc3ViQWdnQ29uZmlnKSB7CiAgICAgICAgICBzdWJEc2xMdmxbc3ViQWdnQ29uZmlnLmlkXSA9IHN1YkFnZ0NvbmZpZy50b0RzbChhZ2dDb25maWdzKTsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgaWYgKG91dHB1dC5wYXJlbnRBZ2dzKSB7CiAgICAgICAgdmFyIF9zdWJEc2xMdmwgPSBjb25maWdEc2wucGFyZW50QWdncyB8fCAoY29uZmlnRHNsLnBhcmVudEFnZ3MgPSB7fSk7CgogICAgICAgIG91dHB1dC5wYXJlbnRBZ2dzLmZvckVhY2goZnVuY3Rpb24gbmVzdEFkaG9jU3ViQWdncyhzdWJBZ2dDb25maWcpIHsKICAgICAgICAgIF9zdWJEc2xMdmxbc3ViQWdnQ29uZmlnLmlkXSA9IHN1YkFnZ0NvbmZpZy50b0RzbChhZ2dDb25maWdzKTsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgcmV0dXJuIGNvbmZpZ0RzbDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJ0b0pTT04iLAogICAgdmFsdWU6IGZ1bmN0aW9uIHRvSlNPTigpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICB2YXIgcGFyYW1zID0gdGhpcy5wYXJhbXM7CgogICAgICB2YXIgb3V0UGFyYW1zID0gX2xvZGFzaC5kZWZhdWx0LnRyYW5zZm9ybSh0aGlzLmdldEFnZ1BhcmFtcygpLCBmdW5jdGlvbiAob3V0LCBhZ2dQYXJhbSkgewogICAgICAgIHZhciB2YWwgPSBwYXJhbXNbYWdnUGFyYW0ubmFtZV07IC8vIGRvbid0IHNlcmlhbGl6ZSB1bmRlZmluZWQvbnVsbCB2YWx1ZXMKCiAgICAgICAgaWYgKHZhbCA9PSBudWxsKSByZXR1cm47CiAgICAgICAgaWYgKGFnZ1BhcmFtLnNlcmlhbGl6ZSkgdmFsID0gYWdnUGFyYW0uc2VyaWFsaXplKHZhbCwgX3RoaXMzKTsKICAgICAgICBpZiAodmFsID09IG51bGwpIHJldHVybjsgLy8gdG8gcHJldmVudCBhY2NpZGVudGFsIGxlYWtpbmcsIHdlIHdpbGwgY2xvbmUgYWxsIGNvbXBsZXggdmFsdWVzCgogICAgICAgIG91dFthZ2dQYXJhbS5uYW1lXSA9IF9sb2Rhc2guZGVmYXVsdC5jbG9uZURlZXAodmFsKTsKICAgICAgfSwge30pOwoKICAgICAgcmV0dXJuIHsKICAgICAgICBpZDogdGhpcy5pZCwKICAgICAgICBlbmFibGVkOiB0aGlzLmVuYWJsZWQsCiAgICAgICAgdHlwZTogdGhpcy50eXBlICYmIHRoaXMudHlwZS5uYW1lLAogICAgICAgIHNjaGVtYTogX2xvZGFzaC5kZWZhdWx0LmdldCh0aGlzLCAnc2NoZW1hLm5hbWUnLCB0aGlzLnNjaGVtYSksCiAgICAgICAgcGFyYW1zOiBvdXRQYXJhbXMKICAgICAgfTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRBZ2dQYXJhbXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEFnZ1BhcmFtcygpIHsKICAgICAgcmV0dXJuIFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkoX2xvZGFzaC5kZWZhdWx0Lmhhcyh0aGlzLCAndHlwZS5wYXJhbXMnKSA/IHRoaXMudHlwZS5wYXJhbXMgOiBbXSksIF90b0NvbnN1bWFibGVBcnJheShfbG9kYXNoLmRlZmF1bHQuaGFzKHRoaXMsICdzY2hlbWEucGFyYW1zJykgPyB0aGlzLnNjaGVtYS5wYXJhbXMgOiBbXSkpOwogICAgfQogIH0sIHsKICAgIGtleTogImdldFJlcXVlc3RBZ2dzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRSZXF1ZXN0QWdncygpIHsKICAgICAgcmV0dXJuIHRoaXMudHlwZSAmJiB0aGlzLnR5cGUuZ2V0UmVxdWVzdEFnZ3ModGhpcykgfHwgW3RoaXNdOwogICAgfQogIH0sIHsKICAgIGtleTogImdldFJlc3BvbnNlQWdncyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0UmVzcG9uc2VBZ2dzKCkgewogICAgICByZXR1cm4gdGhpcy50eXBlICYmIHRoaXMudHlwZS5nZXRSZXNwb25zZUFnZ3ModGhpcykgfHwgW3RoaXNdOwogICAgfQogIH0sIHsKICAgIGtleTogImdldFZhbHVlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRWYWx1ZShidWNrZXQpIHsKICAgICAgcmV0dXJuIHRoaXMudHlwZS5nZXRWYWx1ZSh0aGlzLCBidWNrZXQpOwogICAgfQogIH0sIHsKICAgIGtleTogImdldEtleSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0S2V5KGJ1Y2tldCwga2V5KSB7CiAgICAgIGlmICh0aGlzLnR5cGUuZ2V0S2V5KSB7CiAgICAgICAgcmV0dXJuIHRoaXMudHlwZS5nZXRLZXkoYnVja2V0LCBrZXksIHRoaXMpOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiAnJzsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogImdldEZpZWxkRGlzcGxheU5hbWUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEZpZWxkRGlzcGxheU5hbWUoKSB7CiAgICAgIHZhciBmaWVsZCA9IHRoaXMuZ2V0RmllbGQoKTsKICAgICAgcmV0dXJuIGZpZWxkID8gZmllbGQuZGlzcGxheU5hbWUgfHwgdGhpcy5maWVsZE5hbWUoKSA6ICcnOwogICAgfQogIH0sIHsKICAgIGtleTogImdldEZpZWxkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRGaWVsZCgpIHsKICAgICAgcmV0dXJuIHRoaXMucGFyYW1zLmZpZWxkOwogICAgfQogIH0sIHsKICAgIGtleTogIm1ha2VMYWJlbCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbWFrZUxhYmVsKCkgewogICAgICB2YXIgcGVyY2VudGFnZU1vZGUgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IGZhbHNlOwoKICAgICAgaWYgKHRoaXMucGFyYW1zLmN1c3RvbUxhYmVsKSB7CiAgICAgICAgcmV0dXJuIHRoaXMucGFyYW1zLmN1c3RvbUxhYmVsOwogICAgICB9CgogICAgICBpZiAoIXRoaXMudHlwZSkgcmV0dXJuICcnOwogICAgICByZXR1cm4gcGVyY2VudGFnZU1vZGUgPyBfaTE4bi5pMThuLnRyYW5zbGF0ZSgnY29tbW9uLnVpLnZpcy5hZ2dDb25maWcucGVyY2VudGFnZU9mTGFiZWwnLCB7CiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdQZXJjZW50YWdlIG9mIHtsYWJlbH0nLAogICAgICAgIHZhbHVlczogewogICAgICAgICAgbGFiZWw6IHRoaXMudHlwZS5tYWtlTGFiZWwodGhpcykKICAgICAgICB9CiAgICAgIH0pIDogIiIuY29uY2F0KHRoaXMudHlwZS5tYWtlTGFiZWwodGhpcykpOwogICAgfQogIH0sIHsKICAgIGtleTogImdldEluZGV4UGF0dGVybiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0SW5kZXhQYXR0ZXJuKCkgewogICAgICByZXR1cm4gdGhpcy5hZ2dDb25maWdzLmluZGV4UGF0dGVybjsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRUaW1lUmFuZ2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFRpbWVSYW5nZSgpIHsKICAgICAgcmV0dXJuIHRoaXMuYWdnQ29uZmlncy50aW1lUmFuZ2U7CiAgICB9CiAgfSwgewogICAga2V5OiAiZmllbGRGb3JtYXR0ZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZpZWxkRm9ybWF0dGVyKGNvbnRlbnRUeXBlLCBkZWZhdWx0Rm9ybWF0KSB7CiAgICAgIHZhciBmb3JtYXQgPSB0aGlzLnR5cGUgJiYgdGhpcy50eXBlLmdldEZvcm1hdCh0aGlzKTsKCiAgICAgIGlmIChmb3JtYXQpIHsKICAgICAgICByZXR1cm4gZm9ybWF0LmdldENvbnZlcnRlckZvcihjb250ZW50VHlwZSk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzLmZpZWxkT3duRm9ybWF0dGVyKGNvbnRlbnRUeXBlLCBkZWZhdWx0Rm9ybWF0KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJmaWVsZE93bkZvcm1hdHRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZmllbGRPd25Gb3JtYXR0ZXIoY29udGVudFR5cGUsIGRlZmF1bHRGb3JtYXQpIHsKICAgICAgdmFyIGZpZWxkRm9ybWF0cyA9IF9uZXdfcGxhdGZvcm0ubnBTdGFydC5wbHVnaW5zLmRhdGEuZmllbGRGb3JtYXRzOwogICAgICB2YXIgZmllbGQgPSB0aGlzLmdldEZpZWxkKCk7CiAgICAgIHZhciBmb3JtYXQgPSBmaWVsZCAmJiBmaWVsZC5mb3JtYXQ7CiAgICAgIGlmICghZm9ybWF0KSBmb3JtYXQgPSBkZWZhdWx0Rm9ybWF0OwogICAgICBpZiAoIWZvcm1hdCkgZm9ybWF0ID0gZmllbGRGb3JtYXRzLmdldERlZmF1bHRJbnN0YW5jZShfcHVibGljLktCTl9GSUVMRF9UWVBFUy5TVFJJTkcpOwogICAgICByZXR1cm4gZm9ybWF0LmdldENvbnZlcnRlckZvcihjb250ZW50VHlwZSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZmllbGROYW1lIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBmaWVsZE5hbWUoKSB7CiAgICAgIHZhciBmaWVsZCA9IHRoaXMuZ2V0RmllbGQoKTsKICAgICAgcmV0dXJuIGZpZWxkID8gZmllbGQubmFtZSA6ICcnOwogICAgfQogIH0sIHsKICAgIGtleTogImZpZWxkSXNUaW1lRmllbGQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZpZWxkSXNUaW1lRmllbGQoKSB7CiAgICAgIHZhciBpbmRleFBhdHRlcm4gPSB0aGlzLmdldEluZGV4UGF0dGVybigpOwogICAgICBpZiAoIWluZGV4UGF0dGVybikgcmV0dXJuIGZhbHNlOyAvLyBAdHMtaWdub3JlCgogICAgICB2YXIgdGltZUZpZWxkTmFtZSA9IGluZGV4UGF0dGVybi50aW1lRmllbGROYW1lOwogICAgICByZXR1cm4gdGltZUZpZWxkTmFtZSAmJiB0aGlzLmZpZWxkTmFtZSgpID09PSB0aW1lRmllbGROYW1lOwogICAgfQogIH0sIHsKICAgIGtleTogInNldFR5cGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldFR5cGUodHlwZSkgewogICAgICB0aGlzLnR5cGUgPSB0eXBlb2YgdHlwZSA9PT0gJ3N0cmluZycgPyBnZXRUeXBlRnJvbVJlZ2lzdHJ5KHR5cGUpIDogdHlwZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRTY2hlbWEiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldFNjaGVtYShzY2hlbWEpIHsKICAgICAgdGhpcy5zY2hlbWEgPSB0eXBlb2Ygc2NoZW1hID09PSAnc3RyaW5nJyA/IGdldFNjaGVtYUZyb21SZWdpc3RyeSh0aGlzLmFnZ0NvbmZpZ3Muc2NoZW1hcywgc2NoZW1hKSA6IHNjaGVtYTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJ0eXBlIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fX3R5cGU7CiAgICB9LAogICAgc2V0OiBmdW5jdGlvbiBzZXQodHlwZSkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgIGlmICh0aGlzLl9fdHlwZURlY29yYXRpb25zKSB7CiAgICAgICAgX2xvZGFzaC5kZWZhdWx0LmZvck93bih0aGlzLl9fdHlwZURlY29yYXRpb25zLCBmdW5jdGlvbiAocHJvcCwgbmFtZSkgewogICAgICAgICAgLy8gQHRzLWlnbm9yZQogICAgICAgICAgZGVsZXRlIHRoaXNbbmFtZV07CiAgICAgICAgfSwgdGhpcyk7CiAgICAgIH0KCiAgICAgIGlmICh0eXBlICYmIF9sb2Rhc2guZGVmYXVsdC5pc0Z1bmN0aW9uKHR5cGUuZGVjb3JhdGVBZ2dDb25maWcpKSB7CiAgICAgICAgdGhpcy5fX3R5cGVEZWNvcmF0aW9ucyA9IHR5cGUuZGVjb3JhdGVBZ2dDb25maWcoKTsKICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0aGlzLCB0aGlzLl9fdHlwZURlY29yYXRpb25zKTsKICAgICAgfQoKICAgICAgdGhpcy5fX3R5cGUgPSB0eXBlOwogICAgICB2YXIgYXZhaWxhYmxlRmllbGRzID0gW107CiAgICAgIHZhciBmaWVsZFBhcmFtID0gdGhpcy50eXBlICYmIHRoaXMudHlwZS5wYXJhbXMuZmluZChmdW5jdGlvbiAocCkgewogICAgICAgIHJldHVybiBwLnR5cGUgPT09ICdmaWVsZCc7CiAgICAgIH0pOwoKICAgICAgaWYgKGZpZWxkUGFyYW0pIHsKICAgICAgICAvLyBAdHMtaWdub3JlCiAgICAgICAgYXZhaWxhYmxlRmllbGRzID0gZmllbGRQYXJhbS5nZXRBdmFpbGFibGVGaWVsZHModGhpcy5nZXRJbmRleFBhdHRlcm4oKS5maWVsZHMpOwogICAgICB9IC8vIGNsZWFyIG91dCB0aGUgcHJldmlvdXMgcGFyYW1zIGV4Y2VwdCBmb3IgYSBmZXcgc3BlY2lhbCBvbmVzCgoKICAgICAgdGhpcy5zZXRQYXJhbXMoewogICAgICAgIC8vIHNwbGl0IHJvdy9jb2x1bW5zIGlzICJvdXRzaWRlIiBvZiB0aGUgYWdnLCBzbyBkb24ndCByZXNldCBpdAogICAgICAgIHJvdzogdGhpcy5wYXJhbXMucm93LAogICAgICAgIC8vIGFsbW9zdCBldmVyeSBhZ2cgaGFzIGZpZWxkcywgc28gd2UgdHJ5IHRvIHBlcnNpc3QgdGhhdCB3aGVuIHR5cGUgY2hhbmdlcwogICAgICAgIGZpZWxkOiBhdmFpbGFibGVGaWVsZHMuZmluZChmdW5jdGlvbiAoZmllbGQpIHsKICAgICAgICAgIHJldHVybiBmaWVsZC5uYW1lID09PSBfdGhpczQuZ2V0RmllbGQoKTsKICAgICAgICB9KQogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzY2hlbWEiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9fc2NoZW1hOwogICAgfSwKICAgIHNldDogZnVuY3Rpb24gc2V0KHNjaGVtYSkgewogICAgICB0aGlzLl9fc2NoZW1hID0gc2NoZW1hOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIEFnZ0NvbmZpZzsKfSgpOwoKZXhwb3J0cy5BZ2dDb25maWcgPSBBZ2dDb25maWc7"},null]}