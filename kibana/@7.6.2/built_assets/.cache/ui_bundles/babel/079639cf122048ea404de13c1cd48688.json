{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/ml/public/application/routing/routes/timeseriesexplorer.js","dependencies":[{"path":"x-pack/legacy/plugins/ml/public/application/routing/routes/timeseriesexplorer.js","mtime":1585205045936},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLlRpbWVTZXJpZXNFeHBsb3JlclVybFN0YXRlTWFuYWdlciA9IGV4cG9ydHMudGltZVNlcmllc0V4cGxvcmVyUm91dGUgPSB2b2lkIDA7Cgp2YXIgX2xvZGFzaCA9IHJlcXVpcmUoImxvZGFzaCIpOwoKdmFyIF9yZWFjdCA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoInJlYWN0IikpOwoKdmFyIF9yZWFjdFVzZSA9IHJlcXVpcmUoInJlYWN0LXVzZSIpOwoKdmFyIF9tb21lbnQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIm1vbWVudCIpKTsKCnZhciBfaTE4biA9IHJlcXVpcmUoIkBrYm4vaTE4biIpOwoKdmFyIF90aW1lZmlsdGVyID0gcmVxdWlyZSgidWkvdGltZWZpbHRlciIpOwoKdmFyIF90aW1lc2VyaWVzZXhwbG9yZXIgPSByZXF1aXJlKCIuLi8uLi90aW1lc2VyaWVzZXhwbG9yZXIiKTsKCnZhciBfZXhwbG9yZXJfdXRpbHMgPSByZXF1aXJlKCIuLi8uLi9leHBsb3Jlci9leHBsb3Jlcl91dGlscyIpOwoKdmFyIF9tbF9hcGlfc2VydmljZSA9IHJlcXVpcmUoIi4uLy4uL3NlcnZpY2VzL21sX2FwaV9zZXJ2aWNlIik7Cgp2YXIgX2pvYl9zZXJ2aWNlID0gcmVxdWlyZSgiLi4vLi4vc2VydmljZXMvam9iX3NlcnZpY2UiKTsKCnZhciBfZm9yZWNhc3Rfc2VydmljZSA9IHJlcXVpcmUoIi4uLy4uL3NlcnZpY2VzL2ZvcmVjYXN0X3NlcnZpY2UiKTsKCnZhciBfdGltZXNlcmllc2V4cGxvcmVyX2NvbnN0YW50cyA9IHJlcXVpcmUoIi4uLy4uL3RpbWVzZXJpZXNleHBsb3Jlci90aW1lc2VyaWVzZXhwbG9yZXJfY29uc3RhbnRzIik7Cgp2YXIgX3RpbWVzZXJpZXNleHBsb3Jlcl91dGlscyA9IHJlcXVpcmUoIi4uLy4uL3RpbWVzZXJpZXNleHBsb3Jlci90aW1lc2VyaWVzZXhwbG9yZXJfdXRpbHMiKTsKCnZhciBfdGltZXNlcmllc2V4cGxvcmVyX3BhZ2UgPSByZXF1aXJlKCIuLi8uLi90aW1lc2VyaWVzZXhwbG9yZXIvdGltZXNlcmllc2V4cGxvcmVyX3BhZ2UiKTsKCnZhciBfdGltZXNlcmllc2V4cGxvcmVyX25vX2pvYnNfZm91bmQgPSByZXF1aXJlKCIuLi8uLi90aW1lc2VyaWVzZXhwbG9yZXIvY29tcG9uZW50cy90aW1lc2VyaWVzZXhwbG9yZXJfbm9fam9ic19mb3VuZCIpOwoKdmFyIF91cmxfc3RhdGUgPSByZXF1aXJlKCIuLi8uLi91dGlsL3VybF9zdGF0ZSIpOwoKdmFyIF9zZWxlY3RfaW50ZXJ2YWwgPSByZXF1aXJlKCIuLi8uLi9jb21wb25lbnRzL2NvbnRyb2xzL3NlbGVjdF9pbnRlcnZhbCIpOwoKdmFyIF9zZWxlY3Rfc2V2ZXJpdHkgPSByZXF1aXJlKCIuLi8uLi9jb21wb25lbnRzL2NvbnRyb2xzL3NlbGVjdF9zZXZlcml0eSIpOwoKdmFyIF9yb3V0ZXIgPSByZXF1aXJlKCIuLi9yb3V0ZXIiKTsKCnZhciBfdXNlX3JlZnJlc2ggPSByZXF1aXJlKCIuLi91c2VfcmVmcmVzaCIpOwoKdmFyIF91c2VfcmVzb2x2ZXIgPSByZXF1aXJlKCIuLi91c2VfcmVzb2x2ZXIiKTsKCnZhciBfcmVzb2x2ZXJzID0gcmVxdWlyZSgiLi4vcmVzb2x2ZXJzIik7Cgp2YXIgX2JyZWFkY3J1bWJzID0gcmVxdWlyZSgiLi4vYnJlYWRjcnVtYnMiKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7CiAgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsKICAgIGRlZmF1bHQ6IG9iagogIH07Cn0KCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgewogIGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsKICAgIHJldHVybiBvYmo7CiAgfSBlbHNlIHsKICAgIHZhciBuZXdPYmogPSB7fTsKCiAgICBpZiAob2JqICE9IG51bGwpIHsKICAgICAgZm9yICh2YXIga2V5IGluIG9iaikgewogICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7CiAgICAgICAgICB2YXIgZGVzYyA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSAmJiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID8gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIGtleSkgOiB7fTsKCiAgICAgICAgICBpZiAoZGVzYy5nZXQgfHwgZGVzYy5zZXQpIHsKICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5ld09iaiwga2V5LCBkZXNjKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG5ld09ialtrZXldID0gb2JqW2tleV07CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgbmV3T2JqLmRlZmF1bHQgPSBvYmo7CiAgICByZXR1cm4gbmV3T2JqOwogIH0KfQoKZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7CiAgcmV0dXJuIF9hcnJheVdpdGhIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHx8IF9ub25JdGVyYWJsZVJlc3QoKTsKfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlUmVzdCgpIHsKICB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7Cn0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHsKICB2YXIgX2FyciA9IFtdOwogIHZhciBfbiA9IHRydWU7CiAgdmFyIF9kID0gZmFsc2U7CiAgdmFyIF9lID0gdW5kZWZpbmVkOwoKICB0cnkgewogICAgZm9yICh2YXIgX2kgPSBhcnJbU3ltYm9sLml0ZXJhdG9yXSgpLCBfczsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSkgewogICAgICBfYXJyLnB1c2goX3MudmFsdWUpOwoKICAgICAgaWYgKGkgJiYgX2Fyci5sZW5ndGggPT09IGkpIGJyZWFrOwogICAgfQogIH0gY2F0Y2ggKGVycikgewogICAgX2QgPSB0cnVlOwogICAgX2UgPSBlcnI7CiAgfSBmaW5hbGx5IHsKICAgIHRyeSB7CiAgICAgIGlmICghX24gJiYgX2lbInJldHVybiJdICE9IG51bGwpIF9pWyJyZXR1cm4iXSgpOwogICAgfSBmaW5hbGx5IHsKICAgICAgaWYgKF9kKSB0aHJvdyBfZTsKICAgIH0KICB9CgogIHJldHVybiBfYXJyOwp9CgpmdW5jdGlvbiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsKfQoKZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7CiAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOwoKICBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgewogICAgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7CiAgICBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7CiAgICAgIHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOwogICAgfSk7CiAgICBrZXlzLnB1c2guYXBwbHkoa2V5cywgc3ltYm9scyk7CiAgfQoKICByZXR1cm4ga2V5czsKfQoKZnVuY3Rpb24gX29iamVjdFNwcmVhZCh0YXJnZXQpIHsKICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgewogICAgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXSAhPSBudWxsID8gYXJndW1lbnRzW2ldIDoge307CgogICAgaWYgKGkgJSAyKSB7CiAgICAgIG93bktleXMoc291cmNlLCB0cnVlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsKICAgICAgfSk7CiAgICB9IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKSB7CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoc291cmNlKSk7CiAgICB9IGVsc2UgewogICAgICBvd25LZXlzKHNvdXJjZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwga2V5KSk7CiAgICAgIH0pOwogICAgfQogIH0KCiAgcmV0dXJuIHRhcmdldDsKfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgewogIGlmIChrZXkgaW4gb2JqKSB7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsKICAgICAgdmFsdWU6IHZhbHVlLAogICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgIHdyaXRhYmxlOiB0cnVlCiAgICB9KTsKICB9IGVsc2UgewogICAgb2JqW2tleV0gPSB2YWx1ZTsKICB9CgogIHJldHVybiBvYmo7Cn0KCmZ1bmN0aW9uIF9leHRlbmRzKCkgewogIF9leHRlbmRzID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiAodGFyZ2V0KSB7CiAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgewogICAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldOwoKICAgICAgZm9yICh2YXIga2V5IGluIHNvdXJjZSkgewogICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoc291cmNlLCBrZXkpKSB7CiAgICAgICAgICB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHJldHVybiB0YXJnZXQ7CiAgfTsKCiAgcmV0dXJuIF9leHRlbmRzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn0KCnZhciB0aW1lU2VyaWVzRXhwbG9yZXJSb3V0ZSA9IHsKICBwYXRoOiAnL3RpbWVzZXJpZXNleHBsb3JlcicsCiAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIocHJvcHMsIGNvbmZpZywgZGVwcykgewogICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoUGFnZVdyYXBwZXIsIF9leHRlbmRzKHsKICAgICAgY29uZmlnOiBjb25maWcKICAgIH0sIHByb3BzLCB7CiAgICAgIGRlcHM6IGRlcHMKICAgIH0pKTsKICB9LAogIGJyZWFkY3J1bWJzOiBbX2JyZWFkY3J1bWJzLk1MX0JSRUFEQ1JVTUIsIF9icmVhZGNydW1icy5BTk9NQUxZX0RFVEVDVElPTl9CUkVBRENSVU1CLCB7CiAgICB0ZXh0OiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWwuYW5vbWFseURldGVjdGlvbi5zaW5nbGVNZXRyaWNWaWV3ZXJMYWJlbCcsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdTaW5nbGUgTWV0cmljIFZpZXdlcicKICAgIH0pLAogICAgaHJlZjogJycKICB9XQp9OwpleHBvcnRzLnRpbWVTZXJpZXNFeHBsb3JlclJvdXRlID0gdGltZVNlcmllc0V4cGxvcmVyUm91dGU7Cgp2YXIgUGFnZVdyYXBwZXIgPSBmdW5jdGlvbiBQYWdlV3JhcHBlcihfcmVmKSB7CiAgdmFyIGNvbmZpZyA9IF9yZWYuY29uZmlnLAogICAgICBkZXBzID0gX3JlZi5kZXBzOwoKICB2YXIgX3VzZVJlc29sdmVyID0gKDAsIF91c2VfcmVzb2x2ZXIudXNlUmVzb2x2ZXIpKCcnLCB1bmRlZmluZWQsIGNvbmZpZywgX29iamVjdFNwcmVhZCh7fSwgKDAsIF9yZXNvbHZlcnMuYmFzaWNSZXNvbHZlcnMpKGRlcHMpLCB7CiAgICBqb2JzOiBfam9iX3NlcnZpY2UubWxKb2JTZXJ2aWNlLmxvYWRKb2JzV3JhcHBlciwKICAgIGpvYnNXaXRoVGltZVJhbmdlOiBmdW5jdGlvbiBqb2JzV2l0aFRpbWVSYW5nZSgpIHsKICAgICAgcmV0dXJuIF9tbF9hcGlfc2VydmljZS5tbC5qb2JzLmpvYnNXaXRoVGltZXJhbmdlKCgwLCBfZXhwbG9yZXJfdXRpbHMuZ2V0RGF0ZUZvcm1hdFR6KSgpKTsKICAgIH0KICB9KSksCiAgICAgIGNvbnRleHQgPSBfdXNlUmVzb2x2ZXIuY29udGV4dCwKICAgICAgcmVzdWx0cyA9IF91c2VSZXNvbHZlci5yZXN1bHRzOwoKICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcm91dGVyLlBhZ2VMb2FkZXIsIHsKICAgIGNvbnRleHQ6IGNvbnRleHQKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFRpbWVTZXJpZXNFeHBsb3JlclVybFN0YXRlTWFuYWdlciwgewogICAgY29uZmlnOiBjb25maWcsCiAgICBqb2JzV2l0aFRpbWVSYW5nZTogcmVzdWx0cy5qb2JzV2l0aFRpbWVSYW5nZS5qb2JzCiAgfSkpOwp9OwoKdmFyIFRpbWVTZXJpZXNFeHBsb3JlclVybFN0YXRlTWFuYWdlciA9IGZ1bmN0aW9uIFRpbWVTZXJpZXNFeHBsb3JlclVybFN0YXRlTWFuYWdlcihfcmVmMikgewogIHZhciBfZ2xvYmFsU3RhdGUkdGltZSwgX2dsb2JhbFN0YXRlJHRpbWUyLCBfZ2xvYmFsU3RhdGUkbWwsIF9hcHBTdGF0ZSRtbFRpbWVTZXJpZSwgX2FwcFN0YXRlJG1sVGltZVNlcmllMiwgX2FwcFN0YXRlJG1sVGltZVNlcmllMywgX2FwcFN0YXRlJG1sVGltZVNlcmllNCwgX2JvdW5kcyRtaW4sIF9ib3VuZHMkbWF4LCBfYXBwU3RhdGUkbWxUaW1lU2VyaWU1OwoKICB2YXIgY29uZmlnID0gX3JlZjIuY29uZmlnLAogICAgICBqb2JzV2l0aFRpbWVSYW5nZSA9IF9yZWYyLmpvYnNXaXRoVGltZVJhbmdlOwoKICB2YXIgX3VzZVVybFN0YXRlID0gKDAsIF91cmxfc3RhdGUudXNlVXJsU3RhdGUpKCdfYScpLAogICAgICBfdXNlVXJsU3RhdGUyID0gX3NsaWNlZFRvQXJyYXkoX3VzZVVybFN0YXRlLCAyKSwKICAgICAgYXBwU3RhdGUgPSBfdXNlVXJsU3RhdGUyWzBdLAogICAgICBzZXRBcHBTdGF0ZSA9IF91c2VVcmxTdGF0ZTJbMV07CgogIHZhciBfdXNlVXJsU3RhdGUzID0gKDAsIF91cmxfc3RhdGUudXNlVXJsU3RhdGUpKCdfZycpLAogICAgICBfdXNlVXJsU3RhdGU0ID0gX3NsaWNlZFRvQXJyYXkoX3VzZVVybFN0YXRlMywgMiksCiAgICAgIGdsb2JhbFN0YXRlID0gX3VzZVVybFN0YXRlNFswXSwKICAgICAgc2V0R2xvYmFsU3RhdGUgPSBfdXNlVXJsU3RhdGU0WzFdOwoKICB2YXIgX3VzZVN0YXRlID0gKDAsIF9yZWFjdC51c2VTdGF0ZSkoMCksCiAgICAgIF91c2VTdGF0ZTIgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUsIDIpLAogICAgICBsYXN0UmVmcmVzaCA9IF91c2VTdGF0ZTJbMF0sCiAgICAgIHNldExhc3RSZWZyZXNoID0gX3VzZVN0YXRlMlsxXTsKCiAgdmFyIHByZXZpb3VzUmVmcmVzaCA9ICgwLCBfcmVhY3RVc2UudXNlUHJldmlvdXMpKGxhc3RSZWZyZXNoKTsKCiAgdmFyIF91c2VTdGF0ZTMgPSAoMCwgX3JlYWN0LnVzZVN0YXRlKSgpLAogICAgICBfdXNlU3RhdGU0ID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlMywgMiksCiAgICAgIHNlbGVjdGVkSm9iSWQgPSBfdXNlU3RhdGU0WzBdLAogICAgICBzZXRTZWxlY3RlZEpvYklkID0gX3VzZVN0YXRlNFsxXTsKCiAgdmFyIHJlZnJlc2ggPSAoMCwgX3VzZV9yZWZyZXNoLnVzZVJlZnJlc2gpKCk7CiAgKDAsIF9yZWFjdC51c2VFZmZlY3QpKGZ1bmN0aW9uICgpIHsKICAgIGlmIChyZWZyZXNoICE9PSB1bmRlZmluZWQpIHsKICAgICAgc2V0TGFzdFJlZnJlc2gocmVmcmVzaCA9PT0gbnVsbCB8fCByZWZyZXNoID09PSB2b2lkIDAgPyB2b2lkIDAgOiByZWZyZXNoLmxhc3RSZWZyZXNoKTsKCiAgICAgIGlmIChyZWZyZXNoLnRpbWVSYW5nZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgdmFyIF9yZWZyZXNoJHRpbWVSYW5nZSA9IHJlZnJlc2gudGltZVJhbmdlLAogICAgICAgICAgICBzdGFydCA9IF9yZWZyZXNoJHRpbWVSYW5nZS5zdGFydCwKICAgICAgICAgICAgZW5kID0gX3JlZnJlc2gkdGltZVJhbmdlLmVuZDsKICAgICAgICBzZXRHbG9iYWxTdGF0ZSgndGltZScsIHsKICAgICAgICAgIGZyb206IHN0YXJ0LAogICAgICAgICAgdG86IGVuZAogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSwgW3JlZnJlc2ggPT09IG51bGwgfHwgcmVmcmVzaCA9PT0gdm9pZCAwID8gdm9pZCAwIDogcmVmcmVzaC5sYXN0UmVmcmVzaF0pOwogICgwLCBfcmVhY3QudXNlRWZmZWN0KShmdW5jdGlvbiAoKSB7CiAgICBfdGltZWZpbHRlci50aW1lZmlsdGVyLmVuYWJsZVRpbWVSYW5nZVNlbGVjdG9yKCk7CgogICAgX3RpbWVmaWx0ZXIudGltZWZpbHRlci5lbmFibGVBdXRvUmVmcmVzaFNlbGVjdG9yKCk7CiAgfSwgW10pOyAvLyBXZSBjYW5ub3Qgc2ltcGx5IGluZmVyIGJvdW5kcyBmcm9tIHRoZSBnbG9iYWxTdGF0ZSdzIGB0aW1lYCBhdHRyaWJ1dGUKICAvLyB3aXRoIGBtb21lbnRgIHNpbmNlIGl0IGNhbiBjb250YWluIGN1c3RvbSBzdHJpbmdzIHN1Y2ggYXMgYG5vdy0xNW1gLgogIC8vIFNvIHdoZW4gZ2xvYmFsU3RhdGUncyBgdGltZWAgY2hhbmdlcywgd2UgdXBkYXRlIHRoZSB0aW1lZmlsdGVyIGFuZCB1c2UKICAvLyBgdGltZWZpbHRlci5nZXRCb3VuZHMoKWAgdG8gdXBkYXRlIGBib3VuZHNgIGluIHRoaXMgY29tcG9uZW50J3Mgc3RhdGUuCgogIHZhciBfdXNlU3RhdGU1ID0gKDAsIF9yZWFjdC51c2VTdGF0ZSkodW5kZWZpbmVkKSwKICAgICAgX3VzZVN0YXRlNiA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZTUsIDIpLAogICAgICBib3VuZHMgPSBfdXNlU3RhdGU2WzBdLAogICAgICBzZXRCb3VuZHMgPSBfdXNlU3RhdGU2WzFdOwoKICAoMCwgX3JlYWN0LnVzZUVmZmVjdCkoZnVuY3Rpb24gKCkgewogICAgaWYgKChnbG9iYWxTdGF0ZSA9PT0gbnVsbCB8fCBnbG9iYWxTdGF0ZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogZ2xvYmFsU3RhdGUudGltZSkgIT09IHVuZGVmaW5lZCkgewogICAgICBfdGltZWZpbHRlci50aW1lZmlsdGVyLnNldFRpbWUoewogICAgICAgIGZyb206IGdsb2JhbFN0YXRlLnRpbWUuZnJvbSwKICAgICAgICB0bzogZ2xvYmFsU3RhdGUudGltZS50bwogICAgICB9KTsKCiAgICAgIHZhciB0aW1lZmlsdGVyQm91bmRzID0gX3RpbWVmaWx0ZXIudGltZWZpbHRlci5nZXRCb3VuZHMoKTsgLy8gT25seSBpZiBib3RoIG1pbi9tYXggYm91bmRzIGFyZSB2YWxpZCBtb21lbnQgdGltZXMgc2V0IHRoZSBib3VuZHMuCiAgICAgIC8vIEFuIGludmFsaWQgc3RyaW5nIHJlc3RvcmVkIGZyb20gZ2xvYmFsU3RhdGUgbWlnaHQgcmV0dXJuIGB1bmRlZmluZWRgLgoKCiAgICAgIGlmICgodGltZWZpbHRlckJvdW5kcyA9PT0gbnVsbCB8fCB0aW1lZmlsdGVyQm91bmRzID09PSB2b2lkIDAgPyB2b2lkIDAgOiB0aW1lZmlsdGVyQm91bmRzLm1pbikgIT09IHVuZGVmaW5lZCAmJiAodGltZWZpbHRlckJvdW5kcyA9PT0gbnVsbCB8fCB0aW1lZmlsdGVyQm91bmRzID09PSB2b2lkIDAgPyB2b2lkIDAgOiB0aW1lZmlsdGVyQm91bmRzLm1heCkgIT09IHVuZGVmaW5lZCkgewogICAgICAgIHNldEJvdW5kcyhfdGltZWZpbHRlci50aW1lZmlsdGVyLmdldEJvdW5kcygpKTsKICAgICAgfQogICAgfQogIH0sIFtnbG9iYWxTdGF0ZSA9PT0gbnVsbCB8fCBnbG9iYWxTdGF0ZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9nbG9iYWxTdGF0ZSR0aW1lID0gZ2xvYmFsU3RhdGUudGltZSkgPT09IG51bGwgfHwgX2dsb2JhbFN0YXRlJHRpbWUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9nbG9iYWxTdGF0ZSR0aW1lLmZyb20sIGdsb2JhbFN0YXRlID09PSBudWxsIHx8IGdsb2JhbFN0YXRlID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX2dsb2JhbFN0YXRlJHRpbWUyID0gZ2xvYmFsU3RhdGUudGltZSkgPT09IG51bGwgfHwgX2dsb2JhbFN0YXRlJHRpbWUyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZ2xvYmFsU3RhdGUkdGltZTIudG9dKTsKICB2YXIgc2VsZWN0ZWRKb2JJZHMgPSBnbG9iYWxTdGF0ZSA9PT0gbnVsbCB8fCBnbG9iYWxTdGF0ZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9nbG9iYWxTdGF0ZSRtbCA9IGdsb2JhbFN0YXRlLm1sKSA9PT0gbnVsbCB8fCBfZ2xvYmFsU3RhdGUkbWwgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9nbG9iYWxTdGF0ZSRtbC5qb2JJZHM7IC8vIFNvcnQgc2VsZWN0ZWRKb2JJZHMgc28gd2UgY2FuIGJlIHN1cmUgY29tcGFyaXNvbiB3b3JrcyB3aGVuIHN0cmluZ2lmeWluZy4KCiAgaWYgKEFycmF5LmlzQXJyYXkoc2VsZWN0ZWRKb2JJZHMpKSB7CiAgICBzZWxlY3RlZEpvYklkcy5zb3J0KCk7CiAgfSAvLyBXaGVuIGNoYW5naW5nIGpvYnMgd2UnbGwgY2xlYXIgYXBwU3RhdGUgKGRldGVjdG9ySW5kZXgsIGVudGl0aWVzLCBmb3JlY2FzdElkKS4KICAvLyBUbyByZXRvcmUgc2V0dGluZ3MgZnJvbSB0aGUgVVJMIG9uIGluaXRpYWwgbG9hZCB3ZSBhbHNvIG5lZWQgdG8gY2hlY2sgYWdhaW5zdAogIC8vIGBwcmV2aW91c1NlbGVjdGVkSm9iSWRzYCB0byBhdm9pZCB3aXBpbmcgYXBwU3RhdGUuCgoKICB2YXIgcHJldmlvdXNTZWxlY3RlZEpvYklkcyA9ICgwLCBfcmVhY3RVc2UudXNlUHJldmlvdXMpKHNlbGVjdGVkSm9iSWRzKTsKICB2YXIgaXNKb2JDaGFuZ2UgPSAhKDAsIF9sb2Rhc2guaXNFcXVhbCkocHJldmlvdXNTZWxlY3RlZEpvYklkcywgc2VsZWN0ZWRKb2JJZHMpOyAvLyBVc2UgYSBzaWRlIGVmZmVjdCB0byBjbGVhciBhcHBTdGF0ZSB3aGVuIGNoYW5naW5nIGpvYnMuCgogICgwLCBfcmVhY3QudXNlRWZmZWN0KShmdW5jdGlvbiAoKSB7CiAgICBpZiAoc2VsZWN0ZWRKb2JJZHMgIT09IHVuZGVmaW5lZCAmJiBwcmV2aW91c1NlbGVjdGVkSm9iSWRzICE9PSB1bmRlZmluZWQpIHsKICAgICAgc2V0TGFzdFJlZnJlc2goRGF0ZS5ub3coKSk7CiAgICAgIGFwcFN0YXRlSGFuZGxlcihfdGltZXNlcmllc2V4cGxvcmVyX2NvbnN0YW50cy5BUFBfU1RBVEVfQUNUSU9OLkNMRUFSKTsKICAgIH0KCiAgICB2YXIgdmFsaWRhdGVkSm9iSWQgPSAoMCwgX3RpbWVzZXJpZXNleHBsb3Jlcl91dGlscy52YWxpZGF0ZUpvYlNlbGVjdGlvbikoam9ic1dpdGhUaW1lUmFuZ2UsIHNlbGVjdGVkSm9iSWRzLCBzZXRHbG9iYWxTdGF0ZSk7CgogICAgaWYgKHR5cGVvZiB2YWxpZGF0ZWRKb2JJZCA9PT0gJ3N0cmluZycpIHsKICAgICAgc2V0U2VsZWN0ZWRKb2JJZCh2YWxpZGF0ZWRKb2JJZCk7CiAgICB9CiAgfSwgW0pTT04uc3RyaW5naWZ5KHNlbGVjdGVkSm9iSWRzKV0pOyAvLyBOZXh0IHdlIGdldCBnbG9iYWxTdGF0ZSBhbmQgYXBwU3RhdGUgaW5mb3JtYXRpb24gdG8gcGFzcyBpdCBvbiBhcyBwcm9wcyBsYXRlci4KICAvLyBJZiBhIGpvYiBjaGFuZ2UgaXMgZ29pbmcgb24sIHdlIGZhbGwgYmFjayB0byBkZWZhdWx0cyAoYXMgaWYgYXBwU3RhdGUgd2FzIGFscmVhZHkgY2xlYXJlZCksCiAgLy8gb3RoZXJ3aXNlIHRoZSBwYWdlIGNvdWxkIGJyZWFrLgoKICB2YXIgc2VsZWN0ZWREZXRlY3RvckluZGV4ID0gaXNKb2JDaGFuZ2UgPyAwIDogKyhhcHBTdGF0ZSA9PT0gbnVsbCB8fCBhcHBTdGF0ZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9hcHBTdGF0ZSRtbFRpbWVTZXJpZSA9IGFwcFN0YXRlLm1sVGltZVNlcmllc0V4cGxvcmVyKSA9PT0gbnVsbCB8fCBfYXBwU3RhdGUkbWxUaW1lU2VyaWUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hcHBTdGF0ZSRtbFRpbWVTZXJpZS5kZXRlY3RvckluZGV4KSB8fCAwOwogIHZhciBzZWxlY3RlZEVudGl0aWVzID0gaXNKb2JDaGFuZ2UgPyB1bmRlZmluZWQgOiBhcHBTdGF0ZSA9PT0gbnVsbCB8fCBhcHBTdGF0ZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9hcHBTdGF0ZSRtbFRpbWVTZXJpZTIgPSBhcHBTdGF0ZS5tbFRpbWVTZXJpZXNFeHBsb3JlcikgPT09IG51bGwgfHwgX2FwcFN0YXRlJG1sVGltZVNlcmllMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2FwcFN0YXRlJG1sVGltZVNlcmllMi5lbnRpdGllczsKICB2YXIgc2VsZWN0ZWRGb3JlY2FzdElkID0gaXNKb2JDaGFuZ2UgPyB1bmRlZmluZWQgOiBhcHBTdGF0ZSA9PT0gbnVsbCB8fCBhcHBTdGF0ZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9hcHBTdGF0ZSRtbFRpbWVTZXJpZTMgPSBhcHBTdGF0ZS5tbFRpbWVTZXJpZXNFeHBsb3JlcikgPT09IG51bGwgfHwgX2FwcFN0YXRlJG1sVGltZVNlcmllMyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2FwcFN0YXRlJG1sVGltZVNlcmllMy5mb3JlY2FzdElkOwogIHZhciB6b29tID0gaXNKb2JDaGFuZ2UgPyB1bmRlZmluZWQgOiBhcHBTdGF0ZSA9PT0gbnVsbCB8fCBhcHBTdGF0ZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9hcHBTdGF0ZSRtbFRpbWVTZXJpZTQgPSBhcHBTdGF0ZS5tbFRpbWVTZXJpZXNFeHBsb3JlcikgPT09IG51bGwgfHwgX2FwcFN0YXRlJG1sVGltZVNlcmllNCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2FwcFN0YXRlJG1sVGltZVNlcmllNC56b29tOwogIHZhciBzZWxlY3RlZEpvYiA9IHNlbGVjdGVkSm9iSWQgIT09IHVuZGVmaW5lZCA/IF9qb2Jfc2VydmljZS5tbEpvYlNlcnZpY2UuZ2V0Sm9iKHNlbGVjdGVkSm9iSWQpIDogdW5kZWZpbmVkOwogIHZhciB0aW1lU2VyaWVzSm9icyA9ICgwLCBfdGltZXNlcmllc2V4cGxvcmVyX3V0aWxzLmNyZWF0ZVRpbWVTZXJpZXNKb2JEYXRhKShfam9iX3NlcnZpY2UubWxKb2JTZXJ2aWNlLmpvYnMpOwogIHZhciBhdXRvWm9vbUR1cmF0aW9uOwoKICBpZiAoc2VsZWN0ZWRKb2JJZCAhPT0gdW5kZWZpbmVkICYmIHNlbGVjdGVkSm9iICE9PSB1bmRlZmluZWQpIHsKICAgIGF1dG9ab29tRHVyYXRpb24gPSAoMCwgX3RpbWVzZXJpZXNleHBsb3Jlcl91dGlscy5nZXRBdXRvWm9vbUR1cmF0aW9uKSh0aW1lU2VyaWVzSm9icywgc2VsZWN0ZWRKb2IpOwogIH0KCiAgdmFyIGFwcFN0YXRlSGFuZGxlciA9ICgwLCBfcmVhY3QudXNlQ2FsbGJhY2spKGZ1bmN0aW9uIChhY3Rpb24sIHBheWxvYWQpIHsKICAgIHZhciBtbFRpbWVTZXJpZXNFeHBsb3JlciA9IChhcHBTdGF0ZSA9PT0gbnVsbCB8fCBhcHBTdGF0ZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogYXBwU3RhdGUubWxUaW1lU2VyaWVzRXhwbG9yZXIpICE9PSB1bmRlZmluZWQgPyBfb2JqZWN0U3ByZWFkKHt9LCBhcHBTdGF0ZS5tbFRpbWVTZXJpZXNFeHBsb3JlcikgOiB7fTsKCiAgICBzd2l0Y2ggKGFjdGlvbikgewogICAgICBjYXNlIF90aW1lc2VyaWVzZXhwbG9yZXJfY29uc3RhbnRzLkFQUF9TVEFURV9BQ1RJT04uQ0xFQVI6CiAgICAgICAgZGVsZXRlIG1sVGltZVNlcmllc0V4cGxvcmVyLmRldGVjdG9ySW5kZXg7CiAgICAgICAgZGVsZXRlIG1sVGltZVNlcmllc0V4cGxvcmVyLmVudGl0aWVzOwogICAgICAgIGRlbGV0ZSBtbFRpbWVTZXJpZXNFeHBsb3Jlci5mb3JlY2FzdElkOwogICAgICAgIGRlbGV0ZSBtbFRpbWVTZXJpZXNFeHBsb3Jlci56b29tOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSBfdGltZXNlcmllc2V4cGxvcmVyX2NvbnN0YW50cy5BUFBfU1RBVEVfQUNUSU9OLlNFVF9ERVRFQ1RPUl9JTkRFWDoKICAgICAgICBtbFRpbWVTZXJpZXNFeHBsb3Jlci5kZXRlY3RvckluZGV4ID0gcGF5bG9hZDsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgX3RpbWVzZXJpZXNleHBsb3Jlcl9jb25zdGFudHMuQVBQX1NUQVRFX0FDVElPTi5TRVRfRU5USVRJRVM6CiAgICAgICAgbWxUaW1lU2VyaWVzRXhwbG9yZXIuZW50aXRpZXMgPSBwYXlsb2FkOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSBfdGltZXNlcmllc2V4cGxvcmVyX2NvbnN0YW50cy5BUFBfU1RBVEVfQUNUSU9OLlNFVF9GT1JFQ0FTVF9JRDoKICAgICAgICBtbFRpbWVTZXJpZXNFeHBsb3Jlci5mb3JlY2FzdElkID0gcGF5bG9hZDsKICAgICAgICBkZWxldGUgbWxUaW1lU2VyaWVzRXhwbG9yZXIuem9vbTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgX3RpbWVzZXJpZXNleHBsb3Jlcl9jb25zdGFudHMuQVBQX1NUQVRFX0FDVElPTi5TRVRfWk9PTToKICAgICAgICBtbFRpbWVTZXJpZXNFeHBsb3Jlci56b29tID0gcGF5bG9hZDsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgX3RpbWVzZXJpZXNleHBsb3Jlcl9jb25zdGFudHMuQVBQX1NUQVRFX0FDVElPTi5VTlNFVF9aT09NOgogICAgICAgIGRlbGV0ZSBtbFRpbWVTZXJpZXNFeHBsb3Jlci56b29tOwogICAgICAgIGJyZWFrOwogICAgfQoKICAgIHNldEFwcFN0YXRlKCdtbFRpbWVTZXJpZXNFeHBsb3JlcicsIG1sVGltZVNlcmllc0V4cGxvcmVyKTsKICB9LCBbSlNPTi5zdHJpbmdpZnkoW2FwcFN0YXRlLCBnbG9iYWxTdGF0ZV0pXSk7CiAgdmFyIGJvdW5kc01pbk1zID0gYm91bmRzID09PSBudWxsIHx8IGJvdW5kcyA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9ib3VuZHMkbWluID0gYm91bmRzLm1pbikgPT09IG51bGwgfHwgX2JvdW5kcyRtaW4gPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9ib3VuZHMkbWluLnZhbHVlT2YoKTsKICB2YXIgYm91bmRzTWF4TXMgPSBib3VuZHMgPT09IG51bGwgfHwgYm91bmRzID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX2JvdW5kcyRtYXggPSBib3VuZHMubWF4KSA9PT0gbnVsbCB8fCBfYm91bmRzJG1heCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2JvdW5kcyRtYXgudmFsdWVPZigpOwoKICB2YXIgX3VzZVN0YXRlNyA9ICgwLCBfcmVhY3QudXNlU3RhdGUpKGFwcFN0YXRlID09PSBudWxsIHx8IGFwcFN0YXRlID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX2FwcFN0YXRlJG1sVGltZVNlcmllNSA9IGFwcFN0YXRlLm1sVGltZVNlcmllc0V4cGxvcmVyKSA9PT0gbnVsbCB8fCBfYXBwU3RhdGUkbWxUaW1lU2VyaWU1ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYXBwU3RhdGUkbWxUaW1lU2VyaWU1LmZvcmVjYXN0SWQpLAogICAgICBfdXNlU3RhdGU4ID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlNywgMiksCiAgICAgIHNlbGVjdGVkRm9yZWNhc3RJZFByb3AgPSBfdXNlU3RhdGU4WzBdLAogICAgICBzZXRTZWxlY3RlZEZvcmVjYXN0SWRQcm9wID0gX3VzZVN0YXRlOFsxXTsKCiAgKDAsIF9yZWFjdC51c2VFZmZlY3QpKGZ1bmN0aW9uICgpIHsKICAgIGlmIChhdXRvWm9vbUR1cmF0aW9uICE9PSB1bmRlZmluZWQgJiYgYm91bmRzTWluTXMgIT09IHVuZGVmaW5lZCAmJiBib3VuZHNNYXhNcyAhPT0gdW5kZWZpbmVkICYmIHNlbGVjdGVkSm9iICE9PSB1bmRlZmluZWQgJiYgc2VsZWN0ZWRGb3JlY2FzdElkICE9PSB1bmRlZmluZWQpIHsKICAgICAgaWYgKHNlbGVjdGVkRm9yZWNhc3RJZFByb3AgIT09IHNlbGVjdGVkRm9yZWNhc3RJZCkgewogICAgICAgIHNldFNlbGVjdGVkRm9yZWNhc3RJZFByb3AodW5kZWZpbmVkKTsKICAgICAgfQoKICAgICAgX2ZvcmVjYXN0X3NlcnZpY2UubWxGb3JlY2FzdFNlcnZpY2UuZ2V0Rm9yZWNhc3REYXRlUmFuZ2Uoc2VsZWN0ZWRKb2IsIHNlbGVjdGVkRm9yZWNhc3RJZCkudGhlbihmdW5jdGlvbiAocmVzcCkgewogICAgICAgIGlmIChhdXRvWm9vbUR1cmF0aW9uID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHZhciBlYXJsaWVzdCA9ICgwLCBfbW9tZW50LmRlZmF1bHQpKHJlc3AuZWFybGllc3QgfHwgYm91bmRzTWluTXMpOwogICAgICAgIHZhciBsYXRlc3QgPSAoMCwgX21vbWVudC5kZWZhdWx0KShyZXNwLmxhdGVzdCB8fCBib3VuZHNNYXhNcyk7CgogICAgICAgIGlmIChlYXJsaWVzdC5pc0JlZm9yZSgoMCwgX21vbWVudC5kZWZhdWx0KShib3VuZHNNaW5NcykpIHx8IGxhdGVzdC5pc0FmdGVyKCgwLCBfbW9tZW50LmRlZmF1bHQpKGJvdW5kc01heE1zKSkpIHsKICAgICAgICAgIHZhciBlYXJsaWVzdE1zID0gTWF0aC5taW4oZWFybGllc3QudmFsdWVPZigpLCBib3VuZHNNaW5Ncyk7CiAgICAgICAgICB2YXIgbGF0ZXN0TXMgPSBNYXRoLm1heChsYXRlc3QudmFsdWVPZigpLCBib3VuZHNNYXhNcyk7CiAgICAgICAgICBzZXRHbG9iYWxTdGF0ZSgndGltZScsIHsKICAgICAgICAgICAgZnJvbTogKDAsIF9tb21lbnQuZGVmYXVsdCkoZWFybGllc3RNcykudG9JU09TdHJpbmcoKSwKICAgICAgICAgICAgdG86ICgwLCBfbW9tZW50LmRlZmF1bHQpKGxhdGVzdE1zKS50b0lTT1N0cmluZygpCiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIHNldFNlbGVjdGVkRm9yZWNhc3RJZFByb3Aoc2VsZWN0ZWRGb3JlY2FzdElkKTsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlc3ApIHsKICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ1RpbWUgc2VyaWVzIGV4cGxvcmVyIC0gZXJyb3IgbG9hZGluZyB0aW1lIHJhbmdlIG9mIGZvcmVjYXN0IGZyb20gZWxhc3RpY3NlYXJjaDonLCByZXNwKTsKICAgICAgfSk7CiAgICB9CiAgfSwgW3NlbGVjdGVkRm9yZWNhc3RJZF0pOwoKICB2YXIgX3VzZVRhYmxlSW50ZXJ2YWwgPSAoMCwgX3NlbGVjdF9pbnRlcnZhbC51c2VUYWJsZUludGVydmFsKSgpLAogICAgICBfdXNlVGFibGVJbnRlcnZhbDIgPSBfc2xpY2VkVG9BcnJheShfdXNlVGFibGVJbnRlcnZhbCwgMSksCiAgICAgIHRhYmxlSW50ZXJ2YWwgPSBfdXNlVGFibGVJbnRlcnZhbDJbMF07CgogIHZhciBfdXNlVGFibGVTZXZlcml0eSA9ICgwLCBfc2VsZWN0X3NldmVyaXR5LnVzZVRhYmxlU2V2ZXJpdHkpKCksCiAgICAgIF91c2VUYWJsZVNldmVyaXR5MiA9IF9zbGljZWRUb0FycmF5KF91c2VUYWJsZVNldmVyaXR5LCAxKSwKICAgICAgdGFibGVTZXZlcml0eSA9IF91c2VUYWJsZVNldmVyaXR5MlswXTsKCiAgdmFyIHR6Q29uZmlnID0gY29uZmlnLmdldCgnZGF0ZUZvcm1hdDp0eicpOwogIHZhciBkYXRlRm9ybWF0VHogPSB0ekNvbmZpZyAhPT0gJ0Jyb3dzZXInID8gdHpDb25maWcgOiBfbW9tZW50LmRlZmF1bHQudHouZ3Vlc3MoKTsKCiAgaWYgKHRpbWVTZXJpZXNKb2JzLmxlbmd0aCA9PT0gMCkgewogICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3RpbWVzZXJpZXNleHBsb3Jlcl9wYWdlLlRpbWVTZXJpZXNFeHBsb3JlclBhZ2UsIHsKICAgICAgZGF0ZUZvcm1hdFR6OiBkYXRlRm9ybWF0VHoKICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3RpbWVzZXJpZXNleHBsb3Jlcl9ub19qb2JzX2ZvdW5kLlRpbWVzZXJpZXNleHBsb3Jlck5vSm9ic0ZvdW5kLCBudWxsKSk7CiAgfQoKICBpZiAoc2VsZWN0ZWRKb2JJZCA9PT0gdW5kZWZpbmVkIHx8IGF1dG9ab29tRHVyYXRpb24gPT09IHVuZGVmaW5lZCB8fCBib3VuZHMgPT09IHVuZGVmaW5lZCkgewogICAgcmV0dXJuIG51bGw7CiAgfQoKICB2YXIgem9vbVByb3AgPSB0eXBlb2Ygc2VsZWN0ZWRGb3JlY2FzdElkID09PSAnc3RyaW5nJyAmJiBzZWxlY3RlZEZvcmVjYXN0SWRQcm9wID09PSB1bmRlZmluZWQgPyB1bmRlZmluZWQgOiB6b29tOwogIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF90aW1lc2VyaWVzZXhwbG9yZXIuVGltZVNlcmllc0V4cGxvcmVyLCB7CiAgICBhcHBTdGF0ZUhhbmRsZXI6IGFwcFN0YXRlSGFuZGxlciwKICAgIGF1dG9ab29tRHVyYXRpb246IGF1dG9ab29tRHVyYXRpb24sCiAgICBib3VuZHM6IGJvdW5kcywKICAgIGRhdGVGb3JtYXRUejogZGF0ZUZvcm1hdFR6LAogICAgbGFzdFJlZnJlc2g6IGxhc3RSZWZyZXNoLAogICAgcHJldmlvdXNSZWZyZXNoOiBwcmV2aW91c1JlZnJlc2gsCiAgICBzZWxlY3RlZEpvYklkOiBzZWxlY3RlZEpvYklkLAogICAgc2VsZWN0ZWREZXRlY3RvckluZGV4OiBzZWxlY3RlZERldGVjdG9ySW5kZXgsCiAgICBzZWxlY3RlZEVudGl0aWVzOiBzZWxlY3RlZEVudGl0aWVzLAogICAgc2VsZWN0ZWRGb3JlY2FzdElkOiBzZWxlY3RlZEZvcmVjYXN0SWRQcm9wLAogICAgdGFibGVJbnRlcnZhbDogdGFibGVJbnRlcnZhbC52YWwsCiAgICB0YWJsZVNldmVyaXR5OiB0YWJsZVNldmVyaXR5LnZhbCwKICAgIHRpbWVmaWx0ZXI6IF90aW1lZmlsdGVyLnRpbWVmaWx0ZXIsCiAgICB6b29tOiB6b29tUHJvcAogIH0pOwp9OwoKZXhwb3J0cy5UaW1lU2VyaWVzRXhwbG9yZXJVcmxTdGF0ZU1hbmFnZXIgPSBUaW1lU2VyaWVzRXhwbG9yZXJVcmxTdGF0ZU1hbmFnZXI7"},null]}