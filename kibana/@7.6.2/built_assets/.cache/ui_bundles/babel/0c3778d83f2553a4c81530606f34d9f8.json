{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/lens/public/indexpattern_plugin/loader.js","dependencies":[{"path":"x-pack/legacy/plugins/lens/public/indexpattern_plugin/loader.js","mtime":1585205045017},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmxvYWRJbmRleFBhdHRlcm5zID0gbG9hZEluZGV4UGF0dGVybnM7CmV4cG9ydHMubG9hZEluaXRpYWxTdGF0ZSA9IGxvYWRJbml0aWFsU3RhdGU7CmV4cG9ydHMuY2hhbmdlSW5kZXhQYXR0ZXJuID0gY2hhbmdlSW5kZXhQYXR0ZXJuOwpleHBvcnRzLmNoYW5nZUxheWVySW5kZXhQYXR0ZXJuID0gY2hhbmdlTGF5ZXJJbmRleFBhdHRlcm47CmV4cG9ydHMuc3luY0V4aXN0aW5nRmllbGRzID0gc3luY0V4aXN0aW5nRmllbGRzOwoKdmFyIF9sb2Rhc2ggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoImxvZGFzaCIpKTsKCnZhciBfc3RhdGVfaGVscGVycyA9IHJlcXVpcmUoIi4vc3RhdGVfaGVscGVycyIpOwoKdmFyIF9jb21tb24gPSByZXF1aXJlKCIuLi8uLi9jb21tb24iKTsKCnZhciBfZG9jdW1lbnRfZmllbGQgPSByZXF1aXJlKCIuL2RvY3VtZW50X2ZpZWxkIik7Cgp2YXIgX3B1YmxpYyA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uLy4uLy4uL3NyYy9wbHVnaW5zL2RhdGEvcHVibGljIik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgewogIHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7CiAgICBkZWZhdWx0OiBvYmoKICB9Owp9CgpmdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7CiAgcmV0dXJuIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfbm9uSXRlcmFibGVTcHJlYWQoKTsKfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlU3ByZWFkKCkgewogIHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7Cn0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXkoaXRlcikgewogIGlmIChTeW1ib2wuaXRlcmF0b3IgaW4gT2JqZWN0KGl0ZXIpIHx8IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChpdGVyKSA9PT0gIltvYmplY3QgQXJndW1lbnRzXSIpIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpOwp9CgpmdW5jdGlvbiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgewogICAgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkoYXJyLmxlbmd0aCk7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHsKICAgICAgYXJyMltpXSA9IGFycltpXTsKICAgIH0KCiAgICByZXR1cm4gYXJyMjsKICB9Cn0KCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgewogIHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsKCiAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsKICAgIHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOwogICAgaWYgKGVudW1lcmFibGVPbmx5KSBzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgewogICAgICByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsKICAgIH0pOwogICAga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOwogIH0KCiAgcmV0dXJuIGtleXM7Cn0KCmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7CiAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsKICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OwoKICAgIGlmIChpICUgMikgewogICAgICBvd25LZXlzKHNvdXJjZSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7CiAgICAgIH0pOwogICAgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgewogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpOwogICAgfSBlbHNlIHsKICAgICAgb3duS2V5cyhzb3VyY2UpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOwogICAgICB9KTsKICAgIH0KICB9CgogIHJldHVybiB0YXJnZXQ7Cn0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsKICBpZiAoa2V5IGluIG9iaikgewogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7CiAgICAgIHZhbHVlOiB2YWx1ZSwKICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICB3cml0YWJsZTogdHJ1ZQogICAgfSk7CiAgfSBlbHNlIHsKICAgIG9ialtrZXldID0gdmFsdWU7CiAgfQoKICByZXR1cm4gb2JqOwp9CgpmdW5jdGlvbiBsb2FkSW5kZXhQYXR0ZXJucyhfcmVmKSB7CiAgdmFyIHBhdHRlcm5zLCBzYXZlZE9iamVjdHNDbGllbnQsIGNhY2hlLCBtaXNzaW5nSWRzLCByZXNwOwogIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXN5bmMoZnVuY3Rpb24gbG9hZEluZGV4UGF0dGVybnMkKF9jb250ZXh0KSB7CiAgICB3aGlsZSAoMSkgewogICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgcGF0dGVybnMgPSBfcmVmLnBhdHRlcm5zLCBzYXZlZE9iamVjdHNDbGllbnQgPSBfcmVmLnNhdmVkT2JqZWN0c0NsaWVudCwgY2FjaGUgPSBfcmVmLmNhY2hlOwogICAgICAgICAgbWlzc2luZ0lkcyA9IHBhdHRlcm5zLmZpbHRlcihmdW5jdGlvbiAoaWQpIHsKICAgICAgICAgICAgcmV0dXJuICFjYWNoZVtpZF07CiAgICAgICAgICB9KTsKCiAgICAgICAgICBpZiAoIShtaXNzaW5nSWRzLmxlbmd0aCA9PT0gMCkpIHsKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDQ7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIGNhY2hlKTsKCiAgICAgICAgY2FzZSA0OgogICAgICAgICAgX2NvbnRleHQubmV4dCA9IDY7CiAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKHNhdmVkT2JqZWN0c0NsaWVudC5idWxrR2V0KG1pc3NpbmdJZHMubWFwKGZ1bmN0aW9uIChpZCkgewogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgIGlkOiBpZCwKICAgICAgICAgICAgICB0eXBlOiAnaW5kZXgtcGF0dGVybicKICAgICAgICAgICAgfTsKICAgICAgICAgIH0pKSk7CgogICAgICAgIGNhc2UgNjoKICAgICAgICAgIHJlc3AgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgcmVzcC5zYXZlZE9iamVjdHMucmVkdWNlKGZ1bmN0aW9uIChhY2MsIHNhdmVkT2JqZWN0KSB7CiAgICAgICAgICAgIHZhciBpbmRleFBhdHRlcm4gPSBmcm9tU2F2ZWRPYmplY3Qoc2F2ZWRPYmplY3QpOwogICAgICAgICAgICBhY2NbaW5kZXhQYXR0ZXJuLmlkXSA9IGluZGV4UGF0dGVybjsKICAgICAgICAgICAgcmV0dXJuIGFjYzsKICAgICAgICAgIH0sIF9vYmplY3RTcHJlYWQoe30sIGNhY2hlKSkpOwoKICAgICAgICBjYXNlIDg6CiAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgIH0KICAgIH0KICB9KTsKfQoKZnVuY3Rpb24gbG9hZEluaXRpYWxTdGF0ZShfcmVmMikgewogIHZhciBzdGF0ZSwgc2F2ZWRPYmplY3RzQ2xpZW50LCBkZWZhdWx0SW5kZXhQYXR0ZXJuSWQsIGluZGV4UGF0dGVyblJlZnMsIHJlcXVpcmVkUGF0dGVybnMsIGN1cnJlbnRJbmRleFBhdHRlcm5JZCwgaW5kZXhQYXR0ZXJuczsKICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmFzeW5jKGZ1bmN0aW9uIGxvYWRJbml0aWFsU3RhdGUkKF9jb250ZXh0MikgewogICAgd2hpbGUgKDEpIHsKICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgc3RhdGUgPSBfcmVmMi5zdGF0ZSwgc2F2ZWRPYmplY3RzQ2xpZW50ID0gX3JlZjIuc2F2ZWRPYmplY3RzQ2xpZW50LCBkZWZhdWx0SW5kZXhQYXR0ZXJuSWQgPSBfcmVmMi5kZWZhdWx0SW5kZXhQYXR0ZXJuSWQ7CiAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDM7CiAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKGxvYWRJbmRleFBhdHRlcm5SZWZzKHNhdmVkT2JqZWN0c0NsaWVudCkpOwoKICAgICAgICBjYXNlIDM6CiAgICAgICAgICBpbmRleFBhdHRlcm5SZWZzID0gX2NvbnRleHQyLnNlbnQ7CiAgICAgICAgICByZXF1aXJlZFBhdHRlcm5zID0gX2xvZGFzaC5kZWZhdWx0LnVuaXF1ZShzdGF0ZSA/IE9iamVjdC52YWx1ZXMoc3RhdGUubGF5ZXJzKS5tYXAoZnVuY3Rpb24gKGwpIHsKICAgICAgICAgICAgcmV0dXJuIGwuaW5kZXhQYXR0ZXJuSWQ7CiAgICAgICAgICB9KS5jb25jYXQoc3RhdGUuY3VycmVudEluZGV4UGF0dGVybklkKSA6IFtkZWZhdWx0SW5kZXhQYXR0ZXJuSWQgfHwgaW5kZXhQYXR0ZXJuUmVmc1swXS5pZF0pOwogICAgICAgICAgY3VycmVudEluZGV4UGF0dGVybklkID0gcmVxdWlyZWRQYXR0ZXJuc1swXTsKICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gODsKICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAobG9hZEluZGV4UGF0dGVybnMoewogICAgICAgICAgICBzYXZlZE9iamVjdHNDbGllbnQ6IHNhdmVkT2JqZWN0c0NsaWVudCwKICAgICAgICAgICAgY2FjaGU6IHt9LAogICAgICAgICAgICBwYXR0ZXJuczogcmVxdWlyZWRQYXR0ZXJucwogICAgICAgICAgfSkpOwoKICAgICAgICBjYXNlIDg6CiAgICAgICAgICBpbmRleFBhdHRlcm5zID0gX2NvbnRleHQyLnNlbnQ7CgogICAgICAgICAgaWYgKCFzdGF0ZSkgewogICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDExOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIiwgX29iamVjdFNwcmVhZCh7fSwgc3RhdGUsIHsKICAgICAgICAgICAgY3VycmVudEluZGV4UGF0dGVybklkOiBjdXJyZW50SW5kZXhQYXR0ZXJuSWQsCiAgICAgICAgICAgIGluZGV4UGF0dGVyblJlZnM6IGluZGV4UGF0dGVyblJlZnMsCiAgICAgICAgICAgIGluZGV4UGF0dGVybnM6IGluZGV4UGF0dGVybnMsCiAgICAgICAgICAgIHNob3dFbXB0eUZpZWxkczogZmFsc2UsCiAgICAgICAgICAgIGV4aXN0aW5nRmllbGRzOiB7fQogICAgICAgICAgfSkpOwoKICAgICAgICBjYXNlIDExOgogICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIsIHsKICAgICAgICAgICAgY3VycmVudEluZGV4UGF0dGVybklkOiBjdXJyZW50SW5kZXhQYXR0ZXJuSWQsCiAgICAgICAgICAgIGluZGV4UGF0dGVyblJlZnM6IGluZGV4UGF0dGVyblJlZnMsCiAgICAgICAgICAgIGluZGV4UGF0dGVybnM6IGluZGV4UGF0dGVybnMsCiAgICAgICAgICAgIGxheWVyczoge30sCiAgICAgICAgICAgIHNob3dFbXB0eUZpZWxkczogZmFsc2UsCiAgICAgICAgICAgIGV4aXN0aW5nRmllbGRzOiB7fQogICAgICAgICAgfSk7CgogICAgICAgIGNhc2UgMTI6CiAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICB9CiAgICB9CiAgfSk7Cn0KCmZ1bmN0aW9uIGNoYW5nZUluZGV4UGF0dGVybihfcmVmMykgewogIHZhciBpZCwgc2F2ZWRPYmplY3RzQ2xpZW50LCBzdGF0ZSwgc2V0U3RhdGUsIG9uRXJyb3IsIF9pbmRleFBhdHRlcm5zOwoKICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmFzeW5jKGZ1bmN0aW9uIGNoYW5nZUluZGV4UGF0dGVybiQoX2NvbnRleHQzKSB7CiAgICB3aGlsZSAoMSkgewogICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICBpZCA9IF9yZWYzLmlkLCBzYXZlZE9iamVjdHNDbGllbnQgPSBfcmVmMy5zYXZlZE9iamVjdHNDbGllbnQsIHN0YXRlID0gX3JlZjMuc3RhdGUsIHNldFN0YXRlID0gX3JlZjMuc2V0U3RhdGUsIG9uRXJyb3IgPSBfcmVmMy5vbkVycm9yOwogICAgICAgICAgX2NvbnRleHQzLnByZXYgPSAxOwogICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA0OwogICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hd3JhcChsb2FkSW5kZXhQYXR0ZXJucyh7CiAgICAgICAgICAgIHNhdmVkT2JqZWN0c0NsaWVudDogc2F2ZWRPYmplY3RzQ2xpZW50LAogICAgICAgICAgICBjYWNoZTogc3RhdGUuaW5kZXhQYXR0ZXJucywKICAgICAgICAgICAgcGF0dGVybnM6IFtpZF0KICAgICAgICAgIH0pKTsKCiAgICAgICAgY2FzZSA0OgogICAgICAgICAgX2luZGV4UGF0dGVybnMgPSBfY29udGV4dDMuc2VudDsKICAgICAgICAgIHNldFN0YXRlKGZ1bmN0aW9uIChzKSB7CiAgICAgICAgICAgIHJldHVybiBfb2JqZWN0U3ByZWFkKHt9LCBzLCB7CiAgICAgICAgICAgICAgbGF5ZXJzOiBpc1NpbmdsZUVtcHR5TGF5ZXIoc3RhdGUubGF5ZXJzKSA/IF9sb2Rhc2guZGVmYXVsdC5tYXBWYWx1ZXMoc3RhdGUubGF5ZXJzLCBmdW5jdGlvbiAobGF5ZXIpIHsKICAgICAgICAgICAgICAgIHJldHVybiAoMCwgX3N0YXRlX2hlbHBlcnMudXBkYXRlTGF5ZXJJbmRleFBhdHRlcm4pKGxheWVyLCBfaW5kZXhQYXR0ZXJuc1tpZF0pOwogICAgICAgICAgICAgIH0pIDogc3RhdGUubGF5ZXJzLAogICAgICAgICAgICAgIGluZGV4UGF0dGVybnM6IF9vYmplY3RTcHJlYWQoe30sIHMuaW5kZXhQYXR0ZXJucywgX2RlZmluZVByb3BlcnR5KHt9LCBpZCwgX2luZGV4UGF0dGVybnNbaWRdKSksCiAgICAgICAgICAgICAgY3VycmVudEluZGV4UGF0dGVybklkOiBpZAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pOwogICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAxMTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDg6CiAgICAgICAgICBfY29udGV4dDMucHJldiA9IDg7CiAgICAgICAgICBfY29udGV4dDMudDAgPSBfY29udGV4dDNbImNhdGNoIl0oMSk7CiAgICAgICAgICBvbkVycm9yKF9jb250ZXh0My50MCk7CgogICAgICAgIGNhc2UgMTE6CiAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICB9CiAgICB9CiAgfSwgbnVsbCwgbnVsbCwgW1sxLCA4XV0pOwp9CgpmdW5jdGlvbiBjaGFuZ2VMYXllckluZGV4UGF0dGVybihfcmVmNCkgewogIHZhciBpbmRleFBhdHRlcm5JZCwgbGF5ZXJJZCwgc2F2ZWRPYmplY3RzQ2xpZW50LCBzdGF0ZSwgc2V0U3RhdGUsIG9uRXJyb3IsIHJlcGxhY2VJZlBvc3NpYmxlLCBfaW5kZXhQYXR0ZXJuczI7CgogIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXN5bmMoZnVuY3Rpb24gY2hhbmdlTGF5ZXJJbmRleFBhdHRlcm4kKF9jb250ZXh0NCkgewogICAgd2hpbGUgKDEpIHsKICAgICAgc3dpdGNoIChfY29udGV4dDQucHJldiA9IF9jb250ZXh0NC5uZXh0KSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgaW5kZXhQYXR0ZXJuSWQgPSBfcmVmNC5pbmRleFBhdHRlcm5JZCwgbGF5ZXJJZCA9IF9yZWY0LmxheWVySWQsIHNhdmVkT2JqZWN0c0NsaWVudCA9IF9yZWY0LnNhdmVkT2JqZWN0c0NsaWVudCwgc3RhdGUgPSBfcmVmNC5zdGF0ZSwgc2V0U3RhdGUgPSBfcmVmNC5zZXRTdGF0ZSwgb25FcnJvciA9IF9yZWY0Lm9uRXJyb3IsIHJlcGxhY2VJZlBvc3NpYmxlID0gX3JlZjQucmVwbGFjZUlmUG9zc2libGU7CiAgICAgICAgICBfY29udGV4dDQucHJldiA9IDE7CiAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDQ7CiAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKGxvYWRJbmRleFBhdHRlcm5zKHsKICAgICAgICAgICAgc2F2ZWRPYmplY3RzQ2xpZW50OiBzYXZlZE9iamVjdHNDbGllbnQsCiAgICAgICAgICAgIGNhY2hlOiBzdGF0ZS5pbmRleFBhdHRlcm5zLAogICAgICAgICAgICBwYXR0ZXJuczogW2luZGV4UGF0dGVybklkXQogICAgICAgICAgfSkpOwoKICAgICAgICBjYXNlIDQ6CiAgICAgICAgICBfaW5kZXhQYXR0ZXJuczIgPSBfY29udGV4dDQuc2VudDsKICAgICAgICAgIHNldFN0YXRlKGZ1bmN0aW9uIChzKSB7CiAgICAgICAgICAgIHJldHVybiBfb2JqZWN0U3ByZWFkKHt9LCBzLCB7CiAgICAgICAgICAgICAgbGF5ZXJzOiBfb2JqZWN0U3ByZWFkKHt9LCBzLmxheWVycywgX2RlZmluZVByb3BlcnR5KHt9LCBsYXllcklkLCAoMCwgX3N0YXRlX2hlbHBlcnMudXBkYXRlTGF5ZXJJbmRleFBhdHRlcm4pKHMubGF5ZXJzW2xheWVySWRdLCBfaW5kZXhQYXR0ZXJuczJbaW5kZXhQYXR0ZXJuSWRdKSkpLAogICAgICAgICAgICAgIGluZGV4UGF0dGVybnM6IF9vYmplY3RTcHJlYWQoe30sIHMuaW5kZXhQYXR0ZXJucywgX2RlZmluZVByb3BlcnR5KHt9LCBpbmRleFBhdHRlcm5JZCwgX2luZGV4UGF0dGVybnMyW2luZGV4UGF0dGVybklkXSkpLAogICAgICAgICAgICAgIGN1cnJlbnRJbmRleFBhdHRlcm5JZDogcmVwbGFjZUlmUG9zc2libGUgPyBpbmRleFBhdHRlcm5JZCA6IHMuY3VycmVudEluZGV4UGF0dGVybklkCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDExOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgODoKICAgICAgICAgIF9jb250ZXh0NC5wcmV2ID0gODsKICAgICAgICAgIF9jb250ZXh0NC50MCA9IF9jb250ZXh0NFsiY2F0Y2giXSgxKTsKICAgICAgICAgIG9uRXJyb3IoX2NvbnRleHQ0LnQwKTsKCiAgICAgICAgY2FzZSAxMToKICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5zdG9wKCk7CiAgICAgIH0KICAgIH0KICB9LCBudWxsLCBudWxsLCBbWzEsIDhdXSk7Cn0KCmZ1bmN0aW9uIGxvYWRJbmRleFBhdHRlcm5SZWZzKHNhdmVkT2JqZWN0c0NsaWVudCkgewogIHZhciByZXN1bHQ7CiAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hc3luYyhmdW5jdGlvbiBsb2FkSW5kZXhQYXR0ZXJuUmVmcyQoX2NvbnRleHQ1KSB7CiAgICB3aGlsZSAoMSkgewogICAgICBzd2l0Y2ggKF9jb250ZXh0NS5wcmV2ID0gX2NvbnRleHQ1Lm5leHQpIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDI7CiAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKHNhdmVkT2JqZWN0c0NsaWVudC5maW5kKHsKICAgICAgICAgICAgdHlwZTogJ2luZGV4LXBhdHRlcm4nLAogICAgICAgICAgICBmaWVsZHM6IFsndGl0bGUnXSwKICAgICAgICAgICAgcGVyUGFnZTogMTAwMDAKICAgICAgICAgIH0pKTsKCiAgICAgICAgY2FzZSAyOgogICAgICAgICAgcmVzdWx0ID0gX2NvbnRleHQ1LnNlbnQ7CiAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LmFicnVwdCgicmV0dXJuIiwgcmVzdWx0LnNhdmVkT2JqZWN0cy5tYXAoZnVuY3Rpb24gKG8pIHsKICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICBpZDogU3RyaW5nKG8uaWQpLAogICAgICAgICAgICAgIHRpdGxlOiBvLmF0dHJpYnV0ZXMudGl0bGUKICAgICAgICAgICAgfTsKICAgICAgICAgIH0pLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgICAgICAgcmV0dXJuIGEudGl0bGUubG9jYWxlQ29tcGFyZShiLnRpdGxlKTsKICAgICAgICAgIH0pKTsKCiAgICAgICAgY2FzZSA0OgogICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LnN0b3AoKTsKICAgICAgfQogICAgfQogIH0pOwp9CgpmdW5jdGlvbiBzeW5jRXhpc3RpbmdGaWVsZHMoX3JlZjUpIHsKICB2YXIgaW5kZXhQYXR0ZXJucywgZGF0ZVJhbmdlLCBmZXRjaEpzb24sIHNldFN0YXRlLCBlbXB0aW5lc3NJbmZvOwogIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXN5bmMoZnVuY3Rpb24gc3luY0V4aXN0aW5nRmllbGRzJChfY29udGV4dDYpIHsKICAgIHdoaWxlICgxKSB7CiAgICAgIHN3aXRjaCAoX2NvbnRleHQ2LnByZXYgPSBfY29udGV4dDYubmV4dCkgewogICAgICAgIGNhc2UgMDoKICAgICAgICAgIGluZGV4UGF0dGVybnMgPSBfcmVmNS5pbmRleFBhdHRlcm5zLCBkYXRlUmFuZ2UgPSBfcmVmNS5kYXRlUmFuZ2UsIGZldGNoSnNvbiA9IF9yZWY1LmZldGNoSnNvbiwgc2V0U3RhdGUgPSBfcmVmNS5zZXRTdGF0ZTsKICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMzsKICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAoUHJvbWlzZS5hbGwoaW5kZXhQYXR0ZXJucy5tYXAoZnVuY3Rpb24gKHBhdHRlcm4pIHsKICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gewogICAgICAgICAgICAgIGZyb21EYXRlOiBkYXRlUmFuZ2UuZnJvbURhdGUsCiAgICAgICAgICAgICAgdG9EYXRlOiBkYXRlUmFuZ2UudG9EYXRlCiAgICAgICAgICAgIH07CgogICAgICAgICAgICBpZiAocGF0dGVybi50aW1lRmllbGROYW1lKSB7CiAgICAgICAgICAgICAgcXVlcnkudGltZUZpZWxkTmFtZSA9IHBhdHRlcm4udGltZUZpZWxkTmFtZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIGZldGNoSnNvbigiIi5jb25jYXQoX2NvbW1vbi5CQVNFX0FQSV9VUkwsICIvZXhpc3RpbmdfZmllbGRzLyIpLmNvbmNhdChwYXR0ZXJuLmlkKSwgewogICAgICAgICAgICAgIHF1ZXJ5OiBxdWVyeQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pKSk7CgogICAgICAgIGNhc2UgMzoKICAgICAgICAgIGVtcHRpbmVzc0luZm8gPSBfY29udGV4dDYuc2VudDsKICAgICAgICAgIHNldFN0YXRlKGZ1bmN0aW9uIChzdGF0ZSkgewogICAgICAgICAgICByZXR1cm4gX29iamVjdFNwcmVhZCh7fSwgc3RhdGUsIHsKICAgICAgICAgICAgICBleGlzdGluZ0ZpZWxkczogZW1wdGluZXNzSW5mby5yZWR1Y2UoZnVuY3Rpb24gKGFjYywgaW5mbykgewogICAgICAgICAgICAgICAgYWNjW2luZm8uaW5kZXhQYXR0ZXJuVGl0bGVdID0gYm9vbGVhbk1hcChpbmZvLmV4aXN0aW5nRmllbGROYW1lcyk7CiAgICAgICAgICAgICAgICByZXR1cm4gYWNjOwogICAgICAgICAgICAgIH0sIHN0YXRlLmV4aXN0aW5nRmllbGRzKQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pOwoKICAgICAgICBjYXNlIDU6CiAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgIHJldHVybiBfY29udGV4dDYuc3RvcCgpOwogICAgICB9CiAgICB9CiAgfSk7Cn0KCmZ1bmN0aW9uIGJvb2xlYW5NYXAoa2V5cykgewogIHJldHVybiBrZXlzLnJlZHVjZShmdW5jdGlvbiAoYWNjLCBrZXkpIHsKICAgIGFjY1trZXldID0gdHJ1ZTsKICAgIHJldHVybiBhY2M7CiAgfSwge30pOwp9CgpmdW5jdGlvbiBpc1NpbmdsZUVtcHR5TGF5ZXIobGF5ZXJNYXApIHsKICB2YXIgbGF5ZXJzID0gT2JqZWN0LnZhbHVlcyhsYXllck1hcCk7CiAgcmV0dXJuIGxheWVycy5sZW5ndGggPT09IDEgJiYgbGF5ZXJzWzBdLmNvbHVtbk9yZGVyLmxlbmd0aCA9PT0gMDsKfQoKZnVuY3Rpb24gZnJvbVNhdmVkT2JqZWN0KHNhdmVkT2JqZWN0KSB7CiAgdmFyIGlkID0gc2F2ZWRPYmplY3QuaWQsCiAgICAgIGF0dHJpYnV0ZXMgPSBzYXZlZE9iamVjdC5hdHRyaWJ1dGVzLAogICAgICB0eXBlID0gc2F2ZWRPYmplY3QudHlwZTsKCiAgdmFyIGluZGV4UGF0dGVybiA9IF9vYmplY3RTcHJlYWQoe30sIGF0dHJpYnV0ZXMsIHsKICAgIGlkOiBpZCwKICAgIHR5cGU6IHR5cGUsCiAgICB0aXRsZTogYXR0cmlidXRlcy50aXRsZSwKICAgIGZpZWxkczogSlNPTi5wYXJzZShhdHRyaWJ1dGVzLmZpZWxkcykuZmlsdGVyKGZ1bmN0aW9uIChmaWVsZCkgewogICAgICByZXR1cm4gISgwLCBfcHVibGljLmlzTmVzdGVkRmllbGQpKGZpZWxkKSAmJiAoISFmaWVsZC5hZ2dyZWdhdGFibGUgfHwgISFmaWVsZC5zY3JpcHRlZCk7CiAgICB9KS5jb25jYXQoX2RvY3VtZW50X2ZpZWxkLmRvY3VtZW50RmllbGQpLAogICAgdHlwZU1ldGE6IGF0dHJpYnV0ZXMudHlwZU1ldGEgPyBKU09OLnBhcnNlKGF0dHJpYnV0ZXMudHlwZU1ldGEpIDogdW5kZWZpbmVkLAogICAgZmllbGRGb3JtYXRNYXA6IGF0dHJpYnV0ZXMuZmllbGRGb3JtYXRNYXAgPyBKU09OLnBhcnNlKGF0dHJpYnV0ZXMuZmllbGRGb3JtYXRNYXApIDogdW5kZWZpbmVkCiAgfSk7CgogIHZhciB0eXBlTWV0YSA9IGluZGV4UGF0dGVybi50eXBlTWV0YTsKCiAgaWYgKCF0eXBlTWV0YSkgewogICAgcmV0dXJuIGluZGV4UGF0dGVybjsKICB9CgogIHZhciBhZ2dzID0gT2JqZWN0LmtleXModHlwZU1ldGEuYWdncyk7CgogIHZhciBuZXdGaWVsZHMgPSBfdG9Db25zdW1hYmxlQXJyYXkoaW5kZXhQYXR0ZXJuLmZpZWxkcyk7CgogIG5ld0ZpZWxkcy5mb3JFYWNoKGZ1bmN0aW9uIChmaWVsZCwgaW5kZXgpIHsKICAgIHZhciByZXN0cmljdGlvbnNPYmogPSB7fTsKICAgIGFnZ3MuZm9yRWFjaChmdW5jdGlvbiAoYWdnKSB7CiAgICAgIHZhciByZXN0cmljdGlvbiA9IHR5cGVNZXRhLmFnZ3NbYWdnXSAmJiB0eXBlTWV0YS5hZ2dzW2FnZ11bZmllbGQubmFtZV07CgogICAgICBpZiAocmVzdHJpY3Rpb24pIHsKICAgICAgICByZXN0cmljdGlvbnNPYmpbYWdnXSA9IHJlc3RyaWN0aW9uOwogICAgICB9CiAgICB9KTsKCiAgICBpZiAoT2JqZWN0LmtleXMocmVzdHJpY3Rpb25zT2JqKS5sZW5ndGgpIHsKICAgICAgbmV3RmllbGRzW2luZGV4XSA9IF9vYmplY3RTcHJlYWQoe30sIGZpZWxkLCB7CiAgICAgICAgYWdncmVnYXRpb25SZXN0cmljdGlvbnM6IHJlc3RyaWN0aW9uc09iagogICAgICB9KTsKICAgIH0KICB9KTsKICByZXR1cm4gewogICAgaWQ6IGluZGV4UGF0dGVybi5pZCwKICAgIHRpdGxlOiBpbmRleFBhdHRlcm4udGl0bGUsCiAgICB0aW1lRmllbGROYW1lOiBpbmRleFBhdHRlcm4udGltZUZpZWxkTmFtZSB8fCB1bmRlZmluZWQsCiAgICBmaWVsZHM6IG5ld0ZpZWxkcwogIH07Cn0="},null]}