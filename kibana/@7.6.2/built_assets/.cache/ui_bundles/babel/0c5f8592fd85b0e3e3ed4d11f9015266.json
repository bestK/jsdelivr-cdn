{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/security/public/views/management/role_mappings/edit_role_mapping/components/role_selector/role_selector.js","dependencies":[{"path":"x-pack/legacy/plugins/security/public/views/management/role_mappings/edit_role_mapping/components/role_selector/role_selector.js","mtime":1585205047240},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiKSB7IF90eXBlb2YyID0gZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mMiA9IGZ1bmN0aW9uIF90eXBlb2YyKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mMihvYmopOyB9CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuUm9sZVNlbGVjdG9yID0gdm9pZCAwOwoKdmFyIF9yZWFjdCA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoInJlYWN0IikpOwoKdmFyIF9pMThuID0gcmVxdWlyZSgiQGtibi9pMThuIik7Cgp2YXIgX2V1aSA9IHJlcXVpcmUoIkBlbGFzdGljL2V1aSIpOwoKdmFyIF9yb2xlc19hcGkgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi8uLi8uLi9saWIvcm9sZXNfYXBpIik7Cgp2YXIgX2FkZF9yb2xlX3RlbXBsYXRlX2J1dHRvbiA9IHJlcXVpcmUoIi4vYWRkX3JvbGVfdGVtcGxhdGVfYnV0dG9uIik7Cgp2YXIgX3JvbGVfdGVtcGxhdGVfZWRpdG9yID0gcmVxdWlyZSgiLi9yb2xlX3RlbXBsYXRlX2VkaXRvciIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7CiAgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgewogICAgcmV0dXJuIG9iajsKICB9IGVsc2UgewogICAgdmFyIG5ld09iaiA9IHt9OwoKICAgIGlmIChvYmogIT0gbnVsbCkgewogICAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7CiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHsKICAgICAgICAgIHZhciBkZXNjID0gT2JqZWN0LmRlZmluZVByb3BlcnR5ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KSA6IHt9OwoKICAgICAgICAgIGlmIChkZXNjLmdldCB8fCBkZXNjLnNldCkgewogICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobmV3T2JqLCBrZXksIGRlc2MpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBuZXdPYmouZGVmYXVsdCA9IG9iajsKICAgIHJldHVybiBuZXdPYmo7CiAgfQp9CgpmdW5jdGlvbiBfdHlwZW9mKG9iaikgewogIGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIF90eXBlb2YyKFN5bWJvbC5pdGVyYXRvcikgPT09ICJzeW1ib2wiKSB7CiAgICBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsKICAgICAgcmV0dXJuIF90eXBlb2YyKG9iaik7CiAgICB9OwogIH0gZWxzZSB7CiAgICBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsKICAgICAgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogX3R5cGVvZjIob2JqKTsKICAgIH07CiAgfQoKICByZXR1cm4gX3R5cGVvZihvYmopOwp9CgpmdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7CiAgcmV0dXJuIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfbm9uSXRlcmFibGVTcHJlYWQoKTsKfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlU3ByZWFkKCkgewogIHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7Cn0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXkoaXRlcikgewogIGlmIChTeW1ib2wuaXRlcmF0b3IgaW4gT2JqZWN0KGl0ZXIpIHx8IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChpdGVyKSA9PT0gIltvYmplY3QgQXJndW1lbnRzXSIpIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpOwp9CgpmdW5jdGlvbiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgewogICAgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkoYXJyLmxlbmd0aCk7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHsKICAgICAgYXJyMltpXSA9IGFycltpXTsKICAgIH0KCiAgICByZXR1cm4gYXJyMjsKICB9Cn0KCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgewogIHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsKCiAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsKICAgIHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOwogICAgaWYgKGVudW1lcmFibGVPbmx5KSBzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgewogICAgICByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsKICAgIH0pOwogICAga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOwogIH0KCiAgcmV0dXJuIGtleXM7Cn0KCmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7CiAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsKICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OwoKICAgIGlmIChpICUgMikgewogICAgICBvd25LZXlzKHNvdXJjZSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7CiAgICAgIH0pOwogICAgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgewogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpOwogICAgfSBlbHNlIHsKICAgICAgb3duS2V5cyhzb3VyY2UpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOwogICAgICB9KTsKICAgIH0KICB9CgogIHJldHVybiB0YXJnZXQ7Cn0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsKICBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7CiAgfQp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgewogICAgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsKICAgIGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsKICAgIGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsKICAgIGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOwogIH0KfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgewogIGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOwogIGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsKICByZXR1cm4gQ29uc3RydWN0b3I7Cn0KCmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsKICBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpKSB7CiAgICByZXR1cm4gY2FsbDsKICB9CgogIHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOwp9CgpmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgewogIF9nZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7CiAgICByZXR1cm4gby5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKG8pOwogIH07CiAgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsKfQoKZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7CiAgaWYgKHNlbGYgPT09IHZvaWQgMCkgewogICAgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsKICB9CgogIHJldHVybiBzZWxmOwp9CgpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsKICBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICJmdW5jdGlvbiIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24iKTsKICB9CgogIHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgewogICAgY29uc3RydWN0b3I6IHsKICAgICAgdmFsdWU6IHN1YkNsYXNzLAogICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlCiAgICB9CiAgfSk7CiAgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcyk7Cn0KCmZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7CiAgX3NldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IGZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7CiAgICBvLl9fcHJvdG9fXyA9IHA7CiAgICByZXR1cm4gbzsKICB9OwoKICByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApOwp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7CiAgaWYgKGtleSBpbiBvYmopIHsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgICB2YWx1ZTogdmFsdWUsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgd3JpdGFibGU6IHRydWUKICAgIH0pOwogIH0gZWxzZSB7CiAgICBvYmpba2V5XSA9IHZhbHVlOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKdmFyIFJvbGVTZWxlY3RvciA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKF9SZWFjdCRDb21wb25lbnQpIHsKICBfaW5oZXJpdHMoUm9sZVNlbGVjdG9yLCBfUmVhY3QkQ29tcG9uZW50KTsKCiAgZnVuY3Rpb24gUm9sZVNlbGVjdG9yKHByb3BzKSB7CiAgICB2YXIgX3RoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFJvbGVTZWxlY3Rvcik7CgogICAgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfZ2V0UHJvdG90eXBlT2YoUm9sZVNlbGVjdG9yKS5jYWxsKHRoaXMsIHByb3BzKSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiZ2V0Um9sZUNvbWJvQm94IiwgZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3RoaXMkcHJvcHMkcm9sZU1hcHBpID0gX3RoaXMucHJvcHMucm9sZU1hcHBpbmcucm9sZXMsCiAgICAgICAgICByb2xlcyA9IF90aGlzJHByb3BzJHJvbGVNYXBwaSA9PT0gdm9pZCAwID8gW10gOiBfdGhpcyRwcm9wcyRyb2xlTWFwcGk7CiAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQ29tYm9Cb3gsIHsKICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiAicm9sZU1hcHBpbmdGb3JtUm9sZUNvbWJvQm94IiwKICAgICAgICBwbGFjZWhvbGRlcjogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLnNlY3VyaXR5Lm1hbmFnZW1lbnQuZWRpdFJvbGVNYXBwaW5nLnNlbGVjdFJvbGVzUGxhY2Vob2xkZXInLCB7CiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1NlbGVjdCBvbmUgb3IgbW9yZSByb2xlcycKICAgICAgICB9KSwKICAgICAgICBpc0xvYWRpbmc6IF90aGlzLnN0YXRlLnJvbGVzLmxlbmd0aCA9PT0gMCwKICAgICAgICBvcHRpb25zOiBfdGhpcy5zdGF0ZS5yb2xlcy5tYXAoZnVuY3Rpb24gKHIpIHsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGxhYmVsOiByLm5hbWUKICAgICAgICAgIH07CiAgICAgICAgfSksCiAgICAgICAgc2VsZWN0ZWRPcHRpb25zOiByb2xlcy5tYXAoZnVuY3Rpb24gKHIpIHsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGxhYmVsOiByCiAgICAgICAgICB9OwogICAgICAgIH0pLAogICAgICAgIG9uQ2hhbmdlOiBmdW5jdGlvbiBvbkNoYW5nZShzZWxlY3RlZE9wdGlvbnMpIHsKICAgICAgICAgIF90aGlzLnByb3BzLm9uQ2hhbmdlKF9vYmplY3RTcHJlYWQoe30sIF90aGlzLnByb3BzLnJvbGVNYXBwaW5nLCB7CiAgICAgICAgICAgIHJvbGVzOiBzZWxlY3RlZE9wdGlvbnMubWFwKGZ1bmN0aW9uIChzbykgewogICAgICAgICAgICAgIHJldHVybiBzby5sYWJlbDsKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIHJvbGVfdGVtcGxhdGVzOiBbXQogICAgICAgICAgfSkpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJnZXRSb2xlVGVtcGxhdGVzIiwgZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3RoaXMkcHJvcHMkcm9sZU1hcHBpMiA9IF90aGlzLnByb3BzLnJvbGVNYXBwaW5nLnJvbGVfdGVtcGxhdGVzLAogICAgICAgICAgcm9sZVRlbXBsYXRlcyA9IF90aGlzJHByb3BzJHJvbGVNYXBwaTIgPT09IHZvaWQgMCA/IFtdIDogX3RoaXMkcHJvcHMkcm9sZU1hcHBpMjsKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIG51bGwsIHJvbGVUZW1wbGF0ZXMubWFwKGZ1bmN0aW9uIChydCwgaW5kZXgpIHsKICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRnJhZ21lbnQsIHsKICAgICAgICAgIGtleTogaW5kZXgKICAgICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yb2xlX3RlbXBsYXRlX2VkaXRvci5Sb2xlVGVtcGxhdGVFZGl0b3IsIHsKICAgICAgICAgIGNhblVzZVN0b3JlZFNjcmlwdHM6IF90aGlzLnByb3BzLmNhblVzZVN0b3JlZFNjcmlwdHMsCiAgICAgICAgICBjYW5Vc2VJbmxpbmVTY3JpcHRzOiBfdGhpcy5wcm9wcy5jYW5Vc2VJbmxpbmVTY3JpcHRzLAogICAgICAgICAgcm9sZVRlbXBsYXRlOiBydCwKICAgICAgICAgIG9uQ2hhbmdlOiBmdW5jdGlvbiBvbkNoYW5nZSh1cGRhdGVkVGVtcGxhdGUpIHsKICAgICAgICAgICAgdmFyIHRlbXBsYXRlcyA9IF90b0NvbnN1bWFibGVBcnJheShfdGhpcy5wcm9wcy5yb2xlTWFwcGluZy5yb2xlX3RlbXBsYXRlcyB8fCBbXSk7CgogICAgICAgICAgICB0ZW1wbGF0ZXMuc3BsaWNlKGluZGV4LCAxLCB1cGRhdGVkVGVtcGxhdGUpOwoKICAgICAgICAgICAgX3RoaXMucHJvcHMub25DaGFuZ2UoX29iamVjdFNwcmVhZCh7fSwgX3RoaXMucHJvcHMucm9sZU1hcHBpbmcsIHsKICAgICAgICAgICAgICByb2xlX3RlbXBsYXRlczogdGVtcGxhdGVzCiAgICAgICAgICAgIH0pKTsKICAgICAgICAgIH0sCiAgICAgICAgICBvbkRlbGV0ZTogZnVuY3Rpb24gb25EZWxldGUoKSB7CiAgICAgICAgICAgIHZhciB0ZW1wbGF0ZXMgPSBfdG9Db25zdW1hYmxlQXJyYXkoX3RoaXMucHJvcHMucm9sZU1hcHBpbmcucm9sZV90ZW1wbGF0ZXMgfHwgW10pOwoKICAgICAgICAgICAgdGVtcGxhdGVzLnNwbGljZShpbmRleCwgMSk7CgogICAgICAgICAgICBfdGhpcy5wcm9wcy5vbkNoYW5nZShfb2JqZWN0U3ByZWFkKHt9LCBfdGhpcy5wcm9wcy5yb2xlTWFwcGluZywgewogICAgICAgICAgICAgIHJvbGVfdGVtcGxhdGVzOiB0ZW1wbGF0ZXMKICAgICAgICAgICAgfSkpOwogICAgICAgICAgfQogICAgICAgIH0pLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpSG9yaXpvbnRhbFJ1bGUsIG51bGwpKTsKICAgICAgfSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2FkZF9yb2xlX3RlbXBsYXRlX2J1dHRvbi5BZGRSb2xlVGVtcGxhdGVCdXR0b24sIHsKICAgICAgICBjYW5Vc2VTdG9yZWRTY3JpcHRzOiBfdGhpcy5wcm9wcy5jYW5Vc2VTdG9yZWRTY3JpcHRzLAogICAgICAgIGNhblVzZUlubGluZVNjcmlwdHM6IF90aGlzLnByb3BzLmNhblVzZUlubGluZVNjcmlwdHMsCiAgICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljayh0eXBlKSB7CiAgICAgICAgICBzd2l0Y2ggKHR5cGUpIHsKICAgICAgICAgICAgY2FzZSAnaW5saW5lJzoKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgdGVtcGxhdGVzID0gX3RoaXMucHJvcHMucm9sZU1hcHBpbmcucm9sZV90ZW1wbGF0ZXMgfHwgW107CgogICAgICAgICAgICAgICAgX3RoaXMucHJvcHMub25DaGFuZ2UoX29iamVjdFNwcmVhZCh7fSwgX3RoaXMucHJvcHMucm9sZU1hcHBpbmcsIHsKICAgICAgICAgICAgICAgICAgcm9sZXM6IFtdLAogICAgICAgICAgICAgICAgICByb2xlX3RlbXBsYXRlczogW10uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheSh0ZW1wbGF0ZXMpLCBbewogICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlOiB7CiAgICAgICAgICAgICAgICAgICAgICBzb3VyY2U6ICcnCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9XSkKICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICBjYXNlICdzdG9yZWQnOgogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBfdGVtcGxhdGVzID0gX3RoaXMucHJvcHMucm9sZU1hcHBpbmcucm9sZV90ZW1wbGF0ZXMgfHwgW107CgogICAgICAgICAgICAgICAgX3RoaXMucHJvcHMub25DaGFuZ2UoX29iamVjdFNwcmVhZCh7fSwgX3RoaXMucHJvcHMucm9sZU1hcHBpbmcsIHsKICAgICAgICAgICAgICAgICAgcm9sZXM6IFtdLAogICAgICAgICAgICAgICAgICByb2xlX3RlbXBsYXRlczogW10uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShfdGVtcGxhdGVzKSwgW3sKICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogewogICAgICAgICAgICAgICAgICAgICAgaWQ6ICcnCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9XSkKICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiVW5zdXBwb3J0ZWQgdGVtcGxhdGUgdHlwZTogIi5jb25jYXQodHlwZSkpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSkpOwogICAgfSk7CgogICAgX3RoaXMuc3RhdGUgPSB7CiAgICAgIHJvbGVzOiBbXQogICAgfTsKICAgIHJldHVybiBfdGhpczsKICB9CgogIF9jcmVhdGVDbGFzcyhSb2xlU2VsZWN0b3IsIFt7CiAgICBrZXk6ICJjb21wb25lbnREaWRNb3VudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50RGlkTW91bnQoKSB7CiAgICAgIHZhciByb2xlczsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hc3luYyhmdW5jdGlvbiBjb21wb25lbnREaWRNb3VudCQoX2NvbnRleHQpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI7CiAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hd3JhcChfcm9sZXNfYXBpLlJvbGVzQXBpLmdldFJvbGVzKCkpOwoKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgIHJvbGVzID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgIHJvbGVzOiByb2xlcwogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBudWxsLCB0aGlzKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHsKICAgICAgdmFyIG1vZGUgPSB0aGlzLnByb3BzLm1vZGU7CiAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRm9ybVJvdywgewogICAgICAgIGZ1bGxXaWR0aDogdHJ1ZQogICAgICB9LCBtb2RlID09PSAncm9sZXMnID8gdGhpcy5nZXRSb2xlQ29tYm9Cb3goKSA6IHRoaXMuZ2V0Um9sZVRlbXBsYXRlcygpKTsKICAgIH0KICB9XSk7CgogIHJldHVybiBSb2xlU2VsZWN0b3I7Cn0oX3JlYWN0LmRlZmF1bHQuQ29tcG9uZW50KTsKCmV4cG9ydHMuUm9sZVNlbGVjdG9yID0gUm9sZVNlbGVjdG9yOw=="},null]}