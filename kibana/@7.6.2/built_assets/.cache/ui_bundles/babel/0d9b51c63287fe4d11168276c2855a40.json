{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/ml/public/application/components/anomalies_table/anomaly_details.js","dependencies":[{"path":"x-pack/legacy/plugins/ml/public/application/components/anomalies_table/anomaly_details.js","mtime":1585205045457},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkFub21hbHlEZXRhaWxzID0gdm9pZCAwOwoKdmFyIF9wcm9wVHlwZXMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoInByb3AtdHlwZXMiKSk7Cgp2YXIgX3JlYWN0ID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgicmVhY3QiKSk7Cgp2YXIgX2xvZGFzaCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgibG9kYXNoIikpOwoKdmFyIF9pMThuID0gcmVxdWlyZSgiQGtibi9pMThuIik7Cgp2YXIgX3JlYWN0MiA9IHJlcXVpcmUoIkBrYm4vaTE4bi9yZWFjdCIpOwoKdmFyIF9ldWkgPSByZXF1aXJlKCJAZWxhc3RpYy9ldWkiKTsKCnZhciBfZGF0ZV91dGlscyA9IHJlcXVpcmUoIi4uLy4uL3V0aWwvZGF0ZV91dGlscyIpOwoKdmFyIF9lbnRpdHlfY2VsbCA9IHJlcXVpcmUoIi4uL2VudGl0eV9jZWxsIik7Cgp2YXIgX2Fub21hbHlfdXRpbHMgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9jb21tb24vdXRpbC9hbm9tYWx5X3V0aWxzIik7Cgp2YXIgX211bHRpX2J1Y2tldF9pbXBhY3QgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9jb21tb24vY29uc3RhbnRzL211bHRpX2J1Y2tldF9pbXBhY3QiKTsKCnZhciBfZm9ybWF0X3ZhbHVlID0gcmVxdWlyZSgiLi4vLi4vZm9ybWF0dGVycy9mb3JtYXRfdmFsdWUiKTsKCnZhciBfYW5vbWFsaWVzX3RhYmxlX2NvbnN0YW50cyA9IHJlcXVpcmUoIi4vYW5vbWFsaWVzX3RhYmxlX2NvbnN0YW50cyIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7IGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsgcmV0dXJuIG9iajsgfSBlbHNlIHsgdmFyIG5ld09iaiA9IHt9OyBpZiAob2JqICE9IG51bGwpIHsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgeyB2YXIgZGVzYyA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSAmJiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID8gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIGtleSkgOiB7fTsgaWYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmosIGtleSwgZGVzYyk7IH0gZWxzZSB7IG5ld09ialtrZXldID0gb2JqW2tleV07IH0gfSB9IH0gbmV3T2JqLmRlZmF1bHQgPSBvYmo7IHJldHVybiBuZXdPYmo7IH0gfQoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiKSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfTsgfSBlbHNlIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyAic3ltYm9sIiA6IHR5cGVvZiBvYmo7IH07IH0gcmV0dXJuIF90eXBlb2Yob2JqKTsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH0KCmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKGNhbGwgJiYgKF90eXBlb2YoY2FsbCkgPT09ICJvYmplY3QiIHx8IHR5cGVvZiBjYWxsID09PSAiZnVuY3Rpb24iKSkgeyByZXR1cm4gY2FsbDsgfSByZXR1cm4gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKTsgfQoKZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7IGlmIChzZWxmID09PSB2b2lkIDApIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsgfSByZXR1cm4gc2VsZjsgfQoKZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgX2dldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LmdldFByb3RvdHlwZU9mIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgcmV0dXJuIG8uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihvKTsgfTsgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsgfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uIik7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTsgfQoKZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgX3NldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IGZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IG8uX19wcm90b19fID0gcDsgcmV0dXJuIG87IH07IHJldHVybiBfc2V0UHJvdG90eXBlT2YobywgcCk7IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsgaWYgKGtleSBpbiBvYmopIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7IHZhbHVlOiB2YWx1ZSwgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTsgfSBlbHNlIHsgb2JqW2tleV0gPSB2YWx1ZTsgfSByZXR1cm4gb2JqOyB9Cgp2YXIgVElNRV9GSUVMRF9OQU1FID0gJ3RpbWVzdGFtcCc7CgpmdW5jdGlvbiBnZXRGaWx0ZXJFbnRpdHkoZW50aXR5TmFtZSwgZW50aXR5VmFsdWUsIGZpbHRlcikgewogIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9lbnRpdHlfY2VsbC5FbnRpdHlDZWxsLCB7CiAgICBlbnRpdHlOYW1lOiBlbnRpdHlOYW1lLAogICAgZW50aXR5VmFsdWU6IGVudGl0eVZhbHVlLAogICAgZmlsdGVyOiBmaWx0ZXIKICB9KTsKfQoKZnVuY3Rpb24gZ2V0RGV0YWlsc0l0ZW1zKGFub21hbHksIGV4YW1wbGVzLCBmaWx0ZXIpIHsKICB2YXIgc291cmNlID0gYW5vbWFseS5zb3VyY2U7IC8vIFRPRE8gLSB3aGVuIG11bHRpdmFyaWF0ZSBhbmFseXNlcyBhcmUgbW9yZSBjb21tb24sCiAgLy8gbG9vayBpbiBlYWNoIGNhdXNlIGZvciBhICdjb3JyZWxhdGVkQnlGaWVsZFZhbHVlJyBmaWVsZCwKCiAgdmFyIGNhdXNlcyA9IFtdOwogIHZhciBzb3VyY2VDYXVzZXMgPSBzb3VyY2UuY2F1c2VzIHx8IFtdOwogIHZhciBzaW5nbGVDYXVzZUJ5RmllbGROYW1lID0gdW5kZWZpbmVkOwogIHZhciBzaW5nbGVDYXVzZUJ5RmllbGRWYWx1ZSA9IHVuZGVmaW5lZDsKCiAgaWYgKHNvdXJjZUNhdXNlcy5sZW5ndGggPT09IDEpIHsKICAgIC8vIE1ldHJpY3MgYW5kIHByb2JhYmlsaXR5IHdpbGwgYWxyZWFkeSBoYXZlIGJlZW4gcGxhY2VkIGF0IHRoZSB0b3AgbGV2ZWwuCiAgICAvLyBJZiBjYXVzZSBoYXMgYnlGaWVsZFZhbHVlLCBtb3ZlIGl0IHRvIGEgdG9wIGxldmVsIGZpZWxkcyBmb3IgZGlzcGxheS4KICAgIGlmIChzb3VyY2VDYXVzZXNbMF0uYnlfZmllbGRfbmFtZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIHNpbmdsZUNhdXNlQnlGaWVsZE5hbWUgPSBzb3VyY2VDYXVzZXNbMF0uYnlfZmllbGRfbmFtZTsKICAgICAgc2luZ2xlQ2F1c2VCeUZpZWxkVmFsdWUgPSBzb3VyY2VDYXVzZXNbMF0uYnlfZmllbGRfdmFsdWU7CiAgICB9CiAgfSBlbHNlIHsKICAgIGNhdXNlcyA9IHNvdXJjZUNhdXNlcy5tYXAoZnVuY3Rpb24gKGNhdXNlKSB7CiAgICAgIHZhciBzaW1wbGlmaWVkID0gX2xvZGFzaC5kZWZhdWx0LnBpY2soY2F1c2UsICd0eXBpY2FsJywgJ2FjdHVhbCcsICdwcm9iYWJpbGl0eScpOyAvLyBHZXQgdGhlICdlbnRpdHkgZmllbGQgbmFtZS92YWx1ZScgdG8gZGlzcGxheSBpbiB0aGUgY2F1c2UgLQogICAgICAvLyBGb3IgYnkgYW5kIG92ZXIsIHVzZSBieV9maWVsZF9uYW1lL3ZhbHVlIChvdmVyX2ZpZWxkX25hbWUvdmFsdWUgYXJlIGluIHRoZSB0b3AgbGV2ZWwgZmllbGRzKQogICAgICAvLyBGb3IganVzdCBhbiAnb3ZlcicgZmllbGQgLSB0aGUgb3Zlcl9maWVsZF9uYW1lL3ZhbHVlIGFwcGVhciBpbiBib3RoIHRvcCBsZXZlbCBhbmQgY2F1c2UuCgoKICAgICAgc2ltcGxpZmllZC5lbnRpdHlOYW1lID0gX2xvZGFzaC5kZWZhdWx0LmhhcyhjYXVzZSwgJ2J5X2ZpZWxkX25hbWUnKSA/IGNhdXNlLmJ5X2ZpZWxkX25hbWUgOiBjYXVzZS5vdmVyX2ZpZWxkX25hbWU7CiAgICAgIHNpbXBsaWZpZWQuZW50aXR5VmFsdWUgPSBfbG9kYXNoLmRlZmF1bHQuaGFzKGNhdXNlLCAnYnlfZmllbGRfdmFsdWUnKSA/IGNhdXNlLmJ5X2ZpZWxkX3ZhbHVlIDogY2F1c2Uub3Zlcl9maWVsZF92YWx1ZTsKICAgICAgcmV0dXJuIHNpbXBsaWZpZWQ7CiAgICB9KTsKICB9CgogIHZhciBpdGVtcyA9IFtdOwoKICBpZiAoc291cmNlLnBhcnRpdGlvbl9maWVsZF92YWx1ZSAhPT0gdW5kZWZpbmVkKSB7CiAgICBpdGVtcy5wdXNoKHsKICAgICAgdGl0bGU6IHNvdXJjZS5wYXJ0aXRpb25fZmllbGRfbmFtZSwKICAgICAgZGVzY3JpcHRpb246IGdldEZpbHRlckVudGl0eShzb3VyY2UucGFydGl0aW9uX2ZpZWxkX25hbWUsIHNvdXJjZS5wYXJ0aXRpb25fZmllbGRfdmFsdWUsIGZpbHRlcikKICAgIH0pOwogIH0KCiAgaWYgKHNvdXJjZS5ieV9maWVsZF92YWx1ZSAhPT0gdW5kZWZpbmVkKSB7CiAgICBpdGVtcy5wdXNoKHsKICAgICAgdGl0bGU6IHNvdXJjZS5ieV9maWVsZF9uYW1lLAogICAgICBkZXNjcmlwdGlvbjogZ2V0RmlsdGVyRW50aXR5KHNvdXJjZS5ieV9maWVsZF9uYW1lLCBzb3VyY2UuYnlfZmllbGRfdmFsdWUsIGZpbHRlcikKICAgIH0pOwogIH0KCiAgaWYgKHNpbmdsZUNhdXNlQnlGaWVsZE5hbWUgIT09IHVuZGVmaW5lZCkgewogICAgLy8gRGlzcGxheSBieUZpZWxkIG9mIHNpbmdsZSBjYXVzZS4KICAgIGl0ZW1zLnB1c2goewogICAgICB0aXRsZTogc2luZ2xlQ2F1c2VCeUZpZWxkTmFtZSwKICAgICAgZGVzY3JpcHRpb246IGdldEZpbHRlckVudGl0eShzaW5nbGVDYXVzZUJ5RmllbGROYW1lLCBzaW5nbGVDYXVzZUJ5RmllbGRWYWx1ZSwgZmlsdGVyKQogICAgfSk7CiAgfQoKICBpZiAoc291cmNlLm92ZXJfZmllbGRfdmFsdWUgIT09IHVuZGVmaW5lZCkgewogICAgaXRlbXMucHVzaCh7CiAgICAgIHRpdGxlOiBzb3VyY2Uub3Zlcl9maWVsZF9uYW1lLAogICAgICBkZXNjcmlwdGlvbjogZ2V0RmlsdGVyRW50aXR5KHNvdXJjZS5vdmVyX2ZpZWxkX25hbWUsIHNvdXJjZS5vdmVyX2ZpZWxkX3ZhbHVlLCBmaWx0ZXIpCiAgICB9KTsKICB9CgogIHZhciBhbm9tYWx5VGltZSA9IHNvdXJjZVtUSU1FX0ZJRUxEX05BTUVdOwogIHZhciB0aW1lRGVzYyA9ICIiLmNvbmNhdCgoMCwgX2RhdGVfdXRpbHMuZm9ybWF0SHVtYW5SZWFkYWJsZURhdGVUaW1lU2Vjb25kcykoYW5vbWFseVRpbWUpKTsKCiAgaWYgKHNvdXJjZS5idWNrZXRfc3BhbiAhPT0gdW5kZWZpbmVkKSB7CiAgICB2YXIgYW5vbWFseUVuZFRpbWUgPSBhbm9tYWx5VGltZSArIHNvdXJjZS5idWNrZXRfc3BhbiAqIDEwMDA7CiAgICB0aW1lRGVzYyA9IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tbC5hbm9tYWxpZXNUYWJsZS5hbm9tYWx5RGV0YWlscy5hbm9tYWx5VGltZVJhbmdlTGFiZWwnLCB7CiAgICAgIGRlZmF1bHRNZXNzYWdlOiAne2Fub21hbHlUaW1lfSB0byB7YW5vbWFseUVuZFRpbWV9JywKICAgICAgdmFsdWVzOiB7CiAgICAgICAgYW5vbWFseVRpbWU6ICgwLCBfZGF0ZV91dGlscy5mb3JtYXRIdW1hblJlYWRhYmxlRGF0ZVRpbWVTZWNvbmRzKShhbm9tYWx5VGltZSksCiAgICAgICAgYW5vbWFseUVuZFRpbWU6ICgwLCBfZGF0ZV91dGlscy5mb3JtYXRIdW1hblJlYWRhYmxlRGF0ZVRpbWVTZWNvbmRzKShhbm9tYWx5RW5kVGltZSkKICAgICAgfQogICAgfSk7CiAgfQoKICBpdGVtcy5wdXNoKHsKICAgIHRpdGxlOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWwuYW5vbWFsaWVzVGFibGUuYW5vbWFseURldGFpbHMudGltZVRpdGxlJywgewogICAgICBkZWZhdWx0TWVzc2FnZTogJ3RpbWUnCiAgICB9KSwKICAgIGRlc2NyaXB0aW9uOiB0aW1lRGVzYwogIH0pOwogIGl0ZW1zLnB1c2goewogICAgdGl0bGU6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tbC5hbm9tYWxpZXNUYWJsZS5hbm9tYWx5RGV0YWlscy5mdW5jdGlvblRpdGxlJywgewogICAgICBkZWZhdWx0TWVzc2FnZTogJ2Z1bmN0aW9uJwogICAgfSksCiAgICBkZXNjcmlwdGlvbjogc291cmNlLmZ1bmN0aW9uICE9PSAnbWV0cmljJyA/IHNvdXJjZS5mdW5jdGlvbiA6IHNvdXJjZS5mdW5jdGlvbl9kZXNjcmlwdGlvbgogIH0pOwoKICBpZiAoc291cmNlLmZpZWxkX25hbWUgIT09IHVuZGVmaW5lZCkgewogICAgaXRlbXMucHVzaCh7CiAgICAgIHRpdGxlOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWwuYW5vbWFsaWVzVGFibGUuYW5vbWFseURldGFpbHMuZmllbGROYW1lVGl0bGUnLCB7CiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdmaWVsZE5hbWUnCiAgICAgIH0pLAogICAgICBkZXNjcmlwdGlvbjogc291cmNlLmZpZWxkX25hbWUKICAgIH0pOwogIH0KCiAgdmFyIGZ1bmN0aW9uRGVzY3JpcHRpb24gPSBzb3VyY2UuZnVuY3Rpb25fZGVzY3JpcHRpb24gfHwgJyc7CgogIGlmIChhbm9tYWx5LmFjdHVhbCAhPT0gdW5kZWZpbmVkICYmICgwLCBfYW5vbWFseV91dGlscy5zaG93QWN0dWFsRm9yRnVuY3Rpb24pKGZ1bmN0aW9uRGVzY3JpcHRpb24pID09PSB0cnVlKSB7CiAgICBpdGVtcy5wdXNoKHsKICAgICAgdGl0bGU6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tbC5hbm9tYWxpZXNUYWJsZS5hbm9tYWx5RGV0YWlscy5hY3R1YWxUaXRsZScsIHsKICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ2FjdHVhbCcKICAgICAgfSksCiAgICAgIGRlc2NyaXB0aW9uOiAoMCwgX2Zvcm1hdF92YWx1ZS5mb3JtYXRWYWx1ZSkoYW5vbWFseS5hY3R1YWwsIHNvdXJjZS5mdW5jdGlvbiwgdW5kZWZpbmVkLCBzb3VyY2UpCiAgICB9KTsKICB9CgogIGlmIChhbm9tYWx5LnR5cGljYWwgIT09IHVuZGVmaW5lZCAmJiAoMCwgX2Fub21hbHlfdXRpbHMuc2hvd1R5cGljYWxGb3JGdW5jdGlvbikoZnVuY3Rpb25EZXNjcmlwdGlvbikgPT09IHRydWUpIHsKICAgIGl0ZW1zLnB1c2goewogICAgICB0aXRsZTogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1sLmFub21hbGllc1RhYmxlLmFub21hbHlEZXRhaWxzLnR5cGljYWxUaXRsZScsIHsKICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ3R5cGljYWwnCiAgICAgIH0pLAogICAgICBkZXNjcmlwdGlvbjogKDAsIF9mb3JtYXRfdmFsdWUuZm9ybWF0VmFsdWUpKGFub21hbHkudHlwaWNhbCwgc291cmNlLmZ1bmN0aW9uLCB1bmRlZmluZWQsIHNvdXJjZSkKICAgIH0pOwogIH0KCiAgaXRlbXMucHVzaCh7CiAgICB0aXRsZTogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1sLmFub21hbGllc1RhYmxlLmFub21hbHlEZXRhaWxzLmpvYklkVGl0bGUnLCB7CiAgICAgIGRlZmF1bHRNZXNzYWdlOiAnam9iIElEJwogICAgfSksCiAgICBkZXNjcmlwdGlvbjogYW5vbWFseS5qb2JJZAogIH0pOwoKICBpZiAoc291cmNlLm11bHRpX2J1Y2tldF9pbXBhY3QgIT09IHVuZGVmaW5lZCAmJiBzb3VyY2UubXVsdGlfYnVja2V0X2ltcGFjdCA+PSBfbXVsdGlfYnVja2V0X2ltcGFjdC5NVUxUSV9CVUNLRVRfSU1QQUNULkxPVykgewogICAgaXRlbXMucHVzaCh7CiAgICAgIHRpdGxlOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWwuYW5vbWFsaWVzVGFibGUuYW5vbWFseURldGFpbHMubXVsdGlCdWNrZXRJbXBhY3RUaXRsZScsIHsKICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ211bHRpLWJ1Y2tldCBpbXBhY3QnCiAgICAgIH0pLAogICAgICBkZXNjcmlwdGlvbjogKDAsIF9hbm9tYWx5X3V0aWxzLmdldE11bHRpQnVja2V0SW1wYWN0TGFiZWwpKHNvdXJjZS5tdWx0aV9idWNrZXRfaW1wYWN0KQogICAgfSk7CiAgfQoKICBpdGVtcy5wdXNoKHsKICAgIHRpdGxlOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWwuYW5vbWFsaWVzVGFibGUuYW5vbWFseURldGFpbHMucHJvYmFiaWxpdHlUaXRsZScsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdwcm9iYWJpbGl0eScKICAgIH0pLAogICAgZGVzY3JpcHRpb246IHNvdXJjZS5wcm9iYWJpbGl0eQogIH0pOyAvLyBJZiB0aGVyZSB3YXMgb25seSBvbmUgY2F1c2UsIHRoZSBhY3R1YWwsIHR5cGljYWwgYW5kIGJ5X2ZpZWxkCiAgLy8gd2lsbCBhbHJlYWR5IGhhdmUgYmVlbiBhZGRlZCBmb3IgZGlzcGxheS4KCiAgaWYgKGNhdXNlcy5sZW5ndGggPiAxKSB7CiAgICBjYXVzZXMuZm9yRWFjaChmdW5jdGlvbiAoY2F1c2UsIGluZGV4KSB7CiAgICAgIHZhciB0aXRsZSA9IGluZGV4ID09PSAwID8gX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1sLmFub21hbGllc1RhYmxlLmFub21hbHlEZXRhaWxzLmNhdXNlVmFsdWVzVGl0bGUnLCB7CiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICd7Y2F1c2VFbnRpdHlOYW1lfSB2YWx1ZXMnLAogICAgICAgIHZhbHVlczogewogICAgICAgICAgY2F1c2VFbnRpdHlOYW1lOiBjYXVzZS5lbnRpdHlOYW1lCiAgICAgICAgfQogICAgICB9KSA6ICcnOwoKICAgICAgdmFyIGRlc2NyaXB0aW9uID0gX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1sLmFub21hbGllc1RhYmxlLmFub21hbHlEZXRhaWxzLmNhdXNlVmFsdWVzRGVzY3JpcHRpb24nLCB7CiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICd7Y2F1c2VFbnRpdHlWYWx1ZX0gKGFjdHVhbCB7YWN0dWFsVmFsdWV9LCAnICsgJ3R5cGljYWwge3R5cGljYWxWYWx1ZX0sIHByb2JhYmlsaXR5IHtwcm9iYWJpbGl0eVZhbHVlfSknLAogICAgICAgIHZhbHVlczogewogICAgICAgICAgY2F1c2VFbnRpdHlWYWx1ZTogY2F1c2UuZW50aXR5VmFsdWUsCiAgICAgICAgICBhY3R1YWxWYWx1ZTogKDAsIF9mb3JtYXRfdmFsdWUuZm9ybWF0VmFsdWUpKGNhdXNlLmFjdHVhbCwgc291cmNlLmZ1bmN0aW9uKSwKICAgICAgICAgIHR5cGljYWxWYWx1ZTogKDAsIF9mb3JtYXRfdmFsdWUuZm9ybWF0VmFsdWUpKGNhdXNlLnR5cGljYWwsIHNvdXJjZS5mdW5jdGlvbiksCiAgICAgICAgICBwcm9iYWJpbGl0eVZhbHVlOiBjYXVzZS5wcm9iYWJpbGl0eQogICAgICAgIH0KICAgICAgfSk7CgogICAgICBpdGVtcy5wdXNoKHsKICAgICAgICB0aXRsZTogdGl0bGUsCiAgICAgICAgZGVzY3JpcHRpb246IGRlc2NyaXB0aW9uCiAgICAgIH0pOwogICAgfSk7CiAgfQoKICByZXR1cm4gaXRlbXM7Cn0gLy8gYW5vbWFseUluZmx1ZW5jZXJzOiBbIHtmaWVsZE5hbWU6IGZpZWxkVmFsdWV9LCB7ZmllbGROYW1lOiBmaWVsZFZhbHVlfSwgLi4uIF0KCgpmdW5jdGlvbiBnZXRJbmZsdWVuY2Vyc0l0ZW1zKGFub21hbHlJbmZsdWVuY2VycywgaW5mbHVlbmNlckZpbHRlciwgbnVtVG9EaXNwbGF5KSB7CiAgdmFyIGl0ZW1zID0gW107CgogIHZhciBfbG9vcCA9IGZ1bmN0aW9uIF9sb29wKGkpIHsKICAgIE9iamVjdC5rZXlzKGFub21hbHlJbmZsdWVuY2Vyc1tpXSkuZm9yRWFjaChmdW5jdGlvbiAoaW5mbHVlbmNlckZpZWxkTmFtZSkgewogICAgICB2YXIgdmFsdWUgPSBhbm9tYWx5SW5mbHVlbmNlcnNbaV1baW5mbHVlbmNlckZpZWxkTmFtZV07CiAgICAgIGl0ZW1zLnB1c2goewogICAgICAgIHRpdGxlOiBpbmZsdWVuY2VyRmllbGROYW1lLAogICAgICAgIGRlc2NyaXB0aW9uOiBnZXRGaWx0ZXJFbnRpdHkoaW5mbHVlbmNlckZpZWxkTmFtZSwgdmFsdWUsIGluZmx1ZW5jZXJGaWx0ZXIpCiAgICAgIH0pOwogICAgfSk7CiAgfTsKCiAgZm9yICh2YXIgaSA9IDA7IGkgPCBudW1Ub0Rpc3BsYXk7IGkrKykgewogICAgX2xvb3AoaSk7CiAgfQoKICByZXR1cm4gaXRlbXM7Cn0KCnZhciBBbm9tYWx5RGV0YWlscyA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKF9Db21wb25lbnQpIHsKICBfaW5oZXJpdHMoQW5vbWFseURldGFpbHMsIF9Db21wb25lbnQpOwoKICBmdW5jdGlvbiBBbm9tYWx5RGV0YWlscyhwcm9wcykgewogICAgdmFyIF90aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBBbm9tYWx5RGV0YWlscyk7CgogICAgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfZ2V0UHJvdG90eXBlT2YoQW5vbWFseURldGFpbHMpLmNhbGwodGhpcywgcHJvcHMpKTsKICAgIF90aGlzLnN0YXRlID0gewogICAgICBzaG93QWxsSW5mbHVlbmNlcnM6IGZhbHNlCiAgICB9OwoKICAgIGlmIChfdGhpcy5wcm9wcy5leGFtcGxlcyAhPT0gdW5kZWZpbmVkICYmIF90aGlzLnByb3BzLmV4YW1wbGVzLmxlbmd0aCA+IDApIHsKICAgICAgX3RoaXMudGFicyA9IFt7CiAgICAgICAgaWQ6ICdEZXRhaWxzJywKICAgICAgICBuYW1lOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWwuYW5vbWFsaWVzVGFibGUuYW5vbWFseURldGFpbHMuZGV0YWlsc1RpdGxlJywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdEZXRhaWxzJwogICAgICAgIH0pLAogICAgICAgIGNvbnRlbnQ6IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LkZyYWdtZW50LCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgICBjbGFzc05hbWU6ICJtbC1hbm9tYWxpZXMtdGFibGUtZGV0YWlscyIKICAgICAgICB9LCBfdGhpcy5yZW5kZXJEZXNjcmlwdGlvbigpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3BhY2VyLCB7CiAgICAgICAgICBzaXplOiAibSIKICAgICAgICB9KSwgX3RoaXMucmVuZGVyRGV0YWlscygpLCBfdGhpcy5yZW5kZXJJbmZsdWVuY2VycygpKSkKICAgICAgfSwgewogICAgICAgIGlkOiAnQ2F0ZWdvcnkgZXhhbXBsZXMnLAogICAgICAgIG5hbWU6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tbC5hbm9tYWxpZXNUYWJsZS5hbm9tYWx5RGV0YWlscy5jYXRlZ29yeUV4YW1wbGVzVGl0bGUnLCB7CiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0NhdGVnb3J5IGV4YW1wbGVzJwogICAgICAgIH0pLAogICAgICAgIGNvbnRlbnQ6IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LkZyYWdtZW50LCBudWxsLCBfdGhpcy5yZW5kZXJDYXRlZ29yeUV4YW1wbGVzKCkpCiAgICAgIH1dOwogICAgfQoKICAgIHJldHVybiBfdGhpczsKICB9CgogIF9jcmVhdGVDbGFzcyhBbm9tYWx5RGV0YWlscywgW3sKICAgIGtleTogInRvZ2dsZUFsbEluZmx1ZW5jZXJzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB0b2dnbGVBbGxJbmZsdWVuY2VycygpIHsKICAgICAgdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgc2hvd0FsbEluZmx1ZW5jZXJzOiAhdGhpcy5zdGF0ZS5zaG93QWxsSW5mbHVlbmNlcnMKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVuZGVyQ2F0ZWdvcnlFeGFtcGxlcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyQ2F0ZWdvcnlFeGFtcGxlcygpIHsKICAgICAgdmFyIF90aGlzJHByb3BzID0gdGhpcy5wcm9wcywKICAgICAgICAgIGV4YW1wbGVzID0gX3RoaXMkcHJvcHMuZXhhbXBsZXMsCiAgICAgICAgICBkZWZpbml0aW9uID0gX3RoaXMkcHJvcHMuZGVmaW5pdGlvbjsKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4R3JvdXAsIHsKICAgICAgICBkaXJlY3Rpb246ICJjb2x1bW4iLAogICAgICAgIGp1c3RpZnlDb250ZW50OiAiY2VudGVyIiwKICAgICAgICBndXR0ZXJTaXplOiAibSIsCiAgICAgICAgY2xhc3NOYW1lOiAibWxBbm9tYWx5Q2F0ZWdvcnlFeGFtcGxlcyIKICAgICAgfSwgZGVmaW5pdGlvbiAhPT0gdW5kZWZpbmVkICYmIGRlZmluaXRpb24udGVybXMgJiYgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRnJhZ21lbnQsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgICAgIGtleTogImV4YW1wbGUtdGVybXMiCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUZXh0LCB7CiAgICAgICAgc2l6ZTogInhzIgogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJoNCIsIHsKICAgICAgICBjbGFzc05hbWU6ICJtbEFub21hbHlDYXRlZ29yeUV4YW1wbGVzX19oZWFkZXIiCiAgICAgIH0sIF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tbC5hbm9tYWxpZXNUYWJsZS5hbm9tYWx5RGV0YWlscy50ZXJtc1RpdGxlJywgewogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnVGVybXMnCiAgICAgIH0pKSwgIlx4QTAiLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpSWNvblRpcCwgewogICAgICAgICJhcmlhLWxhYmVsIjogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1sLmFub21hbGllc1RhYmxlLmFub21hbHlEZXRhaWxzLnRlcm1zRGVzY3JpcHRpb25BcmlhTGFiZWwnLCB7CiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0Rlc2NyaXB0aW9uJwogICAgICAgIH0pLAogICAgICAgIHR5cGU6ICJxdWVzdGlvbkluQ2lyY2xlIiwKICAgICAgICBjb2xvcjogInN1YmR1ZWQiLAogICAgICAgIHNpemU6ICJzIiwKICAgICAgICBjb250ZW50OiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgICAgaWQ6ICJ4cGFjay5tbC5hbm9tYWxpZXNUYWJsZS5hbm9tYWx5RGV0YWlscy50ZXJtc0Rlc2NyaXB0aW9uVG9vbHRpcCIsCiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkEgc3BhY2Ugc2VwYXJhdGVkIGxpc3Qgb2YgdGhlIGNvbW1vbiB0b2tlbnMgdGhhdCBhcmUgbWF0Y2hlZCBpbiB2YWx1ZXMgb2YgdGhlIGNhdGVnb3J5IChtYXkgaGF2ZSBiZWVuIHRydW5jYXRlZCB0byBhIG1heCBjaGFyYWN0ZXIgbGltaXQgb2Yge21heENoYXJzfSkiLAogICAgICAgICAgdmFsdWVzOiB7CiAgICAgICAgICAgIG1heENoYXJzOiBfYW5vbWFsaWVzX3RhYmxlX2NvbnN0YW50cy5NQVhfQ0hBUlMKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICB9KSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUZXh0LCB7CiAgICAgICAgc2l6ZTogInhzIgogICAgICB9LCBkZWZpbml0aW9uLnRlcm1zKSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTcGFjZXIsIHsKICAgICAgICBzaXplOiAieHMiCiAgICAgIH0pKSwgZGVmaW5pdGlvbiAhPT0gdW5kZWZpbmVkICYmIGRlZmluaXRpb24ucmVnZXggJiYgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRnJhZ21lbnQsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgICAgIGtleTogImV4YW1wbGUtcmVnZXgiCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUZXh0LCB7CiAgICAgICAgc2l6ZTogInhzIgogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJoNCIsIHsKICAgICAgICBjbGFzc05hbWU6ICJtbEFub21hbHlDYXRlZ29yeUV4YW1wbGVzX19oZWFkZXIiCiAgICAgIH0sIF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tbC5hbm9tYWxpZXNUYWJsZS5hbm9tYWx5RGV0YWlscy5yZWdleFRpdGxlJywgewogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnUmVnZXgnCiAgICAgIH0pKSwgIlx4QTAiLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpSWNvblRpcCwgewogICAgICAgICJhcmlhLWxhYmVsIjogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1sLmFub21hbGllc1RhYmxlLmFub21hbHlEZXRhaWxzLnJlZ2V4RGVzY3JpcHRpb25BcmlhTGFiZWwnLCB7CiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0Rlc2NyaXB0aW9uJwogICAgICAgIH0pLAogICAgICAgIHR5cGU6ICJxdWVzdGlvbkluQ2lyY2xlIiwKICAgICAgICBjb2xvcjogInN1YmR1ZWQiLAogICAgICAgIHNpemU6ICJzIiwKICAgICAgICBjb250ZW50OiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgICAgaWQ6ICJ4cGFjay5tbC5hbm9tYWxpZXNUYWJsZS5hbm9tYWx5RGV0YWlscy5yZWdleERlc2NyaXB0aW9uVG9vbHRpcCIsCiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIlRoZSByZWd1bGFyIGV4cHJlc3Npb24gdGhhdCBpcyB1c2VkIHRvIHNlYXJjaCBmb3IgdmFsdWVzIHRoYXQgbWF0Y2ggdGhlIGNhdGVnb3J5IChtYXkgaGF2ZSBiZWVuIHRydW5jYXRlZCB0byBhIG1heCBjaGFyYWN0ZXIgbGltaXQgb2Yge21heENoYXJzfSkiLAogICAgICAgICAgdmFsdWVzOiB7CiAgICAgICAgICAgIG1heENoYXJzOiBfYW5vbWFsaWVzX3RhYmxlX2NvbnN0YW50cy5NQVhfQ0hBUlMKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICB9KSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUZXh0LCB7CiAgICAgICAgc2l6ZTogInhzIgogICAgICB9LCBkZWZpbml0aW9uLnJlZ2V4KSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTcGFjZXIsIHsKICAgICAgICBzaXplOiAieHMiCiAgICAgIH0pKSwgZXhhbXBsZXMubWFwKGZ1bmN0aW9uIChleGFtcGxlLCBpKSB7CiAgICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgICAgICAga2V5OiAiZXhhbXBsZSIuY29uY2F0KGkpCiAgICAgICAgfSwgaSA9PT0gMCAmJiBkZWZpbml0aW9uICE9PSB1bmRlZmluZWQgJiYgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRleHQsIHsKICAgICAgICAgIHNpemU6ICJzIgogICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImg0IiwgbnVsbCwgX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1sLmFub21hbGllc1RhYmxlLmFub21hbHlEZXRhaWxzLmV4YW1wbGVzVGl0bGUnLCB7CiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0V4YW1wbGVzJwogICAgICAgIH0pKSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCB7CiAgICAgICAgICBjbGFzc05hbWU6ICJtbEFub21hbHlDYXRlZ29yeUV4YW1wbGVzX19pdGVtIgogICAgICAgIH0sIGV4YW1wbGUpKTsKICAgICAgfSkpOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlckRlc2NyaXB0aW9uIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJEZXNjcmlwdGlvbigpIHsKICAgICAgdmFyIGFub21hbHkgPSB0aGlzLnByb3BzLmFub21hbHk7CiAgICAgIHZhciBzb3VyY2UgPSBhbm9tYWx5LnNvdXJjZTsKCiAgICAgIHZhciBhbm9tYWx5RGVzY3JpcHRpb24gPSBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWwuYW5vbWFsaWVzVGFibGUuYW5vbWFseURldGFpbHMuYW5vbWFseUluTGFiZWwnLCB7CiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICd7YW5vbWFseVNldmVyaXR5fSBhbm9tYWx5IGluIHthbm9tYWx5RGV0ZWN0b3J9JywKICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgIGFub21hbHlTZXZlcml0eTogKDAsIF9hbm9tYWx5X3V0aWxzLmdldFNldmVyaXR5KShhbm9tYWx5LnNldmVyaXR5KS5sYWJlbCwKICAgICAgICAgIGFub21hbHlEZXRlY3RvcjogYW5vbWFseS5kZXRlY3RvcgogICAgICAgIH0KICAgICAgfSk7CgogICAgICBpZiAoYW5vbWFseS5lbnRpdHlOYW1lICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBhbm9tYWx5RGVzY3JpcHRpb24gKz0gX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1sLmFub21hbGllc1RhYmxlLmFub21hbHlEZXRhaWxzLmZvdW5kRm9yTGFiZWwnLCB7CiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJyBmb3VuZCBmb3Ige2Fub21hbHlFbnRpdHlOYW1lfSB7YW5vbWFseUVudGl0eVZhbHVlfScsCiAgICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgICAgYW5vbWFseUVudGl0eU5hbWU6IGFub21hbHkuZW50aXR5TmFtZSwKICAgICAgICAgICAgYW5vbWFseUVudGl0eVZhbHVlOiBhbm9tYWx5LmVudGl0eVZhbHVlCiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGlmIChzb3VyY2UucGFydGl0aW9uX2ZpZWxkX25hbWUgIT09IHVuZGVmaW5lZCAmJiBzb3VyY2UucGFydGl0aW9uX2ZpZWxkX25hbWUgIT09IGFub21hbHkuZW50aXR5TmFtZSkgewogICAgICAgIGFub21hbHlEZXNjcmlwdGlvbiArPSBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWwuYW5vbWFsaWVzVGFibGUuYW5vbWFseURldGFpbHMuZGV0ZWN0ZWRJbkxhYmVsJywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICcgZGV0ZWN0ZWQgaW4ge3NvdXJjZVBhcnRpdGlvbkZpZWxkTmFtZX0ge3NvdXJjZVBhcnRpdGlvbkZpZWxkVmFsdWV9JywKICAgICAgICAgIHZhbHVlczogewogICAgICAgICAgICBzb3VyY2VQYXJ0aXRpb25GaWVsZE5hbWU6IHNvdXJjZS5wYXJ0aXRpb25fZmllbGRfbmFtZSwKICAgICAgICAgICAgc291cmNlUGFydGl0aW9uRmllbGRWYWx1ZTogc291cmNlLnBhcnRpdGlvbl9maWVsZF92YWx1ZQogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9IC8vIENoZWNrIGZvciBhIGNvcnJlbGF0ZWRCeUZpZWxkVmFsdWUgaW4gdGhlIHNvdXJjZSB3aGljaCB3aWxsIGJlIHByZXNlbnQgZm9yIG11bHRpdmFyaWF0ZSBhbmFseXNlcwogICAgICAvLyB3aGVyZSB0aGUgcmVjb3JkIGlzIGFub21hbG91cyBkdWUgdG8gcmVsYXRpb25zaGlwIHdpdGggYW5vdGhlciAnYnknIGZpZWxkIHZhbHVlLgoKCiAgICAgIHZhciBtdkRlc2NyaXB0aW9uID0gdW5kZWZpbmVkOwoKICAgICAgaWYgKHNvdXJjZS5jb3JyZWxhdGVkX2J5X2ZpZWxkX3ZhbHVlICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBtdkRlc2NyaXB0aW9uID0gX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1sLmFub21hbGllc1RhYmxlLmFub21hbHlEZXRhaWxzLm11bHRpdmFyaWF0ZURlc2NyaXB0aW9uJywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdtdWx0aXZhcmlhdGUgY29ycmVsYXRpb25zIGZvdW5kIGluIHtzb3VyY2VCeUZpZWxkTmFtZX07ICcgKyAne3NvdXJjZUJ5RmllbGRWYWx1ZX0gaXMgY29uc2lkZXJlZCBhbm9tYWxvdXMgZ2l2ZW4ge3NvdXJjZUNvcnJlbGF0ZWRCeUZpZWxkVmFsdWV9JywKICAgICAgICAgIHZhbHVlczogewogICAgICAgICAgICBzb3VyY2VCeUZpZWxkTmFtZTogc291cmNlLmJ5X2ZpZWxkX25hbWUsCiAgICAgICAgICAgIHNvdXJjZUJ5RmllbGRWYWx1ZTogc291cmNlLmJ5X2ZpZWxkX3ZhbHVlLAogICAgICAgICAgICBzb3VyY2VDb3JyZWxhdGVkQnlGaWVsZFZhbHVlOiBzb3VyY2UuY29ycmVsYXRlZF9ieV9maWVsZF92YWx1ZQogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CgogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuZGVmYXVsdC5GcmFnbWVudCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRleHQsIHsKICAgICAgICBzaXplOiAieHMiCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImg0IiwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogInhwYWNrLm1sLmFub21hbGllc1RhYmxlLmFub21hbHlEZXRhaWxzLmRlc2NyaXB0aW9uVGl0bGUiLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiRGVzY3JpcHRpb24iCiAgICAgIH0pKSwgYW5vbWFseURlc2NyaXB0aW9uKSwgbXZEZXNjcmlwdGlvbiAhPT0gdW5kZWZpbmVkICYmIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUZXh0LCB7CiAgICAgICAgc2l6ZTogInhzIgogICAgICB9LCBtdkRlc2NyaXB0aW9uKSk7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVuZGVyRGV0YWlscyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyRGV0YWlscygpIHsKICAgICAgdmFyIGRldGFpbEl0ZW1zID0gZ2V0RGV0YWlsc0l0ZW1zKHRoaXMucHJvcHMuYW5vbWFseSwgdGhpcy5wcm9wcy5leGFtcGxlcywgdGhpcy5wcm9wcy5maWx0ZXIpOwoKICAgICAgdmFyIGlzSW50ZXJpbVJlc3VsdCA9IF9sb2Rhc2guZGVmYXVsdC5nZXQodGhpcy5wcm9wcy5hbm9tYWx5LCAnc291cmNlLmlzX2ludGVyaW0nLCBmYWxzZSk7CgogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuZGVmYXVsdC5GcmFnbWVudCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRleHQsIHsKICAgICAgICBzaXplOiAieHMiCiAgICAgIH0sIHRoaXMucHJvcHMuaXNBZ2dyZWdhdGVkRGF0YSA9PT0gdHJ1ZSA/IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImg0IiwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogInhwYWNrLm1sLmFub21hbGllc1RhYmxlLmFub21hbHlEZXRhaWxzLmRldGFpbHNPbkhpZ2hlc3RTZXZlcml0eUFub21hbHlUaXRsZSIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJEZXRhaWxzIG9uIGhpZ2hlc3Qgc2V2ZXJpdHkgYW5vbWFseSIKICAgICAgfSkpIDogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgiaDQiLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAieHBhY2subWwuYW5vbWFsaWVzVGFibGUuYW5vbWFseURldGFpbHMuYW5vbWFseURldGFpbHNUaXRsZSIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJBbm9tYWx5IGRldGFpbHMiCiAgICAgIH0pKSwgaXNJbnRlcmltUmVzdWx0ID09PSB0cnVlICYmIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LmRlZmF1bHQuRnJhZ21lbnQsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlJY29uLCB7CiAgICAgICAgdHlwZTogImFsZXJ0IgogICAgICB9KSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgic3BhbiIsIHsKICAgICAgICBjbGFzc05hbWU6ICJpbnRlcmltLXJlc3VsdCIKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogInhwYWNrLm1sLmFub21hbGllc1RhYmxlLmFub21hbHlEZXRhaWxzLmludGVyaW1SZXN1bHRMYWJlbCIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJJbnRlcmltIHJlc3VsdCIKICAgICAgfSkpKSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlEZXNjcmlwdGlvbkxpc3QsIHsKICAgICAgICB0eXBlOiAiY29sdW1uIiwKICAgICAgICBsaXN0SXRlbXM6IGRldGFpbEl0ZW1zLAogICAgICAgIGNsYXNzTmFtZTogImFub21hbHktZGVzY3JpcHRpb24tbGlzdCIKICAgICAgfSkpOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlckluZmx1ZW5jZXJzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJJbmZsdWVuY2VycygpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB2YXIgYW5vbWFseUluZmx1ZW5jZXJzID0gdGhpcy5wcm9wcy5hbm9tYWx5LmluZmx1ZW5jZXJzOwogICAgICB2YXIgbGlzdEl0ZW1zID0gW107CiAgICAgIHZhciBvdGhlcnNDb3VudCA9IDA7CiAgICAgIHZhciBudW1Ub0Rpc3BsYXkgPSAwOwoKICAgICAgaWYgKGFub21hbHlJbmZsdWVuY2VycyAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgbnVtVG9EaXNwbGF5ID0gdGhpcy5zdGF0ZS5zaG93QWxsSW5mbHVlbmNlcnMgPT09IHRydWUgPyBhbm9tYWx5SW5mbHVlbmNlcnMubGVuZ3RoIDogTWF0aC5taW4odGhpcy5wcm9wcy5pbmZsdWVuY2Vyc0xpbWl0LCBhbm9tYWx5SW5mbHVlbmNlcnMubGVuZ3RoKTsKICAgICAgICBvdGhlcnNDb3VudCA9IE1hdGgubWF4KGFub21hbHlJbmZsdWVuY2Vycy5sZW5ndGggLSBudW1Ub0Rpc3BsYXksIDApOwoKICAgICAgICBpZiAob3RoZXJzQ291bnQgPT09IDEpIHsKICAgICAgICAgIC8vIERpc3BsYXkgdGhlIDEgZXh0cmEgaW5mbHVlbmNlciBhcyBkaXNwbGF5aW5nICJhbmQgMSBtb3JlIiB3b3VsZCBhbHNvIHRha2UgdXAgYSBsaW5lLgogICAgICAgICAgbnVtVG9EaXNwbGF5Kys7CiAgICAgICAgICBvdGhlcnNDb3VudCA9IDA7CiAgICAgICAgfQoKICAgICAgICBsaXN0SXRlbXMgPSBnZXRJbmZsdWVuY2Vyc0l0ZW1zKGFub21hbHlJbmZsdWVuY2VycywgdGhpcy5wcm9wcy5pbmZsdWVuY2VyRmlsdGVyLCBudW1Ub0Rpc3BsYXkpOwogICAgICB9CgogICAgICBpZiAobGlzdEl0ZW1zLmxlbmd0aCA+IDApIHsKICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuZGVmYXVsdC5GcmFnbWVudCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgewogICAgICAgICAgc2l6ZTogIm0iCiAgICAgICAgfSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUZXh0LCB7CiAgICAgICAgICBzaXplOiAieHMiCiAgICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgiaDQiLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgICAgaWQ6ICJ4cGFjay5tbC5hbm9tYWxpZXNUYWJsZS5hbm9tYWx5RGV0YWlscy5pbmZsdWVuY2Vyc1RpdGxlIiwKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiSW5mbHVlbmNlcnMiCiAgICAgICAgfSkpKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aURlc2NyaXB0aW9uTGlzdCwgewogICAgICAgICAgdHlwZTogImNvbHVtbiIsCiAgICAgICAgICBsaXN0SXRlbXM6IGxpc3RJdGVtcywKICAgICAgICAgIGNsYXNzTmFtZTogImFub21hbHktZGVzY3JpcHRpb24tbGlzdCIKICAgICAgICB9KSwgb3RoZXJzQ291bnQgPiAwICYmIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlMaW5rLCB7CiAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgICByZXR1cm4gX3RoaXMyLnRvZ2dsZUFsbEluZmx1ZW5jZXJzKCk7CiAgICAgICAgICB9CiAgICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICAgIGlkOiAieHBhY2subWwuYW5vbWFsaWVzVGFibGUuYW5vbWFseURldGFpbHMuYW5vbWFseURlc2NyaXB0aW9uTGlzdE1vcmVMaW5rVGV4dCIsCiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogImFuZCB7b3RoZXJzQ291bnR9IG1vcmUiLAogICAgICAgICAgdmFsdWVzOiB7CiAgICAgICAgICAgIG90aGVyc0NvdW50OiBvdGhlcnNDb3VudAogICAgICAgICAgfQogICAgICAgIH0pKSwgbnVtVG9EaXNwbGF5ID4gdGhpcy5wcm9wcy5pbmZsdWVuY2Vyc0xpbWl0ICsgMSAmJiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpTGluaywgewogICAgICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHsKICAgICAgICAgICAgcmV0dXJuIF90aGlzMi50b2dnbGVBbGxJbmZsdWVuY2VycygpOwogICAgICAgICAgfQogICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICBpZDogInhwYWNrLm1sLmFub21hbGllc1RhYmxlLmFub21hbHlEZXRhaWxzLmFub21hbHlEZXNjcmlwdGlvblNob3dMZXNzTGlua1RleHQiLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJzaG93IGxlc3MiCiAgICAgICAgfSkpKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkgewogICAgICB2YXIgdGFiSW5kZXggPSB0aGlzLnByb3BzLnRhYkluZGV4OwoKICAgICAgaWYgKHRoaXMudGFicyAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUYWJiZWRDb250ZW50LCB7CiAgICAgICAgICB0YWJzOiB0aGlzLnRhYnMsCiAgICAgICAgICBzaXplOiAicyIsCiAgICAgICAgICBpbml0aWFsU2VsZWN0ZWRUYWI6IHRoaXMudGFic1t0YWJJbmRleF0sCiAgICAgICAgICBvblRhYkNsaWNrOiBmdW5jdGlvbiBvblRhYkNsaWNrKCkge30KICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgICAgY2xhc3NOYW1lOiAibWwtYW5vbWFsaWVzLXRhYmxlLWRldGFpbHMiCiAgICAgICAgfSwgdGhpcy5yZW5kZXJEZXNjcmlwdGlvbigpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3BhY2VyLCB7CiAgICAgICAgICBzaXplOiAibSIKICAgICAgICB9KSwgdGhpcy5yZW5kZXJEZXRhaWxzKCksIHRoaXMucmVuZGVySW5mbHVlbmNlcnMoKSk7CiAgICAgIH0KICAgIH0KICB9XSk7CgogIHJldHVybiBBbm9tYWx5RGV0YWlsczsKfShfcmVhY3QuQ29tcG9uZW50KTsKCmV4cG9ydHMuQW5vbWFseURldGFpbHMgPSBBbm9tYWx5RGV0YWlsczsKCl9kZWZpbmVQcm9wZXJ0eShBbm9tYWx5RGV0YWlscywgInByb3BUeXBlcyIsIHsKICBhbm9tYWx5OiBfcHJvcFR5cGVzLmRlZmF1bHQub2JqZWN0LmlzUmVxdWlyZWQsCiAgZXhhbXBsZXM6IF9wcm9wVHlwZXMuZGVmYXVsdC5hcnJheSwKICBkZWZpbml0aW9uOiBfcHJvcFR5cGVzLmRlZmF1bHQub2JqZWN0LAogIGlzQWdncmVnYXRlZERhdGE6IF9wcm9wVHlwZXMuZGVmYXVsdC5ib29sLAogIGZpbHRlcjogX3Byb3BUeXBlcy5kZWZhdWx0LmZ1bmMsCiAgaW5mbHVlbmNlcnNMaW1pdDogX3Byb3BUeXBlcy5kZWZhdWx0Lm51bWJlciwKICBpbmZsdWVuY2VyRmlsdGVyOiBfcHJvcFR5cGVzLmRlZmF1bHQuZnVuYywKICB0YWJJbmRleDogX3Byb3BUeXBlcy5kZWZhdWx0Lm51bWJlci5pc1JlcXVpcmVkCn0pOw=="},null]}