{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/siem/public/pages/detection_engine/rules/create/helpers.js","dependencies":[{"path":"x-pack/legacy/plugins/siem/public/pages/detection_engine/rules/create/helpers.js","mtime":1585205047887},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmZvcm1hdFJ1bGUgPSB2b2lkIDA7Cgp2YXIgX2ZwID0gcmVxdWlyZSgibG9kYXNoL2ZwIik7Cgp2YXIgX21vbWVudCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgibW9tZW50IikpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsKICByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogewogICAgZGVmYXVsdDogb2JqCiAgfTsKfQoKZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7CiAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOwoKICBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgewogICAgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7CiAgICBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7CiAgICAgIHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOwogICAgfSk7CiAgICBrZXlzLnB1c2guYXBwbHkoa2V5cywgc3ltYm9scyk7CiAgfQoKICByZXR1cm4ga2V5czsKfQoKZnVuY3Rpb24gX29iamVjdFNwcmVhZCh0YXJnZXQpIHsKICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgewogICAgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXSAhPSBudWxsID8gYXJndW1lbnRzW2ldIDoge307CgogICAgaWYgKGkgJSAyKSB7CiAgICAgIG93bktleXMoc291cmNlLCB0cnVlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsKICAgICAgfSk7CiAgICB9IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKSB7CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoc291cmNlKSk7CiAgICB9IGVsc2UgewogICAgICBvd25LZXlzKHNvdXJjZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwga2V5KSk7CiAgICAgIH0pOwogICAgfQogIH0KCiAgcmV0dXJuIHRhcmdldDsKfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgewogIGlmIChrZXkgaW4gb2JqKSB7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsKICAgICAgdmFsdWU6IHZhbHVlLAogICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgIHdyaXRhYmxlOiB0cnVlCiAgICB9KTsKICB9IGVsc2UgewogICAgb2JqW2tleV0gPSB2YWx1ZTsKICB9CgogIHJldHVybiBvYmo7Cn0KCmZ1bmN0aW9uIF9vYmplY3RXaXRob3V0UHJvcGVydGllcyhzb3VyY2UsIGV4Y2x1ZGVkKSB7CiAgaWYgKHNvdXJjZSA9PSBudWxsKSByZXR1cm4ge307CgogIHZhciB0YXJnZXQgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShzb3VyY2UsIGV4Y2x1ZGVkKTsKCiAgdmFyIGtleSwgaTsKCiAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsKICAgIHZhciBzb3VyY2VTeW1ib2xLZXlzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzb3VyY2UpOwoKICAgIGZvciAoaSA9IDA7IGkgPCBzb3VyY2VTeW1ib2xLZXlzLmxlbmd0aDsgaSsrKSB7CiAgICAgIGtleSA9IHNvdXJjZVN5bWJvbEtleXNbaV07CiAgICAgIGlmIChleGNsdWRlZC5pbmRleE9mKGtleSkgPj0gMCkgY29udGludWU7CiAgICAgIGlmICghT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKHNvdXJjZSwga2V5KSkgY29udGludWU7CiAgICAgIHRhcmdldFtrZXldID0gc291cmNlW2tleV07CiAgICB9CiAgfQoKICByZXR1cm4gdGFyZ2V0Owp9CgpmdW5jdGlvbiBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShzb3VyY2UsIGV4Y2x1ZGVkKSB7CiAgaWYgKHNvdXJjZSA9PSBudWxsKSByZXR1cm4ge307CiAgdmFyIHRhcmdldCA9IHt9OwogIHZhciBzb3VyY2VLZXlzID0gT2JqZWN0LmtleXMoc291cmNlKTsKICB2YXIga2V5LCBpOwoKICBmb3IgKGkgPSAwOyBpIDwgc291cmNlS2V5cy5sZW5ndGg7IGkrKykgewogICAga2V5ID0gc291cmNlS2V5c1tpXTsKICAgIGlmIChleGNsdWRlZC5pbmRleE9mKGtleSkgPj0gMCkgY29udGludWU7CiAgICB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldOwogIH0KCiAgcmV0dXJuIHRhcmdldDsKfQoKdmFyIGdldFRpbWVUeXBlVmFsdWUgPSBmdW5jdGlvbiBnZXRUaW1lVHlwZVZhbHVlKHRpbWUpIHsKICB2YXIgdGltZU9iaiA9IHsKICAgIHVuaXQ6ICcnLAogICAgdmFsdWU6IDAKICB9OwogIHZhciBmaWx0ZXJUaW1lVmFsID0gdGltZS5tYXRjaCgvXGQrL2cpOwogIHZhciBmaWx0ZXJUaW1lVHlwZSA9IHRpbWUubWF0Y2goL1thLXpBLVpdKy9nKTsKCiAgaWYgKCEoMCwgX2ZwLmlzRW1wdHkpKGZpbHRlclRpbWVWYWwpICYmIGZpbHRlclRpbWVWYWwgIT0gbnVsbCAmJiAhaXNOYU4oTnVtYmVyKGZpbHRlclRpbWVWYWxbMF0pKSkgewogICAgdGltZU9iai52YWx1ZSA9IE51bWJlcihmaWx0ZXJUaW1lVmFsWzBdKTsKICB9CgogIGlmICghKDAsIF9mcC5pc0VtcHR5KShmaWx0ZXJUaW1lVHlwZSkgJiYgZmlsdGVyVGltZVR5cGUgIT0gbnVsbCAmJiBbJ3MnLCAnbScsICdoJ10uaW5jbHVkZXMoZmlsdGVyVGltZVR5cGVbMF0pKSB7CiAgICB0aW1lT2JqLnVuaXQgPSBmaWx0ZXJUaW1lVHlwZVswXTsKICB9CgogIHJldHVybiB0aW1lT2JqOwp9OwoKdmFyIGZvcm1hdERlZmluZVN0ZXBEYXRhID0gZnVuY3Rpb24gZm9ybWF0RGVmaW5lU3RlcERhdGEoZGVmaW5lU3RlcERhdGEpIHsKICB2YXIgcXVlcnlCYXIgPSBkZWZpbmVTdGVwRGF0YS5xdWVyeUJhciwKICAgICAgaXNOZXcgPSBkZWZpbmVTdGVwRGF0YS5pc05ldywKICAgICAgcmVzdCA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllcyhkZWZpbmVTdGVwRGF0YSwgWyJxdWVyeUJhciIsICJpc05ldyJdKTsKCiAgdmFyIGZpbHRlcnMgPSBxdWVyeUJhci5maWx0ZXJzLAogICAgICBxdWVyeSA9IHF1ZXJ5QmFyLnF1ZXJ5LAogICAgICBzYXZlZElkID0gcXVlcnlCYXIuc2F2ZWRfaWQ7CiAgcmV0dXJuIF9vYmplY3RTcHJlYWQoe30sIHJlc3QsIHsKICAgIGxhbmd1YWdlOiBxdWVyeS5sYW5ndWFnZSwKICAgIGZpbHRlcnM6IGZpbHRlcnMsCiAgICBxdWVyeTogcXVlcnkucXVlcnkKICB9LCBzYXZlZElkICE9IG51bGwgJiYgc2F2ZWRJZCAhPT0gJycgPyB7CiAgICBzYXZlZF9pZDogc2F2ZWRJZAogIH0gOiB7fSk7Cn07Cgp2YXIgZm9ybWF0U2NoZWR1bGVTdGVwRGF0YSA9IGZ1bmN0aW9uIGZvcm1hdFNjaGVkdWxlU3RlcERhdGEoc2NoZWR1bGVEYXRhKSB7CiAgdmFyIGlzTmV3ID0gc2NoZWR1bGVEYXRhLmlzTmV3LAogICAgICBmb3JtYXRTY2hlZHVsZURhdGEgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXMoc2NoZWR1bGVEYXRhLCBbImlzTmV3Il0pOwoKICBpZiAoISgwLCBfZnAuaXNFbXB0eSkoZm9ybWF0U2NoZWR1bGVEYXRhLmludGVydmFsKSAmJiAhKDAsIF9mcC5pc0VtcHR5KShmb3JtYXRTY2hlZHVsZURhdGEuZnJvbSkpIHsKICAgIHZhciBfZ2V0VGltZVR5cGVWYWx1ZSA9IGdldFRpbWVUeXBlVmFsdWUoZm9ybWF0U2NoZWR1bGVEYXRhLmludGVydmFsKSwKICAgICAgICBpbnRlcnZhbFVuaXQgPSBfZ2V0VGltZVR5cGVWYWx1ZS51bml0LAogICAgICAgIGludGVydmFsVmFsdWUgPSBfZ2V0VGltZVR5cGVWYWx1ZS52YWx1ZTsKCiAgICB2YXIgX2dldFRpbWVUeXBlVmFsdWUyID0gZ2V0VGltZVR5cGVWYWx1ZShmb3JtYXRTY2hlZHVsZURhdGEuZnJvbSksCiAgICAgICAgZnJvbVVuaXQgPSBfZ2V0VGltZVR5cGVWYWx1ZTIudW5pdCwKICAgICAgICBmcm9tVmFsdWUgPSBfZ2V0VGltZVR5cGVWYWx1ZTIudmFsdWU7CgogICAgdmFyIGR1cmF0aW9uID0gX21vbWVudC5kZWZhdWx0LmR1cmF0aW9uKGludGVydmFsVmFsdWUsIGludGVydmFsVW5pdCk7CgogICAgZHVyYXRpb24uYWRkKGZyb21WYWx1ZSwgZnJvbVVuaXQpOwogICAgZm9ybWF0U2NoZWR1bGVEYXRhLmZyb20gPSAibm93LSIuY29uY2F0KGR1cmF0aW9uLmFzU2Vjb25kcygpLCAicyIpOwogICAgZm9ybWF0U2NoZWR1bGVEYXRhLnRvID0gJ25vdyc7CiAgfQoKICByZXR1cm4gX29iamVjdFNwcmVhZCh7fSwgZm9ybWF0U2NoZWR1bGVEYXRhLCB7CiAgICBtZXRhOiB7CiAgICAgIGZyb206IHNjaGVkdWxlRGF0YS5mcm9tCiAgICB9CiAgfSk7Cn07Cgp2YXIgZm9ybWF0QWJvdXRTdGVwRGF0YSA9IGZ1bmN0aW9uIGZvcm1hdEFib3V0U3RlcERhdGEoYWJvdXRTdGVwRGF0YSkgewogIHZhciBmYWxzZVBvc2l0aXZlcyA9IGFib3V0U3RlcERhdGEuZmFsc2VQb3NpdGl2ZXMsCiAgICAgIHJlZmVyZW5jZXMgPSBhYm91dFN0ZXBEYXRhLnJlZmVyZW5jZXMsCiAgICAgIHJpc2tTY29yZSA9IGFib3V0U3RlcERhdGEucmlza1Njb3JlLAogICAgICB0aHJlYXQgPSBhYm91dFN0ZXBEYXRhLnRocmVhdCwKICAgICAgdGltZWxpbmUgPSBhYm91dFN0ZXBEYXRhLnRpbWVsaW5lLAogICAgICBpc05ldyA9IGFib3V0U3RlcERhdGEuaXNOZXcsCiAgICAgIHJlc3QgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXMoYWJvdXRTdGVwRGF0YSwgWyJmYWxzZVBvc2l0aXZlcyIsICJyZWZlcmVuY2VzIiwgInJpc2tTY29yZSIsICJ0aHJlYXQiLCAidGltZWxpbmUiLCAiaXNOZXciXSk7CgogIHJldHVybiBfb2JqZWN0U3ByZWFkKHsKICAgIGZhbHNlX3Bvc2l0aXZlczogZmFsc2VQb3NpdGl2ZXMuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgIHJldHVybiAhKDAsIF9mcC5pc0VtcHR5KShpdGVtKTsKICAgIH0pLAogICAgcmVmZXJlbmNlczogcmVmZXJlbmNlcy5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgcmV0dXJuICEoMCwgX2ZwLmlzRW1wdHkpKGl0ZW0pOwogICAgfSksCiAgICByaXNrX3Njb3JlOiByaXNrU2NvcmUKICB9LCB0aW1lbGluZS5pZCAhPSBudWxsICYmIHRpbWVsaW5lLnRpdGxlICE9IG51bGwgPyB7CiAgICB0aW1lbGluZV9pZDogdGltZWxpbmUuaWQsCiAgICB0aW1lbGluZV90aXRsZTogdGltZWxpbmUudGl0bGUKICB9IDoge30sIHsKICAgIHRocmVhdDogdGhyZWF0LmZpbHRlcihmdW5jdGlvbiAoc2luZ2xlVGhyZWF0KSB7CiAgICAgIHJldHVybiBzaW5nbGVUaHJlYXQudGFjdGljLm5hbWUgIT09ICdub25lJzsKICAgIH0pLm1hcChmdW5jdGlvbiAoc2luZ2xlVGhyZWF0KSB7CiAgICAgIHJldHVybiBfb2JqZWN0U3ByZWFkKHt9LCBzaW5nbGVUaHJlYXQsIHsKICAgICAgICBmcmFtZXdvcms6ICdNSVRSRSBBVFQmQ0snLAogICAgICAgIHRlY2huaXF1ZTogc2luZ2xlVGhyZWF0LnRlY2huaXF1ZS5tYXAoZnVuY3Rpb24gKHRlY2huaXF1ZSkgewogICAgICAgICAgdmFyIGlkID0gdGVjaG5pcXVlLmlkLAogICAgICAgICAgICAgIG5hbWUgPSB0ZWNobmlxdWUubmFtZSwKICAgICAgICAgICAgICByZWZlcmVuY2UgPSB0ZWNobmlxdWUucmVmZXJlbmNlOwogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgaWQ6IGlkLAogICAgICAgICAgICBuYW1lOiBuYW1lLAogICAgICAgICAgICByZWZlcmVuY2U6IHJlZmVyZW5jZQogICAgICAgICAgfTsKICAgICAgICB9KQogICAgICB9KTsKICAgIH0pCiAgfSwgcmVzdCk7Cn07Cgp2YXIgZm9ybWF0UnVsZSA9IGZ1bmN0aW9uIGZvcm1hdFJ1bGUoZGVmaW5lU3RlcERhdGEsIGFib3V0U3RlcERhdGEsIHNjaGVkdWxlRGF0YSwgcnVsZUlkKSB7CiAgdmFyIHR5cGUgPSAhKDAsIF9mcC5pc0VtcHR5KShkZWZpbmVTdGVwRGF0YS5xdWVyeUJhci5zYXZlZF9pZCkgPyAnc2F2ZWRfcXVlcnknIDogJ3F1ZXJ5JzsKCiAgdmFyIHBlcnNpc3REYXRhID0gX29iamVjdFNwcmVhZCh7CiAgICB0eXBlOiB0eXBlCiAgfSwgZm9ybWF0RGVmaW5lU3RlcERhdGEoZGVmaW5lU3RlcERhdGEpLCB7fSwgZm9ybWF0QWJvdXRTdGVwRGF0YShhYm91dFN0ZXBEYXRhKSwge30sIGZvcm1hdFNjaGVkdWxlU3RlcERhdGEoc2NoZWR1bGVEYXRhKSk7CgogIHJldHVybiBydWxlSWQgIT0gbnVsbCA/IF9vYmplY3RTcHJlYWQoewogICAgaWQ6IHJ1bGVJZAogIH0sIHBlcnNpc3REYXRhKSA6IHBlcnNpc3REYXRhOwp9OwoKZXhwb3J0cy5mb3JtYXRSdWxlID0gZm9ybWF0UnVsZTs="},null]}