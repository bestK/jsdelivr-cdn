{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/legacy/ui/public/agg_types/buckets/terms.js","dependencies":[{"path":"src/legacy/ui/public/agg_types/buckets/terms.js","mtime":1585205040787},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLnRlcm1zQnVja2V0QWdnID0gdm9pZCAwOwoKdmFyIF9sb2Rhc2ggPSByZXF1aXJlKCJsb2Rhc2giKTsKCnZhciBfaTE4biA9IHJlcXVpcmUoIkBrYm4vaTE4biIpOwoKdmFyIF9jb3VyaWVyID0gcmVxdWlyZSgiLi4vLi4vY291cmllciIpOwoKdmFyIF9idWNrZXRfYWdnX3R5cGUgPSByZXF1aXJlKCIuL19idWNrZXRfYWdnX3R5cGUiKTsKCnZhciBfYnVja2V0X2FnZ190eXBlcyA9IHJlcXVpcmUoIi4vYnVja2V0X2FnZ190eXBlcyIpOwoKdmFyIF90ZXJtcyA9IHJlcXVpcmUoIi4vY3JlYXRlX2ZpbHRlci90ZXJtcyIpOwoKdmFyIF9pbmxpbmVfY29tcF93cmFwcGVyID0gcmVxdWlyZSgiLi9pbmxpbmVfY29tcF93cmFwcGVyIik7Cgp2YXIgX21pZ3JhdGVfaW5jbHVkZV9leGNsdWRlX2Zvcm1hdCA9IHJlcXVpcmUoIi4vbWlncmF0ZV9pbmNsdWRlX2V4Y2x1ZGVfZm9ybWF0Iik7Cgp2YXIgX29yZGVyX2FnZyA9IHJlcXVpcmUoIi4uLy4uL3Zpcy9lZGl0b3JzL2RlZmF1bHQvY29udHJvbHMvb3JkZXJfYWdnIik7Cgp2YXIgX29yZGVyID0gcmVxdWlyZSgiLi4vLi4vdmlzL2VkaXRvcnMvZGVmYXVsdC9jb250cm9scy9vcmRlciIpOwoKdmFyIF9vcmRlcl9ieSA9IHJlcXVpcmUoIi4uLy4uL3Zpcy9lZGl0b3JzL2RlZmF1bHQvY29udHJvbHMvb3JkZXJfYnkiKTsKCnZhciBfc2l6ZSA9IHJlcXVpcmUoIi4uLy4uL3Zpcy9lZGl0b3JzL2RlZmF1bHQvY29udHJvbHMvc2l6ZSIpOwoKdmFyIF9taXNzaW5nX2J1Y2tldCA9IHJlcXVpcmUoIi4uLy4uL3Zpcy9lZGl0b3JzL2RlZmF1bHQvY29udHJvbHMvbWlzc2luZ19idWNrZXQiKTsKCnZhciBfb3RoZXJfYnVja2V0ID0gcmVxdWlyZSgiLi4vLi4vdmlzL2VkaXRvcnMvZGVmYXVsdC9jb250cm9scy9vdGhlcl9idWNrZXQiKTsKCnZhciBfcHVibGljID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vLi4vcGx1Z2lucy9kYXRhL3B1YmxpYyIpOwoKdmFyIF9zY2hlbWFzID0gcmVxdWlyZSgiLi4vLi4vdmlzL2VkaXRvcnMvZGVmYXVsdC9zY2hlbWFzIik7Cgp2YXIgX3Rlcm1zX290aGVyX2J1Y2tldF9oZWxwZXIgPSByZXF1aXJlKCIuL190ZXJtc19vdGhlcl9idWNrZXRfaGVscGVyIik7CgpmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsKICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7CgogIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7CiAgICB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsKICAgIGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsKICAgICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7CiAgICB9KTsKICAgIGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsKICB9CgogIHJldHVybiBrZXlzOwp9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgewogIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsKCiAgICBpZiAoaSAlIDIpIHsKICAgICAgb3duS2V5cyhzb3VyY2UsIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOwogICAgICB9KTsKICAgIH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsKICAgIH0gZWxzZSB7CiAgICAgIG93bktleXMoc291cmNlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsKICAgICAgfSk7CiAgICB9CiAgfQoKICByZXR1cm4gdGFyZ2V0Owp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7CiAgaWYgKGtleSBpbiBvYmopIHsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgICB2YWx1ZTogdmFsdWUsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgd3JpdGFibGU6IHRydWUKICAgIH0pOwogIH0gZWxzZSB7CiAgICBvYmpba2V5XSA9IHZhbHVlOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7CiAgcmV0dXJuIF9hcnJheVdpdGhIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHx8IF9ub25JdGVyYWJsZVJlc3QoKTsKfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlUmVzdCgpIHsKICB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7Cn0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHsKICB2YXIgX2FyciA9IFtdOwogIHZhciBfbiA9IHRydWU7CiAgdmFyIF9kID0gZmFsc2U7CiAgdmFyIF9lID0gdW5kZWZpbmVkOwoKICB0cnkgewogICAgZm9yICh2YXIgX2kgPSBhcnJbU3ltYm9sLml0ZXJhdG9yXSgpLCBfczsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSkgewogICAgICBfYXJyLnB1c2goX3MudmFsdWUpOwoKICAgICAgaWYgKGkgJiYgX2Fyci5sZW5ndGggPT09IGkpIGJyZWFrOwogICAgfQogIH0gY2F0Y2ggKGVycikgewogICAgX2QgPSB0cnVlOwogICAgX2UgPSBlcnI7CiAgfSBmaW5hbGx5IHsKICAgIHRyeSB7CiAgICAgIGlmICghX24gJiYgX2lbInJldHVybiJdICE9IG51bGwpIF9pWyJyZXR1cm4iXSgpOwogICAgfSBmaW5hbGx5IHsKICAgICAgaWYgKF9kKSB0aHJvdyBfZTsKICAgIH0KICB9CgogIHJldHVybiBfYXJyOwp9CgpmdW5jdGlvbiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsKfQoKdmFyIF9hbGwgPSBfc2xpY2VkVG9BcnJheShuZXcgX3NjaGVtYXMuU2NoZW1hcyhbewogIGdyb3VwOiAnbm9uZScsCiAgbmFtZTogJ29yZGVyQWdnJywKICAvLyBUaGlzIHN0cmluZyBpcyBuZXZlciB2aXNpYmxlIHRvIHRoZSB1c2VyIHNvIGl0IGRvZXNuJ3QgbmVlZCB0byBiZSB0cmFuc2xhdGVkCiAgdGl0bGU6ICdPcmRlciBBZ2cnLAogIGhpZGVDdXN0b21MYWJlbDogdHJ1ZSwKICBhZ2dGaWx0ZXI6IF9vcmRlcl9ieS5hZ2dGaWx0ZXIKfV0pLmFsbCwgMSksCiAgICBvcmRlckFnZ1NjaGVtYSA9IF9hbGxbMF07Cgp2YXIgdGVybXNUaXRsZSA9IF9pMThuLmkxOG4udHJhbnNsYXRlKCdjb21tb24udWkuYWdnVHlwZXMuYnVja2V0cy50ZXJtc1RpdGxlJywgewogIGRlZmF1bHRNZXNzYWdlOiAnVGVybXMnCn0pOwoKdmFyIHRlcm1zQnVja2V0QWdnID0gbmV3IF9idWNrZXRfYWdnX3R5cGUuQnVja2V0QWdnVHlwZSh7CiAgbmFtZTogX2J1Y2tldF9hZ2dfdHlwZXMuQlVDS0VUX1RZUEVTLlRFUk1TLAogIHRpdGxlOiB0ZXJtc1RpdGxlLAogIG1ha2VMYWJlbDogZnVuY3Rpb24gbWFrZUxhYmVsKGFnZykgewogICAgdmFyIHBhcmFtcyA9IGFnZy5wYXJhbXM7CiAgICByZXR1cm4gYWdnLmdldEZpZWxkRGlzcGxheU5hbWUoKSArICc6ICcgKyBwYXJhbXMub3JkZXIudGV4dDsKICB9LAogIGdldEZvcm1hdDogZnVuY3Rpb24gZ2V0Rm9ybWF0KGJ1Y2tldCkgewogICAgcmV0dXJuIHsKICAgICAgZ2V0Q29udmVydGVyRm9yOiBmdW5jdGlvbiBnZXRDb252ZXJ0ZXJGb3IodHlwZSkgewogICAgICAgIHJldHVybiBmdW5jdGlvbiAodmFsKSB7CiAgICAgICAgICBpZiAodmFsID09PSAnX19vdGhlcl9fJykgewogICAgICAgICAgICByZXR1cm4gYnVja2V0LnBhcmFtcy5vdGhlckJ1Y2tldExhYmVsOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICh2YWwgPT09ICdfX21pc3NpbmdfXycpIHsKICAgICAgICAgICAgcmV0dXJuIGJ1Y2tldC5wYXJhbXMubWlzc2luZ0J1Y2tldExhYmVsOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBidWNrZXQucGFyYW1zLmZpZWxkLmZvcm1hdC5jb252ZXJ0KHZhbCwgdHlwZSk7CiAgICAgICAgfTsKICAgICAgfQogICAgfTsKICB9LAogIGNyZWF0ZUZpbHRlcjogX3Rlcm1zLmNyZWF0ZUZpbHRlclRlcm1zLAogIHBvc3RGbGlnaHRSZXF1ZXN0OiBmdW5jdGlvbiBwb3N0RmxpZ2h0UmVxdWVzdChyZXNwLCBhZ2dDb25maWdzLCBhZ2dDb25maWcsIHNlYXJjaFNvdXJjZSwgaW5zcGVjdG9yQWRhcHRlcnMsIGFib3J0U2lnbmFsKSB7CiAgICB2YXIgbmVzdGVkU2VhcmNoU291cmNlLCBmaWx0ZXJBZ2csIHJlcXVlc3QsIHJlc3BvbnNlOwogICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hc3luYyhmdW5jdGlvbiBwb3N0RmxpZ2h0UmVxdWVzdCQoX2NvbnRleHQpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIGlmIChyZXNwLmFnZ3JlZ2F0aW9ucykgewogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCByZXNwKTsKCiAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgIG5lc3RlZFNlYXJjaFNvdXJjZSA9IHNlYXJjaFNvdXJjZS5jcmVhdGVDaGlsZCgpOwoKICAgICAgICAgICAgaWYgKCFhZ2dDb25maWcucGFyYW1zLm90aGVyQnVja2V0KSB7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE2OwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBmaWx0ZXJBZ2cgPSAoMCwgX3Rlcm1zX290aGVyX2J1Y2tldF9oZWxwZXIuYnVpbGRPdGhlckJ1Y2tldEFnZykoYWdnQ29uZmlncywgYWdnQ29uZmlnLCByZXNwKTsKCiAgICAgICAgICAgIGlmIChmaWx0ZXJBZ2cpIHsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNzsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgcmVzcCk7CgogICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICBuZXN0ZWRTZWFyY2hTb3VyY2Uuc2V0RmllbGQoJ2FnZ3MnLCBmaWx0ZXJBZ2cpOwogICAgICAgICAgICByZXF1ZXN0ID0gaW5zcGVjdG9yQWRhcHRlcnMucmVxdWVzdHMuc3RhcnQoX2kxOG4uaTE4bi50cmFuc2xhdGUoJ2NvbW1vbi51aS5hZ2dUeXBlcy5idWNrZXRzLnRlcm1zLm90aGVyQnVja2V0VGl0bGUnLCB7CiAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdPdGhlciBidWNrZXQnCiAgICAgICAgICAgIH0pLCB7CiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IF9pMThuLmkxOG4udHJhbnNsYXRlKCdjb21tb24udWkuYWdnVHlwZXMuYnVja2V0cy50ZXJtcy5vdGhlckJ1Y2tldERlc2NyaXB0aW9uJywgewogICAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdUaGlzIHJlcXVlc3QgY291bnRzIHRoZSBudW1iZXIgb2YgZG9jdW1lbnRzIHRoYXQgZmFsbCAnICsgJ291dHNpZGUgdGhlIGNyaXRlcmlvbiBvZiB0aGUgZGF0YSBidWNrZXRzLicKICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgbmVzdGVkU2VhcmNoU291cmNlLmdldFNlYXJjaFJlcXVlc3RCb2R5KCkudGhlbihmdW5jdGlvbiAoYm9keSkgewogICAgICAgICAgICAgIHJlcXVlc3QuanNvbihib2R5KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHJlcXVlc3Quc3RhdHMoKDAsIF9jb3VyaWVyLmdldFJlcXVlc3RJbnNwZWN0b3JTdGF0cykobmVzdGVkU2VhcmNoU291cmNlKSk7CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMzsKICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hd3JhcChuZXN0ZWRTZWFyY2hTb3VyY2UuZmV0Y2goewogICAgICAgICAgICAgIGFib3J0U2lnbmFsOiBhYm9ydFNpZ25hbAogICAgICAgICAgICB9KSk7CgogICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgcmVzcG9uc2UgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICByZXF1ZXN0LnN0YXRzKCgwLCBfY291cmllci5nZXRSZXNwb25zZUluc3BlY3RvclN0YXRzKShuZXN0ZWRTZWFyY2hTb3VyY2UsIHJlc3BvbnNlKSkub2soewogICAgICAgICAgICAgIGpzb246IHJlc3BvbnNlCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXNwID0gKDAsIF90ZXJtc19vdGhlcl9idWNrZXRfaGVscGVyLm1lcmdlT3RoZXJCdWNrZXRBZ2dSZXNwb25zZSkoYWdnQ29uZmlncywgcmVzcCwgcmVzcG9uc2UsIGFnZ0NvbmZpZywgZmlsdGVyQWdnKCkpOwoKICAgICAgICAgIGNhc2UgMTY6CiAgICAgICAgICAgIGlmIChhZ2dDb25maWcucGFyYW1zLm1pc3NpbmdCdWNrZXQpIHsKICAgICAgICAgICAgICByZXNwID0gKDAsIF90ZXJtc19vdGhlcl9idWNrZXRfaGVscGVyLnVwZGF0ZU1pc3NpbmdCdWNrZXQpKHJlc3AsIGFnZ0NvbmZpZ3MsIGFnZ0NvbmZpZyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIHJlc3ApOwoKICAgICAgICAgIGNhc2UgMTg6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSk7CiAgfSwKICBwYXJhbXM6IFt7CiAgICBuYW1lOiAnZmllbGQnLAogICAgdHlwZTogJ2ZpZWxkJywKICAgIGZpbHRlckZpZWxkVHlwZXM6IFtfcHVibGljLktCTl9GSUVMRF9UWVBFUy5OVU1CRVIsIF9wdWJsaWMuS0JOX0ZJRUxEX1RZUEVTLkJPT0xFQU4sIF9wdWJsaWMuS0JOX0ZJRUxEX1RZUEVTLkRBVEUsIF9wdWJsaWMuS0JOX0ZJRUxEX1RZUEVTLklQLCBfcHVibGljLktCTl9GSUVMRF9UWVBFUy5TVFJJTkddCiAgfSwgewogICAgbmFtZTogJ29yZGVyQnknLAogICAgZWRpdG9yQ29tcG9uZW50OiBfb3JkZXJfYnkuT3JkZXJCeVBhcmFtRWRpdG9yLAogICAgd3JpdGU6IF9sb2Rhc2gubm9vcCAvLyBwcmV2ZW50IGRlZmF1bHQgd3JpdGUsIGl0J3MgaGFuZGxlZCBieSBvcmRlckFnZwoKICB9LCB7CiAgICBuYW1lOiAnb3JkZXJBZ2cnLAogICAgdHlwZTogJ2FnZycsCiAgICBkZWZhdWx0OiBudWxsLAogICAgZWRpdG9yQ29tcG9uZW50OiBfb3JkZXJfYWdnLk9yZGVyQWdnUGFyYW1FZGl0b3IsCiAgICBtYWtlQWdnOiBmdW5jdGlvbiBtYWtlQWdnKHRlcm1zQWdnLCBzdGF0ZSkgewogICAgICBzdGF0ZSA9IHN0YXRlIHx8IHt9OwogICAgICBzdGF0ZS5zY2hlbWEgPSBvcmRlckFnZ1NjaGVtYTsKICAgICAgdmFyIG9yZGVyQWdnID0gdGVybXNBZ2cuYWdnQ29uZmlncy5jcmVhdGVBZ2dDb25maWcoc3RhdGUsIHsKICAgICAgICBhZGRUb0FnZ0NvbmZpZ3M6IGZhbHNlCiAgICAgIH0pOwogICAgICBvcmRlckFnZy5pZCA9IHRlcm1zQWdnLmlkICsgJy1vcmRlckFnZyc7CiAgICAgIHJldHVybiBvcmRlckFnZzsKICAgIH0sCiAgICB3cml0ZTogZnVuY3Rpb24gd3JpdGUoYWdnLCBvdXRwdXQsIGFnZ3MpIHsKICAgICAgdmFyIGRpciA9IGFnZy5wYXJhbXMub3JkZXIudmFsdWU7CiAgICAgIHZhciBvcmRlciA9IG91dHB1dC5wYXJhbXMub3JkZXIgPSB7fTsKICAgICAgdmFyIG9yZGVyQWdnID0gYWdnLnBhcmFtcy5vcmRlckFnZyB8fCBhZ2dzLmdldFJlc3BvbnNlQWdnQnlJZChhZ2cucGFyYW1zLm9yZGVyQnkpOyAvLyBUT0RPOiBUaGlzIHdvcmtzIGFyb3VuZCBhbiBFbGFzdGljc2VhcmNoIGJ1ZyB0aGUgYWx3YXlzIGNhc3RzIHRlcm1zIGFnZyBzY3JpcHRzIHRvIHN0cmluZ3MKICAgICAgLy8gdGh1cyBjYXVzaW5nIGlzc3VlcyB3aXRoIGZpbHRlcmluZy4gVGhpcyBwcm9iYWJseSBjYXVzZXMgb3RoZXIgaXNzdWVzIHNpbmNlIGZsb2F0IG1pZ2h0IG5vdAogICAgICAvLyBiZSBhYmxlIHRvIGNvbnRhaW4gdGhlIG51bWJlciBvbiB0aGUgZWxhc3RpY3NlYXJjaCBzaWRlCgogICAgICBpZiAob3V0cHV0LnBhcmFtcy5zY3JpcHQpIHsKICAgICAgICBvdXRwdXQucGFyYW1zLnZhbHVlX3R5cGUgPSBhZ2cuZ2V0RmllbGQoKS50eXBlID09PSAnbnVtYmVyJyA/ICdmbG9hdCcgOiBhZ2cuZ2V0RmllbGQoKS50eXBlOwogICAgICB9CgogICAgICBpZiAoYWdnLnBhcmFtcy5taXNzaW5nQnVja2V0ICYmIGFnZy5wYXJhbXMuZmllbGQudHlwZSA9PT0gJ3N0cmluZycpIHsKICAgICAgICBvdXRwdXQucGFyYW1zLm1pc3NpbmcgPSAnX19taXNzaW5nX18nOwogICAgICB9CgogICAgICBpZiAoIW9yZGVyQWdnKSB7CiAgICAgICAgb3JkZXJbYWdnLnBhcmFtcy5vcmRlckJ5IHx8ICdfY291bnQnXSA9IGRpcjsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmIChvcmRlckFnZy50eXBlLm5hbWUgPT09ICdjb3VudCcpIHsKICAgICAgICBvcmRlci5fY291bnQgPSBkaXI7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgb3JkZXJBZ2dJZCA9IG9yZGVyQWdnLmlkOwoKICAgICAgaWYgKG9yZGVyQWdnLnBhcmVudElkICYmIGFnZ3MpIHsKICAgICAgICBvcmRlckFnZyA9IGFnZ3MuYnlJZChvcmRlckFnZy5wYXJlbnRJZCk7CiAgICAgIH0KCiAgICAgIG91dHB1dC5zdWJBZ2dzID0gKG91dHB1dC5zdWJBZ2dzIHx8IFtdKS5jb25jYXQob3JkZXJBZ2cpOwogICAgICBvcmRlcltvcmRlckFnZ0lkXSA9IGRpcjsKICAgIH0KICB9LCB7CiAgICBuYW1lOiAnb3JkZXInLAogICAgdHlwZTogJ29wdGlvbmVkJywKICAgIGRlZmF1bHQ6ICdkZXNjJywKICAgIGVkaXRvckNvbXBvbmVudDogKDAsIF9pbmxpbmVfY29tcF93cmFwcGVyLndyYXBXaXRoSW5saW5lQ29tcCkoX29yZGVyLk9yZGVyUGFyYW1FZGl0b3IpLAogICAgb3B0aW9uczogW3sKICAgICAgdGV4dDogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ2NvbW1vbi51aS5hZ2dUeXBlcy5idWNrZXRzLnRlcm1zLm9yZGVyRGVzY2VuZGluZ1RpdGxlJywgewogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnRGVzY2VuZGluZycKICAgICAgfSksCiAgICAgIHZhbHVlOiAnZGVzYycKICAgIH0sIHsKICAgICAgdGV4dDogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ2NvbW1vbi51aS5hZ2dUeXBlcy5idWNrZXRzLnRlcm1zLm9yZGVyQXNjZW5kaW5nVGl0bGUnLCB7CiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdBc2NlbmRpbmcnCiAgICAgIH0pLAogICAgICB2YWx1ZTogJ2FzYycKICAgIH1dLAogICAgd3JpdGU6IF9sb2Rhc2gubm9vcCAvLyBwcmV2ZW50IGRlZmF1bHQgd3JpdGUsIGl0J3MgaGFuZGxlZCBieSBvcmRlckFnZwoKICB9LCB7CiAgICBuYW1lOiAnc2l6ZScsCiAgICBlZGl0b3JDb21wb25lbnQ6ICgwLCBfaW5saW5lX2NvbXBfd3JhcHBlci53cmFwV2l0aElubGluZUNvbXApKF9zaXplLlNpemVQYXJhbUVkaXRvciksCiAgICBkZWZhdWx0OiA1CiAgfSwgewogICAgbmFtZTogJ290aGVyQnVja2V0JywKICAgIGRlZmF1bHQ6IGZhbHNlLAogICAgZWRpdG9yQ29tcG9uZW50OiBfb3RoZXJfYnVja2V0Lk90aGVyQnVja2V0UGFyYW1FZGl0b3IsCiAgICB3cml0ZTogX2xvZGFzaC5ub29wCiAgfSwgewogICAgbmFtZTogJ290aGVyQnVja2V0TGFiZWwnLAogICAgdHlwZTogJ3N0cmluZycsCiAgICBkZWZhdWx0OiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgnY29tbW9uLnVpLmFnZ1R5cGVzLmJ1Y2tldHMudGVybXMub3RoZXJCdWNrZXRMYWJlbCcsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdPdGhlcicKICAgIH0pLAogICAgZGlzcGxheU5hbWU6IF9pMThuLmkxOG4udHJhbnNsYXRlKCdjb21tb24udWkuYWdnVHlwZXMub3RoZXJCdWNrZXQubGFiZWxGb3JPdGhlckJ1Y2tldExhYmVsJywgewogICAgICBkZWZhdWx0TWVzc2FnZTogJ0xhYmVsIGZvciBvdGhlciBidWNrZXQnCiAgICB9KSwKICAgIHNob3VsZFNob3c6IGZ1bmN0aW9uIHNob3VsZFNob3coYWdnKSB7CiAgICAgIHJldHVybiBhZ2cuZ2V0UGFyYW0oJ290aGVyQnVja2V0Jyk7CiAgICB9LAogICAgd3JpdGU6IF9sb2Rhc2gubm9vcAogIH0sIHsKICAgIG5hbWU6ICdtaXNzaW5nQnVja2V0JywKICAgIGRlZmF1bHQ6IGZhbHNlLAogICAgZWRpdG9yQ29tcG9uZW50OiBfbWlzc2luZ19idWNrZXQuTWlzc2luZ0J1Y2tldFBhcmFtRWRpdG9yLAogICAgd3JpdGU6IF9sb2Rhc2gubm9vcAogIH0sIHsKICAgIG5hbWU6ICdtaXNzaW5nQnVja2V0TGFiZWwnLAogICAgZGVmYXVsdDogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ2NvbW1vbi51aS5hZ2dUeXBlcy5idWNrZXRzLnRlcm1zLm1pc3NpbmdCdWNrZXRMYWJlbCcsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdNaXNzaW5nJywKICAgICAgZGVzY3JpcHRpb246ICJEZWZhdWx0IGxhYmVsIHVzZWQgaW4gY2hhcnRzIHdoZW4gZG9jdW1lbnRzIGFyZSBtaXNzaW5nIGEgZmllbGQuXG4gICAgICAgICAgVmlzaWJsZSB3aGVuIHlvdSBjcmVhdGUgYSBjaGFydCB3aXRoIGEgdGVybXMgYWdncmVnYXRpb24gYW5kIGVuYWJsZSBcIlNob3cgbWlzc2luZyB2YWx1ZXNcIiIKICAgIH0pLAogICAgdHlwZTogJ3N0cmluZycsCiAgICBkaXNwbGF5TmFtZTogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ2NvbW1vbi51aS5hZ2dUeXBlcy5vdGhlckJ1Y2tldC5sYWJlbEZvck1pc3NpbmdWYWx1ZXNMYWJlbCcsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdMYWJlbCBmb3IgbWlzc2luZyB2YWx1ZXMnCiAgICB9KSwKICAgIHNob3VsZFNob3c6IGZ1bmN0aW9uIHNob3VsZFNob3coYWdnKSB7CiAgICAgIHJldHVybiBhZ2cuZ2V0UGFyYW0oJ21pc3NpbmdCdWNrZXQnKTsKICAgIH0sCiAgICB3cml0ZTogX2xvZGFzaC5ub29wCiAgfSwgX29iamVjdFNwcmVhZCh7CiAgICBuYW1lOiAnZXhjbHVkZScsCiAgICBkaXNwbGF5TmFtZTogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ2NvbW1vbi51aS5hZ2dUeXBlcy5idWNrZXRzLnRlcm1zLmV4Y2x1ZGVMYWJlbCcsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdFeGNsdWRlJwogICAgfSksCiAgICB0eXBlOiAnc3RyaW5nJywKICAgIGFkdmFuY2VkOiB0cnVlLAogICAgc2hvdWxkU2hvdzogX21pZ3JhdGVfaW5jbHVkZV9leGNsdWRlX2Zvcm1hdC5pc1N0cmluZ1R5cGUKICB9LCBfbWlncmF0ZV9pbmNsdWRlX2V4Y2x1ZGVfZm9ybWF0Lm1pZ3JhdGVJbmNsdWRlRXhjbHVkZUZvcm1hdCksIF9vYmplY3RTcHJlYWQoewogICAgbmFtZTogJ2luY2x1ZGUnLAogICAgZGlzcGxheU5hbWU6IF9pMThuLmkxOG4udHJhbnNsYXRlKCdjb21tb24udWkuYWdnVHlwZXMuYnVja2V0cy50ZXJtcy5pbmNsdWRlTGFiZWwnLCB7CiAgICAgIGRlZmF1bHRNZXNzYWdlOiAnSW5jbHVkZScKICAgIH0pLAogICAgdHlwZTogJ3N0cmluZycsCiAgICBhZHZhbmNlZDogdHJ1ZSwKICAgIHNob3VsZFNob3c6IF9taWdyYXRlX2luY2x1ZGVfZXhjbHVkZV9mb3JtYXQuaXNTdHJpbmdUeXBlCiAgfSwgX21pZ3JhdGVfaW5jbHVkZV9leGNsdWRlX2Zvcm1hdC5taWdyYXRlSW5jbHVkZUV4Y2x1ZGVGb3JtYXQpXQp9KTsKZXhwb3J0cy50ZXJtc0J1Y2tldEFnZyA9IHRlcm1zQnVja2V0QWdnOw=="},null]}