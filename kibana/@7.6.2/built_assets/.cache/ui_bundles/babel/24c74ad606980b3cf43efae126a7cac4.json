{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/maps/public/elasticsearch_geo_utils.js","dependencies":[{"path":"x-pack/legacy/plugins/maps/public/elasticsearch_geo_utils.js","mtime":1585205045213},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmhpdHNUb0dlb0pzb24gPSBoaXRzVG9HZW9Kc29uOwpleHBvcnRzLmdlb1BvaW50VG9HZW9tZXRyeSA9IGdlb1BvaW50VG9HZW9tZXRyeTsKZXhwb3J0cy5jb252ZXJ0RVNTaGFwZVRvR2VvanNvbkdlb21ldHJ5ID0gY29udmVydEVTU2hhcGVUb0dlb2pzb25HZW9tZXRyeTsKZXhwb3J0cy5nZW9TaGFwZVRvR2VvbWV0cnkgPSBnZW9TaGFwZVRvR2VvbWV0cnk7CmV4cG9ydHMuY3JlYXRlRXh0ZW50RmlsdGVyID0gY3JlYXRlRXh0ZW50RmlsdGVyOwpleHBvcnRzLmNyZWF0ZVNwYXRpYWxGaWx0ZXJXaXRoQm91bmRpbmdCb3ggPSBjcmVhdGVTcGF0aWFsRmlsdGVyV2l0aEJvdW5kaW5nQm94OwpleHBvcnRzLmNyZWF0ZVNwYXRpYWxGaWx0ZXJXaXRoR2VvbWV0cnkgPSBjcmVhdGVTcGF0aWFsRmlsdGVyV2l0aEdlb21ldHJ5OwpleHBvcnRzLnJvdW5kQ29vcmRpbmF0ZXMgPSByb3VuZENvb3JkaW5hdGVzOwpleHBvcnRzLmdldEJvdW5kaW5nQm94R2VvbWV0cnkgPSBnZXRCb3VuZGluZ0JveEdlb21ldHJ5OwpleHBvcnRzLmNvbnZlcnRNYXBFeHRlbnRUb1BvbHlnb24gPSBjb252ZXJ0TWFwRXh0ZW50VG9Qb2x5Z29uOwoKdmFyIF9sb2Rhc2ggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoImxvZGFzaCIpKTsKCnZhciBfaTE4biA9IHJlcXVpcmUoIkBrYm4vaTE4biIpOwoKdmFyIF93ZWxsa25vd24gPSByZXF1aXJlKCJ3ZWxsa25vd24iKTsKCnZhciBfY29uc3RhbnRzID0gcmVxdWlyZSgiLi4vY29tbW9uL2NvbnN0YW50cyIpOwoKdmFyIF9pMThuX2dldHRlcnMgPSByZXF1aXJlKCIuLi9jb21tb24vaTE4bl9nZXR0ZXJzIik7Cgp2YXIgX2tpYmFuYV9zZXJ2aWNlcyA9IHJlcXVpcmUoIi4va2liYW5hX3NlcnZpY2VzIik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7IHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7IGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7IH0pOyBrZXlzLnB1c2guYXBwbHkoa2V5cywgc3ltYm9scyk7IH0gcmV0dXJuIGtleXM7IH0KCmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7IGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OyBpZiAoaSAlIDIpIHsgb3duS2V5cyhzb3VyY2UsIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsgfSk7IH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsgfSBlbHNlIHsgb3duS2V5cyhzb3VyY2UpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsgfSk7IH0gfSByZXR1cm4gdGFyZ2V0OyB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7IGlmIChrZXkgaW4gb2JqKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgeyB2YWx1ZTogdmFsdWUsIGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUgfSk7IH0gZWxzZSB7IG9ialtrZXldID0gdmFsdWU7IH0gcmV0dXJuIG9iajsgfQoKZnVuY3Rpb24gZW5zdXJlR2VvRmllbGQodHlwZSkgewogIHZhciBleHBlY3RlZFR5cGVzID0gW19jb25zdGFudHMuRVNfR0VPX0ZJRUxEX1RZUEUuR0VPX1BPSU5ULCBfY29uc3RhbnRzLkVTX0dFT19GSUVMRF9UWVBFLkdFT19TSEFQRV07CgogIGlmICghZXhwZWN0ZWRUeXBlcy5pbmNsdWRlcyh0eXBlKSkgewogICAgdmFyIGVycm9yTWVzc2FnZSA9IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tYXBzLmVzX2dlb191dGlscy51bnN1cHBvcnRlZEZpZWxkVHlwZUVycm9yTWVzc2FnZScsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdVbnN1cHBvcnRlZCBmaWVsZCB0eXBlLCBleHBlY3RlZDoge2V4cGVjdGVkVHlwZXN9LCB5b3UgcHJvdmlkZWQ6IHtmaWVsZFR5cGV9JywKICAgICAgdmFsdWVzOiB7CiAgICAgICAgZmllbGRUeXBlOiB0eXBlLAogICAgICAgIGV4cGVjdGVkVHlwZXM6IGV4cGVjdGVkVHlwZXMuam9pbignLCcpCiAgICAgIH0KICAgIH0pOwoKICAgIHRocm93IG5ldyBFcnJvcihlcnJvck1lc3NhZ2UpOwogIH0KfQoKZnVuY3Rpb24gZW5zdXJlR2VvbWV0cnlUeXBlKHR5cGUsIGV4cGVjdGVkVHlwZXMpIHsKICBpZiAoIWV4cGVjdGVkVHlwZXMuaW5jbHVkZXModHlwZSkpIHsKICAgIHZhciBlcnJvck1lc3NhZ2UgPSBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWFwcy5lc19nZW9fdXRpbHMudW5zdXBwb3J0ZWRHZW9tZXRyeVR5cGVFcnJvck1lc3NhZ2UnLCB7CiAgICAgIGRlZmF1bHRNZXNzYWdlOiAnVW5zdXBwb3J0ZWQgZ2VvbWV0cnkgdHlwZSwgZXhwZWN0ZWQ6IHtleHBlY3RlZFR5cGVzfSwgeW91IHByb3ZpZGVkOiB7Z2VvbWV0cnlUeXBlfScsCiAgICAgIHZhbHVlczogewogICAgICAgIGdlb21ldHJ5VHlwZTogdHlwZSwKICAgICAgICBleHBlY3RlZFR5cGVzOiBleHBlY3RlZFR5cGVzLmpvaW4oJywnKQogICAgICB9CiAgICB9KTsKCiAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JNZXNzYWdlKTsKICB9Cn0KLyoqCiAqIENvbnZlcnRzIEVsYXN0aWNzZWFyY2ggc2VhcmNoIHJlc3VsdHMgaW50byBHZW9Kc29uIEZlYXR1cmVDb2xsZWN0aW9uCiAqCiAqIEBwYXJhbSB7YXJyYXl9IGhpdHMgRWxhc3RpY3NlYXJjaCBzZWFyY2ggcmVzcG9uc2UgaGl0cyBhcnJheQogKiBAcGFyYW0ge2Z1bmN0aW9ufSBmbGF0dGVuSGl0IE1ldGhvZCB0byBmbGF0dGVuIGhpdHMuX3NvdXJjZSBhbmQgaGl0cy5maWVsZHMgaW50byBwcm9wZXJ0aWVzIG9iamVjdC4KICogICBTaG91bGQganVzdCBiZSBJbmRleFBhdHRlcm4uZmxhdHRlbkhpdCBidXQgd2FudGVkIHRvIGF2b2lkIGNvdXBsaW5nIHRoaXMgbWV0aG9kIHRvIEluZGV4UGF0dGVybi4KICogQHBhcmFtIHtzdHJpbmd9IGdlb0ZpZWxkTmFtZSBHZW9tZXRyeSBmaWVsZCBuYW1lCiAqIEBwYXJhbSB7c3RyaW5nfSBnZW9GaWVsZFR5cGUgR2VvbWV0cnkgZmllbGQgdHlwZSBbImdlb19wb2ludCIsICJnZW9fc2hhcGUiXQogKiBAcmV0dXJucyB7bnVtYmVyfQogKi8KCgpmdW5jdGlvbiBoaXRzVG9HZW9Kc29uKGhpdHMsIGZsYXR0ZW5IaXQsIGdlb0ZpZWxkTmFtZSwgZ2VvRmllbGRUeXBlKSB7CiAgdmFyIGZlYXR1cmVzID0gW107CiAgdmFyIHRtcEdlb21ldHJpZXNBY2N1bXVsYXRvciA9IFtdOwoKICBmb3IgKHZhciBpID0gMDsgaSA8IGhpdHMubGVuZ3RoOyBpKyspIHsKICAgIHZhciBwcm9wZXJ0aWVzID0gZmxhdHRlbkhpdChoaXRzW2ldKTsKICAgIHRtcEdlb21ldHJpZXNBY2N1bXVsYXRvci5sZW5ndGggPSAwOyAvL3RydW5jYXRlIGFjY3VtdWxhdG9yCgogICAgZW5zdXJlR2VvRmllbGQoZ2VvRmllbGRUeXBlKTsKCiAgICBpZiAoZ2VvRmllbGRUeXBlID09PSBfY29uc3RhbnRzLkVTX0dFT19GSUVMRF9UWVBFLkdFT19QT0lOVCkgewogICAgICBnZW9Qb2ludFRvR2VvbWV0cnkocHJvcGVydGllc1tnZW9GaWVsZE5hbWVdLCB0bXBHZW9tZXRyaWVzQWNjdW11bGF0b3IpOwogICAgfSBlbHNlIHsKICAgICAgZ2VvU2hhcGVUb0dlb21ldHJ5KHByb3BlcnRpZXNbZ2VvRmllbGROYW1lXSwgdG1wR2VvbWV0cmllc0FjY3VtdWxhdG9yKTsKICAgIH0gLy8gZG9uJ3QgaW5jbHVkZSBnZW9tZXRyeSBmaWVsZCB2YWx1ZSBpbiBwcm9wZXJ0aWVzCgoKICAgIGRlbGV0ZSBwcm9wZXJ0aWVzW2dlb0ZpZWxkTmFtZV07IC8vY3JlYXRlIG5ldyBnZW9qc29uIEZlYXR1cmUgZm9yIGV2ZXJ5IGluZGl2aWR1YWwgZ2VvanNvbiBnZW9tZXRyeS4KCiAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRtcEdlb21ldHJpZXNBY2N1bXVsYXRvci5sZW5ndGg7IGorKykgewogICAgICBmZWF0dXJlcy5wdXNoKHsKICAgICAgICB0eXBlOiAnRmVhdHVyZScsCiAgICAgICAgZ2VvbWV0cnk6IHRtcEdlb21ldHJpZXNBY2N1bXVsYXRvcltqXSwKICAgICAgICAvLyBfaWQgaXMgbm90IHVuaXF1ZSBhY3Jvc3MgS2liYW5hIGluZGV4IHBhdHRlcm4uIE11bHRpcGxlIEVTIGluZGljZXMgY291bGQgaGF2ZSBfaWQgY29sbGlzaW9ucwogICAgICAgIC8vIE5lZWQgdG8gcHJlZml4IHdpdGggX2luZGV4IHRvIGd1YXJhbnRlZSB1bmlxdWVuZXNzCiAgICAgICAgaWQ6ICIiLmNvbmNhdChwcm9wZXJ0aWVzLl9pbmRleCwgIjoiKS5jb25jYXQocHJvcGVydGllcy5faWQsICI6IikuY29uY2F0KGopLAogICAgICAgIHByb3BlcnRpZXM6IHByb3BlcnRpZXMKICAgICAgfSk7CiAgICB9CiAgfQoKICByZXR1cm4gewogICAgdHlwZTogJ0ZlYXR1cmVDb2xsZWN0aW9uJywKICAgIGZlYXR1cmVzOiBmZWF0dXJlcwogIH07Cn0gLy8gUGFyc2UgZ2VvX3BvaW50IGRvY3ZhbHVlX2ZpZWxkCi8vIEVpdGhlcgovLyAxKSBBcnJheSBvZiBsYXRMb24gc3RyaW5ncwovLyAyKSBsYXRMb24gc3RyaW5nCgoKZnVuY3Rpb24gZ2VvUG9pbnRUb0dlb21ldHJ5KHZhbHVlLCBhY2N1bXVsYXRvcikgewogIGlmICghdmFsdWUpIHsKICAgIHJldHVybjsKICB9CgogIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkgewogICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2YWx1ZS5sZW5ndGg7IGkrKykgewogICAgICBnZW9Qb2ludFRvR2VvbWV0cnkodmFsdWVbaV0sIGFjY3VtdWxhdG9yKTsKICAgIH0KCiAgICByZXR1cm47CiAgfQoKICB2YXIgY29tbWFTcGxpdCA9IHZhbHVlLnNwbGl0KCcsJyk7CiAgdmFyIGxhdCA9IHBhcnNlRmxvYXQoY29tbWFTcGxpdFswXSk7CiAgdmFyIGxvbiA9IHBhcnNlRmxvYXQoY29tbWFTcGxpdFsxXSk7CiAgYWNjdW11bGF0b3IucHVzaCh7CiAgICB0eXBlOiBfY29uc3RhbnRzLkdFT19KU09OX1RZUEUuUE9JTlQsCiAgICBjb29yZGluYXRlczogW2xvbiwgbGF0XQogIH0pOwp9CgpmdW5jdGlvbiBjb252ZXJ0RVNTaGFwZVRvR2VvanNvbkdlb21ldHJ5KHZhbHVlKSB7CiAgdmFyIGdlb0pzb24gPSB7CiAgICB0eXBlOiB2YWx1ZS50eXBlLAogICAgY29vcmRpbmF0ZXM6IHZhbHVlLmNvb3JkaW5hdGVzCiAgfTsgLy8gaHR0cHM6Ly93d3cuZWxhc3RpYy5jby9ndWlkZS9lbi9lbGFzdGljc2VhcmNoL3JlZmVyZW5jZS9jdXJyZW50L2dlby1zaGFwZS5odG1sI2lucHV0LXN0cnVjdHVyZQogIC8vIEZvciBzb21lIHVua25vd24gY29tcGF0aWJpbGl0eSBuaWdodG1hcmlzaCByZWFzb24sIEVsYXN0aWNzZWFyY2ggdHlwZXMgYXJlIG5vdCBjYXBpdGFsaXplZCB0aGUgc2FtZSBhcyBnZW9qc29uIHR5cGVzCiAgLy8gRm9yIGV4YW1wbGU6ICdMaW5lU3RyaW5nJyBnZW9qc29uIHR5cGUgaXMgJ2xpbmVzdHJpbmcnIGluIGVsYXN0aWNzZWFyY2gKICAvLyBDb252ZXJ0IGZlYXR1cmUgdHlwZXMgdG8gZ2VvanNvbiBzcGVjIHZhbHVlcwogIC8vIFNvbWV0aW1lcywgdGhlIHR5cGUgaW4gRVMgaXMgY2FwaXRhbGl6ZWQgY29ycmVjdGx5LiBTb21ldGltZXMgaXQgaXMgbm90LiBJdCBkZXBlbmRzIG9uIGhvdyB0aGUgZG9jIHdhcyBpbmdlc3RlZAogIC8vIFRoZSBiZWxvdyBpcyB0aGUgY29ycmVjdGlvbiBpbi1wbGFjZS4KCiAgc3dpdGNoICh2YWx1ZS50eXBlKSB7CiAgICBjYXNlICdwb2ludCc6CiAgICAgIGdlb0pzb24udHlwZSA9IF9jb25zdGFudHMuR0VPX0pTT05fVFlQRS5QT0lOVDsKICAgICAgYnJlYWs7CgogICAgY2FzZSAnbGluZXN0cmluZyc6CiAgICAgIGdlb0pzb24udHlwZSA9IF9jb25zdGFudHMuR0VPX0pTT05fVFlQRS5MSU5FX1NUUklORzsKICAgICAgYnJlYWs7CgogICAgY2FzZSAncG9seWdvbic6CiAgICAgIGdlb0pzb24udHlwZSA9IF9jb25zdGFudHMuR0VPX0pTT05fVFlQRS5QT0xZR09OOwogICAgICBicmVhazsKCiAgICBjYXNlICdtdWx0aXBvaW50JzoKICAgICAgZ2VvSnNvbi50eXBlID0gX2NvbnN0YW50cy5HRU9fSlNPTl9UWVBFLk1VTFRJX1BPSU5UOwogICAgICBicmVhazsKCiAgICBjYXNlICdtdWx0aWxpbmVzdHJpbmcnOgogICAgICBnZW9Kc29uLnR5cGUgPSBfY29uc3RhbnRzLkdFT19KU09OX1RZUEUuTVVMVElfTElORV9TVFJJTkc7CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgJ211bHRpcG9seWdvbic6CiAgICAgIGdlb0pzb24udHlwZSA9IF9jb25zdGFudHMuR0VPX0pTT05fVFlQRS5NVUxUSV9QT0xZR09OOwogICAgICBicmVhazsKCiAgICBjYXNlICdnZW9tZXRyeWNvbGxlY3Rpb24nOgogICAgICBnZW9Kc29uLnR5cGUgPSBfY29uc3RhbnRzLkdFT19KU09OX1RZUEUuR0VPTUVUUllfQ09MTEVDVElPTjsKICAgICAgYnJlYWs7CgogICAgY2FzZSAnZW52ZWxvcGUnOgogICAgY2FzZSAnY2lyY2xlJzoKICAgICAgdmFyIGVycm9yTWVzc2FnZSA9IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tYXBzLmVzX2dlb191dGlscy5jb252ZXJ0LnVuc3VwcG9ydGVkR2VvbWV0cnlUeXBlRXJyb3JNZXNzYWdlJywgewogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiVW5hYmxlIHRvIGNvbnZlcnQge2dlb21ldHJ5VHlwZX0gZ2VvbWV0cnkgdG8gZ2VvanNvbiwgbm90IHN1cHBvcnRlZCIsCiAgICAgICAgdmFsdWVzOiB7CiAgICAgICAgICBnZW9tZXRyeVR5cGU6IGdlb0pzb24udHlwZQogICAgICAgIH0KICAgICAgfSk7CgogICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JNZXNzYWdlKTsKICB9CgogIHJldHVybiBnZW9Kc29uOwp9CgpmdW5jdGlvbiBjb252ZXJ0V0tUU3RyaW5nVG9HZW9qc29uKHZhbHVlKSB7CiAgdHJ5IHsKICAgIHJldHVybiAoMCwgX3dlbGxrbm93bi5wYXJzZSkodmFsdWUpOwogIH0gY2F0Y2ggKGUpIHsKICAgIHZhciBlcnJvck1lc3NhZ2UgPSBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWFwcy5lc19nZW9fdXRpbHMud2t0LmludmFsaWRXS1RFcnJvck1lc3NhZ2UnLCB7CiAgICAgIGRlZmF1bHRNZXNzYWdlOiAiVW5hYmxlIHRvIGNvbnZlcnQge3drdH0gdG8gZ2VvanNvbi4gVmFsaWQgV0tUIGV4cGVjdGVkLiIsCiAgICAgIHZhbHVlczogewogICAgICAgIHdrdDogdmFsdWUKICAgICAgfQogICAgfSk7CgogICAgdGhyb3cgbmV3IEVycm9yKGVycm9yTWVzc2FnZSk7CiAgfQp9CgpmdW5jdGlvbiBnZW9TaGFwZVRvR2VvbWV0cnkodmFsdWUsIGFjY3VtdWxhdG9yKSB7CiAgaWYgKCF2YWx1ZSkgewogICAgcmV0dXJuOwogIH0KCiAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7CiAgICAvLyB2YWx1ZSBleHByZXNzZWQgYXMgYW4gYXJyYXkgb2YgdmFsdWVzCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZhbHVlLmxlbmd0aDsgaSsrKSB7CiAgICAgIGdlb1NoYXBlVG9HZW9tZXRyeSh2YWx1ZVtpXSwgYWNjdW11bGF0b3IpOwogICAgfQoKICAgIHJldHVybjsKICB9CgogIHZhciBnZW9Kc29uOwoKICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykgewogICAgZ2VvSnNvbiA9IGNvbnZlcnRXS1RTdHJpbmdUb0dlb2pzb24odmFsdWUpOwogIH0gZWxzZSB7CiAgICBnZW9Kc29uID0gY29udmVydEVTU2hhcGVUb0dlb2pzb25HZW9tZXRyeSh2YWx1ZSk7CiAgfQoKICBhY2N1bXVsYXRvci5wdXNoKGdlb0pzb24pOwp9CgpmdW5jdGlvbiBjcmVhdGVHZW9Cb3VuZEJveEZpbHRlcihnZW9tZXRyeSwgZ2VvRmllbGROYW1lKSB7CiAgdmFyIGZpbHRlclByb3BzID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiB7fTsKICBlbnN1cmVHZW9tZXRyeVR5cGUoZ2VvbWV0cnkudHlwZSwgW19jb25zdGFudHMuR0VPX0pTT05fVFlQRS5QT0xZR09OXSk7CiAgdmFyIFRPUF9MRUZUX0lOREVYID0gMDsKICB2YXIgQk9UVE9NX1JJR0hUX0lOREVYID0gMjsKICB2YXIgdmVydGljaWVzID0gZ2VvbWV0cnkuY29vcmRpbmF0ZXNbX2NvbnN0YW50cy5QT0xZR09OX0NPT1JESU5BVEVTX0VYVEVSSU9SX0lOREVYXTsKICByZXR1cm4gX29iamVjdFNwcmVhZCh7CiAgICBnZW9fYm91bmRpbmdfYm94OiBfZGVmaW5lUHJvcGVydHkoe30sIGdlb0ZpZWxkTmFtZSwgewogICAgICB0b3BfbGVmdDogdmVydGljaWVzW1RPUF9MRUZUX0lOREVYXSwKICAgICAgYm90dG9tX3JpZ2h0OiB2ZXJ0aWNpZXNbQk9UVE9NX1JJR0hUX0lOREVYXQogICAgfSkKICB9LCBmaWx0ZXJQcm9wcyk7Cn0KCmZ1bmN0aW9uIGNyZWF0ZUdlb1BvbHlnb25GaWx0ZXIocG9seWdvbkNvb3JkaW5hdGVzLCBnZW9GaWVsZE5hbWUpIHsKICB2YXIgZmlsdGVyUHJvcHMgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IHt9OwogIHJldHVybiBfb2JqZWN0U3ByZWFkKHsKICAgIGdlb19wb2x5Z29uOiBfZGVmaW5lUHJvcGVydHkoewogICAgICBpZ25vcmVfdW5tYXBwZWQ6IHRydWUKICAgIH0sIGdlb0ZpZWxkTmFtZSwgewogICAgICBwb2ludHM6IHBvbHlnb25Db29yZGluYXRlc1tfY29uc3RhbnRzLlBPTFlHT05fQ09PUkRJTkFURVNfRVhURVJJT1JfSU5ERVhdLm1hcChmdW5jdGlvbiAoY29vcmRpbmF0ZVBhaXIpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgbG9uOiBjb29yZGluYXRlUGFpcltfY29uc3RhbnRzLkxPTl9JTkRFWF0sCiAgICAgICAgICBsYXQ6IGNvb3JkaW5hdGVQYWlyW19jb25zdGFudHMuTEFUX0lOREVYXQogICAgICAgIH07CiAgICAgIH0pCiAgICB9KQogIH0sIGZpbHRlclByb3BzKTsKfQoKZnVuY3Rpb24gY3JlYXRlRXh0ZW50RmlsdGVyKG1hcEV4dGVudCwgZ2VvRmllbGROYW1lLCBnZW9GaWVsZFR5cGUpIHsKICBlbnN1cmVHZW9GaWVsZChnZW9GaWVsZFR5cGUpOwogIHZhciBzYWZlUG9seWdvbiA9IGNvbnZlcnRNYXBFeHRlbnRUb1BvbHlnb24obWFwRXh0ZW50KTsKCiAgaWYgKGdlb0ZpZWxkVHlwZSA9PT0gX2NvbnN0YW50cy5FU19HRU9fRklFTERfVFlQRS5HRU9fUE9JTlQpIHsKICAgIHJldHVybiBjcmVhdGVHZW9Cb3VuZEJveEZpbHRlcihzYWZlUG9seWdvbiwgZ2VvRmllbGROYW1lKTsKICB9CgogIHJldHVybiB7CiAgICBnZW9fc2hhcGU6IF9kZWZpbmVQcm9wZXJ0eSh7fSwgZ2VvRmllbGROYW1lLCB7CiAgICAgIHNoYXBlOiBzYWZlUG9seWdvbiwKICAgICAgcmVsYXRpb246IF9jb25zdGFudHMuRVNfU1BBVElBTF9SRUxBVElPTlMuSU5URVJTRUNUUwogICAgfSkKICB9Owp9CgpmdW5jdGlvbiBjcmVhdGVTcGF0aWFsRmlsdGVyV2l0aEJvdW5kaW5nQm94KG9wdGlvbnMpIHsKICByZXR1cm4gY3JlYXRlR2VvbWV0cnlGaWx0ZXJXaXRoTWV0YShfb2JqZWN0U3ByZWFkKHt9LCBvcHRpb25zLCB7CiAgICBpc0JvdW5kaW5nQm94OiB0cnVlCiAgfSkpOwp9CgpmdW5jdGlvbiBjcmVhdGVTcGF0aWFsRmlsdGVyV2l0aEdlb21ldHJ5KG9wdGlvbnMpIHsKICByZXR1cm4gY3JlYXRlR2VvbWV0cnlGaWx0ZXJXaXRoTWV0YShvcHRpb25zKTsKfQoKZnVuY3Rpb24gY3JlYXRlR2VvbWV0cnlGaWx0ZXJXaXRoTWV0YShfcmVmKSB7CiAgdmFyIHByZUluZGV4ZWRTaGFwZSA9IF9yZWYucHJlSW5kZXhlZFNoYXBlLAogICAgICBnZW9tZXRyeSA9IF9yZWYuZ2VvbWV0cnksCiAgICAgIGdlb21ldHJ5TGFiZWwgPSBfcmVmLmdlb21ldHJ5TGFiZWwsCiAgICAgIGluZGV4UGF0dGVybklkID0gX3JlZi5pbmRleFBhdHRlcm5JZCwKICAgICAgZ2VvRmllbGROYW1lID0gX3JlZi5nZW9GaWVsZE5hbWUsCiAgICAgIGdlb0ZpZWxkVHlwZSA9IF9yZWYuZ2VvRmllbGRUeXBlLAogICAgICBfcmVmJHJlbGF0aW9uID0gX3JlZi5yZWxhdGlvbiwKICAgICAgcmVsYXRpb24gPSBfcmVmJHJlbGF0aW9uID09PSB2b2lkIDAgPyBfY29uc3RhbnRzLkVTX1NQQVRJQUxfUkVMQVRJT05TLklOVEVSU0VDVFMgOiBfcmVmJHJlbGF0aW9uLAogICAgICBfcmVmJGlzQm91bmRpbmdCb3ggPSBfcmVmLmlzQm91bmRpbmdCb3gsCiAgICAgIGlzQm91bmRpbmdCb3ggPSBfcmVmJGlzQm91bmRpbmdCb3ggPT09IHZvaWQgMCA/IGZhbHNlIDogX3JlZiRpc0JvdW5kaW5nQm94OwogIGVuc3VyZUdlb0ZpZWxkKGdlb0ZpZWxkVHlwZSk7CiAgdmFyIHJlbGF0aW9uTGFiZWwgPSBnZW9GaWVsZFR5cGUgPT09IF9jb25zdGFudHMuRVNfR0VPX0ZJRUxEX1RZUEUuR0VPX1BPSU5UID8gX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1hcHMuZXNfZ2VvX3V0aWxzLnNoYXBlRmlsdGVyLmdlb1BvaW50UmVsYXRpb25MYWJlbCcsIHsKICAgIGRlZmF1bHRNZXNzYWdlOiAnaW4nCiAgfSkgOiAoMCwgX2kxOG5fZ2V0dGVycy5nZXRFc1NwYXRpYWxSZWxhdGlvbkxhYmVsKShyZWxhdGlvbik7CiAgdmFyIG1ldGEgPSB7CiAgICB0eXBlOiBfa2liYW5hX3NlcnZpY2VzLlNQQVRJQUxfRklMVEVSX1RZUEUsCiAgICBuZWdhdGU6IGZhbHNlLAogICAgaW5kZXg6IGluZGV4UGF0dGVybklkLAogICAga2V5OiBnZW9GaWVsZE5hbWUsCiAgICBhbGlhczogIiIuY29uY2F0KGdlb0ZpZWxkTmFtZSwgIiAiKS5jb25jYXQocmVsYXRpb25MYWJlbCwgIiAiKS5jb25jYXQoZ2VvbWV0cnlMYWJlbCkKICB9OwoKICBpZiAoZ2VvRmllbGRUeXBlID09PSBfY29uc3RhbnRzLkVTX0dFT19GSUVMRF9UWVBFLkdFT19TSEFQRSkgewogICAgdmFyIHNoYXBlUXVlcnkgPSB7CiAgICAgIHJlbGF0aW9uOiByZWxhdGlvbgogICAgfTsKCiAgICBpZiAocHJlSW5kZXhlZFNoYXBlKSB7CiAgICAgIHNoYXBlUXVlcnkuaW5kZXhlZF9zaGFwZSA9IHByZUluZGV4ZWRTaGFwZTsKICAgIH0gZWxzZSB7CiAgICAgIHNoYXBlUXVlcnkuc2hhcGUgPSBnZW9tZXRyeTsKICAgIH0KCiAgICByZXR1cm4gewogICAgICBtZXRhOiBtZXRhLAogICAgICBnZW9fc2hhcGU6IF9kZWZpbmVQcm9wZXJ0eSh7CiAgICAgICAgaWdub3JlX3VubWFwcGVkOiB0cnVlCiAgICAgIH0sIGdlb0ZpZWxkTmFtZSwgc2hhcGVRdWVyeSkKICAgIH07CiAgfSAvLyBnZW9fcG9pbnRzIHN1cHBvcnRzIGxpbWl0ZWQgZ2VvbWV0cnkgdHlwZXMKCgogIGVuc3VyZUdlb21ldHJ5VHlwZShnZW9tZXRyeS50eXBlLCBbX2NvbnN0YW50cy5HRU9fSlNPTl9UWVBFLlBPTFlHT04sIF9jb25zdGFudHMuR0VPX0pTT05fVFlQRS5NVUxUSV9QT0xZR09OXSk7CgogIGlmIChnZW9tZXRyeS50eXBlID09PSBfY29uc3RhbnRzLkdFT19KU09OX1RZUEUuTVVMVElfUE9MWUdPTikgewogICAgcmV0dXJuIHsKICAgICAgbWV0YTogbWV0YSwKICAgICAgcXVlcnk6IHsKICAgICAgICBib29sOiB7CiAgICAgICAgICBzaG91bGQ6IGdlb21ldHJ5LmNvb3JkaW5hdGVzLm1hcChmdW5jdGlvbiAocG9seWdvbkNvb3JkaW5hdGVzKSB7CiAgICAgICAgICAgIHJldHVybiBjcmVhdGVHZW9Qb2x5Z29uRmlsdGVyKHBvbHlnb25Db29yZGluYXRlcywgZ2VvRmllbGROYW1lKTsKICAgICAgICAgIH0pCiAgICAgICAgfQogICAgICB9CiAgICB9OwogIH0KCiAgaWYgKGlzQm91bmRpbmdCb3gpIHsKICAgIHJldHVybiBjcmVhdGVHZW9Cb3VuZEJveEZpbHRlcihnZW9tZXRyeSwgZ2VvRmllbGROYW1lLCB7CiAgICAgIG1ldGE6IG1ldGEKICAgIH0pOwogIH0KCiAgcmV0dXJuIGNyZWF0ZUdlb1BvbHlnb25GaWx0ZXIoZ2VvbWV0cnkuY29vcmRpbmF0ZXMsIGdlb0ZpZWxkTmFtZSwgewogICAgbWV0YTogbWV0YQogIH0pOwp9CgpmdW5jdGlvbiByb3VuZENvb3JkaW5hdGVzKGNvb3JkaW5hdGVzKSB7CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb29yZGluYXRlcy5sZW5ndGg7IGkrKykgewogICAgdmFyIHZhbHVlID0gY29vcmRpbmF0ZXNbaV07CgogICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7CiAgICAgIHJvdW5kQ29vcmRpbmF0ZXModmFsdWUpOwogICAgfSBlbHNlIGlmICghaXNOYU4odmFsdWUpKSB7CiAgICAgIGNvb3JkaW5hdGVzW2ldID0gX2xvZGFzaC5kZWZhdWx0LnJvdW5kKHZhbHVlLCBfY29uc3RhbnRzLkRFQ0lNQUxfREVHUkVFU19QUkVDSVNJT04pOwogICAgfQogIH0KfQovKgogKiByZXR1cm5zIFBvbHlnb24gZ2VvbWV0cnkgd2hlcmUgY29vcmRpbmF0ZXMgZGVmaW5lIGEgYm91bmRpbmcgYm94IHRoYXQgY29udGFpbnMgdGhlIGlucHV0IGdlb21ldHJ5CiAqLwoKCmZ1bmN0aW9uIGdldEJvdW5kaW5nQm94R2VvbWV0cnkoZ2VvbWV0cnkpIHsKICBlbnN1cmVHZW9tZXRyeVR5cGUoZ2VvbWV0cnkudHlwZSwgW19jb25zdGFudHMuR0VPX0pTT05fVFlQRS5QT0xZR09OXSk7CiAgdmFyIGV4dGVyaW9yID0gZ2VvbWV0cnkuY29vcmRpbmF0ZXNbX2NvbnN0YW50cy5QT0xZR09OX0NPT1JESU5BVEVTX0VYVEVSSU9SX0lOREVYXTsKICB2YXIgZXh0ZW50ID0gewogICAgbWluTG9uOiBleHRlcmlvclswXVtfY29uc3RhbnRzLkxPTl9JTkRFWF0sCiAgICBtaW5MYXQ6IGV4dGVyaW9yWzBdW19jb25zdGFudHMuTEFUX0lOREVYXSwKICAgIG1heExvbjogZXh0ZXJpb3JbMF1bX2NvbnN0YW50cy5MT05fSU5ERVhdLAogICAgbWF4TGF0OiBleHRlcmlvclswXVtfY29uc3RhbnRzLkxBVF9JTkRFWF0KICB9OwoKICBmb3IgKHZhciBpID0gMTsgaSA8IGV4dGVyaW9yLmxlbmd0aDsgaSsrKSB7CiAgICBleHRlbnQubWluTG9uID0gTWF0aC5taW4oZXh0ZXJpb3JbaV1bX2NvbnN0YW50cy5MT05fSU5ERVhdLCBleHRlbnQubWluTG9uKTsKICAgIGV4dGVudC5taW5MYXQgPSBNYXRoLm1pbihleHRlcmlvcltpXVtfY29uc3RhbnRzLkxBVF9JTkRFWF0sIGV4dGVudC5taW5MYXQpOwogICAgZXh0ZW50Lm1heExvbiA9IE1hdGgubWF4KGV4dGVyaW9yW2ldW19jb25zdGFudHMuTE9OX0lOREVYXSwgZXh0ZW50Lm1heExvbik7CiAgICBleHRlbnQubWF4TGF0ID0gTWF0aC5tYXgoZXh0ZXJpb3JbaV1bX2NvbnN0YW50cy5MQVRfSU5ERVhdLCBleHRlbnQubWF4TGF0KTsKICB9CgogIHJldHVybiBjb252ZXJ0TWFwRXh0ZW50VG9Qb2x5Z29uKGV4dGVudCk7Cn0KCmZ1bmN0aW9uIGZvcm1hdEVudmVsb3BlQXNQb2x5Z29uKF9yZWYyKSB7CiAgdmFyIG1heExhdCA9IF9yZWYyLm1heExhdCwKICAgICAgbWF4TG9uID0gX3JlZjIubWF4TG9uLAogICAgICBtaW5MYXQgPSBfcmVmMi5taW5MYXQsCiAgICAgIG1pbkxvbiA9IF9yZWYyLm1pbkxvbjsKICAvLyBHZW9KU09OIG1hbmRhdGVzIHRoYXQgdGhlIG91dGVyIHBvbHlnb24gbXVzdCBiZSBjb3VudGVyY2xvY2t3aXNlIHRvIGF2b2lkIGFtYmlndW91cyBwb2x5Z29ucwogIC8vIHdoZW4gdGhlIHNoYXBlIGNyb3NzZXMgdGhlIGRhdGVsaW5lCiAgdmFyIGxlZnQgPSBtaW5Mb247CiAgdmFyIHJpZ2h0ID0gbWF4TG9uOwogIHZhciB0b3AgPSBtYXhMYXQgPiA5MCA/IDkwIDogbWF4TGF0OwogIHZhciBib3R0b20gPSBtaW5MYXQgPCAtOTAgPyAtOTAgOiBtaW5MYXQ7CiAgdmFyIHRvcExlZnQgPSBbbGVmdCwgdG9wXTsKICB2YXIgYm90dG9tTGVmdCA9IFtsZWZ0LCBib3R0b21dOwogIHZhciBib3R0b21SaWdodCA9IFtyaWdodCwgYm90dG9tXTsKICB2YXIgdG9wUmlnaHQgPSBbcmlnaHQsIHRvcF07CiAgcmV0dXJuIHsKICAgIHR5cGU6IF9jb25zdGFudHMuR0VPX0pTT05fVFlQRS5QT0xZR09OLAogICAgY29vcmRpbmF0ZXM6IFtbdG9wTGVmdCwgYm90dG9tTGVmdCwgYm90dG9tUmlnaHQsIHRvcFJpZ2h0LCB0b3BMZWZ0XV0KICB9Owp9Ci8qCiAqIENvbnZlcnQgbWFwIGJvdW5kcyB0byBwb2x5Z29uCiAqLwoKCmZ1bmN0aW9uIGNvbnZlcnRNYXBFeHRlbnRUb1BvbHlnb24oX3JlZjMpIHsKICB2YXIgbWF4TGF0ID0gX3JlZjMubWF4TGF0LAogICAgICBtYXhMb24gPSBfcmVmMy5tYXhMb24sCiAgICAgIG1pbkxhdCA9IF9yZWYzLm1pbkxhdCwKICAgICAgbWluTG9uID0gX3JlZjMubWluTG9uOwogIHZhciBsb25EZWx0YSA9IG1heExvbiAtIG1pbkxvbjsKCiAgaWYgKGxvbkRlbHRhID49IDM2MCkgewogICAgcmV0dXJuIGZvcm1hdEVudmVsb3BlQXNQb2x5Z29uKHsKICAgICAgbWF4TGF0OiBtYXhMYXQsCiAgICAgIG1heExvbjogMTgwLAogICAgICBtaW5MYXQ6IG1pbkxhdCwKICAgICAgbWluTG9uOiAtMTgwCiAgICB9KTsKICB9CgogIGlmIChtYXhMb24gPiAxODApIHsKICAgIC8vIGJvdW5kcyBjcm9zcyBkYXRlbGluZSBlYXN0IHRvIHdlc3QKICAgIHZhciBvdmVybGFwV2VzdE9mRGF0ZUxpbmUgPSBtYXhMb24gLSAxODA7CiAgICByZXR1cm4gZm9ybWF0RW52ZWxvcGVBc1BvbHlnb24oewogICAgICBtYXhMYXQ6IG1heExhdCwKICAgICAgbWF4TG9uOiAtMTgwICsgb3ZlcmxhcFdlc3RPZkRhdGVMaW5lLAogICAgICBtaW5MYXQ6IG1pbkxhdCwKICAgICAgbWluTG9uOiBtaW5Mb24KICAgIH0pOwogIH0KCiAgaWYgKG1pbkxvbiA8IC0xODApIHsKICAgIC8vIGJvdW5kcyBjcm9zcyBkYXRlbGluZSB3ZXN0IHRvIGVhc3QKICAgIHZhciBvdmVybGFwRWFzdE9mRGF0ZUxpbmUgPSBNYXRoLmFicyhtaW5Mb24pIC0gMTgwOwogICAgcmV0dXJuIGZvcm1hdEVudmVsb3BlQXNQb2x5Z29uKHsKICAgICAgbWF4TGF0OiBtYXhMYXQsCiAgICAgIG1heExvbjogbWF4TG9uLAogICAgICBtaW5MYXQ6IG1pbkxhdCwKICAgICAgbWluTG9uOiAxODAgLSBvdmVybGFwRWFzdE9mRGF0ZUxpbmUKICAgIH0pOwogIH0KCiAgcmV0dXJuIGZvcm1hdEVudmVsb3BlQXNQb2x5Z29uKHsKICAgIG1heExhdDogbWF4TGF0LAogICAgbWF4TG9uOiBtYXhMb24sCiAgICBtaW5MYXQ6IG1pbkxhdCwKICAgIG1pbkxvbjogbWluTG9uCiAgfSk7Cn0="},null]}