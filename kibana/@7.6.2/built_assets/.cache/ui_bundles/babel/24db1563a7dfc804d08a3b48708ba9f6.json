{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/legacy/core_plugins/kibana/public/visualize/np_ready/wizard/type_selection/type_selection.js","dependencies":[{"path":"src/legacy/core_plugins/kibana/public/visualize/np_ready/wizard/type_selection/type_selection.js","mtime":1585205039927},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiKSB7IF90eXBlb2YyID0gZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mMiA9IGZ1bmN0aW9uIF90eXBlb2YyKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mMihvYmopOyB9CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuVHlwZVNlbGVjdGlvbiA9IHZvaWQgMDsKCnZhciBfaTE4biA9IHJlcXVpcmUoIkBrYm4vaTE4biIpOwoKdmFyIF9yZWFjdCA9IHJlcXVpcmUoIkBrYm4vaTE4bi9yZWFjdCIpOwoKdmFyIF9sb2Rhc2ggPSByZXF1aXJlKCJsb2Rhc2giKTsKCnZhciBfcmVhY3QyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJyZWFjdCIpKTsKCnZhciBfZXVpID0gcmVxdWlyZSgiQGVsYXN0aWMvZXVpIik7Cgp2YXIgX21lbW9pemUgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi8uLi8uLi92aXN1YWxpemF0aW9ucy9wdWJsaWMvbnBfcmVhZHkvcHVibGljL2xlZ2FjeS9tZW1vaXplIik7Cgp2YXIgX25ld192aXNfaGVscCA9IHJlcXVpcmUoIi4vbmV3X3Zpc19oZWxwIik7Cgp2YXIgX3Zpc19oZWxwX3RleHQgPSByZXF1aXJlKCIuL3Zpc19oZWxwX3RleHQiKTsKCnZhciBfdmlzX3R5cGVfaWNvbiA9IHJlcXVpcmUoIi4vdmlzX3R5cGVfaWNvbiIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsKICByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogewogICAgZGVmYXVsdDogb2JqCiAgfTsKfQoKZnVuY3Rpb24gX3R5cGVvZihvYmopIHsKICBpZiAodHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBfdHlwZW9mMihTeW1ib2wuaXRlcmF0b3IpID09PSAic3ltYm9sIikgewogICAgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7CiAgICAgIHJldHVybiBfdHlwZW9mMihvYmopOwogICAgfTsKICB9IGVsc2UgewogICAgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7CiAgICAgIHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyAic3ltYm9sIiA6IF90eXBlb2YyKG9iaik7CiAgICB9OwogIH0KCiAgcmV0dXJuIF90eXBlb2Yob2JqKTsKfQoKZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7CiAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOwoKICBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgewogICAgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7CiAgICBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7CiAgICAgIHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOwogICAgfSk7CiAgICBrZXlzLnB1c2guYXBwbHkoa2V5cywgc3ltYm9scyk7CiAgfQoKICByZXR1cm4ga2V5czsKfQoKZnVuY3Rpb24gX29iamVjdFNwcmVhZCh0YXJnZXQpIHsKICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgewogICAgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXSAhPSBudWxsID8gYXJndW1lbnRzW2ldIDoge307CgogICAgaWYgKGkgJSAyKSB7CiAgICAgIG93bktleXMoc291cmNlLCB0cnVlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsKICAgICAgfSk7CiAgICB9IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKSB7CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoc291cmNlKSk7CiAgICB9IGVsc2UgewogICAgICBvd25LZXlzKHNvdXJjZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwga2V5KSk7CiAgICAgIH0pOwogICAgfQogIH0KCiAgcmV0dXJuIHRhcmdldDsKfQoKZnVuY3Rpb24gX3RvQ29uc3VtYWJsZUFycmF5KGFycikgewogIHJldHVybiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5KGFycikgfHwgX25vbkl0ZXJhYmxlU3ByZWFkKCk7Cn0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVNwcmVhZCgpIHsKICB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gc3ByZWFkIG5vbi1pdGVyYWJsZSBpbnN0YW5jZSIpOwp9CgpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5KGl0ZXIpIHsKICBpZiAoU3ltYm9sLml0ZXJhdG9yIGluIE9iamVjdChpdGVyKSB8fCBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoaXRlcikgPT09ICJbb2JqZWN0IEFyZ3VtZW50c10iKSByZXR1cm4gQXJyYXkuZnJvbShpdGVyKTsKfQoKZnVuY3Rpb24gX2FycmF5V2l0aG91dEhvbGVzKGFycikgewogIGlmIChBcnJheS5pc0FycmF5KGFycikpIHsKICAgIGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGFyci5sZW5ndGgpOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7CiAgICAgIGFycjJbaV0gPSBhcnJbaV07CiAgICB9CgogICAgcmV0dXJuIGFycjI7CiAgfQp9CgpmdW5jdGlvbiBfZXh0ZW5kcygpIHsKICBfZXh0ZW5kcyA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gKHRhcmdldCkgewogICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsKICAgICAgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXTsKCiAgICAgIGZvciAodmFyIGtleSBpbiBzb3VyY2UpIHsKICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSwga2V5KSkgewogICAgICAgICAgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gdGFyZ2V0OwogIH07CgogIHJldHVybiBfZXh0ZW5kcy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7CiAgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOwogIH0KfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgewogIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsKICAgIHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07CiAgICBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7CiAgICBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7CiAgICBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsKICB9Cn0KCmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsKICBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsKICBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7CiAgcmV0dXJuIENvbnN0cnVjdG9yOwp9CgpmdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7CiAgaWYgKGNhbGwgJiYgKF90eXBlb2YoY2FsbCkgPT09ICJvYmplY3QiIHx8IHR5cGVvZiBjYWxsID09PSAiZnVuY3Rpb24iKSkgewogICAgcmV0dXJuIGNhbGw7CiAgfQoKICByZXR1cm4gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKTsKfQoKZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsKICBfZ2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3QuZ2V0UHJvdG90eXBlT2YgOiBmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgewogICAgcmV0dXJuIG8uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihvKTsKICB9OwogIHJldHVybiBfZ2V0UHJvdG90eXBlT2Yobyk7Cn0KCmZ1bmN0aW9uIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZikgewogIGlmIChzZWxmID09PSB2b2lkIDApIHsKICAgIHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcigidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkIik7CiAgfQoKICByZXR1cm4gc2VsZjsKfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7CiAgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAiZnVuY3Rpb24iICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uIik7CiAgfQoKICBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsKICAgIGNvbnN0cnVjdG9yOiB7CiAgICAgIHZhbHVlOiBzdWJDbGFzcywKICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZQogICAgfQogIH0pOwogIGlmIChzdXBlckNsYXNzKSBfc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpOwp9CgpmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgewogIF9zZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgewogICAgby5fX3Byb3RvX18gPSBwOwogICAgcmV0dXJuIG87CiAgfTsKCiAgcmV0dXJuIF9zZXRQcm90b3R5cGVPZihvLCBwKTsKfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgewogIGlmIChrZXkgaW4gb2JqKSB7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsKICAgICAgdmFsdWU6IHZhbHVlLAogICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgIHdyaXRhYmxlOiB0cnVlCiAgICB9KTsKICB9IGVsc2UgewogICAgb2JqW2tleV0gPSB2YWx1ZTsKICB9CgogIHJldHVybiBvYmo7Cn0KCnZhciBUeXBlU2VsZWN0aW9uID0KLyojX19QVVJFX18qLwpmdW5jdGlvbiAoX1JlYWN0JENvbXBvbmVudCkgewogIF9pbmhlcml0cyhUeXBlU2VsZWN0aW9uLCBfUmVhY3QkQ29tcG9uZW50KTsKCiAgZnVuY3Rpb24gVHlwZVNlbGVjdGlvbigpIHsKICAgIHZhciBfZ2V0UHJvdG90eXBlT2YyOwoKICAgIHZhciBfdGhpczsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVHlwZVNlbGVjdGlvbik7CgogICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbiksIF9rZXkgPSAwOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7CiAgICAgIGFyZ3NbX2tleV0gPSBhcmd1bWVudHNbX2tleV07CiAgICB9CgogICAgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoX2dldFByb3RvdHlwZU9mMiA9IF9nZXRQcm90b3R5cGVPZihUeXBlU2VsZWN0aW9uKSkuY2FsbC5hcHBseShfZ2V0UHJvdG90eXBlT2YyLCBbdGhpc10uY29uY2F0KGFyZ3MpKSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAic3RhdGUiLCB7CiAgICAgIGhpZ2hsaWdodGVkVHlwZTogbnVsbCwKICAgICAgcXVlcnk6ICcnCiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJnZXRGaWx0ZXJlZFZpc1R5cGVzIiwgKDAsIF9tZW1vaXplLm1lbW9pemVMYXN0KShfdGhpcy5maWx0ZXJlZFZpc1R5cGVzKSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAicmVuZGVyVmlzVHlwZSIsIGZ1bmN0aW9uICh2aXNUeXBlKSB7CiAgICAgIHZhciBzdGFnZSA9IHt9OwogICAgICB2YXIgaGlnaGxpZ2h0TXNnOwoKICAgICAgaWYgKCEoJ2FsaWFzVXJsJyBpbiB2aXNUeXBlKSAmJiB2aXNUeXBlLnN0YWdlID09PSAnZXhwZXJpbWVudGFsJykgewogICAgICAgIHN0YWdlID0gewogICAgICAgICAgYmV0YUJhZGdlTGFiZWw6IF9pMThuLmkxOG4udHJhbnNsYXRlKCdrYm4udmlzdWFsaXplLm5ld1Zpc1dpemFyZC5leHBlcmltZW50YWxUaXRsZScsIHsKICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdFeHBlcmltZW50YWwnCiAgICAgICAgICB9KSwKICAgICAgICAgIGJldGFCYWRnZVRvb2x0aXBDb250ZW50OiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgna2JuLnZpc3VhbGl6ZS5uZXdWaXNXaXphcmQuZXhwZXJpbWVudGFsVG9vbHRpcCcsIHsKICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdUaGlzIHZpc3VhbGl6YXRpb24gbWlnaHQgYmUgY2hhbmdlZCBvciByZW1vdmVkIGluIGEgZnV0dXJlIHJlbGVhc2UgYW5kIGlzIG5vdCBzdWJqZWN0IHRvIHRoZSBzdXBwb3J0IFNMQS4nCiAgICAgICAgICB9KQogICAgICAgIH07CiAgICAgICAgaGlnaGxpZ2h0TXNnID0gX2kxOG4uaTE4bi50cmFuc2xhdGUoJ2tibi52aXN1YWxpemUubmV3VmlzV2l6YXJkLmV4cGVyaW1lbnRhbERlc2NyaXB0aW9uJywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdUaGlzIHZpc3VhbGl6YXRpb24gaXMgZXhwZXJpbWVudGFsLiBUaGUgZGVzaWduIGFuZCBpbXBsZW1lbnRhdGlvbiBhcmUgbGVzcyBtYXR1cmUgdGhhbiBzdGFibGUgdmlzdWFsaXphdGlvbnMgYW5kIG1pZ2h0IGJlIHN1YmplY3QgdG8gY2hhbmdlLicKICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmICgnYWxpYXNVcmwnIGluIHZpc1R5cGUpIHsKICAgICAgICBpZiAodmlzVHlwZS5zdGFnZSA9PT0gJ2JldGEnKSB7CiAgICAgICAgICB2YXIgYWxpYXNEZXNjcmlwdGlvbiA9IF9pMThuLmkxOG4udHJhbnNsYXRlKCdrYm4udmlzdWFsaXplLm5ld1Zpc1dpemFyZC5iZXRhRGVzY3JpcHRpb24nLCB7CiAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnVGhpcyB2aXN1YWxpemF0aW9uIGlzIGluIGJldGEgYW5kIGlzIHN1YmplY3QgdG8gY2hhbmdlLiBUaGUgZGVzaWduIGFuZCBjb2RlIGlzIGxlc3MgbWF0dXJlIHRoYW4gb2ZmaWNpYWwgR0EgZmVhdHVyZXMgYW5kIGlzIGJlaW5nIHByb3ZpZGVkIGFzLWlzIHdpdGggbm8gd2FycmFudGllcy4gQmV0YSBmZWF0dXJlcyBhcmUgbm90IHN1YmplY3QgdG8gdGhlIHN1cHBvcnQgU0xBIG9mIG9mZmljaWFsIEdBIGZlYXR1cmVzJwogICAgICAgICAgfSk7CgogICAgICAgICAgc3RhZ2UgPSB7CiAgICAgICAgICAgIGJldGFCYWRnZUxhYmVsOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgna2JuLnZpc3VhbGl6ZS5uZXdWaXNXaXphcmQuYmV0YVRpdGxlJywgewogICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnQmV0YScKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIGJldGFCYWRnZVRvb2x0aXBDb250ZW50OiBhbGlhc0Rlc2NyaXB0aW9uIC8vIGJldGFCYWRnZUljb25UeXBlOiAncG9wb3V0JywKCiAgICAgICAgICB9OwogICAgICAgICAgaGlnaGxpZ2h0TXNnID0gYWxpYXNEZXNjcmlwdGlvbjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdmFyIF9hbGlhc0Rlc2NyaXB0aW9uID0gX2kxOG4uaTE4bi50cmFuc2xhdGUoJ2tibi52aXN1YWxpemUubmV3VmlzV2l6YXJkLnZpc1R5cGVBbGlhc0Rlc2NyaXB0aW9uJywgewogICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ09wZW5zIGEgS2liYW5hIGFwcGxpY2F0aW9uIHRoYXQgaXMgb3V0c2lkZSBvZiBWaXN1YWxpemUuJwogICAgICAgICAgfSk7CgogICAgICAgICAgc3RhZ2UgPSB7CiAgICAgICAgICAgIGJldGFCYWRnZUxhYmVsOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgna2JuLnZpc3VhbGl6ZS5uZXdWaXNXaXphcmQudmlzVHlwZUFsaWFzVGl0bGUnLCB7CiAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdLaWJhbmEgYXBwbGljYXRpb24nCiAgICAgICAgICAgIH0pLAogICAgICAgICAgICBiZXRhQmFkZ2VUb29sdGlwQ29udGVudDogX2FsaWFzRGVzY3JpcHRpb24sCiAgICAgICAgICAgIGJldGFCYWRnZUljb25UeXBlOiAncG9wb3V0JwogICAgICAgICAgfTsKICAgICAgICAgIGhpZ2hsaWdodE1zZyA9IF9hbGlhc0Rlc2NyaXB0aW9uOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdmFyIGlzRGlzYWJsZWQgPSBfdGhpcy5zdGF0ZS5xdWVyeSAhPT0gJycgJiYgIXZpc1R5cGUuaGlnaGxpZ2h0ZWQ7CgogICAgICB2YXIgb25DbGljayA9IGZ1bmN0aW9uIG9uQ2xpY2soKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLnByb3BzLm9uVmlzVHlwZVNlbGVjdGVkKHZpc1R5cGUpOwogICAgICB9OwoKICAgICAgdmFyIGhpZ2hsaWdodGVkVHlwZSA9IHsKICAgICAgICB0aXRsZTogdmlzVHlwZS50aXRsZSwKICAgICAgICBuYW1lOiB2aXNUeXBlLm5hbWUsCiAgICAgICAgZGVzY3JpcHRpb246IHZpc1R5cGUuZGVzY3JpcHRpb24sCiAgICAgICAgaGlnaGxpZ2h0TXNnOiBoaWdobGlnaHRNc2cKICAgICAgfTsKICAgICAgcmV0dXJuIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpS2V5UGFkTWVudUl0ZW1CdXR0b24sIF9leHRlbmRzKHsKICAgICAgICBrZXk6IHZpc1R5cGUubmFtZSwKICAgICAgICBsYWJlbDogX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCB7CiAgICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiAidmlzVHlwZVRpdGxlIgogICAgICAgIH0sIHZpc1R5cGUudGl0bGUpLAogICAgICAgIG9uQ2xpY2s6IG9uQ2xpY2ssCiAgICAgICAgb25Gb2N1czogZnVuY3Rpb24gb25Gb2N1cygpIHsKICAgICAgICAgIHJldHVybiBfdGhpcy5zZXRIaWdobGlnaHRUeXBlKGhpZ2hsaWdodGVkVHlwZSk7CiAgICAgICAgfSwKICAgICAgICBvbk1vdXNlRW50ZXI6IGZ1bmN0aW9uIG9uTW91c2VFbnRlcigpIHsKICAgICAgICAgIHJldHVybiBfdGhpcy5zZXRIaWdobGlnaHRUeXBlKGhpZ2hsaWdodGVkVHlwZSk7CiAgICAgICAgfSwKICAgICAgICBvbk1vdXNlTGVhdmU6IGZ1bmN0aW9uIG9uTW91c2VMZWF2ZSgpIHsKICAgICAgICAgIHJldHVybiBfdGhpcy5zZXRIaWdobGlnaHRUeXBlKG51bGwpOwogICAgICAgIH0sCiAgICAgICAgb25CbHVyOiBmdW5jdGlvbiBvbkJsdXIoKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXMuc2V0SGlnaGxpZ2h0VHlwZShudWxsKTsKICAgICAgICB9LAogICAgICAgIGNsYXNzTmFtZTogInZpc05ld1Zpc0RpYWxvZ19fdHlwZSIsCiAgICAgICAgImRhdGEtdGVzdC1zdWJqIjogInZpc1R5cGUtIi5jb25jYXQodmlzVHlwZS5uYW1lKSwKICAgICAgICAiZGF0YS12aXMtc3RhZ2UiOiAhKCdhbGlhc1VybCcgaW4gdmlzVHlwZSkgPyB2aXNUeXBlLnN0YWdlIDogJ2FsaWFzJywKICAgICAgICBkaXNhYmxlZDogaXNEaXNhYmxlZCwKICAgICAgICAiYXJpYS1kZXNjcmliZWRieSI6ICJ2aXNUeXBlRGVzY3JpcHRpb24tIi5jb25jYXQodmlzVHlwZS5uYW1lKSwKICAgICAgICByb2xlOiAibWVudWl0ZW0iCiAgICAgIH0sIHN0YWdlKSwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3Zpc190eXBlX2ljb24uVmlzVHlwZUljb24sIHsKICAgICAgICBpY29uOiB2aXNUeXBlLmljb24sCiAgICAgICAgaW1hZ2U6ICEoJ2FsaWFzVXJsJyBpbiB2aXNUeXBlKSA/IHZpc1R5cGUuaW1hZ2UgOiB1bmRlZmluZWQKICAgICAgfSkpOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAib25RdWVyeUNoYW5nZSIsIGZ1bmN0aW9uIChldikgewogICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgcXVlcnk6IGV2LnRhcmdldC52YWx1ZQogICAgICB9KTsKICAgIH0pOwoKICAgIHJldHVybiBfdGhpczsKICB9CgogIF9jcmVhdGVDbGFzcyhUeXBlU2VsZWN0aW9uLCBbewogICAga2V5OiAicmVuZGVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7CiAgICAgIHZhciBfdGhpcyRzdGF0ZSA9IHRoaXMuc3RhdGUsCiAgICAgICAgICBxdWVyeSA9IF90aGlzJHN0YXRlLnF1ZXJ5LAogICAgICAgICAgaGlnaGxpZ2h0ZWRUeXBlID0gX3RoaXMkc3RhdGUuaGlnaGxpZ2h0ZWRUeXBlOwogICAgICB2YXIgdmlzVHlwZXMgPSB0aGlzLmdldEZpbHRlcmVkVmlzVHlwZXModGhpcy5wcm9wcy52aXNUeXBlc1JlZ2lzdHJ5LCBxdWVyeSk7CiAgICAgIHJldHVybiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLmRlZmF1bHQuRnJhZ21lbnQsIG51bGwsIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpTW9kYWxIZWFkZXIsIG51bGwsIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpTW9kYWxIZWFkZXJUaXRsZSwgbnVsbCwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogImtibi52aXN1YWxpemUubmV3VmlzV2l6YXJkLnRpdGxlIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIk5ldyBWaXN1YWxpemF0aW9uIgogICAgICB9KSkpLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgIGNsYXNzTmFtZTogInZpc05ld1Zpc0RpYWxvZ19fYm9keSIKICAgICAgfSwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4R3JvdXAsIHsKICAgICAgICBndXR0ZXJTaXplOiAieGwiCiAgICAgIH0sIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIG51bGwsIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEdyb3VwLCB7CiAgICAgICAgY2xhc3NOYW1lOiAidmlzTmV3VmlzRGlhbG9nX19saXN0IiwKICAgICAgICBkaXJlY3Rpb246ICJjb2x1bW4iLAogICAgICAgIGd1dHRlclNpemU6ICJub25lIiwKICAgICAgICByZXNwb25zaXZlOiBmYWxzZQogICAgICB9LCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICAgICAgZ3JvdzogZmFsc2UsCiAgICAgICAgY2xhc3NOYW1lOiAidmlzTmV3VmlzRGlhbG9nX19zZWFyY2hXcmFwcGVyIgogICAgICB9LCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZpZWxkU2VhcmNoLCB7CiAgICAgICAgcGxhY2Vob2xkZXI6ICJGaWx0ZXIiLAogICAgICAgIHZhbHVlOiBxdWVyeSwKICAgICAgICBvbkNoYW5nZTogdGhpcy5vblF1ZXJ5Q2hhbmdlLAogICAgICAgIGZ1bGxXaWR0aDogdHJ1ZSwKICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiAiZmlsdGVyVmlzVHlwZSIsCiAgICAgICAgImFyaWEtbGFiZWwiOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgna2JuLnZpc3VhbGl6ZS5uZXdWaXNXaXphcmQuZmlsdGVyVmlzVHlwZUFyaWFMYWJlbCcsIHsKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnRmlsdGVyIGZvciBhIHZpc3VhbGl6YXRpb24gdHlwZScKICAgICAgICB9KQogICAgICB9KSksIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgICAgICBncm93OiAxLAogICAgICAgIGNsYXNzTmFtZTogInZpc05ld1Zpc0RpYWxvZ19fdHlwZXNXcmFwcGVyIgogICAgICB9LCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNjcmVlblJlYWRlck9ubHksIG51bGwsIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgewogICAgICAgICJhcmlhLWxpdmUiOiAicG9saXRlIgogICAgICB9LCBxdWVyeSAmJiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAia2JuLnZpc3VhbGl6ZS5uZXdWaXNXaXphcmQucmVzdWx0c0ZvdW5kIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIntyZXN1bHRDb3VudH0ge3Jlc3VsdENvdW50LCBwbHVyYWwsIG9uZSB7dHlwZX0gb3RoZXIge3R5cGVzfSB9IGZvdW5kIiwKICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgIHJlc3VsdENvdW50OiB2aXNUeXBlcy5maWx0ZXIoZnVuY3Rpb24gKHR5cGUpIHsKICAgICAgICAgICAgcmV0dXJuIHR5cGUuaGlnaGxpZ2h0ZWQ7CiAgICAgICAgICB9KS5sZW5ndGgKICAgICAgICB9CiAgICAgIH0pKSksIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpS2V5UGFkTWVudSwgewogICAgICAgIGNsYXNzTmFtZTogInZpc05ld1Zpc0RpYWxvZ19fdHlwZXMiLAogICAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJ2aXNOZXdEaWFsb2dUeXBlcyIKICAgICAgfSwgdmlzVHlwZXMubWFwKHRoaXMucmVuZGVyVmlzVHlwZSkpKSkpLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICAgICAgY2xhc3NOYW1lOiAidmlzTmV3VmlzRGlhbG9nX19kZXNjcmlwdGlvbiIsCiAgICAgICAgZ3JvdzogZmFsc2UKICAgICAgfSwgaGlnaGxpZ2h0ZWRUeXBlID8gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3Zpc19oZWxwX3RleHQuVmlzSGVscFRleHQsIGhpZ2hsaWdodGVkVHlwZSkgOiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLmRlZmF1bHQuRnJhZ21lbnQsIG51bGwsIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVGl0bGUsIHsKICAgICAgICBzaXplOiAicyIKICAgICAgfSwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImgyIiwgbnVsbCwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogImtibi52aXN1YWxpemUubmV3VmlzV2l6YXJkLnNlbGVjdFZpc1R5cGUiLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiU2VsZWN0IGEgdmlzdWFsaXphdGlvbiB0eXBlIgogICAgICB9KSkpLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgewogICAgICAgIHNpemU6ICJtIgogICAgICB9KSwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX25ld192aXNfaGVscC5OZXdWaXNIZWxwLCB7CiAgICAgICAgcHJvbW90ZWRUeXBlczogdmlzVHlwZXMuZmlsdGVyKGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICByZXR1cm4gdC5wcm9tb3Rpb247CiAgICAgICAgfSksCiAgICAgICAgb25Qcm9tb3Rpb25DbGlja2VkOiB0aGlzLnByb3BzLm9uVmlzVHlwZVNlbGVjdGVkCiAgICAgIH0pKSkpKSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZmlsdGVyZWRWaXNUeXBlcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZmlsdGVyZWRWaXNUeXBlcyh2aXNUeXBlcywgcXVlcnkpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB2YXIgdHlwZXMgPSB2aXNUeXBlcy5hbGwoKS5maWx0ZXIoZnVuY3Rpb24gKHR5cGUpIHsKICAgICAgICAvLyBGaWx0ZXIgb3V0IGFsbCBsYWIgdmlzdWFsaXphdGlvbnMgaWYgbGFiIG1vZGUgaXMgbm90IGVuYWJsZWQKICAgICAgICBpZiAoIV90aGlzMi5wcm9wcy5zaG93RXhwZXJpbWVudGFsICYmIHR5cGUuc3RhZ2UgPT09ICdleHBlcmltZW50YWwnKSB7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSAvLyBGaWx0ZXIgb3V0IGhpZGRlbiB2aXN1YWxpemF0aW9ucwoKCiAgICAgICAgaWYgKHR5cGUuaGlkZGVuKSB7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfSk7CiAgICAgIHZhciBhbGxUeXBlcyA9IFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkodHlwZXMpLCBfdG9Db25zdW1hYmxlQXJyYXkodmlzVHlwZXMuZ2V0QWxpYXNlcygpKSk7CiAgICAgIHZhciBlbnRyaWVzOwoKICAgICAgaWYgKCFxdWVyeSkgewogICAgICAgIGVudHJpZXMgPSBhbGxUeXBlcy5tYXAoZnVuY3Rpb24gKHR5cGUpIHsKICAgICAgICAgIHJldHVybiBfb2JqZWN0U3ByZWFkKHt9LCB0eXBlLCB7CiAgICAgICAgICAgIGhpZ2hsaWdodGVkOiBmYWxzZQogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFyIHEgPSBxdWVyeS50b0xvd2VyQ2FzZSgpOwogICAgICAgIGVudHJpZXMgPSBhbGxUeXBlcy5tYXAoZnVuY3Rpb24gKHR5cGUpIHsKICAgICAgICAgIHZhciBtYXRjaGVzUXVlcnkgPSB0eXBlLm5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxKSB8fCB0eXBlLnRpdGxlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMocSkgfHwgdHlwZW9mIHR5cGUuZGVzY3JpcHRpb24gPT09ICdzdHJpbmcnICYmIHR5cGUuZGVzY3JpcHRpb24udG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxKTsKICAgICAgICAgIHJldHVybiBfb2JqZWN0U3ByZWFkKHt9LCB0eXBlLCB7CiAgICAgICAgICAgIGhpZ2hsaWdodGVkOiBtYXRjaGVzUXVlcnkKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9CgogICAgICByZXR1cm4gKDAsIF9sb2Rhc2guc29ydEJ5T3JkZXIpKGVudHJpZXMsIFsnaGlnaGxpZ2h0ZWQnLCAncHJvbW90aW9uJywgJ3RpdGxlJ10sIFsnZGVzYycsICdhc2MnLCAnYXNjJ10pOwogICAgfQogIH0sIHsKICAgIGtleTogInNldEhpZ2hsaWdodFR5cGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldEhpZ2hsaWdodFR5cGUoaGlnaGxpZ2h0ZWRUeXBlKSB7CiAgICAgIHRoaXMuc2V0U3RhdGUoewogICAgICAgIGhpZ2hsaWdodGVkVHlwZTogaGlnaGxpZ2h0ZWRUeXBlCiAgICAgIH0pOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIFR5cGVTZWxlY3Rpb247Cn0oX3JlYWN0Mi5kZWZhdWx0LkNvbXBvbmVudCk7CgpleHBvcnRzLlR5cGVTZWxlY3Rpb24gPSBUeXBlU2VsZWN0aW9uOw=="},null]}