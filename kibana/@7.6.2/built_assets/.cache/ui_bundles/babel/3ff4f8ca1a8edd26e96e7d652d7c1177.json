{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/siem/public/containers/detection_engine/rules/use_pre_packaged_rules.js","dependencies":[{"path":"x-pack/legacy/plugins/siem/public/containers/detection_engine/rules/use_pre_packaged_rules.js","mtime":1585205047779},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLnVzZVByZVBhY2thZ2VkUnVsZXMgPSB2b2lkIDA7Cgp2YXIgX3JlYWN0ID0gcmVxdWlyZSgicmVhY3QiKTsKCnZhciBfdG9hc3RlcnMgPSByZXF1aXJlKCIuLi8uLi8uLi9jb21wb25lbnRzL3RvYXN0ZXJzIik7Cgp2YXIgX2Vycm9yX3RvX3RvYXN0ZXIgPSByZXF1aXJlKCIuLi8uLi8uLi9jb21wb25lbnRzL21sL2FwaS9lcnJvcl90b190b2FzdGVyIik7Cgp2YXIgX2FwaSA9IHJlcXVpcmUoIi4vYXBpIik7Cgp2YXIgaTE4biA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoIi4vdHJhbnNsYXRpb25zIikpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7CiAgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgewogICAgcmV0dXJuIG9iajsKICB9IGVsc2UgewogICAgdmFyIG5ld09iaiA9IHt9OwoKICAgIGlmIChvYmogIT0gbnVsbCkgewogICAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7CiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHsKICAgICAgICAgIHZhciBkZXNjID0gT2JqZWN0LmRlZmluZVByb3BlcnR5ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KSA6IHt9OwoKICAgICAgICAgIGlmIChkZXNjLmdldCB8fCBkZXNjLnNldCkgewogICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobmV3T2JqLCBrZXksIGRlc2MpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBuZXdPYmouZGVmYXVsdCA9IG9iajsKICAgIHJldHVybiBuZXdPYmo7CiAgfQp9CgpmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsKICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7CgogIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7CiAgICB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsKICAgIGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsKICAgICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7CiAgICB9KTsKICAgIGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsKICB9CgogIHJldHVybiBrZXlzOwp9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgewogIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsKCiAgICBpZiAoaSAlIDIpIHsKICAgICAgb3duS2V5cyhzb3VyY2UsIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOwogICAgICB9KTsKICAgIH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsKICAgIH0gZWxzZSB7CiAgICAgIG93bktleXMoc291cmNlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsKICAgICAgfSk7CiAgICB9CiAgfQoKICByZXR1cm4gdGFyZ2V0Owp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7CiAgaWYgKGtleSBpbiBvYmopIHsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgICB2YWx1ZTogdmFsdWUsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgd3JpdGFibGU6IHRydWUKICAgIH0pOwogIH0gZWxzZSB7CiAgICBvYmpba2V5XSA9IHZhbHVlOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7CiAgcmV0dXJuIF9hcnJheVdpdGhIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHx8IF9ub25JdGVyYWJsZVJlc3QoKTsKfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlUmVzdCgpIHsKICB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7Cn0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHsKICB2YXIgX2FyciA9IFtdOwogIHZhciBfbiA9IHRydWU7CiAgdmFyIF9kID0gZmFsc2U7CiAgdmFyIF9lID0gdW5kZWZpbmVkOwoKICB0cnkgewogICAgZm9yICh2YXIgX2kgPSBhcnJbU3ltYm9sLml0ZXJhdG9yXSgpLCBfczsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSkgewogICAgICBfYXJyLnB1c2goX3MudmFsdWUpOwoKICAgICAgaWYgKGkgJiYgX2Fyci5sZW5ndGggPT09IGkpIGJyZWFrOwogICAgfQogIH0gY2F0Y2ggKGVycikgewogICAgX2QgPSB0cnVlOwogICAgX2UgPSBlcnI7CiAgfSBmaW5hbGx5IHsKICAgIHRyeSB7CiAgICAgIGlmICghX24gJiYgX2lbInJldHVybiJdICE9IG51bGwpIF9pWyJyZXR1cm4iXSgpOwogICAgfSBmaW5hbGx5IHsKICAgICAgaWYgKF9kKSB0aHJvdyBfZTsKICAgIH0KICB9CgogIHJldHVybiBfYXJyOwp9CgpmdW5jdGlvbiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsKfQovKioKICogSG9vayBmb3IgdXNpbmcgdG8gZ2V0IHN0YXR1cyBhYm91dCBwcmUtcGFja2FnZWQgUnVsZXMgZnJvbSB0aGUgRGV0ZWN0aW9uIEVuZ2luZSBBUEkKICoKICogQHBhcmFtIGhhc0luZGV4V3JpdGUgYm9vbGVhbgogKiBAcGFyYW0gaGFzTWFuYWdlQXBpS2V5IGJvb2xlYW4KICogQHBhcmFtIGlzQXV0aGVudGljYXRlZCBib29sZWFuCiAqIEBwYXJhbSBoYXNFbmNyeXB0aW9uS2V5IGJvb2xlYW4KICogQHBhcmFtIGlzU2lnbmFsSW5kZXhFeGlzdHMgYm9vbGVhbgogKgogKi8KCgp2YXIgdXNlUHJlUGFja2FnZWRSdWxlcyA9IGZ1bmN0aW9uIHVzZVByZVBhY2thZ2VkUnVsZXMoX3JlZikgewogIHZhciBjYW5Vc2VyQ1JVRCA9IF9yZWYuY2FuVXNlckNSVUQsCiAgICAgIGhhc0luZGV4V3JpdGUgPSBfcmVmLmhhc0luZGV4V3JpdGUsCiAgICAgIGhhc01hbmFnZUFwaUtleSA9IF9yZWYuaGFzTWFuYWdlQXBpS2V5LAogICAgICBpc0F1dGhlbnRpY2F0ZWQgPSBfcmVmLmlzQXV0aGVudGljYXRlZCwKICAgICAgaGFzRW5jcnlwdGlvbktleSA9IF9yZWYuaGFzRW5jcnlwdGlvbktleSwKICAgICAgaXNTaWduYWxJbmRleEV4aXN0cyA9IF9yZWYuaXNTaWduYWxJbmRleEV4aXN0czsKCiAgdmFyIF91c2VTdGF0ZSA9ICgwLCBfcmVhY3QudXNlU3RhdGUpKHsKICAgIGNyZWF0ZVByZVBhY2thZ2VkUnVsZXM6IG51bGwsCiAgICByZWZldGNoUHJlUGFja2FnZWRSdWxlc1N0YXR1czogbnVsbCwKICAgIHJ1bGVzQ3VzdG9tSW5zdGFsbGVkOiBudWxsLAogICAgcnVsZXNJbnN0YWxsZWQ6IG51bGwsCiAgICBydWxlc05vdEluc3RhbGxlZDogbnVsbCwKICAgIHJ1bGVzTm90VXBkYXRlZDogbnVsbAogIH0pLAogICAgICBfdXNlU3RhdGUyID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlLCAyKSwKICAgICAgcnVsZXNTdGF0dXMgPSBfdXNlU3RhdGUyWzBdLAogICAgICBzZXRSdWxlU3RhdHVzID0gX3VzZVN0YXRlMlsxXTsKCiAgdmFyIF91c2VTdGF0ZTMgPSAoMCwgX3JlYWN0LnVzZVN0YXRlKShmYWxzZSksCiAgICAgIF91c2VTdGF0ZTQgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUzLCAyKSwKICAgICAgbG9hZGluZ0NyZWF0ZVByZVBhY2thZ2VkUnVsZXMgPSBfdXNlU3RhdGU0WzBdLAogICAgICBzZXRMb2FkaW5nQ3JlYXRlUHJlUGFja2FnZWRSdWxlcyA9IF91c2VTdGF0ZTRbMV07CgogIHZhciBfdXNlU3RhdGU1ID0gKDAsIF9yZWFjdC51c2VTdGF0ZSkodHJ1ZSksCiAgICAgIF91c2VTdGF0ZTYgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGU1LCAyKSwKICAgICAgbG9hZGluZyA9IF91c2VTdGF0ZTZbMF0sCiAgICAgIHNldExvYWRpbmcgPSBfdXNlU3RhdGU2WzFdOwoKICB2YXIgX3VzZVN0YXRlVG9hc3RlciA9ICgwLCBfdG9hc3RlcnMudXNlU3RhdGVUb2FzdGVyKSgpLAogICAgICBfdXNlU3RhdGVUb2FzdGVyMiA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZVRvYXN0ZXIsIDIpLAogICAgICBkaXNwYXRjaFRvYXN0ZXIgPSBfdXNlU3RhdGVUb2FzdGVyMlsxXTsKCiAgKDAsIF9yZWFjdC51c2VFZmZlY3QpKGZ1bmN0aW9uICgpIHsKICAgIHZhciBpc1N1YnNjcmliZWQgPSB0cnVlOwogICAgdmFyIGFib3J0Q3RybCA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTsKCiAgICB2YXIgZmV0Y2hQcmVQYWNrYWdlZFJ1bGVzID0gZnVuY3Rpb24gZmV0Y2hQcmVQYWNrYWdlZFJ1bGVzKCkgewogICAgICB2YXIgcHJlUGFja2FnZWRSdWxlU3RhdHVzUmVzcG9uc2U7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXN5bmMoZnVuY3Rpb24gZmV0Y2hQcmVQYWNrYWdlZFJ1bGVzJChfY29udGV4dCkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMDsKICAgICAgICAgICAgICBzZXRMb2FkaW5nKHRydWUpOwogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA0OwogICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAoKDAsIF9hcGkuZ2V0UHJlUGFja2FnZWRSdWxlc1N0YXR1cykoewogICAgICAgICAgICAgICAgc2lnbmFsOiBhYm9ydEN0cmwuc2lnbmFsCiAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIHByZVBhY2thZ2VkUnVsZVN0YXR1c1Jlc3BvbnNlID0gX2NvbnRleHQuc2VudDsKCiAgICAgICAgICAgICAgaWYgKGlzU3Vic2NyaWJlZCkgewogICAgICAgICAgICAgICAgc2V0UnVsZVN0YXR1cyh7CiAgICAgICAgICAgICAgICAgIGNyZWF0ZVByZVBhY2thZ2VkUnVsZXM6IGNyZWF0ZUVsYXN0aWNSdWxlcywKICAgICAgICAgICAgICAgICAgcmVmZXRjaFByZVBhY2thZ2VkUnVsZXNTdGF0dXM6IGZldGNoUHJlUGFja2FnZWRSdWxlcywKICAgICAgICAgICAgICAgICAgcnVsZXNDdXN0b21JbnN0YWxsZWQ6IHByZVBhY2thZ2VkUnVsZVN0YXR1c1Jlc3BvbnNlLnJ1bGVzX2N1c3RvbV9pbnN0YWxsZWQsCiAgICAgICAgICAgICAgICAgIHJ1bGVzSW5zdGFsbGVkOiBwcmVQYWNrYWdlZFJ1bGVTdGF0dXNSZXNwb25zZS5ydWxlc19pbnN0YWxsZWQsCiAgICAgICAgICAgICAgICAgIHJ1bGVzTm90SW5zdGFsbGVkOiBwcmVQYWNrYWdlZFJ1bGVTdGF0dXNSZXNwb25zZS5ydWxlc19ub3RfaW5zdGFsbGVkLAogICAgICAgICAgICAgICAgICBydWxlc05vdFVwZGF0ZWQ6IHByZVBhY2thZ2VkUnVsZVN0YXR1c1Jlc3BvbnNlLnJ1bGVzX25vdF91cGRhdGVkCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gODsKICAgICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDApOwoKICAgICAgICAgICAgICBpZiAoaXNTdWJzY3JpYmVkKSB7CiAgICAgICAgICAgICAgICBzZXRSdWxlU3RhdHVzKHsKICAgICAgICAgICAgICAgICAgY3JlYXRlUHJlUGFja2FnZWRSdWxlczogbnVsbCwKICAgICAgICAgICAgICAgICAgcmVmZXRjaFByZVBhY2thZ2VkUnVsZXNTdGF0dXM6IG51bGwsCiAgICAgICAgICAgICAgICAgIHJ1bGVzQ3VzdG9tSW5zdGFsbGVkOiBudWxsLAogICAgICAgICAgICAgICAgICBydWxlc0luc3RhbGxlZDogbnVsbCwKICAgICAgICAgICAgICAgICAgcnVsZXNOb3RJbnN0YWxsZWQ6IG51bGwsCiAgICAgICAgICAgICAgICAgIHJ1bGVzTm90VXBkYXRlZDogbnVsbAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAoMCwgX2Vycm9yX3RvX3RvYXN0ZXIuZXJyb3JUb1RvYXN0ZXIpKHsKICAgICAgICAgICAgICAgICAgdGl0bGU6IGkxOG4uUlVMRV9GRVRDSF9GQUlMVVJFLAogICAgICAgICAgICAgICAgICBlcnJvcjogX2NvbnRleHQudDAsCiAgICAgICAgICAgICAgICAgIGRpc3BhdGNoVG9hc3RlcjogZGlzcGF0Y2hUb2FzdGVyCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgIGlmIChpc1N1YnNjcmliZWQpIHsKICAgICAgICAgICAgICAgIHNldExvYWRpbmcoZmFsc2UpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIG51bGwsIG51bGwsIFtbMCwgOF1dKTsKICAgIH07CgogICAgdmFyIGNyZWF0ZUVsYXN0aWNSdWxlcyA9IGZ1bmN0aW9uIGNyZWF0ZUVsYXN0aWNSdWxlcygpIHsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hc3luYyhmdW5jdGlvbiBjcmVhdGVFbGFzdGljUnVsZXMkKF9jb250ZXh0NCkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KCJyZXR1cm4iLCBuZXcgUHJvbWlzZShmdW5jdGlvbiBfY2FsbGVlMihyZXNvbHZlKSB7CiAgICAgICAgICAgICAgICB2YXIgaXRlcmF0aW9uVHJ5T2ZGZXRjaGluZ1ByZVBhY2thZ2VkQ291bnQsIHRpbWVvdXRJZCwgc3RvcFRpbWVPdXQsIHJlRmV0Y2g7CiAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmFzeW5jKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDMpIHsKICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLnByZXYgPSAwOwoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoY2FuVXNlckNSVUQgJiYgaGFzSW5kZXhXcml0ZSAmJiBoYXNNYW5hZ2VBcGlLZXkgJiYgaXNBdXRoZW50aWNhdGVkICYmIGhhc0VuY3J5cHRpb25LZXkgJiYgaXNTaWduYWxJbmRleEV4aXN0cykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDg7CiAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIHNldExvYWRpbmdDcmVhdGVQcmVQYWNrYWdlZFJ1bGVzKHRydWUpOwogICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDU7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAoKDAsIF9hcGkuY3JlYXRlUHJlcGFja2FnZWRSdWxlcykoewogICAgICAgICAgICAgICAgICAgICAgICAgIHNpZ25hbDogYWJvcnRDdHJsLnNpZ25hbAogICAgICAgICAgICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNTdWJzY3JpYmVkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlcmF0aW9uVHJ5T2ZGZXRjaGluZ1ByZVBhY2thZ2VkQ291bnQgPSAwOwogICAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVvdXRJZCA9IC0xOwoKICAgICAgICAgICAgICAgICAgICAgICAgICBzdG9wVGltZU91dCA9IGZ1bmN0aW9uIHN0b3BUaW1lT3V0KCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRpbWVvdXRJZCAhPT0gLTEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmNsZWFyVGltZW91dCh0aW1lb3V0SWQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgICAgICAgICAgICAgIHJlRmV0Y2ggPSBmdW5jdGlvbiByZUZldGNoKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcmVQYWNrYWdlZFJ1bGVTdGF0dXNSZXNwb25zZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hc3luYyhmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dDIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVyYXRpb25UcnlPZkZldGNoaW5nUHJlUGFja2FnZWRDb3VudCA9IGl0ZXJhdGlvblRyeU9mRmV0Y2hpbmdQcmVQYWNrYWdlZENvdW50ICsgMTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hd3JhcCgoMCwgX2FwaS5nZXRQcmVQYWNrYWdlZFJ1bGVzU3RhdHVzKSh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaWduYWw6IGFib3J0Q3RybC5zaWduYWwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJlUGFja2FnZWRSdWxlU3RhdHVzUmVzcG9uc2UgPSBfY29udGV4dDIuc2VudDsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzU3Vic2NyaWJlZCAmJiAocHJlUGFja2FnZWRSdWxlU3RhdHVzUmVzcG9uc2UucnVsZXNfbm90X2luc3RhbGxlZCA9PT0gMCAmJiBwcmVQYWNrYWdlZFJ1bGVTdGF0dXNSZXNwb25zZS5ydWxlc19ub3RfdXBkYXRlZCA9PT0gMCB8fCBpdGVyYXRpb25UcnlPZkZldGNoaW5nUHJlUGFja2FnZWRDb3VudCA+IDEwMCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldExvYWRpbmdDcmVhdGVQcmVQYWNrYWdlZFJ1bGVzKGZhbHNlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldFJ1bGVTdGF0dXMoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVQcmVQYWNrYWdlZFJ1bGVzOiBjcmVhdGVFbGFzdGljUnVsZXMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZmV0Y2hQcmVQYWNrYWdlZFJ1bGVzU3RhdHVzOiBmZXRjaFByZVBhY2thZ2VkUnVsZXMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGVzQ3VzdG9tSW5zdGFsbGVkOiBwcmVQYWNrYWdlZFJ1bGVTdGF0dXNSZXNwb25zZS5ydWxlc19jdXN0b21faW5zdGFsbGVkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydWxlc0luc3RhbGxlZDogcHJlUGFja2FnZWRSdWxlU3RhdHVzUmVzcG9uc2UucnVsZXNfaW5zdGFsbGVkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydWxlc05vdEluc3RhbGxlZDogcHJlUGFja2FnZWRSdWxlU3RhdHVzUmVzcG9uc2UucnVsZXNfbm90X2luc3RhbGxlZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVsZXNOb3RVcGRhdGVkOiBwcmVQYWNrYWdlZFJ1bGVTdGF0dXNSZXNwb25zZS5ydWxlc19ub3RfdXBkYXRlZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoMCwgX3RvYXN0ZXJzLmRpc3BsYXlTdWNjZXNzVG9hc3QpKGkxOG4uUlVMRV9QUkVQQUNLQUdFRF9TVUNDRVNTLCBkaXNwYXRjaFRvYXN0ZXIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RvcFRpbWVPdXQoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUodHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVvdXRJZCA9IHJlRmV0Y2goKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDMwMCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgdGltZW91dElkID0gcmVGZXRjaCgpOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShmYWxzZSk7CgogICAgICAgICAgICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDE0OwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDMucHJldiA9IDExOwogICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDMudDAgPSBfY29udGV4dDNbImNhdGNoIl0oMCk7CgogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNTdWJzY3JpYmVkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0TG9hZGluZ0NyZWF0ZVByZVBhY2thZ2VkUnVsZXMoZmFsc2UpOwogICAgICAgICAgICAgICAgICAgICAgICAgICgwLCBfZXJyb3JfdG9fdG9hc3Rlci5lcnJvclRvVG9hc3RlcikoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGkxOG4uUlVMRV9QUkVQQUNLQUdFRF9GQUlMVVJFLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IF9jb250ZXh0My50MCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoVG9hc3RlcjogZGlzcGF0Y2hUb2FzdGVyCiAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShmYWxzZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LCBudWxsLCBudWxsLCBbWzAsIDExXV0pOwogICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfTsKCiAgICBmZXRjaFByZVBhY2thZ2VkUnVsZXMoKTsKICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgIGlzU3Vic2NyaWJlZCA9IGZhbHNlOwogICAgICBhYm9ydEN0cmwuYWJvcnQoKTsKICAgIH07CiAgfSwgW2NhblVzZXJDUlVELCBoYXNJbmRleFdyaXRlLCBoYXNNYW5hZ2VBcGlLZXksIGlzQXV0aGVudGljYXRlZCwgaGFzRW5jcnlwdGlvbktleSwgaXNTaWduYWxJbmRleEV4aXN0c10pOwogIHJldHVybiBfb2JqZWN0U3ByZWFkKHsKICAgIGxvYWRpbmc6IGxvYWRpbmcsCiAgICBsb2FkaW5nQ3JlYXRlUHJlUGFja2FnZWRSdWxlczogbG9hZGluZ0NyZWF0ZVByZVBhY2thZ2VkUnVsZXMKICB9LCBydWxlc1N0YXR1cyk7Cn07CgpleHBvcnRzLnVzZVByZVBhY2thZ2VkUnVsZXMgPSB1c2VQcmVQYWNrYWdlZFJ1bGVzOw=="},null]}