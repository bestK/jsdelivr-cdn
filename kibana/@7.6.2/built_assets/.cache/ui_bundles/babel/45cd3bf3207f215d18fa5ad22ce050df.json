{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/maps/public/layers/styles/vector/components/vector_style_editor.js","dependencies":[{"path":"x-pack/legacy/plugins/maps/public/layers/styles/vector/components/vector_style_editor.js","mtime":1585205045377},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLlZlY3RvclN0eWxlRWRpdG9yID0gdm9pZCAwOwoKdmFyIF9sb2Rhc2ggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoImxvZGFzaCIpKTsKCnZhciBfcmVhY3QgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKCJyZWFjdCIpKTsKCnZhciBfY2hyb21lID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJ1aS9jaHJvbWUiKSk7Cgp2YXIgX3ZlY3Rvcl9zdHlsZV9jb2xvcl9lZGl0b3IgPSByZXF1aXJlKCIuL2NvbG9yL3ZlY3Rvcl9zdHlsZV9jb2xvcl9lZGl0b3IiKTsKCnZhciBfdmVjdG9yX3N0eWxlX3NpemVfZWRpdG9yID0gcmVxdWlyZSgiLi9zaXplL3ZlY3Rvcl9zdHlsZV9zaXplX2VkaXRvciIpOwoKdmFyIF92ZWN0b3Jfc3R5bGVfc3ltYm9sX2VkaXRvciA9IHJlcXVpcmUoIi4vdmVjdG9yX3N0eWxlX3N5bWJvbF9lZGl0b3IiKTsKCnZhciBfdmVjdG9yX3N0eWxlX2xhYmVsX2VkaXRvciA9IHJlcXVpcmUoIi4vbGFiZWwvdmVjdG9yX3N0eWxlX2xhYmVsX2VkaXRvciIpOwoKdmFyIF92ZWN0b3Jfc3R5bGVfbGFiZWxfYm9yZGVyX3NpemVfZWRpdG9yID0gcmVxdWlyZSgiLi9sYWJlbC92ZWN0b3Jfc3R5bGVfbGFiZWxfYm9yZGVyX3NpemVfZWRpdG9yIik7Cgp2YXIgX3ZlY3Rvcl9zdHlsZSA9IHJlcXVpcmUoIi4uL3ZlY3Rvcl9zdHlsZSIpOwoKdmFyIF9vcmllbnRhdGlvbl9lZGl0b3IgPSByZXF1aXJlKCIuL29yaWVudGF0aW9uL29yaWVudGF0aW9uX2VkaXRvciIpOwoKdmFyIF92ZWN0b3Jfc3R5bGVfZGVmYXVsdHMgPSByZXF1aXJlKCIuLi92ZWN0b3Jfc3R5bGVfZGVmYXVsdHMiKTsKCnZhciBfY29sb3JfdXRpbHMgPSByZXF1aXJlKCIuLi8uLi9jb2xvcl91dGlscyIpOwoKdmFyIF92ZWN0b3JfZmVhdHVyZV90eXBlcyA9IHJlcXVpcmUoIi4uLy4uLy4uL3NvdXJjZXMvdmVjdG9yX2ZlYXR1cmVfdHlwZXMiKTsKCnZhciBfdmVjdG9yX2NvbnN0YW50cyA9IHJlcXVpcmUoIi4uL3ZlY3Rvcl9jb25zdGFudHMiKTsKCnZhciBfaTE4biA9IHJlcXVpcmUoIkBrYm4vaTE4biIpOwoKdmFyIF9zeW1ib2xfdXRpbHMgPSByZXF1aXJlKCIuLi9zeW1ib2xfdXRpbHMiKTsKCnZhciBfZXVpID0gcmVxdWlyZSgiQGVsYXN0aWMvZXVpIik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGVsc2UgeyB2YXIgbmV3T2JqID0ge307IGlmIChvYmogIT0gbnVsbCkgeyBmb3IgKHZhciBrZXkgaW4gb2JqKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7IHZhciBkZXNjID0gT2JqZWN0LmRlZmluZVByb3BlcnR5ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KSA6IHt9OyBpZiAoZGVzYy5nZXQgfHwgZGVzYy5zZXQpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5ld09iaiwga2V5LCBkZXNjKTsgfSBlbHNlIHsgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IH0gfSBuZXdPYmouZGVmYXVsdCA9IG9iajsgcmV0dXJuIG5ld09iajsgfSB9CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gInN5bWJvbCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9CgpmdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7IHJldHVybiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5KGFycikgfHwgX25vbkl0ZXJhYmxlU3ByZWFkKCk7IH0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVNwcmVhZCgpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIHNwcmVhZCBub24taXRlcmFibGUgaW5zdGFuY2UiKTsgfQoKZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheShpdGVyKSB7IGlmIChTeW1ib2wuaXRlcmF0b3IgaW4gT2JqZWN0KGl0ZXIpIHx8IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChpdGVyKSA9PT0gIltvYmplY3QgQXJndW1lbnRzXSIpIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpOyB9CgpmdW5jdGlvbiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB7IGlmIChBcnJheS5pc0FycmF5KGFycikpIHsgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkoYXJyLmxlbmd0aCk7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHsgYXJyMltpXSA9IGFycltpXTsgfSByZXR1cm4gYXJyMjsgfSB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9CgpmdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfQoKZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpKSB7IHJldHVybiBjYWxsOyB9IHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOyB9CgpmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyBfZ2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3QuZ2V0UHJvdG90eXBlT2YgOiBmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyByZXR1cm4gby5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKG8pOyB9OyByZXR1cm4gX2dldFByb3RvdHlwZU9mKG8pOyB9CgpmdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsgaWYgKHNlbGYgPT09IHZvaWQgMCkgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOyB9IHJldHVybiBzZWxmOyB9CgpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAiZnVuY3Rpb24iICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24iKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBfc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpOyB9CgpmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgby5fX3Byb3RvX18gPSBwOyByZXR1cm4gbzsgfTsgcmV0dXJuIF9zZXRQcm90b3R5cGVPZihvLCBwKTsgfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgeyBpZiAoa2V5IGluIG9iaikgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsgdmFsdWU6IHZhbHVlLCBlbnVtZXJhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlIH0pOyB9IGVsc2UgeyBvYmpba2V5XSA9IHZhbHVlOyB9IHJldHVybiBvYmo7IH0KCnZhciBWZWN0b3JTdHlsZUVkaXRvciA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKF9Db21wb25lbnQpIHsKICBfaW5oZXJpdHMoVmVjdG9yU3R5bGVFZGl0b3IsIF9Db21wb25lbnQpOwoKICBmdW5jdGlvbiBWZWN0b3JTdHlsZUVkaXRvcigpIHsKICAgIHZhciBfZ2V0UHJvdG90eXBlT2YyOwoKICAgIHZhciBfdGhpczsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVmVjdG9yU3R5bGVFZGl0b3IpOwoKICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykgewogICAgICBhcmdzW19rZXldID0gYXJndW1lbnRzW19rZXldOwogICAgfQoKICAgIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKF9nZXRQcm90b3R5cGVPZjIgPSBfZ2V0UHJvdG90eXBlT2YoVmVjdG9yU3R5bGVFZGl0b3IpKS5jYWxsLmFwcGx5KF9nZXRQcm90b3R5cGVPZjIsIFt0aGlzXS5jb25jYXQoYXJncykpKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJzdGF0ZSIsIHsKICAgICAgZGF0ZUZpZWxkczogW10sCiAgICAgIG51bWJlckZpZWxkczogW10sCiAgICAgIGNhdGVnb3JpY2FsRmllbGRzOiBbXSwKICAgICAgZmllbGRzOiBbXSwKICAgICAgZGVmYXVsdER5bmFtaWNQcm9wZXJ0aWVzOiAoMCwgX3ZlY3Rvcl9zdHlsZV9kZWZhdWx0cy5nZXREZWZhdWx0RHluYW1pY1Byb3BlcnRpZXMpKCksCiAgICAgIGRlZmF1bHRTdGF0aWNQcm9wZXJ0aWVzOiAoMCwgX3ZlY3Rvcl9zdHlsZV9kZWZhdWx0cy5nZXREZWZhdWx0U3RhdGljUHJvcGVydGllcykoKSwKICAgICAgc3VwcG9ydGVkRmVhdHVyZXM6IHVuZGVmaW5lZCwKICAgICAgc2VsZWN0ZWRGZWF0dXJlVHlwZTogdW5kZWZpbmVkCiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJfaGFuZGxlU2VsZWN0ZWRGZWF0dXJlQ2hhbmdlIiwgZnVuY3Rpb24gKHNlbGVjdGVkRmVhdHVyZSkgewogICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgc2VsZWN0ZWRGZWF0dXJlOiBzZWxlY3RlZEZlYXR1cmUKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJfb25Jc1RpbWVBd2FyZUNoYW5nZSIsIGZ1bmN0aW9uIChldmVudCkgewogICAgICBfdGhpcy5wcm9wcy5vbklzVGltZUF3YXJlQ2hhbmdlKGV2ZW50LnRhcmdldC5jaGVja2VkKTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIl9vblN0YXRpY1N0eWxlQ2hhbmdlIiwgZnVuY3Rpb24gKHByb3BlcnR5TmFtZSwgb3B0aW9ucykgewogICAgICB2YXIgc3R5bGVEZXNjcmlwdG9yID0gewogICAgICAgIHR5cGU6IF92ZWN0b3Jfc3R5bGUuVmVjdG9yU3R5bGUuU1RZTEVfVFlQRS5TVEFUSUMsCiAgICAgICAgb3B0aW9uczogb3B0aW9ucwogICAgICB9OwoKICAgICAgX3RoaXMucHJvcHMuaGFuZGxlUHJvcGVydHlDaGFuZ2UocHJvcGVydHlOYW1lLCBzdHlsZURlc2NyaXB0b3IpOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiX29uRHluYW1pY1N0eWxlQ2hhbmdlIiwgZnVuY3Rpb24gKHByb3BlcnR5TmFtZSwgb3B0aW9ucykgewogICAgICB2YXIgc3R5bGVEZXNjcmlwdG9yID0gewogICAgICAgIHR5cGU6IF92ZWN0b3Jfc3R5bGUuVmVjdG9yU3R5bGUuU1RZTEVfVFlQRS5EWU5BTUlDLAogICAgICAgIG9wdGlvbnM6IG9wdGlvbnMKICAgICAgfTsKCiAgICAgIF90aGlzLnByb3BzLmhhbmRsZVByb3BlcnR5Q2hhbmdlKHByb3BlcnR5TmFtZSwgc3R5bGVEZXNjcmlwdG9yKTsKICAgIH0pOwoKICAgIHJldHVybiBfdGhpczsKICB9CgogIF9jcmVhdGVDbGFzcyhWZWN0b3JTdHlsZUVkaXRvciwgW3sKICAgIGtleTogImNvbXBvbmVudFdpbGxVbm1vdW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnRXaWxsVW5tb3VudCgpIHsKICAgICAgdGhpcy5faXNNb3VudGVkID0gZmFsc2U7CiAgICB9CiAgfSwgewogICAga2V5OiAiY29tcG9uZW50RGlkTW91bnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudERpZE1vdW50KCkgewogICAgICB0aGlzLl9pc01vdW50ZWQgPSB0cnVlOwoKICAgICAgdGhpcy5fbG9hZEZpZWxkcygpOwoKICAgICAgdGhpcy5fbG9hZFN1cHBvcnRlZEZlYXR1cmVzKCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiY29tcG9uZW50RGlkVXBkYXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnREaWRVcGRhdGUoKSB7CiAgICAgIHRoaXMuX2xvYWRGaWVsZHMoKTsKCiAgICAgIHRoaXMuX2xvYWRTdXBwb3J0ZWRGZWF0dXJlcygpOwogICAgfQogIH0sIHsKICAgIGtleTogIl9sb2FkRmllbGRzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfbG9hZEZpZWxkcygpIHsKICAgICAgdmFyIGdldEZpZWxkTWV0YSwgZGF0ZUZpZWxkcywgZGF0ZUZpZWxkUHJvbWlzZXMsIGRhdGVGaWVsZHNBcnJheSwgbnVtYmVyRmllbGRzLCBudW1iZXJGaWVsZFByb21pc2VzLCBudW1iZXJGaWVsZHNBcnJheSwgY2F0ZWdvcmljYWxGaWVsZHMsIGNhdGVnb3JpY2FsRmllbGRNZXRhLCBjYXRlZ29yaWNhbEZpZWxkc0FycmF5LCBmaWVsZHMsIGZpZWxkUHJvbWlzZXMsIGZpZWxkc0FycmF5OwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmFzeW5jKGZ1bmN0aW9uIF9sb2FkRmllbGRzJChfY29udGV4dDIpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBnZXRGaWVsZE1ldGEgPSBmdW5jdGlvbiBnZXRGaWVsZE1ldGEoZmllbGQpIHsKICAgICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXN5bmMoZnVuY3Rpb24gZ2V0RmllbGRNZXRhJChfY29udGV4dCkgewogICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAoZmllbGQuZ2V0TGFiZWwoKSk7CgogICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0LnQxID0gZmllbGQuZ2V0TmFtZSgpOwogICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dC50MiA9IGZpZWxkLmdldE9yaWdpbigpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IF9jb250ZXh0LnQwLAogICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IF9jb250ZXh0LnQxLAogICAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbjogX2NvbnRleHQudDIKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMzsKICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKHRoaXMucHJvcHMubGF5ZXIuZ2V0RGF0ZUZpZWxkcygpKTsKCiAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICBkYXRlRmllbGRzID0gX2NvbnRleHQyLnNlbnQ7CiAgICAgICAgICAgICAgZGF0ZUZpZWxkUHJvbWlzZXMgPSBkYXRlRmllbGRzLm1hcChnZXRGaWVsZE1ldGEpOwogICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNzsKICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKFByb21pc2UuYWxsKGRhdGVGaWVsZFByb21pc2VzKSk7CgogICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgZGF0ZUZpZWxkc0FycmF5ID0gX2NvbnRleHQyLnNlbnQ7CgogICAgICAgICAgICAgIGlmICh0aGlzLl9pc01vdW50ZWQgJiYgIV9sb2Rhc2guZGVmYXVsdC5pc0VxdWFsKGRhdGVGaWVsZHNBcnJheSwgdGhpcy5zdGF0ZS5kYXRlRmllbGRzKSkgewogICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICAgIGRhdGVGaWVsZHM6IGRhdGVGaWVsZHNBcnJheQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDExOwogICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAodGhpcy5wcm9wcy5sYXllci5nZXROdW1iZXJGaWVsZHMoKSk7CgogICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgIG51bWJlckZpZWxkcyA9IF9jb250ZXh0Mi5zZW50OwogICAgICAgICAgICAgIG51bWJlckZpZWxkUHJvbWlzZXMgPSBudW1iZXJGaWVsZHMubWFwKGdldEZpZWxkTWV0YSk7CiAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxNTsKICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKFByb21pc2UuYWxsKG51bWJlckZpZWxkUHJvbWlzZXMpKTsKCiAgICAgICAgICAgIGNhc2UgMTU6CiAgICAgICAgICAgICAgbnVtYmVyRmllbGRzQXJyYXkgPSBfY29udGV4dDIuc2VudDsKCiAgICAgICAgICAgICAgaWYgKHRoaXMuX2lzTW91bnRlZCAmJiAhX2xvZGFzaC5kZWZhdWx0LmlzRXF1YWwobnVtYmVyRmllbGRzQXJyYXksIHRoaXMuc3RhdGUubnVtYmVyRmllbGRzKSkgewogICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICAgIG51bWJlckZpZWxkczogbnVtYmVyRmllbGRzQXJyYXkKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxOTsKICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKHRoaXMucHJvcHMubGF5ZXIuZ2V0Q2F0ZWdvcmljYWxGaWVsZHMoKSk7CgogICAgICAgICAgICBjYXNlIDE5OgogICAgICAgICAgICAgIGNhdGVnb3JpY2FsRmllbGRzID0gX2NvbnRleHQyLnNlbnQ7CiAgICAgICAgICAgICAgY2F0ZWdvcmljYWxGaWVsZE1ldGEgPSBjYXRlZ29yaWNhbEZpZWxkcy5tYXAoZ2V0RmllbGRNZXRhKTsKICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDIzOwogICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAoUHJvbWlzZS5hbGwoY2F0ZWdvcmljYWxGaWVsZE1ldGEpKTsKCiAgICAgICAgICAgIGNhc2UgMjM6CiAgICAgICAgICAgICAgY2F0ZWdvcmljYWxGaWVsZHNBcnJheSA9IF9jb250ZXh0Mi5zZW50OwoKICAgICAgICAgICAgICBpZiAodGhpcy5faXNNb3VudGVkICYmICFfbG9kYXNoLmRlZmF1bHQuaXNFcXVhbChjYXRlZ29yaWNhbEZpZWxkc0FycmF5LCB0aGlzLnN0YXRlLmNhdGVnb3JpY2FsRmllbGRzKSkgewogICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICAgIGNhdGVnb3JpY2FsRmllbGRzOiBjYXRlZ29yaWNhbEZpZWxkc0FycmF5CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMjc7CiAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hd3JhcCh0aGlzLnByb3BzLmxheWVyLmdldEZpZWxkcygpKTsKCiAgICAgICAgICAgIGNhc2UgMjc6CiAgICAgICAgICAgICAgZmllbGRzID0gX2NvbnRleHQyLnNlbnQ7CiAgICAgICAgICAgICAgZmllbGRQcm9taXNlcyA9IGZpZWxkcy5tYXAoZ2V0RmllbGRNZXRhKTsKICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDMxOwogICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAoUHJvbWlzZS5hbGwoZmllbGRQcm9taXNlcykpOwoKICAgICAgICAgICAgY2FzZSAzMToKICAgICAgICAgICAgICBmaWVsZHNBcnJheSA9IF9jb250ZXh0Mi5zZW50OwoKICAgICAgICAgICAgICBpZiAodGhpcy5faXNNb3VudGVkICYmICFfbG9kYXNoLmRlZmF1bHQuaXNFcXVhbChmaWVsZHNBcnJheSwgdGhpcy5zdGF0ZS5maWVsZHMpKSB7CiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgICAgZmllbGRzOiBmaWVsZHNBcnJheQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgY2FzZSAzMzoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIG51bGwsIHRoaXMpOwogICAgfQogIH0sIHsKICAgIGtleTogIl9sb2FkU3VwcG9ydGVkRmVhdHVyZXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9sb2FkU3VwcG9ydGVkRmVhdHVyZXMoKSB7CiAgICAgIHZhciBzdXBwb3J0ZWRGZWF0dXJlcywgc2VsZWN0ZWRGZWF0dXJlOwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmFzeW5jKGZ1bmN0aW9uIF9sb2FkU3VwcG9ydGVkRmVhdHVyZXMkKF9jb250ZXh0MykgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMjsKICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKHRoaXMucHJvcHMubGF5ZXIuZ2V0U291cmNlKCkuZ2V0U3VwcG9ydGVkU2hhcGVUeXBlcygpKTsKCiAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICBzdXBwb3J0ZWRGZWF0dXJlcyA9IF9jb250ZXh0My5zZW50OwoKICAgICAgICAgICAgICBpZiAodGhpcy5faXNNb3VudGVkKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDU7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICBzZWxlY3RlZEZlYXR1cmUgPSBfdmVjdG9yX2ZlYXR1cmVfdHlwZXMuVkVDVE9SX1NIQVBFX1RZUEVTLlBPTFlHT047CgogICAgICAgICAgICAgIGlmICh0aGlzLnByb3BzLmlzUG9pbnRzT25seSkgewogICAgICAgICAgICAgICAgc2VsZWN0ZWRGZWF0dXJlID0gX3ZlY3Rvcl9mZWF0dXJlX3R5cGVzLlZFQ1RPUl9TSEFQRV9UWVBFUy5QT0lOVDsKICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMucHJvcHMuaXNMaW5lc09ubHkpIHsKICAgICAgICAgICAgICAgIHNlbGVjdGVkRmVhdHVyZSA9IF92ZWN0b3JfZmVhdHVyZV90eXBlcy5WRUNUT1JfU0hBUEVfVFlQRVMuTElORTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGlmICghX2xvZGFzaC5kZWZhdWx0LmlzRXF1YWwoc3VwcG9ydGVkRmVhdHVyZXMsIHRoaXMuc3RhdGUuc3VwcG9ydGVkRmVhdHVyZXMpIHx8IHNlbGVjdGVkRmVhdHVyZSAhPT0gdGhpcy5zdGF0ZS5zZWxlY3RlZEZlYXR1cmUpIHsKICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgICBzdXBwb3J0ZWRGZWF0dXJlczogc3VwcG9ydGVkRmVhdHVyZXMsCiAgICAgICAgICAgICAgICAgIHNlbGVjdGVkRmVhdHVyZTogc2VsZWN0ZWRGZWF0dXJlCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBudWxsLCB0aGlzKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfZ2V0T3JkaW5hbEZpZWxkcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2dldE9yZGluYWxGaWVsZHMoKSB7CiAgICAgIHJldHVybiBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KHRoaXMuc3RhdGUuZGF0ZUZpZWxkcyksIF90b0NvbnN1bWFibGVBcnJheSh0aGlzLnN0YXRlLm51bWJlckZpZWxkcykpOwogICAgfQogIH0sIHsKICAgIGtleTogIl9nZXRPcmRpbmFsQW5kQ2F0ZWdvcmljYWxGaWVsZHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9nZXRPcmRpbmFsQW5kQ2F0ZWdvcmljYWxGaWVsZHMoKSB7CiAgICAgIHJldHVybiBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KHRoaXMuc3RhdGUuZGF0ZUZpZWxkcyksIF90b0NvbnN1bWFibGVBcnJheSh0aGlzLnN0YXRlLm51bWJlckZpZWxkcyksIF90b0NvbnN1bWFibGVBcnJheSh0aGlzLnN0YXRlLmNhdGVnb3JpY2FsRmllbGRzKSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiX3JlbmRlckZpbGxDb2xvciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3JlbmRlckZpbGxDb2xvcigpIHsKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3ZlY3Rvcl9zdHlsZV9jb2xvcl9lZGl0b3IuVmVjdG9yU3R5bGVDb2xvckVkaXRvciwgewogICAgICAgIHN3YXRjaGVzOiBfY29sb3JfdXRpbHMuREVGQVVMVF9GSUxMX0NPTE9SUywKICAgICAgICBvblN0YXRpY1N0eWxlQ2hhbmdlOiB0aGlzLl9vblN0YXRpY1N0eWxlQ2hhbmdlLAogICAgICAgIG9uRHluYW1pY1N0eWxlQ2hhbmdlOiB0aGlzLl9vbkR5bmFtaWNTdHlsZUNoYW5nZSwKICAgICAgICBzdHlsZVByb3BlcnR5OiB0aGlzLnByb3BzLnN0eWxlUHJvcGVydGllc1tfdmVjdG9yX3N0eWxlX2RlZmF1bHRzLlZFQ1RPUl9TVFlMRVMuRklMTF9DT0xPUl0sCiAgICAgICAgZmllbGRzOiB0aGlzLl9nZXRPcmRpbmFsQW5kQ2F0ZWdvcmljYWxGaWVsZHMoKSwKICAgICAgICBkZWZhdWx0U3RhdGljU3R5bGVPcHRpb25zOiB0aGlzLnN0YXRlLmRlZmF1bHRTdGF0aWNQcm9wZXJ0aWVzW192ZWN0b3Jfc3R5bGVfZGVmYXVsdHMuVkVDVE9SX1NUWUxFUy5GSUxMX0NPTE9SXS5vcHRpb25zLAogICAgICAgIGRlZmF1bHREeW5hbWljU3R5bGVPcHRpb25zOiB0aGlzLnN0YXRlLmRlZmF1bHREeW5hbWljUHJvcGVydGllc1tfdmVjdG9yX3N0eWxlX2RlZmF1bHRzLlZFQ1RPUl9TVFlMRVMuRklMTF9DT0xPUl0ub3B0aW9ucwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfcmVuZGVyTGluZUNvbG9yIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVuZGVyTGluZUNvbG9yKCkgewogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfdmVjdG9yX3N0eWxlX2NvbG9yX2VkaXRvci5WZWN0b3JTdHlsZUNvbG9yRWRpdG9yLCB7CiAgICAgICAgc3dhdGNoZXM6IF9jb2xvcl91dGlscy5ERUZBVUxUX0xJTkVfQ09MT1JTLAogICAgICAgIG9uU3RhdGljU3R5bGVDaGFuZ2U6IHRoaXMuX29uU3RhdGljU3R5bGVDaGFuZ2UsCiAgICAgICAgb25EeW5hbWljU3R5bGVDaGFuZ2U6IHRoaXMuX29uRHluYW1pY1N0eWxlQ2hhbmdlLAogICAgICAgIHN0eWxlUHJvcGVydHk6IHRoaXMucHJvcHMuc3R5bGVQcm9wZXJ0aWVzW192ZWN0b3Jfc3R5bGVfZGVmYXVsdHMuVkVDVE9SX1NUWUxFUy5MSU5FX0NPTE9SXSwKICAgICAgICBmaWVsZHM6IHRoaXMuX2dldE9yZGluYWxBbmRDYXRlZ29yaWNhbEZpZWxkcygpLAogICAgICAgIGRlZmF1bHRTdGF0aWNTdHlsZU9wdGlvbnM6IHRoaXMuc3RhdGUuZGVmYXVsdFN0YXRpY1Byb3BlcnRpZXNbX3ZlY3Rvcl9zdHlsZV9kZWZhdWx0cy5WRUNUT1JfU1RZTEVTLkxJTkVfQ09MT1JdLm9wdGlvbnMsCiAgICAgICAgZGVmYXVsdER5bmFtaWNTdHlsZU9wdGlvbnM6IHRoaXMuc3RhdGUuZGVmYXVsdER5bmFtaWNQcm9wZXJ0aWVzW192ZWN0b3Jfc3R5bGVfZGVmYXVsdHMuVkVDVE9SX1NUWUxFUy5MSU5FX0NPTE9SXS5vcHRpb25zCiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogIl9yZW5kZXJMaW5lV2lkdGgiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9yZW5kZXJMaW5lV2lkdGgoKSB7CiAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF92ZWN0b3Jfc3R5bGVfc2l6ZV9lZGl0b3IuVmVjdG9yU3R5bGVTaXplRWRpdG9yLCB7CiAgICAgICAgb25TdGF0aWNTdHlsZUNoYW5nZTogdGhpcy5fb25TdGF0aWNTdHlsZUNoYW5nZSwKICAgICAgICBvbkR5bmFtaWNTdHlsZUNoYW5nZTogdGhpcy5fb25EeW5hbWljU3R5bGVDaGFuZ2UsCiAgICAgICAgc3R5bGVQcm9wZXJ0eTogdGhpcy5wcm9wcy5zdHlsZVByb3BlcnRpZXNbX3ZlY3Rvcl9zdHlsZV9kZWZhdWx0cy5WRUNUT1JfU1RZTEVTLkxJTkVfV0lEVEhdLAogICAgICAgIGZpZWxkczogdGhpcy5fZ2V0T3JkaW5hbEZpZWxkcygpLAogICAgICAgIGRlZmF1bHRTdGF0aWNTdHlsZU9wdGlvbnM6IHRoaXMuc3RhdGUuZGVmYXVsdFN0YXRpY1Byb3BlcnRpZXNbX3ZlY3Rvcl9zdHlsZV9kZWZhdWx0cy5WRUNUT1JfU1RZTEVTLkxJTkVfV0lEVEhdLm9wdGlvbnMsCiAgICAgICAgZGVmYXVsdER5bmFtaWNTdHlsZU9wdGlvbnM6IHRoaXMuc3RhdGUuZGVmYXVsdER5bmFtaWNQcm9wZXJ0aWVzW192ZWN0b3Jfc3R5bGVfZGVmYXVsdHMuVkVDVE9SX1NUWUxFUy5MSU5FX1dJRFRIXS5vcHRpb25zCiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogIl9yZW5kZXJTeW1ib2xTaXplIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVuZGVyU3ltYm9sU2l6ZSgpIHsKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3ZlY3Rvcl9zdHlsZV9zaXplX2VkaXRvci5WZWN0b3JTdHlsZVNpemVFZGl0b3IsIHsKICAgICAgICBvblN0YXRpY1N0eWxlQ2hhbmdlOiB0aGlzLl9vblN0YXRpY1N0eWxlQ2hhbmdlLAogICAgICAgIG9uRHluYW1pY1N0eWxlQ2hhbmdlOiB0aGlzLl9vbkR5bmFtaWNTdHlsZUNoYW5nZSwKICAgICAgICBzdHlsZVByb3BlcnR5OiB0aGlzLnByb3BzLnN0eWxlUHJvcGVydGllc1tfdmVjdG9yX3N0eWxlX2RlZmF1bHRzLlZFQ1RPUl9TVFlMRVMuSUNPTl9TSVpFXSwKICAgICAgICBmaWVsZHM6IHRoaXMuX2dldE9yZGluYWxGaWVsZHMoKSwKICAgICAgICBkZWZhdWx0U3RhdGljU3R5bGVPcHRpb25zOiB0aGlzLnN0YXRlLmRlZmF1bHRTdGF0aWNQcm9wZXJ0aWVzW192ZWN0b3Jfc3R5bGVfZGVmYXVsdHMuVkVDVE9SX1NUWUxFUy5JQ09OX1NJWkVdLm9wdGlvbnMsCiAgICAgICAgZGVmYXVsdER5bmFtaWNTdHlsZU9wdGlvbnM6IHRoaXMuc3RhdGUuZGVmYXVsdER5bmFtaWNQcm9wZXJ0aWVzW192ZWN0b3Jfc3R5bGVfZGVmYXVsdHMuVkVDVE9SX1NUWUxFUy5JQ09OX1NJWkVdLm9wdGlvbnMKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiX3JlbmRlckxhYmVsUHJvcGVydGllcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3JlbmRlckxhYmVsUHJvcGVydGllcygpIHsKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LkZyYWdtZW50LCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF92ZWN0b3Jfc3R5bGVfbGFiZWxfZWRpdG9yLlZlY3RvclN0eWxlTGFiZWxFZGl0b3IsIHsKICAgICAgICBvblN0YXRpY1N0eWxlQ2hhbmdlOiB0aGlzLl9vblN0YXRpY1N0eWxlQ2hhbmdlLAogICAgICAgIG9uRHluYW1pY1N0eWxlQ2hhbmdlOiB0aGlzLl9vbkR5bmFtaWNTdHlsZUNoYW5nZSwKICAgICAgICBzdHlsZVByb3BlcnR5OiB0aGlzLnByb3BzLnN0eWxlUHJvcGVydGllc1tfdmVjdG9yX3N0eWxlX2RlZmF1bHRzLlZFQ1RPUl9TVFlMRVMuTEFCRUxfVEVYVF0sCiAgICAgICAgZmllbGRzOiB0aGlzLnN0YXRlLmZpZWxkcywKICAgICAgICBkZWZhdWx0U3RhdGljU3R5bGVPcHRpb25zOiB0aGlzLnN0YXRlLmRlZmF1bHRTdGF0aWNQcm9wZXJ0aWVzW192ZWN0b3Jfc3R5bGVfZGVmYXVsdHMuVkVDVE9SX1NUWUxFUy5MQUJFTF9URVhUXS5vcHRpb25zLAogICAgICAgIGRlZmF1bHREeW5hbWljU3R5bGVPcHRpb25zOiB0aGlzLnN0YXRlLmRlZmF1bHREeW5hbWljUHJvcGVydGllc1tfdmVjdG9yX3N0eWxlX2RlZmF1bHRzLlZFQ1RPUl9TVFlMRVMuTEFCRUxfVEVYVF0ub3B0aW9ucwogICAgICB9KSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgewogICAgICAgIHNpemU6ICJtIgogICAgICB9KSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfdmVjdG9yX3N0eWxlX2NvbG9yX2VkaXRvci5WZWN0b3JTdHlsZUNvbG9yRWRpdG9yLCB7CiAgICAgICAgc3dhdGNoZXM6IF9jb2xvcl91dGlscy5ERUZBVUxUX0xJTkVfQ09MT1JTLAogICAgICAgIG9uU3RhdGljU3R5bGVDaGFuZ2U6IHRoaXMuX29uU3RhdGljU3R5bGVDaGFuZ2UsCiAgICAgICAgb25EeW5hbWljU3R5bGVDaGFuZ2U6IHRoaXMuX29uRHluYW1pY1N0eWxlQ2hhbmdlLAogICAgICAgIHN0eWxlUHJvcGVydHk6IHRoaXMucHJvcHMuc3R5bGVQcm9wZXJ0aWVzW192ZWN0b3Jfc3R5bGVfZGVmYXVsdHMuVkVDVE9SX1NUWUxFUy5MQUJFTF9DT0xPUl0sCiAgICAgICAgZmllbGRzOiB0aGlzLl9nZXRPcmRpbmFsQW5kQ2F0ZWdvcmljYWxGaWVsZHMoKSwKICAgICAgICBkZWZhdWx0U3RhdGljU3R5bGVPcHRpb25zOiB0aGlzLnN0YXRlLmRlZmF1bHRTdGF0aWNQcm9wZXJ0aWVzW192ZWN0b3Jfc3R5bGVfZGVmYXVsdHMuVkVDVE9SX1NUWUxFUy5MQUJFTF9DT0xPUl0ub3B0aW9ucywKICAgICAgICBkZWZhdWx0RHluYW1pY1N0eWxlT3B0aW9uczogdGhpcy5zdGF0ZS5kZWZhdWx0RHluYW1pY1Byb3BlcnRpZXNbX3ZlY3Rvcl9zdHlsZV9kZWZhdWx0cy5WRUNUT1JfU1RZTEVTLkxBQkVMX0NPTE9SXS5vcHRpb25zCiAgICAgIH0pLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3BhY2VyLCB7CiAgICAgICAgc2l6ZTogIm0iCiAgICAgIH0pLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF92ZWN0b3Jfc3R5bGVfc2l6ZV9lZGl0b3IuVmVjdG9yU3R5bGVTaXplRWRpdG9yLCB7CiAgICAgICAgb25TdGF0aWNTdHlsZUNoYW5nZTogdGhpcy5fb25TdGF0aWNTdHlsZUNoYW5nZSwKICAgICAgICBvbkR5bmFtaWNTdHlsZUNoYW5nZTogdGhpcy5fb25EeW5hbWljU3R5bGVDaGFuZ2UsCiAgICAgICAgc3R5bGVQcm9wZXJ0eTogdGhpcy5wcm9wcy5zdHlsZVByb3BlcnRpZXNbX3ZlY3Rvcl9zdHlsZV9kZWZhdWx0cy5WRUNUT1JfU1RZTEVTLkxBQkVMX1NJWkVdLAogICAgICAgIGZpZWxkczogdGhpcy5fZ2V0T3JkaW5hbEZpZWxkcygpLAogICAgICAgIGRlZmF1bHRTdGF0aWNTdHlsZU9wdGlvbnM6IHRoaXMuc3RhdGUuZGVmYXVsdFN0YXRpY1Byb3BlcnRpZXNbX3ZlY3Rvcl9zdHlsZV9kZWZhdWx0cy5WRUNUT1JfU1RZTEVTLkxBQkVMX1NJWkVdLm9wdGlvbnMsCiAgICAgICAgZGVmYXVsdER5bmFtaWNTdHlsZU9wdGlvbnM6IHRoaXMuc3RhdGUuZGVmYXVsdER5bmFtaWNQcm9wZXJ0aWVzW192ZWN0b3Jfc3R5bGVfZGVmYXVsdHMuVkVDVE9SX1NUWUxFUy5MQUJFTF9TSVpFXS5vcHRpb25zCiAgICAgIH0pLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3BhY2VyLCB7CiAgICAgICAgc2l6ZTogIm0iCiAgICAgIH0pLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF92ZWN0b3Jfc3R5bGVfY29sb3JfZWRpdG9yLlZlY3RvclN0eWxlQ29sb3JFZGl0b3IsIHsKICAgICAgICBzd2F0Y2hlczogX2NvbG9yX3V0aWxzLkRFRkFVTFRfTElORV9DT0xPUlMsCiAgICAgICAgb25TdGF0aWNTdHlsZUNoYW5nZTogdGhpcy5fb25TdGF0aWNTdHlsZUNoYW5nZSwKICAgICAgICBvbkR5bmFtaWNTdHlsZUNoYW5nZTogdGhpcy5fb25EeW5hbWljU3R5bGVDaGFuZ2UsCiAgICAgICAgc3R5bGVQcm9wZXJ0eTogdGhpcy5wcm9wcy5zdHlsZVByb3BlcnRpZXNbX3ZlY3Rvcl9zdHlsZV9kZWZhdWx0cy5WRUNUT1JfU1RZTEVTLkxBQkVMX0JPUkRFUl9DT0xPUl0sCiAgICAgICAgZmllbGRzOiB0aGlzLl9nZXRPcmRpbmFsQW5kQ2F0ZWdvcmljYWxGaWVsZHMoKSwKICAgICAgICBkZWZhdWx0U3RhdGljU3R5bGVPcHRpb25zOiB0aGlzLnN0YXRlLmRlZmF1bHRTdGF0aWNQcm9wZXJ0aWVzW192ZWN0b3Jfc3R5bGVfZGVmYXVsdHMuVkVDVE9SX1NUWUxFUy5MQUJFTF9CT1JERVJfQ09MT1JdLm9wdGlvbnMsCiAgICAgICAgZGVmYXVsdER5bmFtaWNTdHlsZU9wdGlvbnM6IHRoaXMuc3RhdGUuZGVmYXVsdER5bmFtaWNQcm9wZXJ0aWVzW192ZWN0b3Jfc3R5bGVfZGVmYXVsdHMuVkVDVE9SX1NUWUxFUy5MQUJFTF9CT1JERVJfQ09MT1JdLm9wdGlvbnMKICAgICAgfSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTcGFjZXIsIHsKICAgICAgICBzaXplOiAibSIKICAgICAgfSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3ZlY3Rvcl9zdHlsZV9sYWJlbF9ib3JkZXJfc2l6ZV9lZGl0b3IuVmVjdG9yU3R5bGVMYWJlbEJvcmRlclNpemVFZGl0b3IsIHsKICAgICAgICBoYW5kbGVQcm9wZXJ0eUNoYW5nZTogdGhpcy5wcm9wcy5oYW5kbGVQcm9wZXJ0eUNoYW5nZSwKICAgICAgICBzdHlsZVByb3BlcnR5OiB0aGlzLnByb3BzLnN0eWxlUHJvcGVydGllc1tfdmVjdG9yX3N0eWxlX2RlZmF1bHRzLlZFQ1RPUl9TVFlMRVMuTEFCRUxfQk9SREVSX1NJWkVdCiAgICAgIH0pLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3BhY2VyLCB7CiAgICAgICAgc2l6ZTogIm0iCiAgICAgIH0pKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfcmVuZGVyUG9pbnRQcm9wZXJ0aWVzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVuZGVyUG9pbnRQcm9wZXJ0aWVzKCkgewogICAgICB2YXIgaWNvbk9yaWVudGF0aW9uOwoKICAgICAgaWYgKHRoaXMucHJvcHMuc3ltYm9sRGVzY3JpcHRvci5vcHRpb25zLnN5bWJvbGl6ZUFzID09PSBfdmVjdG9yX2NvbnN0YW50cy5TWU1CT0xJWkVfQVNfSUNPTikgewogICAgICAgIGljb25PcmllbnRhdGlvbiA9IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX29yaWVudGF0aW9uX2VkaXRvci5PcmllbnRhdGlvbkVkaXRvciwgewogICAgICAgICAgb25TdGF0aWNTdHlsZUNoYW5nZTogdGhpcy5fb25TdGF0aWNTdHlsZUNoYW5nZSwKICAgICAgICAgIG9uRHluYW1pY1N0eWxlQ2hhbmdlOiB0aGlzLl9vbkR5bmFtaWNTdHlsZUNoYW5nZSwKICAgICAgICAgIHN0eWxlUHJvcGVydHk6IHRoaXMucHJvcHMuc3R5bGVQcm9wZXJ0aWVzW192ZWN0b3Jfc3R5bGVfZGVmYXVsdHMuVkVDVE9SX1NUWUxFUy5JQ09OX09SSUVOVEFUSU9OXSwKICAgICAgICAgIGZpZWxkczogdGhpcy5zdGF0ZS5udW1iZXJGaWVsZHMsCiAgICAgICAgICBkZWZhdWx0U3RhdGljU3R5bGVPcHRpb25zOiB0aGlzLnN0YXRlLmRlZmF1bHRTdGF0aWNQcm9wZXJ0aWVzW192ZWN0b3Jfc3R5bGVfZGVmYXVsdHMuVkVDVE9SX1NUWUxFUy5JQ09OX09SSUVOVEFUSU9OXS5vcHRpb25zLAogICAgICAgICAgZGVmYXVsdER5bmFtaWNTdHlsZU9wdGlvbnM6IHRoaXMuc3RhdGUuZGVmYXVsdER5bmFtaWNQcm9wZXJ0aWVzW192ZWN0b3Jfc3R5bGVfZGVmYXVsdHMuVkVDVE9SX1NUWUxFUy5JQ09OX09SSUVOVEFUSU9OXS5vcHRpb25zCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5GcmFnbWVudCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfdmVjdG9yX3N0eWxlX3N5bWJvbF9lZGl0b3IuVmVjdG9yU3R5bGVTeW1ib2xFZGl0b3IsIHsKICAgICAgICBzdHlsZU9wdGlvbnM6IHRoaXMucHJvcHMuc3ltYm9sRGVzY3JpcHRvci5vcHRpb25zLAogICAgICAgIGhhbmRsZVByb3BlcnR5Q2hhbmdlOiB0aGlzLnByb3BzLmhhbmRsZVByb3BlcnR5Q2hhbmdlLAogICAgICAgIHN5bWJvbE9wdGlvbnM6IF9zeW1ib2xfdXRpbHMuU1lNQk9MX09QVElPTlMsCiAgICAgICAgaXNEYXJrTW9kZTogX2Nocm9tZS5kZWZhdWx0LmdldFVpU2V0dGluZ3NDbGllbnQoKS5nZXQoJ3RoZW1lOmRhcmtNb2RlJywgZmFsc2UpCiAgICAgIH0pLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3BhY2VyLCB7CiAgICAgICAgc2l6ZTogIm0iCiAgICAgIH0pLCB0aGlzLl9yZW5kZXJGaWxsQ29sb3IoKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgewogICAgICAgIHNpemU6ICJtIgogICAgICB9KSwgdGhpcy5fcmVuZGVyTGluZUNvbG9yKCksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTcGFjZXIsIHsKICAgICAgICBzaXplOiAibSIKICAgICAgfSksIHRoaXMuX3JlbmRlckxpbmVXaWR0aCgpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3BhY2VyLCB7CiAgICAgICAgc2l6ZTogIm0iCiAgICAgIH0pLCBpY29uT3JpZW50YXRpb24sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTcGFjZXIsIHsKICAgICAgICBzaXplOiAibSIKICAgICAgfSksIHRoaXMuX3JlbmRlclN5bWJvbFNpemUoKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgewogICAgICAgIHNpemU6ICJtIgogICAgICB9KSwgdGhpcy5fcmVuZGVyTGFiZWxQcm9wZXJ0aWVzKCkpOwogICAgfQogIH0sIHsKICAgIGtleTogIl9yZW5kZXJMaW5lUHJvcGVydGllcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3JlbmRlckxpbmVQcm9wZXJ0aWVzKCkgewogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRnJhZ21lbnQsIG51bGwsIHRoaXMuX3JlbmRlckxpbmVDb2xvcigpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3BhY2VyLCB7CiAgICAgICAgc2l6ZTogIm0iCiAgICAgIH0pLCB0aGlzLl9yZW5kZXJMaW5lV2lkdGgoKSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiX3JlbmRlclBvbHlnb25Qcm9wZXJ0aWVzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVuZGVyUG9seWdvblByb3BlcnRpZXMoKSB7CiAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5GcmFnbWVudCwgbnVsbCwgdGhpcy5fcmVuZGVyRmlsbENvbG9yKCksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTcGFjZXIsIHsKICAgICAgICBzaXplOiAibSIKICAgICAgfSksIHRoaXMuX3JlbmRlckxpbmVDb2xvcigpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3BhY2VyLCB7CiAgICAgICAgc2l6ZTogIm0iCiAgICAgIH0pLCB0aGlzLl9yZW5kZXJMaW5lV2lkdGgoKSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiX3JlbmRlclByb3BlcnRpZXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9yZW5kZXJQcm9wZXJ0aWVzKCkgewogICAgICB2YXIgX3RoaXMkc3RhdGUgPSB0aGlzLnN0YXRlLAogICAgICAgICAgc3VwcG9ydGVkRmVhdHVyZXMgPSBfdGhpcyRzdGF0ZS5zdXBwb3J0ZWRGZWF0dXJlcywKICAgICAgICAgIHNlbGVjdGVkRmVhdHVyZSA9IF90aGlzJHN0YXRlLnNlbGVjdGVkRmVhdHVyZTsKCiAgICAgIGlmICghc3VwcG9ydGVkRmVhdHVyZXMpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgaWYgKHN1cHBvcnRlZEZlYXR1cmVzLmxlbmd0aCA9PT0gMSkgewogICAgICAgIHN3aXRjaCAoc3VwcG9ydGVkRmVhdHVyZXNbMF0pIHsKICAgICAgICAgIGNhc2UgX3ZlY3Rvcl9mZWF0dXJlX3R5cGVzLlZFQ1RPUl9TSEFQRV9UWVBFUy5QT0lOVDoKICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlbmRlclBvaW50UHJvcGVydGllcygpOwoKICAgICAgICAgIGNhc2UgX3ZlY3Rvcl9mZWF0dXJlX3R5cGVzLlZFQ1RPUl9TSEFQRV9UWVBFUy5MSU5FOgogICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVuZGVyTGluZVByb3BlcnRpZXMoKTsKCiAgICAgICAgICBjYXNlIF92ZWN0b3JfZmVhdHVyZV90eXBlcy5WRUNUT1JfU0hBUEVfVFlQRVMuUE9MWUdPTjoKICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlbmRlclBvbHlnb25Qcm9wZXJ0aWVzKCk7CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgZmVhdHVyZUJ1dHRvbnMgPSBbewogICAgICAgIGlkOiBfdmVjdG9yX2ZlYXR1cmVfdHlwZXMuVkVDVE9SX1NIQVBFX1RZUEVTLlBPSU5ULAogICAgICAgIGxhYmVsOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWFwcy52ZWN0b3JTdHlsZUVkaXRvci5wb2ludExhYmVsJywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdQb2ludHMnCiAgICAgICAgfSkKICAgICAgfSwgewogICAgICAgIGlkOiBfdmVjdG9yX2ZlYXR1cmVfdHlwZXMuVkVDVE9SX1NIQVBFX1RZUEVTLkxJTkUsCiAgICAgICAgbGFiZWw6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tYXBzLnZlY3RvclN0eWxlRWRpdG9yLmxpbmVMYWJlbCcsIHsKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnTGluZXMnCiAgICAgICAgfSkKICAgICAgfSwgewogICAgICAgIGlkOiBfdmVjdG9yX2ZlYXR1cmVfdHlwZXMuVkVDVE9SX1NIQVBFX1RZUEVTLlBPTFlHT04sCiAgICAgICAgbGFiZWw6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tYXBzLnZlY3RvclN0eWxlRWRpdG9yLnBvbHlnb25MYWJlbCcsIHsKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnUG9seWdvbnMnCiAgICAgICAgfSkKICAgICAgfV07CgogICAgICB2YXIgc3R5bGVQcm9wZXJ0aWVzID0gdGhpcy5fcmVuZGVyUG9seWdvblByb3BlcnRpZXMoKTsKCiAgICAgIGlmIChzZWxlY3RlZEZlYXR1cmUgPT09IF92ZWN0b3JfZmVhdHVyZV90eXBlcy5WRUNUT1JfU0hBUEVfVFlQRVMuTElORSkgewogICAgICAgIHN0eWxlUHJvcGVydGllcyA9IHRoaXMuX3JlbmRlckxpbmVQcm9wZXJ0aWVzKCk7CiAgICAgIH0gZWxzZSBpZiAoc2VsZWN0ZWRGZWF0dXJlID09PSBfdmVjdG9yX2ZlYXR1cmVfdHlwZXMuVkVDVE9SX1NIQVBFX1RZUEVTLlBPSU5UKSB7CiAgICAgICAgc3R5bGVQcm9wZXJ0aWVzID0gdGhpcy5fcmVuZGVyUG9pbnRQcm9wZXJ0aWVzKCk7CiAgICAgIH0KCiAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5GcmFnbWVudCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUJ1dHRvbkdyb3VwLCB7CiAgICAgICAgbGVnZW5kOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWFwcy52ZWN0b3JTdHlsZUVkaXRvci5mZWF0dXJlVHlwZUJ1dHRvbkdyb3VwTGVnZW5kJywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICd2ZWN0b3IgZmVhdHVyZSBidXR0b24gZ3JvdXAnCiAgICAgICAgfSksCiAgICAgICAgb3B0aW9uczogZmVhdHVyZUJ1dHRvbnMsCiAgICAgICAgaWRTZWxlY3RlZDogc2VsZWN0ZWRGZWF0dXJlLAogICAgICAgIG9uQ2hhbmdlOiB0aGlzLl9oYW5kbGVTZWxlY3RlZEZlYXR1cmVDaGFuZ2UKICAgICAgfSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTcGFjZXIsIHsKICAgICAgICBzaXplOiAibSIKICAgICAgfSksIHN0eWxlUHJvcGVydGllcyk7CiAgICB9CiAgfSwgewogICAga2V5OiAiX3JlbmRlcklzVGltZUF3YXJlU3dpdGNoIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVuZGVySXNUaW1lQXdhcmVTd2l0Y2goKSB7CiAgICAgIGlmICghdGhpcy5wcm9wcy5zaG93SXNUaW1lQXdhcmUpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGb3JtUm93LCB7CiAgICAgICAgZGlzcGxheTogImNvbHVtbkNvbXByZXNzZWRTd2l0Y2giCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTd2l0Y2gsIHsKICAgICAgICBsYWJlbDogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1hcHMudmVjdG9yU3R5bGVFZGl0b3IuaXNUaW1lQXdhcmVMYWJlbCcsIHsKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnQXBwbHkgZ2xvYmFsIHRpbWUgdG8gc3R5bGUgbWV0YWRhdGEgcmVxdWVzdHMnCiAgICAgICAgfSksCiAgICAgICAgY2hlY2tlZDogdGhpcy5wcm9wcy5pc1RpbWVBd2FyZSwKICAgICAgICBvbkNoYW5nZTogdGhpcy5fb25Jc1RpbWVBd2FyZUNoYW5nZSwKICAgICAgICBjb21wcmVzc2VkOiB0cnVlCiAgICAgIH0pKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHsKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LkZyYWdtZW50LCBudWxsLCB0aGlzLl9yZW5kZXJQcm9wZXJ0aWVzKCksIHRoaXMuX3JlbmRlcklzVGltZUF3YXJlU3dpdGNoKCkpOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIFZlY3RvclN0eWxlRWRpdG9yOwp9KF9yZWFjdC5Db21wb25lbnQpOwoKZXhwb3J0cy5WZWN0b3JTdHlsZUVkaXRvciA9IFZlY3RvclN0eWxlRWRpdG9yOw=="},null]}