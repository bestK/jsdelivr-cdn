{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/siem/public/pages/detection_engine/rules/components/query_bar/index.js","dependencies":[{"path":"x-pack/legacy/plugins/siem/public/pages/detection_engine/rules/components/query_bar/index.js","mtime":1585205047867},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLlF1ZXJ5QmFyRGVmaW5lUnVsZSA9IHZvaWQgMDsKCnZhciBfZXVpID0gcmVxdWlyZSgiQGVsYXN0aWMvZXVpIik7Cgp2YXIgX2ZwID0gcmVxdWlyZSgibG9kYXNoL2ZwIik7Cgp2YXIgX3JlYWN0ID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgicmVhY3QiKSk7Cgp2YXIgX3J4anMgPSByZXF1aXJlKCJyeGpzIik7Cgp2YXIgX3N0eWxlZENvbXBvbmVudHMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoInN0eWxlZC1jb21wb25lbnRzIikpOwoKdmFyIF9wdWJsaWMgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi9zcmMvcGx1Z2lucy9kYXRhL3B1YmxpYyIpOwoKdmFyIF9vcGVuX3RpbWVsaW5lX21vZGFsID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vLi4vY29tcG9uZW50cy9vcGVuX3RpbWVsaW5lL29wZW5fdGltZWxpbmVfbW9kYWwiKTsKCnZhciBfcXVlcnlfYmFyID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vLi4vY29tcG9uZW50cy9xdWVyeV9iYXIiKTsKCnZhciBfaGVscGVycyA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uLy4uL2NvbXBvbmVudHMvdGltZWxpbmUvaGVscGVycyIpOwoKdmFyIF9xdWVyeV9iYXIyID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vLi4vY29tcG9uZW50cy90aW1lbGluZS9xdWVyeV9iYXIiKTsKCnZhciBfa2V1cnkgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi8uLi9saWIva2V1cnkiKTsKCnZhciBfa2liYW5hID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vLi4vbGliL2tpYmFuYSIpOwoKdmFyIF9zYXZlZF9xdWVyeV9zZXJ2aWNlcyA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uLy4uL3V0aWxzL3NhdmVkX3F1ZXJ5X3NlcnZpY2VzIik7Cgp2YXIgX3NoYXJlZF9pbXBvcnRzID0gcmVxdWlyZSgiLi4vc2hhcmVkX2ltcG9ydHMiKTsKCnZhciBpMThuID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgiLi90cmFuc2xhdGlvbnMiKSk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgewogIHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7CiAgICBkZWZhdWx0OiBvYmoKICB9Owp9CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsKICBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7CiAgICByZXR1cm4gb2JqOwogIH0gZWxzZSB7CiAgICB2YXIgbmV3T2JqID0ge307CgogICAgaWYgKG9iaiAhPSBudWxsKSB7CiAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHsKICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgewogICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvciA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpIDoge307CgogICAgICAgICAgaWYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSB7CiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmosIGtleSwgZGVzYyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBuZXdPYmpba2V5XSA9IG9ialtrZXldOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIG5ld09iai5kZWZhdWx0ID0gb2JqOwogICAgcmV0dXJuIG5ld09iajsKICB9Cn0KCmZ1bmN0aW9uIF90b0NvbnN1bWFibGVBcnJheShhcnIpIHsKICByZXR1cm4gX2FycmF5V2l0aG91dEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheShhcnIpIHx8IF9ub25JdGVyYWJsZVNwcmVhZCgpOwp9CgpmdW5jdGlvbiBfbm9uSXRlcmFibGVTcHJlYWQoKSB7CiAgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIHNwcmVhZCBub24taXRlcmFibGUgaW5zdGFuY2UiKTsKfQoKZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheShpdGVyKSB7CiAgaWYgKFN5bWJvbC5pdGVyYXRvciBpbiBPYmplY3QoaXRlcikgfHwgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGl0ZXIpID09PSAiW29iamVjdCBBcmd1bWVudHNdIikgcmV0dXJuIEFycmF5LmZyb20oaXRlcik7Cn0KCmZ1bmN0aW9uIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHsKICBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSB7CiAgICBmb3IgKHZhciBpID0gMCwgYXJyMiA9IG5ldyBBcnJheShhcnIubGVuZ3RoKTsgaSA8IGFyci5sZW5ndGg7IGkrKykgewogICAgICBhcnIyW2ldID0gYXJyW2ldOwogICAgfQoKICAgIHJldHVybiBhcnIyOwogIH0KfQoKZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7CiAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOwoKICBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgewogICAgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7CiAgICBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7CiAgICAgIHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOwogICAgfSk7CiAgICBrZXlzLnB1c2guYXBwbHkoa2V5cywgc3ltYm9scyk7CiAgfQoKICByZXR1cm4ga2V5czsKfQoKZnVuY3Rpb24gX29iamVjdFNwcmVhZCh0YXJnZXQpIHsKICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgewogICAgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXSAhPSBudWxsID8gYXJndW1lbnRzW2ldIDoge307CgogICAgaWYgKGkgJSAyKSB7CiAgICAgIG93bktleXMoc291cmNlLCB0cnVlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsKICAgICAgfSk7CiAgICB9IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKSB7CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoc291cmNlKSk7CiAgICB9IGVsc2UgewogICAgICBvd25LZXlzKHNvdXJjZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwga2V5KSk7CiAgICAgIH0pOwogICAgfQogIH0KCiAgcmV0dXJuIHRhcmdldDsKfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgewogIGlmIChrZXkgaW4gb2JqKSB7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsKICAgICAgdmFsdWU6IHZhbHVlLAogICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgIHdyaXRhYmxlOiB0cnVlCiAgICB9KTsKICB9IGVsc2UgewogICAgb2JqW2tleV0gPSB2YWx1ZTsKICB9CgogIHJldHVybiBvYmo7Cn0KCmZ1bmN0aW9uIF9zbGljZWRUb0FycmF5KGFyciwgaSkgewogIHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB8fCBfbm9uSXRlcmFibGVSZXN0KCk7Cn0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVJlc3QoKSB7CiAgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIGRlc3RydWN0dXJlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZSIpOwp9CgpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB7CiAgdmFyIF9hcnIgPSBbXTsKICB2YXIgX24gPSB0cnVlOwogIHZhciBfZCA9IGZhbHNlOwogIHZhciBfZSA9IHVuZGVmaW5lZDsKCiAgdHJ5IHsKICAgIGZvciAodmFyIF9pID0gYXJyW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3M7ICEoX24gPSAoX3MgPSBfaS5uZXh0KCkpLmRvbmUpOyBfbiA9IHRydWUpIHsKICAgICAgX2Fyci5wdXNoKF9zLnZhbHVlKTsKCiAgICAgIGlmIChpICYmIF9hcnIubGVuZ3RoID09PSBpKSBicmVhazsKICAgIH0KICB9IGNhdGNoIChlcnIpIHsKICAgIF9kID0gdHJ1ZTsKICAgIF9lID0gZXJyOwogIH0gZmluYWxseSB7CiAgICB0cnkgewogICAgICBpZiAoIV9uICYmIF9pWyJyZXR1cm4iXSAhPSBudWxsKSBfaVsicmV0dXJuIl0oKTsKICAgIH0gZmluYWxseSB7CiAgICAgIGlmIChfZCkgdGhyb3cgX2U7CiAgICB9CiAgfQoKICByZXR1cm4gX2FycjsKfQoKZnVuY3Rpb24gX2FycmF5V2l0aEhvbGVzKGFycikgewogIGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBhcnI7Cn0KCnZhciBTdHlsZWRFdWlGb3JtUm93ID0gKDAsIF9zdHlsZWRDb21wb25lbnRzLmRlZmF1bHQpKF9ldWkuRXVpRm9ybVJvdykud2l0aENvbmZpZyh7CiAgZGlzcGxheU5hbWU6ICJTdHlsZWRFdWlGb3JtUm93IiwKICBjb21wb25lbnRJZDogIngzZnpnMy0wIgp9KShbIi5rYm5UeXBlYWhlYWRfX2l0ZW1ze21heC1oZWlnaHQ6NDV2aCAhaW1wb3J0YW50O30uZ2xvYmFsUXVlcnlCYXJ7cGFkZGluZzo0cHggMHB4IDBweCAwcHg7LmtiblF1ZXJ5QmFyeyYgPiBkaXY6Zmlyc3QtY2hpbGR7bWFyZ2luOjBweCAwcHggMHB4IDRweDt9fX0iXSk7IC8vIFRPRE8gbmVlZCB0byBhZGQgZGlzYWJsZWQgaW4gdGhlIFNlYXJjaEJhcgoKdmFyIFF1ZXJ5QmFyRGVmaW5lUnVsZSA9IGZ1bmN0aW9uIFF1ZXJ5QmFyRGVmaW5lUnVsZShfcmVmKSB7CiAgdmFyIGJyb3dzZXJGaWVsZHMgPSBfcmVmLmJyb3dzZXJGaWVsZHMsCiAgICAgIGRhdGFUZXN0U3ViaiA9IF9yZWYuZGF0YVRlc3RTdWJqLAogICAgICBmaWVsZCA9IF9yZWYuZmllbGQsCiAgICAgIGlkQXJpYSA9IF9yZWYuaWRBcmlhLAogICAgICBpbmRleFBhdHRlcm4gPSBfcmVmLmluZGV4UGF0dGVybiwKICAgICAgX3JlZiRpc0xvYWRpbmcgPSBfcmVmLmlzTG9hZGluZywKICAgICAgaXNMb2FkaW5nID0gX3JlZiRpc0xvYWRpbmcgPT09IHZvaWQgMCA/IGZhbHNlIDogX3JlZiRpc0xvYWRpbmcsCiAgICAgIG9uQ2xvc2VUaW1lbGluZVNlYXJjaCA9IF9yZWYub25DbG9zZVRpbWVsaW5lU2VhcmNoLAogICAgICBfcmVmJG9wZW5UaW1lbGluZVNlYXIgPSBfcmVmLm9wZW5UaW1lbGluZVNlYXJjaCwKICAgICAgb3BlblRpbWVsaW5lU2VhcmNoID0gX3JlZiRvcGVuVGltZWxpbmVTZWFyID09PSB2b2lkIDAgPyBmYWxzZSA6IF9yZWYkb3BlblRpbWVsaW5lU2VhciwKICAgICAgcmVzaXplUGFyZW50Q29udGFpbmVyID0gX3JlZi5yZXNpemVQYXJlbnRDb250YWluZXI7CgogIHZhciBfdXNlU3RhdGUgPSAoMCwgX3JlYWN0LnVzZVN0YXRlKSgtMSksCiAgICAgIF91c2VTdGF0ZTIgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUsIDIpLAogICAgICBvcmlnaW5hbEhlaWdodCA9IF91c2VTdGF0ZTJbMF0sCiAgICAgIHNldE9yaWdpbmFsSGVpZ2h0ID0gX3VzZVN0YXRlMlsxXTsKCiAgdmFyIF91c2VTdGF0ZTMgPSAoMCwgX3JlYWN0LnVzZVN0YXRlKShmYWxzZSksCiAgICAgIF91c2VTdGF0ZTQgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUzLCAyKSwKICAgICAgbG9hZGluZ1RpbWVsaW5lID0gX3VzZVN0YXRlNFswXSwKICAgICAgc2V0TG9hZGluZ1RpbWVsaW5lID0gX3VzZVN0YXRlNFsxXTsKCiAgdmFyIF91c2VTdGF0ZTUgPSAoMCwgX3JlYWN0LnVzZVN0YXRlKShudWxsKSwKICAgICAgX3VzZVN0YXRlNiA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZTUsIDIpLAogICAgICBzYXZlZFF1ZXJ5ID0gX3VzZVN0YXRlNlswXSwKICAgICAgc2V0U2F2ZWRRdWVyeSA9IF91c2VTdGF0ZTZbMV07CgogIHZhciBfdXNlU3RhdGU3ID0gKDAsIF9yZWFjdC51c2VTdGF0ZSkoewogICAgcXVlcnk6ICcnLAogICAgbGFuZ3VhZ2U6ICdrdWVyeScKICB9KSwKICAgICAgX3VzZVN0YXRlOCA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZTcsIDIpLAogICAgICBxdWVyeURyYWZ0ID0gX3VzZVN0YXRlOFswXSwKICAgICAgc2V0UXVlcnlEcmFmdCA9IF91c2VTdGF0ZThbMV07CgogIHZhciBfZ2V0RmllbGRWYWxpZGl0eUFuZEUgPSAoMCwgX3NoYXJlZF9pbXBvcnRzLmdldEZpZWxkVmFsaWRpdHlBbmRFcnJvck1lc3NhZ2UpKGZpZWxkKSwKICAgICAgaXNJbnZhbGlkID0gX2dldEZpZWxkVmFsaWRpdHlBbmRFLmlzSW52YWxpZCwKICAgICAgZXJyb3JNZXNzYWdlID0gX2dldEZpZWxkVmFsaWRpdHlBbmRFLmVycm9yTWVzc2FnZTsKCiAgdmFyIGtpYmFuYSA9ICgwLCBfa2liYW5hLnVzZUtpYmFuYSkoKTsKCiAgdmFyIF91c2VTdGF0ZTkgPSAoMCwgX3JlYWN0LnVzZVN0YXRlKShuZXcgX3B1YmxpYy5GaWx0ZXJNYW5hZ2VyKGtpYmFuYS5zZXJ2aWNlcy51aVNldHRpbmdzKSksCiAgICAgIF91c2VTdGF0ZTEwID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlOSwgMSksCiAgICAgIGZpbHRlck1hbmFnZXIgPSBfdXNlU3RhdGUxMFswXTsKCiAgdmFyIHNhdmVkUXVlcnlTZXJ2aWNlcyA9ICgwLCBfc2F2ZWRfcXVlcnlfc2VydmljZXMudXNlU2F2ZWRRdWVyeVNlcnZpY2VzKSgpOwogICgwLCBfcmVhY3QudXNlRWZmZWN0KShmdW5jdGlvbiAoKSB7CiAgICB2YXIgaXNTdWJzY3JpYmVkID0gdHJ1ZTsKICAgIHZhciBzdWJzY3JpcHRpb25zID0gbmV3IF9yeGpzLlN1YnNjcmlwdGlvbigpOwogICAgZmlsdGVyTWFuYWdlci5zZXRGaWx0ZXJzKFtdKTsKICAgIHN1YnNjcmlwdGlvbnMuYWRkKGZpbHRlck1hbmFnZXIuZ2V0VXBkYXRlcyQoKS5zdWJzY3JpYmUoewogICAgICBuZXh0OiBmdW5jdGlvbiBuZXh0KCkgewogICAgICAgIGlmIChpc1N1YnNjcmliZWQpIHsKICAgICAgICAgIHZhciBuZXdGaWx0ZXJzID0gZmlsdGVyTWFuYWdlci5nZXRGaWx0ZXJzKCk7CiAgICAgICAgICB2YXIgX3JlZjIgPSBmaWVsZC52YWx1ZSwKICAgICAgICAgICAgICBmaWx0ZXJzID0gX3JlZjIuZmlsdGVyczsKCiAgICAgICAgICBpZiAoISgwLCBfZnAuaXNFcXVhbCkoZmlsdGVycywgbmV3RmlsdGVycykpIHsKICAgICAgICAgICAgZmllbGQuc2V0VmFsdWUoX29iamVjdFNwcmVhZCh7fSwgZmllbGQudmFsdWUsIHsKICAgICAgICAgICAgICBmaWx0ZXJzOiBuZXdGaWx0ZXJzCiAgICAgICAgICAgIH0pKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0pKTsKICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgIGlzU3Vic2NyaWJlZCA9IGZhbHNlOwogICAgICBzdWJzY3JpcHRpb25zLnVuc3Vic2NyaWJlKCk7CiAgICB9OwogIH0sIFtmaWVsZC52YWx1ZV0pOwogICgwLCBfcmVhY3QudXNlRWZmZWN0KShmdW5jdGlvbiAoKSB7CiAgICB2YXIgaXNTdWJzY3JpYmVkID0gdHJ1ZTsKCiAgICBmdW5jdGlvbiB1cGRhdGVGaWx0ZXJRdWVyeUZyb21WYWx1ZSgpIHsKICAgICAgdmFyIF9yZWYzLCBmaWx0ZXJzLCBxdWVyeSwgc2F2ZWRJZCwgbXlTYXZlZFF1ZXJ5OwoKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hc3luYyhmdW5jdGlvbiB1cGRhdGVGaWx0ZXJRdWVyeUZyb21WYWx1ZSQoX2NvbnRleHQpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgX3JlZjMgPSBmaWVsZC52YWx1ZSwgZmlsdGVycyA9IF9yZWYzLmZpbHRlcnMsIHF1ZXJ5ID0gX3JlZjMucXVlcnksIHNhdmVkSWQgPSBfcmVmMy5zYXZlZF9pZDsKCiAgICAgICAgICAgICAgaWYgKCEoMCwgX2ZwLmlzRXF1YWwpKHF1ZXJ5LCBxdWVyeURyYWZ0KSkgewogICAgICAgICAgICAgICAgc2V0UXVlcnlEcmFmdChxdWVyeSk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZiAoISgwLCBfZnAuaXNFcXVhbCkoZmlsdGVycywgZmlsdGVyTWFuYWdlci5nZXRGaWx0ZXJzKCkpKSB7CiAgICAgICAgICAgICAgICBmaWx0ZXJNYW5hZ2VyLnNldEZpbHRlcnMoZmlsdGVycyk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZiAoIShzYXZlZElkICE9IG51bGwgJiYgc2F2ZWRRdWVyeSAhPSBudWxsICYmIHNhdmVkSWQgIT09IHNhdmVkUXVlcnkuaWQgfHwgc2F2ZWRJZCAhPSBudWxsICYmIHNhdmVkUXVlcnkgPT0gbnVsbCkpIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxNjsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDQ7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDc7CiAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hd3JhcChzYXZlZFF1ZXJ5U2VydmljZXMuZ2V0U2F2ZWRRdWVyeShzYXZlZElkKSk7CgogICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgbXlTYXZlZFF1ZXJ5ID0gX2NvbnRleHQuc2VudDsKCiAgICAgICAgICAgICAgaWYgKGlzU3Vic2NyaWJlZCAmJiBteVNhdmVkUXVlcnkgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgc2V0U2F2ZWRRdWVyeShteVNhdmVkUXVlcnkpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE0OwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMTE7CiAgICAgICAgICAgICAgX2NvbnRleHQudDAgPSBfY29udGV4dFsiY2F0Y2giXSg0KTsKICAgICAgICAgICAgICBzZXRTYXZlZFF1ZXJ5KG51bGwpOwoKICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTc7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDE2OgogICAgICAgICAgICAgIGlmIChzYXZlZElkID09IG51bGwgJiYgc2F2ZWRRdWVyeSAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICBzZXRTYXZlZFF1ZXJ5KG51bGwpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNhc2UgMTc6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIG51bGwsIG51bGwsIFtbNCwgMTFdXSk7CiAgICB9CgogICAgdXBkYXRlRmlsdGVyUXVlcnlGcm9tVmFsdWUoKTsKICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgIGlzU3Vic2NyaWJlZCA9IGZhbHNlOwogICAgfTsKICB9LCBbZmllbGQudmFsdWVdKTsKICB2YXIgb25TdWJtaXRRdWVyeSA9ICgwLCBfcmVhY3QudXNlQ2FsbGJhY2spKGZ1bmN0aW9uIChuZXdRdWVyeSwgdGltZWZpbHRlcikgewogICAgdmFyIF9yZWY0ID0gZmllbGQudmFsdWUsCiAgICAgICAgcXVlcnkgPSBfcmVmNC5xdWVyeTsKCiAgICBpZiAoISgwLCBfZnAuaXNFcXVhbCkocXVlcnksIG5ld1F1ZXJ5KSkgewogICAgICBmaWVsZC5zZXRWYWx1ZShfb2JqZWN0U3ByZWFkKHt9LCBmaWVsZC52YWx1ZSwgewogICAgICAgIHF1ZXJ5OiBuZXdRdWVyeQogICAgICB9KSk7CiAgICB9CiAgfSwgW2ZpZWxkXSk7CiAgdmFyIG9uQ2hhbmdlZFF1ZXJ5ID0gKDAsIF9yZWFjdC51c2VDYWxsYmFjaykoZnVuY3Rpb24gKG5ld1F1ZXJ5KSB7CiAgICB2YXIgX3JlZjUgPSBmaWVsZC52YWx1ZSwKICAgICAgICBxdWVyeSA9IF9yZWY1LnF1ZXJ5OwoKICAgIGlmICghKDAsIF9mcC5pc0VxdWFsKShxdWVyeSwgbmV3UXVlcnkpKSB7CiAgICAgIGZpZWxkLnNldFZhbHVlKF9vYmplY3RTcHJlYWQoe30sIGZpZWxkLnZhbHVlLCB7CiAgICAgICAgcXVlcnk6IG5ld1F1ZXJ5CiAgICAgIH0pKTsKICAgIH0KICB9LCBbZmllbGRdKTsKICB2YXIgb25TYXZlZFF1ZXJ5ID0gKDAsIF9yZWFjdC51c2VDYWxsYmFjaykoZnVuY3Rpb24gKG5ld1NhdmVkUXVlcnkpIHsKICAgIGlmIChuZXdTYXZlZFF1ZXJ5ICE9IG51bGwpIHsKICAgICAgdmFyIF9yZWY2ID0gZmllbGQudmFsdWUsCiAgICAgICAgICBfc2F2ZWRJZCA9IF9yZWY2LnNhdmVkX2lkOwoKICAgICAgaWYgKG5ld1NhdmVkUXVlcnkuaWQgIT09IF9zYXZlZElkKSB7CiAgICAgICAgc2V0U2F2ZWRRdWVyeShuZXdTYXZlZFF1ZXJ5KTsKICAgICAgICBmaWVsZC5zZXRWYWx1ZSh7CiAgICAgICAgICBmaWx0ZXJzOiBuZXdTYXZlZFF1ZXJ5LmF0dHJpYnV0ZXMuZmlsdGVycywKICAgICAgICAgIHF1ZXJ5OiBuZXdTYXZlZFF1ZXJ5LmF0dHJpYnV0ZXMucXVlcnksCiAgICAgICAgICBzYXZlZF9pZDogbmV3U2F2ZWRRdWVyeS5pZAogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSwgW2ZpZWxkLnZhbHVlXSk7CiAgdmFyIG9uQ2xvc2VUaW1lbGluZU1vZGFsID0gKDAsIF9yZWFjdC51c2VDYWxsYmFjaykoZnVuY3Rpb24gKCkgewogICAgc2V0TG9hZGluZ1RpbWVsaW5lKHRydWUpOwogICAgb25DbG9zZVRpbWVsaW5lU2VhcmNoKCk7CiAgfSwgW29uQ2xvc2VUaW1lbGluZVNlYXJjaF0pOwogIHZhciBvbk9wZW5UaW1lbGluZSA9ICgwLCBfcmVhY3QudXNlQ2FsbGJhY2spKGZ1bmN0aW9uICh0aW1lbGluZSkgewogICAgdmFyIF9yZWY3LCBfdGltZWxpbmUka3FsUXVlcnkkZmksIF90aW1lbGluZSRrcWxRdWVyeSRmaTIsIF9yZWY4LCBfdGltZWxpbmUka3FsUXVlcnkkZmkzLCBfdGltZWxpbmUka3FsUXVlcnkkZmk0LCBfdGltZWxpbmUkZmlsdGVyczsKCiAgICBzZXRMb2FkaW5nVGltZWxpbmUoZmFsc2UpOwogICAgdmFyIG5ld1F1ZXJ5ID0gewogICAgICBxdWVyeTogKF9yZWY3ID0gKF90aW1lbGluZSRrcWxRdWVyeSRmaSA9IHRpbWVsaW5lLmtxbFF1ZXJ5LmZpbHRlclF1ZXJ5KSA9PT0gbnVsbCB8fCBfdGltZWxpbmUka3FsUXVlcnkkZmkgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfdGltZWxpbmUka3FsUXVlcnkkZmkyID0gX3RpbWVsaW5lJGtxbFF1ZXJ5JGZpLmt1ZXJ5KSA9PT0gbnVsbCB8fCBfdGltZWxpbmUka3FsUXVlcnkkZmkyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGltZWxpbmUka3FsUXVlcnkkZmkyLmV4cHJlc3Npb24pICE9PSBudWxsICYmIF9yZWY3ICE9PSB2b2lkIDAgPyBfcmVmNyA6ICcnLAogICAgICBsYW5ndWFnZTogKF9yZWY4ID0gKF90aW1lbGluZSRrcWxRdWVyeSRmaTMgPSB0aW1lbGluZS5rcWxRdWVyeS5maWx0ZXJRdWVyeSkgPT09IG51bGwgfHwgX3RpbWVsaW5lJGtxbFF1ZXJ5JGZpMyA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF90aW1lbGluZSRrcWxRdWVyeSRmaTQgPSBfdGltZWxpbmUka3FsUXVlcnkkZmkzLmt1ZXJ5KSA9PT0gbnVsbCB8fCBfdGltZWxpbmUka3FsUXVlcnkkZmk0ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGltZWxpbmUka3FsUXVlcnkkZmk0LmtpbmQpICE9PSBudWxsICYmIF9yZWY4ICE9PSB2b2lkIDAgPyBfcmVmOCA6ICdrdWVyeScKICAgIH07CiAgICB2YXIgZGF0YVByb3ZpZGVyc0RzbCA9IHRpbWVsaW5lLmRhdGFQcm92aWRlcnMgIT0gbnVsbCAmJiB0aW1lbGluZS5kYXRhUHJvdmlkZXJzLmxlbmd0aCA+IDAgPyAoMCwgX2tldXJ5LmNvbnZlcnRLdWVyeVRvRWxhc3RpY1NlYXJjaFF1ZXJ5KSgoMCwgX2hlbHBlcnMuYnVpbGRHbG9iYWxRdWVyeSkodGltZWxpbmUuZGF0YVByb3ZpZGVycywgYnJvd3NlckZpZWxkcyksIGluZGV4UGF0dGVybikgOiAnJzsKICAgIHZhciBuZXdGaWx0ZXJzID0gKF90aW1lbGluZSRmaWx0ZXJzID0gdGltZWxpbmUuZmlsdGVycykgIT09IG51bGwgJiYgX3RpbWVsaW5lJGZpbHRlcnMgIT09IHZvaWQgMCA/IF90aW1lbGluZSRmaWx0ZXJzIDogW107CiAgICBmaWVsZC5zZXRWYWx1ZSh7CiAgICAgIGZpbHRlcnM6IGRhdGFQcm92aWRlcnNEc2wgIT09ICcnID8gW10uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShuZXdGaWx0ZXJzKSwgWygwLCBfcXVlcnlfYmFyMi5nZXREYXRhUHJvdmlkZXJGaWx0ZXIpKGRhdGFQcm92aWRlcnNEc2wpXSkgOiBuZXdGaWx0ZXJzLAogICAgICBxdWVyeTogbmV3UXVlcnksCiAgICAgIHNhdmVkX2lkOiAnJwogICAgfSk7CiAgfSwgW2Jyb3dzZXJGaWVsZHMsIGZpZWxkLCBpbmRleFBhdHRlcm5dKTsKCiAgdmFyIG9uTXV0YXRpb24gPSBmdW5jdGlvbiBvbk11dGF0aW9uKGV2ZW50LCBvYnNlcnZlcikgewogICAgaWYgKHJlc2l6ZVBhcmVudENvbnRhaW5lciAhPSBudWxsKSB7CiAgICAgIHZhciBzdWdnZXN0aW9uQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2tiblR5cGVhaGVhZF9faXRlbXMnKTsKCiAgICAgIGlmIChzdWdnZXN0aW9uQ29udGFpbmVyICE9IG51bGwpIHsKICAgICAgICB2YXIgYm94ID0gc3VnZ2VzdGlvbkNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgICB2YXIgYWNjb3JkaW9uQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RlZmluZS1ydWxlJyk7CgogICAgICAgIGlmIChhY2NvcmRpb25Db250YWluZXIgIT0gbnVsbCkgewogICAgICAgICAgdmFyIGFjY29yZGlvbkJveCA9IGFjY29yZGlvbkNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKCiAgICAgICAgICBpZiAob3JpZ2luYWxIZWlnaHQgPT09IC0xIHx8IGFjY29yZGlvbkJveC5oZWlnaHQgPCBvcmlnaW5hbEhlaWdodCArIGJveC5oZWlnaHQpIHsKICAgICAgICAgICAgcmVzaXplUGFyZW50Q29udGFpbmVyKG9yaWdpbmFsSGVpZ2h0ICsgYm94LmhlaWdodCAtIDEwMCk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKG9yaWdpbmFsSGVpZ2h0ID09PSAtMSkgewogICAgICAgICAgICBzZXRPcmlnaW5hbEhlaWdodChhY2NvcmRpb25Cb3guaGVpZ2h0KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmVzaXplUGFyZW50Q29udGFpbmVyKC0xKTsKICAgICAgfQogICAgfQogIH07CgogIHZhciBhY3Rpb25UaW1lbGluZVRvSGlkZSA9ICgwLCBfcmVhY3QudXNlTWVtbykoZnVuY3Rpb24gKCkgewogICAgcmV0dXJuIFsnZHVwbGljYXRlJ107CiAgfSwgW10pOwogIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5kZWZhdWx0LkZyYWdtZW50LCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFN0eWxlZEV1aUZvcm1Sb3csIHsKICAgIGxhYmVsOiBmaWVsZC5sYWJlbCwKICAgIGxhYmVsQXBwZW5kOiBmaWVsZC5sYWJlbEFwcGVuZCwKICAgIGhlbHBUZXh0OiBmaWVsZC5oZWxwVGV4dCwKICAgIGVycm9yOiBlcnJvck1lc3NhZ2UsCiAgICBpc0ludmFsaWQ6IGlzSW52YWxpZCwKICAgIGZ1bGxXaWR0aDogdHJ1ZSwKICAgICJkYXRhLXRlc3Qtc3ViaiI6IGRhdGFUZXN0U3ViaiwKICAgIGRlc2NyaWJlZEJ5SWRzOiBpZEFyaWEgPyBbaWRBcmlhXSA6IHVuZGVmaW5lZAogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlNdXRhdGlvbk9ic2VydmVyLCB7CiAgICBvYnNlcnZlck9wdGlvbnM6IHsKICAgICAgc3VidHJlZTogdHJ1ZSwKICAgICAgYXR0cmlidXRlczogdHJ1ZSwKICAgICAgY2hpbGRMaXN0OiB0cnVlCiAgICB9LAogICAgb25NdXRhdGlvbjogb25NdXRhdGlvbgogIH0sIGZ1bmN0aW9uIChtdXRhdGlvblJlZikgewogICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgcmVmOiBtdXRhdGlvblJlZgogICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcXVlcnlfYmFyLlF1ZXJ5QmFyLCB7CiAgICAgIGluZGV4UGF0dGVybjogaW5kZXhQYXR0ZXJuLAogICAgICBpc0xvYWRpbmc6IGlzTG9hZGluZyB8fCBsb2FkaW5nVGltZWxpbmUsCiAgICAgIGlzUmVmcmVzaFBhdXNlZDogZmFsc2UsCiAgICAgIGZpbHRlclF1ZXJ5OiBxdWVyeURyYWZ0LAogICAgICBmaWx0ZXJNYW5hZ2VyOiBmaWx0ZXJNYW5hZ2VyLAogICAgICBmaWx0ZXJzOiBmaWx0ZXJNYW5hZ2VyLmdldEZpbHRlcnMoKSB8fCBbXSwKICAgICAgb25DaGFuZ2VkUXVlcnk6IG9uQ2hhbmdlZFF1ZXJ5LAogICAgICBvblN1Ym1pdFF1ZXJ5OiBvblN1Ym1pdFF1ZXJ5LAogICAgICBzYXZlZFF1ZXJ5OiBzYXZlZFF1ZXJ5LAogICAgICBvblNhdmVkUXVlcnk6IG9uU2F2ZWRRdWVyeSwKICAgICAgaGlkZVNhdmVkUXVlcnk6IGZhbHNlCiAgICB9KSk7CiAgfSkpLCBvcGVuVGltZWxpbmVTZWFyY2ggPyBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9vcGVuX3RpbWVsaW5lX21vZGFsLk9wZW5UaW1lbGluZU1vZGFsLCB7CiAgICBoaWRlQWN0aW9uczogYWN0aW9uVGltZWxpbmVUb0hpZGUsCiAgICBtb2RhbFRpdGxlOiBpMThuLklNUE9SVF9USU1FTElORV9NT0RBTCwKICAgIG9uQ2xvc2U6IG9uQ2xvc2VUaW1lbGluZU1vZGFsLAogICAgb25PcGVuOiBvbk9wZW5UaW1lbGluZQogIH0pIDogbnVsbCk7Cn07CgpleHBvcnRzLlF1ZXJ5QmFyRGVmaW5lUnVsZSA9IFF1ZXJ5QmFyRGVmaW5lUnVsZTs="},null]}