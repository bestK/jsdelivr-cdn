{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/file_upload/public/components/json_upload_and_parse.js","dependencies":[{"path":"x-pack/legacy/plugins/file_upload/public/components/json_upload_and_parse.js","mtime":1585205044181},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkpzb25VcGxvYWRBbmRQYXJzZSA9IHZvaWQgMDsKCnZhciBfcmVhY3QgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKCJyZWFjdCIpKTsKCnZhciBfaTE4biA9IHJlcXVpcmUoIkBrYm4vaTE4biIpOwoKdmFyIF9ldWkgPSByZXF1aXJlKCJAZWxhc3RpYy9ldWkiKTsKCnZhciBfcHJvcFR5cGVzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJwcm9wLXR5cGVzIikpOwoKdmFyIF9pbmRleGluZ19zZXJ2aWNlID0gcmVxdWlyZSgiLi4vdXRpbC9pbmRleGluZ19zZXJ2aWNlIik7Cgp2YXIgX2dlb19wcm9jZXNzaW5nID0gcmVxdWlyZSgiLi4vdXRpbC9nZW9fcHJvY2Vzc2luZyIpOwoKdmFyIF9pbmRleF9zZXR0aW5ncyA9IHJlcXVpcmUoIi4vaW5kZXhfc2V0dGluZ3MiKTsKCnZhciBfanNvbl9pbmRleF9maWxlX3BpY2tlciA9IHJlcXVpcmUoIi4vanNvbl9pbmRleF9maWxlX3BpY2tlciIpOwoKdmFyIF9qc29uX2ltcG9ydF9wcm9ncmVzcyA9IHJlcXVpcmUoIi4vanNvbl9pbXBvcnRfcHJvZ3Jlc3MiKTsKCnZhciBfbG9kYXNoID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJsb2Rhc2giKSk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7IGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsgcmV0dXJuIG9iajsgfSBlbHNlIHsgdmFyIG5ld09iaiA9IHt9OyBpZiAob2JqICE9IG51bGwpIHsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgeyB2YXIgZGVzYyA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSAmJiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID8gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIGtleSkgOiB7fTsgaWYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmosIGtleSwgZGVzYyk7IH0gZWxzZSB7IG5ld09ialtrZXldID0gb2JqW2tleV07IH0gfSB9IH0gbmV3T2JqLmRlZmF1bHQgPSBvYmo7IHJldHVybiBuZXdPYmo7IH0gfQoKZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gInN5bWJvbCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9CgpmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOyBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgeyB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsgaWYgKGVudW1lcmFibGVPbmx5KSBzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgeyByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsgfSk7IGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsgfSByZXR1cm4ga2V5czsgfQoKZnVuY3Rpb24gX29iamVjdFNwcmVhZCh0YXJnZXQpIHsgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXSAhPSBudWxsID8gYXJndW1lbnRzW2ldIDoge307IGlmIChpICUgMikgeyBvd25LZXlzKHNvdXJjZSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOyB9KTsgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgeyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpOyB9IGVsc2UgeyBvd25LZXlzKHNvdXJjZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOyB9KTsgfSB9IHJldHVybiB0YXJnZXQ7IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0KCmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9CgpmdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmIChjYWxsICYmIChfdHlwZW9mKGNhbGwpID09PSAib2JqZWN0IiB8fCB0eXBlb2YgY2FsbCA9PT0gImZ1bmN0aW9uIikpIHsgcmV0dXJuIGNhbGw7IH0gcmV0dXJuIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZik7IH0KCmZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IF9nZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IHJldHVybiBvLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2Yobyk7IH07IHJldHVybiBfZ2V0UHJvdG90eXBlT2Yobyk7IH0KCmZ1bmN0aW9uIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZikgeyBpZiAoc2VsZiA9PT0gdm9pZCAwKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcigidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkIik7IH0gcmV0dXJuIHNlbGY7IH0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICJmdW5jdGlvbiIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiIpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcyk7IH0KCmZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IF9zZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBvLl9fcHJvdG9fXyA9IHA7IHJldHVybiBvOyB9OyByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApOyB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7IGlmIChrZXkgaW4gb2JqKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgeyB2YWx1ZTogdmFsdWUsIGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUgfSk7IH0gZWxzZSB7IG9ialtrZXldID0gdmFsdWU7IH0gcmV0dXJuIG9iajsgfQoKdmFyIElOREVYSU5HX1NUQUdFID0gewogIElOREVYSU5HX1NUQVJURUQ6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5maWxlVXBsb2FkLmpzb25VcGxvYWRBbmRQYXJzZS5kYXRhSW5kZXhpbmdTdGFydGVkJywgewogICAgZGVmYXVsdE1lc3NhZ2U6ICdEYXRhIGluZGV4aW5nIHN0YXJ0ZWQnCiAgfSksCiAgV1JJVElOR19UT19JTkRFWDogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLmZpbGVVcGxvYWQuanNvblVwbG9hZEFuZFBhcnNlLndyaXRpbmdUb0luZGV4JywgewogICAgZGVmYXVsdE1lc3NhZ2U6ICdXcml0aW5nIHRvIGluZGV4JwogIH0pLAogIElOREVYSU5HX0NPTVBMRVRFOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suZmlsZVVwbG9hZC5qc29uVXBsb2FkQW5kUGFyc2UuaW5kZXhpbmdDb21wbGV0ZScsIHsKICAgIGRlZmF1bHRNZXNzYWdlOiAnSW5kZXhpbmcgY29tcGxldGUnCiAgfSksCiAgQ1JFQVRJTkdfSU5ERVhfUEFUVEVSTjogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLmZpbGVVcGxvYWQuanNvblVwbG9hZEFuZFBhcnNlLmNyZWF0aW5nSW5kZXhQYXR0ZXJuJywgewogICAgZGVmYXVsdE1lc3NhZ2U6ICdDcmVhdGluZyBpbmRleCBwYXR0ZXJuJwogIH0pLAogIElOREVYX1BBVFRFUk5fQ09NUExFVEU6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5maWxlVXBsb2FkLmpzb25VcGxvYWRBbmRQYXJzZS5pbmRleFBhdHRlcm5Db21wbGV0ZScsIHsKICAgIGRlZmF1bHRNZXNzYWdlOiAnSW5kZXggcGF0dGVybiBjb21wbGV0ZScKICB9KSwKICBJTkRFWElOR19FUlJPUjogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLmZpbGVVcGxvYWQuanNvblVwbG9hZEFuZFBhcnNlLmRhdGFJbmRleGluZ0Vycm9yJywgewogICAgZGVmYXVsdE1lc3NhZ2U6ICdEYXRhIGluZGV4aW5nIGVycm9yJwogIH0pLAogIElOREVYX1BBVFRFUk5fRVJST1I6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5maWxlVXBsb2FkLmpzb25VcGxvYWRBbmRQYXJzZS5pbmRleFBhdHRlcm5FcnJvcicsIHsKICAgIGRlZmF1bHRNZXNzYWdlOiAnSW5kZXggcGF0dGVybiBlcnJvcicKICB9KQp9OwoKdmFyIEpzb25VcGxvYWRBbmRQYXJzZSA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKF9Db21wb25lbnQpIHsKICBfaW5oZXJpdHMoSnNvblVwbG9hZEFuZFBhcnNlLCBfQ29tcG9uZW50KTsKCiAgZnVuY3Rpb24gSnNvblVwbG9hZEFuZFBhcnNlKCkgewogICAgdmFyIF9nZXRQcm90b3R5cGVPZjI7CgogICAgdmFyIF90aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBKc29uVXBsb2FkQW5kUGFyc2UpOwoKICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykgewogICAgICBhcmdzW19rZXldID0gYXJndW1lbnRzW19rZXldOwogICAgfQoKICAgIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKF9nZXRQcm90b3R5cGVPZjIgPSBfZ2V0UHJvdG90eXBlT2YoSnNvblVwbG9hZEFuZFBhcnNlKSkuY2FsbC5hcHBseShfZ2V0UHJvdG90eXBlT2YyLCBbdGhpc10uY29uY2F0KGFyZ3MpKSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAic3RhdGUiLCB7CiAgICAgIC8vIEZpbGUgc3RhdGUKICAgICAgZmlsZVJlZjogbnVsbCwKICAgICAgcGFyc2VkRmlsZTogbnVsbCwKICAgICAgaW5kZXhlZEZpbGU6IG51bGwsCiAgICAgIC8vIEluZGV4IHN0YXRlCiAgICAgIGluZGV4VHlwZXM6IFtdLAogICAgICBzZWxlY3RlZEluZGV4VHlwZTogJycsCiAgICAgIGluZGV4TmFtZTogJycsCiAgICAgIGluZGV4UmVxdWVzdEluRmxpZ2h0OiBmYWxzZSwKICAgICAgaW5kZXhQYXR0ZXJuUmVxdWVzdEluRmxpZ2h0OiBmYWxzZSwKICAgICAgaGFzSW5kZXhFcnJvcnM6IGZhbHNlLAogICAgICBpc0luZGV4UmVhZHk6IGZhbHNlLAogICAgICAvLyBQcm9ncmVzcy10cmFja2luZyBzdGF0ZQogICAgICBzaG93SW1wb3J0UHJvZ3Jlc3M6IGZhbHNlLAogICAgICBjdXJyZW50SW5kZXhpbmdTdGFnZTogSU5ERVhJTkdfU1RBR0UuSU5ERVhJTkdfU1RBUlRFRCwKICAgICAgaW5kZXhEYXRhUmVzcDogJycsCiAgICAgIGluZGV4UGF0dGVyblJlc3A6ICcnCiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJfcmVzZXRGaWxlQW5kSW5kZXhTZXR0aW5ncyIsIGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKF90aGlzLnByb3BzLm9uRmlsZVJlbW92ZSAmJiBfdGhpcy5zdGF0ZS5maWxlUmVmKSB7CiAgICAgICAgX3RoaXMucHJvcHMub25GaWxlUmVtb3ZlKF90aGlzLnN0YXRlLmZpbGVSZWYpOwogICAgICB9CgogICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgaW5kZXhUeXBlczogW10sCiAgICAgICAgc2VsZWN0ZWRJbmRleFR5cGU6ICcnLAogICAgICAgIGluZGV4TmFtZTogJycsCiAgICAgICAgaW5kZXhlZEZpbGU6IG51bGwsCiAgICAgICAgcGFyc2VkRmlsZTogbnVsbCwKICAgICAgICBmaWxlUmVmOiBudWxsCiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiX3NldFNlbGVjdGVkVHlwZSIsIGZ1bmN0aW9uIChfcmVmKSB7CiAgICAgIHZhciBzZWxlY3RlZEluZGV4VHlwZSA9IF9yZWYuc2VsZWN0ZWRJbmRleFR5cGUsCiAgICAgICAgICBpbmRleFR5cGVzID0gX3JlZi5pbmRleFR5cGVzOwoKICAgICAgaWYgKCFzZWxlY3RlZEluZGV4VHlwZSAmJiBpbmRleFR5cGVzLmxlbmd0aCkgewogICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgIHNlbGVjdGVkSW5kZXhUeXBlOiBpbmRleFR5cGVzWzBdCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIl9zZXRJbmRleFJlYWR5IiwgZnVuY3Rpb24gKF9yZWYyKSB7CiAgICAgIHZhciBwYXJzZWRGaWxlID0gX3JlZjIucGFyc2VkRmlsZSwKICAgICAgICAgIHNlbGVjdGVkSW5kZXhUeXBlID0gX3JlZjIuc2VsZWN0ZWRJbmRleFR5cGUsCiAgICAgICAgICBpbmRleE5hbWUgPSBfcmVmMi5pbmRleE5hbWUsCiAgICAgICAgICBoYXNJbmRleEVycm9ycyA9IF9yZWYyLmhhc0luZGV4RXJyb3JzLAogICAgICAgICAgaW5kZXhSZXF1ZXN0SW5GbGlnaHQgPSBfcmVmMi5pbmRleFJlcXVlc3RJbkZsaWdodCwKICAgICAgICAgIG9uSW5kZXhSZWFkeSA9IF9yZWYyLm9uSW5kZXhSZWFkeTsKICAgICAgdmFyIGlzSW5kZXhSZWFkeSA9ICEhcGFyc2VkRmlsZSAmJiAhIXNlbGVjdGVkSW5kZXhUeXBlICYmICEhaW5kZXhOYW1lICYmICFoYXNJbmRleEVycm9ycyAmJiAhaW5kZXhSZXF1ZXN0SW5GbGlnaHQ7CgogICAgICBpZiAoaXNJbmRleFJlYWR5ICE9PSBfdGhpcy5zdGF0ZS5pc0luZGV4UmVhZHkpIHsKICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICBpc0luZGV4UmVhZHk6IGlzSW5kZXhSZWFkeQogICAgICAgIH0pOwoKICAgICAgICBpZiAob25JbmRleFJlYWR5KSB7CiAgICAgICAgICBvbkluZGV4UmVhZHkoaXNJbmRleFJlYWR5KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIl9pbmRleERhdGEiLCBmdW5jdGlvbiBfY2FsbGVlKF9yZWYzKSB7CiAgICAgIHZhciBpbmRleGVkRmlsZSwgcGFyc2VkRmlsZSwgaW5kZXhSZXF1ZXN0SW5GbGlnaHQsIHRyYW5zZm9ybURldGFpbHMsIGluZGV4TmFtZSwgYXBwTmFtZSwgc2VsZWN0ZWRJbmRleFR5cGUsIGlzSW5kZXhpbmdUcmlnZ2VyZWQsIGlzSW5kZXhSZWFkeSwgb25JbmRleGluZ0NvbXBsZXRlLCBib29sQ3JlYXRlSW5kZXhQYXR0ZXJuLCBmaWxlc0FyZUVxdWFsLCBpbmRleERhdGFSZXNwLCBpbmRleFBhdHRlcm5SZXNwOwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmFzeW5jKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGluZGV4ZWRGaWxlID0gX3JlZjMuaW5kZXhlZEZpbGUsIHBhcnNlZEZpbGUgPSBfcmVmMy5wYXJzZWRGaWxlLCBpbmRleFJlcXVlc3RJbkZsaWdodCA9IF9yZWYzLmluZGV4UmVxdWVzdEluRmxpZ2h0LCB0cmFuc2Zvcm1EZXRhaWxzID0gX3JlZjMudHJhbnNmb3JtRGV0YWlscywgaW5kZXhOYW1lID0gX3JlZjMuaW5kZXhOYW1lLCBhcHBOYW1lID0gX3JlZjMuYXBwTmFtZSwgc2VsZWN0ZWRJbmRleFR5cGUgPSBfcmVmMy5zZWxlY3RlZEluZGV4VHlwZSwgaXNJbmRleGluZ1RyaWdnZXJlZCA9IF9yZWYzLmlzSW5kZXhpbmdUcmlnZ2VyZWQsIGlzSW5kZXhSZWFkeSA9IF9yZWYzLmlzSW5kZXhSZWFkeSwgb25JbmRleGluZ0NvbXBsZXRlID0gX3JlZjMub25JbmRleGluZ0NvbXBsZXRlLCBib29sQ3JlYXRlSW5kZXhQYXR0ZXJuID0gX3JlZjMuYm9vbENyZWF0ZUluZGV4UGF0dGVybjsKICAgICAgICAgICAgICAvLyBDaGVjayBpbmRleCByZWFkeQogICAgICAgICAgICAgIGZpbGVzQXJlRXF1YWwgPSBfbG9kYXNoLmRlZmF1bHQuaXNFcXVhbChpbmRleGVkRmlsZSwgcGFyc2VkRmlsZSk7CgogICAgICAgICAgICAgIGlmICghKCFpc0luZGV4aW5nVHJpZ2dlcmVkIHx8IGZpbGVzQXJlRXF1YWwgfHwgIWlzSW5kZXhSZWFkeSB8fCBpbmRleFJlcXVlc3RJbkZsaWdodCkpIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA0OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICBpbmRleFJlcXVlc3RJbkZsaWdodDogdHJ1ZSwKICAgICAgICAgICAgICAgIGN1cnJlbnRJbmRleGluZ1N0YWdlOiBJTkRFWElOR19TVEFHRS5XUklUSU5HX1RPX0lOREVYCiAgICAgICAgICAgICAgfSk7IC8vIEluZGV4IGRhdGEKCgogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA3OwogICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAoKDAsIF9pbmRleGluZ19zZXJ2aWNlLmluZGV4RGF0YSkocGFyc2VkRmlsZSwgdHJhbnNmb3JtRGV0YWlscywgaW5kZXhOYW1lLCBzZWxlY3RlZEluZGV4VHlwZSwgYXBwTmFtZSkpOwoKICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgIGluZGV4RGF0YVJlc3AgPSBfY29udGV4dC5zZW50OwoKICAgICAgICAgICAgICBpZiAoX3RoaXMuX2lzTW91bnRlZCkgewogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDEwOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgaWYgKGluZGV4RGF0YVJlc3Auc3VjY2VzcykgewogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE1OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICBpbmRleGVkRmlsZTogbnVsbCwKICAgICAgICAgICAgICAgIGluZGV4RGF0YVJlc3A6IGluZGV4RGF0YVJlc3AsCiAgICAgICAgICAgICAgICBpbmRleFJlcXVlc3RJbkZsaWdodDogZmFsc2UsCiAgICAgICAgICAgICAgICBjdXJyZW50SW5kZXhpbmdTdGFnZTogSU5ERVhJTkdfU1RBR0UuSU5ERVhJTkdfRVJST1IKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgX3RoaXMuX3Jlc2V0RmlsZUFuZEluZGV4U2V0dGluZ3MoKTsKCiAgICAgICAgICAgICAgaWYgKG9uSW5kZXhpbmdDb21wbGV0ZSkgewogICAgICAgICAgICAgICAgb25JbmRleGluZ0NvbXBsZXRlKHsKICAgICAgICAgICAgICAgICAgaW5kZXhEYXRhUmVzcDogaW5kZXhEYXRhUmVzcAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgIGNhc2UgMTU6CiAgICAgICAgICAgICAgLy8gSW5kZXggZGF0YSBzdWNjZXNzLiBVcGRhdGUgc3RhdGUgJiBjcmVhdGUgaW5kZXggcGF0dGVybgogICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgIGluZGV4RGF0YVJlc3A6IGluZGV4RGF0YVJlc3AsCiAgICAgICAgICAgICAgICBpbmRleGVkRmlsZTogcGFyc2VkRmlsZSwKICAgICAgICAgICAgICAgIGN1cnJlbnRJbmRleGluZ1N0YWdlOiBJTkRFWElOR19TVEFHRS5JTkRFWElOR19DT01QTEVURQogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBpZiAoIWJvb2xDcmVhdGVJbmRleFBhdHRlcm4pIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyMDsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE5OwogICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAoX3RoaXMuX2NyZWF0ZUluZGV4UGF0dGVybihfdGhpcy5zdGF0ZSkpOwoKICAgICAgICAgICAgY2FzZSAxOToKICAgICAgICAgICAgICBpbmRleFBhdHRlcm5SZXNwID0gX2NvbnRleHQuc2VudDsKCiAgICAgICAgICAgIGNhc2UgMjA6CiAgICAgICAgICAgICAgaWYgKCEoIV90aGlzLl9pc01vdW50ZWQgfHwgIWluZGV4UGF0dGVyblJlc3ApKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjI7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgY2FzZSAyMjoKICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICBjdXJyZW50SW5kZXhpbmdTdGFnZTogSU5ERVhJTkdfU1RBR0UuSU5ERVhfUEFUVEVSTl9DT01QTEVURQogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBpZiAob25JbmRleGluZ0NvbXBsZXRlKSB7CiAgICAgICAgICAgICAgICBvbkluZGV4aW5nQ29tcGxldGUoX29iamVjdFNwcmVhZCh7CiAgICAgICAgICAgICAgICAgIGluZGV4RGF0YVJlc3A6IGluZGV4RGF0YVJlc3AKICAgICAgICAgICAgICAgIH0sIGJvb2xDcmVhdGVJbmRleFBhdHRlcm4gPyB7CiAgICAgICAgICAgICAgICAgIGluZGV4UGF0dGVyblJlc3A6IGluZGV4UGF0dGVyblJlc3AKICAgICAgICAgICAgICAgIH0gOiB7fSkpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNhc2UgMjQ6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiX2NyZWF0ZUluZGV4UGF0dGVybiIsIGZ1bmN0aW9uIF9jYWxsZWUyKF9yZWY0KSB7CiAgICAgIHZhciBpbmRleE5hbWUsIGluZGV4UGF0dGVyblJlc3A7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXN5bmMoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGluZGV4TmFtZSA9IF9yZWY0LmluZGV4TmFtZTsKCiAgICAgICAgICAgICAgaWYgKF90aGlzLl9pc01vdW50ZWQpIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMzsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgIGluZGV4UGF0dGVyblJlcXVlc3RJbkZsaWdodDogdHJ1ZSwKICAgICAgICAgICAgICAgIGN1cnJlbnRJbmRleGluZ1N0YWdlOiBJTkRFWElOR19TVEFHRS5DUkVBVElOR19JTkRFWF9QQVRURVJOCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNjsKICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKCgwLCBfaW5kZXhpbmdfc2VydmljZS5jcmVhdGVJbmRleFBhdHRlcm4pKGluZGV4TmFtZSkpOwoKICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgIGluZGV4UGF0dGVyblJlc3AgPSBfY29udGV4dDIuc2VudDsKCiAgICAgICAgICAgICAgaWYgKF90aGlzLl9pc01vdW50ZWQpIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gOTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgIGluZGV4UGF0dGVyblJlc3A6IGluZGV4UGF0dGVyblJlc3AsCiAgICAgICAgICAgICAgICBpbmRleFBhdHRlcm5SZXF1ZXN0SW5GbGlnaHQ6IGZhbHNlCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIF90aGlzLl9yZXNldEZpbGVBbmRJbmRleFNldHRpbmdzKCk7CgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iLCBpbmRleFBhdHRlcm5SZXNwKTsKCiAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIl9zZXRJbmRleFR5cGVzIiwgZnVuY3Rpb24gKF9yZWY1KSB7CiAgICAgIHZhciB0cmFuc2Zvcm1EZXRhaWxzID0gX3JlZjUudHJhbnNmb3JtRGV0YWlscywKICAgICAgICAgIHBhcnNlZEZpbGUgPSBfcmVmNS5wYXJzZWRGaWxlOwoKICAgICAgaWYgKHBhcnNlZEZpbGUpIHsKICAgICAgICAvLyBVc2VyLXByb3ZpZGVkIGluZGV4IHR5cGVzCiAgICAgICAgaWYgKF90eXBlb2YodHJhbnNmb3JtRGV0YWlscykgPT09ICdvYmplY3QnKSB7CiAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgIGluZGV4VHlwZXM6IHRyYW5zZm9ybURldGFpbHMuaW5kZXhUeXBlcwogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vIEluY2x1ZGVkIGluZGV4IHR5cGVzCiAgICAgICAgICBzd2l0Y2ggKHRyYW5zZm9ybURldGFpbHMpIHsKICAgICAgICAgICAgY2FzZSAnZ2VvJzoKICAgICAgICAgICAgICB2YXIgZmVhdHVyZVR5cGVzID0gX2xvZGFzaC5kZWZhdWx0LnVuaXEocGFyc2VkRmlsZS5mZWF0dXJlcyA/IHBhcnNlZEZpbGUuZmVhdHVyZXMubWFwKGZ1bmN0aW9uIChfcmVmNikgewogICAgICAgICAgICAgICAgdmFyIGdlb21ldHJ5ID0gX3JlZjYuZ2VvbWV0cnk7CiAgICAgICAgICAgICAgICByZXR1cm4gZ2VvbWV0cnkudHlwZTsKICAgICAgICAgICAgICB9KSA6IFtwYXJzZWRGaWxlLmdlb21ldHJ5LnR5cGVdKTsKCiAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgaW5kZXhUeXBlczogKDAsIF9nZW9fcHJvY2Vzc2luZy5nZXRHZW9JbmRleFR5cGVzRm9yRmVhdHVyZXMpKGZlYXR1cmVUeXBlcykKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgIGluZGV4VHlwZXM6IFtdCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0pOwoKICAgIHJldHVybiBfdGhpczsKICB9CgogIF9jcmVhdGVDbGFzcyhKc29uVXBsb2FkQW5kUGFyc2UsIFt7CiAgICBrZXk6ICJjb21wb25lbnREaWRNb3VudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50RGlkTW91bnQoKSB7CiAgICAgIHRoaXMuX2lzTW91bnRlZCA9IHRydWU7CiAgICB9CiAgfSwgewogICAga2V5OiAiY29tcG9uZW50V2lsbFVubW91bnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxVbm1vdW50KCkgewogICAgICB0aGlzLl9pc01vdW50ZWQgPSBmYWxzZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjb21wb25lbnREaWRVcGRhdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudERpZFVwZGF0ZShwcmV2UHJvcHMsIHByZXZTdGF0ZSkgewogICAgICBpZiAoIV9sb2Rhc2guZGVmYXVsdC5pc0VxdWFsKHByZXZTdGF0ZS5wYXJzZWRGaWxlLCB0aGlzLnN0YXRlLnBhcnNlZEZpbGUpKSB7CiAgICAgICAgdGhpcy5fc2V0SW5kZXhUeXBlcyhfb2JqZWN0U3ByZWFkKHt9LCB0aGlzLnN0YXRlLCB7fSwgdGhpcy5wcm9wcykpOwogICAgICB9CgogICAgICB0aGlzLl9zZXRTZWxlY3RlZFR5cGUodGhpcy5zdGF0ZSk7CgogICAgICB0aGlzLl9zZXRJbmRleFJlYWR5KF9vYmplY3RTcHJlYWQoe30sIHRoaXMuc3RhdGUsIHt9LCB0aGlzLnByb3BzKSk7CgogICAgICB0aGlzLl9pbmRleERhdGEoX29iamVjdFNwcmVhZCh7fSwgdGhpcy5zdGF0ZSwge30sIHRoaXMucHJvcHMpKTsKCiAgICAgIGlmICh0aGlzLnByb3BzLmlzSW5kZXhpbmdUcmlnZ2VyZWQgJiYgIXRoaXMuc3RhdGUuc2hvd0ltcG9ydFByb2dyZXNzICYmIHRoaXMuX2lzTW91bnRlZCkgewogICAgICAgIHRoaXMuc2V0U3RhdGUoewogICAgICAgICAgc2hvd0ltcG9ydFByb2dyZXNzOiB0cnVlCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB2YXIgX3RoaXMkc3RhdGUgPSB0aGlzLnN0YXRlLAogICAgICAgICAgY3VycmVudEluZGV4aW5nU3RhZ2UgPSBfdGhpcyRzdGF0ZS5jdXJyZW50SW5kZXhpbmdTdGFnZSwKICAgICAgICAgIGluZGV4RGF0YVJlc3AgPSBfdGhpcyRzdGF0ZS5pbmRleERhdGFSZXNwLAogICAgICAgICAgaW5kZXhQYXR0ZXJuUmVzcCA9IF90aGlzJHN0YXRlLmluZGV4UGF0dGVyblJlc3AsCiAgICAgICAgICBmaWxlUmVmID0gX3RoaXMkc3RhdGUuZmlsZVJlZiwKICAgICAgICAgIGluZGV4TmFtZSA9IF90aGlzJHN0YXRlLmluZGV4TmFtZSwKICAgICAgICAgIGluZGV4VHlwZXMgPSBfdGhpcyRzdGF0ZS5pbmRleFR5cGVzLAogICAgICAgICAgc2hvd0ltcG9ydFByb2dyZXNzID0gX3RoaXMkc3RhdGUuc2hvd0ltcG9ydFByb2dyZXNzOwogICAgICB2YXIgX3RoaXMkcHJvcHMgPSB0aGlzLnByb3BzLAogICAgICAgICAgb25GaWxlVXBsb2FkID0gX3RoaXMkcHJvcHMub25GaWxlVXBsb2FkLAogICAgICAgICAgdHJhbnNmb3JtRGV0YWlscyA9IF90aGlzJHByb3BzLnRyYW5zZm9ybURldGFpbHM7CiAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRm9ybSwgbnVsbCwgc2hvd0ltcG9ydFByb2dyZXNzID8gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfanNvbl9pbXBvcnRfcHJvZ3Jlc3MuSnNvbkltcG9ydFByb2dyZXNzLCB7CiAgICAgICAgaW1wb3J0U3RhZ2U6IGN1cnJlbnRJbmRleGluZ1N0YWdlLAogICAgICAgIGluZGV4RGF0YVJlc3A6IGluZGV4RGF0YVJlc3AsCiAgICAgICAgaW5kZXhQYXR0ZXJuUmVzcDogaW5kZXhQYXR0ZXJuUmVzcCwKICAgICAgICBjb21wbGV0ZTogY3VycmVudEluZGV4aW5nU3RhZ2UgPT09IElOREVYSU5HX1NUQUdFLklOREVYX1BBVFRFUk5fQ09NUExFVEUgfHwgY3VycmVudEluZGV4aW5nU3RhZ2UgPT09IElOREVYSU5HX1NUQUdFLklOREVYSU5HX0VSUk9SLAogICAgICAgIGluZGV4TmFtZTogaW5kZXhOYW1lCiAgICAgIH0pIDogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRnJhZ21lbnQsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2pzb25faW5kZXhfZmlsZV9waWNrZXIuSnNvbkluZGV4RmlsZVBpY2tlciwgewogICAgICAgIG9uRmlsZVVwbG9hZDogb25GaWxlVXBsb2FkLAogICAgICAgIGZpbGVSZWY6IGZpbGVSZWYsCiAgICAgICAgc2V0SW5kZXhOYW1lOiBmdW5jdGlvbiBzZXRJbmRleE5hbWUoaW5kZXhOYW1lKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXMyLnNldFN0YXRlKHsKICAgICAgICAgICAgaW5kZXhOYW1lOiBpbmRleE5hbWUKICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgc2V0RmlsZVJlZjogZnVuY3Rpb24gc2V0RmlsZVJlZihmaWxlUmVmKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXMyLnNldFN0YXRlKHsKICAgICAgICAgICAgZmlsZVJlZjogZmlsZVJlZgogICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgICBzZXRQYXJzZWRGaWxlOiBmdW5jdGlvbiBzZXRQYXJzZWRGaWxlKHBhcnNlZEZpbGUpIHsKICAgICAgICAgIHJldHVybiBfdGhpczIuc2V0U3RhdGUoewogICAgICAgICAgICBwYXJzZWRGaWxlOiBwYXJzZWRGaWxlCiAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgICAgIHRyYW5zZm9ybURldGFpbHM6IHRyYW5zZm9ybURldGFpbHMsCiAgICAgICAgcmVzZXRGaWxlQW5kSW5kZXhTZXR0aW5nczogdGhpcy5fcmVzZXRGaWxlQW5kSW5kZXhTZXR0aW5ncwogICAgICB9KSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfaW5kZXhfc2V0dGluZ3MuSW5kZXhTZXR0aW5ncywgewogICAgICAgIGRpc2FibGVkOiAhZmlsZVJlZiwKICAgICAgICBpbmRleE5hbWU6IGluZGV4TmFtZSwKICAgICAgICBzZXRJbmRleE5hbWU6IGZ1bmN0aW9uIHNldEluZGV4TmFtZShpbmRleE5hbWUpIHsKICAgICAgICAgIHJldHVybiBfdGhpczIuc2V0U3RhdGUoewogICAgICAgICAgICBpbmRleE5hbWU6IGluZGV4TmFtZQogICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgICBpbmRleFR5cGVzOiBpbmRleFR5cGVzLAogICAgICAgIHNldFNlbGVjdGVkSW5kZXhUeXBlOiBmdW5jdGlvbiBzZXRTZWxlY3RlZEluZGV4VHlwZShzZWxlY3RlZEluZGV4VHlwZSkgewogICAgICAgICAgcmV0dXJuIF90aGlzMi5zZXRTdGF0ZSh7CiAgICAgICAgICAgIHNlbGVjdGVkSW5kZXhUeXBlOiBzZWxlY3RlZEluZGV4VHlwZQogICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgICBzZXRIYXNJbmRleEVycm9yczogZnVuY3Rpb24gc2V0SGFzSW5kZXhFcnJvcnMoaGFzSW5kZXhFcnJvcnMpIHsKICAgICAgICAgIHJldHVybiBfdGhpczIuc2V0U3RhdGUoewogICAgICAgICAgICBoYXNJbmRleEVycm9yczogaGFzSW5kZXhFcnJvcnMKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSkpKTsKICAgIH0KICB9XSk7CgogIHJldHVybiBKc29uVXBsb2FkQW5kUGFyc2U7Cn0oX3JlYWN0LkNvbXBvbmVudCk7CgpleHBvcnRzLkpzb25VcGxvYWRBbmRQYXJzZSA9IEpzb25VcGxvYWRBbmRQYXJzZTsKSnNvblVwbG9hZEFuZFBhcnNlLmRlZmF1bHRQcm9wcyA9IHsKICBpc0luZGV4aW5nVHJpZ2dlcmVkOiBmYWxzZSwKICBib29sQ3JlYXRlSW5kZXhQYXR0ZXJuOiB0cnVlCn07Ckpzb25VcGxvYWRBbmRQYXJzZS5wcm9wVHlwZXMgPSB7CiAgYXBwTmFtZTogX3Byb3BUeXBlcy5kZWZhdWx0LnN0cmluZywKICBpc0luZGV4aW5nVHJpZ2dlcmVkOiBfcHJvcFR5cGVzLmRlZmF1bHQuYm9vbCwKICBib29sQ3JlYXRlSW5kZXhQYXR0ZXJuOiBfcHJvcFR5cGVzLmRlZmF1bHQuYm9vbCwKICB0cmFuc2Zvcm1EZXRhaWxzOiBfcHJvcFR5cGVzLmRlZmF1bHQub25lT2ZUeXBlKFtfcHJvcFR5cGVzLmRlZmF1bHQuc3RyaW5nLCBfcHJvcFR5cGVzLmRlZmF1bHQub2JqZWN0XSksCiAgb25JbmRleFJlYWR5U3RhdHVzQ2hhbmdlOiBfcHJvcFR5cGVzLmRlZmF1bHQuZnVuYywKICBvbkluZGV4aW5nQ29tcGxldGU6IF9wcm9wVHlwZXMuZGVmYXVsdC5mdW5jLAogIG9uRmlsZVVwbG9hZDogX3Byb3BUeXBlcy5kZWZhdWx0LmZ1bmMsCiAgb25GaWxlUmVtb3ZlOiBfcHJvcFR5cGVzLmRlZmF1bHQuZnVuYwp9Ow=="},null]}