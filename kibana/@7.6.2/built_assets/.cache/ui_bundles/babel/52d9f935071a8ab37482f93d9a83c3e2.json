{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/ml/public/application/components/rule_editor/utils.js","dependencies":[{"path":"x-pack/legacy/plugins/ml/public/application/components/rule_editor/utils.js","mtime":1585205045509},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmdldE5ld0NvbmRpdGlvbkRlZmF1bHRzID0gZ2V0TmV3Q29uZGl0aW9uRGVmYXVsdHM7CmV4cG9ydHMuZ2V0TmV3UnVsZURlZmF1bHRzID0gZ2V0TmV3UnVsZURlZmF1bHRzOwpleHBvcnRzLmdldFNjb3BlRmllbGREZWZhdWx0cyA9IGdldFNjb3BlRmllbGREZWZhdWx0czsKZXhwb3J0cy5pc1ZhbGlkUnVsZSA9IGlzVmFsaWRSdWxlOwpleHBvcnRzLnNhdmVKb2JSdWxlID0gc2F2ZUpvYlJ1bGU7CmV4cG9ydHMuZGVsZXRlSm9iUnVsZSA9IGRlbGV0ZUpvYlJ1bGU7CmV4cG9ydHMudXBkYXRlSm9iUnVsZXMgPSB1cGRhdGVKb2JSdWxlczsKZXhwb3J0cy5hZGRJdGVtVG9GaWx0ZXIgPSBhZGRJdGVtVG9GaWx0ZXI7CmV4cG9ydHMuYnVpbGRSdWxlRGVzY3JpcHRpb24gPSBidWlsZFJ1bGVEZXNjcmlwdGlvbjsKZXhwb3J0cy5maWx0ZXJUeXBlVG9UZXh0ID0gZmlsdGVyVHlwZVRvVGV4dDsKZXhwb3J0cy5hcHBsaWVzVG9UZXh0ID0gYXBwbGllc1RvVGV4dDsKZXhwb3J0cy5vcGVyYXRvclRvVGV4dCA9IG9wZXJhdG9yVG9UZXh0OwpleHBvcnRzLmdldEFwcGxpZXNUb1ZhbHVlRnJvbUFub21hbHkgPSBnZXRBcHBsaWVzVG9WYWx1ZUZyb21Bbm9tYWx5OwoKdmFyIF9kZXRlY3Rvcl9ydWxlID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vY29tbW9uL2NvbnN0YW50cy9kZXRlY3Rvcl9ydWxlIik7Cgp2YXIgX2xvZGFzaCA9IHJlcXVpcmUoImxvZGFzaCIpOwoKdmFyIF9tbF9hcGlfc2VydmljZSA9IHJlcXVpcmUoIi4uLy4uL3NlcnZpY2VzL21sX2FwaV9zZXJ2aWNlIik7Cgp2YXIgX2pvYl9zZXJ2aWNlID0gcmVxdWlyZSgiLi4vLi4vc2VydmljZXMvam9iX3NlcnZpY2UiKTsKCnZhciBfaTE4biA9IHJlcXVpcmUoIkBrYm4vaTE4biIpOwoKdmFyIF9qb2JfdXRpbHMgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9jb21tb24vdXRpbC9qb2JfdXRpbHMiKTsKCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgeyB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7IGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7IHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOyBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOyB9KTsga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOyB9IHJldHVybiBrZXlzOyB9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsgaWYgKGkgJSAyKSB7IG93bktleXMoc291cmNlLCB0cnVlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7IH0pOyB9IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoc291cmNlKSk7IH0gZWxzZSB7IG93bktleXMoc291cmNlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwga2V5KSk7IH0pOyB9IH0gcmV0dXJuIHRhcmdldDsgfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgeyBpZiAoa2V5IGluIG9iaikgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsgdmFsdWU6IHZhbHVlLCBlbnVtZXJhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlIH0pOyB9IGVsc2UgeyBvYmpba2V5XSA9IHZhbHVlOyB9IHJldHVybiBvYmo7IH0KCmZ1bmN0aW9uIGdldE5ld0NvbmRpdGlvbkRlZmF1bHRzKCkgewogIHJldHVybiB7CiAgICBhcHBsaWVzX3RvOiBfZGV0ZWN0b3JfcnVsZS5BUFBMSUVTX1RPLkFDVFVBTCwKICAgIG9wZXJhdG9yOiBfZGV0ZWN0b3JfcnVsZS5PUEVSQVRPUi5MRVNTX1RIQU4sCiAgICB2YWx1ZTogMQogIH07Cn0KCmZ1bmN0aW9uIGdldE5ld1J1bGVEZWZhdWx0cygpIHsKICByZXR1cm4gewogICAgYWN0aW9uczogW19kZXRlY3Rvcl9ydWxlLkFDVElPTi5TS0lQX1JFU1VMVF0sCiAgICBjb25kaXRpb25zOiBbXQogIH07Cn0KCmZ1bmN0aW9uIGdldFNjb3BlRmllbGREZWZhdWx0cyhmaWx0ZXJMaXN0SWRzKSB7CiAgdmFyIGRlZmF1bHRzID0gewogICAgZmlsdGVyX3R5cGU6IF9kZXRlY3Rvcl9ydWxlLkZJTFRFUl9UWVBFLklOQ0xVREUsCiAgICBlbmFibGVkOiBmYWxzZSAvLyBVSS1vbmx5IHByb3BlcnR5IHRvIHNob3cgZmllbGQgYXMgZW5hYmxlZCBpbiBTY29wZSBzZWN0aW9uLgoKICB9OwoKICBpZiAoZmlsdGVyTGlzdElkcyAhPT0gdW5kZWZpbmVkICYmIGZpbHRlckxpc3RJZHMubGVuZ3RoID4gMCkgewogICAgZGVmYXVsdHMuZmlsdGVyX2lkID0gZmlsdGVyTGlzdElkc1swXTsKICB9CgogIHJldHVybiBkZWZhdWx0czsKfQoKZnVuY3Rpb24gaXNWYWxpZFJ1bGUocnVsZSkgewogIC8vIFJ1bnMgc2ltcGxlIGNoZWNrcyB0byBtYWtlIHN1cmUgdGhlIG1pbmltdW0gc2V0IG9mCiAgLy8gcHJvcGVydGllcyBoYXZlIHZhbHVlcyBpbiB0aGUgZWRpdGVkIHJ1bGUuCiAgdmFyIGlzVmFsaWQgPSBmYWxzZTsgLy8gQ2hlY2sgYW4gYWN0aW9uIGhhcyBiZWVuIHN1cHBsaWVkLgoKICB2YXIgYWN0aW9ucyA9IHJ1bGUuYWN0aW9uczsKCiAgaWYgKGFjdGlvbnMubGVuZ3RoID4gMCkgewogICAgLy8gQ2hlY2sgZWl0aGVyIGEgY29uZGl0aW9uIG9yIGEgc2NvcGUgcHJvcGVydHkgaGFzIGJlZW4gc2V0LgogICAgdmFyIGNvbmRpdGlvbnMgPSBydWxlLmNvbmRpdGlvbnM7CgogICAgaWYgKGNvbmRpdGlvbnMgIT09IHVuZGVmaW5lZCAmJiBjb25kaXRpb25zLmxlbmd0aCA+IDApIHsKICAgICAgaXNWYWxpZCA9IHRydWU7CiAgICB9IGVsc2UgewogICAgICB2YXIgc2NvcGUgPSBydWxlLnNjb3BlOwoKICAgICAgaWYgKHNjb3BlICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBpc1ZhbGlkID0gT2JqZWN0LmtleXMoc2NvcGUpLnNvbWUoZnVuY3Rpb24gKGZpZWxkKSB7CiAgICAgICAgICByZXR1cm4gc2NvcGVbZmllbGRdLmVuYWJsZWQgPT09IHRydWU7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9CgogIHJldHVybiBpc1ZhbGlkOwp9CgpmdW5jdGlvbiBzYXZlSm9iUnVsZShqb2IsIGRldGVjdG9ySW5kZXgsIHJ1bGVJbmRleCwgZWRpdGVkUnVsZSkgewogIHZhciBkZXRlY3RvciA9IGpvYi5hbmFseXNpc19jb25maWcuZGV0ZWN0b3JzW2RldGVjdG9ySW5kZXhdOyAvLyBGaWx0ZXIgb3V0IGFueSBzY29wZSBleHByZXNzaW9uIHdoZXJlIHRoZSBVST1zcGVjaWZpYyAnZW5hYmxlZCcKICAvLyBwcm9wZXJ0eSBpcyBzZXQgdG8gZmFsc2UuCgogIHZhciBjbG9uZWRSdWxlID0gKDAsIF9sb2Rhc2guY2xvbmVEZWVwKShlZGl0ZWRSdWxlKTsKICB2YXIgc2NvcGUgPSBjbG9uZWRSdWxlLnNjb3BlOwoKICBpZiAoc2NvcGUgIT09IHVuZGVmaW5lZCkgewogICAgT2JqZWN0LmtleXMoc2NvcGUpLmZvckVhY2goZnVuY3Rpb24gKGZpZWxkKSB7CiAgICAgIGlmIChzY29wZVtmaWVsZF0uZW5hYmxlZCA9PT0gZmFsc2UpIHsKICAgICAgICBkZWxldGUgc2NvcGVbZmllbGRdOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIFJlbW92ZSB0aGUgVUktb25seSBwcm9wZXJ0eSBhcyBpdCBpcyByZWplY3RlZCBieSB0aGUgZW5kcG9pbnQuCiAgICAgICAgZGVsZXRlIHNjb3BlW2ZpZWxkXS5lbmFibGVkOwogICAgICB9CiAgICB9KTsKICB9CgogIHZhciBydWxlcyA9IFtdOwoKICBpZiAoZGV0ZWN0b3IuY3VzdG9tX3J1bGVzID09PSB1bmRlZmluZWQpIHsKICAgIHJ1bGVzID0gW2Nsb25lZFJ1bGVdOwogIH0gZWxzZSB7CiAgICBydWxlcyA9ICgwLCBfbG9kYXNoLmNsb25lRGVlcCkoZGV0ZWN0b3IuY3VzdG9tX3J1bGVzKTsKCiAgICBpZiAocnVsZUluZGV4IDwgcnVsZXMubGVuZ3RoKSB7CiAgICAgIC8vIEVkaXQgdG8gYW4gZXhpc3RpbmcgcnVsZS4KICAgICAgcnVsZXNbcnVsZUluZGV4XSA9IGNsb25lZFJ1bGU7CiAgICB9IGVsc2UgewogICAgICAvLyBBZGQgYSBuZXcgcnVsZS4KICAgICAgcnVsZXMucHVzaChjbG9uZWRSdWxlKTsKICAgIH0KICB9CgogIHJldHVybiB1cGRhdGVKb2JSdWxlcyhqb2IsIGRldGVjdG9ySW5kZXgsIHJ1bGVzKTsKfQoKZnVuY3Rpb24gZGVsZXRlSm9iUnVsZShqb2IsIGRldGVjdG9ySW5kZXgsIHJ1bGVJbmRleCkgewogIHZhciBkZXRlY3RvciA9IGpvYi5hbmFseXNpc19jb25maWcuZGV0ZWN0b3JzW2RldGVjdG9ySW5kZXhdOwogIHZhciBjdXN0b21SdWxlcyA9IFtdOwoKICBpZiAoZGV0ZWN0b3IuY3VzdG9tX3J1bGVzICE9PSB1bmRlZmluZWQgJiYgcnVsZUluZGV4IDwgZGV0ZWN0b3IuY3VzdG9tX3J1bGVzLmxlbmd0aCkgewogICAgY3VzdG9tUnVsZXMgPSAoMCwgX2xvZGFzaC5jbG9uZURlZXApKGRldGVjdG9yLmN1c3RvbV9ydWxlcyk7CiAgICBjdXN0b21SdWxlcy5zcGxpY2UocnVsZUluZGV4LCAxKTsKICAgIHJldHVybiB1cGRhdGVKb2JSdWxlcyhqb2IsIGRldGVjdG9ySW5kZXgsIGN1c3RvbVJ1bGVzKTsKICB9IGVsc2UgewogICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcihfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWwucnVsZUVkaXRvci5kZWxldGVKb2JSdWxlLnJ1bGVOb0xvbmdlckV4aXN0c0Vycm9yTWVzc2FnZScsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdSdWxlIG5vIGxvbmdlciBleGlzdHMgZm9yIGRldGVjdG9yIGluZGV4IHtkZXRlY3RvckluZGV4fSBpbiBqb2Ige2pvYklkfScsCiAgICAgIHZhbHVlczogewogICAgICAgIGRldGVjdG9ySW5kZXg6IGRldGVjdG9ySW5kZXgsCiAgICAgICAgam9iSWQ6IGpvYi5qb2JfaWQKICAgICAgfQogICAgfSkpKTsKICB9Cn0KCmZ1bmN0aW9uIHVwZGF0ZUpvYlJ1bGVzKGpvYiwgZGV0ZWN0b3JJbmRleCwgcnVsZXMpIHsKICAvLyBQYXNzIGp1c3QgdGhlIGRldGVjdG9yIHdpdGggdGhlIGVkaXRlZCBydWxlIHRvIHRoZSB1cGRhdGVKb2IgZW5kcG9pbnQuCiAgdmFyIGpvYklkID0gam9iLmpvYl9pZDsKICB2YXIgam9iRGF0YSA9IHsKICAgIGRldGVjdG9yczogW3sKICAgICAgZGV0ZWN0b3JfaW5kZXg6IGRldGVjdG9ySW5kZXgsCiAgICAgIGN1c3RvbV9ydWxlczogcnVsZXMKICAgIH1dCiAgfTsKICB2YXIgY3VzdG9tU2V0dGluZ3MgPSB7fTsKCiAgaWYgKGpvYi5jdXN0b21fc2V0dGluZ3MgIT09IHVuZGVmaW5lZCkgewogICAgY3VzdG9tU2V0dGluZ3MgPSBfb2JqZWN0U3ByZWFkKHt9LCBqb2IuY3VzdG9tX3NldHRpbmdzKTsKICAgICgwLCBfam9iX3V0aWxzLnByb2Nlc3NDcmVhdGVkQnkpKGN1c3RvbVNldHRpbmdzKTsKICAgIGpvYkRhdGEuY3VzdG9tX3NldHRpbmdzID0gY3VzdG9tU2V0dGluZ3M7CiAgfQoKICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgX2pvYl9zZXJ2aWNlLm1sSm9iU2VydmljZS51cGRhdGVKb2Ioam9iSWQsIGpvYkRhdGEpLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHsKICAgICAgaWYgKHJlc3Auc3VjY2VzcykgewogICAgICAgIC8vIFJlZnJlc2ggdGhlIGpvYiBkYXRhIGluIHRoZSBqb2Igc2VydmljZSBiZWZvcmUgcmVzb2x2aW5nLgogICAgICAgIF9qb2Jfc2VydmljZS5tbEpvYlNlcnZpY2UucmVmcmVzaEpvYihqb2JJZCkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXNvbHZlKHsKICAgICAgICAgICAgc3VjY2VzczogdHJ1ZQogICAgICAgICAgfSk7CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlZnJlc2hSZXNwKSB7CiAgICAgICAgICByZWplY3QocmVmcmVzaFJlc3ApOwogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHJlamVjdChyZXNwKTsKICAgICAgfQogICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlc3ApIHsKICAgICAgcmVqZWN0KHJlc3ApOwogICAgfSk7CiAgfSk7Cn0gLy8gVXBkYXRlcyBhbiBNTCBmaWx0ZXIgdXNlZCBpbiB0aGUgc2NvcGUgcGFydCBvZiBhIHJ1bGUsCi8vIGFkZGluZyBhbiBpdGVtIHRvIHRoZSBmaWx0ZXIgd2l0aCB0aGUgc3BlY2lmaWVkIElELgoKCmZ1bmN0aW9uIGFkZEl0ZW1Ub0ZpbHRlcihpdGVtLCBmaWx0ZXJJZCkgewogIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICBfbWxfYXBpX3NlcnZpY2UubWwuZmlsdGVycy51cGRhdGVGaWx0ZXIoZmlsdGVySWQsIHVuZGVmaW5lZCwgW2l0ZW1dLCB1bmRlZmluZWQpLnRoZW4oZnVuY3Rpb24gKHVwZGF0ZWRGaWx0ZXIpIHsKICAgICAgcmVzb2x2ZSh1cGRhdGVkRmlsdGVyKTsKICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICByZWplY3QoZXJyb3IpOwogICAgfSk7CiAgfSk7Cn0KCmZ1bmN0aW9uIGJ1aWxkUnVsZURlc2NyaXB0aW9uKHJ1bGUpIHsKICB2YXIgYWN0aW9ucyA9IHJ1bGUuYWN0aW9ucywKICAgICAgY29uZGl0aW9ucyA9IHJ1bGUuY29uZGl0aW9ucywKICAgICAgc2NvcGUgPSBydWxlLnNjb3BlOwogIHZhciBhY3Rpb25zVGV4dCA9ICcnOwogIHZhciBjb25kaXRpb25zVGV4dCA9ICcnOwogIHZhciBmaWx0ZXJzVGV4dCA9ICcnOwogIGFjdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoYWN0aW9uLCBpKSB7CiAgICBpZiAoaSA+IDApIHsKICAgICAgYWN0aW9uc1RleHQgKz0gJyBBTkQgJzsKICAgIH0KCiAgICBzd2l0Y2ggKGFjdGlvbikgewogICAgICBjYXNlIF9kZXRlY3Rvcl9ydWxlLkFDVElPTi5TS0lQX1JFU1VMVDoKICAgICAgICBhY3Rpb25zVGV4dCArPSBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWwucnVsZUVkaXRvci5ydWxlRGVzY3JpcHRpb24ucmVzdWx0QWN0aW9uVHlwZVRleHQnLCB7CiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ3Jlc3VsdCcsCiAgICAgICAgICBkZXNjcmlwdGlvbjogJ1BhcnQgb2YgY29tcG9zaXRlIHRleHQ6IHhwYWNrLm1sLnJ1bGVFZGl0b3IucnVsZURlc2NyaXB0aW9uLlthY3Rpb25OYW1lXUFjdGlvblR5cGVUZXh0ICsnICsgJ3hwYWNrLm1sLnJ1bGVFZGl0b3IucnVsZURlc2NyaXB0aW9uLmNvbmRpdGlvbnNUZXh0ICsgeHBhY2subWwucnVsZUVkaXRvci5ydWxlRGVzY3JpcHRpb24uZmlsdGVyc1RleHQnCiAgICAgICAgfSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIF9kZXRlY3Rvcl9ydWxlLkFDVElPTi5TS0lQX01PREVMX1VQREFURToKICAgICAgICBhY3Rpb25zVGV4dCArPSBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWwucnVsZUVkaXRvci5ydWxlRGVzY3JpcHRpb24ubW9kZWxVcGRhdGVBY3Rpb25UeXBlVGV4dCcsIHsKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnbW9kZWwgdXBkYXRlJywKICAgICAgICAgIGRlc2NyaXB0aW9uOiAnUGFydCBvZiBjb21wb3NpdGUgdGV4dDogeHBhY2subWwucnVsZUVkaXRvci5ydWxlRGVzY3JpcHRpb24uW2FjdGlvbk5hbWVdQWN0aW9uVHlwZVRleHQgKyAnICsgJ3hwYWNrLm1sLnJ1bGVFZGl0b3IucnVsZURlc2NyaXB0aW9uLmNvbmRpdGlvbnNUZXh0ICsgeHBhY2subWwucnVsZUVkaXRvci5ydWxlRGVzY3JpcHRpb24uZmlsdGVyc1RleHQnCiAgICAgICAgfSk7CiAgICAgICAgYnJlYWs7CiAgICB9CiAgfSk7CgogIGlmIChjb25kaXRpb25zICE9PSB1bmRlZmluZWQpIHsKICAgIGNvbmRpdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoY29uZGl0aW9uLCBpKSB7CiAgICAgIGlmIChpID4gMCkgewogICAgICAgIGNvbmRpdGlvbnNUZXh0ICs9ICcgQU5EICc7CiAgICAgIH0KCiAgICAgIGNvbmRpdGlvbnNUZXh0ICs9IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tbC5ydWxlRWRpdG9yLnJ1bGVEZXNjcmlwdGlvbi5jb25kaXRpb25zVGV4dCcsIHsKICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ3thcHBsaWVzVG99IGlzIHtvcGVyYXRvcn0ge3ZhbHVlfScsCiAgICAgICAgdmFsdWVzOiB7CiAgICAgICAgICBhcHBsaWVzVG86IGFwcGxpZXNUb1RleHQoY29uZGl0aW9uLmFwcGxpZXNfdG8pLAogICAgICAgICAgb3BlcmF0b3I6IG9wZXJhdG9yVG9UZXh0KGNvbmRpdGlvbi5vcGVyYXRvciksCiAgICAgICAgICB2YWx1ZTogY29uZGl0aW9uLnZhbHVlCiAgICAgICAgfSwKICAgICAgICBkZXNjcmlwdGlvbjogJ1BhcnQgb2YgY29tcG9zaXRlIHRleHQ6IHhwYWNrLm1sLnJ1bGVFZGl0b3IucnVsZURlc2NyaXB0aW9uLlthY3Rpb25OYW1lXUFjdGlvblR5cGVUZXh0ICsgJyArICd4cGFjay5tbC5ydWxlRWRpdG9yLnJ1bGVEZXNjcmlwdGlvbi5jb25kaXRpb25zVGV4dCArIHhwYWNrLm1sLnJ1bGVFZGl0b3IucnVsZURlc2NyaXB0aW9uLmZpbHRlcnNUZXh0JwogICAgICB9KTsKICAgIH0pOwogIH0KCiAgaWYgKHNjb3BlICE9PSB1bmRlZmluZWQpIHsKICAgIGlmIChjb25kaXRpb25zICE9PSB1bmRlZmluZWQgJiYgY29uZGl0aW9ucy5sZW5ndGggPiAwKSB7CiAgICAgIGZpbHRlcnNUZXh0ICs9ICcgQU5EICc7CiAgICB9CgogICAgdmFyIGZpZWxkTmFtZXMgPSBPYmplY3Qua2V5cyhzY29wZSk7CiAgICBmaWVsZE5hbWVzLmZvckVhY2goZnVuY3Rpb24gKGZpZWxkTmFtZSwgaSkgewogICAgICBpZiAoaSA+IDApIHsKICAgICAgICBmaWx0ZXJzVGV4dCArPSAnIEFORCAnOwogICAgICB9CgogICAgICB2YXIgZmlsdGVyID0gc2NvcGVbZmllbGROYW1lXTsKICAgICAgZmlsdGVyc1RleHQgKz0gX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1sLnJ1bGVFZGl0b3IucnVsZURlc2NyaXB0aW9uLmZpbHRlcnNUZXh0JywgewogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAne2ZpZWxkTmFtZX0gaXMge2ZpbHRlclR5cGV9IHtmaWx0ZXJJZH0nLAogICAgICAgIHZhbHVlczogewogICAgICAgICAgZmllbGROYW1lOiBmaWVsZE5hbWUsCiAgICAgICAgICBmaWx0ZXJUeXBlOiBmaWx0ZXJUeXBlVG9UZXh0KGZpbHRlci5maWx0ZXJfdHlwZSksCiAgICAgICAgICBmaWx0ZXJJZDogZmlsdGVyLmZpbHRlcl9pZAogICAgICAgIH0sCiAgICAgICAgZGVzY3JpcHRpb246ICdQYXJ0IG9mIGNvbXBvc2l0ZSB0ZXh0OiB4cGFjay5tbC5ydWxlRWRpdG9yLnJ1bGVEZXNjcmlwdGlvbi5bYWN0aW9uTmFtZV1BY3Rpb25UeXBlVGV4dCArICcgKyAneHBhY2subWwucnVsZUVkaXRvci5ydWxlRGVzY3JpcHRpb24uY29uZGl0aW9uc1RleHQgKyB4cGFjay5tbC5ydWxlRWRpdG9yLnJ1bGVEZXNjcmlwdGlvbi5maWx0ZXJzVGV4dCcKICAgICAgfSk7CiAgICB9KTsKICB9CgogIHJldHVybiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWwucnVsZUVkaXRvci5ydWxlRGVzY3JpcHRpb24nLCB7CiAgICBkZWZhdWx0TWVzc2FnZTogJ3NraXAge2FjdGlvbnN9IHdoZW4ge2NvbmRpdGlvbnN9e2ZpbHRlcnN9JywKICAgIHZhbHVlczogewogICAgICBhY3Rpb25zOiBhY3Rpb25zVGV4dCwKICAgICAgY29uZGl0aW9uczogY29uZGl0aW9uc1RleHQsCiAgICAgIGZpbHRlcnM6IGZpbHRlcnNUZXh0CiAgICB9LAogICAgZGVzY3JpcHRpb246ICdDb21wb3NpdGUgdGV4dDogeHBhY2subWwucnVsZUVkaXRvci5ydWxlRGVzY3JpcHRpb24uW2FjdGlvbk5hbWVdQWN0aW9uVHlwZVRleHQgKyAnICsgJ3hwYWNrLm1sLnJ1bGVFZGl0b3IucnVsZURlc2NyaXB0aW9uLmNvbmRpdGlvbnNUZXh0ICsgeHBhY2subWwucnVsZUVkaXRvci5ydWxlRGVzY3JpcHRpb24uZmlsdGVyc1RleHQuJyArICcgKEV4YW1wbGU6IHNraXAgbW9kZWwgdXBkYXRlIHdoZW4gYWN0dWFsIGlzIGxlc3MgdGhhbiAxIEFORCBpcCBpcyBpbiB4eHgpJwogIH0pOwp9CgpmdW5jdGlvbiBmaWx0ZXJUeXBlVG9UZXh0KGZpbHRlclR5cGUpIHsKICBzd2l0Y2ggKGZpbHRlclR5cGUpIHsKICAgIGNhc2UgX2RldGVjdG9yX3J1bGUuRklMVEVSX1RZUEUuSU5DTFVERToKICAgICAgcmV0dXJuIF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tbC5ydWxlRWRpdG9yLmluY2x1ZGVGaWx0ZXJUeXBlVGV4dCcsIHsKICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ2luJwogICAgICB9KTsKCiAgICBjYXNlIF9kZXRlY3Rvcl9ydWxlLkZJTFRFUl9UWVBFLkVYQ0xVREU6CiAgICAgIHJldHVybiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWwucnVsZUVkaXRvci5leGNsdWRlRmlsdGVyVHlwZVRleHQnLCB7CiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdub3QgaW4nCiAgICAgIH0pOwoKICAgIGRlZmF1bHQ6CiAgICAgIHJldHVybiBmaWx0ZXJUeXBlICE9PSB1bmRlZmluZWQgPyBmaWx0ZXJUeXBlIDogJyc7CiAgfQp9CgpmdW5jdGlvbiBhcHBsaWVzVG9UZXh0KGFwcGxpZXNUbykgewogIHN3aXRjaCAoYXBwbGllc1RvKSB7CiAgICBjYXNlIF9kZXRlY3Rvcl9ydWxlLkFQUExJRVNfVE8uQUNUVUFMOgogICAgICByZXR1cm4gX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1sLnJ1bGVFZGl0b3IuYWN0dWFsQXBwbGllc1R5cGVUZXh0JywgewogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnYWN0dWFsJwogICAgICB9KTsKCiAgICBjYXNlIF9kZXRlY3Rvcl9ydWxlLkFQUExJRVNfVE8uVFlQSUNBTDoKICAgICAgcmV0dXJuIF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tbC5ydWxlRWRpdG9yLnR5cGljYWxBcHBsaWVzVHlwZVRleHQnLCB7CiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICd0eXBpY2FsJwogICAgICB9KTsKCiAgICBjYXNlIF9kZXRlY3Rvcl9ydWxlLkFQUExJRVNfVE8uRElGRl9GUk9NX1RZUElDQUw6CiAgICAgIHJldHVybiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWwucnVsZUVkaXRvci5kaWZmRnJvbVR5cGljYWxBcHBsaWVzVHlwZVRleHQnLCB7CiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdkaWZmIGZyb20gdHlwaWNhbCcKICAgICAgfSk7CgogICAgZGVmYXVsdDoKICAgICAgcmV0dXJuIGFwcGxpZXNUbyAhPT0gdW5kZWZpbmVkID8gYXBwbGllc1RvIDogJyc7CiAgfQp9CgpmdW5jdGlvbiBvcGVyYXRvclRvVGV4dChvcGVyYXRvcikgewogIHN3aXRjaCAob3BlcmF0b3IpIHsKICAgIGNhc2UgX2RldGVjdG9yX3J1bGUuT1BFUkFUT1IuTEVTU19USEFOOgogICAgICByZXR1cm4gX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1sLnJ1bGVFZGl0b3IubGVzc1RoYW5PcGVyYXRvclR5cGVUZXh0JywgewogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnbGVzcyB0aGFuJwogICAgICB9KTsKCiAgICBjYXNlIF9kZXRlY3Rvcl9ydWxlLk9QRVJBVE9SLkxFU1NfVEhBTl9PUl9FUVVBTDoKICAgICAgcmV0dXJuIF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tbC5ydWxlRWRpdG9yLmxlc3NUaGFuT3JFcXVhbFRvT3BlcmF0b3JUeXBlVGV4dCcsIHsKICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ2xlc3MgdGhhbiBvciBlcXVhbCB0bycKICAgICAgfSk7CgogICAgY2FzZSBfZGV0ZWN0b3JfcnVsZS5PUEVSQVRPUi5HUkVBVEVSX1RIQU46CiAgICAgIHJldHVybiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWwucnVsZUVkaXRvci5ncmVhdGVyVGhhbk9wZXJhdG9yVHlwZVRleHQnLCB7CiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdncmVhdGVyIHRoYW4nCiAgICAgIH0pOwoKICAgIGNhc2UgX2RldGVjdG9yX3J1bGUuT1BFUkFUT1IuR1JFQVRFUl9USEFOX09SX0VRVUFMOgogICAgICByZXR1cm4gX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1sLnJ1bGVFZGl0b3IuZ3JlYXRlclRoYW5PckVxdWFsVG9PcGVyYXRvclR5cGVUZXh0JywgewogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvJwogICAgICB9KTsKCiAgICBkZWZhdWx0OgogICAgICByZXR1cm4gb3BlcmF0b3IgIT09IHVuZGVmaW5lZCA/IG9wZXJhdG9yIDogJyc7CiAgfQp9IC8vIFJldHVybnMgdGhlIHZhbHVlIG9mIHRoZSBzZWxlY3RlZCAnYXBwbGllc190bycgZmllbGQgZnJvbSB0aGUKLy8gc2VsZWN0ZWQgYW5vbWFseSBpLmUuIHRoZSBhY3R1YWwsIHR5cGljYWwgb3IgZGlmZiBmcm9tIHR5cGljYWwuCgoKZnVuY3Rpb24gZ2V0QXBwbGllc1RvVmFsdWVGcm9tQW5vbWFseShhbm9tYWx5LCBhcHBsaWVzVG8pIHsKICB2YXIgYWN0dWFsVmFsdWU7CiAgdmFyIHR5cGljYWxWYWx1ZTsKICB2YXIgYWN0dWFsID0gYW5vbWFseS5hY3R1YWw7CgogIGlmIChhY3R1YWwgIT09IHVuZGVmaW5lZCkgewogICAgYWN0dWFsVmFsdWUgPSBBcnJheS5pc0FycmF5KGFjdHVhbCkgPyBhY3R1YWxbMF0gOiBhY3R1YWw7CiAgfQoKICB2YXIgdHlwaWNhbCA9IGFub21hbHkudHlwaWNhbDsKCiAgaWYgKHR5cGljYWwgIT09IHVuZGVmaW5lZCkgewogICAgdHlwaWNhbFZhbHVlID0gQXJyYXkuaXNBcnJheSh0eXBpY2FsKSA/IHR5cGljYWxbMF0gOiB0eXBpY2FsOwogIH0KCiAgc3dpdGNoIChhcHBsaWVzVG8pIHsKICAgIGNhc2UgX2RldGVjdG9yX3J1bGUuQVBQTElFU19UTy5BQ1RVQUw6CiAgICAgIHJldHVybiBhY3R1YWxWYWx1ZTsKCiAgICBjYXNlIF9kZXRlY3Rvcl9ydWxlLkFQUExJRVNfVE8uVFlQSUNBTDoKICAgICAgcmV0dXJuIHR5cGljYWxWYWx1ZTsKCiAgICBjYXNlIF9kZXRlY3Rvcl9ydWxlLkFQUExJRVNfVE8uRElGRl9GUk9NX1RZUElDQUw6CiAgICAgIGlmIChhY3R1YWwgIT09IHVuZGVmaW5lZCAmJiB0eXBpY2FsICE9PSB1bmRlZmluZWQpIHsKICAgICAgICByZXR1cm4gTWF0aC5hYnMoYWN0dWFsVmFsdWUgLSB0eXBpY2FsVmFsdWUpOwogICAgICB9CgogIH0KCiAgcmV0dXJuIHVuZGVmaW5lZDsKfQ=="},null]}