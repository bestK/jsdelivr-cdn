{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/ml/public/application/timeseriesexplorer/timeseriesexplorer_utils/timeseriesexplorer_utils.js","dependencies":[{"path":"x-pack/legacy/plugins/ml/public/application/timeseriesexplorer/timeseriesexplorer_utils/timeseriesexplorer_utils.js","mtime":1585205046004},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmNyZWF0ZVRpbWVTZXJpZXNKb2JEYXRhID0gY3JlYXRlVGltZVNlcmllc0pvYkRhdGE7CmV4cG9ydHMucHJvY2Vzc01ldHJpY1Bsb3RSZXN1bHRzID0gcHJvY2Vzc01ldHJpY1Bsb3RSZXN1bHRzOwpleHBvcnRzLnByb2Nlc3NGb3JlY2FzdFJlc3VsdHMgPSBwcm9jZXNzRm9yZWNhc3RSZXN1bHRzOwpleHBvcnRzLnByb2Nlc3NSZWNvcmRTY29yZVJlc3VsdHMgPSBwcm9jZXNzUmVjb3JkU2NvcmVSZXN1bHRzOwpleHBvcnRzLnByb2Nlc3NEYXRhRm9yRm9jdXNBbm9tYWxpZXMgPSBwcm9jZXNzRGF0YUZvckZvY3VzQW5vbWFsaWVzOwpleHBvcnRzLnByb2Nlc3NTY2hlZHVsZWRFdmVudHNGb3JDaGFydCA9IHByb2Nlc3NTY2hlZHVsZWRFdmVudHNGb3JDaGFydDsKZXhwb3J0cy5maW5kTmVhcmVzdENoYXJ0UG9pbnRUb1RpbWUgPSBmaW5kTmVhcmVzdENoYXJ0UG9pbnRUb1RpbWU7CmV4cG9ydHMuZmluZENoYXJ0UG9pbnRGb3JBbm9tYWx5VGltZSA9IGZpbmRDaGFydFBvaW50Rm9yQW5vbWFseVRpbWU7CmV4cG9ydHMuY2FsY3VsYXRlQWdncmVnYXRpb25JbnRlcnZhbCA9IGNhbGN1bGF0ZUFnZ3JlZ2F0aW9uSW50ZXJ2YWw7CmV4cG9ydHMuY2FsY3VsYXRlRGVmYXVsdEZvY3VzUmFuZ2UgPSBjYWxjdWxhdGVEZWZhdWx0Rm9jdXNSYW5nZTsKZXhwb3J0cy5jYWxjdWxhdGVJbml0aWFsRm9jdXNSYW5nZSA9IGNhbGN1bGF0ZUluaXRpYWxGb2N1c1JhbmdlOwpleHBvcnRzLmdldEF1dG9ab29tRHVyYXRpb24gPSBnZXRBdXRvWm9vbUR1cmF0aW9uOwoKdmFyIF9sb2Rhc2ggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoImxvZGFzaCIpKTsKCnZhciBfbW9tZW50VGltZXpvbmUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIm1vbWVudC10aW1lem9uZSIpKTsKCnZhciBfam9iX3V0aWxzID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vY29tbW9uL3V0aWwvam9iX3V0aWxzIik7Cgp2YXIgX3BhcnNlX2ludGVydmFsID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vY29tbW9uL3V0aWwvcGFyc2VfaW50ZXJ2YWwiKTsKCnZhciBfdGltZV9idWNrZXRzID0gcmVxdWlyZSgiLi4vLi4vdXRpbC90aW1lX2J1Y2tldHMiKTsKCnZhciBfdGltZXNlcmllc2V4cGxvcmVyX2NvbnN0YW50cyA9IHJlcXVpcmUoIi4uL3RpbWVzZXJpZXNleHBsb3Jlcl9jb25zdGFudHMiKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgovKgogKiBDb3B5cmlnaHQgRWxhc3RpY3NlYXJjaCBCLlYuIGFuZC9vciBsaWNlbnNlZCB0byBFbGFzdGljc2VhcmNoIEIuVi4gdW5kZXIgb25lCiAqIG9yIG1vcmUgY29udHJpYnV0b3IgbGljZW5zZSBhZ3JlZW1lbnRzLiBMaWNlbnNlZCB1bmRlciB0aGUgRWxhc3RpYyBMaWNlbnNlOwogKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIEVsYXN0aWMgTGljZW5zZS4KICovCgovKgogKiBDb250YWlucyBhIG51bWJlciBvZiB1dGlsaXR5IGZ1bmN0aW9ucyB1c2VkIGZvciBwcm9jZXNzaW5nCiAqIHRoZSBkYXRhIGZvciBleHBsb3JpbmcgYSB0aW1lIHNlcmllcyBpbiB0aGUgU2luZ2xlIE1ldHJpYwogKiBWaWV3ZXIgZGFzaGJvYXJkLgogKi8KLy8gY3JlYXRlIG5ldyBqb2Igb2JqZWN0cyBiYXNlZCBvbiBzdGFuZGFyZCBqb2IgY29uZmlnIG9iamVjdHMKLy8gbmV3IGpvYiBvYmplY3RzIGp1c3QgY29udGFpbiBqb2IgaWQsIGJ1Y2tldCBzcGFuIGluIHNlY29uZHMgYW5kIGEgc2VsZWN0ZWQgZmxhZy4KLy8gb25seSB0aW1lIHNlcmllcyB2aWV3IGpvYnMgYXJlIGFsbG93ZWQKZnVuY3Rpb24gY3JlYXRlVGltZVNlcmllc0pvYkRhdGEoam9icykgewogIHZhciBzaW5nbGVUaW1lU2VyaWVzSm9icyA9IGpvYnMuZmlsdGVyKF9qb2JfdXRpbHMuaXNUaW1lU2VyaWVzVmlld0pvYik7CiAgcmV0dXJuIHNpbmdsZVRpbWVTZXJpZXNKb2JzLm1hcChmdW5jdGlvbiAoam9iKSB7CiAgICB2YXIgYnVja2V0U3BhbiA9ICgwLCBfcGFyc2VfaW50ZXJ2YWwucGFyc2VJbnRlcnZhbCkoam9iLmFuYWx5c2lzX2NvbmZpZy5idWNrZXRfc3Bhbik7CiAgICByZXR1cm4gewogICAgICBpZDogam9iLmpvYl9pZCwKICAgICAgc2VsZWN0ZWQ6IGZhbHNlLAogICAgICBidWNrZXRTcGFuU2Vjb25kczogYnVja2V0U3Bhbi5hc1NlY29uZHMoKQogICAgfTsKICB9KTsKfSAvLyBSZXR1cm4gZGF0YXNldCBpbiBmb3JtYXQgdXNlZCBieSB0aGUgc2luZ2xlIG1ldHJpYyBjaGFydC4KLy8gaS5lLiBhcnJheSBvZiBPYmplY3RzIHdpdGgga2V5cyBkYXRlIChKYXZhU2NyaXB0IGRhdGUpIGFuZCB2YWx1ZSwKLy8gcGx1cyBsb3dlciBhbmQgdXBwZXIga2V5cyBpZiBtb2RlbCBwbG90IGlzIGVuYWJsZWQgZm9yIHRoZSBzZXJpZXMuCgoKZnVuY3Rpb24gcHJvY2Vzc01ldHJpY1Bsb3RSZXN1bHRzKG1ldHJpY1Bsb3REYXRhLCBtb2RlbFBsb3RFbmFibGVkKSB7CiAgdmFyIG1ldHJpY1Bsb3RDaGFydERhdGEgPSBbXTsKCiAgaWYgKG1vZGVsUGxvdEVuYWJsZWQgPT09IHRydWUpIHsKICAgIF9sb2Rhc2guZGVmYXVsdC5lYWNoKG1ldHJpY1Bsb3REYXRhLCBmdW5jdGlvbiAoZGF0YUZvclRpbWUsIHRpbWUpIHsKICAgICAgbWV0cmljUGxvdENoYXJ0RGF0YS5wdXNoKHsKICAgICAgICBkYXRlOiBuZXcgRGF0ZSgrdGltZSksCiAgICAgICAgbG93ZXI6IGRhdGFGb3JUaW1lLm1vZGVsTG93ZXIsCiAgICAgICAgdmFsdWU6IGRhdGFGb3JUaW1lLmFjdHVhbCwKICAgICAgICB1cHBlcjogZGF0YUZvclRpbWUubW9kZWxVcHBlcgogICAgICB9KTsKICAgIH0pOwogIH0gZWxzZSB7CiAgICBfbG9kYXNoLmRlZmF1bHQuZWFjaChtZXRyaWNQbG90RGF0YSwgZnVuY3Rpb24gKGRhdGFGb3JUaW1lLCB0aW1lKSB7CiAgICAgIG1ldHJpY1Bsb3RDaGFydERhdGEucHVzaCh7CiAgICAgICAgZGF0ZTogbmV3IERhdGUoK3RpbWUpLAogICAgICAgIHZhbHVlOiBkYXRhRm9yVGltZS5hY3R1YWwKICAgICAgfSk7CiAgICB9KTsKICB9CgogIHJldHVybiBtZXRyaWNQbG90Q2hhcnREYXRhOwp9IC8vIFJldHVybnMgZm9yZWNhc3QgZGF0YXNldCBpbiBmb3JtYXQgdXNlZCBieSB0aGUgc2luZ2xlIG1ldHJpYyBjaGFydC4KLy8gaS5lLiBhcnJheSBvZiBPYmplY3RzIHdpdGgga2V5cyBkYXRlIChKYXZhU2NyaXB0IGRhdGUpLCBpc0ZvcmVjYXN0LAovLyB2YWx1ZSwgbG93ZXIgYW5kIHVwcGVyIGtleXMuCgoKZnVuY3Rpb24gcHJvY2Vzc0ZvcmVjYXN0UmVzdWx0cyhmb3JlY2FzdERhdGEpIHsKICB2YXIgZm9yZWNhc3RQbG90Q2hhcnREYXRhID0gW107CgogIF9sb2Rhc2guZGVmYXVsdC5lYWNoKGZvcmVjYXN0RGF0YSwgZnVuY3Rpb24gKGRhdGFGb3JUaW1lLCB0aW1lKSB7CiAgICBmb3JlY2FzdFBsb3RDaGFydERhdGEucHVzaCh7CiAgICAgIGRhdGU6IG5ldyBEYXRlKCt0aW1lKSwKICAgICAgaXNGb3JlY2FzdDogdHJ1ZSwKICAgICAgbG93ZXI6IGRhdGFGb3JUaW1lLmZvcmVjYXN0TG93ZXIsCiAgICAgIHZhbHVlOiBkYXRhRm9yVGltZS5wcmVkaWN0aW9uLAogICAgICB1cHBlcjogZGF0YUZvclRpbWUuZm9yZWNhc3RVcHBlcgogICAgfSk7CiAgfSk7CgogIHJldHVybiBmb3JlY2FzdFBsb3RDaGFydERhdGE7Cn0gLy8gUmV0dXJuIGRhdGFzZXQgaW4gZm9ybWF0IHVzZWQgYnkgdGhlIHN3aW1sYW5lLgovLyBpLmUuIGFycmF5IG9mIE9iamVjdHMgd2l0aCBrZXlzIGRhdGUgKEphdmFTY3JpcHQgZGF0ZSkgYW5kIHNjb3JlLgoKCmZ1bmN0aW9uIHByb2Nlc3NSZWNvcmRTY29yZVJlc3VsdHMoc2NvcmVEYXRhKSB7CiAgdmFyIGJ1Y2tldFNjb3JlRGF0YSA9IFtdOwoKICBfbG9kYXNoLmRlZmF1bHQuZWFjaChzY29yZURhdGEsIGZ1bmN0aW9uIChkYXRhRm9yVGltZSwgdGltZSkgewogICAgYnVja2V0U2NvcmVEYXRhLnB1c2goewogICAgICBkYXRlOiBuZXcgRGF0ZSgrdGltZSksCiAgICAgIHNjb3JlOiBkYXRhRm9yVGltZS5zY29yZQogICAgfSk7CiAgfSk7CgogIHJldHVybiBidWNrZXRTY29yZURhdGE7Cn0gLy8gVXNlcyBkYXRhIGZyb20gdGhlIGxpc3Qgb2YgYW5vbWFseSByZWNvcmRzIHRvIGFkZCBhbm9tYWx5U2NvcmUsCi8vIGZ1bmN0aW9uLCBhY3R1YWwgYW5kIHR5cGljYWwgcHJvcGVydGllcywgcGx1cyBjYXVzZXMgYW5kIG11bHRpLWJ1Y2tldAovLyBpbmZvIGlmIGFwcGxpY2FibGUsIHRvIHRoZSBjaGFydERhdGEgZW50cmllcyBmb3IgYW5vbWFsb3VzIGJ1Y2tldHMuCgoKZnVuY3Rpb24gcHJvY2Vzc0RhdGFGb3JGb2N1c0Fub21hbGllcyhjaGFydERhdGEsIGFub21hbHlSZWNvcmRzLCBhZ2dyZWdhdGlvbkludGVydmFsLCBtb2RlbFBsb3RFbmFibGVkKSB7CiAgdmFyIHRpbWVzVG9BZGRQb2ludHNGb3IgPSBbXTsgLy8gSXRlcmF0ZSB0aHJvdWdoIHRoZSBhbm9tYWx5IHJlY29yZHMgbWFraW5nIHN1cmUgd2UgaGF2ZSBjaGFydCBwb2ludHMgZm9yIGVhY2ggYW5vbWFseS4KCiAgdmFyIGludGVydmFsTXMgPSBhZ2dyZWdhdGlvbkludGVydmFsLmFzTWlsbGlzZWNvbmRzKCk7CiAgdmFyIGxhc3RDaGFydERhdGFQb2ludFRpbWUgPSB1bmRlZmluZWQ7CgogIGlmIChjaGFydERhdGEgIT09IHVuZGVmaW5lZCAmJiBjaGFydERhdGEubGVuZ3RoID4gMCkgewogICAgbGFzdENoYXJ0RGF0YVBvaW50VGltZSA9IGNoYXJ0RGF0YVtjaGFydERhdGEubGVuZ3RoIC0gMV0uZGF0ZS5nZXRUaW1lKCk7CiAgfQoKICBhbm9tYWx5UmVjb3Jkcy5mb3JFYWNoKGZ1bmN0aW9uIChyZWNvcmQpIHsKICAgIHZhciByZWNvcmRUaW1lID0gcmVjb3JkW190aW1lc2VyaWVzZXhwbG9yZXJfY29uc3RhbnRzLlRJTUVfRklFTERfTkFNRV07CiAgICB2YXIgY2hhcnRQb2ludCA9IGZpbmRDaGFydFBvaW50Rm9yQW5vbWFseVRpbWUoY2hhcnREYXRhLCByZWNvcmRUaW1lLCBhZ2dyZWdhdGlvbkludGVydmFsKTsKCiAgICBpZiAoY2hhcnRQb2ludCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIHZhciB0aW1lVG9BZGQgPSBNYXRoLmZsb29yKHJlY29yZFRpbWUgLyBpbnRlcnZhbE1zKSAqIGludGVydmFsTXM7CgogICAgICBpZiAodGltZXNUb0FkZFBvaW50c0Zvci5pbmRleE9mKHRpbWVUb0FkZCkgPT09IC0xICYmIHRpbWVUb0FkZCAhPT0gbGFzdENoYXJ0RGF0YVBvaW50VGltZSkgewogICAgICAgIHRpbWVzVG9BZGRQb2ludHNGb3IucHVzaCh0aW1lVG9BZGQpOwogICAgICB9CiAgICB9CiAgfSk7CiAgdGltZXNUb0FkZFBvaW50c0Zvci5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7CiAgICByZXR1cm4gYSAtIGI7CiAgfSk7CiAgdGltZXNUb0FkZFBvaW50c0Zvci5mb3JFYWNoKGZ1bmN0aW9uICh0aW1lKSB7CiAgICB2YXIgcG9pbnRUb0FkZCA9IHsKICAgICAgZGF0ZTogbmV3IERhdGUodGltZSksCiAgICAgIHZhbHVlOiBudWxsCiAgICB9OwoKICAgIGlmIChtb2RlbFBsb3RFbmFibGVkID09PSB0cnVlKSB7CiAgICAgIHBvaW50VG9BZGQudXBwZXIgPSBudWxsOwogICAgICBwb2ludFRvQWRkLmxvd2VyID0gbnVsbDsKICAgIH0KCiAgICBjaGFydERhdGEucHVzaChwb2ludFRvQWRkKTsKICB9KTsgLy8gSXRlcmF0ZSB0aHJvdWdoIHRoZSBhbm9tYWx5IHJlY29yZHMgYWRkaW5nIHRoZQogIC8vIHZhcmlvdXMgcHJvcGVydGllcyByZXF1aXJlZCBmb3IgZGlzcGxheS4KCiAgYW5vbWFseVJlY29yZHMuZm9yRWFjaChmdW5jdGlvbiAocmVjb3JkKSB7CiAgICAvLyBMb29rIGZvciBhIGNoYXJ0IHBvaW50IHdpdGggdGhlIHNhbWUgdGltZSBhcyB0aGUgcmVjb3JkLgogICAgLy8gSWYgbm9uZSBmb3VuZCwgZmluZCBjbG9zZXN0IHRpbWUgaW4gY2hhcnREYXRhIHNldC4KICAgIHZhciByZWNvcmRUaW1lID0gcmVjb3JkW190aW1lc2VyaWVzZXhwbG9yZXJfY29uc3RhbnRzLlRJTUVfRklFTERfTkFNRV07CiAgICB2YXIgY2hhcnRQb2ludCA9IGZpbmRDaGFydFBvaW50Rm9yQW5vbWFseVRpbWUoY2hhcnREYXRhLCByZWNvcmRUaW1lLCBhZ2dyZWdhdGlvbkludGVydmFsKTsKCiAgICBpZiAoY2hhcnRQb2ludCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIC8vIElmIGNoYXJ0IGFnZ3JlZ2F0aW9uIGludGVydmFsID4gYnVja2V0IHNwYW4sIHRoZXJlIG1heSBiZSBtb3JlIHRoYW4KICAgICAgLy8gb25lIGFub21hbHkgcmVjb3JkIGluIHRoZSBpbnRlcnZhbCwgc28gdXNlIHRoZSBwcm9wZXJ0aWVzIGZyb20KICAgICAgLy8gdGhlIHJlY29yZCB3aXRoIHRoZSBoaWdoZXN0IGFub21hbHlTY29yZS4KICAgICAgdmFyIHJlY29yZFNjb3JlID0gcmVjb3JkLnJlY29yZF9zY29yZTsKICAgICAgdmFyIHBvaW50U2NvcmUgPSBjaGFydFBvaW50LmFub21hbHlTY29yZTsKCiAgICAgIGlmIChwb2ludFNjb3JlID09PSB1bmRlZmluZWQgfHwgcG9pbnRTY29yZSA8IHJlY29yZFNjb3JlKSB7CiAgICAgICAgY2hhcnRQb2ludC5hbm9tYWx5U2NvcmUgPSByZWNvcmRTY29yZTsKICAgICAgICBjaGFydFBvaW50LmZ1bmN0aW9uID0gcmVjb3JkLmZ1bmN0aW9uOwoKICAgICAgICBpZiAoX2xvZGFzaC5kZWZhdWx0LmhhcyhyZWNvcmQsICdhY3R1YWwnKSkgewogICAgICAgICAgY2hhcnRQb2ludC5hY3R1YWwgPSByZWNvcmQuYWN0dWFsOwogICAgICAgICAgY2hhcnRQb2ludC50eXBpY2FsID0gcmVjb3JkLnR5cGljYWw7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHZhciBjYXVzZXMgPSBfbG9kYXNoLmRlZmF1bHQuZ2V0KHJlY29yZCwgJ2NhdXNlcycsIFtdKTsKCiAgICAgICAgICBpZiAoY2F1c2VzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgY2hhcnRQb2ludC5ieUZpZWxkTmFtZSA9IHJlY29yZC5ieV9maWVsZF9uYW1lOwogICAgICAgICAgICBjaGFydFBvaW50Lm51bWJlck9mQ2F1c2VzID0gY2F1c2VzLmxlbmd0aDsKCiAgICAgICAgICAgIGlmIChjYXVzZXMubGVuZ3RoID09PSAxKSB7CiAgICAgICAgICAgICAgLy8gSWYgb25seSBhIHNpbmdsZSBjYXVzZSwgY29weSBhY3R1YWwgYW5kIHR5cGljYWwgdmFsdWVzIHRvIHRoZSB0b3AgbGV2ZWwuCiAgICAgICAgICAgICAgdmFyIGNhdXNlID0gX2xvZGFzaC5kZWZhdWx0LmZpcnN0KHJlY29yZC5jYXVzZXMpOwoKICAgICAgICAgICAgICBjaGFydFBvaW50LmFjdHVhbCA9IGNhdXNlLmFjdHVhbDsKICAgICAgICAgICAgICBjaGFydFBvaW50LnR5cGljYWwgPSBjYXVzZS50eXBpY2FsOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoX2xvZGFzaC5kZWZhdWx0LmhhcyhyZWNvcmQsICdtdWx0aV9idWNrZXRfaW1wYWN0JykpIHsKICAgICAgICAgIGNoYXJ0UG9pbnQubXVsdGlCdWNrZXRJbXBhY3QgPSByZWNvcmQubXVsdGlfYnVja2V0X2ltcGFjdDsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9KTsKICByZXR1cm4gY2hhcnREYXRhOwp9IC8vIEFkZHMgYSBzY2hlZHVsZWRFdmVudHMgcHJvcGVydHkgdG8gYW55IHBvaW50cyBpbiB0aGUgY2hhcnQgZGF0YSBzZXQKLy8gd2hpY2ggY29ycmVzcG9uZCB0byB0aW1lcyBvZiBzY2hlZHVsZWQgZXZlbnRzIGZvciB0aGUgam9iLgoKCmZ1bmN0aW9uIHByb2Nlc3NTY2hlZHVsZWRFdmVudHNGb3JDaGFydChjaGFydERhdGEsIHNjaGVkdWxlZEV2ZW50cykgewogIGlmIChzY2hlZHVsZWRFdmVudHMgIT09IHVuZGVmaW5lZCkgewogICAgX2xvZGFzaC5kZWZhdWx0LmVhY2goc2NoZWR1bGVkRXZlbnRzLCBmdW5jdGlvbiAoZXZlbnRzLCB0aW1lKSB7CiAgICAgIHZhciBjaGFydFBvaW50ID0gZmluZE5lYXJlc3RDaGFydFBvaW50VG9UaW1lKGNoYXJ0RGF0YSwgdGltZSk7CgogICAgICBpZiAoY2hhcnRQb2ludCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgLy8gTm90ZSBpZiB0aGUgc2NoZWR1bGVkIGV2ZW50IGNvaW5jaWRlcyB3aXRoIGFuIGFic2VuY2Ugb2YgdGhlIHVuZGVybHlpbmcgbWV0cmljIGRhdGEsCiAgICAgICAgLy8gd2UgZG9uJ3Qgd29ycnkgYWJvdXQgcGxvdHRpbmcgdGhlIGV2ZW50LgogICAgICAgIGNoYXJ0UG9pbnQuc2NoZWR1bGVkRXZlbnRzID0gZXZlbnRzOwogICAgICB9CiAgICB9KTsKICB9CgogIHJldHVybiBjaGFydERhdGE7Cn0gLy8gRmluZHMgdGhlIGNoYXJ0IHBvaW50IHdoaWNoIGlzIGNsb3Nlc3QgaW4gdGltZSB0byB0aGUgc3BlY2lmaWVkIHRpbWUuCgoKZnVuY3Rpb24gZmluZE5lYXJlc3RDaGFydFBvaW50VG9UaW1lKGNoYXJ0RGF0YSwgdGltZSkgewogIHZhciBjaGFydFBvaW50OwoKICBpZiAoY2hhcnREYXRhID09PSB1bmRlZmluZWQpIHsKICAgIHJldHVybiBjaGFydFBvaW50OwogIH0KCiAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGFydERhdGEubGVuZ3RoOyBpKyspIHsKICAgIGlmIChjaGFydERhdGFbaV0uZGF0ZS5nZXRUaW1lKCkgPT09IHRpbWUpIHsKICAgICAgY2hhcnRQb2ludCA9IGNoYXJ0RGF0YVtpXTsKICAgICAgYnJlYWs7CiAgICB9CiAgfQoKICBpZiAoY2hhcnRQb2ludCA9PT0gdW5kZWZpbmVkKSB7CiAgICAvLyBGaW5kIG5lYXJlc3QgcG9pbnQgaW4gdGltZS4KICAgIC8vIGxvb3AgdGhyb3VnaCBsaW5lIGl0ZW1zIHVudGlsIHRoZSBkYXRlIGlzIGdyZWF0ZXIgdGhhbiBidWNrZXRUaW1lCiAgICAvLyBncmFiIHRoZSBjdXJyZW50IGFuZCBwcmV2aW91cyBpdGVtcyBhbmQgY29tcGFyZSB0aGUgdGltZSBkaWZmZXJlbmNlcwogICAgdmFyIGZvdW5kSXRlbTsKCiAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgY2hhcnREYXRhLmxlbmd0aDsgX2krKykgewogICAgICB2YXIgaXRlbVRpbWUgPSBjaGFydERhdGFbX2ldLmRhdGUuZ2V0VGltZSgpOwoKICAgICAgaWYgKGl0ZW1UaW1lID4gdGltZSkgewogICAgICAgIHZhciBpdGVtID0gY2hhcnREYXRhW19pXTsKICAgICAgICB2YXIgcHJldmlvdXNJdGVtID0gY2hhcnREYXRhW19pIC0gMV07CiAgICAgICAgdmFyIGRpZmYxID0gTWF0aC5hYnModGltZSAtIHByZXZpb3VzSXRlbS5kYXRlLmdldFRpbWUoKSk7CiAgICAgICAgdmFyIGRpZmYyID0gTWF0aC5hYnModGltZSAtIGl0ZW1UaW1lKTsgLy8gZm91bmRJdGVtIHNob3VsZCBiZSB0aGUgaXRlbSB3aXRoIGEgZGF0ZSBjbG9zZXN0IHRvIGJ1Y2tldFRpbWUKCiAgICAgICAgaWYgKHByZXZpb3VzSXRlbSA9PT0gdW5kZWZpbmVkIHx8IGRpZmYxID4gZGlmZjIpIHsKICAgICAgICAgIGZvdW5kSXRlbSA9IGl0ZW07CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGZvdW5kSXRlbSA9IHByZXZpb3VzSXRlbTsKICAgICAgICB9CgogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CgogICAgY2hhcnRQb2ludCA9IGZvdW5kSXRlbTsKICB9CgogIHJldHVybiBjaGFydFBvaW50Owp9IC8vIEZpbmRzIHRoZSBjaGFydCBwb2ludCB3aGljaCBjb3JyZXNwb25kcyB0byBhbiBhbm9tYWx5IHdpdGggdGhlCi8vIHNwZWNpZmllZCB0aW1lLgoKCmZ1bmN0aW9uIGZpbmRDaGFydFBvaW50Rm9yQW5vbWFseVRpbWUoY2hhcnREYXRhLCBhbm9tYWx5VGltZSwgYWdncmVnYXRpb25JbnRlcnZhbCkgewogIHZhciBjaGFydFBvaW50OwoKICBpZiAoY2hhcnREYXRhID09PSB1bmRlZmluZWQpIHsKICAgIHJldHVybiBjaGFydFBvaW50OwogIH0KCiAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGFydERhdGEubGVuZ3RoOyBpKyspIHsKICAgIGlmIChjaGFydERhdGFbaV0uZGF0ZS5nZXRUaW1lKCkgPT09IGFub21hbHlUaW1lKSB7CiAgICAgIGNoYXJ0UG9pbnQgPSBjaGFydERhdGFbaV07CiAgICAgIGJyZWFrOwogICAgfQogIH0KCiAgaWYgKGNoYXJ0UG9pbnQgPT09IHVuZGVmaW5lZCkgewogICAgLy8gRmluZCB0aGUgdGltZSBvZiB0aGUgcG9pbnQgd2hpY2ggZmFsbHMgaW1tZWRpYXRlbHkgYmVmb3JlIHRoZQogICAgLy8gdGltZSBvZiB0aGUgYW5vbWFseS4gVGhpcyBpcyB0aGUgc3RhcnQgb2YgdGhlIGNoYXJ0ICdidWNrZXQnCiAgICAvLyB3aGljaCBjb250YWlucyB0aGUgYW5vbWFsb3VzIGJ1Y2tldC4KICAgIHZhciBmb3VuZEl0ZW07CiAgICB2YXIgaW50ZXJ2YWxNcyA9IGFnZ3JlZ2F0aW9uSW50ZXJ2YWwuYXNNaWxsaXNlY29uZHMoKTsKCiAgICBmb3IgKHZhciBfaTIgPSAwOyBfaTIgPCBjaGFydERhdGEubGVuZ3RoOyBfaTIrKykgewogICAgICB2YXIgaXRlbVRpbWUgPSBjaGFydERhdGFbX2kyXS5kYXRlLmdldFRpbWUoKTsKCiAgICAgIGlmIChhbm9tYWx5VGltZSAtIGl0ZW1UaW1lIDwgaW50ZXJ2YWxNcykgewogICAgICAgIGZvdW5kSXRlbSA9IGNoYXJ0RGF0YVtfaTJdOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CgogICAgY2hhcnRQb2ludCA9IGZvdW5kSXRlbTsKICB9CgogIHJldHVybiBjaGFydFBvaW50Owp9CgpmdW5jdGlvbiBjYWxjdWxhdGVBZ2dyZWdhdGlvbkludGVydmFsKGJvdW5kcywgYnVja2V0c1RhcmdldCwgam9icywgc2VsZWN0ZWRKb2IpIHsKICAvLyBBZ2dyZWdhdGlvbiBpbnRlcnZhbCB1c2VkIGluIHF1ZXJpZXMgc2hvdWxkIGJlIGEgZnVuY3Rpb24gb2YgdGhlIHRpbWUgc3BhbiBvZiB0aGUgY2hhcnQKICAvLyBhbmQgdGhlIGJ1Y2tldCBzcGFuIG9mIHRoZSBzZWxlY3RlZCBqb2IocykuCiAgdmFyIGJhclRhcmdldCA9IGJ1Y2tldHNUYXJnZXQgIT09IHVuZGVmaW5lZCA/IGJ1Y2tldHNUYXJnZXQgOiAxMDA7IC8vIFVzZSBhIG1heEJhcnMgb2YgMTAlIGdyZWF0ZXIgdGhhbiB0aGUgdGFyZ2V0LgoKICB2YXIgbWF4QmFycyA9IE1hdGguZmxvb3IoMS4xICogYmFyVGFyZ2V0KTsKICB2YXIgYnVja2V0cyA9IG5ldyBfdGltZV9idWNrZXRzLlRpbWVCdWNrZXRzKCk7CiAgYnVja2V0cy5zZXRJbnRlcnZhbCgnYXV0bycpOwogIGJ1Y2tldHMuc2V0Qm91bmRzKGJvdW5kcyk7CiAgYnVja2V0cy5zZXRCYXJUYXJnZXQoTWF0aC5mbG9vcihiYXJUYXJnZXQpKTsKICBidWNrZXRzLnNldE1heEJhcnMobWF4QmFycyk7IC8vIEVuc3VyZSB0aGUgYWdncmVnYXRpb24gaW50ZXJ2YWwgaXMgYWx3YXlzIGEgbXVsdGlwbGUgb2YgdGhlIGJ1Y2tldCBzcGFuIHRvIGF2b2lkIHN0cmFuZ2UKICAvLyBiZWhhdmlvdXIgc3VjaCBhcyBhZGphY2VudCBjaGFydCBidWNrZXRzIGhvbGRpbmcgZGlmZmVyZW50IG51bWJlcnMgb2Ygam9iIHJlc3VsdHMuCgogIHZhciBidWNrZXRTcGFuU2Vjb25kcyA9IF9sb2Rhc2guZGVmYXVsdC5maW5kKGpvYnMsIHsKICAgIGlkOiBzZWxlY3RlZEpvYi5qb2JfaWQKICB9KS5idWNrZXRTcGFuU2Vjb25kczsKCiAgdmFyIGFnZ0ludGVydmFsID0gYnVja2V0cy5nZXRJbnRlcnZhbFRvTmVhcmVzdE11bHRpcGxlKGJ1Y2tldFNwYW5TZWNvbmRzKTsgLy8gU2V0IHRoZSBpbnRlcnZhbCBiYWNrIHRvIHRoZSBqb2IgYnVja2V0IHNwYW4gaWYgdGhlIGF1dG8gaW50ZXJ2YWwgaXMgc21hbGxlci4KCiAgdmFyIHNlY3MgPSBhZ2dJbnRlcnZhbC5hc1NlY29uZHMoKTsKCiAgaWYgKHNlY3MgPCBidWNrZXRTcGFuU2Vjb25kcykgewogICAgYnVja2V0cy5zZXRJbnRlcnZhbChidWNrZXRTcGFuU2Vjb25kcyArICdzJyk7CiAgICBhZ2dJbnRlcnZhbCA9IGJ1Y2tldHMuZ2V0SW50ZXJ2YWwoKTsKICB9CgogIHJldHVybiBhZ2dJbnRlcnZhbDsKfQoKZnVuY3Rpb24gY2FsY3VsYXRlRGVmYXVsdEZvY3VzUmFuZ2UoYXV0b1pvb21EdXJhdGlvbiwgY29udGV4dEFnZ3JlZ2F0aW9uSW50ZXJ2YWwsIGNvbnRleHRDaGFydERhdGEsIGNvbnRleHRGb3JlY2FzdERhdGEpIHsKICB2YXIgaXNGb3JlY2FzdERhdGEgPSBjb250ZXh0Rm9yZWNhc3REYXRhICE9PSB1bmRlZmluZWQgJiYgY29udGV4dEZvcmVjYXN0RGF0YS5sZW5ndGggPiAwOwogIHZhciBjb21iaW5lZERhdGEgPSBpc0ZvcmVjYXN0RGF0YSA9PT0gZmFsc2UgPyBjb250ZXh0Q2hhcnREYXRhIDogY29udGV4dENoYXJ0RGF0YS5jb25jYXQoY29udGV4dEZvcmVjYXN0RGF0YSk7CgogIHZhciBlYXJsaWVzdERhdGFEYXRlID0gX2xvZGFzaC5kZWZhdWx0LmZpcnN0KGNvbWJpbmVkRGF0YSkuZGF0ZTsKCiAgdmFyIGxhdGVzdERhdGFEYXRlID0gX2xvZGFzaC5kZWZhdWx0Lmxhc3QoY29tYmluZWREYXRhKS5kYXRlOwoKICB2YXIgcmFuZ2VFYXJsaWVzdE1zOwogIHZhciByYW5nZUxhdGVzdE1zOwoKICBpZiAoaXNGb3JlY2FzdERhdGEgPT09IHRydWUpIHsKICAgIC8vIFJldHVybiBhIHJhbmdlIGNlbnRyZWQgb24gdGhlIHN0YXJ0IG9mIHRoZSBmb3JlY2FzdCByYW5nZSwgZGVwZW5kaW5nCiAgICAvLyBvbiB0aGUgdGltZSByYW5nZSBvZiB0aGUgZm9yZWNhc3QgYW5kIGRhdGEuCiAgICB2YXIgZWFybGllc3RGb3JlY2FzdERhdGFEYXRlID0gX2xvZGFzaC5kZWZhdWx0LmZpcnN0KGNvbnRleHRGb3JlY2FzdERhdGEpLmRhdGU7CgogICAgdmFyIGxhdGVzdEZvcmVjYXN0RGF0YURhdGUgPSBfbG9kYXNoLmRlZmF1bHQubGFzdChjb250ZXh0Rm9yZWNhc3REYXRhKS5kYXRlOwoKICAgIHJhbmdlTGF0ZXN0TXMgPSBNYXRoLm1pbihlYXJsaWVzdEZvcmVjYXN0RGF0YURhdGUuZ2V0VGltZSgpICsgYXV0b1pvb21EdXJhdGlvbiAvIDIsIGxhdGVzdEZvcmVjYXN0RGF0YURhdGUuZ2V0VGltZSgpKTsKICAgIHJhbmdlRWFybGllc3RNcyA9IE1hdGgubWF4KHJhbmdlTGF0ZXN0TXMgLSBhdXRvWm9vbUR1cmF0aW9uLCBlYXJsaWVzdERhdGFEYXRlLmdldFRpbWUoKSk7CiAgfSBlbHNlIHsKICAgIC8vIFJldHVybnMgdGhlIHJhbmdlIHRoYXQgc2hvd3MgdGhlIG1vc3QgcmVjZW50IGRhdGEgYXQgYnVja2V0IHNwYW4gZ3JhbnVsYXJpdHkuCiAgICByYW5nZUxhdGVzdE1zID0gbGF0ZXN0RGF0YURhdGUuZ2V0VGltZSgpICsgY29udGV4dEFnZ3JlZ2F0aW9uSW50ZXJ2YWwuYXNNaWxsaXNlY29uZHMoKTsKICAgIHJhbmdlRWFybGllc3RNcyA9IE1hdGgubWF4KGVhcmxpZXN0RGF0YURhdGUuZ2V0VGltZSgpLCByYW5nZUxhdGVzdE1zIC0gYXV0b1pvb21EdXJhdGlvbik7CiAgfQoKICByZXR1cm4gW25ldyBEYXRlKHJhbmdlRWFybGllc3RNcyksIG5ldyBEYXRlKHJhbmdlTGF0ZXN0TXMpXTsKfQoKZnVuY3Rpb24gY2FsY3VsYXRlSW5pdGlhbEZvY3VzUmFuZ2Uoem9vbVN0YXRlLCBjb250ZXh0QWdncmVnYXRpb25JbnRlcnZhbCwgYm91bmRzKSB7CiAgaWYgKHpvb21TdGF0ZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAvLyBDaGVjayB0aGF0IHRoZSB6b29tIHRpbWVzIGFyZSB2YWxpZC4KICAgIC8vIHpvb21Gcm9tIG11c3QgYmUgYXQgb3IgYWZ0ZXIgY29udGV4dCBjaGFydCBzZWFyY2ggYm91bmRzIGVhcmxpZXN0LAogICAgLy8gem9vbVRvIG11c3QgYmUgYXQgb3IgYmVmb3JlIGNvbnRleHQgY2hhcnQgc2VhcmNoIGJvdW5kcyBsYXRlc3QuCiAgICB2YXIgem9vbUZyb20gPSAoMCwgX21vbWVudFRpbWV6b25lLmRlZmF1bHQpKHpvb21TdGF0ZS5mcm9tLCAnWVlZWS1NTS1ERFRISDptbTpzcy5TU1NaJywgdHJ1ZSk7CiAgICB2YXIgem9vbVRvID0gKDAsIF9tb21lbnRUaW1lem9uZS5kZWZhdWx0KSh6b29tU3RhdGUudG8sICdZWVlZLU1NLUREVEhIOm1tOnNzLlNTU1onLCB0cnVlKTsKICAgIHZhciBzZWFyY2hCb3VuZHMgPSAoMCwgX3RpbWVfYnVja2V0cy5nZXRCb3VuZHNSb3VuZGVkVG9JbnRlcnZhbCkoYm91bmRzLCBjb250ZXh0QWdncmVnYXRpb25JbnRlcnZhbCwgdHJ1ZSk7CiAgICB2YXIgZWFybGllc3QgPSBzZWFyY2hCb3VuZHMubWluOwogICAgdmFyIGxhdGVzdCA9IHNlYXJjaEJvdW5kcy5tYXg7CgogICAgaWYgKHpvb21Gcm9tLmlzVmFsaWQoKSAmJiB6b29tVG8uaXNWYWxpZCAmJiB6b29tVG8uaXNBZnRlcih6b29tRnJvbSkgJiYgem9vbUZyb20uaXNCZXR3ZWVuKGVhcmxpZXN0LCBsYXRlc3QsIG51bGwsICdbXScpICYmIHpvb21Uby5pc0JldHdlZW4oZWFybGllc3QsIGxhdGVzdCwgbnVsbCwgJ1tdJykpIHsKICAgICAgcmV0dXJuIFt6b29tRnJvbS50b0RhdGUoKSwgem9vbVRvLnRvRGF0ZSgpXTsKICAgIH0KICB9CgogIHJldHVybiB1bmRlZmluZWQ7Cn0KCmZ1bmN0aW9uIGdldEF1dG9ab29tRHVyYXRpb24oam9icywgc2VsZWN0ZWRKb2IpIHsKICAvLyBDYWxjdWxhdGUgdGhlICdhdXRvJyB6b29tIGR1cmF0aW9uIHdoaWNoIHNob3dzIGRhdGEgYXQgYnVja2V0IHNwYW4gZ3JhbnVsYXJpdHkuCiAgLy8gR2V0IHRoZSBtaW5pbXVtIGJ1Y2tldCBzcGFuIG9mIHNlbGVjdGVkIGpvYnMuCiAgLy8gVE9ETyAtIG9ubHkgbG9vayBhdCBqb2JzIGZvciB3aGljaCBkYXRhIGhhcyBiZWVuIHJldHVybmVkPwogIHZhciBidWNrZXRTcGFuU2Vjb25kcyA9IF9sb2Rhc2guZGVmYXVsdC5maW5kKGpvYnMsIHsKICAgIGlkOiBzZWxlY3RlZEpvYi5qb2JfaWQKICB9KS5idWNrZXRTcGFuU2Vjb25kczsgLy8gSW4gbW9zdCBjYXNlcyB0aGUgZHVyYXRpb24gY2FuIGJlIG9idGFpbmVkIGJ5IHNpbXBseSBtdWx0aXBseWluZyB0aGUgcG9pbnRzIHRhcmdldAogIC8vIENoZWNrIHRoYXQgdGhpcyBkdXJhdGlvbiByZXR1cm5zIHRoZSBidWNrZXQgc3BhbiB3aGVuIHJ1biBiYWNrIHRocm91Z2ggdGhlCiAgLy8gVGltZUJ1Y2tldCBpbnRlcnZhbCBjYWxjdWxhdGlvbi4KCgogIHZhciBhdXRvWm9vbUR1cmF0aW9uID0gYnVja2V0U3BhblNlY29uZHMgKiAxMDAwICogKF90aW1lc2VyaWVzZXhwbG9yZXJfY29uc3RhbnRzLkNIQVJUU19QT0lOVF9UQVJHRVQgLSAxKTsgLy8gVXNlIGEgbWF4QmFycyBvZiAxMCUgZ3JlYXRlciB0aGFuIHRoZSB0YXJnZXQuCgogIHZhciBtYXhCYXJzID0gTWF0aC5mbG9vcigxLjEgKiBfdGltZXNlcmllc2V4cGxvcmVyX2NvbnN0YW50cy5DSEFSVFNfUE9JTlRfVEFSR0VUKTsKICB2YXIgYnVja2V0cyA9IG5ldyBfdGltZV9idWNrZXRzLlRpbWVCdWNrZXRzKCk7CiAgYnVja2V0cy5zZXRJbnRlcnZhbCgnYXV0bycpOwogIGJ1Y2tldHMuc2V0QmFyVGFyZ2V0KE1hdGguZmxvb3IoX3RpbWVzZXJpZXNleHBsb3Jlcl9jb25zdGFudHMuQ0hBUlRTX1BPSU5UX1RBUkdFVCkpOwogIGJ1Y2tldHMuc2V0TWF4QmFycyhtYXhCYXJzKTsgLy8gU2V0IGJvdW5kcyBmcm9tICdub3cnIGZvciB0ZXN0aW5nIHRoZSBhdXRvIHpvb20gZHVyYXRpb24uCgogIHZhciBub3dNcyA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpOwogIHZhciBtYXggPSAoMCwgX21vbWVudFRpbWV6b25lLmRlZmF1bHQpKG5vd01zKTsKICB2YXIgbWluID0gKDAsIF9tb21lbnRUaW1lem9uZS5kZWZhdWx0KShub3dNcyAtIGF1dG9ab29tRHVyYXRpb24pOwogIGJ1Y2tldHMuc2V0Qm91bmRzKHsKICAgIG1pbjogbWluLAogICAgbWF4OiBtYXgKICB9KTsKICB2YXIgY2FsY3VsYXRlZEludGVydmFsID0gYnVja2V0cy5nZXRJbnRlcnZhbFRvTmVhcmVzdE11bHRpcGxlKGJ1Y2tldFNwYW5TZWNvbmRzKTsKICB2YXIgY2FsY3VsYXRlZEludGVydmFsU2VjcyA9IGNhbGN1bGF0ZWRJbnRlcnZhbC5hc1NlY29uZHMoKTsKCiAgaWYgKGNhbGN1bGF0ZWRJbnRlcnZhbFNlY3MgIT09IGJ1Y2tldFNwYW5TZWNvbmRzKSB7CiAgICAvLyBJZiB3ZSBoYXZlbid0IGdvdCB0aGUgc3BhbiBiYWNrLCB3aGljaCBtYXkgb2NjdXIgZGVwZW5kaW5nIG9uIHRoZSAnYXV0bycgcmFuZ2VzCiAgICAvLyB1c2VkIGluIFRpbWVCdWNrZXRzIGFuZCB0aGUgYnVja2V0IHNwYW4gb2YgdGhlIGpvYiwgdGhlbiBtdWx0aXBseSBieSB0aGUgcmF0aW8KICAgIC8vIG9mIHRoZSBidWNrZXQgc3BhbiB0byB0aGUgY2FsY3VsYXRlZCBpbnRlcnZhbC4KICAgIGF1dG9ab29tRHVyYXRpb24gPSBhdXRvWm9vbUR1cmF0aW9uICogKGJ1Y2tldFNwYW5TZWNvbmRzIC8gY2FsY3VsYXRlZEludGVydmFsU2Vjcyk7CiAgfQoKICByZXR1cm4gYXV0b1pvb21EdXJhdGlvbjsKfQ=="},null]}