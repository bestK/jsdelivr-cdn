{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/security/public/views/management/edit_role/components/privileges/es/index_privileges.js","dependencies":[{"path":"x-pack/legacy/plugins/security/public/views/management/edit_role/components/privileges/es/index_privileges.js","mtime":1585205047192},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiKSB7IF90eXBlb2YyID0gZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mMiA9IGZ1bmN0aW9uIF90eXBlb2YyKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mMihvYmopOyB9CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuSW5kZXhQcml2aWxlZ2VzID0gdm9pZCAwOwoKdmFyIF9sb2Rhc2ggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoImxvZGFzaCIpKTsKCnZhciBfcmVhY3QgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKCJyZWFjdCIpKTsKCnZhciBfcm9sZV91dGlscyA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uLy4uLy4uL2xpYi9yb2xlX3V0aWxzIik7Cgp2YXIgX29iamVjdHMgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi8uLi8uLi9vYmplY3RzIik7Cgp2YXIgX2luZGV4X3ByaXZpbGVnZV9mb3JtID0gcmVxdWlyZSgiLi9pbmRleF9wcml2aWxlZ2VfZm9ybSIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7CiAgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgewogICAgcmV0dXJuIG9iajsKICB9IGVsc2UgewogICAgdmFyIG5ld09iaiA9IHt9OwoKICAgIGlmIChvYmogIT0gbnVsbCkgewogICAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7CiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHsKICAgICAgICAgIHZhciBkZXNjID0gT2JqZWN0LmRlZmluZVByb3BlcnR5ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KSA6IHt9OwoKICAgICAgICAgIGlmIChkZXNjLmdldCB8fCBkZXNjLnNldCkgewogICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobmV3T2JqLCBrZXksIGRlc2MpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBuZXdPYmouZGVmYXVsdCA9IG9iajsKICAgIHJldHVybiBuZXdPYmo7CiAgfQp9CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgewogIHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7CiAgICBkZWZhdWx0OiBvYmoKICB9Owp9CgpmdW5jdGlvbiBfdHlwZW9mKG9iaikgewogIGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIF90eXBlb2YyKFN5bWJvbC5pdGVyYXRvcikgPT09ICJzeW1ib2wiKSB7CiAgICBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsKICAgICAgcmV0dXJuIF90eXBlb2YyKG9iaik7CiAgICB9OwogIH0gZWxzZSB7CiAgICBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsKICAgICAgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogX3R5cGVvZjIob2JqKTsKICAgIH07CiAgfQoKICByZXR1cm4gX3R5cGVvZihvYmopOwp9CgpmdW5jdGlvbiBfZXh0ZW5kcygpIHsKICBfZXh0ZW5kcyA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gKHRhcmdldCkgewogICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsKICAgICAgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXTsKCiAgICAgIGZvciAodmFyIGtleSBpbiBzb3VyY2UpIHsKICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSwga2V5KSkgewogICAgICAgICAgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gdGFyZ2V0OwogIH07CgogIHJldHVybiBfZXh0ZW5kcy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9CgpmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsKICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7CgogIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7CiAgICB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsKICAgIGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsKICAgICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7CiAgICB9KTsKICAgIGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsKICB9CgogIHJldHVybiBrZXlzOwp9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgewogIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsKCiAgICBpZiAoaSAlIDIpIHsKICAgICAgb3duS2V5cyhzb3VyY2UsIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOwogICAgICB9KTsKICAgIH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsKICAgIH0gZWxzZSB7CiAgICAgIG93bktleXMoc291cmNlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsKICAgICAgfSk7CiAgICB9CiAgfQoKICByZXR1cm4gdGFyZ2V0Owp9CgpmdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7CiAgcmV0dXJuIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfbm9uSXRlcmFibGVTcHJlYWQoKTsKfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlU3ByZWFkKCkgewogIHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7Cn0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXkoaXRlcikgewogIGlmIChTeW1ib2wuaXRlcmF0b3IgaW4gT2JqZWN0KGl0ZXIpIHx8IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChpdGVyKSA9PT0gIltvYmplY3QgQXJndW1lbnRzXSIpIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpOwp9CgpmdW5jdGlvbiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgewogICAgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkoYXJyLmxlbmd0aCk7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHsKICAgICAgYXJyMltpXSA9IGFycltpXTsKICAgIH0KCiAgICByZXR1cm4gYXJyMjsKICB9Cn0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsKICBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7CiAgfQp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgewogICAgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsKICAgIGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsKICAgIGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsKICAgIGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOwogIH0KfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgewogIGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOwogIGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsKICByZXR1cm4gQ29uc3RydWN0b3I7Cn0KCmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsKICBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpKSB7CiAgICByZXR1cm4gY2FsbDsKICB9CgogIHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOwp9CgpmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgewogIF9nZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7CiAgICByZXR1cm4gby5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKG8pOwogIH07CiAgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsKfQoKZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7CiAgaWYgKHNlbGYgPT09IHZvaWQgMCkgewogICAgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsKICB9CgogIHJldHVybiBzZWxmOwp9CgpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsKICBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICJmdW5jdGlvbiIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24iKTsKICB9CgogIHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgewogICAgY29uc3RydWN0b3I6IHsKICAgICAgdmFsdWU6IHN1YkNsYXNzLAogICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlCiAgICB9CiAgfSk7CiAgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcyk7Cn0KCmZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7CiAgX3NldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IGZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7CiAgICBvLl9fcHJvdG9fXyA9IHA7CiAgICByZXR1cm4gbzsKICB9OwoKICByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApOwp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7CiAgaWYgKGtleSBpbiBvYmopIHsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgICB2YWx1ZTogdmFsdWUsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgd3JpdGFibGU6IHRydWUKICAgIH0pOwogIH0gZWxzZSB7CiAgICBvYmpba2V5XSA9IHZhbHVlOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKdmFyIEluZGV4UHJpdmlsZWdlcyA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKF9Db21wb25lbnQpIHsKICBfaW5oZXJpdHMoSW5kZXhQcml2aWxlZ2VzLCBfQ29tcG9uZW50KTsKCiAgZnVuY3Rpb24gSW5kZXhQcml2aWxlZ2VzKHByb3BzKSB7CiAgICB2YXIgX3RoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEluZGV4UHJpdmlsZWdlcyk7CgogICAgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfZ2V0UHJvdG90eXBlT2YoSW5kZXhQcml2aWxlZ2VzKS5jYWxsKHRoaXMsIHByb3BzKSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiYWRkSW5kZXhQcml2aWxlZ2UiLCBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciByb2xlID0gX3RoaXMucHJvcHMucm9sZTsKICAgICAgdmFyIG5ld0luZGljZXMgPSBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KHJvbGUuZWxhc3RpY3NlYXJjaC5pbmRpY2VzKSwgW3sKICAgICAgICBuYW1lczogW10sCiAgICAgICAgcHJpdmlsZWdlczogW10sCiAgICAgICAgZmllbGRfc2VjdXJpdHk6IHsKICAgICAgICAgIGdyYW50OiBbJyonXQogICAgICAgIH0KICAgICAgfV0pOwoKICAgICAgX3RoaXMucHJvcHMub25DaGFuZ2UoX29iamVjdFNwcmVhZCh7fSwgX3RoaXMucHJvcHMucm9sZSwgewogICAgICAgIGVsYXN0aWNzZWFyY2g6IF9vYmplY3RTcHJlYWQoe30sIF90aGlzLnByb3BzLnJvbGUuZWxhc3RpY3NlYXJjaCwgewogICAgICAgICAgaW5kaWNlczogbmV3SW5kaWNlcwogICAgICAgIH0pCiAgICAgIH0pKTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIm9uSW5kZXhQcml2aWxlZ2VDaGFuZ2UiLCBmdW5jdGlvbiAocHJpdmlsZWdlSW5kZXgpIHsKICAgICAgcmV0dXJuIGZ1bmN0aW9uICh1cGRhdGVkUHJpdmlsZWdlKSB7CiAgICAgICAgdmFyIHJvbGUgPSBfdGhpcy5wcm9wcy5yb2xlOwogICAgICAgIHZhciBpbmRpY2VzID0gcm9sZS5lbGFzdGljc2VhcmNoLmluZGljZXM7CgogICAgICAgIHZhciBuZXdJbmRpY2VzID0gX3RvQ29uc3VtYWJsZUFycmF5KGluZGljZXMpOwoKICAgICAgICBuZXdJbmRpY2VzW3ByaXZpbGVnZUluZGV4XSA9IHVwZGF0ZWRQcml2aWxlZ2U7CgogICAgICAgIF90aGlzLnByb3BzLm9uQ2hhbmdlKF9vYmplY3RTcHJlYWQoe30sIF90aGlzLnByb3BzLnJvbGUsIHsKICAgICAgICAgIGVsYXN0aWNzZWFyY2g6IF9vYmplY3RTcHJlYWQoe30sIF90aGlzLnByb3BzLnJvbGUuZWxhc3RpY3NlYXJjaCwgewogICAgICAgICAgICBpbmRpY2VzOiBuZXdJbmRpY2VzCiAgICAgICAgICB9KQogICAgICAgIH0pKTsKCiAgICAgICAgX3RoaXMubG9hZEF2YWlsYWJsZUZpZWxkcyhuZXdJbmRpY2VzKTsKICAgICAgfTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIm9uSW5kZXhQcml2aWxlZ2VEZWxldGUiLCBmdW5jdGlvbiAocHJpdmlsZWdlSW5kZXgpIHsKICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgcm9sZSA9IF90aGlzLnByb3BzLnJvbGU7CgogICAgICAgIHZhciBuZXdJbmRpY2VzID0gX3RvQ29uc3VtYWJsZUFycmF5KHJvbGUuZWxhc3RpY3NlYXJjaC5pbmRpY2VzKTsKCiAgICAgICAgbmV3SW5kaWNlcy5zcGxpY2UocHJpdmlsZWdlSW5kZXgsIDEpOwoKICAgICAgICBfdGhpcy5wcm9wcy5vbkNoYW5nZShfb2JqZWN0U3ByZWFkKHt9LCBfdGhpcy5wcm9wcy5yb2xlLCB7CiAgICAgICAgICBlbGFzdGljc2VhcmNoOiBfb2JqZWN0U3ByZWFkKHt9LCBfdGhpcy5wcm9wcy5yb2xlLmVsYXN0aWNzZWFyY2gsIHsKICAgICAgICAgICAgaW5kaWNlczogbmV3SW5kaWNlcwogICAgICAgICAgfSkKICAgICAgICB9KSk7CiAgICAgIH07CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJpc1BsYWNlaG9sZGVyUHJpdmlsZWdlIiwgZnVuY3Rpb24gKGluZGV4UHJpdmlsZWdlKSB7CiAgICAgIHJldHVybiBpbmRleFByaXZpbGVnZS5uYW1lcy5sZW5ndGggPT09IDA7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJsb2FkRmllbGRzRm9yUGF0dGVybiIsIGZ1bmN0aW9uIF9jYWxsZWUocGF0dGVybikgewogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmFzeW5jKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGlmIChwYXR0ZXJuKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgX2RlZmluZVByb3BlcnR5KHt9LCBwYXR0ZXJuLCBbXSkpOwoKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAyOwogICAgICAgICAgICAgIF9jb250ZXh0LnQwID0gX2RlZmluZVByb3BlcnR5OwogICAgICAgICAgICAgIF9jb250ZXh0LnQxID0ge307CiAgICAgICAgICAgICAgX2NvbnRleHQudDIgPSBwYXR0ZXJuOwogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA4OwogICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAoKDAsIF9vYmplY3RzLmdldEZpZWxkcykoX3RoaXMucHJvcHMuaHR0cENsaWVudCwgcGF0dGVybikpOwoKICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgIF9jb250ZXh0LnQzID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCAoMCwgX2NvbnRleHQudDApKF9jb250ZXh0LnQxLCBfY29udGV4dC50MiwgX2NvbnRleHQudDMpKTsKCiAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDEyOwogICAgICAgICAgICAgIF9jb250ZXh0LnQ0ID0gX2NvbnRleHRbImNhdGNoIl0oMik7CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgX2RlZmluZVByb3BlcnR5KHt9LCBwYXR0ZXJuLCBbXSkpOwoKICAgICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgbnVsbCwgbnVsbCwgW1syLCAxMl1dKTsKICAgIH0pOwoKICAgIF90aGlzLnN0YXRlID0gewogICAgICBhdmFpbGFibGVGaWVsZHM6IHt9CiAgICB9OwogICAgcmV0dXJuIF90aGlzOwogIH0KCiAgX2NyZWF0ZUNsYXNzKEluZGV4UHJpdmlsZWdlcywgW3sKICAgIGtleTogImNvbXBvbmVudERpZE1vdW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnREaWRNb3VudCgpIHsKICAgICAgdGhpcy5sb2FkQXZhaWxhYmxlRmllbGRzKHRoaXMucHJvcHMucm9sZS5lbGFzdGljc2VhcmNoLmluZGljZXMpOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHZhciBfdGhpcyRwcm9wcyRyb2xlJGVsYXMgPSB0aGlzLnByb3BzLnJvbGUuZWxhc3RpY3NlYXJjaC5pbmRpY2VzLAogICAgICAgICAgaW5kaWNlcyA9IF90aGlzJHByb3BzJHJvbGUkZWxhcyA9PT0gdm9pZCAwID8gW10gOiBfdGhpcyRwcm9wcyRyb2xlJGVsYXM7CiAgICAgIHZhciBfdGhpcyRwcm9wcyA9IHRoaXMucHJvcHMsCiAgICAgICAgICBpbmRleFBhdHRlcm5zID0gX3RoaXMkcHJvcHMuaW5kZXhQYXR0ZXJucywKICAgICAgICAgIGFsbG93RG9jdW1lbnRMZXZlbFNlY3VyaXR5ID0gX3RoaXMkcHJvcHMuYWxsb3dEb2N1bWVudExldmVsU2VjdXJpdHksCiAgICAgICAgICBhbGxvd0ZpZWxkTGV2ZWxTZWN1cml0eSA9IF90aGlzJHByb3BzLmFsbG93RmllbGRMZXZlbFNlY3VyaXR5LAogICAgICAgICAgYXZhaWxhYmxlSW5kZXhQcml2aWxlZ2VzID0gX3RoaXMkcHJvcHMuYXZhaWxhYmxlSW5kZXhQcml2aWxlZ2VzOwogICAgICB2YXIgcHJvcHMgPSB7CiAgICAgICAgaW5kZXhQYXR0ZXJuczogaW5kZXhQYXR0ZXJucywKICAgICAgICAvLyBJZiBlZGl0aW5nIGFuIGV4aXN0aW5nIHJvbGUgd2hpbGUgdGhhdCBoYXMgYmVlbiBkaXNhYmxlZCwgYWx3YXlzIHNob3cgdGhlIEZMUy9ETFMgZmllbGRzIGJlY2F1c2UgY3VycmVudGx5CiAgICAgICAgLy8gYSByb2xlIGlzIG9ubHkgbWFya2VkIGFzIGRpc2FibGVkIGlmIGl0IGhhcyBGTFMvRExTIHNldHVwICh1c3VhbGx5IGJlZm9yZSB0aGUgdXNlciBjaGFuZ2VkIHRvIGEgbGljZW5zZSB0aGF0CiAgICAgICAgLy8gZG9lc24ndCBwZXJtaXQgRkxTL0RMUykuCiAgICAgICAgYWxsb3dEb2N1bWVudExldmVsU2VjdXJpdHk6IGFsbG93RG9jdW1lbnRMZXZlbFNlY3VyaXR5IHx8ICEoMCwgX3JvbGVfdXRpbHMuaXNSb2xlRW5hYmxlZCkodGhpcy5wcm9wcy5yb2xlKSwKICAgICAgICBhbGxvd0ZpZWxkTGV2ZWxTZWN1cml0eTogYWxsb3dGaWVsZExldmVsU2VjdXJpdHkgfHwgISgwLCBfcm9sZV91dGlscy5pc1JvbGVFbmFibGVkKSh0aGlzLnByb3BzLnJvbGUpLAogICAgICAgIGlzUmVhZE9ubHlSb2xlOiAoMCwgX3JvbGVfdXRpbHMuaXNSZWFkT25seVJvbGUpKHRoaXMucHJvcHMucm9sZSkKICAgICAgfTsKICAgICAgdmFyIGZvcm1zID0gaW5kaWNlcy5tYXAoZnVuY3Rpb24gKGluZGV4UHJpdmlsZWdlLCBpZHgpIHsKICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfaW5kZXhfcHJpdmlsZWdlX2Zvcm0uSW5kZXhQcml2aWxlZ2VGb3JtLCBfZXh0ZW5kcyh7CiAgICAgICAgICBrZXk6IGlkeAogICAgICAgIH0sIHByb3BzLCB7CiAgICAgICAgICBmb3JtSW5kZXg6IGlkeCwKICAgICAgICAgIHZhbGlkYXRvcjogX3RoaXMyLnByb3BzLnZhbGlkYXRvciwKICAgICAgICAgIGF2YWlsYWJsZUluZGV4UHJpdmlsZWdlczogYXZhaWxhYmxlSW5kZXhQcml2aWxlZ2VzLAogICAgICAgICAgaW5kZXhQcml2aWxlZ2U6IGluZGV4UHJpdmlsZWdlLAogICAgICAgICAgYXZhaWxhYmxlRmllbGRzOiBfdGhpczIuc3RhdGUuYXZhaWxhYmxlRmllbGRzW2luZGV4UHJpdmlsZWdlLm5hbWVzLmpvaW4oJywnKV0sCiAgICAgICAgICBvbkNoYW5nZTogX3RoaXMyLm9uSW5kZXhQcml2aWxlZ2VDaGFuZ2UoaWR4KSwKICAgICAgICAgIG9uRGVsZXRlOiBfdGhpczIub25JbmRleFByaXZpbGVnZURlbGV0ZShpZHgpCiAgICAgICAgfSkpOwogICAgICB9KTsKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LkZyYWdtZW50LCBudWxsLCBmb3Jtcyk7CiAgICB9CiAgfSwgewogICAga2V5OiAibG9hZEF2YWlsYWJsZUZpZWxkcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbG9hZEF2YWlsYWJsZUZpZWxkcyhwcml2aWxlZ2VzKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOyAvLyByZWFkb25seSByb2xlcyBjYW5ub3QgYmUgZWRpdGVkLCBhbmQgdGhlcmVmb3JlIGRvIG5vdCBuZWVkIHRvIGZldGNoIGF2YWlsYWJsZSBmaWVsZHMuCgoKICAgICAgaWYgKCgwLCBfcm9sZV91dGlscy5pc1JlYWRPbmx5Um9sZSkodGhpcy5wcm9wcy5yb2xlKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIHBhdHRlcm5zID0gcHJpdmlsZWdlcy5tYXAoZnVuY3Rpb24gKGluZGV4KSB7CiAgICAgICAgcmV0dXJuIGluZGV4Lm5hbWVzLmpvaW4oJywnKTsKICAgICAgfSk7CiAgICAgIHZhciBjYWNoZWRQYXR0ZXJucyA9IE9iamVjdC5rZXlzKHRoaXMuc3RhdGUuYXZhaWxhYmxlRmllbGRzKTsKCiAgICAgIHZhciBwYXR0ZXJuc1RvRmV0Y2ggPSBfbG9kYXNoLmRlZmF1bHQuZGlmZmVyZW5jZShwYXR0ZXJucywgY2FjaGVkUGF0dGVybnMpOwoKICAgICAgdmFyIGZldGNoUmVxdWVzdHMgPSBwYXR0ZXJuc1RvRmV0Y2gubWFwKHRoaXMubG9hZEZpZWxkc0ZvclBhdHRlcm4pOwogICAgICBQcm9taXNlLmFsbChmZXRjaFJlcXVlc3RzKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIF90aGlzMy5zZXRTdGF0ZSh7CiAgICAgICAgICBhdmFpbGFibGVGaWVsZHM6IF9vYmplY3RTcHJlYWQoe30sIF90aGlzMy5zdGF0ZS5hdmFpbGFibGVGaWVsZHMsIHt9LCByZXNwb25zZS5yZWR1Y2UoZnVuY3Rpb24gKGFjYywgbykgewogICAgICAgICAgICByZXR1cm4gX29iamVjdFNwcmVhZCh7fSwgYWNjLCB7fSwgbyk7CiAgICAgICAgICB9LCB7fSkpCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIEluZGV4UHJpdmlsZWdlczsKfShfcmVhY3QuQ29tcG9uZW50KTsKCmV4cG9ydHMuSW5kZXhQcml2aWxlZ2VzID0gSW5kZXhQcml2aWxlZ2VzOw=="},null]}