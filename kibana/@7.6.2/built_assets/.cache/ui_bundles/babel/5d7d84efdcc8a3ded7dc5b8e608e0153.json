{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/siem/public/pages/detection_engine/rules/components/step_about_rule/index.js","dependencies":[{"path":"x-pack/legacy/plugins/siem/public/pages/detection_engine/rules/components/step_about_rule/index.js","mtime":1585205047879},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLlN0ZXBBYm91dFJ1bGUgPSB2b2lkIDA7Cgp2YXIgX2V1aSA9IHJlcXVpcmUoIkBlbGFzdGljL2V1aSIpOwoKdmFyIF9mcCA9IHJlcXVpcmUoImxvZGFzaC9mcCIpOwoKdmFyIF9yZWFjdCA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoInJlYWN0IikpOwoKdmFyIF9zdHlsZWRDb21wb25lbnRzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJzdHlsZWQtY29tcG9uZW50cyIpKTsKCnZhciBfaGVscGVycyA9IHJlcXVpcmUoIi4uLy4uL2hlbHBlcnMiKTsKCnZhciBfdHlwZXMgPSByZXF1aXJlKCIuLi8uLi90eXBlcyIpOwoKdmFyIFJ1bGVJMThuID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgiLi4vLi4vdHJhbnNsYXRpb25zIikpOwoKdmFyIF9hZGRfaXRlbV9mb3JtID0gcmVxdWlyZSgiLi4vYWRkX2l0ZW1fZm9ybSIpOwoKdmFyIF9kZXNjcmlwdGlvbl9zdGVwID0gcmVxdWlyZSgiLi4vZGVzY3JpcHRpb25fc3RlcCIpOwoKdmFyIF9taXRyZSA9IHJlcXVpcmUoIi4uL21pdHJlIik7Cgp2YXIgX3NoYXJlZF9pbXBvcnRzID0gcmVxdWlyZSgiLi4vc2hhcmVkX2ltcG9ydHMiKTsKCnZhciBfZGF0YSA9IHJlcXVpcmUoIi4vZGF0YSIpOwoKdmFyIF9kZWZhdWx0X3ZhbHVlID0gcmVxdWlyZSgiLi9kZWZhdWx0X3ZhbHVlIik7Cgp2YXIgX2hlbHBlcnMyID0gcmVxdWlyZSgiLi9oZWxwZXJzIik7Cgp2YXIgX3NjaGVtYSA9IHJlcXVpcmUoIi4vc2NoZW1hIik7Cgp2YXIgSTE4biA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoIi4vdHJhbnNsYXRpb25zIikpOwoKdmFyIF9waWNrX3RpbWVsaW5lID0gcmVxdWlyZSgiLi4vcGlja190aW1lbGluZSIpOwoKdmFyIF9zdGVwX2NvbnRlbnRfd3JhcHBlciA9IHJlcXVpcmUoIi4uL3N0ZXBfY29udGVudF93cmFwcGVyIik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgewogIHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7CiAgICBkZWZhdWx0OiBvYmoKICB9Owp9CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsKICBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7CiAgICByZXR1cm4gb2JqOwogIH0gZWxzZSB7CiAgICB2YXIgbmV3T2JqID0ge307CgogICAgaWYgKG9iaiAhPSBudWxsKSB7CiAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHsKICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgewogICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvciA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpIDoge307CgogICAgICAgICAgaWYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSB7CiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmosIGtleSwgZGVzYyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBuZXdPYmpba2V5XSA9IG9ialtrZXldOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIG5ld09iai5kZWZhdWx0ID0gb2JqOwogICAgcmV0dXJuIG5ld09iajsKICB9Cn0KCmZ1bmN0aW9uIF9vYmplY3RXaXRob3V0UHJvcGVydGllcyhzb3VyY2UsIGV4Y2x1ZGVkKSB7CiAgaWYgKHNvdXJjZSA9PSBudWxsKSByZXR1cm4ge307CgogIHZhciB0YXJnZXQgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShzb3VyY2UsIGV4Y2x1ZGVkKTsKCiAgdmFyIGtleSwgaTsKCiAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsKICAgIHZhciBzb3VyY2VTeW1ib2xLZXlzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzb3VyY2UpOwoKICAgIGZvciAoaSA9IDA7IGkgPCBzb3VyY2VTeW1ib2xLZXlzLmxlbmd0aDsgaSsrKSB7CiAgICAgIGtleSA9IHNvdXJjZVN5bWJvbEtleXNbaV07CiAgICAgIGlmIChleGNsdWRlZC5pbmRleE9mKGtleSkgPj0gMCkgY29udGludWU7CiAgICAgIGlmICghT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKHNvdXJjZSwga2V5KSkgY29udGludWU7CiAgICAgIHRhcmdldFtrZXldID0gc291cmNlW2tleV07CiAgICB9CiAgfQoKICByZXR1cm4gdGFyZ2V0Owp9CgpmdW5jdGlvbiBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShzb3VyY2UsIGV4Y2x1ZGVkKSB7CiAgaWYgKHNvdXJjZSA9PSBudWxsKSByZXR1cm4ge307CiAgdmFyIHRhcmdldCA9IHt9OwogIHZhciBzb3VyY2VLZXlzID0gT2JqZWN0LmtleXMoc291cmNlKTsKICB2YXIga2V5LCBpOwoKICBmb3IgKGkgPSAwOyBpIDwgc291cmNlS2V5cy5sZW5ndGg7IGkrKykgewogICAga2V5ID0gc291cmNlS2V5c1tpXTsKICAgIGlmIChleGNsdWRlZC5pbmRleE9mKGtleSkgPj0gMCkgY29udGludWU7CiAgICB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldOwogIH0KCiAgcmV0dXJuIHRhcmdldDsKfQoKZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7CiAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOwoKICBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgewogICAgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7CiAgICBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7CiAgICAgIHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOwogICAgfSk7CiAgICBrZXlzLnB1c2guYXBwbHkoa2V5cywgc3ltYm9scyk7CiAgfQoKICByZXR1cm4ga2V5czsKfQoKZnVuY3Rpb24gX29iamVjdFNwcmVhZCh0YXJnZXQpIHsKICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgewogICAgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXSAhPSBudWxsID8gYXJndW1lbnRzW2ldIDoge307CgogICAgaWYgKGkgJSAyKSB7CiAgICAgIG93bktleXMoc291cmNlLCB0cnVlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsKICAgICAgfSk7CiAgICB9IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKSB7CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoc291cmNlKSk7CiAgICB9IGVsc2UgewogICAgICBvd25LZXlzKHNvdXJjZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwga2V5KSk7CiAgICAgIH0pOwogICAgfQogIH0KCiAgcmV0dXJuIHRhcmdldDsKfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgewogIGlmIChrZXkgaW4gb2JqKSB7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsKICAgICAgdmFsdWU6IHZhbHVlLAogICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgIHdyaXRhYmxlOiB0cnVlCiAgICB9KTsKICB9IGVsc2UgewogICAgb2JqW2tleV0gPSB2YWx1ZTsKICB9CgogIHJldHVybiBvYmo7Cn0KCmZ1bmN0aW9uIF9zbGljZWRUb0FycmF5KGFyciwgaSkgewogIHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB8fCBfbm9uSXRlcmFibGVSZXN0KCk7Cn0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVJlc3QoKSB7CiAgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIGRlc3RydWN0dXJlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZSIpOwp9CgpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB7CiAgdmFyIF9hcnIgPSBbXTsKICB2YXIgX24gPSB0cnVlOwogIHZhciBfZCA9IGZhbHNlOwogIHZhciBfZSA9IHVuZGVmaW5lZDsKCiAgdHJ5IHsKICAgIGZvciAodmFyIF9pID0gYXJyW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3M7ICEoX24gPSAoX3MgPSBfaS5uZXh0KCkpLmRvbmUpOyBfbiA9IHRydWUpIHsKICAgICAgX2Fyci5wdXNoKF9zLnZhbHVlKTsKCiAgICAgIGlmIChpICYmIF9hcnIubGVuZ3RoID09PSBpKSBicmVhazsKICAgIH0KICB9IGNhdGNoIChlcnIpIHsKICAgIF9kID0gdHJ1ZTsKICAgIF9lID0gZXJyOwogIH0gZmluYWxseSB7CiAgICB0cnkgewogICAgICBpZiAoIV9uICYmIF9pWyJyZXR1cm4iXSAhPSBudWxsKSBfaVsicmV0dXJuIl0oKTsKICAgIH0gZmluYWxseSB7CiAgICAgIGlmIChfZCkgdGhyb3cgX2U7CiAgICB9CiAgfQoKICByZXR1cm4gX2FycjsKfQoKZnVuY3Rpb24gX2FycmF5V2l0aEhvbGVzKGFycikgewogIGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBhcnI7Cn0KCnZhciBDb21tb25Vc2VGaWVsZCA9ICgwLCBfc2hhcmVkX2ltcG9ydHMuZ2V0VXNlRmllbGQpKHsKICBjb21wb25lbnQ6IF9zaGFyZWRfaW1wb3J0cy5GaWVsZAp9KTsKCnZhciBUYWdDb250YWluZXIgPSBfc3R5bGVkQ29tcG9uZW50cy5kZWZhdWx0LmRpdi53aXRoQ29uZmlnKHsKICBkaXNwbGF5TmFtZTogIlRhZ0NvbnRhaW5lciIsCiAgY29tcG9uZW50SWQ6ICJzYy0xaGt5dXZuLTAiCn0pKFsibWFyZ2luLXRvcDoxNnB4OyJdKTsKClRhZ0NvbnRhaW5lci5kaXNwbGF5TmFtZSA9ICdUYWdDb250YWluZXInOwp2YXIgQWR2YW5jZWRTZXR0aW5nc0FjY29yZGlvbiA9ICgwLCBfc3R5bGVkQ29tcG9uZW50cy5kZWZhdWx0KShfZXVpLkV1aUFjY29yZGlvbikud2l0aENvbmZpZyh7CiAgZGlzcGxheU5hbWU6ICJBZHZhbmNlZFNldHRpbmdzQWNjb3JkaW9uIiwKICBjb21wb25lbnRJZDogInNjLTFoa3l1dm4tMSIKfSkoWyIuZXVpQWNjb3JkaW9uX19pY29uV3JhcHBlcntkaXNwbGF5Om5vbmU7fS5ldWlBY2NvcmRpb25fX2NoaWxkV3JhcHBlcnt0cmFuc2l0aW9uLWR1cmF0aW9uOjFtczt9Ji5ldWlBY2NvcmRpb24taXNPcGVuIC5ldWlCdXR0b25FbXB0eV9fY29udGVudCA+IHN2Z3t0cmFuc2Zvcm06cm90YXRlKDkwZGVnKTt9Il0pOwoKdmFyIEFkdmFuY2VkU2V0dGluZ3NBY2NvcmRpb25CdXR0b24gPSBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQnV0dG9uRW1wdHksIHsKICBmbHVzaDogImxlZnQiLAogIHNpemU6ICJzIiwKICBpY29uVHlwZTogImFycm93UmlnaHQiCn0sIEkxOG4uQURWQU5DRURfU0VUVElOR1MpOwoKdmFyIFN0ZXBBYm91dFJ1bGVDb21wb25lbnQgPSBmdW5jdGlvbiBTdGVwQWJvdXRSdWxlQ29tcG9uZW50KF9yZWYpIHsKICB2YXIgX3JlZiRhZGRQYWRkaW5nID0gX3JlZi5hZGRQYWRkaW5nLAogICAgICBhZGRQYWRkaW5nID0gX3JlZiRhZGRQYWRkaW5nID09PSB2b2lkIDAgPyBmYWxzZSA6IF9yZWYkYWRkUGFkZGluZywKICAgICAgZGVmYXVsdFZhbHVlcyA9IF9yZWYuZGVmYXVsdFZhbHVlcywKICAgICAgX3JlZiRkZXNjcmlwdGlvbkRpcmVjID0gX3JlZi5kZXNjcmlwdGlvbkRpcmVjdGlvbiwKICAgICAgZGVzY3JpcHRpb25EaXJlY3Rpb24gPSBfcmVmJGRlc2NyaXB0aW9uRGlyZWMgPT09IHZvaWQgMCA/ICdyb3cnIDogX3JlZiRkZXNjcmlwdGlvbkRpcmVjLAogICAgICBpc1JlYWRPbmx5VmlldyA9IF9yZWYuaXNSZWFkT25seVZpZXcsCiAgICAgIF9yZWYkaXNVcGRhdGVWaWV3ID0gX3JlZi5pc1VwZGF0ZVZpZXcsCiAgICAgIGlzVXBkYXRlVmlldyA9IF9yZWYkaXNVcGRhdGVWaWV3ID09PSB2b2lkIDAgPyBmYWxzZSA6IF9yZWYkaXNVcGRhdGVWaWV3LAogICAgICBpc0xvYWRpbmcgPSBfcmVmLmlzTG9hZGluZywKICAgICAgc2V0Rm9ybSA9IF9yZWYuc2V0Rm9ybSwKICAgICAgc2V0U3RlcERhdGEgPSBfcmVmLnNldFN0ZXBEYXRhOwoKICB2YXIgX3VzZVN0YXRlID0gKDAsIF9yZWFjdC51c2VTdGF0ZSkoX2RlZmF1bHRfdmFsdWUuc3RlcEFib3V0RGVmYXVsdFZhbHVlKSwKICAgICAgX3VzZVN0YXRlMiA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZSwgMiksCiAgICAgIG15U3RlcERhdGEgPSBfdXNlU3RhdGUyWzBdLAogICAgICBzZXRNeVN0ZXBEYXRhID0gX3VzZVN0YXRlMlsxXTsKCiAgdmFyIF91c2VGb3JtID0gKDAsIF9zaGFyZWRfaW1wb3J0cy51c2VGb3JtKSh7CiAgICBkZWZhdWx0VmFsdWU6IG15U3RlcERhdGEsCiAgICBvcHRpb25zOiB7CiAgICAgIHN0cmlwRW1wdHlGaWVsZHM6IGZhbHNlCiAgICB9LAogICAgc2NoZW1hOiBfc2NoZW1hLnNjaGVtYQogIH0pLAogICAgICBmb3JtID0gX3VzZUZvcm0uZm9ybTsKCiAgdmFyIG9uU3VibWl0ID0gKDAsIF9yZWFjdC51c2VDYWxsYmFjaykoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgIHZhciBfcmVmMiwgaXNWYWxpZCwgZGF0YTsKCiAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmFzeW5jKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBpZiAoIXNldFN0ZXBEYXRhKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDg7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHNldFN0ZXBEYXRhKF90eXBlcy5SdWxlU3RlcC5hYm91dFJ1bGUsIG51bGwsIGZhbHNlKTsKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDQ7CiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAoZm9ybS5zdWJtaXQoKSk7CgogICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICBfcmVmMiA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgIGlzVmFsaWQgPSBfcmVmMi5pc1ZhbGlkOwogICAgICAgICAgICBkYXRhID0gX3JlZjIuZGF0YTsKCiAgICAgICAgICAgIGlmIChpc1ZhbGlkKSB7CiAgICAgICAgICAgICAgc2V0U3RlcERhdGEoX3R5cGVzLlJ1bGVTdGVwLmFib3V0UnVsZSwgZGF0YSwgaXNWYWxpZCk7CiAgICAgICAgICAgICAgc2V0TXlTdGVwRGF0YShfb2JqZWN0U3ByZWFkKHt9LCBkYXRhLCB7CiAgICAgICAgICAgICAgICBpc05ldzogZmFsc2UKICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSk7CiAgfSwgW2Zvcm1dKTsKICAoMCwgX3JlYWN0LnVzZUVmZmVjdCkoZnVuY3Rpb24gKCkgewogICAgdmFyIGlzTmV3ID0gbXlTdGVwRGF0YS5pc05ldywKICAgICAgICBpbml0RGVmYXVsdFZhbHVlID0gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzKG15U3RlcERhdGEsIFsiaXNOZXciXSk7CgogICAgaWYgKGRlZmF1bHRWYWx1ZXMgIT0gbnVsbCAmJiAhKDAsIF9mcC5pc0VxdWFsKShpbml0RGVmYXVsdFZhbHVlLCBkZWZhdWx0VmFsdWVzKSkgewogICAgICB2YXIgbXlEZWZhdWx0VmFsdWVzID0gX29iamVjdFNwcmVhZCh7fSwgZGVmYXVsdFZhbHVlcywgewogICAgICAgIGlzTmV3OiBmYWxzZQogICAgICB9KTsKCiAgICAgIHNldE15U3RlcERhdGEobXlEZWZhdWx0VmFsdWVzKTsKICAgICAgKDAsIF9oZWxwZXJzLnNldEZpZWxkVmFsdWUpKGZvcm0sIF9zY2hlbWEuc2NoZW1hLCBteURlZmF1bHRWYWx1ZXMpOwogICAgfQogIH0sIFtkZWZhdWx0VmFsdWVzXSk7CiAgKDAsIF9yZWFjdC51c2VFZmZlY3QpKGZ1bmN0aW9uICgpIHsKICAgIGlmIChzZXRGb3JtICE9IG51bGwpIHsKICAgICAgc2V0Rm9ybShfdHlwZXMuUnVsZVN0ZXAuYWJvdXRSdWxlLCBmb3JtKTsKICAgIH0KICB9LCBbZm9ybV0pOwogIHJldHVybiBpc1JlYWRPbmx5VmlldyAmJiBteVN0ZXBEYXRhLm5hbWUgIT0gbnVsbCA/IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3N0ZXBfY29udGVudF93cmFwcGVyLlN0ZXBDb250ZW50V3JhcHBlciwgewogICAgYWRkUGFkZGluZzogYWRkUGFkZGluZwogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2Rlc2NyaXB0aW9uX3N0ZXAuU3RlcFJ1bGVEZXNjcmlwdGlvbiwgewogICAgZGlyZWN0aW9uOiBkZXNjcmlwdGlvbkRpcmVjdGlvbiwKICAgIHNjaGVtYTogX3NjaGVtYS5zY2hlbWEsCiAgICBkYXRhOiBteVN0ZXBEYXRhCiAgfSkpIDogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuZGVmYXVsdC5GcmFnbWVudCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfc3RlcF9jb250ZW50X3dyYXBwZXIuU3RlcENvbnRlbnRXcmFwcGVyLCB7CiAgICBhZGRQYWRkaW5nOiAhaXNVcGRhdGVWaWV3CiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfc2hhcmVkX2ltcG9ydHMuRm9ybSwgewogICAgZm9ybTogZm9ybSwKICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJzdGVwQWJvdXRSdWxlIgogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoQ29tbW9uVXNlRmllbGQsIHsKICAgIHBhdGg6ICJuYW1lIiwKICAgIGNvbXBvbmVudFByb3BzOiB7CiAgICAgIGlkQXJpYTogJ2RldGVjdGlvbkVuZ2luZVN0ZXBBYm91dFJ1bGVOYW1lJywKICAgICAgJ2RhdGEtdGVzdC1zdWJqJzogJ2RldGVjdGlvbkVuZ2luZVN0ZXBBYm91dFJ1bGVOYW1lJywKICAgICAgZXVpRmllbGRQcm9wczogewogICAgICAgIGZ1bGxXaWR0aDogZmFsc2UsCiAgICAgICAgZGlzYWJsZWQ6IGlzTG9hZGluZwogICAgICB9CiAgICB9CiAgfSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoQ29tbW9uVXNlRmllbGQsIHsKICAgIHBhdGg6ICJkZXNjcmlwdGlvbiIsCiAgICBjb21wb25lbnRQcm9wczogewogICAgICBpZEFyaWE6ICdkZXRlY3Rpb25FbmdpbmVTdGVwQWJvdXRSdWxlRGVzY3JpcHRpb24nLAogICAgICAnZGF0YS10ZXN0LXN1YmonOiAnZGV0ZWN0aW9uRW5naW5lU3RlcEFib3V0UnVsZURlc2NyaXB0aW9uJywKICAgICAgZXVpRmllbGRQcm9wczogewogICAgICAgIGRpc2FibGVkOiBpc0xvYWRpbmcKICAgICAgfQogICAgfQogIH0pLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3BhY2VyLCB7CiAgICBzaXplOiAibSIKICB9KSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhHcm91cCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KENvbW1vblVzZUZpZWxkLCB7CiAgICBwYXRoOiAic2V2ZXJpdHkiLAogICAgY29tcG9uZW50UHJvcHM6IHsKICAgICAgaWRBcmlhOiAnZGV0ZWN0aW9uRW5naW5lU3RlcEFib3V0UnVsZVNldmVyaXR5JywKICAgICAgJ2RhdGEtdGVzdC1zdWJqJzogJ2RldGVjdGlvbkVuZ2luZVN0ZXBBYm91dFJ1bGVTZXZlcml0eScsCiAgICAgIGV1aUZpZWxkUHJvcHM6IHsKICAgICAgICBmdWxsV2lkdGg6IGZhbHNlLAogICAgICAgIGRpc2FibGVkOiBpc0xvYWRpbmcsCiAgICAgICAgb3B0aW9uczogX2RhdGEuc2V2ZXJpdHlPcHRpb25zCiAgICAgIH0KICAgIH0KICB9KSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChDb21tb25Vc2VGaWVsZCwgewogICAgcGF0aDogInJpc2tTY29yZSIsCiAgICBjb21wb25lbnRQcm9wczogewogICAgICBpZEFyaWE6ICdkZXRlY3Rpb25FbmdpbmVTdGVwQWJvdXRSdWxlUmlza1Njb3JlJywKICAgICAgJ2RhdGEtdGVzdC1zdWJqJzogJ2RldGVjdGlvbkVuZ2luZVN0ZXBBYm91dFJ1bGVSaXNrU2NvcmUnLAogICAgICBldWlGaWVsZFByb3BzOiB7CiAgICAgICAgbWF4OiAxMDAsCiAgICAgICAgbWluOiAwLAogICAgICAgIGZ1bGxXaWR0aDogZmFsc2UsCiAgICAgICAgZGlzYWJsZWQ6IGlzTG9hZGluZywKICAgICAgICBzaG93VGlja3M6IHRydWUsCiAgICAgICAgdGlja0ludGVydmFsOiAyNQogICAgICB9CiAgICB9CiAgfSkpKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChUYWdDb250YWluZXIsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoQ29tbW9uVXNlRmllbGQsIHsKICAgIHBhdGg6ICJ0YWdzIiwKICAgIGNvbXBvbmVudFByb3BzOiB7CiAgICAgIGlkQXJpYTogJ2RldGVjdGlvbkVuZ2luZVN0ZXBBYm91dFJ1bGVUYWdzJywKICAgICAgJ2RhdGEtdGVzdC1zdWJqJzogJ2RldGVjdGlvbkVuZ2luZVN0ZXBBYm91dFJ1bGVUYWdzJywKICAgICAgZXVpRmllbGRQcm9wczogewogICAgICAgIGZ1bGxXaWR0aDogdHJ1ZSwKICAgICAgICBpc0Rpc2FibGVkOiBpc0xvYWRpbmcsCiAgICAgICAgcGxhY2Vob2xkZXI6ICcnCiAgICAgIH0KICAgIH0KICB9KSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTcGFjZXIsIHsKICAgIHNpemU6ICJtIgogIH0pLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KEFkdmFuY2VkU2V0dGluZ3NBY2NvcmRpb24sIHsKICAgIGlkOiAiYWR2YW5jZWRTZXR0aW5nc0FjY29yZGlvbiIsCiAgICBidXR0b25Db250ZW50OiBBZHZhbmNlZFNldHRpbmdzQWNjb3JkaW9uQnV0dG9uCiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgewogICAgc2l6ZTogIm0iCiAgfSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3NoYXJlZF9pbXBvcnRzLlVzZUZpZWxkLCB7CiAgICBwYXRoOiAidGltZWxpbmUiLAogICAgY29tcG9uZW50OiBfcGlja190aW1lbGluZS5QaWNrVGltZWxpbmUsCiAgICBjb21wb25lbnRQcm9wczogewogICAgICBpZEFyaWE6ICdkZXRlY3Rpb25FbmdpbmVTdGVwQWJvdXRSdWxlVGltZWxpbmUnLAogICAgICBpc0Rpc2FibGVkOiBpc0xvYWRpbmcsCiAgICAgIGRhdGFUZXN0U3ViajogJ2RldGVjdGlvbkVuZ2luZVN0ZXBBYm91dFJ1bGVUaW1lbGluZScKICAgIH0KICB9KSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfc2hhcmVkX2ltcG9ydHMuVXNlRmllbGQsIHsKICAgIHBhdGg6ICJyZWZlcmVuY2VzIiwKICAgIGNvbXBvbmVudDogX2FkZF9pdGVtX2Zvcm0uQWRkSXRlbSwKICAgIGNvbXBvbmVudFByb3BzOiB7CiAgICAgIGFkZFRleHQ6IEkxOG4uQUREX1JFRkVSRU5DRSwKICAgICAgaWRBcmlhOiAnZGV0ZWN0aW9uRW5naW5lU3RlcEFib3V0UnVsZVJlZmVyZW5jZVVybHMnLAogICAgICBpc0Rpc2FibGVkOiBpc0xvYWRpbmcsCiAgICAgIGRhdGFUZXN0U3ViajogJ2RldGVjdGlvbkVuZ2luZVN0ZXBBYm91dFJ1bGVSZWZlcmVuY2VVcmxzJywKICAgICAgdmFsaWRhdGU6IF9oZWxwZXJzMi5pc1VybEludmFsaWQKICAgIH0KICB9KSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfc2hhcmVkX2ltcG9ydHMuVXNlRmllbGQsIHsKICAgIHBhdGg6ICJmYWxzZVBvc2l0aXZlcyIsCiAgICBjb21wb25lbnQ6IF9hZGRfaXRlbV9mb3JtLkFkZEl0ZW0sCiAgICBjb21wb25lbnRQcm9wczogewogICAgICBhZGRUZXh0OiBJMThuLkFERF9GQUxTRV9QT1NJVElWRSwKICAgICAgaWRBcmlhOiAnZGV0ZWN0aW9uRW5naW5lU3RlcEFib3V0UnVsZUZhbHNlUG9zaXRpdmVzJywKICAgICAgaXNEaXNhYmxlZDogaXNMb2FkaW5nLAogICAgICBkYXRhVGVzdFN1Ymo6ICdkZXRlY3Rpb25FbmdpbmVTdGVwQWJvdXRSdWxlRmFsc2VQb3NpdGl2ZXMnCiAgICB9CiAgfSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3NoYXJlZF9pbXBvcnRzLlVzZUZpZWxkLCB7CiAgICBwYXRoOiAidGhyZWF0IiwKICAgIGNvbXBvbmVudDogX21pdHJlLkFkZE1pdHJlVGhyZWF0LAogICAgY29tcG9uZW50UHJvcHM6IHsKICAgICAgaWRBcmlhOiAnZGV0ZWN0aW9uRW5naW5lU3RlcEFib3V0UnVsZU1pdHJlVGhyZWF0JywKICAgICAgaXNEaXNhYmxlZDogaXNMb2FkaW5nLAogICAgICBkYXRhVGVzdFN1Ymo6ICdkZXRlY3Rpb25FbmdpbmVTdGVwQWJvdXRSdWxlTWl0cmVUaHJlYXQnCiAgICB9CiAgfSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9zaGFyZWRfaW1wb3J0cy5Gb3JtRGF0YVByb3ZpZGVyLCB7CiAgICBwYXRoc1RvV2F0Y2g6ICJzZXZlcml0eSIKICB9LCBmdW5jdGlvbiAoX3JlZjMpIHsKICAgIHZhciBzZXZlcml0eSA9IF9yZWYzLnNldmVyaXR5OwogICAgdmFyIG5ld1Jpc2tTY29yZSA9IF9kYXRhLmRlZmF1bHRSaXNrU2NvcmVCeVNldmVyaXR5W3NldmVyaXR5XTsKICAgIHZhciBzZXZlcml0eUZpZWxkID0gZm9ybS5nZXRGaWVsZHMoKS5zZXZlcml0eTsKICAgIHZhciByaXNrU2NvcmVGaWVsZCA9IGZvcm0uZ2V0RmllbGRzKCkucmlza1Njb3JlOwoKICAgIGlmIChzZXZlcml0eUZpZWxkLnZhbHVlICE9PSBzZXZlcml0eSAmJiBuZXdSaXNrU2NvcmUgIT0gbnVsbCAmJiByaXNrU2NvcmVGaWVsZC52YWx1ZSAhPT0gbmV3Umlza1Njb3JlKSB7CiAgICAgIHJpc2tTY29yZUZpZWxkLnNldFZhbHVlKG5ld1Jpc2tTY29yZSk7CiAgICB9CgogICAgcmV0dXJuIG51bGw7CiAgfSkpKSwgIWlzVXBkYXRlVmlldyAmJiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5kZWZhdWx0LkZyYWdtZW50LCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpSG9yaXpvbnRhbFJ1bGUsIHsKICAgIG1hcmdpbjogIm0iCiAgfSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4R3JvdXAsIHsKICAgIGFsaWduSXRlbXM6ICJjZW50ZXIiLAogICAganVzdGlmeUNvbnRlbnQ6ICJmbGV4RW5kIiwKICAgIGd1dHRlclNpemU6ICJ4cyIsCiAgICByZXNwb25zaXZlOiBmYWxzZQogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgZ3JvdzogZmFsc2UKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQnV0dG9uLCB7CiAgICBmaWxsOiB0cnVlLAogICAgb25DbGljazogb25TdWJtaXQsCiAgICBpc0Rpc2FibGVkOiBpc0xvYWRpbmcKICB9LCBSdWxlSTE4bi5DT05USU5VRSkpKSkpOwp9OwoKdmFyIFN0ZXBBYm91dFJ1bGUgPSAoMCwgX3JlYWN0Lm1lbW8pKFN0ZXBBYm91dFJ1bGVDb21wb25lbnQpOwpleHBvcnRzLlN0ZXBBYm91dFJ1bGUgPSBTdGVwQWJvdXRSdWxlOw=="},null]}