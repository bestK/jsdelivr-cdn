{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/ml/public/application/settings/calendars/edit/new_calendar.js","dependencies":[{"path":"x-pack/legacy/plugins/ml/public/application/settings/calendars/edit/new_calendar.js","mtime":1585205045964},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLk5ld0NhbGVuZGFyID0gdm9pZCAwOwoKdmFyIF9yZWFjdCA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoInJlYWN0IikpOwoKdmFyIF9wcm9wVHlwZXMgPSByZXF1aXJlKCJwcm9wLXR5cGVzIik7Cgp2YXIgX3JlYWN0MiA9IHJlcXVpcmUoIkBrYm4vaTE4bi9yZWFjdCIpOwoKdmFyIF9ldWkgPSByZXF1aXJlKCJAZWxhc3RpYy9ldWkiKTsKCnZhciBfbm90aWZ5ID0gcmVxdWlyZSgidWkvbm90aWZ5Iik7Cgp2YXIgX25hdmlnYXRpb25fbWVudSA9IHJlcXVpcmUoIi4uLy4uLy4uL2NvbXBvbmVudHMvbmF2aWdhdGlvbl9tZW51Iik7Cgp2YXIgX3V0aWxzID0gcmVxdWlyZSgiLi91dGlscyIpOwoKdmFyIF9jYWxlbmRhcl9mb3JtID0gcmVxdWlyZSgiLi9jYWxlbmRhcl9mb3JtIik7Cgp2YXIgX25ld19ldmVudF9tb2RhbCA9IHJlcXVpcmUoIi4vbmV3X2V2ZW50X21vZGFsIik7Cgp2YXIgX2ltcG9ydF9tb2RhbCA9IHJlcXVpcmUoIi4vaW1wb3J0X21vZGFsIik7Cgp2YXIgX21sX2FwaV9zZXJ2aWNlID0gcmVxdWlyZSgiLi4vLi4vLi4vc2VydmljZXMvbWxfYXBpX3NlcnZpY2UiKTsKCnZhciBfY2xhc3MsIF90ZW1wOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7IGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsgcmV0dXJuIG9iajsgfSBlbHNlIHsgdmFyIG5ld09iaiA9IHt9OyBpZiAob2JqICE9IG51bGwpIHsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgeyB2YXIgZGVzYyA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSAmJiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID8gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIGtleSkgOiB7fTsgaWYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmosIGtleSwgZGVzYyk7IH0gZWxzZSB7IG5ld09ialtrZXldID0gb2JqW2tleV07IH0gfSB9IH0gbmV3T2JqLmRlZmF1bHQgPSBvYmo7IHJldHVybiBuZXdPYmo7IH0gfQoKZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gInN5bWJvbCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9CgpmdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7IHJldHVybiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5KGFycikgfHwgX25vbkl0ZXJhYmxlU3ByZWFkKCk7IH0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVNwcmVhZCgpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIHNwcmVhZCBub24taXRlcmFibGUgaW5zdGFuY2UiKTsgfQoKZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheShpdGVyKSB7IGlmIChTeW1ib2wuaXRlcmF0b3IgaW4gT2JqZWN0KGl0ZXIpIHx8IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChpdGVyKSA9PT0gIltvYmplY3QgQXJndW1lbnRzXSIpIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpOyB9CgpmdW5jdGlvbiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB7IGlmIChBcnJheS5pc0FycmF5KGFycikpIHsgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkoYXJyLmxlbmd0aCk7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHsgYXJyMltpXSA9IGFycltpXTsgfSByZXR1cm4gYXJyMjsgfSB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9CgpmdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfQoKZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpKSB7IHJldHVybiBjYWxsOyB9IHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOyB9CgpmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyBfZ2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3QuZ2V0UHJvdG90eXBlT2YgOiBmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyByZXR1cm4gby5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKG8pOyB9OyByZXR1cm4gX2dldFByb3RvdHlwZU9mKG8pOyB9CgpmdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsgaWYgKHNlbGYgPT09IHZvaWQgMCkgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOyB9IHJldHVybiBzZWxmOyB9CgpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAiZnVuY3Rpb24iICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24iKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBfc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpOyB9CgpmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgby5fX3Byb3RvX18gPSBwOyByZXR1cm4gbzsgfTsgcmV0dXJuIF9zZXRQcm90b3R5cGVPZihvLCBwKTsgfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgeyBpZiAoa2V5IGluIG9iaikgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsgdmFsdWU6IHZhbHVlLCBlbnVtZXJhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlIH0pOyB9IGVsc2UgeyBvYmpba2V5XSA9IHZhbHVlOyB9IHJldHVybiBvYmo7IH0KCnZhciBOZXdDYWxlbmRhciA9ICgwLCBfcmVhY3QyLmluamVjdEkxOG4pKChfdGVtcCA9IF9jbGFzcyA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKF9Db21wb25lbnQpIHsKICBfaW5oZXJpdHMoTmV3Q2FsZW5kYXIsIF9Db21wb25lbnQpOwoKICBmdW5jdGlvbiBOZXdDYWxlbmRhcihwcm9wcykgewogICAgdmFyIF90aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBOZXdDYWxlbmRhcik7CgogICAgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfZ2V0UHJvdG90eXBlT2YoTmV3Q2FsZW5kYXIpLmNhbGwodGhpcywgcHJvcHMpKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJpc0R1cGxpY2F0ZUlkIiwgZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3RoaXMkc3RhdGUgPSBfdGhpcy5zdGF0ZSwKICAgICAgICAgIGNhbGVuZGFycyA9IF90aGlzJHN0YXRlLmNhbGVuZGFycywKICAgICAgICAgIGZvcm1DYWxlbmRhcklkID0gX3RoaXMkc3RhdGUuZm9ybUNhbGVuZGFySWQ7CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNhbGVuZGFycy5sZW5ndGg7IGkrKykgewogICAgICAgIGlmIChjYWxlbmRhcnNbaV0uY2FsZW5kYXJfaWQgPT09IGZvcm1DYWxlbmRhcklkKSB7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIm9uQ3JlYXRlIiwgZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgdmFyIGZvcm1DYWxlbmRhcklkLCBpbnRsLCBjYWxlbmRhcjsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hc3luYyhmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBmb3JtQ2FsZW5kYXJJZCA9IF90aGlzLnN0YXRlLmZvcm1DYWxlbmRhcklkOwogICAgICAgICAgICAgIGludGwgPSBfdGhpcy5wcm9wcy5pbnRsOwoKICAgICAgICAgICAgICBpZiAoIV90aGlzLmlzRHVwbGljYXRlSWQoKSkgewogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDY7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIF9ub3RpZnkudG9hc3ROb3RpZmljYXRpb25zLmFkZERhbmdlcihpbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgICAgICAgaWQ6ICd4cGFjay5tbC5jYWxlbmRhcnNFZGl0LmNhbk5vdENyZWF0ZUNhbGVuZGFyV2l0aEV4aXN0aW5nSWRFcnJvck1lc3NhZycsCiAgICAgICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0Nhbm5vdCBjcmVhdGUgY2FsZW5kYXIgd2l0aCBpZCBbe2Zvcm1DYWxlbmRhcklkfV0gYXMgaXQgYWxyZWFkeSBleGlzdHMuJwogICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIGZvcm1DYWxlbmRhcklkOiBmb3JtQ2FsZW5kYXJJZAogICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE5OwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgIGNhbGVuZGFyID0gX3RoaXMuc2V0VXBDYWxlbmRhckZvckFwaSgpOwoKICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICBzYXZpbmc6IHRydWUKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDg7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDExOwogICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAoX21sX2FwaV9zZXJ2aWNlLm1sLmFkZENhbGVuZGFyKGNhbGVuZGFyKSk7CgogICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbiA9ICcjL3NldHRpbmdzL2NhbGVuZGFyc19saXN0JzsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTk7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAxNDsKICAgICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDgpOwogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFcnJvciBzYXZpbmcgY2FsZW5kYXInLCBfY29udGV4dC50MCk7CgogICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgIHNhdmluZzogZmFsc2UKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgX25vdGlmeS50b2FzdE5vdGlmaWNhdGlvbnMuYWRkRGFuZ2VyKGludGwuZm9ybWF0TWVzc2FnZSh7CiAgICAgICAgICAgICAgICBpZDogJ3hwYWNrLm1sLmNhbGVuZGFyc0VkaXQuZXJyb3JXaXRoQ3JlYXRpbmdDYWxlbmRhckVycm9yTWVzc2FnZScsCiAgICAgICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0FuIGVycm9yIG9jY3VycmVkIGNyZWF0aW5nIGNhbGVuZGFyIHtjYWxlbmRhcklkfScKICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICBjYWxlbmRhcklkOiBjYWxlbmRhci5jYWxlbmRhcklkCiAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgY2FzZSAxOToKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgbnVsbCwgbnVsbCwgW1s4LCAxNF1dKTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIm9uRWRpdCIsIGZ1bmN0aW9uIF9jYWxsZWUyKCkgewogICAgICB2YXIgY2FsZW5kYXI7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXN5bmMoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGNhbGVuZGFyID0gX3RoaXMuc2V0VXBDYWxlbmRhckZvckFwaSgpOwoKICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICBzYXZpbmc6IHRydWUKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgX2NvbnRleHQyLnByZXYgPSAyOwogICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNTsKICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKF9tbF9hcGlfc2VydmljZS5tbC51cGRhdGVDYWxlbmRhcihjYWxlbmRhcikpOwoKICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbiA9ICcjL3NldHRpbmdzL2NhbGVuZGFyc19saXN0JzsKICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDEzOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgIF9jb250ZXh0Mi5wcmV2ID0gODsKICAgICAgICAgICAgICBfY29udGV4dDIudDAgPSBfY29udGV4dDJbImNhdGNoIl0oMik7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0Vycm9yIHNhdmluZyBjYWxlbmRhcicsIF9jb250ZXh0Mi50MCk7CgogICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgIHNhdmluZzogZmFsc2UKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgX25vdGlmeS50b2FzdE5vdGlmaWNhdGlvbnMuYWRkRGFuZ2VyKF90aGlzLnByb3BzLmludGwuZm9ybWF0TWVzc2FnZSh7CiAgICAgICAgICAgICAgICBpZDogJ3hwYWNrLm1sLmNhbGVuZGFyc0VkaXQuZXJyb3JXaXRoVXBkYXRpbmdDYWxlbmRhckVycm9yTWVzc2FnZScsCiAgICAgICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0FuIGVycm9yIG9jY3VycmVkIHNhdmluZyBjYWxlbmRhciB7Y2FsZW5kYXJJZH0uIFRyeSByZWZyZXNoaW5nIHRoZSBwYWdlLicKICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICBjYWxlbmRhcklkOiBjYWxlbmRhci5jYWxlbmRhcklkCiAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIG51bGwsIG51bGwsIFtbMiwgOF1dKTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInNldFVwQ2FsZW5kYXJGb3JBcGkiLCBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfdGhpcyRzdGF0ZTIgPSBfdGhpcy5zdGF0ZSwKICAgICAgICAgIGZvcm1DYWxlbmRhcklkID0gX3RoaXMkc3RhdGUyLmZvcm1DYWxlbmRhcklkLAogICAgICAgICAgZGVzY3JpcHRpb24gPSBfdGhpcyRzdGF0ZTIuZGVzY3JpcHRpb24sCiAgICAgICAgICBldmVudHMgPSBfdGhpcyRzdGF0ZTIuZXZlbnRzLAogICAgICAgICAgc2VsZWN0ZWRHcm91cE9wdGlvbnMgPSBfdGhpcyRzdGF0ZTIuc2VsZWN0ZWRHcm91cE9wdGlvbnMsCiAgICAgICAgICBzZWxlY3RlZEpvYk9wdGlvbnMgPSBfdGhpcyRzdGF0ZTIuc2VsZWN0ZWRKb2JPcHRpb25zOwogICAgICB2YXIgam9iSWRzID0gc2VsZWN0ZWRKb2JPcHRpb25zLm1hcChmdW5jdGlvbiAob3B0aW9uKSB7CiAgICAgICAgcmV0dXJuIG9wdGlvbi5sYWJlbDsKICAgICAgfSk7CiAgICAgIHZhciBncm91cElkcyA9IHNlbGVjdGVkR3JvdXBPcHRpb25zLm1hcChmdW5jdGlvbiAob3B0aW9uKSB7CiAgICAgICAgcmV0dXJuIG9wdGlvbi5sYWJlbDsKICAgICAgfSk7IC8vIFJlZHVjZSBldmVudHMgdG8gZmllbGRzIGV4cGVjdGVkIGJ5IGFwaQoKICAgICAgdmFyIGV2ZW50c1RvU2F2ZSA9IGV2ZW50cy5tYXAoZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIGRlc2NyaXB0aW9uOiBldmVudC5kZXNjcmlwdGlvbiwKICAgICAgICAgIHN0YXJ0X3RpbWU6IGV2ZW50LnN0YXJ0X3RpbWUsCiAgICAgICAgICBlbmRfdGltZTogZXZlbnQuZW5kX3RpbWUKICAgICAgICB9OwogICAgICB9KTsgLy8gc2V0IHVwIGNhbGVuZGFyCgogICAgICB2YXIgY2FsZW5kYXIgPSB7CiAgICAgICAgY2FsZW5kYXJJZDogZm9ybUNhbGVuZGFySWQsCiAgICAgICAgZGVzY3JpcHRpb246IGRlc2NyaXB0aW9uLAogICAgICAgIGV2ZW50czogZXZlbnRzVG9TYXZlLAogICAgICAgIGpvYl9pZHM6IFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkoam9iSWRzKSwgX3RvQ29uc3VtYWJsZUFycmF5KGdyb3VwSWRzKSkKICAgICAgfTsKICAgICAgcmV0dXJuIGNhbGVuZGFyOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAib25DcmVhdGVHcm91cE9wdGlvbiIsIGZ1bmN0aW9uIChuZXdHcm91cCkgewogICAgICB2YXIgbmV3T3B0aW9uID0gewogICAgICAgIGxhYmVsOiBuZXdHcm91cAogICAgICB9OyAvLyBTZWxlY3QgdGhlIG9wdGlvbi4KCiAgICAgIF90aGlzLnNldFN0YXRlKGZ1bmN0aW9uIChwcmV2U3RhdGUpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgc2VsZWN0ZWRHcm91cE9wdGlvbnM6IHByZXZTdGF0ZS5zZWxlY3RlZEdyb3VwT3B0aW9ucy5jb25jYXQobmV3T3B0aW9uKQogICAgICAgIH07CiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAib25Kb2JTZWxlY3Rpb24iLCBmdW5jdGlvbiAoc2VsZWN0ZWRKb2JPcHRpb25zKSB7CiAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICBzZWxlY3RlZEpvYk9wdGlvbnM6IHNlbGVjdGVkSm9iT3B0aW9ucwogICAgICB9KTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIm9uR3JvdXBTZWxlY3Rpb24iLCBmdW5jdGlvbiAoc2VsZWN0ZWRHcm91cE9wdGlvbnMpIHsKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIHNlbGVjdGVkR3JvdXBPcHRpb25zOiBzZWxlY3RlZEdyb3VwT3B0aW9ucwogICAgICB9KTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIm9uQ2FsZW5kYXJJZENoYW5nZSIsIGZ1bmN0aW9uIChlKSB7CiAgICAgIHZhciBpc1ZhbGlkID0gKDAsIF91dGlscy52YWxpZGF0ZUNhbGVuZGFySWQpKGUudGFyZ2V0LnZhbHVlKTsKCiAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICBmb3JtQ2FsZW5kYXJJZDogZS50YXJnZXQudmFsdWUsCiAgICAgICAgaXNOZXdDYWxlbmRhcklkVmFsaWQ6IGlzVmFsaWQKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJvbkRlc2NyaXB0aW9uQ2hhbmdlIiwgZnVuY3Rpb24gKGUpIHsKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIGRlc2NyaXB0aW9uOiBlLnRhcmdldC52YWx1ZQogICAgICB9KTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInNob3dJbXBvcnRNb2RhbCIsIGZ1bmN0aW9uICgpIHsKICAgICAgX3RoaXMuc2V0U3RhdGUoZnVuY3Rpb24gKHByZXZTdGF0ZSkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICBpc0ltcG9ydE1vZGFsVmlzaWJsZTogIXByZXZTdGF0ZS5pc0ltcG9ydE1vZGFsVmlzaWJsZQogICAgICAgIH07CiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiY2xvc2VJbXBvcnRNb2RhbCIsIGZ1bmN0aW9uICgpIHsKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIGlzSW1wb3J0TW9kYWxWaXNpYmxlOiBmYWxzZQogICAgICB9KTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIm9uRXZlbnREZWxldGUiLCBmdW5jdGlvbiAoZXZlbnRJZCkgewogICAgICBfdGhpcy5zZXRTdGF0ZShmdW5jdGlvbiAocHJldlN0YXRlKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIGV2ZW50czogcHJldlN0YXRlLmV2ZW50cy5maWx0ZXIoZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgICAgIHJldHVybiBldmVudC5ldmVudF9pZCAhPT0gZXZlbnRJZDsKICAgICAgICAgIH0pCiAgICAgICAgfTsKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJjbG9zZU5ld0V2ZW50TW9kYWwiLCBmdW5jdGlvbiAoKSB7CiAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICBpc05ld0V2ZW50TW9kYWxWaXNpYmxlOiBmYWxzZQogICAgICB9KTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInNob3dOZXdFdmVudE1vZGFsIiwgZnVuY3Rpb24gKCkgewogICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgaXNOZXdFdmVudE1vZGFsVmlzaWJsZTogdHJ1ZQogICAgICB9KTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImFkZEV2ZW50IiwgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgIF90aGlzLnNldFN0YXRlKGZ1bmN0aW9uIChwcmV2U3RhdGUpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgZXZlbnRzOiBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KHByZXZTdGF0ZS5ldmVudHMpLCBbZXZlbnRdKSwKICAgICAgICAgIGlzTmV3RXZlbnRNb2RhbFZpc2libGU6IGZhbHNlCiAgICAgICAgfTsKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJhZGRJbXBvcnRlZEV2ZW50cyIsIGZ1bmN0aW9uIChldmVudHMpIHsKICAgICAgX3RoaXMuc2V0U3RhdGUoZnVuY3Rpb24gKHByZXZTdGF0ZSkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICBldmVudHM6IFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkocHJldlN0YXRlLmV2ZW50cyksIF90b0NvbnN1bWFibGVBcnJheShldmVudHMpKSwKICAgICAgICAgIGlzSW1wb3J0TW9kYWxWaXNpYmxlOiBmYWxzZQogICAgICAgIH07CiAgICAgIH0pOwogICAgfSk7CgogICAgX3RoaXMuc3RhdGUgPSB7CiAgICAgIGlzTmV3RXZlbnRNb2RhbFZpc2libGU6IGZhbHNlLAogICAgICBpc0ltcG9ydE1vZGFsVmlzaWJsZTogZmFsc2UsCiAgICAgIGlzTmV3Q2FsZW5kYXJJZFZhbGlkOiBudWxsLAogICAgICBsb2FkaW5nOiB0cnVlLAogICAgICBqb2JJZHM6IFtdLAogICAgICBqb2JJZE9wdGlvbnM6IFtdLAogICAgICBncm91cElkczogW10sCiAgICAgIGdyb3VwSWRPcHRpb25zOiBbXSwKICAgICAgY2FsZW5kYXJzOiBbXSwKICAgICAgZm9ybUNhbGVuZGFySWQ6ICcnLAogICAgICBkZXNjcmlwdGlvbjogJycsCiAgICAgIHNlbGVjdGVkSm9iT3B0aW9uczogW10sCiAgICAgIHNlbGVjdGVkR3JvdXBPcHRpb25zOiBbXSwKICAgICAgZXZlbnRzOiBbXSwKICAgICAgc2F2aW5nOiBmYWxzZSwKICAgICAgc2VsZWN0ZWRDYWxlbmRhcjogdW5kZWZpbmVkCiAgICB9OwogICAgcmV0dXJuIF90aGlzOwogIH0KCiAgX2NyZWF0ZUNsYXNzKE5ld0NhbGVuZGFyLCBbewogICAga2V5OiAiY29tcG9uZW50RGlkTW91bnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudERpZE1vdW50KCkgewogICAgICB0aGlzLmZvcm1TZXR1cCgpOwogICAgfQogIH0sIHsKICAgIGtleTogImZvcm1TZXR1cCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZm9ybVNldHVwKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHZhciBfcmVmLCBqb2JJZHMsIGdyb3VwSWRzLCBjYWxlbmRhcnMsIGpvYklkT3B0aW9ucywgZ3JvdXBJZE9wdGlvbnMsIHNlbGVjdGVkSm9iT3B0aW9ucywgc2VsZWN0ZWRHcm91cE9wdGlvbnMsIGV2ZW50c0xpc3QsIHNlbGVjdGVkQ2FsZW5kYXIsIF9mb3JtQ2FsZW5kYXJJZDsKCiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXN5bmMoZnVuY3Rpb24gZm9ybVNldHVwJChfY29udGV4dDMpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfY29udGV4dDMucHJldiA9IDA7CiAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAzOwogICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAoKDAsIF91dGlscy5nZXRDYWxlbmRhclNldHRpbmdzRGF0YSkoKSk7CgogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgX3JlZiA9IF9jb250ZXh0My5zZW50OwogICAgICAgICAgICAgIGpvYklkcyA9IF9yZWYuam9iSWRzOwogICAgICAgICAgICAgIGdyb3VwSWRzID0gX3JlZi5ncm91cElkczsKICAgICAgICAgICAgICBjYWxlbmRhcnMgPSBfcmVmLmNhbGVuZGFyczsKICAgICAgICAgICAgICBqb2JJZE9wdGlvbnMgPSBqb2JJZHMubWFwKGZ1bmN0aW9uIChqb2JJZCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgbGFiZWw6IGpvYklkCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIGdyb3VwSWRPcHRpb25zID0gZ3JvdXBJZHMubWFwKGZ1bmN0aW9uIChncm91cElkKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICBsYWJlbDogZ3JvdXBJZAogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBzZWxlY3RlZEpvYk9wdGlvbnMgPSBbXTsKICAgICAgICAgICAgICBzZWxlY3RlZEdyb3VwT3B0aW9ucyA9IFtdOwogICAgICAgICAgICAgIGV2ZW50c0xpc3QgPSBbXTsKICAgICAgICAgICAgICBfZm9ybUNhbGVuZGFySWQgPSAnJzsgLy8gRWRpdGluZyBleGlzdGluZyBjYWxlbmRhci4KCiAgICAgICAgICAgICAgaWYgKHRoaXMucHJvcHMuY2FsZW5kYXJJZCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgICAgICBzZWxlY3RlZENhbGVuZGFyID0gY2FsZW5kYXJzLmZpbmQoZnVuY3Rpb24gKGNhbCkgewogICAgICAgICAgICAgICAgICByZXR1cm4gY2FsLmNhbGVuZGFyX2lkID09PSBfdGhpczIucHJvcHMuY2FsZW5kYXJJZDsKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIGlmIChzZWxlY3RlZENhbGVuZGFyKSB7CiAgICAgICAgICAgICAgICAgIF9mb3JtQ2FsZW5kYXJJZCA9IHNlbGVjdGVkQ2FsZW5kYXIuY2FsZW5kYXJfaWQ7CiAgICAgICAgICAgICAgICAgIGV2ZW50c0xpc3QgPSBzZWxlY3RlZENhbGVuZGFyLmV2ZW50czsKICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRDYWxlbmRhci5qb2JfaWRzLmZvckVhY2goZnVuY3Rpb24gKGlkKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGpvYklkcy5maW5kKGZ1bmN0aW9uIChqb2JJZCkgewogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGpvYklkID09PSBpZDsKICAgICAgICAgICAgICAgICAgICB9KSkgewogICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRKb2JPcHRpb25zLnB1c2goewogICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogaWQKICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZ3JvdXBJZHMuZmluZChmdW5jdGlvbiAoZ3JvdXBJZCkgewogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdyb3VwSWQgPT09IGlkOwogICAgICAgICAgICAgICAgICAgIH0pKSB7CiAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZEdyb3VwT3B0aW9ucy5wdXNoKHsKICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IGlkCiAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICBldmVudHM6IGV2ZW50c0xpc3QsCiAgICAgICAgICAgICAgICBmb3JtQ2FsZW5kYXJJZDogX2Zvcm1DYWxlbmRhcklkLAogICAgICAgICAgICAgICAgam9iSWRzOiBqb2JJZHMsCiAgICAgICAgICAgICAgICBqb2JJZE9wdGlvbnM6IGpvYklkT3B0aW9ucywKICAgICAgICAgICAgICAgIGdyb3VwSWRzOiBncm91cElkcywKICAgICAgICAgICAgICAgIGdyb3VwSWRPcHRpb25zOiBncm91cElkT3B0aW9ucywKICAgICAgICAgICAgICAgIGNhbGVuZGFyczogY2FsZW5kYXJzLAogICAgICAgICAgICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgICAgICAgICAgICBzZWxlY3RlZEpvYk9wdGlvbnM6IHNlbGVjdGVkSm9iT3B0aW9ucywKICAgICAgICAgICAgICAgIHNlbGVjdGVkR3JvdXBPcHRpb25zOiBzZWxlY3RlZEdyb3VwT3B0aW9ucywKICAgICAgICAgICAgICAgIHNlbGVjdGVkQ2FsZW5kYXI6IHNlbGVjdGVkQ2FsZW5kYXIKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDIyOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAxNzoKICAgICAgICAgICAgICBfY29udGV4dDMucHJldiA9IDE3OwogICAgICAgICAgICAgIF9jb250ZXh0My50MCA9IF9jb250ZXh0M1siY2F0Y2giXSgwKTsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhfY29udGV4dDMudDApOwogICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgbG9hZGluZzogZmFsc2UKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgX25vdGlmeS50b2FzdE5vdGlmaWNhdGlvbnMuYWRkRGFuZ2VyKHRoaXMucHJvcHMuaW50bC5mb3JtYXRNZXNzYWdlKHsKICAgICAgICAgICAgICAgIGlkOiAneHBhY2subWwuY2FsZW5kYXJzRWRpdC5lcnJvcldpdGhMb2FkaW5nQ2FsZW5kYXJGcm9tRGF0YUVycm9yTWVzc2FnZScsCiAgICAgICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0FuIGVycm9yIG9jY3VycmVkIGxvYWRpbmcgY2FsZW5kYXIgZm9ybSBkYXRhLiBUcnkgcmVmcmVzaGluZyB0aGUgcGFnZS4nCiAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgY2FzZSAyMjoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIG51bGwsIHRoaXMsIFtbMCwgMTddXSk7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVuZGVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7CiAgICAgIHZhciBfdGhpcyRzdGF0ZTMgPSB0aGlzLnN0YXRlLAogICAgICAgICAgZXZlbnRzID0gX3RoaXMkc3RhdGUzLmV2ZW50cywKICAgICAgICAgIGlzTmV3RXZlbnRNb2RhbFZpc2libGUgPSBfdGhpcyRzdGF0ZTMuaXNOZXdFdmVudE1vZGFsVmlzaWJsZSwKICAgICAgICAgIGlzSW1wb3J0TW9kYWxWaXNpYmxlID0gX3RoaXMkc3RhdGUzLmlzSW1wb3J0TW9kYWxWaXNpYmxlLAogICAgICAgICAgaXNOZXdDYWxlbmRhcklkVmFsaWQgPSBfdGhpcyRzdGF0ZTMuaXNOZXdDYWxlbmRhcklkVmFsaWQsCiAgICAgICAgICBmb3JtQ2FsZW5kYXJJZCA9IF90aGlzJHN0YXRlMy5mb3JtQ2FsZW5kYXJJZCwKICAgICAgICAgIGRlc2NyaXB0aW9uID0gX3RoaXMkc3RhdGUzLmRlc2NyaXB0aW9uLAogICAgICAgICAgZ3JvdXBJZE9wdGlvbnMgPSBfdGhpcyRzdGF0ZTMuZ3JvdXBJZE9wdGlvbnMsCiAgICAgICAgICBqb2JJZE9wdGlvbnMgPSBfdGhpcyRzdGF0ZTMuam9iSWRPcHRpb25zLAogICAgICAgICAgc2F2aW5nID0gX3RoaXMkc3RhdGUzLnNhdmluZywKICAgICAgICAgIHNlbGVjdGVkQ2FsZW5kYXIgPSBfdGhpcyRzdGF0ZTMuc2VsZWN0ZWRDYWxlbmRhciwKICAgICAgICAgIHNlbGVjdGVkSm9iT3B0aW9ucyA9IF90aGlzJHN0YXRlMy5zZWxlY3RlZEpvYk9wdGlvbnMsCiAgICAgICAgICBzZWxlY3RlZEdyb3VwT3B0aW9ucyA9IF90aGlzJHN0YXRlMy5zZWxlY3RlZEdyb3VwT3B0aW9uczsKICAgICAgdmFyIG1vZGFsID0gJyc7CgogICAgICBpZiAoaXNOZXdFdmVudE1vZGFsVmlzaWJsZSkgewogICAgICAgIG1vZGFsID0gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aU92ZXJsYXlNYXNrLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9uZXdfZXZlbnRfbW9kYWwuTmV3RXZlbnRNb2RhbCwgewogICAgICAgICAgYWRkRXZlbnQ6IHRoaXMuYWRkRXZlbnQsCiAgICAgICAgICBjbG9zZU1vZGFsOiB0aGlzLmNsb3NlTmV3RXZlbnRNb2RhbAogICAgICAgIH0pKTsKICAgICAgfSBlbHNlIGlmIChpc0ltcG9ydE1vZGFsVmlzaWJsZSkgewogICAgICAgIG1vZGFsID0gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aU92ZXJsYXlNYXNrLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9pbXBvcnRfbW9kYWwuSW1wb3J0TW9kYWwsIHsKICAgICAgICAgIGFkZEltcG9ydGVkRXZlbnRzOiB0aGlzLmFkZEltcG9ydGVkRXZlbnRzLAogICAgICAgICAgY2xvc2VJbXBvcnRNb2RhbDogdGhpcy5jbG9zZUltcG9ydE1vZGFsCiAgICAgICAgfSkpOwogICAgICB9CgogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRnJhZ21lbnQsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX25hdmlnYXRpb25fbWVudS5OYXZpZ2F0aW9uTWVudSwgewogICAgICAgIHRhYklkOiAic2V0dGluZ3MiCiAgICAgIH0pLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpUGFnZSwgewogICAgICAgIGNsYXNzTmFtZTogIm1sQ2FsZW5kYXJFZGl0Rm9ybSIKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVBhZ2VDb250ZW50LCB7CiAgICAgICAgY2xhc3NOYW1lOiAibWxDYWxlbmRhckVkaXRGb3JtX19jb250ZW50IiwKICAgICAgICB2ZXJ0aWNhbFBvc2l0aW9uOiAiY2VudGVyIiwKICAgICAgICBob3Jpem9udGFsUG9zaXRpb246ICJjZW50ZXIiCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2NhbGVuZGFyX2Zvcm0uQ2FsZW5kYXJGb3JtLCB7CiAgICAgICAgY2FsZW5kYXJJZDogc2VsZWN0ZWRDYWxlbmRhciA/IHNlbGVjdGVkQ2FsZW5kYXIuY2FsZW5kYXJfaWQgOiBmb3JtQ2FsZW5kYXJJZCwKICAgICAgICBjYW5DcmVhdGVDYWxlbmRhcjogdGhpcy5wcm9wcy5jYW5DcmVhdGVDYWxlbmRhciwKICAgICAgICBjYW5EZWxldGVDYWxlbmRhcjogdGhpcy5wcm9wcy5jYW5EZWxldGVDYWxlbmRhciwKICAgICAgICBkZXNjcmlwdGlvbjogc2VsZWN0ZWRDYWxlbmRhciA/IHNlbGVjdGVkQ2FsZW5kYXIuZGVzY3JpcHRpb24gOiBkZXNjcmlwdGlvbiwKICAgICAgICBldmVudHNMaXN0OiBldmVudHMsCiAgICAgICAgZ3JvdXBJZHM6IGdyb3VwSWRPcHRpb25zLAogICAgICAgIGlzRWRpdDogc2VsZWN0ZWRDYWxlbmRhciAhPT0gdW5kZWZpbmVkLAogICAgICAgIGlzTmV3Q2FsZW5kYXJJZFZhbGlkOiBzZWxlY3RlZENhbGVuZGFyIHx8IGlzTmV3Q2FsZW5kYXJJZFZhbGlkID09PSBudWxsID8gdHJ1ZSA6IGlzTmV3Q2FsZW5kYXJJZFZhbGlkLAogICAgICAgIGpvYklkczogam9iSWRPcHRpb25zLAogICAgICAgIG9uQ2FsZW5kYXJJZENoYW5nZTogdGhpcy5vbkNhbGVuZGFySWRDaGFuZ2UsCiAgICAgICAgb25DcmVhdGU6IHRoaXMub25DcmVhdGUsCiAgICAgICAgb25EZXNjcmlwdGlvbkNoYW5nZTogdGhpcy5vbkRlc2NyaXB0aW9uQ2hhbmdlLAogICAgICAgIG9uRWRpdDogdGhpcy5vbkVkaXQsCiAgICAgICAgb25FdmVudERlbGV0ZTogdGhpcy5vbkV2ZW50RGVsZXRlLAogICAgICAgIG9uR3JvdXBTZWxlY3Rpb246IHRoaXMub25Hcm91cFNlbGVjdGlvbiwKICAgICAgICBzaG93SW1wb3J0TW9kYWw6IHRoaXMuc2hvd0ltcG9ydE1vZGFsLAogICAgICAgIG9uSm9iU2VsZWN0aW9uOiB0aGlzLm9uSm9iU2VsZWN0aW9uLAogICAgICAgIHNhdmluZzogc2F2aW5nLAogICAgICAgIHNlbGVjdGVkR3JvdXBPcHRpb25zOiBzZWxlY3RlZEdyb3VwT3B0aW9ucywKICAgICAgICBzZWxlY3RlZEpvYk9wdGlvbnM6IHNlbGVjdGVkSm9iT3B0aW9ucywKICAgICAgICBvbkNyZWF0ZUdyb3VwT3B0aW9uOiB0aGlzLm9uQ3JlYXRlR3JvdXBPcHRpb24sCiAgICAgICAgc2hvd05ld0V2ZW50TW9kYWw6IHRoaXMuc2hvd05ld0V2ZW50TW9kYWwKICAgICAgfSkpLCBtb2RhbCkpOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIE5ld0NhbGVuZGFyOwp9KF9yZWFjdC5Db21wb25lbnQpLCBfZGVmaW5lUHJvcGVydHkoX2NsYXNzLCAicHJvcFR5cGVzIiwgewogIGNhbGVuZGFySWQ6IF9wcm9wVHlwZXMuUHJvcFR5cGVzLnN0cmluZywKICBjYW5DcmVhdGVDYWxlbmRhcjogX3Byb3BUeXBlcy5Qcm9wVHlwZXMuYm9vbC5pc1JlcXVpcmVkLAogIGNhbkRlbGV0ZUNhbGVuZGFyOiBfcHJvcFR5cGVzLlByb3BUeXBlcy5ib29sLmlzUmVxdWlyZWQKfSksIF90ZW1wKSk7CmV4cG9ydHMuTmV3Q2FsZW5kYXIgPSBOZXdDYWxlbmRhcjs="},null]}