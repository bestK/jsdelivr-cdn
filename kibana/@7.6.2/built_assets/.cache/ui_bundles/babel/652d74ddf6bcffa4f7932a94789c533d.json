{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/lens/public/editor_frame_plugin/editor_frame/editor_frame.js","dependencies":[{"path":"x-pack/legacy/plugins/lens/public/editor_frame_plugin/editor_frame/editor_frame.js","mtime":1585205044989},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkVkaXRvckZyYW1lID0gRWRpdG9yRnJhbWU7Cgp2YXIgX3JlYWN0ID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgicmVhY3QiKSk7Cgp2YXIgX3N0YXRlX21hbmFnZW1lbnQgPSByZXF1aXJlKCIuL3N0YXRlX21hbmFnZW1lbnQiKTsKCnZhciBfZGF0YV9wYW5lbF93cmFwcGVyID0gcmVxdWlyZSgiLi9kYXRhX3BhbmVsX3dyYXBwZXIiKTsKCnZhciBfY29uZmlnX3BhbmVsX3dyYXBwZXIgPSByZXF1aXJlKCIuL2NvbmZpZ19wYW5lbF93cmFwcGVyIik7Cgp2YXIgX2ZyYW1lX2xheW91dCA9IHJlcXVpcmUoIi4vZnJhbWVfbGF5b3V0Iik7Cgp2YXIgX3N1Z2dlc3Rpb25fcGFuZWwgPSByZXF1aXJlKCIuL3N1Z2dlc3Rpb25fcGFuZWwiKTsKCnZhciBfd29ya3NwYWNlX3BhbmVsID0gcmVxdWlyZSgiLi93b3Jrc3BhY2VfcGFuZWwiKTsKCnZhciBfc2F2ZSA9IHJlcXVpcmUoIi4vc2F2ZSIpOwoKdmFyIF93b3Jrc3BhY2VfcGFuZWxfd3JhcHBlciA9IHJlcXVpcmUoIi4vd29ya3NwYWNlX3BhbmVsX3dyYXBwZXIiKTsKCnZhciBfaWRfZ2VuZXJhdG9yID0gcmVxdWlyZSgiLi4vLi4vaWRfZ2VuZXJhdG9yIik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsKICBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7CiAgICByZXR1cm4gb2JqOwogIH0gZWxzZSB7CiAgICB2YXIgbmV3T2JqID0ge307CgogICAgaWYgKG9iaiAhPSBudWxsKSB7CiAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHsKICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgewogICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvciA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpIDoge307CgogICAgICAgICAgaWYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSB7CiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmosIGtleSwgZGVzYyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBuZXdPYmpba2V5XSA9IG9ialtrZXldOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIG5ld09iai5kZWZhdWx0ID0gb2JqOwogICAgcmV0dXJuIG5ld09iajsKICB9Cn0KCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgewogIHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsKCiAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsKICAgIHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOwogICAgaWYgKGVudW1lcmFibGVPbmx5KSBzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgewogICAgICByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsKICAgIH0pOwogICAga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOwogIH0KCiAgcmV0dXJuIGtleXM7Cn0KCmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7CiAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsKICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OwoKICAgIGlmIChpICUgMikgewogICAgICBvd25LZXlzKHNvdXJjZSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7CiAgICAgIH0pOwogICAgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgewogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpOwogICAgfSBlbHNlIHsKICAgICAgb3duS2V5cyhzb3VyY2UpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOwogICAgICB9KTsKICAgIH0KICB9CgogIHJldHVybiB0YXJnZXQ7Cn0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsKICBpZiAoa2V5IGluIG9iaikgewogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7CiAgICAgIHZhbHVlOiB2YWx1ZSwKICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICB3cml0YWJsZTogdHJ1ZQogICAgfSk7CiAgfSBlbHNlIHsKICAgIG9ialtrZXldID0gdmFsdWU7CiAgfQoKICByZXR1cm4gb2JqOwp9CgpmdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7CiAgcmV0dXJuIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfbm9uSXRlcmFibGVTcHJlYWQoKTsKfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlU3ByZWFkKCkgewogIHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7Cn0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXkoaXRlcikgewogIGlmIChTeW1ib2wuaXRlcmF0b3IgaW4gT2JqZWN0KGl0ZXIpIHx8IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChpdGVyKSA9PT0gIltvYmplY3QgQXJndW1lbnRzXSIpIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpOwp9CgpmdW5jdGlvbiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgewogICAgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkoYXJyLmxlbmd0aCk7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHsKICAgICAgYXJyMltpXSA9IGFycltpXTsKICAgIH0KCiAgICByZXR1cm4gYXJyMjsKICB9Cn0KCmZ1bmN0aW9uIF9zbGljZWRUb0FycmF5KGFyciwgaSkgewogIHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB8fCBfbm9uSXRlcmFibGVSZXN0KCk7Cn0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVJlc3QoKSB7CiAgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIGRlc3RydWN0dXJlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZSIpOwp9CgpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB7CiAgdmFyIF9hcnIgPSBbXTsKICB2YXIgX24gPSB0cnVlOwogIHZhciBfZCA9IGZhbHNlOwogIHZhciBfZSA9IHVuZGVmaW5lZDsKCiAgdHJ5IHsKICAgIGZvciAodmFyIF9pID0gYXJyW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3M7ICEoX24gPSAoX3MgPSBfaS5uZXh0KCkpLmRvbmUpOyBfbiA9IHRydWUpIHsKICAgICAgX2Fyci5wdXNoKF9zLnZhbHVlKTsKCiAgICAgIGlmIChpICYmIF9hcnIubGVuZ3RoID09PSBpKSBicmVhazsKICAgIH0KICB9IGNhdGNoIChlcnIpIHsKICAgIF9kID0gdHJ1ZTsKICAgIF9lID0gZXJyOwogIH0gZmluYWxseSB7CiAgICB0cnkgewogICAgICBpZiAoIV9uICYmIF9pWyJyZXR1cm4iXSAhPSBudWxsKSBfaVsicmV0dXJuIl0oKTsKICAgIH0gZmluYWxseSB7CiAgICAgIGlmIChfZCkgdGhyb3cgX2U7CiAgICB9CiAgfQoKICByZXR1cm4gX2FycjsKfQoKZnVuY3Rpb24gX2FycmF5V2l0aEhvbGVzKGFycikgewogIGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBhcnI7Cn0KCmZ1bmN0aW9uIEVkaXRvckZyYW1lKHByb3BzKSB7CiAgdmFyIF91c2VSZWR1Y2VyID0gKDAsIF9yZWFjdC51c2VSZWR1Y2VyKShfc3RhdGVfbWFuYWdlbWVudC5yZWR1Y2VyLCBwcm9wcywgX3N0YXRlX21hbmFnZW1lbnQuZ2V0SW5pdGlhbFN0YXRlKSwKICAgICAgX3VzZVJlZHVjZXIyID0gX3NsaWNlZFRvQXJyYXkoX3VzZVJlZHVjZXIsIDIpLAogICAgICBzdGF0ZSA9IF91c2VSZWR1Y2VyMlswXSwKICAgICAgZGlzcGF0Y2ggPSBfdXNlUmVkdWNlcjJbMV07CgogIHZhciBvbkVycm9yID0gcHJvcHMub25FcnJvcjsKICB2YXIgYWN0aXZlVmlzdWFsaXphdGlvbiA9IHN0YXRlLnZpc3VhbGl6YXRpb24uYWN0aXZlSWQgJiYgcHJvcHMudmlzdWFsaXphdGlvbk1hcFtzdGF0ZS52aXN1YWxpemF0aW9uLmFjdGl2ZUlkXTsKICB2YXIgYWxsTG9hZGVkID0gT2JqZWN0LnZhbHVlcyhzdGF0ZS5kYXRhc291cmNlU3RhdGVzKS5ldmVyeShmdW5jdGlvbiAoX3JlZikgewogICAgdmFyIGlzTG9hZGluZyA9IF9yZWYuaXNMb2FkaW5nOwogICAgcmV0dXJuIHR5cGVvZiBpc0xvYWRpbmcgPT09ICdib29sZWFuJyAmJiAhaXNMb2FkaW5nOwogIH0pOyAvLyBJbml0aWFsaXplIGN1cnJlbnQgZGF0YXNvdXJjZSBhbmQgYWxsIGFjdGl2ZSBkYXRhc291cmNlcwoKICAoMCwgX3JlYWN0LnVzZUVmZmVjdCkoZnVuY3Rpb24gKCkgewogICAgaWYgKCFhbGxMb2FkZWQpIHsKICAgICAgT2JqZWN0LmVudHJpZXMocHJvcHMuZGF0YXNvdXJjZU1hcCkuZm9yRWFjaChmdW5jdGlvbiAoX3JlZjIpIHsKICAgICAgICB2YXIgX3JlZjMgPSBfc2xpY2VkVG9BcnJheShfcmVmMiwgMiksCiAgICAgICAgICAgIGRhdGFzb3VyY2VJZCA9IF9yZWYzWzBdLAogICAgICAgICAgICBkYXRhc291cmNlID0gX3JlZjNbMV07CgogICAgICAgIGlmIChzdGF0ZS5kYXRhc291cmNlU3RhdGVzW2RhdGFzb3VyY2VJZF0gJiYgc3RhdGUuZGF0YXNvdXJjZVN0YXRlc1tkYXRhc291cmNlSWRdLmlzTG9hZGluZykgewogICAgICAgICAgZGF0YXNvdXJjZS5pbml0aWFsaXplKHN0YXRlLmRhdGFzb3VyY2VTdGF0ZXNbZGF0YXNvdXJjZUlkXS5zdGF0ZSB8fCB1bmRlZmluZWQpLnRoZW4oZnVuY3Rpb24gKGRhdGFzb3VyY2VTdGF0ZSkgewogICAgICAgICAgICBkaXNwYXRjaCh7CiAgICAgICAgICAgICAgdHlwZTogJ1VQREFURV9EQVRBU09VUkNFX1NUQVRFJywKICAgICAgICAgICAgICB1cGRhdGVyOiBkYXRhc291cmNlU3RhdGUsCiAgICAgICAgICAgICAgZGF0YXNvdXJjZUlkOiBkYXRhc291cmNlSWQKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KS5jYXRjaChvbkVycm9yKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sIFthbGxMb2FkZWRdKTsKICB2YXIgZGF0YXNvdXJjZUxheWVycyA9IHt9OwogIE9iamVjdC5rZXlzKHByb3BzLmRhdGFzb3VyY2VNYXApLmZpbHRlcihmdW5jdGlvbiAoaWQpIHsKICAgIHJldHVybiBzdGF0ZS5kYXRhc291cmNlU3RhdGVzW2lkXSAmJiAhc3RhdGUuZGF0YXNvdXJjZVN0YXRlc1tpZF0uaXNMb2FkaW5nOwogIH0pLmZvckVhY2goZnVuY3Rpb24gKGlkKSB7CiAgICB2YXIgZGF0YXNvdXJjZVN0YXRlID0gc3RhdGUuZGF0YXNvdXJjZVN0YXRlc1tpZF0uc3RhdGU7CiAgICB2YXIgZGF0YXNvdXJjZSA9IHByb3BzLmRhdGFzb3VyY2VNYXBbaWRdOwogICAgdmFyIGxheWVycyA9IGRhdGFzb3VyY2UuZ2V0TGF5ZXJzKGRhdGFzb3VyY2VTdGF0ZSk7CiAgICBsYXllcnMuZm9yRWFjaChmdW5jdGlvbiAobGF5ZXIpIHsKICAgICAgdmFyIHB1YmxpY0FQSSA9IHByb3BzLmRhdGFzb3VyY2VNYXBbaWRdLmdldFB1YmxpY0FQSSh7CiAgICAgICAgc3RhdGU6IGRhdGFzb3VyY2VTdGF0ZSwKICAgICAgICBzZXRTdGF0ZTogZnVuY3Rpb24gc2V0U3RhdGUobmV3U3RhdGUpIHsKICAgICAgICAgIGRpc3BhdGNoKHsKICAgICAgICAgICAgdHlwZTogJ1VQREFURV9EQVRBU09VUkNFX1NUQVRFJywKICAgICAgICAgICAgZGF0YXNvdXJjZUlkOiBpZCwKICAgICAgICAgICAgdXBkYXRlcjogbmV3U3RhdGUsCiAgICAgICAgICAgIGNsZWFyU3RhZ2VkUHJldmlldzogdHJ1ZQogICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgICBsYXllcklkOiBsYXllciwKICAgICAgICBkYXRlUmFuZ2U6IHByb3BzLmRhdGVSYW5nZQogICAgICB9KTsKICAgICAgZGF0YXNvdXJjZUxheWVyc1tsYXllcl0gPSBwdWJsaWNBUEk7CiAgICB9KTsKICB9KTsKICB2YXIgZnJhbWVQdWJsaWNBUEkgPSB7CiAgICBkYXRhc291cmNlTGF5ZXJzOiBkYXRhc291cmNlTGF5ZXJzLAogICAgZGF0ZVJhbmdlOiBwcm9wcy5kYXRlUmFuZ2UsCiAgICBxdWVyeTogcHJvcHMucXVlcnksCiAgICBmaWx0ZXJzOiBwcm9wcy5maWx0ZXJzLAogICAgYWRkTmV3TGF5ZXI6IGZ1bmN0aW9uIGFkZE5ld0xheWVyKCkgewogICAgICB2YXIgbmV3TGF5ZXJJZCA9ICgwLCBfaWRfZ2VuZXJhdG9yLmdlbmVyYXRlSWQpKCk7CiAgICAgIGRpc3BhdGNoKHsKICAgICAgICB0eXBlOiAnVVBEQVRFX0xBWUVSJywKICAgICAgICBkYXRhc291cmNlSWQ6IHN0YXRlLmFjdGl2ZURhdGFzb3VyY2VJZCwKICAgICAgICBsYXllcklkOiBuZXdMYXllcklkLAogICAgICAgIHVwZGF0ZXI6IHByb3BzLmRhdGFzb3VyY2VNYXBbc3RhdGUuYWN0aXZlRGF0YXNvdXJjZUlkXS5pbnNlcnRMYXllcgogICAgICB9KTsKICAgICAgcmV0dXJuIG5ld0xheWVySWQ7CiAgICB9LAogICAgcmVtb3ZlTGF5ZXJzOiBmdW5jdGlvbiByZW1vdmVMYXllcnMobGF5ZXJJZHMpIHsKICAgICAgaWYgKGFjdGl2ZVZpc3VhbGl6YXRpb24gJiYgYWN0aXZlVmlzdWFsaXphdGlvbi5yZW1vdmVMYXllciAmJiBzdGF0ZS52aXN1YWxpemF0aW9uLnN0YXRlKSB7CiAgICAgICAgZGlzcGF0Y2goewogICAgICAgICAgdHlwZTogJ1VQREFURV9WSVNVQUxJWkFUSU9OX1NUQVRFJywKICAgICAgICAgIHZpc3VhbGl6YXRpb25JZDogYWN0aXZlVmlzdWFsaXphdGlvbi5pZCwKICAgICAgICAgIG5ld1N0YXRlOiBsYXllcklkcy5yZWR1Y2UoZnVuY3Rpb24gKGFjYywgbGF5ZXJJZCkgewogICAgICAgICAgICByZXR1cm4gYWN0aXZlVmlzdWFsaXphdGlvbi5yZW1vdmVMYXllciA/IGFjdGl2ZVZpc3VhbGl6YXRpb24ucmVtb3ZlTGF5ZXIoYWNjLCBsYXllcklkKSA6IGFjYzsKICAgICAgICAgIH0sIHN0YXRlLnZpc3VhbGl6YXRpb24uc3RhdGUpCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGxheWVySWRzLmZvckVhY2goZnVuY3Rpb24gKGxheWVySWQpIHsKICAgICAgICB2YXIgbGF5ZXJEYXRhc291cmNlSWQgPSBPYmplY3QuZW50cmllcyhwcm9wcy5kYXRhc291cmNlTWFwKS5maW5kKGZ1bmN0aW9uIChfcmVmNCkgewogICAgICAgICAgdmFyIF9yZWY1ID0gX3NsaWNlZFRvQXJyYXkoX3JlZjQsIDIpLAogICAgICAgICAgICAgIGRhdGFzb3VyY2VJZCA9IF9yZWY1WzBdLAogICAgICAgICAgICAgIGRhdGFzb3VyY2UgPSBfcmVmNVsxXTsKCiAgICAgICAgICByZXR1cm4gc3RhdGUuZGF0YXNvdXJjZVN0YXRlc1tkYXRhc291cmNlSWRdICYmIGRhdGFzb3VyY2UuZ2V0TGF5ZXJzKHN0YXRlLmRhdGFzb3VyY2VTdGF0ZXNbZGF0YXNvdXJjZUlkXS5zdGF0ZSkuaW5jbHVkZXMobGF5ZXJJZCk7CiAgICAgICAgfSlbMF07CiAgICAgICAgZGlzcGF0Y2goewogICAgICAgICAgdHlwZTogJ1VQREFURV9MQVlFUicsCiAgICAgICAgICBsYXllcklkOiBsYXllcklkLAogICAgICAgICAgZGF0YXNvdXJjZUlkOiBsYXllckRhdGFzb3VyY2VJZCwKICAgICAgICAgIHVwZGF0ZXI6IHByb3BzLmRhdGFzb3VyY2VNYXBbbGF5ZXJEYXRhc291cmNlSWRdLnJlbW92ZUxheWVyCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH07CiAgKDAsIF9yZWFjdC51c2VFZmZlY3QpKGZ1bmN0aW9uICgpIHsKICAgIGlmIChwcm9wcy5kb2MpIHsKICAgICAgZGlzcGF0Y2goewogICAgICAgIHR5cGU6ICdWSVNVQUxJWkFUSU9OX0xPQURFRCcsCiAgICAgICAgZG9jOiBwcm9wcy5kb2MKICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICBkaXNwYXRjaCh7CiAgICAgICAgdHlwZTogJ1JFU0VUJywKICAgICAgICBzdGF0ZTogKDAsIF9zdGF0ZV9tYW5hZ2VtZW50LmdldEluaXRpYWxTdGF0ZSkocHJvcHMpCiAgICAgIH0pOwogICAgfQogIH0sIFtwcm9wcy5kb2NdKTsgLy8gSW5pdGlhbGl6ZSB2aXN1YWxpemF0aW9uIGFzIHNvb24gYXMgYWxsIGRhdGFzb3VyY2VzIGFyZSByZWFkeQoKICAoMCwgX3JlYWN0LnVzZUVmZmVjdCkoZnVuY3Rpb24gKCkgewogICAgaWYgKGFsbExvYWRlZCAmJiBzdGF0ZS52aXN1YWxpemF0aW9uLnN0YXRlID09PSBudWxsICYmIGFjdGl2ZVZpc3VhbGl6YXRpb24pIHsKICAgICAgdmFyIGluaXRpYWxWaXN1YWxpemF0aW9uU3RhdGUgPSBhY3RpdmVWaXN1YWxpemF0aW9uLmluaXRpYWxpemUoZnJhbWVQdWJsaWNBUEkpOwogICAgICBkaXNwYXRjaCh7CiAgICAgICAgdHlwZTogJ1VQREFURV9WSVNVQUxJWkFUSU9OX1NUQVRFJywKICAgICAgICB2aXN1YWxpemF0aW9uSWQ6IGFjdGl2ZVZpc3VhbGl6YXRpb24uaWQsCiAgICAgICAgbmV3U3RhdGU6IGluaXRpYWxWaXN1YWxpemF0aW9uU3RhdGUKICAgICAgfSk7CiAgICB9CiAgfSwgW2FsbExvYWRlZCwgYWN0aXZlVmlzdWFsaXphdGlvbiwgc3RhdGUudmlzdWFsaXphdGlvbi5zdGF0ZV0pOyAvLyBUaGUgZnJhbWUgbmVlZHMgdG8gY2FsbCBvbkNoYW5nZSBldmVyeSB0aW1lIGl0cyBpbnRlcm5hbCBzdGF0ZSBjaGFuZ2VzCgogICgwLCBfcmVhY3QudXNlRWZmZWN0KShmdW5jdGlvbiAoKSB7CiAgICB2YXIgYWN0aXZlRGF0YXNvdXJjZSA9IHN0YXRlLmFjdGl2ZURhdGFzb3VyY2VJZCAmJiAhc3RhdGUuZGF0YXNvdXJjZVN0YXRlc1tzdGF0ZS5hY3RpdmVEYXRhc291cmNlSWRdLmlzTG9hZGluZyA/IHByb3BzLmRhdGFzb3VyY2VNYXBbc3RhdGUuYWN0aXZlRGF0YXNvdXJjZUlkXSA6IHVuZGVmaW5lZDsKCiAgICBpZiAoIWFjdGl2ZURhdGFzb3VyY2UgfHwgIWFjdGl2ZVZpc3VhbGl6YXRpb24pIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHZhciBpbmRleFBhdHRlcm5zID0gW107CiAgICBPYmplY3QuZW50cmllcyhwcm9wcy5kYXRhc291cmNlTWFwKS5maWx0ZXIoZnVuY3Rpb24gKF9yZWY2KSB7CiAgICAgIHZhciBfcmVmNyA9IF9zbGljZWRUb0FycmF5KF9yZWY2LCAyKSwKICAgICAgICAgIGlkID0gX3JlZjdbMF0sCiAgICAgICAgICBkYXRhc291cmNlID0gX3JlZjdbMV07CgogICAgICB2YXIgc3RhdGVXcmFwcGVyID0gc3RhdGUuZGF0YXNvdXJjZVN0YXRlc1tpZF07CiAgICAgIHJldHVybiBzdGF0ZVdyYXBwZXIgJiYgIXN0YXRlV3JhcHBlci5pc0xvYWRpbmcgJiYgZGF0YXNvdXJjZS5nZXRMYXllcnMoc3RhdGVXcmFwcGVyLnN0YXRlKS5sZW5ndGggPiAwOwogICAgfSkuZm9yRWFjaChmdW5jdGlvbiAoX3JlZjgpIHsKICAgICAgdmFyIF9yZWY5ID0gX3NsaWNlZFRvQXJyYXkoX3JlZjgsIDIpLAogICAgICAgICAgaWQgPSBfcmVmOVswXSwKICAgICAgICAgIGRhdGFzb3VyY2UgPSBfcmVmOVsxXTsKCiAgICAgIGluZGV4UGF0dGVybnMucHVzaC5hcHBseShpbmRleFBhdHRlcm5zLCBfdG9Db25zdW1hYmxlQXJyYXkoZGF0YXNvdXJjZS5nZXRNZXRhRGF0YShzdGF0ZS5kYXRhc291cmNlU3RhdGVzW2lkXS5zdGF0ZSkuZmlsdGVyYWJsZUluZGV4UGF0dGVybnMpKTsKICAgIH0pOwogICAgdmFyIGRvYyA9ICgwLCBfc2F2ZS5nZXRTYXZlZE9iamVjdEZvcm1hdCkoewogICAgICBhY3RpdmVEYXRhc291cmNlczogT2JqZWN0LmtleXMoc3RhdGUuZGF0YXNvdXJjZVN0YXRlcykucmVkdWNlKGZ1bmN0aW9uIChkYXRhc291cmNlTWFwLCBkYXRhc291cmNlSWQpIHsKICAgICAgICByZXR1cm4gX29iamVjdFNwcmVhZCh7fSwgZGF0YXNvdXJjZU1hcCwgX2RlZmluZVByb3BlcnR5KHt9LCBkYXRhc291cmNlSWQsIHByb3BzLmRhdGFzb3VyY2VNYXBbZGF0YXNvdXJjZUlkXSkpOwogICAgICB9LCB7fSksCiAgICAgIHZpc3VhbGl6YXRpb246IGFjdGl2ZVZpc3VhbGl6YXRpb24sCiAgICAgIHN0YXRlOiBzdGF0ZSwKICAgICAgZnJhbWVQdWJsaWNBUEk6IGZyYW1lUHVibGljQVBJCiAgICB9KTsKICAgIHByb3BzLm9uQ2hhbmdlKHsKICAgICAgZmlsdGVyYWJsZUluZGV4UGF0dGVybnM6IGluZGV4UGF0dGVybnMsCiAgICAgIGRvYzogZG9jCiAgICB9KTsKICB9LCBbYWN0aXZlVmlzdWFsaXphdGlvbiwgc3RhdGUuZGF0YXNvdXJjZVN0YXRlcywgc3RhdGUudmlzdWFsaXphdGlvbiwgcHJvcHMucXVlcnksIHByb3BzLmRhdGVSYW5nZSwgcHJvcHMuZmlsdGVycywgcHJvcHMuc2F2ZWRRdWVyeSwgc3RhdGUudGl0bGVdKTsKICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZnJhbWVfbGF5b3V0LkZyYW1lTGF5b3V0LCB7CiAgICBkYXRhUGFuZWw6IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2RhdGFfcGFuZWxfd3JhcHBlci5EYXRhUGFuZWxXcmFwcGVyLCB7CiAgICAgIGRhdGFzb3VyY2VNYXA6IHByb3BzLmRhdGFzb3VyY2VNYXAsCiAgICAgIGFjdGl2ZURhdGFzb3VyY2U6IHN0YXRlLmFjdGl2ZURhdGFzb3VyY2VJZCwKICAgICAgZGF0YXNvdXJjZVN0YXRlOiBzdGF0ZS5hY3RpdmVEYXRhc291cmNlSWQgPyBzdGF0ZS5kYXRhc291cmNlU3RhdGVzW3N0YXRlLmFjdGl2ZURhdGFzb3VyY2VJZF0uc3RhdGUgOiBudWxsLAogICAgICBkYXRhc291cmNlSXNMb2FkaW5nOiBzdGF0ZS5hY3RpdmVEYXRhc291cmNlSWQgPyBzdGF0ZS5kYXRhc291cmNlU3RhdGVzW3N0YXRlLmFjdGl2ZURhdGFzb3VyY2VJZF0uaXNMb2FkaW5nIDogdHJ1ZSwKICAgICAgZGlzcGF0Y2g6IGRpc3BhdGNoLAogICAgICBjb3JlOiBwcm9wcy5jb3JlLAogICAgICBxdWVyeTogcHJvcHMucXVlcnksCiAgICAgIGRhdGVSYW5nZTogcHJvcHMuZGF0ZVJhbmdlLAogICAgICBmaWx0ZXJzOiBwcm9wcy5maWx0ZXJzCiAgICB9KSwKICAgIGNvbmZpZ1BhbmVsOiBhbGxMb2FkZWQgJiYgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfY29uZmlnX3BhbmVsX3dyYXBwZXIuQ29uZmlnUGFuZWxXcmFwcGVyLCB7CiAgICAgIGFjdGl2ZURhdGFzb3VyY2VJZDogc3RhdGUuYWN0aXZlRGF0YXNvdXJjZUlkLAogICAgICBkYXRhc291cmNlTWFwOiBwcm9wcy5kYXRhc291cmNlTWFwLAogICAgICBkYXRhc291cmNlU3RhdGVzOiBzdGF0ZS5kYXRhc291cmNlU3RhdGVzLAogICAgICB2aXN1YWxpemF0aW9uTWFwOiBwcm9wcy52aXN1YWxpemF0aW9uTWFwLAogICAgICBhY3RpdmVWaXN1YWxpemF0aW9uSWQ6IHN0YXRlLnZpc3VhbGl6YXRpb24uYWN0aXZlSWQsCiAgICAgIGRpc3BhdGNoOiBkaXNwYXRjaCwKICAgICAgdmlzdWFsaXphdGlvblN0YXRlOiBzdGF0ZS52aXN1YWxpemF0aW9uLnN0YXRlLAogICAgICBmcmFtZVB1YmxpY0FQSTogZnJhbWVQdWJsaWNBUEkKICAgIH0pLAogICAgd29ya3NwYWNlUGFuZWw6IGFsbExvYWRlZCAmJiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF93b3Jrc3BhY2VfcGFuZWxfd3JhcHBlci5Xb3Jrc3BhY2VQYW5lbFdyYXBwZXIsIHsKICAgICAgdGl0bGU6IHN0YXRlLnRpdGxlCiAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF93b3Jrc3BhY2VfcGFuZWwuV29ya3NwYWNlUGFuZWwsIHsKICAgICAgYWN0aXZlRGF0YXNvdXJjZUlkOiBzdGF0ZS5hY3RpdmVEYXRhc291cmNlSWQsCiAgICAgIGFjdGl2ZVZpc3VhbGl6YXRpb25JZDogc3RhdGUudmlzdWFsaXphdGlvbi5hY3RpdmVJZCwKICAgICAgZGF0YXNvdXJjZU1hcDogcHJvcHMuZGF0YXNvdXJjZU1hcCwKICAgICAgZGF0YXNvdXJjZVN0YXRlczogc3RhdGUuZGF0YXNvdXJjZVN0YXRlcywKICAgICAgZnJhbWVQdWJsaWNBUEk6IGZyYW1lUHVibGljQVBJLAogICAgICB2aXN1YWxpemF0aW9uU3RhdGU6IHN0YXRlLnZpc3VhbGl6YXRpb24uc3RhdGUsCiAgICAgIHZpc3VhbGl6YXRpb25NYXA6IHByb3BzLnZpc3VhbGl6YXRpb25NYXAsCiAgICAgIGRpc3BhdGNoOiBkaXNwYXRjaCwKICAgICAgRXhwcmVzc2lvblJlbmRlcmVyOiBwcm9wcy5FeHByZXNzaW9uUmVuZGVyZXIsCiAgICAgIGNvcmU6IHByb3BzLmNvcmUKICAgIH0pKSwKICAgIHN1Z2dlc3Rpb25zUGFuZWw6IGFsbExvYWRlZCAmJiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9zdWdnZXN0aW9uX3BhbmVsLlN1Z2dlc3Rpb25QYW5lbCwgewogICAgICBmcmFtZTogZnJhbWVQdWJsaWNBUEksCiAgICAgIGFjdGl2ZURhdGFzb3VyY2VJZDogc3RhdGUuYWN0aXZlRGF0YXNvdXJjZUlkLAogICAgICBhY3RpdmVWaXN1YWxpemF0aW9uSWQ6IHN0YXRlLnZpc3VhbGl6YXRpb24uYWN0aXZlSWQsCiAgICAgIGRhdGFzb3VyY2VNYXA6IHByb3BzLmRhdGFzb3VyY2VNYXAsCiAgICAgIGRhdGFzb3VyY2VTdGF0ZXM6IHN0YXRlLmRhdGFzb3VyY2VTdGF0ZXMsCiAgICAgIHZpc3VhbGl6YXRpb25TdGF0ZTogc3RhdGUudmlzdWFsaXphdGlvbi5zdGF0ZSwKICAgICAgdmlzdWFsaXphdGlvbk1hcDogcHJvcHMudmlzdWFsaXphdGlvbk1hcCwKICAgICAgZGlzcGF0Y2g6IGRpc3BhdGNoLAogICAgICBFeHByZXNzaW9uUmVuZGVyZXI6IHByb3BzLkV4cHJlc3Npb25SZW5kZXJlciwKICAgICAgc3RhZ2VkUHJldmlldzogc3RhdGUuc3RhZ2VkUHJldmlldwogICAgfSkKICB9KTsKfQ=="},null]}