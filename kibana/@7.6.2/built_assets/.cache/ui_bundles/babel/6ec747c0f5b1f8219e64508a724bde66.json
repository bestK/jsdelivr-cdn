{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/legacy/core_plugins/timelion/public/directives/timelion_expression_input.js","dependencies":[{"path":"src/legacy/core_plugins/timelion/public/directives/timelion_expression_input.js","mtime":1585205040135},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLlRpbWVsaW9uRXhwSW5wdXQgPSBUaW1lbGlvbkV4cElucHV0OwoKdmFyIF9sb2Rhc2ggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoImxvZGFzaCIpKTsKCnZhciBfanF1ZXJ5ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJqcXVlcnkiKSk7Cgp2YXIgX3BlZ2pzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJwZWdqcyIpKTsKCnZhciBfY2hhaW4gPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoInJhdy1sb2FkZXIhLi4vY2hhaW4ucGVnIikpOwoKdmFyIF90aW1lbGlvbl9leHByZXNzaW9uX2lucHV0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCIuL3RpbWVsaW9uX2V4cHJlc3Npb25faW5wdXQuaHRtbCIpKTsKCnZhciBfdGltZWxpb25fZXhwcmVzc2lvbl9pbnB1dF9oZWxwZXJzID0gcmVxdWlyZSgiLi90aW1lbGlvbl9leHByZXNzaW9uX2lucHV0X2hlbHBlcnMiKTsKCnZhciBfZXVpID0gcmVxdWlyZSgiQGVsYXN0aWMvZXVpIik7Cgp2YXIgX2FyZ192YWx1ZV9zdWdnZXN0aW9ucyA9IHJlcXVpcmUoIi4uL3NlcnZpY2VzL2FyZ192YWx1ZV9zdWdnZXN0aW9ucyIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCi8qCiAqIExpY2Vuc2VkIHRvIEVsYXN0aWNzZWFyY2ggQi5WLiB1bmRlciBvbmUgb3IgbW9yZSBjb250cmlidXRvcgogKiBsaWNlbnNlIGFncmVlbWVudHMuIFNlZSB0aGUgTk9USUNFIGZpbGUgZGlzdHJpYnV0ZWQgd2l0aAogKiB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3JtYXRpb24gcmVnYXJkaW5nIGNvcHlyaWdodAogKiBvd25lcnNoaXAuIEVsYXN0aWNzZWFyY2ggQi5WLiBsaWNlbnNlcyB0aGlzIGZpbGUgdG8geW91IHVuZGVyCiAqIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOyB5b3UgbWF5CiAqIG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwoKLyoqCiAqIFRpbWVsaW9uIEV4cHJlc3Npb24gQXV0b2NvbXBsZXRlcgogKgogKiBUaGlzIGRpcmVjdGl2ZSBhbGxvd3MgdXNlcnMgdG8gZW50ZXIgbXVsdGlsaW5lIHRpbWVsaW9uIGV4cHJlc3Npb25zLiBJZiB0aGUgdXNlciBoYXMgZW50ZXJlZAogKiBhIHZhbGlkIGV4cHJlc3Npb24gYW5kIHRoZW4gdHlwZXMgYSAiLiIsIHRoaXMgZGlyZWN0aXZlIHdpbGwgZGlzcGxheSBhIGxpc3Qgb2Ygc3VnZ2VzdGlvbnMuCiAqCiAqIFVzZXJzIGNhbiBuYXZpZ2F0ZSBzdWdnZXN0aW9ucyB1c2luZyB0aGUgYXJyb3cga2V5cy4gV2hlbiBhIHVzZXIgc2VsZWN0cyBhIHN1Z2dlc3Rpb24sIGl0J3MKICogaW5zZXJ0ZWQgaW50byB0aGUgZXhwcmVzc2lvbiBhbmQgdGhlIGNhcmV0IHBvc2l0aW9uIGlzIHVwZGF0ZWQgdG8gYmUgaW5zaWRlIG9mIHRoZSBuZXdseS0KICogYWRkZWQgZnVuY3Rpb24ncyBwYXJlbnRoZXNlcy4KICoKICogQmVuZWF0aCB0aGUgaG9vZCwgd2UgdXNlIGEgUEVHIGdyYW1tYXIgdG8gdmFsaWRhdGUgdGhlIFRpbWVsaW9uIGV4cHJlc3Npb24gYW5kIGRldGVjdCBpZgogKiB0aGUgY2FyZXQgaXMgaW4gYSBwb3NpdGlvbiB3aXRoaW4gdGhlIGV4cHJlc3Npb24gdGhhdCBhbGxvd3MgZnVuY3Rpb25zIHRvIGJlIHN1Z2dlc3RlZC4KICoKICogTk9URTogVGhpcyBkaXJlY3RpdmUgZG9lc24ndCB3b3JrIHdlbGwgd2l0aCBjb250ZW50ZWRpdGFibGUgZGl2cy4gQ2hhbGxlbmdlcyBpbmNsdWRlOgogKiAgIC0gWW91IGhhdmUgdG8gcmVwbGFjZSBtYXJrdXAgd2l0aCBuZXdsaW5lIGNoYXJhY3RlcnMgYW5kIHNwYWNlcyB3aGVuIHBhc3NpbmcgdGhlIGV4cHJlc3Npb24KICogICAgIHRvIHRoZSBncmFtbWFyLgogKiAgIC0gWW91IGhhdmUgdG8gZG8gdGhlIG9wcG9zaXRlIHdoZW4gbG9hZGluZyBhIHNhdmVkIGV4cHJlc3Npb24sIHNvIHRoYXQgaXQgYXBwZWFycyBjb3JyZWN0bHkKICogICAgIHdpdGhpbiB0aGUgY29udGVudGVkaXRhYmxlIChpLmUuIHJlcGxhY2UgbmV3bGluZXMgd2l0aCA8YnI+IG1hcmt1cCkuCiAqICAgLSBUaGUgUmFuZ2UgYW5kIFNlbGVjdGlvbiBBUElzIGlnbm9yZSBuZXdsaW5lcyB3aGVuIHByb3ZpZGluZyBjYXJldCBwb3NpdGlvbiwgc28gdGhlcmUgaXMKICogICAgIGxpdGVyYWxseSBubyB3YXkgdG8gaW5zZXJ0IHN1Z2dlc3Rpb25zIGludG8gdGhlIGNvcnJlY3QgcGxhY2UgaW4gYSBtdWx0aWxpbmUgZXhwcmVzc2lvbgogKiAgICAgdGhhdCBoYXMgbW9yZSB0aGFuIGEgc2luZ2xlIGNvbnNlY3V0aXZlIG5ld2xpbmUuCiAqLwp2YXIgUGFyc2VyID0gX3BlZ2pzLmRlZmF1bHQuZ2VuZXJhdGUoX2NoYWluLmRlZmF1bHQpOwoKZnVuY3Rpb24gVGltZWxpb25FeHBJbnB1dCgkaHR0cCwgJHRpbWVvdXQpIHsKICByZXR1cm4gewogICAgcmVzdHJpY3Q6ICdFJywKICAgIHNjb3BlOiB7CiAgICAgIHJvd3M6ICc9JywKICAgICAgc2hlZXQ6ICc9JywKICAgICAgdXBkYXRlQ2hhcnQ6ICcmJywKICAgICAgc2hvdWxkUG9wb3ZlclN1Z2dlc3Rpb25zOiAnQCcKICAgIH0sCiAgICByZXBsYWNlOiB0cnVlLAogICAgdGVtcGxhdGU6IF90aW1lbGlvbl9leHByZXNzaW9uX2lucHV0LmRlZmF1bHQsCiAgICBsaW5rOiBmdW5jdGlvbiBsaW5rKHNjb3BlLCBlbGVtKSB7CiAgICAgIHZhciBhcmdWYWx1ZVN1Z2dlc3Rpb25zID0gKDAsIF9hcmdfdmFsdWVfc3VnZ2VzdGlvbnMuZ2V0QXJnVmFsdWVTdWdnZXN0aW9ucykoKTsKICAgICAgdmFyIGV4cHJlc3Npb25JbnB1dCA9IGVsZW0uZmluZCgnW2RhdGEtZXhwcmVzc2lvbi1pbnB1dF0nKTsKICAgICAgdmFyIGZ1bmN0aW9uUmVmZXJlbmNlID0ge307CiAgICAgIHZhciBzdWdnZXN0aWJsZUZ1bmN0aW9uTG9jYXRpb24gPSB7fTsKICAgICAgc2NvcGUuc3VnZ2VzdGlvbnMgPSBuZXcgX3RpbWVsaW9uX2V4cHJlc3Npb25faW5wdXRfaGVscGVycy5TdWdnZXN0aW9ucygpOwoKICAgICAgZnVuY3Rpb24gaW5pdCgpIHsKICAgICAgICAkaHR0cC5nZXQoJy4uL2FwaS90aW1lbGlvbi9mdW5jdGlvbnMnKS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7CiAgICAgICAgICBPYmplY3QuYXNzaWduKGZ1bmN0aW9uUmVmZXJlbmNlLCB7CiAgICAgICAgICAgIGJ5TmFtZTogX2xvZGFzaC5kZWZhdWx0LmluZGV4QnkocmVzcC5kYXRhLCAnbmFtZScpLAogICAgICAgICAgICBsaXN0OiByZXNwLmRhdGEKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9CgogICAgICBmdW5jdGlvbiBzZXRDYXJldE9mZnNldChjYXJldE9mZnNldCkgewogICAgICAgIC8vIFdhaXQgZm9yIEFuZ3VsYXIgdG8gdXBkYXRlIHRoZSBpbnB1dCB3aXRoIHRoZSBuZXcgZXhwcmVzc2lvbiBhbmQgKnRoZW4qIHdlIGNhbiBzZXQKICAgICAgICAvLyB0aGUgY2FyZXQgcG9zaXRpb24uCiAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgZXhwcmVzc2lvbklucHV0LmZvY3VzKCk7CiAgICAgICAgICBleHByZXNzaW9uSW5wdXRbMF0uc2VsZWN0aW9uU3RhcnQgPSBleHByZXNzaW9uSW5wdXRbMF0uc2VsZWN0aW9uRW5kID0gY2FyZXRPZmZzZXQ7CiAgICAgICAgICBzY29wZS4kYXBwbHkoKTsKICAgICAgICB9LCAwKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gaW5zZXJ0U3VnZ2VzdGlvbkludG9FeHByZXNzaW9uKHN1Z2dlc3Rpb25JbmRleCkgewogICAgICAgIGlmIChzY29wZS5zdWdnZXN0aW9ucy5pc0VtcHR5KCkpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHZhciBfc3VnZ2VzdGlibGVGdW5jdGlvbkwgPSBzdWdnZXN0aWJsZUZ1bmN0aW9uTG9jYXRpb24sCiAgICAgICAgICAgIG1pbiA9IF9zdWdnZXN0aWJsZUZ1bmN0aW9uTC5taW4sCiAgICAgICAgICAgIG1heCA9IF9zdWdnZXN0aWJsZUZ1bmN0aW9uTC5tYXg7CiAgICAgICAgdmFyIGluc2VydGVkVmFsdWU7CiAgICAgICAgdmFyIGluc2VydFBvc2l0aW9uTWluT2Zmc2V0ID0gMDsKCiAgICAgICAgc3dpdGNoIChzY29wZS5zdWdnZXN0aW9ucy50eXBlKSB7CiAgICAgICAgICBjYXNlIF90aW1lbGlvbl9leHByZXNzaW9uX2lucHV0X2hlbHBlcnMuU1VHR0VTVElPTl9UWVBFLkZVTkNUSU9OUzoKICAgICAgICAgICAgewogICAgICAgICAgICAgIC8vIFBvc2l0aW9uIHRoZSBjYXJldCBpbnNpZGUgb2YgdGhlIGZ1bmN0aW9uIHBhcmVudGhlc2VzLgogICAgICAgICAgICAgIGluc2VydGVkVmFsdWUgPSAiIi5jb25jYXQoc2NvcGUuc3VnZ2VzdGlvbnMubGlzdFtzdWdnZXN0aW9uSW5kZXhdLm5hbWUsICIoKSIpOyAvLyBtaW4gYWR2YW5jZWQgb25lIHRvIG5vdCByZXBsYWNlIGZ1bmN0aW9uICcuJwoKICAgICAgICAgICAgICBpbnNlcnRQb3NpdGlvbk1pbk9mZnNldCA9IDE7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICBjYXNlIF90aW1lbGlvbl9leHByZXNzaW9uX2lucHV0X2hlbHBlcnMuU1VHR0VTVElPTl9UWVBFLkFSR1VNRU5UUzoKICAgICAgICAgICAgewogICAgICAgICAgICAgIC8vIFBvc2l0aW9uIHRoZSBjYXJldCBhZnRlciB0aGUgJz0nCiAgICAgICAgICAgICAgaW5zZXJ0ZWRWYWx1ZSA9ICIiLmNvbmNhdChzY29wZS5zdWdnZXN0aW9ucy5saXN0W3N1Z2dlc3Rpb25JbmRleF0ubmFtZSwgIj0iKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgIGNhc2UgX3RpbWVsaW9uX2V4cHJlc3Npb25faW5wdXRfaGVscGVycy5TVUdHRVNUSU9OX1RZUEUuQVJHVU1FTlRfVkFMVUU6CiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAvLyBQb3NpdGlvbiB0aGUgY2FyZXQgYWZ0ZXIgdGhlIGFyZ3VtZW50IHZhbHVlCiAgICAgICAgICAgICAgaW5zZXJ0ZWRWYWx1ZSA9ICIiLmNvbmNhdChzY29wZS5zdWdnZXN0aW9ucy5saXN0W3N1Z2dlc3Rpb25JbmRleF0ubmFtZSk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHZhciB1cGRhdGVkRXhwcmVzc2lvbiA9ICgwLCBfdGltZWxpb25fZXhwcmVzc2lvbl9pbnB1dF9oZWxwZXJzLmluc2VydEF0TG9jYXRpb24pKGluc2VydGVkVmFsdWUsIHNjb3BlLnNoZWV0LCBtaW4gKyBpbnNlcnRQb3NpdGlvbk1pbk9mZnNldCwgbWF4KTsKICAgICAgICBzY29wZS5zaGVldCA9IHVwZGF0ZWRFeHByZXNzaW9uOwogICAgICAgIHZhciBuZXdDYXJldE9mZnNldCA9IG1pbiArIGluc2VydGVkVmFsdWUubGVuZ3RoOwogICAgICAgIHNldENhcmV0T2Zmc2V0KG5ld0NhcmV0T2Zmc2V0KTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gc2Nyb2xsVG9TdWdnZXN0aW9uQXQoaW5kZXgpIHsKICAgICAgICAvLyBXZSBkb24ndCBjYWNoZSB0aGVzZSBiZWNhdXNlIHRoZSBsaXN0IGNoYW5nZXMgYmFzZWQgb24gdXNlciBpbnB1dC4KICAgICAgICB2YXIgc3VnZ2VzdGlvbnNMaXN0ID0gKDAsIF9qcXVlcnkuZGVmYXVsdCkoJ1tkYXRhLXN1Z2dlc3Rpb25zLWxpc3RdJyk7CiAgICAgICAgdmFyIHN1Z2dlc3Rpb25MaXN0SXRlbSA9ICgwLCBfanF1ZXJ5LmRlZmF1bHQpKCdbZGF0YS1zdWdnZXN0aW9uLWxpc3QtaXRlbV0nKVtpbmRleF07IC8vIFNjcm9sbCB0byB0aGUgcG9zaXRpb24gb2YgdGhlIGl0ZW0gcmVsYXRpdmUgdG8gdGhlIGxpc3QsIG5vdCB0byB0aGUgd2luZG93LgoKICAgICAgICBzdWdnZXN0aW9uc0xpc3Quc2Nyb2xsVG9wKHN1Z2dlc3Rpb25MaXN0SXRlbS5vZmZzZXRUb3AgLSBzdWdnZXN0aW9uc0xpc3RbMF0ub2Zmc2V0VG9wKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gZ2V0Q3Vyc29yUG9zaXRpb24oKSB7CiAgICAgICAgaWYgKGV4cHJlc3Npb25JbnB1dC5sZW5ndGgpIHsKICAgICAgICAgIHJldHVybiBleHByZXNzaW9uSW5wdXRbMF0uc2VsZWN0aW9uU3RhcnQ7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gZ2V0U3VnZ2VzdGlvbnMoKSB7CiAgICAgICAgdmFyIHN1Z2dlc3Rpb25zOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXN5bmMoZnVuY3Rpb24gZ2V0U3VnZ2VzdGlvbnMkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI7CiAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKCgwLCBfdGltZWxpb25fZXhwcmVzc2lvbl9pbnB1dF9oZWxwZXJzLnN1Z2dlc3QpKHNjb3BlLnNoZWV0LCBmdW5jdGlvblJlZmVyZW5jZS5saXN0LCBQYXJzZXIsIGdldEN1cnNvclBvc2l0aW9uKCksIGFyZ1ZhbHVlU3VnZ2VzdGlvbnMpKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgc3VnZ2VzdGlvbnMgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICAgICAgLy8gV2UncmUgdXNpbmcgRVM2IFByb21pc2VzLCBub3QgJHEsIHNvIHdlIGhhdmUgdG8gd3JhcCB0aGlzIGluICRhcHBseS4KICAgICAgICAgICAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIGlmIChzdWdnZXN0aW9ucykgewogICAgICAgICAgICAgICAgICAgIHNjb3BlLnN1Z2dlc3Rpb25zLnNldExpc3Qoc3VnZ2VzdGlvbnMubGlzdCwgc3VnZ2VzdGlvbnMudHlwZSk7CiAgICAgICAgICAgICAgICAgICAgc2NvcGUuc3VnZ2VzdGlvbnMuc2hvdygpOwogICAgICAgICAgICAgICAgICAgIHN1Z2dlc3RpYmxlRnVuY3Rpb25Mb2NhdGlvbiA9IHN1Z2dlc3Rpb25zLmxvY2F0aW9uOwogICAgICAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWdnZXN0aW9uc0xpc3QgPSAoMCwgX2pxdWVyeS5kZWZhdWx0KSgnW2RhdGEtc3VnZ2VzdGlvbnMtbGlzdF0nKTsKICAgICAgICAgICAgICAgICAgICAgIHN1Z2dlc3Rpb25zTGlzdC5zY3JvbGxUb3AoMCk7CiAgICAgICAgICAgICAgICAgICAgfSwgMCk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICBzdWdnZXN0aWJsZUZ1bmN0aW9uTG9jYXRpb24gPSB1bmRlZmluZWQ7CiAgICAgICAgICAgICAgICAgIHNjb3BlLnN1Z2dlc3Rpb25zLnJlc2V0KCk7CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGlzTmF2aWdhdGlvbmFsS2V5KGtleUNvZGUpIHsKICAgICAgICB2YXIga2V5Q29kZXMgPSBfbG9kYXNoLmRlZmF1bHQudmFsdWVzKF9ldWkuY29tYm9Cb3hLZXlDb2Rlcyk7CgogICAgICAgIHJldHVybiBrZXlDb2Rlcy5pbmNsdWRlcyhrZXlDb2RlKTsKICAgICAgfQoKICAgICAgc2NvcGUub25Gb2N1c0lucHV0ID0gZnVuY3Rpb24gKCkgewogICAgICAgIC8vIFdhaXQgZm9yIHRoZSBjYXJldCBwb3NpdGlvbiBvZiB0aGUgaW5wdXQgdG8gdXBkYXRlIGFuZCB0aGVuIHdlIGNhbiBnZXQgc3VnZ2VzdGlvbnMKICAgICAgICAvLyAod2hpY2ggZGVwZW5kcyBvbiB0aGUgY2FyZXQgcG9zaXRpb24pLgogICAgICAgICR0aW1lb3V0KGdldFN1Z2dlc3Rpb25zLCAwKTsKICAgICAgfTsKCiAgICAgIHNjb3BlLm9uQmx1cklucHV0ID0gZnVuY3Rpb24gKCkgewogICAgICAgIHNjb3BlLnN1Z2dlc3Rpb25zLmhpZGUoKTsKICAgICAgfTsKCiAgICAgIHNjb3BlLm9uS2V5RG93bklucHV0ID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAvLyBJZiB3ZSd2ZSBwcmVzc2VkIGFueSBub24tbmF2aWdhdGlvbmFsIGtleXMsIHRoZW4gdGhlIHVzZXIgaGFzIHR5cGVkIHNvbWV0aGluZyBhbmQgd2UKICAgICAgICAvLyBjYW4gZXhpdCBlYXJseSB3aXRob3V0IGRvaW5nIGFueSBuYXZpZ2F0aW9uLiBUaGUga2V5dXAgaGFuZGxlciB3aWxsIHB1bGwgdXAgc3VnZ2VzdGlvbnMuCiAgICAgICAgaWYgKCFpc05hdmlnYXRpb25hbEtleShlLmtleUNvZGUpKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBzd2l0Y2ggKGUua2V5Q29kZSkgewogICAgICAgICAgY2FzZSBfZXVpLmNvbWJvQm94S2V5Q29kZXMuVVA6CiAgICAgICAgICAgIGlmIChzY29wZS5zdWdnZXN0aW9ucy5pc1Zpc2libGUpIHsKICAgICAgICAgICAgICAvLyBVcCBhbmQgZG93biBrZXlzIG5hdmlnYXRlIHRocm91Z2ggc3VnZ2VzdGlvbnMuCiAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICAgIHNjb3BlLnN1Z2dlc3Rpb25zLnN0ZXBGb3J3YXJkKCk7CiAgICAgICAgICAgICAgc2Nyb2xsVG9TdWdnZXN0aW9uQXQoc2NvcGUuc3VnZ2VzdGlvbnMuaW5kZXgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIF9ldWkuY29tYm9Cb3hLZXlDb2Rlcy5ET1dOOgogICAgICAgICAgICBpZiAoc2NvcGUuc3VnZ2VzdGlvbnMuaXNWaXNpYmxlKSB7CiAgICAgICAgICAgICAgLy8gVXAgYW5kIGRvd24ga2V5cyBuYXZpZ2F0ZSB0aHJvdWdoIHN1Z2dlc3Rpb25zLgogICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgICBzY29wZS5zdWdnZXN0aW9ucy5zdGVwQmFja3dhcmQoKTsKICAgICAgICAgICAgICBzY3JvbGxUb1N1Z2dlc3Rpb25BdChzY29wZS5zdWdnZXN0aW9ucy5pbmRleCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgX2V1aS5jb21ib0JveEtleUNvZGVzLlRBQjoKICAgICAgICAgICAgLy8gSWYgdGhlcmUgYXJlIG5vIHN1Z2dlc3Rpb25zIG9yIG5vbmUgaXMgc2VsZWN0ZWQsIHRoZSB1c2VyIHRhYnMgdG8gdGhlIG5leHQgaW5wdXQuCiAgICAgICAgICAgIGlmIChzY29wZS5zdWdnZXN0aW9ucy5pc0VtcHR5KCkgfHwgc2NvcGUuc3VnZ2VzdGlvbnMuaW5kZXggPCAwKSB7CiAgICAgICAgICAgICAgLy8gQmVmb3JlIGxldHRpbmcgdGhlIHRhYiBiZSBoYW5kbGVkIHRvIGZvY3VzIHRoZSBuZXh0IGVsZW1lbnQKICAgICAgICAgICAgICAvLyB3ZSBuZWVkIHRvIGhpZGUgdGhlIHN1Z2dlc3Rpb25zLCBvdGhlcndpc2UgaXQgd2lsbCBmb2N1cyB0aGVzZQogICAgICAgICAgICAgIC8vIGluc3RlYWQgb2YgdGhlIHRpbWUgaW50ZXJ2YWwgc2VsZWN0LgogICAgICAgICAgICAgIHNjb3BlLnN1Z2dlc3Rpb25zLmhpZGUoKTsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0gLy8gSWYgd2UgaGF2ZSBzdWdnZXN0aW9ucywgY29tcGxldGUgdGhlIHNlbGVjdGVkIG9uZS4KCgogICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgIGluc2VydFN1Z2dlc3Rpb25JbnRvRXhwcmVzc2lvbihzY29wZS5zdWdnZXN0aW9ucy5pbmRleCk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgX2V1aS5jb21ib0JveEtleUNvZGVzLkVOVEVSOgogICAgICAgICAgICBpZiAoZS5tZXRhS2V5IHx8IGUuY3RybEtleSkgewogICAgICAgICAgICAgIC8vIFJlLXJlbmRlciB0aGUgY2hhcnQgd2hlbiB0aGUgdXNlciBoaXRzIENNRCtFTlRFUi4KICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgICAgc2NvcGUudXBkYXRlQ2hhcnQoKTsKICAgICAgICAgICAgfSBlbHNlIGlmICghc2NvcGUuc3VnZ2VzdGlvbnMuaXNFbXB0eSgpKSB7CiAgICAgICAgICAgICAgLy8gSWYgdGhlIHN1Z2dlc3Rpb25zIGFyZSBvcGVuLCBjb21wbGV0ZSB0aGUgZXhwcmVzc2lvbiB3aXRoIHRoZSBzdWdnZXN0aW9uLgogICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgICBpbnNlcnRTdWdnZXN0aW9uSW50b0V4cHJlc3Npb24oc2NvcGUuc3VnZ2VzdGlvbnMuaW5kZXgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIF9ldWkuY29tYm9Cb3hLZXlDb2Rlcy5FU0NBUEU6CiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgc2NvcGUuc3VnZ2VzdGlvbnMuaGlkZSgpOwogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH07CgogICAgICBzY29wZS5vbktleVVwSW5wdXQgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIC8vIElmIHRoZSB1c2VyIGlzbid0IG5hdmlnYXRpbmcsIHRoZW4gd2Ugc2hvdWxkIHVwZGF0ZSB0aGUgc3VnZ2VzdGlvbnMgYmFzZWQgb24gdGhlaXIgaW5wdXQuCiAgICAgICAgaWYgKCFpc05hdmlnYXRpb25hbEtleShlLmtleUNvZGUpKSB7CiAgICAgICAgICBnZXRTdWdnZXN0aW9ucygpOwogICAgICAgIH0KICAgICAgfTsKCiAgICAgIHNjb3BlLm9uQ2xpY2tFeHByZXNzaW9uID0gZnVuY3Rpb24gKCkgewogICAgICAgIGdldFN1Z2dlc3Rpb25zKCk7CiAgICAgIH07CgogICAgICBzY29wZS5vbkNsaWNrU3VnZ2VzdGlvbiA9IGZ1bmN0aW9uIChpbmRleCkgewogICAgICAgIGluc2VydFN1Z2dlc3Rpb25JbnRvRXhwcmVzc2lvbihpbmRleCk7CiAgICAgIH07CgogICAgICBzY29wZS5nZXRBY3RpdmVTdWdnZXN0aW9uSWQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKHNjb3BlLnN1Z2dlc3Rpb25zLmlzVmlzaWJsZSAmJiBzY29wZS5zdWdnZXN0aW9ucy5pbmRleCA+IC0xKSB7CiAgICAgICAgICByZXR1cm4gInRpbWVsaW9uU3VnZ2VzdGlvbiIuY29uY2F0KHNjb3BlLnN1Z2dlc3Rpb25zLmluZGV4KTsKICAgICAgICB9CgogICAgICAgIHJldHVybiAnJzsKICAgICAgfTsKCiAgICAgIGluaXQoKTsKICAgIH0KICB9Owp9"},null]}