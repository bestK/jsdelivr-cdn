{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/security/public/views/management/edit_role/components/edit_role_page.js","dependencies":[{"path":"x-pack/legacy/plugins/security/public/views/management/edit_role/components/edit_role_page.js","mtime":1585205047180},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiKSB7IF90eXBlb2YyID0gZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mMiA9IGZ1bmN0aW9uIF90eXBlb2YyKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mMihvYmopOyB9CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuRWRpdFJvbGVQYWdlID0gdm9pZCAwOwoKdmFyIF9ldWkgPSByZXF1aXJlKCJAZWxhc3RpYy9ldWkiKTsKCnZhciBfcmVhY3QgPSByZXF1aXJlKCJAa2JuL2kxOG4vcmVhY3QiKTsKCnZhciBfbG9kYXNoID0gcmVxdWlyZSgibG9kYXNoIik7Cgp2YXIgX3JlYWN0MiA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoInJlYWN0IikpOwoKdmFyIF9ub3RpZnkgPSByZXF1aXJlKCJ1aS9ub3RpZnkiKTsKCnZhciBfbW9kZWwgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi8uLi9jb21tb24vbW9kZWwiKTsKCnZhciBfcm9sZV91dGlscyA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL2xpYi9yb2xlX3V0aWxzIik7Cgp2YXIgX29iamVjdHMgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9vYmplY3RzIik7Cgp2YXIgX21hbmFnZW1lbnRfdXJscyA9IHJlcXVpcmUoIi4uLy4uL21hbmFnZW1lbnRfdXJscyIpOwoKdmFyIF92YWxpZGF0ZV9yb2xlID0gcmVxdWlyZSgiLi4vbGliL3ZhbGlkYXRlX3JvbGUiKTsKCnZhciBfZGVsZXRlX3JvbGVfYnV0dG9uID0gcmVxdWlyZSgiLi9kZWxldGVfcm9sZV9idXR0b24iKTsKCnZhciBfcHJpdmlsZWdlcyA9IHJlcXVpcmUoIi4vcHJpdmlsZWdlcyIpOwoKdmFyIF9yZXNlcnZlZF9yb2xlX2JhZGdlID0gcmVxdWlyZSgiLi9yZXNlcnZlZF9yb2xlX2JhZGdlIik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsKICBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7CiAgICByZXR1cm4gb2JqOwogIH0gZWxzZSB7CiAgICB2YXIgbmV3T2JqID0ge307CgogICAgaWYgKG9iaiAhPSBudWxsKSB7CiAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHsKICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgewogICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvciA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpIDoge307CgogICAgICAgICAgaWYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSB7CiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmosIGtleSwgZGVzYyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBuZXdPYmpba2V5XSA9IG9ialtrZXldOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIG5ld09iai5kZWZhdWx0ID0gb2JqOwogICAgcmV0dXJuIG5ld09iajsKICB9Cn0KCmZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7CiAgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgX3R5cGVvZjIoU3ltYm9sLml0ZXJhdG9yKSA9PT0gInN5bWJvbCIpIHsKICAgIF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgewogICAgICByZXR1cm4gX3R5cGVvZjIob2JqKTsKICAgIH07CiAgfSBlbHNlIHsKICAgIF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgewogICAgICByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiBfdHlwZW9mMihvYmopOwogICAgfTsKICB9CgogIHJldHVybiBfdHlwZW9mKG9iaik7Cn0KCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgewogIHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsKCiAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsKICAgIHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOwogICAgaWYgKGVudW1lcmFibGVPbmx5KSBzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgewogICAgICByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsKICAgIH0pOwogICAga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOwogIH0KCiAgcmV0dXJuIGtleXM7Cn0KCmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7CiAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsKICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OwoKICAgIGlmIChpICUgMikgewogICAgICBvd25LZXlzKHNvdXJjZSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7CiAgICAgIH0pOwogICAgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgewogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpOwogICAgfSBlbHNlIHsKICAgICAgb3duS2V5cyhzb3VyY2UpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOwogICAgICB9KTsKICAgIH0KICB9CgogIHJldHVybiB0YXJnZXQ7Cn0KCmZ1bmN0aW9uIF9leHRlbmRzKCkgewogIF9leHRlbmRzID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiAodGFyZ2V0KSB7CiAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgewogICAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldOwoKICAgICAgZm9yICh2YXIga2V5IGluIHNvdXJjZSkgewogICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoc291cmNlLCBrZXkpKSB7CiAgICAgICAgICB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHJldHVybiB0YXJnZXQ7CiAgfTsKCiAgcmV0dXJuIF9leHRlbmRzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsKICBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7CiAgfQp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgewogICAgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsKICAgIGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsKICAgIGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsKICAgIGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOwogIH0KfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgewogIGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOwogIGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsKICByZXR1cm4gQ29uc3RydWN0b3I7Cn0KCmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsKICBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpKSB7CiAgICByZXR1cm4gY2FsbDsKICB9CgogIHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOwp9CgpmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgewogIF9nZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7CiAgICByZXR1cm4gby5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKG8pOwogIH07CiAgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsKfQoKZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7CiAgaWYgKHNlbGYgPT09IHZvaWQgMCkgewogICAgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsKICB9CgogIHJldHVybiBzZWxmOwp9CgpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsKICBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICJmdW5jdGlvbiIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24iKTsKICB9CgogIHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgewogICAgY29uc3RydWN0b3I6IHsKICAgICAgdmFsdWU6IHN1YkNsYXNzLAogICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlCiAgICB9CiAgfSk7CiAgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcyk7Cn0KCmZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7CiAgX3NldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IGZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7CiAgICBvLl9fcHJvdG9fXyA9IHA7CiAgICByZXR1cm4gbzsKICB9OwoKICByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApOwp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7CiAgaWYgKGtleSBpbiBvYmopIHsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgICB2YWx1ZTogdmFsdWUsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgd3JpdGFibGU6IHRydWUKICAgIH0pOwogIH0gZWxzZSB7CiAgICBvYmpba2V5XSA9IHZhbHVlOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKdmFyIEVkaXRSb2xlUGFnZVVJID0KLyojX19QVVJFX18qLwpmdW5jdGlvbiAoX0NvbXBvbmVudCkgewogIF9pbmhlcml0cyhFZGl0Um9sZVBhZ2VVSSwgX0NvbXBvbmVudCk7CgogIGZ1bmN0aW9uIEVkaXRSb2xlUGFnZVVJKF9wcm9wcykgewogICAgdmFyIF90aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBFZGl0Um9sZVBhZ2VVSSk7CgogICAgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfZ2V0UHJvdG90eXBlT2YoRWRpdFJvbGVQYWdlVUkpLmNhbGwodGhpcywgX3Byb3BzKSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAidmFsaWRhdG9yIiwgdm9pZCAwKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJnZXRGb3JtVGl0bGUiLCBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciB0aXRsZVRleHQ7CiAgICAgIHZhciBwcm9wcyA9IHsKICAgICAgICB0YWJJbmRleDogMAogICAgICB9OwoKICAgICAgaWYgKCgwLCBfcm9sZV91dGlscy5pc1Jlc2VydmVkUm9sZSkoX3RoaXMuc3RhdGUucm9sZSkpIHsKICAgICAgICB0aXRsZVRleHQgPSBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgICAgaWQ6ICJ4cGFjay5zZWN1cml0eS5tYW5hZ2VtZW50LmVkaXRSb2xlLnZpZXdpbmdSb2xlVGl0bGUiLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJWaWV3aW5nIHJvbGUiCiAgICAgICAgfSk7CiAgICAgICAgcHJvcHNbJ2FyaWEtZGVzY3JpYmVkYnknXSA9ICdyZXNlcnZlZFJvbGVEZXNjcmlwdGlvbic7CiAgICAgIH0gZWxzZSBpZiAoX3RoaXMuZWRpdGluZ0V4aXN0aW5nUm9sZSgpKSB7CiAgICAgICAgdGl0bGVUZXh0ID0gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICAgIGlkOiAieHBhY2suc2VjdXJpdHkubWFuYWdlbWVudC5lZGl0Um9sZS5lZGl0Um9sZVRpdGxlIiwKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiRWRpdCByb2xlIgogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHRpdGxlVGV4dCA9IF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICBpZDogInhwYWNrLnNlY3VyaXR5Lm1hbmFnZW1lbnQuZWRpdFJvbGUuY3JlYXRlUm9sZVRpdGxlIiwKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiQ3JlYXRlIHJvbGUiCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRpdGxlLCB7CiAgICAgICAgc2l6ZTogImwiCiAgICAgIH0sIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJoMSIsIHByb3BzLCB0aXRsZVRleHQsICIgIiwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3Jlc2VydmVkX3JvbGVfYmFkZ2UuUmVzZXJ2ZWRSb2xlQmFkZ2UsIHsKICAgICAgICByb2xlOiBfdGhpcy5zdGF0ZS5yb2xlCiAgICAgIH0pKSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJnZXRBY3Rpb25CdXR0b24iLCBmdW5jdGlvbiAoKSB7CiAgICAgIGlmIChfdGhpcy5lZGl0aW5nRXhpc3RpbmdSb2xlKCkgJiYgISgwLCBfcm9sZV91dGlscy5pc1JlYWRPbmx5Um9sZSkoX3RoaXMuc3RhdGUucm9sZSkpIHsKICAgICAgICByZXR1cm4gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgICAgICAgZ3JvdzogZmFsc2UKICAgICAgICB9LCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZGVsZXRlX3JvbGVfYnV0dG9uLkRlbGV0ZVJvbGVCdXR0b24sIHsKICAgICAgICAgIGNhbkRlbGV0ZTogdHJ1ZSwKICAgICAgICAgIG9uRGVsZXRlOiBfdGhpcy5oYW5kbGVEZWxldGVSb2xlCiAgICAgICAgfSkpOwogICAgICB9CgogICAgICByZXR1cm4gbnVsbDsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImdldFJvbGVOYW1lIiwgZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlQYW5lbCwgbnVsbCwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGb3JtUm93LCBfZXh0ZW5kcyh7CiAgICAgICAgbGFiZWw6IF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICBpZDogInhwYWNrLnNlY3VyaXR5Lm1hbmFnZW1lbnQuZWRpdFJvbGUucm9sZU5hbWVGb3JtUm93VGl0bGUiLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJSb2xlIG5hbWUiCiAgICAgICAgfSksCiAgICAgICAgaGVscFRleHQ6ICEoMCwgX3JvbGVfdXRpbHMuaXNSZXNlcnZlZFJvbGUpKF90aGlzLnN0YXRlLnJvbGUpICYmIF90aGlzLmVkaXRpbmdFeGlzdGluZ1JvbGUoKSA/IF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICBpZDogInhwYWNrLnNlY3VyaXR5Lm1hbmFnZW1lbnQuZWRpdFJvbGUucm9sZU5hbWVGb3JtUm93SGVscFRleHQiLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJBIHJvbGUncyBuYW1lIGNhbm5vdCBiZSBjaGFuZ2VkIG9uY2UgaXQgaGFzIGJlZW4gY3JlYXRlZC4iCiAgICAgICAgfSkgOiB1bmRlZmluZWQKICAgICAgfSwgX3RoaXMudmFsaWRhdG9yLnZhbGlkYXRlUm9sZU5hbWUoX3RoaXMuc3RhdGUucm9sZSkpLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZpZWxkVGV4dCwgewogICAgICAgIG5hbWU6ICduYW1lJywKICAgICAgICB2YWx1ZTogX3RoaXMuc3RhdGUucm9sZS5uYW1lIHx8ICcnLAogICAgICAgIG9uQ2hhbmdlOiBfdGhpcy5vbk5hbWVDaGFuZ2UsCiAgICAgICAgImRhdGEtdGVzdC1zdWJqIjogJ3JvbGVGb3JtTmFtZUlucHV0JywKICAgICAgICByZWFkT25seTogKDAsIF9yb2xlX3V0aWxzLmlzUmVzZXJ2ZWRSb2xlKShfdGhpcy5zdGF0ZS5yb2xlKSB8fCBfdGhpcy5lZGl0aW5nRXhpc3RpbmdSb2xlKCkKICAgICAgfSkpKTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIm9uTmFtZUNoYW5nZSIsIGZ1bmN0aW9uIChlKSB7CiAgICAgIHZhciByYXdWYWx1ZSA9IGUudGFyZ2V0LnZhbHVlOwogICAgICB2YXIgbmFtZSA9IHJhd1ZhbHVlLnJlcGxhY2UoL1xzL2csICdfJyk7CgogICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgcm9sZTogX29iamVjdFNwcmVhZCh7fSwgX3RoaXMuc3RhdGUucm9sZSwgewogICAgICAgICAgbmFtZTogbmFtZQogICAgICAgIH0pCiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAib25Sb2xlQ2hhbmdlIiwgZnVuY3Rpb24gKHJvbGUpIHsKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIHJvbGU6IHJvbGUKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJnZXRLaWJhbmFQcml2aWxlZ2VzIiwgZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIG51bGwsIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3BhY2VyLCBudWxsKSwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3ByaXZpbGVnZXMuS2liYW5hUHJpdmlsZWdlc1JlZ2lvbiwgewogICAgICAgIGtpYmFuYVByaXZpbGVnZXM6IG5ldyBfbW9kZWwuS2liYW5hUHJpdmlsZWdlcyhfdGhpcy5wcm9wcy5raWJhbmFQcml2aWxlZ2VzKSwKICAgICAgICBzcGFjZXM6IF90aGlzLnByb3BzLnNwYWNlcywKICAgICAgICBzcGFjZXNFbmFibGVkOiBfdGhpcy5wcm9wcy5zcGFjZXNFbmFibGVkLAogICAgICAgIGZlYXR1cmVzOiBfdGhpcy5wcm9wcy5mZWF0dXJlcywKICAgICAgICB1aUNhcGFiaWxpdGllczogX3RoaXMucHJvcHMudWlDYXBhYmlsaXRpZXMsCiAgICAgICAgZWRpdGFibGU6ICEoMCwgX3JvbGVfdXRpbHMuaXNSZWFkT25seVJvbGUpKF90aGlzLnN0YXRlLnJvbGUpLAogICAgICAgIHJvbGU6IF90aGlzLnN0YXRlLnJvbGUsCiAgICAgICAgb25DaGFuZ2U6IF90aGlzLm9uUm9sZUNoYW5nZSwKICAgICAgICB2YWxpZGF0b3I6IF90aGlzLnZhbGlkYXRvciwKICAgICAgICBpbnRsOiBfdGhpcy5wcm9wcy5pbnRsCiAgICAgIH0pKTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImdldEZvcm1CdXR0b25zIiwgZnVuY3Rpb24gKCkgewogICAgICBpZiAoKDAsIF9yb2xlX3V0aWxzLmlzUmVhZE9ubHlSb2xlKShfdGhpcy5zdGF0ZS5yb2xlKSkgewogICAgICAgIHJldHVybiBfdGhpcy5nZXRSZXR1cm5Ub1JvbGVMaXN0QnV0dG9uKCk7CiAgICAgIH0KCiAgICAgIHJldHVybiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhHcm91cCwgewogICAgICAgIHJlc3BvbnNpdmU6IGZhbHNlCiAgICAgIH0sIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgICAgICBncm93OiBmYWxzZQogICAgICB9LCBfdGhpcy5nZXRTYXZlQnV0dG9uKCkpLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICAgICAgZ3JvdzogZmFsc2UKICAgICAgfSwgX3RoaXMuZ2V0Q2FuY2VsQnV0dG9uKCkpLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICAgICAgZ3JvdzogdHJ1ZQogICAgICB9KSwgX3RoaXMuZ2V0QWN0aW9uQnV0dG9uKCkpOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiZ2V0UmV0dXJuVG9Sb2xlTGlzdEJ1dHRvbiIsIGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQnV0dG9uLCB7CiAgICAgICAgb25DbGljazogX3RoaXMuYmFja1RvUm9sZUxpc3QsCiAgICAgICAgImRhdGEtdGVzdC1zdWJqIjogInJvbGVGb3JtUmV0dXJuQnV0dG9uIgogICAgICB9LCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAieHBhY2suc2VjdXJpdHkubWFuYWdlbWVudC5lZGl0Um9sZS5yZXR1cm5Ub1JvbGVMaXN0QnV0dG9uTGFiZWwiLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiUmV0dXJuIHRvIHJvbGUgbGlzdCIKICAgICAgfSkpOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiZ2V0U2F2ZUJ1dHRvbiIsIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHNhdmVUZXh0ID0gX3RoaXMuZWRpdGluZ0V4aXN0aW5nUm9sZSgpID8gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogInhwYWNrLnNlY3VyaXR5Lm1hbmFnZW1lbnQuZWRpdFJvbGUudXBkYXRlUm9sZVRleHQiLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiVXBkYXRlIHJvbGUiCiAgICAgIH0pIDogX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogInhwYWNrLnNlY3VyaXR5Lm1hbmFnZW1lbnQuZWRpdFJvbGUuY3JlYXRlUm9sZVRleHQiLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiQ3JlYXRlIHJvbGUiCiAgICAgIH0pOwogICAgICByZXR1cm4gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlCdXR0b24sIHsKICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiAicm9sZUZvcm1TYXZlQnV0dG9uIiwKICAgICAgICBmaWxsOiB0cnVlLAogICAgICAgIG9uQ2xpY2s6IF90aGlzLnNhdmVSb2xlLAogICAgICAgIGRpc2FibGVkOiAoMCwgX3JvbGVfdXRpbHMuaXNSZXNlcnZlZFJvbGUpKF90aGlzLnN0YXRlLnJvbGUpCiAgICAgIH0sIHNhdmVUZXh0KTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImdldENhbmNlbEJ1dHRvbiIsIGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQnV0dG9uRW1wdHksIHsKICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiAicm9sZUZvcm1DYW5jZWxCdXR0b24iLAogICAgICAgIG9uQ2xpY2s6IF90aGlzLmJhY2tUb1JvbGVMaXN0CiAgICAgIH0sIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJ4cGFjay5zZWN1cml0eS5tYW5hZ2VtZW50LmVkaXRSb2xlLmNhbmNlbEJ1dHRvbkxhYmVsIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkNhbmNlbCIKICAgICAgfSkpOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiZWRpdGluZ0V4aXN0aW5nUm9sZSIsIGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuICEhX3RoaXMucHJvcHMucm9sZS5uYW1lICYmIF90aGlzLnByb3BzLmFjdGlvbiA9PT0gJ2VkaXQnOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAic2F2ZVJvbGUiLCBmdW5jdGlvbiAoKSB7CiAgICAgIF90aGlzLnZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7CgogICAgICB2YXIgcmVzdWx0ID0gX3RoaXMudmFsaWRhdG9yLnZhbGlkYXRlRm9yU2F2ZShfdGhpcy5zdGF0ZS5yb2xlKTsKCiAgICAgIGlmIChyZXN1bHQuaXNJbnZhbGlkKSB7CiAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgZm9ybUVycm9yOiByZXN1bHQKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICBmb3JtRXJyb3I6IG51bGwKICAgICAgICB9KTsKCiAgICAgICAgdmFyIF90aGlzJHByb3BzID0gX3RoaXMucHJvcHMsCiAgICAgICAgICAgIGh0dHBDbGllbnQgPSBfdGhpcyRwcm9wcy5odHRwQ2xpZW50LAogICAgICAgICAgICBpbnRsID0gX3RoaXMkcHJvcHMuaW50bCwKICAgICAgICAgICAgc3BhY2VzRW5hYmxlZCA9IF90aGlzJHByb3BzLnNwYWNlc0VuYWJsZWQ7CiAgICAgICAgKDAsIF9vYmplY3RzLnNhdmVSb2xlKShodHRwQ2xpZW50LCBfdGhpcy5zdGF0ZS5yb2xlLCBzcGFjZXNFbmFibGVkKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIF9ub3RpZnkudG9hc3ROb3RpZmljYXRpb25zLmFkZFN1Y2Nlc3MoaW50bC5mb3JtYXRNZXNzYWdlKHsKICAgICAgICAgICAgaWQ6ICd4cGFjay5zZWN1cml0eS5tYW5hZ2VtZW50LmVkaXRSb2xlLnJvbGVTdWNjZXNzZnVsbHlTYXZlZE5vdGlmaWNhdGlvbk1lc3NhZ2UnLAogICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1NhdmVkIHJvbGUnCiAgICAgICAgICB9KSk7CgogICAgICAgICAgX3RoaXMuYmFja1RvUm9sZUxpc3QoKTsKICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICAgIF9ub3RpZnkudG9hc3ROb3RpZmljYXRpb25zLmFkZERhbmdlcigoMCwgX2xvZGFzaC5nZXQpKGVycm9yLCAnZGF0YS5tZXNzYWdlJykpOwogICAgICAgIH0pOwogICAgICB9CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJoYW5kbGVEZWxldGVSb2xlIiwgZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3RoaXMkcHJvcHMyID0gX3RoaXMucHJvcHMsCiAgICAgICAgICBodHRwQ2xpZW50ID0gX3RoaXMkcHJvcHMyLmh0dHBDbGllbnQsCiAgICAgICAgICByb2xlID0gX3RoaXMkcHJvcHMyLnJvbGUsCiAgICAgICAgICBpbnRsID0gX3RoaXMkcHJvcHMyLmludGw7CiAgICAgICgwLCBfb2JqZWN0cy5kZWxldGVSb2xlKShodHRwQ2xpZW50LCByb2xlLm5hbWUpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIF9ub3RpZnkudG9hc3ROb3RpZmljYXRpb25zLmFkZFN1Y2Nlc3MoaW50bC5mb3JtYXRNZXNzYWdlKHsKICAgICAgICAgIGlkOiAneHBhY2suc2VjdXJpdHkubWFuYWdlbWVudC5lZGl0Um9sZS5yb2xlU3VjY2Vzc2Z1bGx5RGVsZXRlZE5vdGlmaWNhdGlvbk1lc3NhZ2UnLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdEZWxldGVkIHJvbGUnCiAgICAgICAgfSkpOwoKICAgICAgICBfdGhpcy5iYWNrVG9Sb2xlTGlzdCgpOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICBfbm90aWZ5LnRvYXN0Tm90aWZpY2F0aW9ucy5hZGREYW5nZXIoKDAsIF9sb2Rhc2guZ2V0KShlcnJvciwgJ2RhdGEubWVzc2FnZScpKTsKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJiYWNrVG9Sb2xlTGlzdCIsIGZ1bmN0aW9uICgpIHsKICAgICAgd2luZG93LmxvY2F0aW9uLmhhc2ggPSBfbWFuYWdlbWVudF91cmxzLlJPTEVTX1BBVEg7CiAgICB9KTsKCiAgICBfdGhpcy52YWxpZGF0b3IgPSBuZXcgX3ZhbGlkYXRlX3JvbGUuUm9sZVZhbGlkYXRvcih7CiAgICAgIHNob3VsZFZhbGlkYXRlOiBmYWxzZQogICAgfSk7CgogICAgdmFyIF9yb2xlOwoKICAgIGlmIChfcHJvcHMuYWN0aW9uID09PSAnY2xvbmUnKSB7CiAgICAgIF9yb2xlID0gKDAsIF9yb2xlX3V0aWxzLnByZXBhcmVSb2xlQ2xvbmUpKF9wcm9wcy5yb2xlKTsKICAgIH0gZWxzZSB7CiAgICAgIF9yb2xlID0gKDAsIF9yb2xlX3V0aWxzLmNvcHlSb2xlKShfcHJvcHMucm9sZSk7CiAgICB9CgogICAgX3RoaXMuc3RhdGUgPSB7CiAgICAgIHJvbGU6IF9yb2xlLAogICAgICBmb3JtRXJyb3I6IG51bGwKICAgIH07CiAgICByZXR1cm4gX3RoaXM7CiAgfQoKICBfY3JlYXRlQ2xhc3MoRWRpdFJvbGVQYWdlVUksIFt7CiAgICBrZXk6ICJjb21wb25lbnREaWRNb3VudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50RGlkTW91bnQoKSB7CiAgICAgIGlmICh0aGlzLnByb3BzLmFjdGlvbiA9PT0gJ2Nsb25lJyAmJiAoMCwgX3JvbGVfdXRpbHMuaXNSZXNlcnZlZFJvbGUpKHRoaXMucHJvcHMucm9sZSkpIHsKICAgICAgICB0aGlzLmJhY2tUb1JvbGVMaXN0KCk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHsKICAgICAgdmFyIGRlc2NyaXB0aW9uID0gdGhpcy5wcm9wcy5zcGFjZXNFbmFibGVkID8gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogInhwYWNrLnNlY3VyaXR5Lm1hbmFnZW1lbnQuZWRpdFJvbGUuc2V0UHJpdmlsZWdlc1RvS2liYW5hU3BhY2VzRGVzY3JpcHRpb24iLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiU2V0IHByaXZpbGVnZXMgb24geW91ciBFbGFzdGljc2VhcmNoIGRhdGEgYW5kIGNvbnRyb2wgYWNjZXNzIHRvIHlvdXIgS2liYW5hIHNwYWNlcy4iCiAgICAgIH0pIDogX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogInhwYWNrLnNlY3VyaXR5Lm1hbmFnZW1lbnQuZWRpdFJvbGUuc2V0UHJpdmlsZWdlc1RvS2liYW5hRGVzY3JpcHRpb24iLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiU2V0IHByaXZpbGVnZXMgb24geW91ciBFbGFzdGljc2VhcmNoIGRhdGEgYW5kIGNvbnRyb2wgYWNjZXNzIHRvIEtpYmFuYS4iCiAgICAgIH0pOwogICAgICByZXR1cm4gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICBjbGFzc05hbWU6ICJlZGl0Um9sZVBhZ2UiCiAgICAgIH0sIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRm9ybSwgdGhpcy5zdGF0ZS5mb3JtRXJyb3IsIHRoaXMuZ2V0Rm9ybVRpdGxlKCksIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3BhY2VyLCBudWxsKSwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUZXh0LCB7CiAgICAgICAgc2l6ZTogInMiCiAgICAgIH0sIGRlc2NyaXB0aW9uKSwgKDAsIF9yb2xlX3V0aWxzLmlzUmVzZXJ2ZWRSb2xlKSh0aGlzLnN0YXRlLnJvbGUpICYmIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRnJhZ21lbnQsIG51bGwsIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3BhY2VyLCB7CiAgICAgICAgc2l6ZTogInMiCiAgICAgIH0pLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRleHQsIHsKICAgICAgICBzaXplOiAicyIsCiAgICAgICAgY29sb3I6ICJzdWJkdWVkIgogICAgICB9LCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudCgicCIsIHsKICAgICAgICBpZDogInJlc2VydmVkUm9sZURlc2NyaXB0aW9uIiwKICAgICAgICB0YWJJbmRleDogMAogICAgICB9LCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAieHBhY2suc2VjdXJpdHkubWFuYWdlbWVudC5lZGl0Um9sZS5tb2RpZnlpbmdSZXZlcnNlZFJvbGVzRGVzY3JpcHRpb24iLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiUmVzZXJ2ZWQgcm9sZXMgYXJlIGJ1aWx0LWluIGFuZCBjYW5ub3QgYmUgcmVtb3ZlZCBvciBtb2RpZmllZC4iCiAgICAgIH0pKSkpLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgbnVsbCksIHRoaXMuZ2V0Um9sZU5hbWUoKSwgdGhpcy5nZXRFbGFzdGljc2VhcmNoUHJpdmlsZWdlcygpLCB0aGlzLmdldEtpYmFuYVByaXZpbGVnZXMoKSwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTcGFjZXIsIG51bGwpLCB0aGlzLmdldEZvcm1CdXR0b25zKCkpKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRFbGFzdGljc2VhcmNoUHJpdmlsZWdlcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0RWxhc3RpY3NlYXJjaFByaXZpbGVnZXMoKSB7CiAgICAgIHJldHVybiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudCgiZGl2IiwgbnVsbCwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTcGFjZXIsIG51bGwpLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcHJpdmlsZWdlcy5FbGFzdGljc2VhcmNoUHJpdmlsZWdlcywgewogICAgICAgIHJvbGU6IHRoaXMuc3RhdGUucm9sZSwKICAgICAgICBlZGl0YWJsZTogISgwLCBfcm9sZV91dGlscy5pc1JlYWRPbmx5Um9sZSkodGhpcy5zdGF0ZS5yb2xlKSwKICAgICAgICBodHRwQ2xpZW50OiB0aGlzLnByb3BzLmh0dHBDbGllbnQsCiAgICAgICAgb25DaGFuZ2U6IHRoaXMub25Sb2xlQ2hhbmdlLAogICAgICAgIHJ1bkFzVXNlcnM6IHRoaXMucHJvcHMucnVuQXNVc2VycywKICAgICAgICB2YWxpZGF0b3I6IHRoaXMudmFsaWRhdG9yLAogICAgICAgIGluZGV4UGF0dGVybnM6IHRoaXMucHJvcHMuaW5kZXhQYXR0ZXJucywKICAgICAgICBidWlsdGluRVNQcml2aWxlZ2VzOiB0aGlzLnByb3BzLmJ1aWx0aW5FU1ByaXZpbGVnZXMsCiAgICAgICAgYWxsb3dEb2N1bWVudExldmVsU2VjdXJpdHk6IHRoaXMucHJvcHMuYWxsb3dEb2N1bWVudExldmVsU2VjdXJpdHksCiAgICAgICAgYWxsb3dGaWVsZExldmVsU2VjdXJpdHk6IHRoaXMucHJvcHMuYWxsb3dGaWVsZExldmVsU2VjdXJpdHkKICAgICAgfSkpOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIEVkaXRSb2xlUGFnZVVJOwp9KF9yZWFjdDIuQ29tcG9uZW50KTsKCnZhciBFZGl0Um9sZVBhZ2UgPSAoMCwgX3JlYWN0LmluamVjdEkxOG4pKEVkaXRSb2xlUGFnZVVJKTsKZXhwb3J0cy5FZGl0Um9sZVBhZ2UgPSBFZGl0Um9sZVBhZ2U7"},null]}