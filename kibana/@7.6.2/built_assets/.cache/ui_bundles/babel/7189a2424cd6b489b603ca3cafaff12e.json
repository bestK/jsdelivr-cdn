{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/transform/public/app/sections/create_transform/components/step_create/step_create_form.js","dependencies":[{"path":"x-pack/legacy/plugins/transform/public/app/sections/create_transform/components/step_create/step_create_form.js","mtime":1585205048547},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmdldERlZmF1bHRTdGVwQ3JlYXRlU3RhdGUgPSBnZXREZWZhdWx0U3RlcENyZWF0ZVN0YXRlOwpleHBvcnRzLlN0ZXBDcmVhdGVGb3JtID0gdm9pZCAwOwoKdmFyIF9yZWFjdCA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoInJlYWN0IikpOwoKdmFyIF9pMThuID0gcmVxdWlyZSgiQGtibi9pMThuIik7Cgp2YXIgX25vdGlmeSA9IHJlcXVpcmUoInVpL25vdGlmeSIpOwoKdmFyIF9ldWkgPSByZXF1aXJlKCJAZWxhc3RpYy9ldWkiKTsKCnZhciBfcHVibGljID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vc3JjL3BsdWdpbnMva2liYW5hX3JlYWN0L3B1YmxpYyIpOwoKdmFyIF9jb21wb25lbnRzID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vY29tcG9uZW50cyIpOwoKdmFyIF91c2VfYXBpID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vaG9va3MvdXNlX2FwaSIpOwoKdmFyIF9raWJhbmEgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9saWIva2liYW5hIik7Cgp2YXIgX25hdmlnYXRpb24gPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9jb21tb24vbmF2aWdhdGlvbiIpOwoKdmFyIF9jb25zdGFudHMgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi8uLi8uLi9jb21tb24vY29uc3RhbnRzIik7Cgp2YXIgX2NvbW1vbiA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL2NvbW1vbiIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7CiAgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgewogICAgcmV0dXJuIG9iajsKICB9IGVsc2UgewogICAgdmFyIG5ld09iaiA9IHt9OwoKICAgIGlmIChvYmogIT0gbnVsbCkgewogICAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7CiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHsKICAgICAgICAgIHZhciBkZXNjID0gT2JqZWN0LmRlZmluZVByb3BlcnR5ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KSA6IHt9OwoKICAgICAgICAgIGlmIChkZXNjLmdldCB8fCBkZXNjLnNldCkgewogICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobmV3T2JqLCBrZXksIGRlc2MpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBuZXdPYmouZGVmYXVsdCA9IG9iajsKICAgIHJldHVybiBuZXdPYmo7CiAgfQp9CgpmdW5jdGlvbiBfc2xpY2VkVG9BcnJheShhcnIsIGkpIHsKICByZXR1cm4gX2FycmF5V2l0aEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgfHwgX25vbkl0ZXJhYmxlUmVzdCgpOwp9CgpmdW5jdGlvbiBfbm9uSXRlcmFibGVSZXN0KCkgewogIHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2UiKTsKfQoKZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgewogIHZhciBfYXJyID0gW107CiAgdmFyIF9uID0gdHJ1ZTsKICB2YXIgX2QgPSBmYWxzZTsKICB2YXIgX2UgPSB1bmRlZmluZWQ7CgogIHRyeSB7CiAgICBmb3IgKHZhciBfaSA9IGFycltTeW1ib2wuaXRlcmF0b3JdKCksIF9zOyAhKF9uID0gKF9zID0gX2kubmV4dCgpKS5kb25lKTsgX24gPSB0cnVlKSB7CiAgICAgIF9hcnIucHVzaChfcy52YWx1ZSk7CgogICAgICBpZiAoaSAmJiBfYXJyLmxlbmd0aCA9PT0gaSkgYnJlYWs7CiAgICB9CiAgfSBjYXRjaCAoZXJyKSB7CiAgICBfZCA9IHRydWU7CiAgICBfZSA9IGVycjsKICB9IGZpbmFsbHkgewogICAgdHJ5IHsKICAgICAgaWYgKCFfbiAmJiBfaVsicmV0dXJuIl0gIT0gbnVsbCkgX2lbInJldHVybiJdKCk7CiAgICB9IGZpbmFsbHkgewogICAgICBpZiAoX2QpIHRocm93IF9lOwogICAgfQogIH0KCiAgcmV0dXJuIF9hcnI7Cn0KCmZ1bmN0aW9uIF9hcnJheVdpdGhIb2xlcyhhcnIpIHsKICBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSByZXR1cm4gYXJyOwp9CgpmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsKICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7CgogIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7CiAgICB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsKICAgIGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsKICAgICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7CiAgICB9KTsKICAgIGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsKICB9CgogIHJldHVybiBrZXlzOwp9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgewogIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsKCiAgICBpZiAoaSAlIDIpIHsKICAgICAgb3duS2V5cyhzb3VyY2UsIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOwogICAgICB9KTsKICAgIH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsKICAgIH0gZWxzZSB7CiAgICAgIG93bktleXMoc291cmNlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsKICAgICAgfSk7CiAgICB9CiAgfQoKICByZXR1cm4gdGFyZ2V0Owp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7CiAgaWYgKGtleSBpbiBvYmopIHsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgICB2YWx1ZTogdmFsdWUsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgd3JpdGFibGU6IHRydWUKICAgIH0pOwogIH0gZWxzZSB7CiAgICBvYmpba2V5XSA9IHZhbHVlOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKZnVuY3Rpb24gZ2V0RGVmYXVsdFN0ZXBDcmVhdGVTdGF0ZSgpIHsKICByZXR1cm4gewogICAgY3JlYXRlZDogZmFsc2UsCiAgICBzdGFydGVkOiBmYWxzZSwKICAgIGluZGV4UGF0dGVybklkOiB1bmRlZmluZWQKICB9Owp9Cgp2YXIgU3RlcENyZWF0ZUZvcm0gPSBfcmVhY3QuZGVmYXVsdC5tZW1vKGZ1bmN0aW9uIChfcmVmKSB7CiAgdmFyIGNyZWF0ZUluZGV4UGF0dGVybiA9IF9yZWYuY3JlYXRlSW5kZXhQYXR0ZXJuLAogICAgICB0cmFuc2Zvcm1Db25maWcgPSBfcmVmLnRyYW5zZm9ybUNvbmZpZywKICAgICAgdHJhbnNmb3JtSWQgPSBfcmVmLnRyYW5zZm9ybUlkLAogICAgICBvbkNoYW5nZSA9IF9yZWYub25DaGFuZ2UsCiAgICAgIG92ZXJyaWRlcyA9IF9yZWYub3ZlcnJpZGVzOwoKICB2YXIgZGVmYXVsdHMgPSBfb2JqZWN0U3ByZWFkKHt9LCBnZXREZWZhdWx0U3RlcENyZWF0ZVN0YXRlKCksIHt9LCBvdmVycmlkZXMpOwoKICB2YXIgX3VzZVN0YXRlID0gKDAsIF9yZWFjdC51c2VTdGF0ZSkoZmFsc2UpLAogICAgICBfdXNlU3RhdGUyID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlLCAyKSwKICAgICAgcmVkaXJlY3RUb1RyYW5zZm9ybU1hbmFnZW1lbnQgPSBfdXNlU3RhdGUyWzBdLAogICAgICBzZXRSZWRpcmVjdFRvVHJhbnNmb3JtTWFuYWdlbWVudCA9IF91c2VTdGF0ZTJbMV07CgogIHZhciBfdXNlU3RhdGUzID0gKDAsIF9yZWFjdC51c2VTdGF0ZSkoZGVmYXVsdHMuY3JlYXRlZCksCiAgICAgIF91c2VTdGF0ZTQgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUzLCAyKSwKICAgICAgY3JlYXRlZCA9IF91c2VTdGF0ZTRbMF0sCiAgICAgIHNldENyZWF0ZWQgPSBfdXNlU3RhdGU0WzFdOwoKICB2YXIgX3VzZVN0YXRlNSA9ICgwLCBfcmVhY3QudXNlU3RhdGUpKGRlZmF1bHRzLnN0YXJ0ZWQpLAogICAgICBfdXNlU3RhdGU2ID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlNSwgMiksCiAgICAgIHN0YXJ0ZWQgPSBfdXNlU3RhdGU2WzBdLAogICAgICBzZXRTdGFydGVkID0gX3VzZVN0YXRlNlsxXTsKCiAgdmFyIF91c2VTdGF0ZTcgPSAoMCwgX3JlYWN0LnVzZVN0YXRlKShkZWZhdWx0cy5pbmRleFBhdHRlcm5JZCksCiAgICAgIF91c2VTdGF0ZTggPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGU3LCAyKSwKICAgICAgaW5kZXhQYXR0ZXJuSWQgPSBfdXNlU3RhdGU4WzBdLAogICAgICBzZXRJbmRleFBhdHRlcm5JZCA9IF91c2VTdGF0ZThbMV07CgogIHZhciBfdXNlU3RhdGU5ID0gKDAsIF9yZWFjdC51c2VTdGF0ZSkodW5kZWZpbmVkKSwKICAgICAgX3VzZVN0YXRlMTAgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGU5LCAyKSwKICAgICAgcHJvZ3Jlc3NQZXJjZW50Q29tcGxldGUgPSBfdXNlU3RhdGUxMFswXSwKICAgICAgc2V0UHJvZ3Jlc3NQZXJjZW50Q29tcGxldGUgPSBfdXNlU3RhdGUxMFsxXTsKCiAgdmFyIGtpYmFuYUNvbnRleHQgPSAoMCwgX2tpYmFuYS51c2VLaWJhbmFDb250ZXh0KSgpOwogICgwLCBfcmVhY3QudXNlRWZmZWN0KShmdW5jdGlvbiAoKSB7CiAgICBvbkNoYW5nZSh7CiAgICAgIGNyZWF0ZWQ6IGNyZWF0ZWQsCiAgICAgIHN0YXJ0ZWQ6IHN0YXJ0ZWQsCiAgICAgIGluZGV4UGF0dGVybklkOiBpbmRleFBhdHRlcm5JZAogICAgfSk7IC8vIGN1c3RvbSBjb21wYXJpc29uCiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaG9va3MvZXhoYXVzdGl2ZS1kZXBzCiAgfSwgW2NyZWF0ZWQsIHN0YXJ0ZWQsIGluZGV4UGF0dGVybklkXSk7CiAgdmFyIGFwaSA9ICgwLCBfdXNlX2FwaS51c2VBcGkpKCk7CgogIGZ1bmN0aW9uIGNyZWF0ZVRyYW5zZm9ybSgpIHsKICAgIHZhciByZXNwOwogICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hc3luYyhmdW5jdGlvbiBjcmVhdGVUcmFuc2Zvcm0kKF9jb250ZXh0KSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBzZXRDcmVhdGVkKHRydWUpOwogICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMTsKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDQ7CiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAoYXBpLmNyZWF0ZVRyYW5zZm9ybSh0cmFuc2Zvcm1JZCwgdHJhbnNmb3JtQ29uZmlnKSk7CgogICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICByZXNwID0gX2NvbnRleHQuc2VudDsKCiAgICAgICAgICAgIGlmICghKHJlc3AuZXJyb3JzICE9PSB1bmRlZmluZWQgJiYgQXJyYXkuaXNBcnJheShyZXNwLmVycm9ycykpKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDEwOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoIShyZXNwLmVycm9ycy5sZW5ndGggPT09IDEpKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDg7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRocm93IHJlc3AuZXJyb3JzWzBdOwoKICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgaWYgKCEocmVzcC5lcnJvcnMubGVuZ3RoID4gMSkpIHsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTA7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRocm93IHJlc3AuZXJyb3JzOwoKICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgIF9ub3RpZnkudG9hc3ROb3RpZmljYXRpb25zLmFkZFN1Y2Nlc3MoX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLnRyYW5zZm9ybS5zdGVwQ3JlYXRlRm9ybS5jcmVhdGVUcmFuc2Zvcm1TdWNjZXNzTWVzc2FnZScsIHsKICAgICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1JlcXVlc3QgdG8gY3JlYXRlIHRyYW5zZm9ybSB7dHJhbnNmb3JtSWR9IGFja25vd2xlZGdlZC4nLAogICAgICAgICAgICAgIHZhbHVlczogewogICAgICAgICAgICAgICAgdHJhbnNmb3JtSWQ6IHRyYW5zZm9ybUlkCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KSk7CgogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTg7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAxMzsKICAgICAgICAgICAgX2NvbnRleHQudDAgPSBfY29udGV4dFsiY2F0Y2giXSgxKTsKICAgICAgICAgICAgc2V0Q3JlYXRlZChmYWxzZSk7CgogICAgICAgICAgICBfbm90aWZ5LnRvYXN0Tm90aWZpY2F0aW9ucy5hZGREYW5nZXIoewogICAgICAgICAgICAgIHRpdGxlOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2sudHJhbnNmb3JtLnN0ZXBDcmVhdGVGb3JtLmNyZWF0ZVRyYW5zZm9ybUVycm9yTWVzc2FnZScsIHsKICAgICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnQW4gZXJyb3Igb2NjdXJyZWQgY3JlYXRpbmcgdGhlIHRyYW5zZm9ybSB7dHJhbnNmb3JtSWR9OicsCiAgICAgICAgICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgICAgICAgICAgdHJhbnNmb3JtSWQ6IHRyYW5zZm9ybUlkCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgdGV4dDogKDAsIF9wdWJsaWMudG9Nb3VudFBvaW50KShfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9jb21wb25lbnRzLlRvYXN0Tm90aWZpY2F0aW9uVGV4dCwgewogICAgICAgICAgICAgICAgdGV4dDogX2NvbnRleHQudDAKICAgICAgICAgICAgICB9KSkKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBmYWxzZSk7CgogICAgICAgICAgY2FzZSAxODoKICAgICAgICAgICAgaWYgKGNyZWF0ZUluZGV4UGF0dGVybikgewogICAgICAgICAgICAgIGNyZWF0ZUtpYmFuYUluZGV4UGF0dGVybigpOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCB0cnVlKTsKCiAgICAgICAgICBjYXNlIDIwOgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIG51bGwsIG51bGwsIFtbMSwgMTNdXSk7CiAgfQoKICBmdW5jdGlvbiBzdGFydFRyYW5zZm9ybSgpIHsKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXN5bmMoZnVuY3Rpb24gc3RhcnRUcmFuc2Zvcm0kKF9jb250ZXh0MikgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBzZXRTdGFydGVkKHRydWUpOwogICAgICAgICAgICBfY29udGV4dDIucHJldiA9IDE7CiAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNDsKICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hd3JhcChhcGkuc3RhcnRUcmFuc2Zvcm1zKFt7CiAgICAgICAgICAgICAgaWQ6IHRyYW5zZm9ybUlkCiAgICAgICAgICAgIH1dKSk7CgogICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICBfbm90aWZ5LnRvYXN0Tm90aWZpY2F0aW9ucy5hZGRTdWNjZXNzKF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay50cmFuc2Zvcm0uc3RlcENyZWF0ZUZvcm0uc3RhcnRUcmFuc2Zvcm1TdWNjZXNzTWVzc2FnZScsIHsKICAgICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1JlcXVlc3QgdG8gc3RhcnQgdHJhbnNmb3JtIHt0cmFuc2Zvcm1JZH0gYWNrbm93bGVkZ2VkLicsCiAgICAgICAgICAgICAgdmFsdWVzOiB7CiAgICAgICAgICAgICAgICB0cmFuc2Zvcm1JZDogdHJhbnNmb3JtSWQKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTE7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgX2NvbnRleHQyLnByZXYgPSA3OwogICAgICAgICAgICBfY29udGV4dDIudDAgPSBfY29udGV4dDJbImNhdGNoIl0oMSk7CiAgICAgICAgICAgIHNldFN0YXJ0ZWQoZmFsc2UpOwoKICAgICAgICAgICAgX25vdGlmeS50b2FzdE5vdGlmaWNhdGlvbnMuYWRkRGFuZ2VyKHsKICAgICAgICAgICAgICB0aXRsZTogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLnRyYW5zZm9ybS5zdGVwQ3JlYXRlRm9ybS5zdGFydFRyYW5zZm9ybUVycm9yTWVzc2FnZScsIHsKICAgICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnQW4gZXJyb3Igb2NjdXJyZWQgc3RhcnRpbmcgdGhlIHRyYW5zZm9ybSB7dHJhbnNmb3JtSWR9OicsCiAgICAgICAgICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgICAgICAgICAgdHJhbnNmb3JtSWQ6IHRyYW5zZm9ybUlkCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgdGV4dDogKDAsIF9wdWJsaWMudG9Nb3VudFBvaW50KShfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9jb21wb25lbnRzLlRvYXN0Tm90aWZpY2F0aW9uVGV4dCwgewogICAgICAgICAgICAgICAgdGV4dDogX2NvbnRleHQyLnQwCiAgICAgICAgICAgICAgfSkpCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIG51bGwsIG51bGwsIFtbMSwgN11dKTsKICB9CgogIGZ1bmN0aW9uIGNyZWF0ZUFuZFN0YXJ0VHJhbnNmb3JtKCkgewogICAgdmFyIGFja25vd2xlZGdlZDsKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXN5bmMoZnVuY3Rpb24gY3JlYXRlQW5kU3RhcnRUcmFuc2Zvcm0kKF9jb250ZXh0MykgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDI7CiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAoY3JlYXRlVHJhbnNmb3JtKCkpOwoKICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgYWNrbm93bGVkZ2VkID0gX2NvbnRleHQzLnNlbnQ7CgogICAgICAgICAgICBpZiAoIWFja25vd2xlZGdlZCkgewogICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gNjsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA2OwogICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKHN0YXJ0VHJhbnNmb3JtKCkpOwoKICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSk7CiAgfQoKICB2YXIgY3JlYXRlS2liYW5hSW5kZXhQYXR0ZXJuID0gZnVuY3Rpb24gY3JlYXRlS2liYW5hSW5kZXhQYXR0ZXJuKCkgewogICAgdmFyIGluZGV4UGF0dGVybk5hbWUsIG5ld0luZGV4UGF0dGVybiwgaWQ7CiAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmFzeW5jKGZ1bmN0aW9uIGNyZWF0ZUtpYmFuYUluZGV4UGF0dGVybiQoX2NvbnRleHQ0KSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dDQucHJldiA9IF9jb250ZXh0NC5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIGluZGV4UGF0dGVybk5hbWUgPSB0cmFuc2Zvcm1Db25maWcuZGVzdC5pbmRleDsKICAgICAgICAgICAgX2NvbnRleHQ0LnByZXYgPSAxOwogICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDQ7CiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAoa2liYW5hQ29udGV4dC5pbmRleFBhdHRlcm5zLm1ha2UoKSk7CgogICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICBuZXdJbmRleFBhdHRlcm4gPSBfY29udGV4dDQuc2VudDsKICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihuZXdJbmRleFBhdHRlcm4sIHsKICAgICAgICAgICAgICBpZDogJycsCiAgICAgICAgICAgICAgdGl0bGU6IGluZGV4UGF0dGVybk5hbWUKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gODsKICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hd3JhcChuZXdJbmRleFBhdHRlcm4uY3JlYXRlKCkpOwoKICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgaWQgPSBfY29udGV4dDQuc2VudDsKCiAgICAgICAgICAgIGlmICghKGlkID09PSBmYWxzZSkpIHsKICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDEyOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBfbm90aWZ5LnRvYXN0Tm90aWZpY2F0aW9ucy5hZGREYW5nZXIoX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLnRyYW5zZm9ybS5zdGVwQ3JlYXRlRm9ybS5kdXBsaWNhdGVJbmRleFBhdHRlcm5FcnJvck1lc3NhZ2UnLCB7CiAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdBbiBlcnJvciBvY2N1cnJlZCBjcmVhdGluZyB0aGUgS2liYW5hIGluZGV4IHBhdHRlcm4ge2luZGV4UGF0dGVybk5hbWV9OiBUaGUgaW5kZXggcGF0dGVybiBhbHJlYWR5IGV4aXN0cy4nLAogICAgICAgICAgICAgIHZhbHVlczogewogICAgICAgICAgICAgICAgaW5kZXhQYXR0ZXJuTmFtZTogaW5kZXhQYXR0ZXJuTmFtZQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgIGlmIChraWJhbmFDb250ZXh0LmtpYmFuYUNvbmZpZy5nZXQoJ2RlZmF1bHRJbmRleCcpKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAxNTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAxNTsKICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hd3JhcChraWJhbmFDb250ZXh0LmtpYmFuYUNvbmZpZy5zZXQoJ2RlZmF1bHRJbmRleCcsIGlkKSk7CgogICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgX25vdGlmeS50b2FzdE5vdGlmaWNhdGlvbnMuYWRkU3VjY2VzcyhfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2sudHJhbnNmb3JtLnN0ZXBDcmVhdGVGb3JtLmNyZWF0ZUluZGV4UGF0dGVyblN1Y2Nlc3NNZXNzYWdlJywgewogICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnS2liYW5hIGluZGV4IHBhdHRlcm4ge2luZGV4UGF0dGVybk5hbWV9IGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5LicsCiAgICAgICAgICAgICAgdmFsdWVzOiB7CiAgICAgICAgICAgICAgICBpbmRleFBhdHRlcm5OYW1lOiBpbmRleFBhdHRlcm5OYW1lCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KSk7CgogICAgICAgICAgICBzZXRJbmRleFBhdHRlcm5JZChpZCk7CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KCJyZXR1cm4iLCB0cnVlKTsKCiAgICAgICAgICBjYXNlIDIwOgogICAgICAgICAgICBfY29udGV4dDQucHJldiA9IDIwOwogICAgICAgICAgICBfY29udGV4dDQudDAgPSBfY29udGV4dDRbImNhdGNoIl0oMSk7CgogICAgICAgICAgICBfbm90aWZ5LnRvYXN0Tm90aWZpY2F0aW9ucy5hZGREYW5nZXIoewogICAgICAgICAgICAgIHRpdGxlOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2sudHJhbnNmb3JtLnN0ZXBDcmVhdGVGb3JtLmNyZWF0ZUluZGV4UGF0dGVybkVycm9yTWVzc2FnZScsIHsKICAgICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnQW4gZXJyb3Igb2NjdXJyZWQgY3JlYXRpbmcgdGhlIEtpYmFuYSBpbmRleCBwYXR0ZXJuIHtpbmRleFBhdHRlcm5OYW1lfTonLAogICAgICAgICAgICAgICAgdmFsdWVzOiB7CiAgICAgICAgICAgICAgICAgIGluZGV4UGF0dGVybk5hbWU6IGluZGV4UGF0dGVybk5hbWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICB0ZXh0OiAoMCwgX3B1YmxpYy50b01vdW50UG9pbnQpKF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2NvbXBvbmVudHMuVG9hc3ROb3RpZmljYXRpb25UZXh0LCB7CiAgICAgICAgICAgICAgICB0ZXh0OiBfY29udGV4dDQudDAKICAgICAgICAgICAgICB9KSkKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LmFicnVwdCgicmV0dXJuIiwgZmFsc2UpOwoKICAgICAgICAgIGNhc2UgMjQ6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIG51bGwsIG51bGwsIFtbMSwgMjBdXSk7CiAgfTsKCiAgdmFyIGlzQmF0Y2hUcmFuc2Zvcm0gPSB0eXBlb2YgdHJhbnNmb3JtQ29uZmlnLnN5bmMgPT09ICd1bmRlZmluZWQnOwoKICBpZiAoc3RhcnRlZCA9PT0gdHJ1ZSAmJiBwcm9ncmVzc1BlcmNlbnRDb21wbGV0ZSA9PT0gdW5kZWZpbmVkICYmIGlzQmF0Y2hUcmFuc2Zvcm0pIHsKICAgIC8vIHdyYXBwaW5nIGluIGZ1bmN0aW9uIHNvIHdlIGNhbiBrZWVwIHRoZSBpbnRlcnZhbCBpZCBpbiBsb2NhbCBzY29wZQogICAgdmFyIHN0YXJ0UHJvZ3Jlc3NCYXIgPSBmdW5jdGlvbiBzdGFydFByb2dyZXNzQmFyKCkgewogICAgICB2YXIgaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHZhciBzdGF0cywgcGVyY2VudDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmFzeW5jKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0NSkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDUucHJldiA9IF9jb250ZXh0NS5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQ1LnByZXYgPSAwOwogICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hd3JhcChhcGkuZ2V0VHJhbnNmb3Jtc1N0YXRzKHRyYW5zZm9ybUlkKSk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIHN0YXRzID0gX2NvbnRleHQ1LnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKHN0YXRzICYmIEFycmF5LmlzQXJyYXkoc3RhdHMudHJhbnNmb3JtcykgJiYgc3RhdHMudHJhbnNmb3Jtcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgIHBlcmNlbnQgPSAoMCwgX2NvbW1vbi5nZXRUcmFuc2Zvcm1Qcm9ncmVzcykoewogICAgICAgICAgICAgICAgICAgIGlkOiB0cmFuc2Zvcm1Db25maWcuaWQsCiAgICAgICAgICAgICAgICAgICAgY29uZmlnOiB0cmFuc2Zvcm1Db25maWcsCiAgICAgICAgICAgICAgICAgICAgc3RhdHM6IHN0YXRzLnRyYW5zZm9ybXNbMF0KICAgICAgICAgICAgICAgICAgfSkgfHwgMDsKICAgICAgICAgICAgICAgICAgc2V0UHJvZ3Jlc3NQZXJjZW50Q29tcGxldGUocGVyY2VudCk7CgogICAgICAgICAgICAgICAgICBpZiAocGVyY2VudCA+PSAxMDApIHsKICAgICAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKGludGVydmFsKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gMTE7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgX2NvbnRleHQ1LnByZXYgPSA3OwogICAgICAgICAgICAgICAgX2NvbnRleHQ1LnQwID0gX2NvbnRleHQ1WyJjYXRjaCJdKDApOwoKICAgICAgICAgICAgICAgIF9ub3RpZnkudG9hc3ROb3RpZmljYXRpb25zLmFkZERhbmdlcih7CiAgICAgICAgICAgICAgICAgIHRpdGxlOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2sudHJhbnNmb3JtLnN0ZXBDcmVhdGVGb3JtLnByb2dyZXNzRXJyb3JNZXNzYWdlJywgewogICAgICAgICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnQW4gZXJyb3Igb2NjdXJyZWQgZ2V0dGluZyB0aGUgcHJvZ3Jlc3MgcGVyY2VudGFnZTonCiAgICAgICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgICAgICB0ZXh0OiAoMCwgX3B1YmxpYy50b01vdW50UG9pbnQpKF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2NvbXBvbmVudHMuVG9hc3ROb3RpZmljYXRpb25UZXh0LCB7CiAgICAgICAgICAgICAgICAgICAgdGV4dDogX2NvbnRleHQ1LnQwCiAgICAgICAgICAgICAgICAgIH0pKQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChpbnRlcnZhbCk7CgogICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgbnVsbCwgbnVsbCwgW1swLCA3XV0pOwogICAgICB9LCBfY29uc3RhbnRzLlBST0dSRVNTX1JFRlJFU0hfSU5URVJWQUxfTVMpOwogICAgICBzZXRQcm9ncmVzc1BlcmNlbnRDb21wbGV0ZSgwKTsKICAgIH07CgogICAgc3RhcnRQcm9ncmVzc0JhcigpOwogIH0KCiAgZnVuY3Rpb24gZ2V0VHJhbnNmb3JtQ29uZmlnRGV2Q29uc29sZVN0YXRlbWVudCgpIHsKICAgIHJldHVybiAiUFVUIF90cmFuc2Zvcm0vIi5jb25jYXQodHJhbnNmb3JtSWQsICJcbiIpLmNvbmNhdChKU09OLnN0cmluZ2lmeSh0cmFuc2Zvcm1Db25maWcsIG51bGwsIDIpLCAiXG5cbiIpOwogIH0gLy8gVE9ETyBtb3ZlIHRoaXMgdG8gU0FTUwoKCiAgdmFyIEZMRVhfR1JPVVBfU1RZTEUgPSB7CiAgICBoZWlnaHQ6ICc5MHB4JywKICAgIG1heFdpZHRoOiAnODAwcHgnCiAgfTsKICB2YXIgRkxFWF9JVEVNX1NUWUxFID0gewogICAgd2lkdGg6ICcyMDBweCcKICB9OwogIHZhciBQQU5FTF9JVEVNX1NUWUxFID0gewogICAgd2lkdGg6ICczMDBweCcKICB9OwoKICBpZiAocmVkaXJlY3RUb1RyYW5zZm9ybU1hbmFnZW1lbnQpIHsKICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9uYXZpZ2F0aW9uLlJlZGlyZWN0VG9UcmFuc2Zvcm1NYW5hZ2VtZW50LCBudWxsKTsKICB9CgogIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAiZGF0YS10ZXN0LXN1YmoiOiAidHJhbnNmb3JtU3RlcENyZWF0ZUZvcm0iCiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZvcm0sIG51bGwsICFjcmVhdGVkICYmIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4R3JvdXAsIHsKICAgIGFsaWduSXRlbXM6ICJjZW50ZXIiLAogICAgc3R5bGU6IEZMRVhfR1JPVVBfU1RZTEUKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgIGdyb3c6IGZhbHNlLAogICAgc3R5bGU6IEZMRVhfSVRFTV9TVFlMRQogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlCdXR0b24sIHsKICAgIGZpbGw6IHRydWUsCiAgICBpc0Rpc2FibGVkOiBjcmVhdGVkICYmIHN0YXJ0ZWQsCiAgICBvbkNsaWNrOiBjcmVhdGVBbmRTdGFydFRyYW5zZm9ybSwKICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJ0cmFuc2Zvcm1XaXphcmRDcmVhdGVBbmRTdGFydEJ1dHRvbiIKICB9LCBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2sudHJhbnNmb3JtLnN0ZXBDcmVhdGVGb3JtLmNyZWF0ZUFuZFN0YXJ0VHJhbnNmb3JtQnV0dG9uJywgewogICAgZGVmYXVsdE1lc3NhZ2U6ICdDcmVhdGUgYW5kIHN0YXJ0JwogIH0pKSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRleHQsIHsKICAgIGNvbG9yOiAic3ViZHVlZCIsCiAgICBzaXplOiAicyIKICB9LCBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2sudHJhbnNmb3JtLnN0ZXBDcmVhdGVGb3JtLmNyZWF0ZUFuZFN0YXJ0VHJhbnNmb3JtRGVzY3JpcHRpb24nLCB7CiAgICBkZWZhdWx0TWVzc2FnZTogJ0NyZWF0ZXMgYW5kIHN0YXJ0cyB0aGUgdHJhbnNmb3JtLiBBIHRyYW5zZm9ybSB3aWxsIGluY3JlYXNlIHNlYXJjaCBhbmQgaW5kZXhpbmcgbG9hZCBpbiB5b3VyIGNsdXN0ZXIuIFBsZWFzZSBzdG9wIHRoZSB0cmFuc2Zvcm0gaWYgZXhjZXNzaXZlIGxvYWQgaXMgZXhwZXJpZW5jZWQuIEFmdGVyIHRoZSB0cmFuc2Zvcm0gaXMgc3RhcnRlZCwgeW91IHdpbGwgYmUgb2ZmZXJlZCBvcHRpb25zIHRvIGNvbnRpbnVlIGV4cGxvcmluZyB0aGUgdHJhbnNmb3JtLicKICB9KSkpKSwgY3JlYXRlZCAmJiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEdyb3VwLCB7CiAgICBhbGlnbkl0ZW1zOiAiY2VudGVyIiwKICAgIHN0eWxlOiBGTEVYX0dST1VQX1NUWUxFCiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICBncm93OiBmYWxzZSwKICAgIHN0eWxlOiBGTEVYX0lURU1fU1RZTEUKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQnV0dG9uLCB7CiAgICBmaWxsOiB0cnVlLAogICAgaXNEaXNhYmxlZDogY3JlYXRlZCAmJiBzdGFydGVkLAogICAgb25DbGljazogc3RhcnRUcmFuc2Zvcm0sCiAgICAiZGF0YS10ZXN0LXN1YmoiOiAidHJhbnNmb3JtV2l6YXJkU3RhcnRCdXR0b24iCiAgfSwgX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLnRyYW5zZm9ybS5zdGVwQ3JlYXRlRm9ybS5zdGFydFRyYW5zZm9ybUJ1dHRvbicsIHsKICAgIGRlZmF1bHRNZXNzYWdlOiAnU3RhcnQnCiAgfSkpKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVGV4dCwgewogICAgY29sb3I6ICJzdWJkdWVkIiwKICAgIHNpemU6ICJzIgogIH0sIF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay50cmFuc2Zvcm0uc3RlcENyZWF0ZUZvcm0uc3RhcnRUcmFuc2Zvcm1EZXNjcmlwdGlvbicsIHsKICAgIGRlZmF1bHRNZXNzYWdlOiAnU3RhcnRzIHRoZSB0cmFuc2Zvcm0uIEEgdHJhbnNmb3JtIHdpbGwgaW5jcmVhc2Ugc2VhcmNoIGFuZCBpbmRleGluZyBsb2FkIGluIHlvdXIgY2x1c3Rlci4gUGxlYXNlIHN0b3AgdGhlIHRyYW5zZm9ybSBpZiBleGNlc3NpdmUgbG9hZCBpcyBleHBlcmllbmNlZC4gQWZ0ZXIgdGhlIHRyYW5zZm9ybSBpcyBzdGFydGVkLCB5b3Ugd2lsbCBiZSBvZmZlcmVkIG9wdGlvbnMgdG8gY29udGludWUgZXhwbG9yaW5nIHRoZSB0cmFuc2Zvcm0uJwogIH0pKSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEdyb3VwLCB7CiAgICBhbGlnbkl0ZW1zOiAiY2VudGVyIiwKICAgIHN0eWxlOiBGTEVYX0dST1VQX1NUWUxFCiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICBncm93OiBmYWxzZSwKICAgIHN0eWxlOiBGTEVYX0lURU1fU1RZTEUKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQnV0dG9uLCB7CiAgICBpc0Rpc2FibGVkOiBjcmVhdGVkLAogICAgb25DbGljazogY3JlYXRlVHJhbnNmb3JtLAogICAgImRhdGEtdGVzdC1zdWJqIjogInRyYW5zZm9ybVdpemFyZENyZWF0ZUJ1dHRvbiIKICB9LCBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2sudHJhbnNmb3JtLnN0ZXBDcmVhdGVGb3JtLmNyZWF0ZVRyYW5zZm9ybUJ1dHRvbicsIHsKICAgIGRlZmF1bHRNZXNzYWdlOiAnQ3JlYXRlJwogIH0pKSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRleHQsIHsKICAgIGNvbG9yOiAic3ViZHVlZCIsCiAgICBzaXplOiAicyIKICB9LCBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2sudHJhbnNmb3JtLnN0ZXBDcmVhdGVGb3JtLmNyZWF0ZVRyYW5zZm9ybURlc2NyaXB0aW9uJywgewogICAgZGVmYXVsdE1lc3NhZ2U6ICdDcmVhdGUgdGhlIHRyYW5zZm9ybSB3aXRob3V0IHN0YXJ0aW5nIGl0LiBZb3Ugd2lsbCBiZSBhYmxlIHRvIHN0YXJ0IHRoZSB0cmFuc2Zvcm0gbGF0ZXIgYnkgcmV0dXJuaW5nIHRvIHRoZSB0cmFuc2Zvcm1zIGxpc3QuJwogIH0pKSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEdyb3VwLCB7CiAgICBhbGlnbkl0ZW1zOiAiY2VudGVyIiwKICAgIHN0eWxlOiBGTEVYX0dST1VQX1NUWUxFCiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICBncm93OiBmYWxzZSwKICAgIHN0eWxlOiBGTEVYX0lURU1fU1RZTEUKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQ29weSwgewogICAgdGV4dFRvQ29weTogZ2V0VHJhbnNmb3JtQ29uZmlnRGV2Q29uc29sZVN0YXRlbWVudCgpCiAgfSwgZnVuY3Rpb24gKGNvcHkpIHsKICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQnV0dG9uLCB7CiAgICAgIG9uQ2xpY2s6IGNvcHksCiAgICAgIHN0eWxlOiB7CiAgICAgICAgd2lkdGg6ICcxMDAlJwogICAgICB9LAogICAgICAiZGF0YS10ZXN0LXN1YmoiOiAidHJhbnNmb3JtV2l6YXJkQ29weVRvQ2xpcGJvYXJkQnV0dG9uIgogICAgfSwgX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLnRyYW5zZm9ybS5zdGVwQ3JlYXRlRm9ybS5jb3B5VHJhbnNmb3JtQ29uZmlnVG9DbGlwYm9hcmRCdXR0b24nLCB7CiAgICAgIGRlZmF1bHRNZXNzYWdlOiAnQ29weSB0byBjbGlwYm9hcmQnCiAgICB9KSk7CiAgfSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUZXh0LCB7CiAgICBjb2xvcjogInN1YmR1ZWQiLAogICAgc2l6ZTogInMiCiAgfSwgX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLnRyYW5zZm9ybS5zdGVwQ3JlYXRlRm9ybS5jb3B5VHJhbnNmb3JtQ29uZmlnVG9DbGlwYm9hcmREZXNjcmlwdGlvbicsIHsKICAgIGRlZmF1bHRNZXNzYWdlOiAnQ29waWVzIHRvIHRoZSBjbGlwYm9hcmQgdGhlIEtpYmFuYSBEZXYgQ29uc29sZSBjb21tYW5kIGZvciBjcmVhdGluZyB0aGUgdHJhbnNmb3JtLicKICB9KSkpKSwgcHJvZ3Jlc3NQZXJjZW50Q29tcGxldGUgIT09IHVuZGVmaW5lZCAmJiBpc0JhdGNoVHJhbnNmb3JtICYmIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LkZyYWdtZW50LCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3BhY2VyLCB7CiAgICBzaXplOiAibSIKICB9KSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRleHQsIHsKICAgIHNpemU6ICJ4cyIKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJzdHJvbmciLCBudWxsLCBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2sudHJhbnNmb3JtLnN0ZXBDcmVhdGVGb3JtLnByb2dyZXNzVGl0bGUnLCB7CiAgICBkZWZhdWx0TWVzc2FnZTogJ1Byb2dyZXNzJwogIH0pKSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4R3JvdXAsIHsKICAgIGd1dHRlclNpemU6ICJ4cyIKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgIHN0eWxlOiB7CiAgICAgIHdpZHRoOiAnNDAwcHgnCiAgICB9LAogICAgZ3JvdzogZmFsc2UKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpUHJvZ3Jlc3MsIHsKICAgIHNpemU6ICJsIiwKICAgIGNvbG9yOiAicHJpbWFyeSIsCiAgICB2YWx1ZTogcHJvZ3Jlc3NQZXJjZW50Q29tcGxldGUsCiAgICBtYXg6IDEwMCwKICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJ0cmFuc2Zvcm1XaXphcmRQcm9ncmVzc0JhciIKICB9KSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRleHQsIHsKICAgIHNpemU6ICJ4cyIKICB9LCBwcm9ncmVzc1BlcmNlbnRDb21wbGV0ZSwgIiUiKSkpKSwgY3JlYXRlZCAmJiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5GcmFnbWVudCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUhvcml6b250YWxSdWxlLCBudWxsKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhHcmlkLCB7CiAgICBndXR0ZXJTaXplOiAibCIKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgIHN0eWxlOiBQQU5FTF9JVEVNX1NUWUxFCiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUNhcmQsIHsKICAgIGljb246IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlJY29uLCB7CiAgICAgIHNpemU6ICJ4eGwiLAogICAgICB0eXBlOiAibGlzdCIKICAgIH0pLAogICAgdGl0bGU6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay50cmFuc2Zvcm0uc3RlcENyZWF0ZUZvcm0udHJhbnNmb3JtTGlzdENhcmRUaXRsZScsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdUcmFuc2Zvcm1zJwogICAgfSksCiAgICBkZXNjcmlwdGlvbjogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLnRyYW5zZm9ybS5zdGVwQ3JlYXRlRm9ybS50cmFuc2Zvcm1MaXN0Q2FyZERlc2NyaXB0aW9uJywgewogICAgICBkZWZhdWx0TWVzc2FnZTogJ1JldHVybiB0byB0aGUgdHJhbnNmb3JtIG1hbmFnZW1lbnQgcGFnZS4nCiAgICB9KSwKICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7CiAgICAgIHJldHVybiBzZXRSZWRpcmVjdFRvVHJhbnNmb3JtTWFuYWdlbWVudCh0cnVlKTsKICAgIH0sCiAgICAiZGF0YS10ZXN0LXN1YmoiOiAidHJhbnNmb3JtV2l6YXJkQ2FyZE1hbmFnZW1lbnQiCiAgfSkpLCBzdGFydGVkID09PSB0cnVlICYmIGNyZWF0ZUluZGV4UGF0dGVybiA9PT0gdHJ1ZSAmJiBpbmRleFBhdHRlcm5JZCA9PT0gdW5kZWZpbmVkICYmIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgc3R5bGU6IFBBTkVMX0lURU1fU1RZTEUKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpUGFuZWwsIHsKICAgIHN0eWxlOiB7CiAgICAgIHBvc2l0aW9uOiAncmVsYXRpdmUnCiAgICB9CiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVByb2dyZXNzLCB7CiAgICBzaXplOiAieHMiLAogICAgY29sb3I6ICJwcmltYXJ5IiwKICAgIHBvc2l0aW9uOiAiYWJzb2x1dGUiCiAgfSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUZXh0LCB7CiAgICBjb2xvcjogInN1YmR1ZWQiLAogICAgc2l6ZTogInMiCiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgicCIsIG51bGwsIF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay50cmFuc2Zvcm0uc3RlcENyZWF0ZUZvcm0uY3JlYXRpbmdJbmRleFBhdHRlcm5NZXNzYWdlJywgewogICAgZGVmYXVsdE1lc3NhZ2U6ICdDcmVhdGluZyBLaWJhbmEgaW5kZXggcGF0dGVybiAuLi4nCiAgfSkpKSkpLCBzdGFydGVkID09PSB0cnVlICYmIGluZGV4UGF0dGVybklkICE9PSB1bmRlZmluZWQgJiYgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICBzdHlsZTogUEFORUxfSVRFTV9TVFlMRQogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlDYXJkLCB7CiAgICBpY29uOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpSWNvbiwgewogICAgICBzaXplOiAieHhsIiwKICAgICAgdHlwZTogImRpc2NvdmVyQXBwIgogICAgfSksCiAgICB0aXRsZTogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLnRyYW5zZm9ybS5zdGVwQ3JlYXRlRm9ybS5kaXNjb3ZlckNhcmRUaXRsZScsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdEaXNjb3ZlcicKICAgIH0pLAogICAgZGVzY3JpcHRpb246IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay50cmFuc2Zvcm0uc3RlcENyZWF0ZUZvcm0uZGlzY292ZXJDYXJkRGVzY3JpcHRpb24nLCB7CiAgICAgIGRlZmF1bHRNZXNzYWdlOiAnVXNlIERpc2NvdmVyIHRvIGV4cGxvcmUgdGhlIHRyYW5zZm9ybS4nCiAgICB9KSwKICAgIGhyZWY6ICgwLCBfY29tbW9uLmdldERpc2NvdmVyVXJsKShpbmRleFBhdHRlcm5JZCwga2liYW5hQ29udGV4dC5rYm5CYXNlVXJsKSwKICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJ0cmFuc2Zvcm1XaXphcmRDYXJkRGlzY292ZXIiCiAgfSkpKSkpKTsKfSk7CgpleHBvcnRzLlN0ZXBDcmVhdGVGb3JtID0gU3RlcENyZWF0ZUZvcm07"},null]}