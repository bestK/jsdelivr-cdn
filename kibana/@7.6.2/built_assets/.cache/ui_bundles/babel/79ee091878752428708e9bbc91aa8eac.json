{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/legacy/core_plugins/kibana/public/home/np_ready/components/tutorial/tutorial.js","dependencies":[{"path":"src/legacy/core_plugins/kibana/public/home/np_ready/components/tutorial/tutorial.js","mtime":1585205039576},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLlR1dG9yaWFsID0gdm9pZCAwOwoKdmFyIF9sb2Rhc2ggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoImxvZGFzaCIpKTsKCnZhciBfcmVhY3QgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoInJlYWN0IikpOwoKdmFyIF9wcm9wVHlwZXMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoInByb3AtdHlwZXMiKSk7Cgp2YXIgX2Zvb3RlciA9IHJlcXVpcmUoIi4vZm9vdGVyIik7Cgp2YXIgX2ludHJvZHVjdGlvbiA9IHJlcXVpcmUoIi4vaW50cm9kdWN0aW9uIik7Cgp2YXIgX2luc3RydWN0aW9uX3NldCA9IHJlcXVpcmUoIi4vaW5zdHJ1Y3Rpb25fc2V0Iik7Cgp2YXIgX3NhdmVkX29iamVjdHNfaW5zdGFsbGVyID0gcmVxdWlyZSgiLi9zYXZlZF9vYmplY3RzX2luc3RhbGxlciIpOwoKdmFyIF9ldWkgPSByZXF1aXJlKCJAZWxhc3RpYy9ldWkiKTsKCnZhciBTdGF0dXNDaGVja1N0YXRlcyA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoIi4vc3RhdHVzX2NoZWNrX3N0YXRlcyIpKTsKCnZhciBfcmVhY3QyID0gcmVxdWlyZSgiQGtibi9pMThuL3JlYWN0Iik7Cgp2YXIgX2kxOG4gPSByZXF1aXJlKCJAa2JuL2kxOG4iKTsKCnZhciBfa2liYW5hX3NlcnZpY2VzID0gcmVxdWlyZSgiLi4vLi4vLi4va2liYW5hX3NlcnZpY2VzIik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGVsc2UgeyB2YXIgbmV3T2JqID0ge307IGlmIChvYmogIT0gbnVsbCkgeyBmb3IgKHZhciBrZXkgaW4gb2JqKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7IHZhciBkZXNjID0gT2JqZWN0LmRlZmluZVByb3BlcnR5ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KSA6IHt9OyBpZiAoZGVzYy5nZXQgfHwgZGVzYy5zZXQpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5ld09iaiwga2V5LCBkZXNjKTsgfSBlbHNlIHsgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IH0gfSBuZXdPYmouZGVmYXVsdCA9IG9iajsgcmV0dXJuIG5ld09iajsgfSB9CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gInN5bWJvbCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9CgpmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOyBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgeyB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsgaWYgKGVudW1lcmFibGVPbmx5KSBzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgeyByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsgfSk7IGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsgfSByZXR1cm4ga2V5czsgfQoKZnVuY3Rpb24gX29iamVjdFNwcmVhZCh0YXJnZXQpIHsgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXSAhPSBudWxsID8gYXJndW1lbnRzW2ldIDoge307IGlmIChpICUgMikgeyBvd25LZXlzKHNvdXJjZSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOyB9KTsgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgeyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpOyB9IGVsc2UgeyBvd25LZXlzKHNvdXJjZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOyB9KTsgfSB9IHJldHVybiB0YXJnZXQ7IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0KCmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9CgpmdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmIChjYWxsICYmIChfdHlwZW9mKGNhbGwpID09PSAib2JqZWN0IiB8fCB0eXBlb2YgY2FsbCA9PT0gImZ1bmN0aW9uIikpIHsgcmV0dXJuIGNhbGw7IH0gcmV0dXJuIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZik7IH0KCmZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IF9nZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IHJldHVybiBvLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2Yobyk7IH07IHJldHVybiBfZ2V0UHJvdG90eXBlT2Yobyk7IH0KCmZ1bmN0aW9uIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZikgeyBpZiAoc2VsZiA9PT0gdm9pZCAwKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcigidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkIik7IH0gcmV0dXJuIHNlbGY7IH0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICJmdW5jdGlvbiIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiIpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcyk7IH0KCmZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IF9zZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBvLl9fcHJvdG9fXyA9IHA7IHJldHVybiBvOyB9OyByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApOyB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7IGlmIChrZXkgaW4gb2JqKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgeyB2YWx1ZTogdmFsdWUsIGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUgfSk7IH0gZWxzZSB7IG9ialtrZXldID0gdmFsdWU7IH0gcmV0dXJuIG9iajsgfQoKdmFyIElOU1RSVUNUSU9OU19UWVBFID0gewogIEVMQVNUSUNfQ0xPVUQ6ICdlbGFzdGljQ2xvdWQnLAogIE9OX1BSRU06ICdvblByZW0nLAogIE9OX1BSRU1fRUxBU1RJQ19DTE9VRDogJ29uUHJlbUVsYXN0aWNDbG91ZCcKfTsKCnZhciBob21lVGl0bGUgPSBfaTE4bi5pMThuLnRyYW5zbGF0ZSgna2JuLmhvbWUuYnJlYWRjcnVtYnMuaG9tZVRpdGxlJywgewogIGRlZmF1bHRNZXNzYWdlOiAnSG9tZScKfSk7Cgp2YXIgYWRkRGF0YVRpdGxlID0gX2kxOG4uaTE4bi50cmFuc2xhdGUoJ2tibi5ob21lLmJyZWFkY3J1bWJzLmFkZERhdGFUaXRsZScsIHsKICBkZWZhdWx0TWVzc2FnZTogJ0FkZCBkYXRhJwp9KTsKCnZhciBUdXRvcmlhbFVpID0KLyojX19QVVJFX18qLwpmdW5jdGlvbiAoX1JlYWN0JENvbXBvbmVudCkgewogIF9pbmhlcml0cyhUdXRvcmlhbFVpLCBfUmVhY3QkQ29tcG9uZW50KTsKCiAgZnVuY3Rpb24gVHV0b3JpYWxVaShwcm9wcykgewogICAgdmFyIF90aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBUdXRvcmlhbFVpKTsKCiAgICBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIF9nZXRQcm90b3R5cGVPZihUdXRvcmlhbFVpKS5jYWxsKHRoaXMsIHByb3BzKSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiZ2V0SW5zdHJ1Y3Rpb25zIiwgZnVuY3Rpb24gKCkgewogICAgICBpZiAoIV90aGlzLnN0YXRlLnR1dG9yaWFsKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIGluc3RydWN0aW9uU2V0czogW10KICAgICAgICB9OwogICAgICB9CgogICAgICBzd2l0Y2ggKF90aGlzLnN0YXRlLnZpc2libGVJbnN0cnVjdGlvbnMpIHsKICAgICAgICBjYXNlIElOU1RSVUNUSU9OU19UWVBFLkVMQVNUSUNfQ0xPVUQ6CiAgICAgICAgICByZXR1cm4gX3RoaXMuc3RhdGUudHV0b3JpYWwuZWxhc3RpY0Nsb3VkOwoKICAgICAgICBjYXNlIElOU1RSVUNUSU9OU19UWVBFLk9OX1BSRU06CiAgICAgICAgICByZXR1cm4gX3RoaXMuc3RhdGUudHV0b3JpYWwub25QcmVtOwoKICAgICAgICBjYXNlIElOU1RSVUNUSU9OU19UWVBFLk9OX1BSRU1fRUxBU1RJQ19DTE9VRDoKICAgICAgICAgIHJldHVybiBfdGhpcy5zdGF0ZS50dXRvcmlhbC5vblByZW1FbGFzdGljQ2xvdWQ7CgogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoX3RoaXMucHJvcHMuaW50bC5mb3JtYXRNZXNzYWdlKHsKICAgICAgICAgICAgaWQ6ICdrYm4uaG9tZS50dXRvcmlhbC51bmhhbmRsZWRJbnN0cnVjdGlvblR5cGVFcnJvckRlc2NyaXB0aW9uJywKICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdVbmhhbmRsZWQgaW5zdHJ1Y3Rpb24gdHlwZSB7dmlzaWJsZUluc3RydWN0aW9uc30nCiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIHZpc2libGVJbnN0cnVjdGlvbnM6IF90aGlzLnN0YXRlLnZpc2libGVJbnN0cnVjdGlvbnMKICAgICAgICAgIH0pKTsKICAgICAgfQogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiZ2V0SW5zdHJ1Y3Rpb25TZXRzIiwgZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gX3RoaXMuZ2V0SW5zdHJ1Y3Rpb25zKCkuaW5zdHJ1Y3Rpb25TZXRzOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiaW5pdEluc3RydWN0aW9uc1N0YXRlIiwgZnVuY3Rpb24gKCkgewogICAgICB2YXIgaW5zdHJ1Y3Rpb25zID0gX3RoaXMuZ2V0SW5zdHJ1Y3Rpb25zKCk7CgogICAgICB2YXIgcGFyYW1WYWx1ZXMgPSB7fTsKCiAgICAgIGlmIChpbnN0cnVjdGlvbnMucGFyYW1zKSB7CiAgICAgICAgaW5zdHJ1Y3Rpb25zLnBhcmFtcy5mb3JFYWNoKGZ1bmN0aW9uIChwYXJhbSkgewogICAgICAgICAgcGFyYW1WYWx1ZXNbcGFyYW0uaWRdID0gcGFyYW0uZGVmYXVsdFZhbHVlOwogICAgICAgIH0pOwogICAgICB9CgogICAgICB2YXIgc3RhdHVzQ2hlY2tTdGF0ZXMgPSBuZXcgQXJyYXkoaW5zdHJ1Y3Rpb25zLmluc3RydWN0aW9uU2V0cy5sZW5ndGgpLmZpbGwoU3RhdHVzQ2hlY2tTdGF0ZXMuTk9UX0NIRUNLRUQpOwoKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIHBhcmFtVmFsdWVzOiBwYXJhbVZhbHVlcywKICAgICAgICBzdGF0dXNDaGVja1N0YXRlczogc3RhdHVzQ2hlY2tTdGF0ZXMKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJzZXRWaXNpYmxlSW5zdHJ1Y3Rpb25zIiwgZnVuY3Rpb24gKGluc3RydWN0aW9uc1R5cGUpIHsKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIHZpc2libGVJbnN0cnVjdGlvbnM6IGluc3RydWN0aW9uc1R5cGUKICAgICAgfSwgX3RoaXMuaW5pdEluc3RydWN0aW9uc1N0YXRlKTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInNldFBhcmFtZXRlciIsIGZ1bmN0aW9uIChwYXJhbUlkLCBuZXdWYWx1ZSkgewogICAgICBfdGhpcy5zZXRTdGF0ZShmdW5jdGlvbiAocHJldmlvdXNTdGF0ZSkgewogICAgICAgIHZhciBwYXJhbVZhbHVlcyA9IF9sb2Rhc2guZGVmYXVsdC5jbG9uZURlZXAocHJldmlvdXNTdGF0ZS5wYXJhbVZhbHVlcyk7CgogICAgICAgIHBhcmFtVmFsdWVzW3BhcmFtSWRdID0gbmV3VmFsdWU7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIHBhcmFtVmFsdWVzOiBwYXJhbVZhbHVlcwogICAgICAgIH07CiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiY2hlY2tJbnN0cnVjdGlvblNldFN0YXR1cyIsIGZ1bmN0aW9uIF9jYWxsZWUoaW5zdHJ1Y3Rpb25TZXRJbmRleCkgewogICAgICB2YXIgaW5zdHJ1Y3Rpb25TZXQsIGVzSGl0c0NoZWNrQ29uZmlnLCBzdGF0dXNDaGVja1N0YXRlOwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmFzeW5jKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGluc3RydWN0aW9uU2V0ID0gX3RoaXMuZ2V0SW5zdHJ1Y3Rpb25TZXRzKClbaW5zdHJ1Y3Rpb25TZXRJbmRleF07CiAgICAgICAgICAgICAgZXNIaXRzQ2hlY2tDb25maWcgPSBfbG9kYXNoLmRlZmF1bHQuZ2V0KGluc3RydWN0aW9uU2V0LCAic3RhdHVzQ2hlY2suZXNIaXRzQ2hlY2siKTsKCiAgICAgICAgICAgICAgaWYgKCFlc0hpdHNDaGVja0NvbmZpZykgewogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDc7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA1OwogICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAoX3RoaXMuZmV0Y2hFc0hpdHNTdGF0dXMoZXNIaXRzQ2hlY2tDb25maWcpKTsKCiAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICBzdGF0dXNDaGVja1N0YXRlID0gX2NvbnRleHQuc2VudDsKCiAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoZnVuY3Rpb24gKHByZXZTdGF0ZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgc3RhdHVzQ2hlY2tTdGF0ZXM6IF9vYmplY3RTcHJlYWQoe30sIHByZXZTdGF0ZS5zdGF0dXNDaGVja1N0YXRlcywgX2RlZmluZVByb3BlcnR5KHt9LCBpbnN0cnVjdGlvblNldEluZGV4LCBzdGF0dXNDaGVja1N0YXRlKSkKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiZmV0Y2hFc0hpdHNTdGF0dXMiLCBmdW5jdGlvbiBfY2FsbGVlMihlc0hpdHNDaGVja0NvbmZpZykgewogICAgICB2YXIgc2VhcmNoSGVhZGVyLCBzZWFyY2hCb2R5LCByZXNwb25zZSwgcmVzdWx0cywgbnVtSGl0czsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hc3luYyhmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgc2VhcmNoSGVhZGVyID0gSlNPTi5zdHJpbmdpZnkoewogICAgICAgICAgICAgICAgaW5kZXg6IGVzSGl0c0NoZWNrQ29uZmlnLmluZGV4CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgc2VhcmNoQm9keSA9IEpTT04uc3RyaW5naWZ5KHsKICAgICAgICAgICAgICAgIHF1ZXJ5OiBlc0hpdHNDaGVja0NvbmZpZy5xdWVyeSwKICAgICAgICAgICAgICAgIHNpemU6IDEKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDQ7CiAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hd3JhcChmZXRjaChfdGhpcy5wcm9wcy5hZGRCYXNlUGF0aCgnL2VsYXN0aWNzZWFyY2gvX21zZWFyY2gnKSwgewogICAgICAgICAgICAgICAgbWV0aG9kOiAncG9zdCcsCiAgICAgICAgICAgICAgICBib2R5OiAiIi5jb25jYXQoc2VhcmNoSGVhZGVyLCAiXG4iKS5jb25jYXQoc2VhcmNoQm9keSwgIlxuIiksCiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgIGFjY2VwdDogJ2FwcGxpY2F0aW9uL2pzb24nLAogICAgICAgICAgICAgICAgICAnY29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL3gtbmRqc29uJywKICAgICAgICAgICAgICAgICAgJ2tibi14c3JmJzogJ2tpYmFuYScKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBjcmVkZW50aWFsczogJ3NhbWUtb3JpZ2luJwogICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICByZXNwb25zZSA9IF9jb250ZXh0Mi5zZW50OwoKICAgICAgICAgICAgICBpZiAoIShyZXNwb25zZS5zdGF0dXMgPiAzMDApKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDc7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iLCBTdGF0dXNDaGVja1N0YXRlcy5FUlJPUik7CgogICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA5OwogICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAocmVzcG9uc2UuanNvbigpKTsKCiAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICByZXN1bHRzID0gX2NvbnRleHQyLnNlbnQ7CiAgICAgICAgICAgICAgbnVtSGl0cyA9IF9sb2Rhc2guZGVmYXVsdC5nZXQocmVzdWx0cywgJ3Jlc3BvbnNlcy5bMF0uaGl0cy5oaXRzLmxlbmd0aCcsIDApOwogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iLCBudW1IaXRzID09PSAwID8gU3RhdHVzQ2hlY2tTdGF0ZXMuTk9fREFUQSA6IFN0YXR1c0NoZWNrU3RhdGVzLkhBU19EQVRBKTsKCiAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInJlbmRlckluc3RydWN0aW9uU2V0c1RvZ2dsZSIsIGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKCFfdGhpcy5wcm9wcy5pc0Nsb3VkRW5hYmxlZCAmJiBfdGhpcy5zdGF0ZS50dXRvcmlhbC5vblByZW1FbGFzdGljQ2xvdWQpIHsKICAgICAgICB2YXIgc2VsZk1hbmFnZWRMYWJlbCA9IF90aGlzLnByb3BzLmludGwuZm9ybWF0TWVzc2FnZSh7CiAgICAgICAgICBpZDogJ2tibi5ob21lLnR1dG9yaWFsLnNlbGZNYW5hZ2VkQnV0dG9uTGFiZWwnLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdTZWxmIG1hbmFnZWQnCiAgICAgICAgfSk7CgogICAgICAgIHZhciBjbG91ZExhYmVsID0gX3RoaXMucHJvcHMuaW50bC5mb3JtYXRNZXNzYWdlKHsKICAgICAgICAgIGlkOiAna2JuLmhvbWUudHV0b3JpYWwuZWxhc3RpY0Nsb3VkQnV0dG9uTGFiZWwnLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdFbGFzdGljIENsb3VkJwogICAgICAgIH0pOwoKICAgICAgICB2YXIgcmFkaW9CdXR0b25zID0gW3sKICAgICAgICAgIGlkOiBJTlNUUlVDVElPTlNfVFlQRS5PTl9QUkVNLAogICAgICAgICAgbGFiZWw6IHNlbGZNYW5hZ2VkTGFiZWwKICAgICAgICB9LCB7CiAgICAgICAgICBpZDogSU5TVFJVQ1RJT05TX1RZUEUuT05fUFJFTV9FTEFTVElDX0NMT1VELAogICAgICAgICAgbGFiZWw6IGNsb3VkTGFiZWwKICAgICAgICB9XTsKICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhHcm91cCwgewogICAgICAgICAganVzdGlmeUNvbnRlbnQ6ICJjZW50ZXIiCiAgICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICAgICAgICBncm93OiBmYWxzZQogICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlCdXR0b25Hcm91cCwgewogICAgICAgICAgb3B0aW9uczogcmFkaW9CdXR0b25zLAogICAgICAgICAgaWRTZWxlY3RlZDogX3RoaXMuc3RhdGUudmlzaWJsZUluc3RydWN0aW9ucywKICAgICAgICAgIG9uQ2hhbmdlOiBfdGhpcy5zZXRWaXNpYmxlSW5zdHJ1Y3Rpb25zLAogICAgICAgICAgY29sb3I6ICJwcmltYXJ5IgogICAgICAgIH0pKSk7CiAgICAgIH0KICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIm9uU3RhdHVzQ2hlY2siLCBmdW5jdGlvbiAoaW5zdHJ1Y3Rpb25TZXRJbmRleCkgewogICAgICBfdGhpcy5zZXRTdGF0ZShmdW5jdGlvbiAocHJldlN0YXRlKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIHN0YXR1c0NoZWNrU3RhdGVzOiBfb2JqZWN0U3ByZWFkKHt9LCBwcmV2U3RhdGUuc3RhdHVzQ2hlY2tTdGF0ZXMsIF9kZWZpbmVQcm9wZXJ0eSh7fSwgaW5zdHJ1Y3Rpb25TZXRJbmRleCwgU3RhdHVzQ2hlY2tTdGF0ZXMuRkVUQ0hJTkcpKQogICAgICAgIH07CiAgICAgIH0sIF90aGlzLmNoZWNrSW5zdHJ1Y3Rpb25TZXRTdGF0dXMuYmluZChudWxsLCBpbnN0cnVjdGlvblNldEluZGV4KSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJyZW5kZXJJbnN0cnVjdGlvblNldHMiLCBmdW5jdGlvbiAoaW5zdHJ1Y3Rpb25zKSB7CiAgICAgIHZhciBvZmZzZXQgPSAxOwogICAgICByZXR1cm4gaW5zdHJ1Y3Rpb25zLmluc3RydWN0aW9uU2V0cy5tYXAoZnVuY3Rpb24gKGluc3RydWN0aW9uU2V0LCBpbmRleCkgewogICAgICAgIHZhciBjdXJyZW50T2Zmc2V0ID0gb2Zmc2V0OwogICAgICAgIG9mZnNldCArPSBpbnN0cnVjdGlvblNldC5pbnN0cnVjdGlvblZhcmlhbnRzWzBdLmluc3RydWN0aW9ucy5sZW5ndGg7CiAgICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2luc3RydWN0aW9uX3NldC5JbnN0cnVjdGlvblNldCwgewogICAgICAgICAgdGl0bGU6IGluc3RydWN0aW9uU2V0LnRpdGxlLAogICAgICAgICAgaW5zdHJ1Y3Rpb25WYXJpYW50czogaW5zdHJ1Y3Rpb25TZXQuaW5zdHJ1Y3Rpb25WYXJpYW50cywKICAgICAgICAgIHN0YXR1c0NoZWNrQ29uZmlnOiBpbnN0cnVjdGlvblNldC5zdGF0dXNDaGVjaywKICAgICAgICAgIHN0YXR1c0NoZWNrU3RhdGU6IF90aGlzLnN0YXRlLnN0YXR1c0NoZWNrU3RhdGVzW2luZGV4XSwKICAgICAgICAgIG9uU3RhdHVzQ2hlY2s6IGZ1bmN0aW9uIG9uU3RhdHVzQ2hlY2soKSB7CiAgICAgICAgICAgIF90aGlzLm9uU3RhdHVzQ2hlY2soaW5kZXgpOwogICAgICAgICAgfSwKICAgICAgICAgIG9mZnNldDogY3VycmVudE9mZnNldCwKICAgICAgICAgIHBhcmFtczogaW5zdHJ1Y3Rpb25zLnBhcmFtcywKICAgICAgICAgIHBhcmFtVmFsdWVzOiBfdGhpcy5zdGF0ZS5wYXJhbVZhbHVlcywKICAgICAgICAgIHNldFBhcmFtZXRlcjogX3RoaXMuc2V0UGFyYW1ldGVyLAogICAgICAgICAgcmVwbGFjZVRlbXBsYXRlU3RyaW5nczogX3RoaXMucHJvcHMucmVwbGFjZVRlbXBsYXRlU3RyaW5ncywKICAgICAgICAgIGtleTogaW5kZXgKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJyZW5kZXJTYXZlZE9iamVjdHNJbnN0YWxsZXIiLCBmdW5jdGlvbiAoKSB7CiAgICAgIGlmICghX3RoaXMuc3RhdGUudHV0b3JpYWwuc2F2ZWRPYmplY3RzKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfc2F2ZWRfb2JqZWN0c19pbnN0YWxsZXIuU2F2ZWRPYmplY3RzSW5zdGFsbGVyLCB7CiAgICAgICAgYnVsa0NyZWF0ZTogX3RoaXMucHJvcHMuYnVsa0NyZWF0ZSwKICAgICAgICBzYXZlZE9iamVjdHM6IF90aGlzLnN0YXRlLnR1dG9yaWFsLnNhdmVkT2JqZWN0cywKICAgICAgICBpbnN0YWxsTXNnOiBfdGhpcy5zdGF0ZS50dXRvcmlhbC5zYXZlZE9iamVjdHNJbnN0YWxsTXNnCiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAicmVuZGVyRm9vdGVyIiwgZnVuY3Rpb24gKCkgewogICAgICB2YXIgbGFiZWw7CiAgICAgIHZhciB1cmw7CgogICAgICBpZiAoX2xvZGFzaC5kZWZhdWx0LmhhcyhfdGhpcy5zdGF0ZSwgJ3R1dG9yaWFsLmFydGlmYWN0cy5hcHBsaWNhdGlvbicpKSB7CiAgICAgICAgbGFiZWwgPSBfdGhpcy5zdGF0ZS50dXRvcmlhbC5hcnRpZmFjdHMuYXBwbGljYXRpb24ubGFiZWw7CiAgICAgICAgdXJsID0gX3RoaXMucHJvcHMuYWRkQmFzZVBhdGgoX3RoaXMuc3RhdGUudHV0b3JpYWwuYXJ0aWZhY3RzLmFwcGxpY2F0aW9uLnBhdGgpOwogICAgICB9IGVsc2UgaWYgKF9sb2Rhc2guZGVmYXVsdC5oYXMoX3RoaXMuc3RhdGUsICd0dXRvcmlhbC5hcnRpZmFjdHMuZGFzaGJvYXJkcycpKSB7CiAgICAgICAgdmFyIG92ZXJ2aWV3RGFzaGJvYXJkID0gX3RoaXMuc3RhdGUudHV0b3JpYWwuYXJ0aWZhY3RzLmRhc2hib2FyZHMuZmluZChmdW5jdGlvbiAoZGFzaGJvYXJkKSB7CiAgICAgICAgICByZXR1cm4gZGFzaGJvYXJkLmlzT3ZlcnZpZXc7CiAgICAgICAgfSk7CgogICAgICAgIGlmIChvdmVydmlld0Rhc2hib2FyZCkgewogICAgICAgICAgbGFiZWwgPSBvdmVydmlld0Rhc2hib2FyZC5saW5rTGFiZWw7CiAgICAgICAgICB1cmwgPSBfdGhpcy5wcm9wcy5hZGRCYXNlUGF0aCgiL2FwcC9raWJhbmEjL2Rhc2hib2FyZC8iLmNvbmNhdChvdmVydmlld0Rhc2hib2FyZC5pZCkpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHVybCAmJiBsYWJlbCkgewogICAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9mb290ZXIuRm9vdGVyLCB7CiAgICAgICAgICBsYWJlbDogbGFiZWwsCiAgICAgICAgICB1cmw6IHVybAogICAgICAgIH0pOwogICAgICB9CiAgICB9KTsKCiAgICBfdGhpcy5zdGF0ZSA9IHsKICAgICAgbm90Rm91bmQ6IGZhbHNlLAogICAgICBwYXJhbVZhbHVlczoge30sCiAgICAgIHN0YXR1c0NoZWNrU3RhdGVzOiBbXSwKICAgICAgdHV0b3JpYWw6IG51bGwKICAgIH07CgogICAgaWYgKHByb3BzLmlzQ2xvdWRFbmFibGVkKSB7CiAgICAgIF90aGlzLnN0YXRlLnZpc2libGVJbnN0cnVjdGlvbnMgPSBJTlNUUlVDVElPTlNfVFlQRS5FTEFTVElDX0NMT1VEOwogICAgfSBlbHNlIHsKICAgICAgX3RoaXMuc3RhdGUudmlzaWJsZUluc3RydWN0aW9ucyA9IElOU1RSVUNUSU9OU19UWVBFLk9OX1BSRU07CiAgICB9CgogICAgcmV0dXJuIF90aGlzOwogIH0KCiAgX2NyZWF0ZUNsYXNzKFR1dG9yaWFsVWksIFt7CiAgICBrZXk6ICJVTlNBRkVfY29tcG9uZW50V2lsbE1vdW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBVTlNBRkVfY29tcG9uZW50V2lsbE1vdW50KCkgewogICAgICB0aGlzLl9pc01vdW50ZWQgPSB0cnVlOwogICAgfQogIH0sIHsKICAgIGtleTogImNvbXBvbmVudFdpbGxVbm1vdW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnRXaWxsVW5tb3VudCgpIHsKICAgICAgdGhpcy5faXNNb3VudGVkID0gZmFsc2U7CiAgICB9CiAgfSwgewogICAga2V5OiAiY29tcG9uZW50RGlkTW91bnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudERpZE1vdW50KCkgewogICAgICB2YXIgdHV0b3JpYWw7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXN5bmMoZnVuY3Rpb24gY29tcG9uZW50RGlkTW91bnQkKF9jb250ZXh0MykgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMjsKICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKHRoaXMucHJvcHMuZ2V0VHV0b3JpYWwodGhpcy5wcm9wcy50dXRvcmlhbElkKSk7CgogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgdHV0b3JpYWwgPSBfY29udGV4dDMuc2VudDsKCiAgICAgICAgICAgICAgaWYgKHRoaXMuX2lzTW91bnRlZCkgewogICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA1OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgaWYgKHR1dG9yaWFsKSB7CiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3Qvbm8tZGlkLW1vdW50LXNldC1zdGF0ZQogICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICAgIHR1dG9yaWFsOiB0dXRvcmlhbAogICAgICAgICAgICAgICAgfSwgdGhpcy5pbml0SW5zdHJ1Y3Rpb25zU3RhdGUpOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3Qvbm8tZGlkLW1vdW50LXNldC1zdGF0ZQogICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICAgIG5vdEZvdW5kOiB0cnVlCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICgwLCBfa2liYW5hX3NlcnZpY2VzLmdldFNlcnZpY2VzKSgpLmNocm9tZS5zZXRCcmVhZGNydW1icyhbewogICAgICAgICAgICAgICAgdGV4dDogaG9tZVRpdGxlLAogICAgICAgICAgICAgICAgaHJlZjogJyMvaG9tZScKICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICB0ZXh0OiBhZGREYXRhVGl0bGUsCiAgICAgICAgICAgICAgICBocmVmOiAnIy9ob21lL3R1dG9yaWFsX2RpcmVjdG9yeScKICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICB0ZXh0OiB0dXRvcmlhbCA/IHR1dG9yaWFsLm5hbWUgOiB0aGlzLnByb3BzLnR1dG9yaWFsSWQKICAgICAgICAgICAgICB9XSk7CgogICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBudWxsLCB0aGlzKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHsKICAgICAgdmFyIGNvbnRlbnQ7CgogICAgICBpZiAodGhpcy5zdGF0ZS5ub3RGb3VuZCkgewogICAgICAgIGNvbnRlbnQgPSBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgICBjbGFzc05hbWU6ICJob21UdXRvcmlhbF9fbm90Rm91bmRQYW5lbCIKICAgICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVGV4dCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgicCIsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICBpZDogImtibi5ob21lLnR1dG9yaWFsLm5vVHV0b3JpYWxMYWJlbCIsCiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIlVuYWJsZSB0byBmaW5kIHR1dG9yaWFsIHt0dXRvcmlhbElkfSIsCiAgICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgICAgdHV0b3JpYWxJZDogdGhpcy5wcm9wcy50dXRvcmlhbElkCiAgICAgICAgICB9CiAgICAgICAgfSkpKSk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnN0YXRlLnR1dG9yaWFsKSB7CiAgICAgICAgdmFyIHByZXZpZXdVcmw7CgogICAgICAgIGlmICh0aGlzLnN0YXRlLnR1dG9yaWFsLnByZXZpZXdJbWFnZVBhdGgpIHsKICAgICAgICAgIHByZXZpZXdVcmwgPSB0aGlzLnByb3BzLmFkZEJhc2VQYXRoKHRoaXMuc3RhdGUudHV0b3JpYWwucHJldmlld0ltYWdlUGF0aCk7CiAgICAgICAgfQoKICAgICAgICB2YXIgZXhwb3J0ZWRGaWVsZHNVcmw7CgogICAgICAgIGlmIChfbG9kYXNoLmRlZmF1bHQuaGFzKHRoaXMuc3RhdGUsICd0dXRvcmlhbC5hcnRpZmFjdHMuZXhwb3J0ZWRGaWVsZHMnKSkgewogICAgICAgICAgZXhwb3J0ZWRGaWVsZHNVcmwgPSB0aGlzLnByb3BzLnJlcGxhY2VUZW1wbGF0ZVN0cmluZ3ModGhpcy5zdGF0ZS50dXRvcmlhbC5hcnRpZmFjdHMuZXhwb3J0ZWRGaWVsZHMuZG9jdW1lbnRhdGlvblVybCk7CiAgICAgICAgfQoKICAgICAgICB2YXIgaWNvbiA9IHRoaXMuc3RhdGUudHV0b3JpYWwuZXVpSWNvblR5cGU7CgogICAgICAgIGlmIChpY29uICYmIGljb24uaW5jbHVkZXMoJy8nKSkgewogICAgICAgICAgaWNvbiA9IHRoaXMucHJvcHMuYWRkQmFzZVBhdGgoaWNvbik7CiAgICAgICAgfQoKICAgICAgICB2YXIgaW5zdHJ1Y3Rpb25zID0gdGhpcy5nZXRJbnN0cnVjdGlvbnMoKTsKICAgICAgICBjb250ZW50ID0gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgiZGl2IiwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfaW50cm9kdWN0aW9uLkludHJvZHVjdGlvbiwgewogICAgICAgICAgdGl0bGU6IHRoaXMuc3RhdGUudHV0b3JpYWwubmFtZSwKICAgICAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLnByb3BzLnJlcGxhY2VUZW1wbGF0ZVN0cmluZ3ModGhpcy5zdGF0ZS50dXRvcmlhbC5sb25nRGVzY3JpcHRpb24pLAogICAgICAgICAgcHJldmlld1VybDogcHJldmlld1VybCwKICAgICAgICAgIGV4cG9ydGVkRmllbGRzVXJsOiBleHBvcnRlZEZpZWxkc1VybCwKICAgICAgICAgIGljb25UeXBlOiBpY29uLAogICAgICAgICAgaXNCZXRhOiB0aGlzLnN0YXRlLnR1dG9yaWFsLmlzQmV0YQogICAgICAgIH0pLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3BhY2VyLCBudWxsKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgICAgY2xhc3NOYW1lOiAiZXVpLXRleHRDZW50ZXIiCiAgICAgICAgfSwgdGhpcy5yZW5kZXJJbnN0cnVjdGlvblNldHNUb2dnbGUoKSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTcGFjZXIsIG51bGwpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpUGFuZWwsIHsKICAgICAgICAgIHBhZGRpbmdTaXplOiAibCIKICAgICAgICB9LCB0aGlzLnJlbmRlckluc3RydWN0aW9uU2V0cyhpbnN0cnVjdGlvbnMpLCB0aGlzLnJlbmRlclNhdmVkT2JqZWN0c0luc3RhbGxlcigpLCB0aGlzLnJlbmRlckZvb3RlcigpKSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpUGFnZSwgewogICAgICAgIHJlc3RyaWN0V2lkdGg6IDEyMDAKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVBhZ2VCb2R5LCBudWxsLCBjb250ZW50KSk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gVHV0b3JpYWxVaTsKfShfcmVhY3QuZGVmYXVsdC5Db21wb25lbnQpOwoKVHV0b3JpYWxVaS5wcm9wVHlwZXMgPSB7CiAgYWRkQmFzZVBhdGg6IF9wcm9wVHlwZXMuZGVmYXVsdC5mdW5jLmlzUmVxdWlyZWQsCiAgaXNDbG91ZEVuYWJsZWQ6IF9wcm9wVHlwZXMuZGVmYXVsdC5ib29sLmlzUmVxdWlyZWQsCiAgZ2V0VHV0b3JpYWw6IF9wcm9wVHlwZXMuZGVmYXVsdC5mdW5jLmlzUmVxdWlyZWQsCiAgcmVwbGFjZVRlbXBsYXRlU3RyaW5nczogX3Byb3BUeXBlcy5kZWZhdWx0LmZ1bmMuaXNSZXF1aXJlZCwKICB0dXRvcmlhbElkOiBfcHJvcFR5cGVzLmRlZmF1bHQuc3RyaW5nLmlzUmVxdWlyZWQsCiAgYnVsa0NyZWF0ZTogX3Byb3BUeXBlcy5kZWZhdWx0LmZ1bmMuaXNSZXF1aXJlZAp9Owp2YXIgVHV0b3JpYWwgPSAoMCwgX3JlYWN0Mi5pbmplY3RJMThuKShUdXRvcmlhbFVpKTsKZXhwb3J0cy5UdXRvcmlhbCA9IFR1dG9yaWFsOw=="},null]}