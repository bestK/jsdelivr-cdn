{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/ml/public/application/services/results_service/result_service_rx.js","dependencies":[{"path":"x-pack/legacy/plugins/ml/public/application/services/results_service/result_service_rx.js","mtime":1585205045952},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmdldE1ldHJpY0RhdGEgPSBnZXRNZXRyaWNEYXRhOwpleHBvcnRzLmdldE1vZGVsUGxvdE91dHB1dCA9IGdldE1vZGVsUGxvdE91dHB1dDsKZXhwb3J0cy5nZXRSZWNvcmRzRm9yQ3JpdGVyaWEgPSBnZXRSZWNvcmRzRm9yQ3JpdGVyaWE7CmV4cG9ydHMuZ2V0U2NoZWR1bGVkRXZlbnRzQnlCdWNrZXQgPSBnZXRTY2hlZHVsZWRFdmVudHNCeUJ1Y2tldDsKZXhwb3J0cy5mZXRjaFBhcnRpdGlvbkZpZWxkc1ZhbHVlcyA9IGZldGNoUGFydGl0aW9uRmllbGRzVmFsdWVzOwoKdmFyIF9vcGVyYXRvcnMgPSByZXF1aXJlKCJyeGpzL29wZXJhdG9ycyIpOwoKdmFyIF9sb2Rhc2ggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoImxvZGFzaCIpKTsKCnZhciBfam9iX3V0aWxzID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vY29tbW9uL3V0aWwvam9iX3V0aWxzIik7Cgp2YXIgX21sX2FwaV9zZXJ2aWNlID0gcmVxdWlyZSgiLi4vbWxfYXBpX3NlcnZpY2UiKTsKCnZhciBfaW5kZXhfcGF0dGVybnMgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9jb21tb24vY29uc3RhbnRzL2luZGV4X3BhdHRlcm5zIik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgewogIHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7CiAgICBkZWZhdWx0OiBvYmoKICB9Owp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7CiAgaWYgKGtleSBpbiBvYmopIHsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgICB2YWx1ZTogdmFsdWUsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgd3JpdGFibGU6IHRydWUKICAgIH0pOwogIH0gZWxzZSB7CiAgICBvYmpba2V5XSA9IHZhbHVlOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKZnVuY3Rpb24gX3RvQ29uc3VtYWJsZUFycmF5KGFycikgewogIHJldHVybiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5KGFycikgfHwgX25vbkl0ZXJhYmxlU3ByZWFkKCk7Cn0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVNwcmVhZCgpIHsKICB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gc3ByZWFkIG5vbi1pdGVyYWJsZSBpbnN0YW5jZSIpOwp9CgpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5KGl0ZXIpIHsKICBpZiAoU3ltYm9sLml0ZXJhdG9yIGluIE9iamVjdChpdGVyKSB8fCBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoaXRlcikgPT09ICJbb2JqZWN0IEFyZ3VtZW50c10iKSByZXR1cm4gQXJyYXkuZnJvbShpdGVyKTsKfQoKZnVuY3Rpb24gX2FycmF5V2l0aG91dEhvbGVzKGFycikgewogIGlmIChBcnJheS5pc0FycmF5KGFycikpIHsKICAgIGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGFyci5sZW5ndGgpOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7CiAgICAgIGFycjJbaV0gPSBhcnJbaV07CiAgICB9CgogICAgcmV0dXJuIGFycjI7CiAgfQp9CgpmdW5jdGlvbiBnZXRNZXRyaWNEYXRhKGluZGV4LCBlbnRpdHlGaWVsZHMsIHF1ZXJ5LCBtZXRyaWNGdW5jdGlvbiwgLy8gRVMgYWdncmVnYXRpb24gbmFtZQptZXRyaWNGaWVsZE5hbWUsIHRpbWVGaWVsZE5hbWUsIGVhcmxpZXN0TXMsIGxhdGVzdE1zLCBpbnRlcnZhbCkgewogIC8vIEJ1aWxkIHRoZSBjcml0ZXJpYSB0byB1c2UgaW4gdGhlIGJvb2wgZmlsdGVyIHBhcnQgb2YgdGhlIHJlcXVlc3QuCiAgLy8gQWRkIGNyaXRlcmlhIGZvciB0aGUgdGltZSByYW5nZSwgZW50aXR5IGZpZWxkcywKICAvLyBwbHVzIGFueSBhZGRpdGlvbmFsIHN1cHBsaWVkIHF1ZXJ5LgogIHZhciBzaG91bGRDcml0ZXJpYSA9IFtdOwogIHZhciBtdXN0Q3JpdGVyaWEgPSBbewogICAgcmFuZ2U6IF9kZWZpbmVQcm9wZXJ0eSh7fSwgdGltZUZpZWxkTmFtZSwgewogICAgICBndGU6IGVhcmxpZXN0TXMsCiAgICAgIGx0ZTogbGF0ZXN0TXMsCiAgICAgIGZvcm1hdDogJ2Vwb2NoX21pbGxpcycKICAgIH0pCiAgfV0uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShxdWVyeSA/IFtxdWVyeV0gOiBbXSkpOwogIGVudGl0eUZpZWxkcy5mb3JFYWNoKGZ1bmN0aW9uIChlbnRpdHkpIHsKICAgIGlmIChlbnRpdHkuZmllbGRWYWx1ZS5sZW5ndGggIT09IDApIHsKICAgICAgbXVzdENyaXRlcmlhLnB1c2goewogICAgICAgIHRlcm06IF9kZWZpbmVQcm9wZXJ0eSh7fSwgZW50aXR5LmZpZWxkTmFtZSwgZW50aXR5LmZpZWxkVmFsdWUpCiAgICAgIH0pOwogICAgfSBlbHNlIHsKICAgICAgLy8gQWRkIHNwZWNpYWwgaGFuZGxpbmcgZm9yIGJsYW5rIGVudGl0eSBmaWVsZCB2YWx1ZXMsIGNoZWNraW5nIGZvciBlaXRoZXIKICAgICAgLy8gYW4gZW1wdHkgc3RyaW5nIG9yIHRoZSBmaWVsZCBub3QgZXhpc3RpbmcuCiAgICAgIHNob3VsZENyaXRlcmlhLnB1c2goewogICAgICAgIGJvb2w6IHsKICAgICAgICAgIG11c3Q6IFt7CiAgICAgICAgICAgIHRlcm06IF9kZWZpbmVQcm9wZXJ0eSh7fSwgZW50aXR5LmZpZWxkTmFtZSwgJycpCiAgICAgICAgICB9XQogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHNob3VsZENyaXRlcmlhLnB1c2goewogICAgICAgIGJvb2w6IHsKICAgICAgICAgIG11c3Rfbm90OiBbewogICAgICAgICAgICBleGlzdHM6IHsKICAgICAgICAgICAgICBmaWVsZDogZW50aXR5LmZpZWxkTmFtZQogICAgICAgICAgICB9CiAgICAgICAgICB9XQogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfSk7CiAgdmFyIGJvZHkgPSB7CiAgICBxdWVyeTogewogICAgICBib29sOiB7CiAgICAgICAgbXVzdDogbXVzdENyaXRlcmlhCiAgICAgIH0KICAgIH0sCiAgICBzaXplOiAwLAogICAgX3NvdXJjZTogewogICAgICBleGNsdWRlczogW10KICAgIH0sCiAgICBhZ2dzOiB7CiAgICAgIGJ5VGltZTogewogICAgICAgIGRhdGVfaGlzdG9ncmFtOiB7CiAgICAgICAgICBmaWVsZDogdGltZUZpZWxkTmFtZSwKICAgICAgICAgIGludGVydmFsOiBpbnRlcnZhbCwKICAgICAgICAgIG1pbl9kb2NfY291bnQ6IDAKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9OwoKICBpZiAoc2hvdWxkQ3JpdGVyaWEubGVuZ3RoID4gMCkgewogICAgYm9keS5xdWVyeS5ib29sLnNob3VsZCA9IHNob3VsZENyaXRlcmlhOwogICAgYm9keS5xdWVyeS5ib29sLm1pbmltdW1fc2hvdWxkX21hdGNoID0gc2hvdWxkQ3JpdGVyaWEubGVuZ3RoIC8gMjsKICB9CgogIGlmIChtZXRyaWNGaWVsZE5hbWUgIT09IHVuZGVmaW5lZCAmJiBtZXRyaWNGaWVsZE5hbWUgIT09ICcnKSB7CiAgICBib2R5LmFnZ3MuYnlUaW1lLmFnZ3MgPSB7fTsKCiAgICB2YXIgbWV0cmljQWdnID0gX2RlZmluZVByb3BlcnR5KHt9LCBtZXRyaWNGdW5jdGlvbiwgewogICAgICBmaWVsZDogbWV0cmljRmllbGROYW1lCiAgICB9KTsKCiAgICBpZiAobWV0cmljRnVuY3Rpb24gPT09ICdwZXJjZW50aWxlcycpIHsKICAgICAgbWV0cmljQWdnW21ldHJpY0Z1bmN0aW9uXS5wZXJjZW50cyA9IFtfam9iX3V0aWxzLk1MX01FRElBTl9QRVJDRU5UU107CiAgICB9CgogICAgYm9keS5hZ2dzLmJ5VGltZS5hZ2dzLm1ldHJpYyA9IG1ldHJpY0FnZzsKICB9CgogIHJldHVybiBfbWxfYXBpX3NlcnZpY2UubWwuZXNTZWFyY2gkKHsKICAgIGluZGV4OiBpbmRleCwKICAgIGJvZHk6IGJvZHkKICB9KS5waXBlKCgwLCBfb3BlcmF0b3JzLm1hcCkoZnVuY3Rpb24gKHJlc3ApIHsKICAgIHZhciBfcmVmLCBfcmVzcCRhZ2dyZWdhdGlvbnMsIF9yZXNwJGFnZ3JlZ2F0aW9ucyRieTsKCiAgICB2YXIgb2JqID0gewogICAgICBzdWNjZXNzOiB0cnVlLAogICAgICByZXN1bHRzOiB7fQogICAgfTsKICAgIHZhciBkYXRhQnlUaW1lID0gKF9yZWYgPSByZXNwID09PSBudWxsIHx8IHJlc3AgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfcmVzcCRhZ2dyZWdhdGlvbnMgPSByZXNwLmFnZ3JlZ2F0aW9ucykgPT09IG51bGwgfHwgX3Jlc3AkYWdncmVnYXRpb25zID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX3Jlc3AkYWdncmVnYXRpb25zJGJ5ID0gX3Jlc3AkYWdncmVnYXRpb25zLmJ5VGltZSkgPT09IG51bGwgfHwgX3Jlc3AkYWdncmVnYXRpb25zJGJ5ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfcmVzcCRhZ2dyZWdhdGlvbnMkYnkuYnVja2V0cykgIT09IG51bGwgJiYgX3JlZiAhPT0gdm9pZCAwID8gX3JlZiA6IFtdOwogICAgZGF0YUJ5VGltZS5mb3JFYWNoKGZ1bmN0aW9uIChkYXRhRm9yVGltZSkgewogICAgICBpZiAobWV0cmljRnVuY3Rpb24gPT09ICdjb3VudCcpIHsKICAgICAgICBvYmoucmVzdWx0c1tkYXRhRm9yVGltZS5rZXldID0gZGF0YUZvclRpbWUuZG9jX2NvdW50OwogICAgICB9IGVsc2UgewogICAgICAgIHZhciBfZGF0YUZvclRpbWUkbWV0cmljLCBfZGF0YUZvclRpbWUkbWV0cmljMjsKCiAgICAgICAgdmFyIHZhbHVlID0gZGF0YUZvclRpbWUgPT09IG51bGwgfHwgZGF0YUZvclRpbWUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfZGF0YUZvclRpbWUkbWV0cmljID0gZGF0YUZvclRpbWUubWV0cmljKSA9PT0gbnVsbCB8fCBfZGF0YUZvclRpbWUkbWV0cmljID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZGF0YUZvclRpbWUkbWV0cmljLnZhbHVlOwogICAgICAgIHZhciB2YWx1ZXMgPSBkYXRhRm9yVGltZSA9PT0gbnVsbCB8fCBkYXRhRm9yVGltZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9kYXRhRm9yVGltZSRtZXRyaWMyID0gZGF0YUZvclRpbWUubWV0cmljKSA9PT0gbnVsbCB8fCBfZGF0YUZvclRpbWUkbWV0cmljMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2RhdGFGb3JUaW1lJG1ldHJpYzIudmFsdWVzOwoKICAgICAgICBpZiAoZGF0YUZvclRpbWUuZG9jX2NvdW50ID09PSAwKSB7CiAgICAgICAgICBvYmoucmVzdWx0c1tkYXRhRm9yVGltZS5rZXldID0gbnVsbDsKICAgICAgICB9IGVsc2UgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIG9iai5yZXN1bHRzW2RhdGFGb3JUaW1lLmtleV0gPSB2YWx1ZTsKICAgICAgICB9IGVsc2UgaWYgKHZhbHVlcyAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAvLyBQZXJjZW50aWxlcyBhZ2cgY3VycmVudGx5IHJldHVybnMgTmFOIHJhdGhlciB0aGFuIG51bGwgd2hlbiBub25lIG9mIHRoZSBkb2NzIGluIHRoZQogICAgICAgICAgLy8gYnVja2V0IGNvbnRhaW4gdGhlIGZpZWxkIHVzZWQgaW4gdGhlIGFnZ3JlZ2F0aW9uCiAgICAgICAgICAvLyAoc2VlIGVsYXN0aWNzZWFyY2ggaXNzdWUgaHR0cHM6Ly9naXRodWIuY29tL2VsYXN0aWMvZWxhc3RpY3NlYXJjaC9pc3N1ZXMvMjkwNjYpLgogICAgICAgICAgLy8gU3RvcmUgYXMgbnVsbCwgc28gdmFsdWVzIGNhbiBiZSBoYW5kbGVkIGluIHRoZSBzYW1lIG1hbm5lciBkb3duc3RyZWFtIGFzIG90aGVyIGFnZ3MKICAgICAgICAgIC8vIChtaW4sIG1lYW4sIG1heCkgd2hpY2ggcmV0dXJuIG51bGwuCiAgICAgICAgICB2YXIgbWVkaWFuVmFsdWVzID0gdmFsdWVzW19qb2JfdXRpbHMuTUxfTUVESUFOX1BFUkNFTlRTXTsKICAgICAgICAgIG9iai5yZXN1bHRzW2RhdGFGb3JUaW1lLmtleV0gPSAhaXNOYU4obWVkaWFuVmFsdWVzKSA/IG1lZGlhblZhbHVlcyA6IG51bGw7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG9iai5yZXN1bHRzW2RhdGFGb3JUaW1lLmtleV0gPSBudWxsOwogICAgICAgIH0KICAgICAgfQogICAgfSk7CiAgICByZXR1cm4gb2JqOwogIH0pKTsKfQoKZnVuY3Rpb24gZ2V0TW9kZWxQbG90T3V0cHV0KGpvYklkLCBkZXRlY3RvckluZGV4LCBjcml0ZXJpYUZpZWxkcywgZWFybGllc3RNcywgbGF0ZXN0TXMsIGludGVydmFsLCBhZ2dUeXBlKSB7CiAgdmFyIG9iaiA9IHsKICAgIHN1Y2Nlc3M6IHRydWUsCiAgICByZXN1bHRzOiB7fQogIH07IC8vIGlmIGFuIGFnZ1R5cGUgb2JqZWN0IGhhcyBiZWVuIHBhc3NlZCBpbiwgdXNlIGl0LgogIC8vIG90aGVyd2lzZSBkZWZhdWx0IHRvIG1pbiBhbmQgbWF4IGFnZ3MgZm9yIHRoZSB1cHBlciBhbmQgbG93ZXIgYm91bmRzCgogIHZhciBtb2RlbEFnZ3MgPSBhZ2dUeXBlID09PSB1bmRlZmluZWQgPyB7CiAgICBtYXg6ICdtYXgnLAogICAgbWluOiAnbWluJwogIH0gOiB7CiAgICBtYXg6IGFnZ1R5cGUubWF4LAogICAgbWluOiBhZ2dUeXBlLm1pbgogIH07IC8vIEJ1aWxkIHRoZSBjcml0ZXJpYSB0byB1c2UgaW4gdGhlIGJvb2wgZmlsdGVyIHBhcnQgb2YgdGhlIHJlcXVlc3QuCiAgLy8gQWRkIGNyaXRlcmlhIGZvciB0aGUgam9iIElEIGFuZCB0aW1lIHJhbmdlLgoKICB2YXIgbXVzdENyaXRlcmlhID0gW3sKICAgIHRlcm06IHsKICAgICAgam9iX2lkOiBqb2JJZAogICAgfQogIH0sIHsKICAgIHJhbmdlOiB7CiAgICAgIHRpbWVzdGFtcDogewogICAgICAgIGd0ZTogZWFybGllc3RNcywKICAgICAgICBsdGU6IGxhdGVzdE1zLAogICAgICAgIGZvcm1hdDogJ2Vwb2NoX21pbGxpcycKICAgICAgfQogICAgfQogIH1dOyAvLyBBZGQgaW4gdGVybSBxdWVyaWVzIGZvciBlYWNoIG9mIHRoZSBzcGVjaWZpZWQgY3JpdGVyaWEuCgogIF9sb2Rhc2guZGVmYXVsdC5lYWNoKGNyaXRlcmlhRmllbGRzLCBmdW5jdGlvbiAoY3JpdGVyaWEpIHsKICAgIG11c3RDcml0ZXJpYS5wdXNoKHsKICAgICAgdGVybTogX2RlZmluZVByb3BlcnR5KHt9LCBjcml0ZXJpYS5maWVsZE5hbWUsIGNyaXRlcmlhLmZpZWxkVmFsdWUpCiAgICB9KTsKICB9KTsgLy8gQWRkIGNyaXRlcmlhIGZvciB0aGUgZGV0ZWN0b3IgaW5kZXguIFJlc3VsdHMgZnJvbSBqb2JzIGNyZWF0ZWQgYmVmb3JlIDYuMSB3aWxsIG5vdAogIC8vIGNvbnRhaW4gYSBkZXRlY3Rvcl9pbmRleCBmaWVsZCwgc28gdXNlIGEgc2hvdWxkIGNyaXRlcmlhIHdpdGggYSAnbm90IGV4aXN0cycgY2hlY2suCgoKICB2YXIgc2hvdWxkQ3JpdGVyaWEgPSBbewogICAgdGVybTogewogICAgICBkZXRlY3Rvcl9pbmRleDogZGV0ZWN0b3JJbmRleAogICAgfQogIH0sIHsKICAgIGJvb2w6IHsKICAgICAgbXVzdF9ub3Q6IFt7CiAgICAgICAgZXhpc3RzOiB7CiAgICAgICAgICBmaWVsZDogJ2RldGVjdG9yX2luZGV4JwogICAgICAgIH0KICAgICAgfV0KICAgIH0KICB9XTsKICByZXR1cm4gX21sX2FwaV9zZXJ2aWNlLm1sLmVzU2VhcmNoJCh7CiAgICBpbmRleDogX2luZGV4X3BhdHRlcm5zLk1MX1JFU1VMVFNfSU5ERVhfUEFUVEVSTiwKICAgIHNpemU6IDAsCiAgICBib2R5OiB7CiAgICAgIHF1ZXJ5OiB7CiAgICAgICAgYm9vbDogewogICAgICAgICAgZmlsdGVyOiBbewogICAgICAgICAgICBxdWVyeV9zdHJpbmc6IHsKICAgICAgICAgICAgICBxdWVyeTogJ3Jlc3VsdF90eXBlOm1vZGVsX3Bsb3QnLAogICAgICAgICAgICAgIGFuYWx5emVfd2lsZGNhcmQ6IHRydWUKICAgICAgICAgICAgfQogICAgICAgICAgfSwgewogICAgICAgICAgICBib29sOiB7CiAgICAgICAgICAgICAgbXVzdDogbXVzdENyaXRlcmlhLAogICAgICAgICAgICAgIHNob3VsZDogc2hvdWxkQ3JpdGVyaWEsCiAgICAgICAgICAgICAgbWluaW11bV9zaG91bGRfbWF0Y2g6IDEKICAgICAgICAgICAgfQogICAgICAgICAgfV0KICAgICAgICB9CiAgICAgIH0sCiAgICAgIGFnZ3M6IHsKICAgICAgICB0aW1lczogewogICAgICAgICAgZGF0ZV9oaXN0b2dyYW06IHsKICAgICAgICAgICAgZmllbGQ6ICd0aW1lc3RhbXAnLAogICAgICAgICAgICBpbnRlcnZhbDogaW50ZXJ2YWwsCiAgICAgICAgICAgIG1pbl9kb2NfY291bnQ6IDAKICAgICAgICAgIH0sCiAgICAgICAgICBhZ2dzOiB7CiAgICAgICAgICAgIGFjdHVhbDogewogICAgICAgICAgICAgIGF2ZzogewogICAgICAgICAgICAgICAgZmllbGQ6ICdhY3R1YWwnCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICBtb2RlbFVwcGVyOiBfZGVmaW5lUHJvcGVydHkoe30sIG1vZGVsQWdncy5tYXgsIHsKICAgICAgICAgICAgICBmaWVsZDogJ21vZGVsX3VwcGVyJwogICAgICAgICAgICB9KSwKICAgICAgICAgICAgbW9kZWxMb3dlcjogX2RlZmluZVByb3BlcnR5KHt9LCBtb2RlbEFnZ3MubWluLCB7CiAgICAgICAgICAgICAgZmllbGQ6ICdtb2RlbF9sb3dlcicKICAgICAgICAgICAgfSkKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9KS5waXBlKCgwLCBfb3BlcmF0b3JzLm1hcCkoZnVuY3Rpb24gKHJlc3ApIHsKICAgIHZhciBhZ2dyZWdhdGlvbnNCeVRpbWUgPSBfbG9kYXNoLmRlZmF1bHQuZ2V0KHJlc3AsIFsnYWdncmVnYXRpb25zJywgJ3RpbWVzJywgJ2J1Y2tldHMnXSwgW10pOwoKICAgIF9sb2Rhc2guZGVmYXVsdC5lYWNoKGFnZ3JlZ2F0aW9uc0J5VGltZSwgZnVuY3Rpb24gKGRhdGFGb3JUaW1lKSB7CiAgICAgIHZhciB0aW1lID0gZGF0YUZvclRpbWUua2V5OwoKICAgICAgdmFyIG1vZGVsVXBwZXIgPSBfbG9kYXNoLmRlZmF1bHQuZ2V0KGRhdGFGb3JUaW1lLCBbJ21vZGVsVXBwZXInLCAndmFsdWUnXSk7CgogICAgICB2YXIgbW9kZWxMb3dlciA9IF9sb2Rhc2guZGVmYXVsdC5nZXQoZGF0YUZvclRpbWUsIFsnbW9kZWxMb3dlcicsICd2YWx1ZSddKTsKCiAgICAgIHZhciBhY3R1YWwgPSBfbG9kYXNoLmRlZmF1bHQuZ2V0KGRhdGFGb3JUaW1lLCBbJ2FjdHVhbCcsICd2YWx1ZSddKTsKCiAgICAgIG9iai5yZXN1bHRzW3RpbWVdID0gewogICAgICAgIGFjdHVhbDogYWN0dWFsLAogICAgICAgIG1vZGVsVXBwZXI6IG1vZGVsVXBwZXIgPT09IHVuZGVmaW5lZCB8fCBpc0Zpbml0ZShtb2RlbFVwcGVyKSA9PT0gZmFsc2UgPyBudWxsIDogbW9kZWxVcHBlciwKICAgICAgICBtb2RlbExvd2VyOiBtb2RlbExvd2VyID09PSB1bmRlZmluZWQgfHwgaXNGaW5pdGUobW9kZWxMb3dlcikgPT09IGZhbHNlID8gbnVsbCA6IG1vZGVsTG93ZXIKICAgICAgfTsKICAgIH0pOwoKICAgIHJldHVybiBvYmo7CiAgfSkpOwp9IC8vIFF1ZXJpZXMgRWxhc3RpY3NlYXJjaCB0byBvYnRhaW4gdGhlIHJlY29yZCBsZXZlbCByZXN1bHRzIG1hdGNoaW5nIHRoZSBnaXZlbiBjcml0ZXJpYSwKLy8gZm9yIHRoZSBzcGVjaWZpZWQgam9iKHMpLCB0aW1lIHJhbmdlLCBhbmQgcmVjb3JkIHNjb3JlIHRocmVzaG9sZC4KLy8gY3JpdGVyaWFGaWVsZHMgcGFyYW1ldGVyIG11c3QgYmUgYW4gYXJyYXksIHdpdGggZWFjaCBvYmplY3QgaW4gdGhlIGFycmF5IGhhdmluZyAnZmllbGROYW1lJwovLyAnZmllbGRWYWx1ZScgcHJvcGVydGllcy4KLy8gUGFzcyBhbiBlbXB0eSBhcnJheSBvciBbJyonXSB0byBzZWFyY2ggb3ZlciBhbGwgam9iIElEcy4KCgpmdW5jdGlvbiBnZXRSZWNvcmRzRm9yQ3JpdGVyaWEoam9iSWRzLCBjcml0ZXJpYUZpZWxkcywgdGhyZXNob2xkLCBlYXJsaWVzdE1zLCBsYXRlc3RNcywgbWF4UmVzdWx0cykgewogIHZhciBvYmogPSB7CiAgICBzdWNjZXNzOiB0cnVlLAogICAgcmVjb3JkczogW10KICB9OyAvLyBCdWlsZCB0aGUgY3JpdGVyaWEgdG8gdXNlIGluIHRoZSBib29sIGZpbHRlciBwYXJ0IG9mIHRoZSByZXF1ZXN0LgogIC8vIEFkZCBjcml0ZXJpYSBmb3IgdGhlIHRpbWUgcmFuZ2UsIHJlY29yZCBzY29yZSwgcGx1cyBhbnkgc3BlY2lmaWVkIGpvYiBJRHMuCgogIHZhciBib29sQ3JpdGVyaWEgPSBbewogICAgcmFuZ2U6IHsKICAgICAgdGltZXN0YW1wOiB7CiAgICAgICAgZ3RlOiBlYXJsaWVzdE1zLAogICAgICAgIGx0ZTogbGF0ZXN0TXMsCiAgICAgICAgZm9ybWF0OiAnZXBvY2hfbWlsbGlzJwogICAgICB9CiAgICB9CiAgfSwgewogICAgcmFuZ2U6IHsKICAgICAgcmVjb3JkX3Njb3JlOiB7CiAgICAgICAgZ3RlOiB0aHJlc2hvbGQKICAgICAgfQogICAgfQogIH1dOwoKICBpZiAoam9iSWRzICYmIGpvYklkcy5sZW5ndGggPiAwICYmICEoam9iSWRzLmxlbmd0aCA9PT0gMSAmJiBqb2JJZHNbMF0gPT09ICcqJykpIHsKICAgIHZhciBqb2JJZEZpbHRlclN0ciA9ICcnOwoKICAgIF9sb2Rhc2guZGVmYXVsdC5lYWNoKGpvYklkcywgZnVuY3Rpb24gKGpvYklkLCBpKSB7CiAgICAgIGlmIChpID4gMCkgewogICAgICAgIGpvYklkRmlsdGVyU3RyICs9ICcgT1IgJzsKICAgICAgfQoKICAgICAgam9iSWRGaWx0ZXJTdHIgKz0gJ2pvYl9pZDonOwogICAgICBqb2JJZEZpbHRlclN0ciArPSBqb2JJZDsKICAgIH0pOwoKICAgIGJvb2xDcml0ZXJpYS5wdXNoKHsKICAgICAgcXVlcnlfc3RyaW5nOiB7CiAgICAgICAgYW5hbHl6ZV93aWxkY2FyZDogZmFsc2UsCiAgICAgICAgcXVlcnk6IGpvYklkRmlsdGVyU3RyCiAgICAgIH0KICAgIH0pOwogIH0gLy8gQWRkIGluIHRlcm0gcXVlcmllcyBmb3IgZWFjaCBvZiB0aGUgc3BlY2lmaWVkIGNyaXRlcmlhLgoKCiAgX2xvZGFzaC5kZWZhdWx0LmVhY2goY3JpdGVyaWFGaWVsZHMsIGZ1bmN0aW9uIChjcml0ZXJpYSkgewogICAgYm9vbENyaXRlcmlhLnB1c2goewogICAgICB0ZXJtOiBfZGVmaW5lUHJvcGVydHkoe30sIGNyaXRlcmlhLmZpZWxkTmFtZSwgY3JpdGVyaWEuZmllbGRWYWx1ZSkKICAgIH0pOwogIH0pOwoKICByZXR1cm4gX21sX2FwaV9zZXJ2aWNlLm1sLmVzU2VhcmNoJCh7CiAgICBpbmRleDogX2luZGV4X3BhdHRlcm5zLk1MX1JFU1VMVFNfSU5ERVhfUEFUVEVSTiwKICAgIHJlc3RfdG90YWxfaGl0c19hc19pbnQ6IHRydWUsCiAgICBzaXplOiBtYXhSZXN1bHRzICE9PSB1bmRlZmluZWQgPyBtYXhSZXN1bHRzIDogMTAwLAogICAgYm9keTogewogICAgICBxdWVyeTogewogICAgICAgIGJvb2w6IHsKICAgICAgICAgIGZpbHRlcjogW3sKICAgICAgICAgICAgcXVlcnlfc3RyaW5nOiB7CiAgICAgICAgICAgICAgcXVlcnk6ICdyZXN1bHRfdHlwZTpyZWNvcmQnLAogICAgICAgICAgICAgIGFuYWx5emVfd2lsZGNhcmQ6IGZhbHNlCiAgICAgICAgICAgIH0KICAgICAgICAgIH0sIHsKICAgICAgICAgICAgYm9vbDogewogICAgICAgICAgICAgIG11c3Q6IGJvb2xDcml0ZXJpYQogICAgICAgICAgICB9CiAgICAgICAgICB9XQogICAgICAgIH0KICAgICAgfSwKICAgICAgc29ydDogW3sKICAgICAgICByZWNvcmRfc2NvcmU6IHsKICAgICAgICAgIG9yZGVyOiAnZGVzYycKICAgICAgICB9CiAgICAgIH1dCiAgICB9CiAgfSkucGlwZSgoMCwgX29wZXJhdG9ycy5tYXApKGZ1bmN0aW9uIChyZXNwKSB7CiAgICBpZiAocmVzcC5oaXRzLnRvdGFsICE9PSAwKSB7CiAgICAgIF9sb2Rhc2guZGVmYXVsdC5lYWNoKHJlc3AuaGl0cy5oaXRzLCBmdW5jdGlvbiAoaGl0KSB7CiAgICAgICAgb2JqLnJlY29yZHMucHVzaChoaXQuX3NvdXJjZSk7CiAgICAgIH0pOwogICAgfQoKICAgIHJldHVybiBvYmo7CiAgfSkpOwp9IC8vIE9idGFpbnMgYSBsaXN0IG9mIHNjaGVkdWxlZCBldmVudHMgYnkgam9iIElEIGFuZCB0aW1lLgovLyBQYXNzIGFuIGVtcHR5IGFycmF5IG9yIFsnKiddIHRvIHNlYXJjaCBvdmVyIGFsbCBqb2IgSURzLgovLyBSZXR1cm5lZCByZXNwb25zZSBjb250YWlucyBhIGV2ZW50cyBwcm9wZXJ0eSwgd2hpY2ggd2lsbCBvbmx5Ci8vIGNvbnRhaW5zIGtleXMgZm9yIGpvYnMgd2hpY2ggaGF2ZSBzY2hlZHVsZWQgZXZlbnRzIGZvciB0aGUgc3BlY2lmaWVkIHRpbWUgcmFuZ2UuCgoKZnVuY3Rpb24gZ2V0U2NoZWR1bGVkRXZlbnRzQnlCdWNrZXQoam9iSWRzLCBlYXJsaWVzdE1zLCBsYXRlc3RNcywgaW50ZXJ2YWwsIG1heEpvYnMsIG1heEV2ZW50cykgewogIHZhciBvYmogPSB7CiAgICBzdWNjZXNzOiB0cnVlLAogICAgZXZlbnRzOiB7fQogIH07IC8vIEJ1aWxkIHRoZSBjcml0ZXJpYSB0byB1c2UgaW4gdGhlIGJvb2wgZmlsdGVyIHBhcnQgb2YgdGhlIHJlcXVlc3QuCiAgLy8gQWRkcyBjcml0ZXJpYSBmb3IgdGhlIHRpbWUgcmFuZ2UgcGx1cyBhbnkgc3BlY2lmaWVkIGpvYiBJRHMuCgogIHZhciBib29sQ3JpdGVyaWEgPSBbewogICAgcmFuZ2U6IHsKICAgICAgdGltZXN0YW1wOiB7CiAgICAgICAgZ3RlOiBlYXJsaWVzdE1zLAogICAgICAgIGx0ZTogbGF0ZXN0TXMsCiAgICAgICAgZm9ybWF0OiAnZXBvY2hfbWlsbGlzJwogICAgICB9CiAgICB9CiAgfSwgewogICAgZXhpc3RzOiB7CiAgICAgIGZpZWxkOiAnc2NoZWR1bGVkX2V2ZW50cycKICAgIH0KICB9XTsKCiAgaWYgKGpvYklkcyAmJiBqb2JJZHMubGVuZ3RoID4gMCAmJiAhKGpvYklkcy5sZW5ndGggPT09IDEgJiYgam9iSWRzWzBdID09PSAnKicpKSB7CiAgICB2YXIgam9iSWRGaWx0ZXJTdHIgPSAnJzsKCiAgICBfbG9kYXNoLmRlZmF1bHQuZWFjaChqb2JJZHMsIGZ1bmN0aW9uIChqb2JJZCwgaSkgewogICAgICBqb2JJZEZpbHRlclN0ciArPSAiIi5jb25jYXQoaSA+IDAgPyAnIE9SICcgOiAnJywgImpvYl9pZDoiKS5jb25jYXQoam9iSWQpOwogICAgfSk7CgogICAgYm9vbENyaXRlcmlhLnB1c2goewogICAgICBxdWVyeV9zdHJpbmc6IHsKICAgICAgICBhbmFseXplX3dpbGRjYXJkOiBmYWxzZSwKICAgICAgICBxdWVyeTogam9iSWRGaWx0ZXJTdHIKICAgICAgfQogICAgfSk7CiAgfQoKICByZXR1cm4gX21sX2FwaV9zZXJ2aWNlLm1sLmVzU2VhcmNoJCh7CiAgICBpbmRleDogX2luZGV4X3BhdHRlcm5zLk1MX1JFU1VMVFNfSU5ERVhfUEFUVEVSTiwKICAgIHNpemU6IDAsCiAgICBib2R5OiB7CiAgICAgIHF1ZXJ5OiB7CiAgICAgICAgYm9vbDogewogICAgICAgICAgZmlsdGVyOiBbewogICAgICAgICAgICBxdWVyeV9zdHJpbmc6IHsKICAgICAgICAgICAgICBxdWVyeTogJ3Jlc3VsdF90eXBlOmJ1Y2tldCcsCiAgICAgICAgICAgICAgYW5hbHl6ZV93aWxkY2FyZDogZmFsc2UKICAgICAgICAgICAgfQogICAgICAgICAgfSwgewogICAgICAgICAgICBib29sOiB7CiAgICAgICAgICAgICAgbXVzdDogYm9vbENyaXRlcmlhCiAgICAgICAgICAgIH0KICAgICAgICAgIH1dCiAgICAgICAgfQogICAgICB9LAogICAgICBhZ2dzOiB7CiAgICAgICAgam9iczogewogICAgICAgICAgdGVybXM6IHsKICAgICAgICAgICAgZmllbGQ6ICdqb2JfaWQnLAogICAgICAgICAgICBtaW5fZG9jX2NvdW50OiAxLAogICAgICAgICAgICBzaXplOiBtYXhKb2JzCiAgICAgICAgICB9LAogICAgICAgICAgYWdnczogewogICAgICAgICAgICB0aW1lczogewogICAgICAgICAgICAgIGRhdGVfaGlzdG9ncmFtOiB7CiAgICAgICAgICAgICAgICBmaWVsZDogJ3RpbWVzdGFtcCcsCiAgICAgICAgICAgICAgICBpbnRlcnZhbDogaW50ZXJ2YWwsCiAgICAgICAgICAgICAgICBtaW5fZG9jX2NvdW50OiAxCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBhZ2dzOiB7CiAgICAgICAgICAgICAgICBldmVudHM6IHsKICAgICAgICAgICAgICAgICAgdGVybXM6IHsKICAgICAgICAgICAgICAgICAgICBmaWVsZDogJ3NjaGVkdWxlZF9ldmVudHMnLAogICAgICAgICAgICAgICAgICAgIHNpemU6IG1heEV2ZW50cwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSkucGlwZSgoMCwgX29wZXJhdG9ycy5tYXApKGZ1bmN0aW9uIChyZXNwKSB7CiAgICB2YXIgZGF0YUJ5Sm9iSWQgPSBfbG9kYXNoLmRlZmF1bHQuZ2V0KHJlc3AsIFsnYWdncmVnYXRpb25zJywgJ2pvYnMnLCAnYnVja2V0cyddLCBbXSk7CgogICAgX2xvZGFzaC5kZWZhdWx0LmVhY2goZGF0YUJ5Sm9iSWQsIGZ1bmN0aW9uIChkYXRhRm9ySm9iKSB7CiAgICAgIHZhciBqb2JJZCA9IGRhdGFGb3JKb2Iua2V5OwogICAgICB2YXIgcmVzdWx0c0ZvclRpbWUgPSB7fTsKCiAgICAgIHZhciBkYXRhQnlUaW1lID0gX2xvZGFzaC5kZWZhdWx0LmdldChkYXRhRm9ySm9iLCBbJ3RpbWVzJywgJ2J1Y2tldHMnXSwgW10pOwoKICAgICAgX2xvZGFzaC5kZWZhdWx0LmVhY2goZGF0YUJ5VGltZSwgZnVuY3Rpb24gKGRhdGFGb3JUaW1lKSB7CiAgICAgICAgdmFyIHRpbWUgPSBkYXRhRm9yVGltZS5rZXk7CgogICAgICAgIHZhciBldmVudHMgPSBfbG9kYXNoLmRlZmF1bHQuZ2V0KGRhdGFGb3JUaW1lLCBbJ2V2ZW50cycsICdidWNrZXRzJ10pOwoKICAgICAgICByZXN1bHRzRm9yVGltZVt0aW1lXSA9IF9sb2Rhc2guZGVmYXVsdC5tYXAoZXZlbnRzLCAna2V5Jyk7CiAgICAgIH0pOwoKICAgICAgb2JqLmV2ZW50c1tqb2JJZF0gPSByZXN1bHRzRm9yVGltZTsKICAgIH0pOwoKICAgIHJldHVybiBvYmo7CiAgfSkpOwp9CgpmdW5jdGlvbiBmZXRjaFBhcnRpdGlvbkZpZWxkc1ZhbHVlcyhqb2JJZCwgc2VhcmNoVGVybSwgY3JpdGVyaWFGaWVsZHMsIGVhcmxpZXN0TXMsIGxhdGVzdE1zKSB7CiAgcmV0dXJuIF9tbF9hcGlfc2VydmljZS5tbC5yZXN1bHRzLmZldGNoUGFydGl0aW9uRmllbGRzVmFsdWVzKGpvYklkLCBzZWFyY2hUZXJtLCBjcml0ZXJpYUZpZWxkcywgZWFybGllc3RNcywgbGF0ZXN0TXMpOwp9"},null]}