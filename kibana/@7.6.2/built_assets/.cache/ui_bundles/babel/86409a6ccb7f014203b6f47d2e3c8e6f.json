{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/siem/public/pages/detection_engine/rules/all/index.js","dependencies":[{"path":"x-pack/legacy/plugins/siem/public/pages/detection_engine/rules/all/index.js","mtime":1585205047863},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkFsbFJ1bGVzID0gdm9pZCAwOwoKdmFyIF9ldWkgPSByZXF1aXJlKCJAZWxhc3RpYy9ldWkiKTsKCnZhciBfcmVhY3QgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKCJyZWFjdCIpKTsKCnZhciBfcmVhY3RSb3V0ZXJEb20gPSByZXF1aXJlKCJyZWFjdC1yb3V0ZXItZG9tIik7Cgp2YXIgX3N0eWxlZENvbXBvbmVudHMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoInN0eWxlZC1jb21wb25lbnRzIikpOwoKdmFyIF91dWlkID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJ1dWlkIikpOwoKdmFyIF9ydWxlcyA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL2NvbnRhaW5lcnMvZGV0ZWN0aW9uX2VuZ2luZS9ydWxlcyIpOwoKdmFyIF9oZWFkZXJfc2VjdGlvbiA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL2NvbXBvbmVudHMvaGVhZGVyX3NlY3Rpb24iKTsKCnZhciBfdXRpbGl0eV9iYXIgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9jb21wb25lbnRzL2RldGVjdGlvbl9lbmdpbmUvdXRpbGl0eV9iYXIiKTsKCnZhciBfdG9hc3RlcnMgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9jb21wb25lbnRzL3RvYXN0ZXJzIik7Cgp2YXIgX2xvYWRlciA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL2NvbXBvbmVudHMvbG9hZGVyIik7Cgp2YXIgX3BhbmVsID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vY29tcG9uZW50cy9wYW5lbCIpOwoKdmFyIF9sb2FkX2VtcHR5X3Byb21wdCA9IHJlcXVpcmUoIi4uL2NvbXBvbmVudHMvcHJlX3BhY2thZ2VkX3J1bGVzL2xvYWRfZW1wdHlfcHJvbXB0Iik7Cgp2YXIgX3J1bGVfZG93bmxvYWRlciA9IHJlcXVpcmUoIi4uL2NvbXBvbmVudHMvcnVsZV9kb3dubG9hZGVyIik7Cgp2YXIgX2hlbHBlcnMgPSByZXF1aXJlKCIuLi9oZWxwZXJzIik7Cgp2YXIgaTE4biA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoIi4uL3RyYW5zbGF0aW9ucyIpKTsKCnZhciBfYmF0Y2hfYWN0aW9ucyA9IHJlcXVpcmUoIi4vYmF0Y2hfYWN0aW9ucyIpOwoKdmFyIF9jb2x1bW5zID0gcmVxdWlyZSgiLi9jb2x1bW5zIik7Cgp2YXIgX2hlbHBlcnMyID0gcmVxdWlyZSgiLi9oZWxwZXJzIik7Cgp2YXIgX3JlZHVjZXIgPSByZXF1aXJlKCIuL3JlZHVjZXIiKTsKCnZhciBfcnVsZXNfdGFibGVfZmlsdGVycyA9IHJlcXVpcmUoIi4vcnVsZXNfdGFibGVfZmlsdGVycy9ydWxlc190YWJsZV9maWx0ZXJzIik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgewogIHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7CiAgICBkZWZhdWx0OiBvYmoKICB9Owp9CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsKICBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7CiAgICByZXR1cm4gb2JqOwogIH0gZWxzZSB7CiAgICB2YXIgbmV3T2JqID0ge307CgogICAgaWYgKG9iaiAhPSBudWxsKSB7CiAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHsKICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgewogICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvciA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpIDoge307CgogICAgICAgICAgaWYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSB7CiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmosIGtleSwgZGVzYyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBuZXdPYmpba2V5XSA9IG9ialtrZXldOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIG5ld09iai5kZWZhdWx0ID0gb2JqOwogICAgcmV0dXJuIG5ld09iajsKICB9Cn0KCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgewogIHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsKCiAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsKICAgIHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOwogICAgaWYgKGVudW1lcmFibGVPbmx5KSBzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgewogICAgICByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsKICAgIH0pOwogICAga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOwogIH0KCiAgcmV0dXJuIGtleXM7Cn0KCmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7CiAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsKICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OwoKICAgIGlmIChpICUgMikgewogICAgICBvd25LZXlzKHNvdXJjZSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7CiAgICAgIH0pOwogICAgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgewogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpOwogICAgfSBlbHNlIHsKICAgICAgb3duS2V5cyhzb3VyY2UpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOwogICAgICB9KTsKICAgIH0KICB9CgogIHJldHVybiB0YXJnZXQ7Cn0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsKICBpZiAoa2V5IGluIG9iaikgewogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7CiAgICAgIHZhbHVlOiB2YWx1ZSwKICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICB3cml0YWJsZTogdHJ1ZQogICAgfSk7CiAgfSBlbHNlIHsKICAgIG9ialtrZXldID0gdmFsdWU7CiAgfQoKICByZXR1cm4gb2JqOwp9CgpmdW5jdGlvbiBfc2xpY2VkVG9BcnJheShhcnIsIGkpIHsKICByZXR1cm4gX2FycmF5V2l0aEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgfHwgX25vbkl0ZXJhYmxlUmVzdCgpOwp9CgpmdW5jdGlvbiBfbm9uSXRlcmFibGVSZXN0KCkgewogIHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2UiKTsKfQoKZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgewogIHZhciBfYXJyID0gW107CiAgdmFyIF9uID0gdHJ1ZTsKICB2YXIgX2QgPSBmYWxzZTsKICB2YXIgX2UgPSB1bmRlZmluZWQ7CgogIHRyeSB7CiAgICBmb3IgKHZhciBfaSA9IGFycltTeW1ib2wuaXRlcmF0b3JdKCksIF9zOyAhKF9uID0gKF9zID0gX2kubmV4dCgpKS5kb25lKTsgX24gPSB0cnVlKSB7CiAgICAgIF9hcnIucHVzaChfcy52YWx1ZSk7CgogICAgICBpZiAoaSAmJiBfYXJyLmxlbmd0aCA9PT0gaSkgYnJlYWs7CiAgICB9CiAgfSBjYXRjaCAoZXJyKSB7CiAgICBfZCA9IHRydWU7CiAgICBfZSA9IGVycjsKICB9IGZpbmFsbHkgewogICAgdHJ5IHsKICAgICAgaWYgKCFfbiAmJiBfaVsicmV0dXJuIl0gIT0gbnVsbCkgX2lbInJldHVybiJdKCk7CiAgICB9IGZpbmFsbHkgewogICAgICBpZiAoX2QpIHRocm93IF9lOwogICAgfQogIH0KCiAgcmV0dXJuIF9hcnI7Cn0KCmZ1bmN0aW9uIF9hcnJheVdpdGhIb2xlcyhhcnIpIHsKICBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSByZXR1cm4gYXJyOwp9IC8vIEV1aUJhc2ljVGFibGUgZ2l2ZSBtZSBhIGhhcmR0aW1lIHdpdGggYWRkaW5nIHRoZSByZWYgYXR0cmlidXRlcyBzbyBJIHdlbnQgdGhlIGVhc3kgd2F5Ci8vIGFmdGVyIGZldyBob3VycyBvZiBmaWdodCB3aXRoIHR5cGVzY3JpcHQgISEhISBJIGxvc3QgOigKLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnkKCgp2YXIgTXlFdWlCYXNpY1RhYmxlID0gKDAsIF9zdHlsZWRDb21wb25lbnRzLmRlZmF1bHQpKF9ldWkuRXVpQmFzaWNUYWJsZSkud2l0aENvbmZpZyh7CiAgZGlzcGxheU5hbWU6ICJNeUV1aUJhc2ljVGFibGUiLAogIGNvbXBvbmVudElkOiAic2MtMnJmb2FlLTAiCn0pKFsiIl0pOwp2YXIgaW5pdGlhbFN0YXRlID0gewogIGV4cG9ydFJ1bGVJZHM6IFtdLAogIGZpbHRlck9wdGlvbnM6IHsKICAgIGZpbHRlcjogJycsCiAgICBzb3J0RmllbGQ6ICdlbmFibGVkJywKICAgIHNvcnRPcmRlcjogJ2Rlc2MnCiAgfSwKICBsb2FkaW5nUnVsZUlkczogW10sCiAgbG9hZGluZ1J1bGVzQWN0aW9uOiBudWxsLAogIHBhZ2luYXRpb246IHsKICAgIHBhZ2U6IDEsCiAgICBwZXJQYWdlOiAyMCwKICAgIHRvdGFsOiAwCiAgfSwKICBydWxlczogW10sCiAgc2VsZWN0ZWRSdWxlSWRzOiBbXQp9OwovKioKICogVGFibGUgQ29tcG9uZW50IGZvciBkaXNwbGF5aW5nIGFsbCBSdWxlcyBmb3IgYSBnaXZlbiBjbHVzdGVyLiBQcm92aWRlcyB0aGUgYWJpbGl0eSB0byBmaWx0ZXIKICogYnkgbmFtZSwgc29ydCBieSBlbmFibGVkLCBhbmQgcGVyZm9ybSB0aGUgZm9sbG93aW5nIGFjdGlvbnM6CiAqICAgKiBFbmFibGUvRGlzYWJsZQogKiAgICogRHVwbGljYXRlCiAqICAgKiBEZWxldGUKICogICAqIEltcG9ydC9FeHBvcnQKICovCgp2YXIgQWxsUnVsZXMgPSBfcmVhY3QuZGVmYXVsdC5tZW1vKGZ1bmN0aW9uIChfcmVmKSB7CiAgdmFyIF9wYWdpbmF0aW9uJHRvdGFsLCBfcmVmNDsKCiAgdmFyIGNyZWF0ZVByZVBhY2thZ2VkUnVsZXMgPSBfcmVmLmNyZWF0ZVByZVBhY2thZ2VkUnVsZXMsCiAgICAgIGhhc05vUGVybWlzc2lvbnMgPSBfcmVmLmhhc05vUGVybWlzc2lvbnMsCiAgICAgIGxvYWRpbmcgPSBfcmVmLmxvYWRpbmcsCiAgICAgIGxvYWRpbmdDcmVhdGVQcmVQYWNrYWdlZFJ1bGVzID0gX3JlZi5sb2FkaW5nQ3JlYXRlUHJlUGFja2FnZWRSdWxlcywKICAgICAgcmVmZXRjaFByZVBhY2thZ2VkUnVsZXNTdGF0dXMgPSBfcmVmLnJlZmV0Y2hQcmVQYWNrYWdlZFJ1bGVzU3RhdHVzLAogICAgICBydWxlc0N1c3RvbUluc3RhbGxlZCA9IF9yZWYucnVsZXNDdXN0b21JbnN0YWxsZWQsCiAgICAgIHJ1bGVzSW5zdGFsbGVkID0gX3JlZi5ydWxlc0luc3RhbGxlZCwKICAgICAgcnVsZXNOb3RJbnN0YWxsZWQgPSBfcmVmLnJ1bGVzTm90SW5zdGFsbGVkLAogICAgICBydWxlc05vdFVwZGF0ZWQgPSBfcmVmLnJ1bGVzTm90VXBkYXRlZCwKICAgICAgc2V0UmVmcmVzaFJ1bGVzRGF0YSA9IF9yZWYuc2V0UmVmcmVzaFJ1bGVzRGF0YTsKCiAgdmFyIF91c2VTdGF0ZSA9ICgwLCBfcmVhY3QudXNlU3RhdGUpKHRydWUpLAogICAgICBfdXNlU3RhdGUyID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlLCAyKSwKICAgICAgaW5pdExvYWRpbmcgPSBfdXNlU3RhdGUyWzBdLAogICAgICBzZXRJbml0TG9hZGluZyA9IF91c2VTdGF0ZTJbMV07CgogIHZhciB0YWJsZVJlZiA9ICgwLCBfcmVhY3QudXNlUmVmKSgpOwoKICB2YXIgX3VzZVJlZHVjZXIgPSAoMCwgX3JlYWN0LnVzZVJlZHVjZXIpKCgwLCBfcmVkdWNlci5hbGxSdWxlc1JlZHVjZXIpKHRhYmxlUmVmKSwgaW5pdGlhbFN0YXRlKSwKICAgICAgX3VzZVJlZHVjZXIyID0gX3NsaWNlZFRvQXJyYXkoX3VzZVJlZHVjZXIsIDIpLAogICAgICBfdXNlUmVkdWNlcjIkID0gX3VzZVJlZHVjZXIyWzBdLAogICAgICBleHBvcnRSdWxlSWRzID0gX3VzZVJlZHVjZXIyJC5leHBvcnRSdWxlSWRzLAogICAgICBmaWx0ZXJPcHRpb25zID0gX3VzZVJlZHVjZXIyJC5maWx0ZXJPcHRpb25zLAogICAgICBsb2FkaW5nUnVsZUlkcyA9IF91c2VSZWR1Y2VyMiQubG9hZGluZ1J1bGVJZHMsCiAgICAgIGxvYWRpbmdSdWxlc0FjdGlvbiA9IF91c2VSZWR1Y2VyMiQubG9hZGluZ1J1bGVzQWN0aW9uLAogICAgICBwYWdpbmF0aW9uID0gX3VzZVJlZHVjZXIyJC5wYWdpbmF0aW9uLAogICAgICBydWxlcyA9IF91c2VSZWR1Y2VyMiQucnVsZXMsCiAgICAgIHNlbGVjdGVkUnVsZUlkcyA9IF91c2VSZWR1Y2VyMiQuc2VsZWN0ZWRSdWxlSWRzLAogICAgICBkaXNwYXRjaCA9IF91c2VSZWR1Y2VyMlsxXTsKCiAgdmFyIGhpc3RvcnkgPSAoMCwgX3JlYWN0Um91dGVyRG9tLnVzZUhpc3RvcnkpKCk7CgogIHZhciBfdXNlU3RhdGVUb2FzdGVyID0gKDAsIF90b2FzdGVycy51c2VTdGF0ZVRvYXN0ZXIpKCksCiAgICAgIF91c2VTdGF0ZVRvYXN0ZXIyID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlVG9hc3RlciwgMiksCiAgICAgIGRpc3BhdGNoVG9hc3RlciA9IF91c2VTdGF0ZVRvYXN0ZXIyWzFdOwoKICB2YXIgc2V0UnVsZXMgPSAoMCwgX3JlYWN0LnVzZUNhbGxiYWNrKShmdW5jdGlvbiAobmV3UnVsZXMsIG5ld1BhZ2luYXRpb24pIHsKICAgIGRpc3BhdGNoKHsKICAgICAgdHlwZTogJ3NldFJ1bGVzJywKICAgICAgcnVsZXM6IG5ld1J1bGVzLAogICAgICBwYWdpbmF0aW9uOiBuZXdQYWdpbmF0aW9uCiAgICB9KTsKICB9LCBbXSk7CgogIHZhciBfdXNlUnVsZXMgPSAoMCwgX3J1bGVzLnVzZVJ1bGVzKSh7CiAgICBwYWdpbmF0aW9uOiBwYWdpbmF0aW9uLAogICAgZmlsdGVyT3B0aW9uczogZmlsdGVyT3B0aW9ucywKICAgIHJlZmV0Y2hQcmVQYWNrYWdlZFJ1bGVzU3RhdHVzOiByZWZldGNoUHJlUGFja2FnZWRSdWxlc1N0YXR1cywKICAgIGRpc3BhdGNoUnVsZXNJblJlZHVjZXI6IHNldFJ1bGVzCiAgfSksCiAgICAgIF91c2VSdWxlczIgPSBfc2xpY2VkVG9BcnJheShfdXNlUnVsZXMsIDMpLAogICAgICBpc0xvYWRpbmdSdWxlcyA9IF91c2VSdWxlczJbMF0sCiAgICAgIHJlRmV0Y2hSdWxlc0RhdGEgPSBfdXNlUnVsZXMyWzJdOwoKICB2YXIgcHJlUGFja2FnZWRSdWxlU3RhdHVzID0gKDAsIF9oZWxwZXJzLmdldFByZVBhY2thZ2VkUnVsZVN0YXR1cykocnVsZXNJbnN0YWxsZWQsIHJ1bGVzTm90SW5zdGFsbGVkLCBydWxlc05vdFVwZGF0ZWQpOwogIHZhciBnZXRCYXRjaEl0ZW1zUG9wb3ZlckNvbnRlbnQgPSAoMCwgX3JlYWN0LnVzZUNhbGxiYWNrKShmdW5jdGlvbiAoY2xvc2VQb3BvdmVyKSB7CiAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUNvbnRleHRNZW51UGFuZWwsIHsKICAgICAgaXRlbXM6ICgwLCBfYmF0Y2hfYWN0aW9ucy5nZXRCYXRjaEl0ZW1zKSh7CiAgICAgICAgY2xvc2VQb3BvdmVyOiBjbG9zZVBvcG92ZXIsCiAgICAgICAgZGlzcGF0Y2g6IGRpc3BhdGNoLAogICAgICAgIGRpc3BhdGNoVG9hc3RlcjogZGlzcGF0Y2hUb2FzdGVyLAogICAgICAgIGxvYWRpbmdSdWxlSWRzOiBsb2FkaW5nUnVsZUlkcywKICAgICAgICBzZWxlY3RlZFJ1bGVJZHM6IHNlbGVjdGVkUnVsZUlkcywKICAgICAgICByZUZldGNoUnVsZXM6IHJlRmV0Y2hSdWxlc0RhdGEsCiAgICAgICAgcnVsZXM6IHJ1bGVzCiAgICAgIH0pCiAgICB9KTsKICB9LCBbZGlzcGF0Y2gsIGRpc3BhdGNoVG9hc3RlciwgbG9hZGluZ1J1bGVJZHMsIHJlRmV0Y2hSdWxlc0RhdGEsIHJ1bGVzLCBzZWxlY3RlZFJ1bGVJZHNdKTsKICB2YXIgdGFibGVPbkNoYW5nZUNhbGxiYWNrID0gKDAsIF9yZWFjdC51c2VDYWxsYmFjaykoZnVuY3Rpb24gKF9yZWYyKSB7CiAgICB2YXIgX3JlZjM7CgogICAgdmFyIHBhZ2UgPSBfcmVmMi5wYWdlLAogICAgICAgIHNvcnQgPSBfcmVmMi5zb3J0OwogICAgZGlzcGF0Y2goewogICAgICB0eXBlOiAndXBkYXRlRmlsdGVyT3B0aW9ucycsCiAgICAgIGZpbHRlck9wdGlvbnM6IHsKICAgICAgICBzb3J0RmllbGQ6ICdlbmFibGVkJywKICAgICAgICAvLyBPbmx5IGVuYWJsZWQgaXMgc3VwcG9ydGVkIGZvciBzb3J0aW5nIGN1cnJlbnRseQogICAgICAgIHNvcnRPcmRlcjogKF9yZWYzID0gc29ydCA9PT0gbnVsbCB8fCBzb3J0ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzb3J0LmRpcmVjdGlvbikgIT09IG51bGwgJiYgX3JlZjMgIT09IHZvaWQgMCA/IF9yZWYzIDogJ2Rlc2MnCiAgICAgIH0sCiAgICAgIHBhZ2luYXRpb246IHsKICAgICAgICBwYWdlOiBwYWdlLmluZGV4ICsgMSwKICAgICAgICBwZXJQYWdlOiBwYWdlLnNpemUKICAgICAgfQogICAgfSk7CiAgfSwgW2Rpc3BhdGNoXSk7CiAgdmFyIGNvbHVtbnMgPSAoMCwgX3JlYWN0LnVzZU1lbW8pKGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiAoMCwgX2NvbHVtbnMuZ2V0Q29sdW1ucykoewogICAgICBkaXNwYXRjaDogZGlzcGF0Y2gsCiAgICAgIGRpc3BhdGNoVG9hc3RlcjogZGlzcGF0Y2hUb2FzdGVyLAogICAgICBoaXN0b3J5OiBoaXN0b3J5LAogICAgICBoYXNOb1Blcm1pc3Npb25zOiBoYXNOb1Blcm1pc3Npb25zLAogICAgICBsb2FkaW5nUnVsZUlkczogbG9hZGluZ1J1bGVzQWN0aW9uICE9IG51bGwgJiYgKGxvYWRpbmdSdWxlc0FjdGlvbiA9PT0gJ2VuYWJsZScgfHwgbG9hZGluZ1J1bGVzQWN0aW9uID09PSAnZGlzYWJsZScpID8gbG9hZGluZ1J1bGVJZHMgOiBbXSwKICAgICAgcmVGZXRjaFJ1bGVzOiByZUZldGNoUnVsZXNEYXRhCiAgICB9KTsKICB9LCBbZGlzcGF0Y2gsIGRpc3BhdGNoVG9hc3RlciwgaGlzdG9yeSwgbG9hZGluZ1J1bGVJZHMsIGxvYWRpbmdSdWxlc0FjdGlvbiwgcmVGZXRjaFJ1bGVzRGF0YV0pOwogICgwLCBfcmVhY3QudXNlRWZmZWN0KShmdW5jdGlvbiAoKSB7CiAgICBpZiAocmVGZXRjaFJ1bGVzRGF0YSAhPSBudWxsKSB7CiAgICAgIHNldFJlZnJlc2hSdWxlc0RhdGEocmVGZXRjaFJ1bGVzRGF0YSk7CiAgICB9CiAgfSwgW3JlRmV0Y2hSdWxlc0RhdGEsIHNldFJlZnJlc2hSdWxlc0RhdGFdKTsKICAoMCwgX3JlYWN0LnVzZUVmZmVjdCkoZnVuY3Rpb24gKCkgewogICAgaWYgKGluaXRMb2FkaW5nICYmICFsb2FkaW5nICYmICFpc0xvYWRpbmdSdWxlcykgewogICAgICBzZXRJbml0TG9hZGluZyhmYWxzZSk7CiAgICB9CiAgfSwgW2luaXRMb2FkaW5nLCBsb2FkaW5nLCBpc0xvYWRpbmdSdWxlc10pOwogIHZhciBoYW5kbGVDcmVhdGVQcmVQYWNrYWdlZFJ1bGVzID0gKDAsIF9yZWFjdC51c2VDYWxsYmFjaykoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXN5bmMoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIGlmICghKGNyZWF0ZVByZVBhY2thZ2VkUnVsZXMgIT0gbnVsbCAmJiByZUZldGNoUnVsZXNEYXRhICE9IG51bGwpKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDQ7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzOwogICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKGNyZWF0ZVByZVBhY2thZ2VkUnVsZXMoKSk7CgogICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICByZUZldGNoUnVsZXNEYXRhKHRydWUpOwoKICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9KTsKICB9LCBbY3JlYXRlUHJlUGFja2FnZWRSdWxlcywgcmVGZXRjaFJ1bGVzRGF0YV0pOwogIHZhciBldWlCYXNpY1RhYmxlU2VsZWN0aW9uUHJvcHMgPSAoMCwgX3JlYWN0LnVzZU1lbW8pKGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiB7CiAgICAgIHNlbGVjdGFibGU6IGZ1bmN0aW9uIHNlbGVjdGFibGUoaXRlbSkgewogICAgICAgIHJldHVybiAhbG9hZGluZ1J1bGVJZHMuaW5jbHVkZXMoaXRlbS5pZCk7CiAgICAgIH0sCiAgICAgIG9uU2VsZWN0aW9uQ2hhbmdlOiBmdW5jdGlvbiBvblNlbGVjdGlvbkNoYW5nZShzZWxlY3RlZCkgewogICAgICAgIHJldHVybiBkaXNwYXRjaCh7CiAgICAgICAgICB0eXBlOiAnc2VsZWN0ZWRSdWxlSWRzJywKICAgICAgICAgIGlkczogc2VsZWN0ZWQubWFwKGZ1bmN0aW9uIChyKSB7CiAgICAgICAgICAgIHJldHVybiByLmlkOwogICAgICAgICAgfSkKICAgICAgICB9KTsKICAgICAgfQogICAgfTsKICB9LCBbbG9hZGluZ1J1bGVJZHNdKTsKICB2YXIgb25GaWx0ZXJDaGFuZ2VkQ2FsbGJhY2sgPSAoMCwgX3JlYWN0LnVzZUNhbGxiYWNrKShmdW5jdGlvbiAobmV3RmlsdGVyT3B0aW9ucykgewogICAgZGlzcGF0Y2goewogICAgICB0eXBlOiAndXBkYXRlRmlsdGVyT3B0aW9ucycsCiAgICAgIGZpbHRlck9wdGlvbnM6IF9vYmplY3RTcHJlYWQoe30sIG5ld0ZpbHRlck9wdGlvbnMpLAogICAgICBwYWdpbmF0aW9uOiB7CiAgICAgICAgcGFnZTogMQogICAgICB9CiAgICB9KTsKICB9LCBbXSk7CiAgdmFyIGVtcHR5UHJvbXB0ID0gKDAsIF9yZWFjdC51c2VNZW1vKShmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUVtcHR5UHJvbXB0LCB7CiAgICAgIHRpdGxlOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJoMyIsIG51bGwsIGkxOG4uTk9fUlVMRVMpLAogICAgICB0aXRsZVNpemU6ICJ4cyIsCiAgICAgIGJvZHk6IGkxOG4uTk9fUlVMRVNfQk9EWQogICAgfSk7CiAgfSwgW10pOwogIHZhciBpc0xvYWRpbmdBbkFjdGlvbk9uUnVsZSA9ICgwLCBfcmVhY3QudXNlTWVtbykoZnVuY3Rpb24gKCkgewogICAgaWYgKGxvYWRpbmdSdWxlSWRzLmxlbmd0aCA+IDAgJiYgKGxvYWRpbmdSdWxlc0FjdGlvbiA9PT0gJ2Rpc2FibGUnIHx8IGxvYWRpbmdSdWxlc0FjdGlvbiA9PT0gJ2VuYWJsZScpKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0gZWxzZSBpZiAobG9hZGluZ1J1bGVJZHMubGVuZ3RoID4gMCkgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICByZXR1cm4gZmFsc2U7CiAgfSwgW2xvYWRpbmdSdWxlSWRzLCBsb2FkaW5nUnVsZXNBY3Rpb25dKTsKICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuZGVmYXVsdC5GcmFnbWVudCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcnVsZV9kb3dubG9hZGVyLlJ1bGVEb3dubG9hZGVyLCB7CiAgICBmaWxlbmFtZTogIiIuY29uY2F0KGkxOG4uRVhQT1JUX0ZJTEVOQU1FLCAiLm5kanNvbiIpLAogICAgcnVsZUlkczogZXhwb3J0UnVsZUlkcywKICAgIG9uRXhwb3J0Q29tcGxldGU6IGZ1bmN0aW9uIG9uRXhwb3J0Q29tcGxldGUoZXhwb3J0Q291bnQpIHsKICAgICAgZGlzcGF0Y2goewogICAgICAgIHR5cGU6ICdsb2FkaW5nUnVsZUlkcycsCiAgICAgICAgaWRzOiBbXSwKICAgICAgICBhY3Rpb25UeXBlOiBudWxsCiAgICAgIH0pOwogICAgICBkaXNwYXRjaFRvYXN0ZXIoewogICAgICAgIHR5cGU6ICdhZGRUb2FzdGVyJywKICAgICAgICB0b2FzdDogewogICAgICAgICAgaWQ6IF91dWlkLmRlZmF1bHQudjQoKSwKICAgICAgICAgIHRpdGxlOiBpMThuLlNVQ0NFU1NGVUxMWV9FWFBPUlRFRF9SVUxFUyhleHBvcnRDb3VudCksCiAgICAgICAgICBjb2xvcjogJ3N1Y2Nlc3MnLAogICAgICAgICAgaWNvblR5cGU6ICdjaGVjaycKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0pLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3BhY2VyLCBudWxsKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcGFuZWwuUGFuZWwsIHsKICAgIGxvYWRpbmc6IGxvYWRpbmcgfHwgaXNMb2FkaW5nUnVsZXMKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5kZWZhdWx0LkZyYWdtZW50LCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9oZWFkZXJfc2VjdGlvbi5IZWFkZXJTZWN0aW9uLCB7CiAgICBzcGxpdDogdHJ1ZSwKICAgIHRpdGxlOiBpMThuLkFMTF9SVUxFUwogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3J1bGVzX3RhYmxlX2ZpbHRlcnMuUnVsZXNUYWJsZUZpbHRlcnMsIHsKICAgIG9uRmlsdGVyQ2hhbmdlZDogb25GaWx0ZXJDaGFuZ2VkQ2FsbGJhY2ssCiAgICBydWxlc0N1c3RvbUluc3RhbGxlZDogcnVsZXNDdXN0b21JbnN0YWxsZWQsCiAgICBydWxlc0luc3RhbGxlZDogcnVsZXNJbnN0YWxsZWQKICB9KSksIChsb2FkaW5nIHx8IGlzTG9hZGluZ1J1bGVzIHx8IGlzTG9hZGluZ0FuQWN0aW9uT25SdWxlKSAmJiAhaW5pdExvYWRpbmcgJiYgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfbG9hZGVyLkxvYWRlciwgewogICAgImRhdGEtdGVzdC1zdWJqIjogImxvYWRpbmdQYW5lbEFsbFJ1bGVzVGFibGUiLAogICAgb3ZlcmxheTogdHJ1ZSwKICAgIHNpemU6ICJ4bCIKICB9KSwgcnVsZXNDdXN0b21JbnN0YWxsZWQgIT0gbnVsbCAmJiBydWxlc0N1c3RvbUluc3RhbGxlZCA9PT0gMCAmJiBwcmVQYWNrYWdlZFJ1bGVTdGF0dXMgPT09ICdydWxlTm90SW5zdGFsbGVkJyAmJiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9sb2FkX2VtcHR5X3Byb21wdC5QcmVQYWNrYWdlZFJ1bGVzUHJvbXB0LCB7CiAgICBjcmVhdGVQcmVQYWNrYWdlZFJ1bGVzOiBoYW5kbGVDcmVhdGVQcmVQYWNrYWdlZFJ1bGVzLAogICAgbG9hZGluZzogbG9hZGluZ0NyZWF0ZVByZVBhY2thZ2VkUnVsZXMsCiAgICB1c2VySGFzTm9QZXJtaXNzaW9uczogaGFzTm9QZXJtaXNzaW9ucwogIH0pLCBpbml0TG9hZGluZyAmJiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpTG9hZGluZ0NvbnRlbnQsIHsKICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJpbml0aWFsTG9hZGluZ1BhbmVsQWxsUnVsZXNUYWJsZSIsCiAgICBsaW5lczogMTAKICB9KSwgKDAsIF9oZWxwZXJzMi5zaG93UnVsZXNUYWJsZSkoewogICAgcnVsZXNDdXN0b21JbnN0YWxsZWQ6IHJ1bGVzQ3VzdG9tSW5zdGFsbGVkLAogICAgcnVsZXNJbnN0YWxsZWQ6IHJ1bGVzSW5zdGFsbGVkCiAgfSkgJiYgIWluaXRMb2FkaW5nICYmIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LmRlZmF1bHQuRnJhZ21lbnQsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3V0aWxpdHlfYmFyLlV0aWxpdHlCYXIsIHsKICAgIGJvcmRlcjogdHJ1ZQogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3V0aWxpdHlfYmFyLlV0aWxpdHlCYXJTZWN0aW9uLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF91dGlsaXR5X2Jhci5VdGlsaXR5QmFyR3JvdXAsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3V0aWxpdHlfYmFyLlV0aWxpdHlCYXJUZXh0LCBudWxsLCBpMThuLlNIT1dJTkdfUlVMRVMoKF9wYWdpbmF0aW9uJHRvdGFsID0gcGFnaW5hdGlvbi50b3RhbCkgIT09IG51bGwgJiYgX3BhZ2luYXRpb24kdG90YWwgIT09IHZvaWQgMCA/IF9wYWdpbmF0aW9uJHRvdGFsIDogMCkpKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfdXRpbGl0eV9iYXIuVXRpbGl0eUJhckdyb3VwLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF91dGlsaXR5X2Jhci5VdGlsaXR5QmFyVGV4dCwgbnVsbCwgaTE4bi5TRUxFQ1RFRF9SVUxFUyhzZWxlY3RlZFJ1bGVJZHMubGVuZ3RoKSksICFoYXNOb1Blcm1pc3Npb25zICYmIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3V0aWxpdHlfYmFyLlV0aWxpdHlCYXJBY3Rpb24sIHsKICAgIGljb25TaWRlOiAicmlnaHQiLAogICAgaWNvblR5cGU6ICJhcnJvd0Rvd24iLAogICAgcG9wb3ZlckNvbnRlbnQ6IGdldEJhdGNoSXRlbXNQb3BvdmVyQ29udGVudAogIH0sIGkxOG4uQkFUQ0hfQUNUSU9OUyksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3V0aWxpdHlfYmFyLlV0aWxpdHlCYXJBY3Rpb24sIHsKICAgIGljb25TaWRlOiAibGVmdCIsCiAgICBpY29uVHlwZTogInJlZnJlc2giLAogICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHsKICAgICAgcmV0dXJuIHJlRmV0Y2hSdWxlc0RhdGEodHJ1ZSk7CiAgICB9CiAgfSwgaTE4bi5SRUZSRVNIKSkpKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChNeUV1aUJhc2ljVGFibGUsIHsKICAgIGNvbHVtbnM6IGNvbHVtbnMsCiAgICBpc1NlbGVjdGFibGU6IChfcmVmNCA9ICFoYXNOb1Blcm1pc3Npb25zKSAhPT0gbnVsbCAmJiBfcmVmNCAhPT0gdm9pZCAwID8gX3JlZjQgOiBmYWxzZSwKICAgIGl0ZW1JZDogImlkIiwKICAgIGl0ZW1zOiBydWxlcyAhPT0gbnVsbCAmJiBydWxlcyAhPT0gdm9pZCAwID8gcnVsZXMgOiBbXSwKICAgIG5vSXRlbXNNZXNzYWdlOiBlbXB0eVByb21wdCwKICAgIG9uQ2hhbmdlOiB0YWJsZU9uQ2hhbmdlQ2FsbGJhY2ssCiAgICBwYWdpbmF0aW9uOiB7CiAgICAgIHBhZ2VJbmRleDogcGFnaW5hdGlvbi5wYWdlIC0gMSwKICAgICAgcGFnZVNpemU6IHBhZ2luYXRpb24ucGVyUGFnZSwKICAgICAgdG90YWxJdGVtQ291bnQ6IHBhZ2luYXRpb24udG90YWwsCiAgICAgIHBhZ2VTaXplT3B0aW9uczogWzUsIDEwLCAyMCwgNTAsIDEwMCwgMjAwLCAzMDBdCiAgICB9LAogICAgcmVmOiB0YWJsZVJlZiwKICAgIHNvcnRpbmc6IHsKICAgICAgc29ydDogewogICAgICAgIGZpZWxkOiAnZW5hYmxlZCcsCiAgICAgICAgZGlyZWN0aW9uOiBmaWx0ZXJPcHRpb25zLnNvcnRPcmRlcgogICAgICB9CiAgICB9LAogICAgc2VsZWN0aW9uOiBoYXNOb1Blcm1pc3Npb25zID8gdW5kZWZpbmVkIDogZXVpQmFzaWNUYWJsZVNlbGVjdGlvblByb3BzCiAgfSkpKSkpOwp9KTsKCmV4cG9ydHMuQWxsUnVsZXMgPSBBbGxSdWxlczsKQWxsUnVsZXMuZGlzcGxheU5hbWUgPSAnQWxsUnVsZXMnOw=="},null]}