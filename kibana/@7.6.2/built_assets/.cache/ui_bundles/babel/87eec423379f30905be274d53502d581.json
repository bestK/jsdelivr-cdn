{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/siem/public/pages/detection_engine/components/signals/actions.js","dependencies":[{"path":"x-pack/legacy/plugins/siem/public/pages/detection_engine/components/signals/actions.js","mtime":1585205047851},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLnNlbmRTaWduYWxUb1RpbWVsaW5lQWN0aW9uID0gZXhwb3J0cy51cGRhdGVTaWduYWxTdGF0dXNBY3Rpb24gPSBleHBvcnRzLmdldEZpbHRlckFuZFJ1bGVCb3VuZHMgPSBleHBvcnRzLmdldFVwZGF0ZVNpZ25hbHNRdWVyeSA9IHZvaWQgMDsKCnZhciBfZGF0ZW1hdGggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIkBlbGFzdGljL2RhdGVtYXRoIikpOwoKdmFyIF9mcCA9IHJlcXVpcmUoImxvZGFzaC9mcCIpOwoKdmFyIF9tb21lbnQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIm1vbWVudCIpKTsKCnZhciBfYXBpID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vY29udGFpbmVycy9kZXRlY3Rpb25fZW5naW5lL3NpZ25hbHMvYXBpIik7Cgp2YXIgX2luZGV4ID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vY29udGFpbmVycy90aW1lbGluZS9vbmUvaW5kZXguZ3FsX3F1ZXJ5Iik7Cgp2YXIgX2hlbHBlcnMgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9jb21wb25lbnRzL29wZW5fdGltZWxpbmUvaGVscGVycyIpOwoKdmFyIF9rZXVyeSA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL2xpYi9rZXVyeSIpOwoKdmFyIF9kZWZhdWx0cyA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL3N0b3JlL3RpbWVsaW5lL2RlZmF1bHRzIik7Cgp2YXIgX2hlbHBlcnMyID0gcmVxdWlyZSgiLi9oZWxwZXJzIik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgewogIHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7CiAgICBkZWZhdWx0OiBvYmoKICB9Owp9CgpmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsKICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7CgogIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7CiAgICB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsKICAgIGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsKICAgICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7CiAgICB9KTsKICAgIGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsKICB9CgogIHJldHVybiBrZXlzOwp9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgewogIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsKCiAgICBpZiAoaSAlIDIpIHsKICAgICAgb3duS2V5cyhzb3VyY2UsIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOwogICAgICB9KTsKICAgIH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsKICAgIH0gZWxzZSB7CiAgICAgIG93bktleXMoc291cmNlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsKICAgICAgfSk7CiAgICB9CiAgfQoKICByZXR1cm4gdGFyZ2V0Owp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7CiAgaWYgKGtleSBpbiBvYmopIHsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgICB2YWx1ZTogdmFsdWUsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgd3JpdGFibGU6IHRydWUKICAgIH0pOwogIH0gZWxzZSB7CiAgICBvYmpba2V5XSA9IHZhbHVlOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKZnVuY3Rpb24gX3RvQ29uc3VtYWJsZUFycmF5KGFycikgewogIHJldHVybiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5KGFycikgfHwgX25vbkl0ZXJhYmxlU3ByZWFkKCk7Cn0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVNwcmVhZCgpIHsKICB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gc3ByZWFkIG5vbi1pdGVyYWJsZSBpbnN0YW5jZSIpOwp9CgpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5KGl0ZXIpIHsKICBpZiAoU3ltYm9sLml0ZXJhdG9yIGluIE9iamVjdChpdGVyKSB8fCBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoaXRlcikgPT09ICJbb2JqZWN0IEFyZ3VtZW50c10iKSByZXR1cm4gQXJyYXkuZnJvbShpdGVyKTsKfQoKZnVuY3Rpb24gX2FycmF5V2l0aG91dEhvbGVzKGFycikgewogIGlmIChBcnJheS5pc0FycmF5KGFycikpIHsKICAgIGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGFyci5sZW5ndGgpOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7CiAgICAgIGFycjJbaV0gPSBhcnJbaV07CiAgICB9CgogICAgcmV0dXJuIGFycjI7CiAgfQp9Cgp2YXIgZ2V0VXBkYXRlU2lnbmFsc1F1ZXJ5ID0gZnVuY3Rpb24gZ2V0VXBkYXRlU2lnbmFsc1F1ZXJ5KGV2ZW50SWRzKSB7CiAgcmV0dXJuIHsKICAgIHF1ZXJ5OiB7CiAgICAgIGJvb2w6IHsKICAgICAgICBmaWx0ZXI6IHsKICAgICAgICAgIHRlcm1zOiB7CiAgICAgICAgICAgIF9pZDogX3RvQ29uc3VtYWJsZUFycmF5KGV2ZW50SWRzKQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQogIH07Cn07CgpleHBvcnRzLmdldFVwZGF0ZVNpZ25hbHNRdWVyeSA9IGdldFVwZGF0ZVNpZ25hbHNRdWVyeTsKCnZhciBnZXRGaWx0ZXJBbmRSdWxlQm91bmRzID0gZnVuY3Rpb24gZ2V0RmlsdGVyQW5kUnVsZUJvdW5kcyhkYXRhKSB7CiAgdmFyIF9yZWYsIF9kYXRhJDAkZmlsdGVyLCBfZGF0YSQwJGZpbHRlciQ7CgogIHZhciBzdHJpbmdGaWx0ZXIgPSAoX3JlZiA9IGRhdGEgPT09IG51bGwgfHwgZGF0YSA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9kYXRhJDAkZmlsdGVyID0gZGF0YVswXS5maWx0ZXIoZnVuY3Rpb24gKGQpIHsKICAgIHJldHVybiBkLmZpZWxkID09PSAnc2lnbmFsLnJ1bGUuZmlsdGVycyc7CiAgfSkpID09PSBudWxsIHx8IF9kYXRhJDAkZmlsdGVyID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX2RhdGEkMCRmaWx0ZXIkID0gX2RhdGEkMCRmaWx0ZXJbMF0pID09PSBudWxsIHx8IF9kYXRhJDAkZmlsdGVyJCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2RhdGEkMCRmaWx0ZXIkLnZhbHVlKSAhPT0gbnVsbCAmJiBfcmVmICE9PSB2b2lkIDAgPyBfcmVmIDogW107CiAgdmFyIGV2ZW50VGltZXMgPSBkYXRhLmZsYXRNYXAoZnVuY3Rpb24gKHNpZ25hbCkgewogICAgdmFyIF9yZWYyLCBfc2lnbmFsJGZpbHRlciwgX3NpZ25hbCRmaWx0ZXIkOwoKICAgIHJldHVybiAoX3JlZjIgPSAoX3NpZ25hbCRmaWx0ZXIgPSBzaWduYWwuZmlsdGVyKGZ1bmN0aW9uIChkKSB7CiAgICAgIHJldHVybiBkLmZpZWxkID09PSAnc2lnbmFsLm9yaWdpbmFsX3RpbWUnOwogICAgfSkpID09PSBudWxsIHx8IF9zaWduYWwkZmlsdGVyID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX3NpZ25hbCRmaWx0ZXIkID0gX3NpZ25hbCRmaWx0ZXJbMF0pID09PSBudWxsIHx8IF9zaWduYWwkZmlsdGVyJCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3NpZ25hbCRmaWx0ZXIkLnZhbHVlKSAhPT0gbnVsbCAmJiBfcmVmMiAhPT0gdm9pZCAwID8gX3JlZjIgOiBbXTsKICB9KS5tYXAoZnVuY3Rpb24gKGQpIHsKICAgIHJldHVybiAoMCwgX21vbWVudC5kZWZhdWx0KShkKTsKICB9KTsKICByZXR1cm4gW3N0cmluZ0ZpbHRlciwgX21vbWVudC5kZWZhdWx0Lm1pbihldmVudFRpbWVzKS52YWx1ZU9mKCksIF9tb21lbnQuZGVmYXVsdC5tYXgoZXZlbnRUaW1lcykudmFsdWVPZigpXTsKfTsKCmV4cG9ydHMuZ2V0RmlsdGVyQW5kUnVsZUJvdW5kcyA9IGdldEZpbHRlckFuZFJ1bGVCb3VuZHM7Cgp2YXIgdXBkYXRlU2lnbmFsU3RhdHVzQWN0aW9uID0gZnVuY3Rpb24gdXBkYXRlU2lnbmFsU3RhdHVzQWN0aW9uKF9yZWYzKSB7CiAgdmFyIHF1ZXJ5LCBzaWduYWxJZHMsIHN0YXR1cywgc2V0RXZlbnRzTG9hZGluZywgc2V0RXZlbnRzRGVsZXRlZCwgcXVlcnlPYmplY3Q7CiAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hc3luYyhmdW5jdGlvbiB1cGRhdGVTaWduYWxTdGF0dXNBY3Rpb24kKF9jb250ZXh0KSB7CiAgICB3aGlsZSAoMSkgewogICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgcXVlcnkgPSBfcmVmMy5xdWVyeSwgc2lnbmFsSWRzID0gX3JlZjMuc2lnbmFsSWRzLCBzdGF0dXMgPSBfcmVmMy5zdGF0dXMsIHNldEV2ZW50c0xvYWRpbmcgPSBfcmVmMy5zZXRFdmVudHNMb2FkaW5nLCBzZXRFdmVudHNEZWxldGVkID0gX3JlZjMuc2V0RXZlbnRzRGVsZXRlZDsKICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAxOwogICAgICAgICAgc2V0RXZlbnRzTG9hZGluZyh7CiAgICAgICAgICAgIGV2ZW50SWRzOiBzaWduYWxJZHMsCiAgICAgICAgICAgIGlzTG9hZGluZzogdHJ1ZQogICAgICAgICAgfSk7CiAgICAgICAgICBxdWVyeU9iamVjdCA9IHF1ZXJ5ID8gewogICAgICAgICAgICBxdWVyeTogSlNPTi5wYXJzZShxdWVyeSkKICAgICAgICAgIH0gOiBnZXRVcGRhdGVTaWduYWxzUXVlcnkoc2lnbmFsSWRzKTsKICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA2OwogICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hd3JhcCgoMCwgX2FwaS51cGRhdGVTaWduYWxTdGF0dXMpKHsKICAgICAgICAgICAgcXVlcnk6IHF1ZXJ5T2JqZWN0LAogICAgICAgICAgICBzdGF0dXM6IHN0YXR1cwogICAgICAgICAgfSkpOwoKICAgICAgICBjYXNlIDY6CiAgICAgICAgICAvLyBUT0RPOiBPbmx5IGRlbGV0ZSB0aG9zZSB0aGF0IHdlcmUgc3VjY2Vzc2Z1bGx5IHVwZGF0ZWQgZnJvbSB1cGRhdGVkUnVsZXMKICAgICAgICAgIHNldEV2ZW50c0RlbGV0ZWQoewogICAgICAgICAgICBldmVudElkczogc2lnbmFsSWRzLAogICAgICAgICAgICBpc0RlbGV0ZWQ6IHRydWUKICAgICAgICAgIH0pOwogICAgICAgICAgX2NvbnRleHQubmV4dCA9IDExOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgOToKICAgICAgICAgIF9jb250ZXh0LnByZXYgPSA5OwogICAgICAgICAgX2NvbnRleHQudDAgPSBfY29udGV4dFsiY2F0Y2giXSgxKTsKCiAgICAgICAgY2FzZSAxMToKICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAxMTsKICAgICAgICAgIHNldEV2ZW50c0xvYWRpbmcoewogICAgICAgICAgICBldmVudElkczogc2lnbmFsSWRzLAogICAgICAgICAgICBpc0xvYWRpbmc6IGZhbHNlCiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybiBfY29udGV4dC5maW5pc2goMTEpOwoKICAgICAgICBjYXNlIDE0OgogICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICB9CiAgICB9CiAgfSwgbnVsbCwgbnVsbCwgW1sxLCA5LCAxMSwgMTRdXSk7Cn07CgpleHBvcnRzLnVwZGF0ZVNpZ25hbFN0YXR1c0FjdGlvbiA9IHVwZGF0ZVNpZ25hbFN0YXR1c0FjdGlvbjsKCnZhciBzZW5kU2lnbmFsVG9UaW1lbGluZUFjdGlvbiA9IGZ1bmN0aW9uIHNlbmRTaWduYWxUb1RpbWVsaW5lQWN0aW9uKF9yZWY0KSB7CiAgdmFyIF9lY3NEYXRhJHNpZ25hbCwgX2Vjc0RhdGEkc2lnbmFsJHJ1bGUsIF9lY3NEYXRhJHNpZ25hbDIsIF9lY3NEYXRhJHNpZ25hbDIkcnVsZSwgX2Vjc0RhdGEkc2lnbmFsMywgX2Vjc0RhdGEkc2lnbmFsMyRydWxlLCBfZWNzRGF0YSRzaWduYWw0LCBfZWNzRGF0YSRzaWduYWw0JHJ1bGUsIF9lY3NEYXRhJHRpbWVzdGFtcCwgX2Vjc0RhdGEkdGltZXN0YW1wMjsKCiAgdmFyIGFwb2xsb0NsaWVudCwgY3JlYXRlVGltZWxpbmUsIGVjc0RhdGEsIHVwZGF0ZVRpbWVsaW5lSXNMb2FkaW5nLCBvcGVuU2lnbmFsSW5CYXNpY1RpbWVsaW5lLCB0aW1lbGluZUlkLCBlbGxhcHNlZFRpbWVSdWxlLCBmcm9tLCB0bywgcmVzcG9uc2VUaW1lbGluZSwgdGltZWxpbmVUZW1wbGF0ZSwgX3JlZjUsIF90aW1lbGluZSRrcWxRdWVyeSwgX3RpbWVsaW5lJGtxbFF1ZXJ5JGZpLCBfdGltZWxpbmUka3FsUXVlcnkkZmkyLCBfdGltZWxpbmUkZmlsdGVycywgX3RpbWVsaW5lJGRhdGFQcm92aWRlLCBfcmVmNiwgX3RpbWVsaW5lJGtxbFF1ZXJ5MiwgX3RpbWVsaW5lJGtxbFF1ZXJ5MiRmLCBfdGltZWxpbmUka3FsUXVlcnkyJGYyLCBfcmVmNywgX3RpbWVsaW5lJGtxbFF1ZXJ5MywgX3RpbWVsaW5lJGtxbFF1ZXJ5MyRmLCBfdGltZWxpbmUka3FsUXVlcnkzJGYyLCBfZm9ybWF0VGltZWxpbmVSZXN1bHQsIHRpbWVsaW5lLCBfcXVlcnksIGZpbHRlcnMsIGRhdGFQcm92aWRlcnM7CgogIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXN5bmMoZnVuY3Rpb24gc2VuZFNpZ25hbFRvVGltZWxpbmVBY3Rpb24kKF9jb250ZXh0MikgewogICAgd2hpbGUgKDEpIHsKICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgYXBvbGxvQ2xpZW50ID0gX3JlZjQuYXBvbGxvQ2xpZW50LCBjcmVhdGVUaW1lbGluZSA9IF9yZWY0LmNyZWF0ZVRpbWVsaW5lLCBlY3NEYXRhID0gX3JlZjQuZWNzRGF0YSwgdXBkYXRlVGltZWxpbmVJc0xvYWRpbmcgPSBfcmVmNC51cGRhdGVUaW1lbGluZUlzTG9hZGluZzsKICAgICAgICAgIG9wZW5TaWduYWxJbkJhc2ljVGltZWxpbmUgPSB0cnVlOwogICAgICAgICAgdGltZWxpbmVJZCA9ICgoX2Vjc0RhdGEkc2lnbmFsID0gZWNzRGF0YS5zaWduYWwpID09PSBudWxsIHx8IF9lY3NEYXRhJHNpZ25hbCA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9lY3NEYXRhJHNpZ25hbCRydWxlID0gX2Vjc0RhdGEkc2lnbmFsLnJ1bGUpID09PSBudWxsIHx8IF9lY3NEYXRhJHNpZ25hbCRydWxlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZWNzRGF0YSRzaWduYWwkcnVsZS50aW1lbGluZV9pZCkgIT0gbnVsbCA/IChfZWNzRGF0YSRzaWduYWwyID0gZWNzRGF0YS5zaWduYWwpID09PSBudWxsIHx8IF9lY3NEYXRhJHNpZ25hbDIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfZWNzRGF0YSRzaWduYWwyJHJ1bGUgPSBfZWNzRGF0YSRzaWduYWwyLnJ1bGUpID09PSBudWxsIHx8IF9lY3NEYXRhJHNpZ25hbDIkcnVsZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Vjc0RhdGEkc2lnbmFsMiRydWxlLnRpbWVsaW5lX2lkWzBdIDogJyc7CiAgICAgICAgICBlbGxhcHNlZFRpbWVSdWxlID0gX21vbWVudC5kZWZhdWx0LmR1cmF0aW9uKCgwLCBfbW9tZW50LmRlZmF1bHQpKCkuZGlmZihfZGF0ZW1hdGguZGVmYXVsdC5wYXJzZSgoKF9lY3NEYXRhJHNpZ25hbDMgPSBlY3NEYXRhLnNpZ25hbCkgPT09IG51bGwgfHwgX2Vjc0RhdGEkc2lnbmFsMyA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9lY3NEYXRhJHNpZ25hbDMkcnVsZSA9IF9lY3NEYXRhJHNpZ25hbDMucnVsZSkgPT09IG51bGwgfHwgX2Vjc0RhdGEkc2lnbmFsMyRydWxlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZWNzRGF0YSRzaWduYWwzJHJ1bGUuZnJvbSkgIT0gbnVsbCA/IChfZWNzRGF0YSRzaWduYWw0ID0gZWNzRGF0YS5zaWduYWwpID09PSBudWxsIHx8IF9lY3NEYXRhJHNpZ25hbDQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfZWNzRGF0YSRzaWduYWw0JHJ1bGUgPSBfZWNzRGF0YSRzaWduYWw0LnJ1bGUpID09PSBudWxsIHx8IF9lY3NEYXRhJHNpZ25hbDQkcnVsZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Vjc0RhdGEkc2lnbmFsNCRydWxlLmZyb21bMF0gOiAnbm93LTBzJykpKTsKICAgICAgICAgIGZyb20gPSAoMCwgX21vbWVudC5kZWZhdWx0KSgoX2Vjc0RhdGEkdGltZXN0YW1wID0gZWNzRGF0YS50aW1lc3RhbXApICE9PSBudWxsICYmIF9lY3NEYXRhJHRpbWVzdGFtcCAhPT0gdm9pZCAwID8gX2Vjc0RhdGEkdGltZXN0YW1wIDogbmV3IERhdGUoKSkuc3VidHJhY3QoZWxsYXBzZWRUaW1lUnVsZSkudmFsdWVPZigpOwogICAgICAgICAgdG8gPSAoMCwgX21vbWVudC5kZWZhdWx0KSgoX2Vjc0RhdGEkdGltZXN0YW1wMiA9IGVjc0RhdGEudGltZXN0YW1wKSAhPT0gbnVsbCAmJiBfZWNzRGF0YSR0aW1lc3RhbXAyICE9PSB2b2lkIDAgPyBfZWNzRGF0YSR0aW1lc3RhbXAyIDogbmV3IERhdGUoKSkudmFsdWVPZigpOwoKICAgICAgICAgIGlmICghKHRpbWVsaW5lSWQgIT09ICcnICYmIGFwb2xsb0NsaWVudCAhPSBudWxsKSkgewogICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDIwOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgICBfY29udGV4dDIucHJldiA9IDc7CiAgICAgICAgICB1cGRhdGVUaW1lbGluZUlzTG9hZGluZyh7CiAgICAgICAgICAgIGlkOiAndGltZWxpbmUtMScsCiAgICAgICAgICAgIGlzTG9hZGluZzogdHJ1ZQogICAgICAgICAgfSk7CiAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDExOwogICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hd3JhcChhcG9sbG9DbGllbnQucXVlcnkoewogICAgICAgICAgICBxdWVyeTogX2luZGV4Lm9uZVRpbWVsaW5lUXVlcnksCiAgICAgICAgICAgIGZldGNoUG9saWN5OiAnbm8tY2FjaGUnLAogICAgICAgICAgICB2YXJpYWJsZXM6IHsKICAgICAgICAgICAgICBpZDogdGltZWxpbmVJZAogICAgICAgICAgICB9CiAgICAgICAgICB9KSk7CgogICAgICAgIGNhc2UgMTE6CiAgICAgICAgICByZXNwb25zZVRpbWVsaW5lID0gX2NvbnRleHQyLnNlbnQ7CiAgICAgICAgICB0aW1lbGluZVRlbXBsYXRlID0gKDAsIF9oZWxwZXJzLm9taXRUeXBlbmFtZUluVGltZWxpbmUpKCgwLCBfZnAuZ2V0T3IpKHt9LCAnZGF0YS5nZXRPbmVUaW1lbGluZScsIHJlc3BvbnNlVGltZWxpbmUpKTsKCiAgICAgICAgICBpZiAoISgwLCBfZnAuaXNFbXB0eSkodGltZWxpbmVUZW1wbGF0ZSkpIHsKICAgICAgICAgICAgb3BlblNpZ25hbEluQmFzaWNUaW1lbGluZSA9IGZhbHNlOwogICAgICAgICAgICBfZm9ybWF0VGltZWxpbmVSZXN1bHQgPSAoMCwgX2hlbHBlcnMuZm9ybWF0VGltZWxpbmVSZXN1bHRUb01vZGVsKSh0aW1lbGluZVRlbXBsYXRlLCB0cnVlKSwgdGltZWxpbmUgPSBfZm9ybWF0VGltZWxpbmVSZXN1bHQudGltZWxpbmU7CiAgICAgICAgICAgIF9xdWVyeSA9ICgwLCBfaGVscGVyczIucmVwbGFjZVRlbXBsYXRlRmllbGRGcm9tUXVlcnkpKChfcmVmNSA9IChfdGltZWxpbmUka3FsUXVlcnkgPSB0aW1lbGluZS5rcWxRdWVyeSkgPT09IG51bGwgfHwgX3RpbWVsaW5lJGtxbFF1ZXJ5ID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX3RpbWVsaW5lJGtxbFF1ZXJ5JGZpID0gX3RpbWVsaW5lJGtxbFF1ZXJ5LmZpbHRlclF1ZXJ5KSA9PT0gbnVsbCB8fCBfdGltZWxpbmUka3FsUXVlcnkkZmkgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfdGltZWxpbmUka3FsUXVlcnkkZmkyID0gX3RpbWVsaW5lJGtxbFF1ZXJ5JGZpLmt1ZXJ5KSA9PT0gbnVsbCB8fCBfdGltZWxpbmUka3FsUXVlcnkkZmkyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGltZWxpbmUka3FsUXVlcnkkZmkyLmV4cHJlc3Npb24pICE9PSBudWxsICYmIF9yZWY1ICE9PSB2b2lkIDAgPyBfcmVmNSA6ICcnLCBlY3NEYXRhKTsKICAgICAgICAgICAgZmlsdGVycyA9ICgwLCBfaGVscGVyczIucmVwbGFjZVRlbXBsYXRlRmllbGRGcm9tTWF0Y2hGaWx0ZXJzKSgoX3RpbWVsaW5lJGZpbHRlcnMgPSB0aW1lbGluZS5maWx0ZXJzKSAhPT0gbnVsbCAmJiBfdGltZWxpbmUkZmlsdGVycyAhPT0gdm9pZCAwID8gX3RpbWVsaW5lJGZpbHRlcnMgOiBbXSwgZWNzRGF0YSk7CiAgICAgICAgICAgIGRhdGFQcm92aWRlcnMgPSAoMCwgX2hlbHBlcnMyLnJlcGxhY2VUZW1wbGF0ZUZpZWxkRnJvbURhdGFQcm92aWRlcnMpKChfdGltZWxpbmUkZGF0YVByb3ZpZGUgPSB0aW1lbGluZS5kYXRhUHJvdmlkZXJzKSAhPT0gbnVsbCAmJiBfdGltZWxpbmUkZGF0YVByb3ZpZGUgIT09IHZvaWQgMCA/IF90aW1lbGluZSRkYXRhUHJvdmlkZSA6IFtdLCBlY3NEYXRhKTsKICAgICAgICAgICAgY3JlYXRlVGltZWxpbmUoewogICAgICAgICAgICAgIGZyb206IGZyb20sCiAgICAgICAgICAgICAgdGltZWxpbmU6IF9vYmplY3RTcHJlYWQoe30sIHRpbWVsaW5lLCB7CiAgICAgICAgICAgICAgICBkYXRhUHJvdmlkZXJzOiBkYXRhUHJvdmlkZXJzLAogICAgICAgICAgICAgICAgZXZlbnRUeXBlOiAnYWxsJywKICAgICAgICAgICAgICAgIGZpbHRlcnM6IGZpbHRlcnMsCiAgICAgICAgICAgICAgICBkYXRlUmFuZ2U6IHsKICAgICAgICAgICAgICAgICAgc3RhcnQ6IGZyb20sCiAgICAgICAgICAgICAgICAgIGVuZDogdG8KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBrcWxRdWVyeTogewogICAgICAgICAgICAgICAgICBmaWx0ZXJRdWVyeTogewogICAgICAgICAgICAgICAgICAgIGt1ZXJ5OiB7CiAgICAgICAgICAgICAgICAgICAgICBraW5kOiAoX3JlZjYgPSAoX3RpbWVsaW5lJGtxbFF1ZXJ5MiA9IHRpbWVsaW5lLmtxbFF1ZXJ5KSA9PT0gbnVsbCB8fCBfdGltZWxpbmUka3FsUXVlcnkyID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX3RpbWVsaW5lJGtxbFF1ZXJ5MiRmID0gX3RpbWVsaW5lJGtxbFF1ZXJ5Mi5maWx0ZXJRdWVyeSkgPT09IG51bGwgfHwgX3RpbWVsaW5lJGtxbFF1ZXJ5MiRmID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX3RpbWVsaW5lJGtxbFF1ZXJ5MiRmMiA9IF90aW1lbGluZSRrcWxRdWVyeTIkZi5rdWVyeSkgPT09IG51bGwgfHwgX3RpbWVsaW5lJGtxbFF1ZXJ5MiRmMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RpbWVsaW5lJGtxbFF1ZXJ5MiRmMi5raW5kKSAhPT0gbnVsbCAmJiBfcmVmNiAhPT0gdm9pZCAwID8gX3JlZjYgOiAna3VlcnknLAogICAgICAgICAgICAgICAgICAgICAgZXhwcmVzc2lvbjogX3F1ZXJ5CiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBzZXJpYWxpemVkUXVlcnk6ICgwLCBfa2V1cnkuY29udmVydEt1ZXJ5VG9FbGFzdGljU2VhcmNoUXVlcnkpKF9xdWVyeSkKICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgZmlsdGVyUXVlcnlEcmFmdDogewogICAgICAgICAgICAgICAgICAgIGtpbmQ6IChfcmVmNyA9IChfdGltZWxpbmUka3FsUXVlcnkzID0gdGltZWxpbmUua3FsUXVlcnkpID09PSBudWxsIHx8IF90aW1lbGluZSRrcWxRdWVyeTMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfdGltZWxpbmUka3FsUXVlcnkzJGYgPSBfdGltZWxpbmUka3FsUXVlcnkzLmZpbHRlclF1ZXJ5KSA9PT0gbnVsbCB8fCBfdGltZWxpbmUka3FsUXVlcnkzJGYgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfdGltZWxpbmUka3FsUXVlcnkzJGYyID0gX3RpbWVsaW5lJGtxbFF1ZXJ5MyRmLmt1ZXJ5KSA9PT0gbnVsbCB8fCBfdGltZWxpbmUka3FsUXVlcnkzJGYyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGltZWxpbmUka3FsUXVlcnkzJGYyLmtpbmQpICE9PSBudWxsICYmIF9yZWY3ICE9PSB2b2lkIDAgPyBfcmVmNyA6ICdrdWVyeScsCiAgICAgICAgICAgICAgICAgICAgZXhwcmVzc2lvbjogX3F1ZXJ5CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBzaG93OiB0cnVlCiAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgdG86IHRvCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQoKICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMjA7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAxNjoKICAgICAgICAgIF9jb250ZXh0Mi5wcmV2ID0gMTY7CiAgICAgICAgICBfY29udGV4dDIudDAgPSBfY29udGV4dDJbImNhdGNoIl0oNyk7CiAgICAgICAgICBvcGVuU2lnbmFsSW5CYXNpY1RpbWVsaW5lID0gdHJ1ZTsKICAgICAgICAgIHVwZGF0ZVRpbWVsaW5lSXNMb2FkaW5nKHsKICAgICAgICAgICAgaWQ6ICd0aW1lbGluZS0xJywKICAgICAgICAgICAgaXNMb2FkaW5nOiBmYWxzZQogICAgICAgICAgfSk7CgogICAgICAgIGNhc2UgMjA6CiAgICAgICAgICBpZiAob3BlblNpZ25hbEluQmFzaWNUaW1lbGluZSkgewogICAgICAgICAgICBjcmVhdGVUaW1lbGluZSh7CiAgICAgICAgICAgICAgZnJvbTogZnJvbSwKICAgICAgICAgICAgICB0aW1lbGluZTogX29iamVjdFNwcmVhZCh7fSwgX2RlZmF1bHRzLnRpbWVsaW5lRGVmYXVsdHMsIHsKICAgICAgICAgICAgICAgIGRhdGFQcm92aWRlcnM6IFt7CiAgICAgICAgICAgICAgICAgIGFuZDogW10sCiAgICAgICAgICAgICAgICAgIGlkOiAic2VuZC1zaWduYWwtdG8tdGltZWxpbmUtYWN0aW9uLWRlZmF1bHQtZHJhZ2dhYmxlLWV2ZW50LWRldGFpbHMtdmFsdWUtZm9ybWF0dGVkLWZpZWxkLXZhbHVlLXRpbWVsaW5lLTEtc2lnbmFsLWlkLSIuY29uY2F0KGVjc0RhdGEuX2lkKSwKICAgICAgICAgICAgICAgICAgbmFtZTogZWNzRGF0YS5faWQsCiAgICAgICAgICAgICAgICAgIGVuYWJsZWQ6IHRydWUsCiAgICAgICAgICAgICAgICAgIGV4Y2x1ZGVkOiBmYWxzZSwKICAgICAgICAgICAgICAgICAga3FsUXVlcnk6ICcnLAogICAgICAgICAgICAgICAgICBxdWVyeU1hdGNoOiB7CiAgICAgICAgICAgICAgICAgICAgZmllbGQ6ICdfaWQnLAogICAgICAgICAgICAgICAgICAgIHZhbHVlOiBlY3NEYXRhLl9pZCwKICAgICAgICAgICAgICAgICAgICBvcGVyYXRvcjogJzonCiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH1dLAogICAgICAgICAgICAgICAgaWQ6ICd0aW1lbGluZS0xJywKICAgICAgICAgICAgICAgIGRhdGVSYW5nZTogewogICAgICAgICAgICAgICAgICBzdGFydDogZnJvbSwKICAgICAgICAgICAgICAgICAgZW5kOiB0bwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGV2ZW50VHlwZTogJ2FsbCcsCiAgICAgICAgICAgICAgICBrcWxRdWVyeTogewogICAgICAgICAgICAgICAgICBmaWx0ZXJRdWVyeTogewogICAgICAgICAgICAgICAgICAgIGt1ZXJ5OiB7CiAgICAgICAgICAgICAgICAgICAgICBraW5kOiAna3VlcnknLAogICAgICAgICAgICAgICAgICAgICAgZXhwcmVzc2lvbjogJycKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIHNlcmlhbGl6ZWRRdWVyeTogJycKICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgZmlsdGVyUXVlcnlEcmFmdDogewogICAgICAgICAgICAgICAgICAgIGtpbmQ6ICdrdWVyeScsCiAgICAgICAgICAgICAgICAgICAgZXhwcmVzc2lvbjogJycKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgIHRvOiB0bwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KCiAgICAgICAgY2FzZSAyMToKICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgIH0KICAgIH0KICB9LCBudWxsLCBudWxsLCBbWzcsIDE2XV0pOwp9OwoKZXhwb3J0cy5zZW5kU2lnbmFsVG9UaW1lbGluZUFjdGlvbiA9IHNlbmRTaWduYWxUb1RpbWVsaW5lQWN0aW9uOw=="},null]}