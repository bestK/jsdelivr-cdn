{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/ml/public/application/explorer/explorer_charts/explorer_chart_single_metric.js","dependencies":[{"path":"x-pack/legacy/plugins/ml/public/application/explorer/explorer_charts/explorer_chart_single_metric.js","mtime":1585205045728},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkV4cGxvcmVyQ2hhcnRTaW5nbGVNZXRyaWMgPSB2b2lkIDA7Cgp2YXIgX3Byb3BUeXBlcyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgicHJvcC10eXBlcyIpKTsKCnZhciBfcmVhY3QgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoInJlYWN0IikpOwoKdmFyIF9sb2Rhc2ggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoImxvZGFzaCIpKTsKCnZhciBfZCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiZDMiKSk7Cgp2YXIgX2pxdWVyeSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgianF1ZXJ5IikpOwoKdmFyIF9tb21lbnQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIm1vbWVudCIpKTsKCnZhciBfZGF0ZV91dGlscyA9IHJlcXVpcmUoIi4uLy4uL3V0aWwvZGF0ZV91dGlscyIpOwoKdmFyIF9mb3JtYXRfdmFsdWUgPSByZXF1aXJlKCIuLi8uLi9mb3JtYXR0ZXJzL2Zvcm1hdF92YWx1ZSIpOwoKdmFyIF9hbm9tYWx5X3V0aWxzID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vY29tbW9uL3V0aWwvYW5vbWFseV91dGlscyIpOwoKdmFyIF9jaGFydF91dGlscyA9IHJlcXVpcmUoIi4uLy4uL3V0aWwvY2hhcnRfdXRpbHMiKTsKCnZhciBfbG9hZGluZ19pbmRpY2F0b3IgPSByZXF1aXJlKCIuLi8uLi9jb21wb25lbnRzL2xvYWRpbmdfaW5kaWNhdG9yL2xvYWRpbmdfaW5kaWNhdG9yIik7Cgp2YXIgX3RpbWVfYnVja2V0cyA9IHJlcXVpcmUoIi4uLy4uL3V0aWwvdGltZV9idWNrZXRzIik7Cgp2YXIgX3N0cmluZ191dGlscyA9IHJlcXVpcmUoIi4uLy4uL3V0aWwvc3RyaW5nX3V0aWxzIik7Cgp2YXIgX2ZpZWxkX2Zvcm1hdF9zZXJ2aWNlID0gcmVxdWlyZSgiLi4vLi4vc2VydmljZXMvZmllbGRfZm9ybWF0X3NlcnZpY2UiKTsKCnZhciBfY2hhcnRfdG9vbHRpcF9zZXJ2aWNlID0gcmVxdWlyZSgiLi4vLi4vY29tcG9uZW50cy9jaGFydF90b29sdGlwL2NoYXJ0X3Rvb2x0aXBfc2VydmljZSIpOwoKdmFyIF9yZWFjdDIgPSByZXF1aXJlKCJAa2JuL2kxOG4vcmVhY3QiKTsKCnZhciBfY2xhc3MsIF90ZW1wOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiKSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfTsgfSBlbHNlIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyAic3ltYm9sIiA6IHR5cGVvZiBvYmo7IH07IH0gcmV0dXJuIF90eXBlb2Yob2JqKTsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH0KCmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKGNhbGwgJiYgKF90eXBlb2YoY2FsbCkgPT09ICJvYmplY3QiIHx8IHR5cGVvZiBjYWxsID09PSAiZnVuY3Rpb24iKSkgeyByZXR1cm4gY2FsbDsgfSByZXR1cm4gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKTsgfQoKZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7IGlmIChzZWxmID09PSB2b2lkIDApIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsgfSByZXR1cm4gc2VsZjsgfQoKZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgX2dldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LmdldFByb3RvdHlwZU9mIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgcmV0dXJuIG8uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihvKTsgfTsgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsgfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uIik7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTsgfQoKZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgX3NldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IGZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IG8uX19wcm90b19fID0gcDsgcmV0dXJuIG87IH07IHJldHVybiBfc2V0UHJvdG90eXBlT2YobywgcCk7IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsgaWYgKGtleSBpbiBvYmopIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7IHZhbHVlOiB2YWx1ZSwgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTsgfSBlbHNlIHsgb2JqW2tleV0gPSB2YWx1ZTsgfSByZXR1cm4gb2JqOyB9Cgp2YXIgQ09OVEVOVF9XUkFQUEVSX0hFSUdIVCA9IDIxNTsKdmFyIENPTlRFTlRfV1JBUFBFUl9DTEFTUyA9ICdtbC1leHBsb3Jlci1jaGFydC1jb250ZW50LXdyYXBwZXInOwp2YXIgRXhwbG9yZXJDaGFydFNpbmdsZU1ldHJpYyA9ICgwLCBfcmVhY3QyLmluamVjdEkxOG4pKChfdGVtcCA9IF9jbGFzcyA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKF9SZWFjdCRDb21wb25lbnQpIHsKICBfaW5oZXJpdHMoRXhwbG9yZXJDaGFydFNpbmdsZU1ldHJpYywgX1JlYWN0JENvbXBvbmVudCk7CgogIGZ1bmN0aW9uIEV4cGxvcmVyQ2hhcnRTaW5nbGVNZXRyaWMoKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRXhwbG9yZXJDaGFydFNpbmdsZU1ldHJpYyk7CgogICAgcmV0dXJuIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIF9nZXRQcm90b3R5cGVPZihFeHBsb3JlckNoYXJ0U2luZ2xlTWV0cmljKS5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTsKICB9CgogIF9jcmVhdGVDbGFzcyhFeHBsb3JlckNoYXJ0U2luZ2xlTWV0cmljLCBbewogICAga2V5OiAiY29tcG9uZW50RGlkTW91bnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudERpZE1vdW50KCkgewogICAgICB0aGlzLnJlbmRlckNoYXJ0KCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiY29tcG9uZW50RGlkVXBkYXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnREaWRVcGRhdGUoKSB7CiAgICAgIHRoaXMucmVuZGVyQ2hhcnQoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXJDaGFydCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyQ2hhcnQoKSB7CiAgICAgIHZhciBfdGhpcyRwcm9wcyA9IHRoaXMucHJvcHMsCiAgICAgICAgICB0b29NYW55QnVja2V0cyA9IF90aGlzJHByb3BzLnRvb01hbnlCdWNrZXRzLAogICAgICAgICAgaW50bCA9IF90aGlzJHByb3BzLmludGw7CiAgICAgIHZhciBlbGVtZW50ID0gdGhpcy5yb290Tm9kZTsKICAgICAgdmFyIGNvbmZpZyA9IHRoaXMucHJvcHMuc2VyaWVzQ29uZmlnOwogICAgICB2YXIgc2V2ZXJpdHkgPSB0aGlzLnByb3BzLnNldmVyaXR5OwoKICAgICAgaWYgKHR5cGVvZiBjb25maWcgPT09ICd1bmRlZmluZWQnIHx8IEFycmF5LmlzQXJyYXkoY29uZmlnLmNoYXJ0RGF0YSkgPT09IGZhbHNlKSB7CiAgICAgICAgLy8ganVzdCByZXR1cm4gc28gdGhlIGVtcHR5IGRpcmVjdGl2ZSByZW5kZXJzIHdpdGhvdXQgYW4gZXJyb3IgbGF0ZXIgb24KICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBmaWVsZEZvcm1hdCA9IF9maWVsZF9mb3JtYXRfc2VydmljZS5tbEZpZWxkRm9ybWF0U2VydmljZS5nZXRGaWVsZEZvcm1hdChjb25maWcuam9iSWQsIGNvbmZpZy5kZXRlY3RvckluZGV4KTsKCiAgICAgIHZhciB2aXpXaWR0aCA9IDA7CiAgICAgIHZhciBjaGFydEhlaWdodCA9IDE3MDsgLy8gTGVmdCBtYXJnaW4gaXMgYWRqdXN0ZWQgbGF0ZXIgZm9yIGxvbmdlc3QgeS1heGlzIGxhYmVsLgoKICAgICAgdmFyIG1hcmdpbiA9IHsKICAgICAgICB0b3A6IDEwLAogICAgICAgIHJpZ2h0OiAwLAogICAgICAgIGJvdHRvbTogMzAsCiAgICAgICAgbGVmdDogNjAKICAgICAgfTsKICAgICAgdmFyIGxpbmVDaGFydFhTY2FsZSA9IG51bGw7CiAgICAgIHZhciBsaW5lQ2hhcnRZU2NhbGUgPSBudWxsOwogICAgICB2YXIgbGluZUNoYXJ0R3JvdXA7CiAgICAgIHZhciBsaW5lQ2hhcnRWYWx1ZXNMaW5lID0gbnVsbDsKICAgICAgaW5pdChjb25maWcuY2hhcnRMaW1pdHMpOwogICAgICBkcmF3TGluZUNoYXJ0KGNvbmZpZy5jaGFydERhdGEpOwoKICAgICAgZnVuY3Rpb24gaW5pdChjaGFydExpbWl0cykgewogICAgICAgIHZhciAkZWwgPSAoMCwgX2pxdWVyeS5kZWZhdWx0KSgnLm1sLWV4cGxvcmVyLWNoYXJ0Jyk7IC8vIENsZWFyIGFueSBleGlzdGluZyBlbGVtZW50cyBmcm9tIHRoZSB2aXN1YWxpemF0aW9uLAogICAgICAgIC8vIHRoZW4gYnVpbGQgdGhlIHN2ZyBlbGVtZW50cyBmb3IgdGhlIGNoYXJ0LgoKICAgICAgICB2YXIgY2hhcnRFbGVtZW50ID0gX2QuZGVmYXVsdC5zZWxlY3QoZWxlbWVudCkuc2VsZWN0KCIuIi5jb25jYXQoQ09OVEVOVF9XUkFQUEVSX0NMQVNTKSk7CgogICAgICAgIGNoYXJ0RWxlbWVudC5zZWxlY3QoJ3N2ZycpLnJlbW92ZSgpOwogICAgICAgIHZhciBzdmdXaWR0aCA9ICRlbC53aWR0aCgpOwogICAgICAgIHZhciBzdmdIZWlnaHQgPSBjaGFydEhlaWdodCArIG1hcmdpbi50b3AgKyBtYXJnaW4uYm90dG9tOwogICAgICAgIHZhciBzdmcgPSBjaGFydEVsZW1lbnQuYXBwZW5kKCdzdmcnKS5jbGFzc2VkKCdtbC1leHBsb3Jlci1jaGFydC1zdmcnLCB0cnVlKS5hdHRyKCd3aWR0aCcsIHN2Z1dpZHRoKS5hdHRyKCdoZWlnaHQnLCBzdmdIZWlnaHQpOyAvLyBTZXQgdGhlIHNpemUgb2YgdGhlIGxlZnQgbWFyZ2luIGFjY29yZGluZyB0byB0aGUgd2lkdGggb2YgdGhlIGxhcmdlc3QgeSBheGlzIHRpY2sgbGFiZWwuCgogICAgICAgIGxpbmVDaGFydFlTY2FsZSA9IF9kLmRlZmF1bHQuc2NhbGUubGluZWFyKCkucmFuZ2UoW2NoYXJ0SGVpZ2h0LCAwXSkuZG9tYWluKFtjaGFydExpbWl0cy5taW4sIGNoYXJ0TGltaXRzLm1heF0pLm5pY2UoKTsKCiAgICAgICAgdmFyIHlBeGlzID0gX2QuZGVmYXVsdC5zdmcuYXhpcygpLnNjYWxlKGxpbmVDaGFydFlTY2FsZSkub3JpZW50KCdsZWZ0JykuaW5uZXJUaWNrU2l6ZSgwKS5vdXRlclRpY2tTaXplKDApLnRpY2tQYWRkaW5nKDEwKTsKCiAgICAgICAgdmFyIG1heFlBeGlzTGFiZWxXaWR0aCA9IDA7CiAgICAgICAgdmFyIHRlbXBMYWJlbFRleHQgPSBzdmcuYXBwZW5kKCdnJykuYXR0cignY2xhc3MnLCAndGVtcC1heGlzLWxhYmVsIHRpY2snKTsKICAgICAgICB0ZW1wTGFiZWxUZXh0LnNlbGVjdEFsbCgndGV4dC50ZW1wLmF4aXMnKS5kYXRhKGxpbmVDaGFydFlTY2FsZS50aWNrcygpKS5lbnRlcigpLmFwcGVuZCgndGV4dCcpLnRleHQoZnVuY3Rpb24gKGQpIHsKICAgICAgICAgIGlmIChmaWVsZEZvcm1hdCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIHJldHVybiBmaWVsZEZvcm1hdC5jb252ZXJ0KGQsICd0ZXh0Jyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gbGluZUNoYXJ0WVNjYWxlLnRpY2tGb3JtYXQoKShkKTsKICAgICAgICAgIH0KICAgICAgICB9KSAvLyBEb24ndCB1c2UgYW4gYXJyb3cgZnVuY3Rpb24gc2luY2Ugd2UgbmVlZCBhY2Nlc3MgdG8gYHRoaXNgLgogICAgICAgIC5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIG1heFlBeGlzTGFiZWxXaWR0aCA9IE1hdGgubWF4KHRoaXMuZ2V0QkJveCgpLndpZHRoICsgeUF4aXMudGlja1BhZGRpbmcoKSwgbWF4WUF4aXNMYWJlbFdpZHRoKTsKICAgICAgICB9KS5yZW1vdmUoKTsKCiAgICAgICAgX2QuZGVmYXVsdC5zZWxlY3QoJy50ZW1wLWF4aXMtbGFiZWwnKS5yZW1vdmUoKTsKCiAgICAgICAgbWFyZ2luLmxlZnQgPSBNYXRoLm1heChtYXhZQXhpc0xhYmVsV2lkdGgsIDQwKTsKICAgICAgICB2aXpXaWR0aCA9IHN2Z1dpZHRoIC0gbWFyZ2luLmxlZnQgLSBtYXJnaW4ucmlnaHQ7IC8vIFNldCB0aGUgeCBheGlzIGRvbWFpbiB0byBtYXRjaCB0aGUgcmVxdWVzdCBwbG90IHJhbmdlLgogICAgICAgIC8vIFRoaXMgZW5zdXJlcyByYW5nZXMgb24gZGlmZmVyZW50IGNoYXJ0cyB3aWxsIG1hdGNoLCBldmVuIHdoZW4gdGhlcmUgYXJlbid0CiAgICAgICAgLy8gZGF0YSBwb2ludHMgYWNyb3NzIHRoZSBmdWxsIHJhbmdlLCBhbmQgdGhlIHNlbGVjdGVkIGFub21hbG91cyByZWdpb24gaXMgY2VudHJlZC4KCiAgICAgICAgbGluZUNoYXJ0WFNjYWxlID0gX2QuZGVmYXVsdC50aW1lLnNjYWxlKCkucmFuZ2UoWzAsIHZpeldpZHRoXSkuZG9tYWluKFtjb25maWcucGxvdEVhcmxpZXN0LCBjb25maWcucGxvdExhdGVzdF0pOwogICAgICAgIGxpbmVDaGFydFZhbHVlc0xpbmUgPSBfZC5kZWZhdWx0LnN2Zy5saW5lKCkueChmdW5jdGlvbiAoZCkgewogICAgICAgICAgcmV0dXJuIGxpbmVDaGFydFhTY2FsZShkLmRhdGUpOwogICAgICAgIH0pLnkoZnVuY3Rpb24gKGQpIHsKICAgICAgICAgIHJldHVybiBsaW5lQ2hhcnRZU2NhbGUoZC52YWx1ZSk7CiAgICAgICAgfSkuZGVmaW5lZChmdW5jdGlvbiAoZCkgewogICAgICAgICAgcmV0dXJuIGQudmFsdWUgIT09IG51bGw7CiAgICAgICAgfSk7CiAgICAgICAgbGluZUNoYXJ0R3JvdXAgPSBzdmcuYXBwZW5kKCdnJykuYXR0cignY2xhc3MnLCAnbGluZS1jaGFydCcpLmF0dHIoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUoJyArIG1hcmdpbi5sZWZ0ICsgJywnICsgbWFyZ2luLnRvcCArICcpJyk7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGRyYXdMaW5lQ2hhcnQoZGF0YSkgewogICAgICAgIC8vIEFkZCBib3JkZXIgcm91bmQgcGxvdCBhcmVhLgogICAgICAgIGxpbmVDaGFydEdyb3VwLmFwcGVuZCgncmVjdCcpLmF0dHIoJ3gnLCAwKS5hdHRyKCd5JywgMCkuYXR0cignaGVpZ2h0JywgY2hhcnRIZWlnaHQpLmF0dHIoJ3dpZHRoJywgdml6V2lkdGgpLnN0eWxlKCdzdHJva2UnLCAnI2NjY2NjYycpLnN0eWxlKCdmaWxsJywgJ25vbmUnKS5zdHlsZSgnc3Ryb2tlLXdpZHRoJywgMSk7CiAgICAgICAgZHJhd0xpbmVDaGFydEF4ZXMoKTsKICAgICAgICBkcmF3TGluZUNoYXJ0SGlnaGxpZ2h0ZWRTcGFuKCk7CiAgICAgICAgZHJhd0xpbmVDaGFydFBhdGhzKGRhdGEpOwogICAgICAgICgwLCBfY2hhcnRfdXRpbHMuZHJhd0xpbmVDaGFydERvdHMpKGRhdGEsIGxpbmVDaGFydEdyb3VwLCBsaW5lQ2hhcnRWYWx1ZXNMaW5lKTsKICAgICAgICBkcmF3TGluZUNoYXJ0TWFya2VycyhkYXRhKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gZHJhd0xpbmVDaGFydEF4ZXMoKSB7CiAgICAgICAgLy8gR2V0IHRoZSBzY2FsZWQgZGF0ZSBmb3JtYXQgdG8gdXNlIGZvciB4IGF4aXMgdGljayBsYWJlbHMuCiAgICAgICAgdmFyIHRpbWVCdWNrZXRzID0gbmV3IF90aW1lX2J1Y2tldHMuVGltZUJ1Y2tldHMoKTsKICAgICAgICB2YXIgYm91bmRzID0gewogICAgICAgICAgbWluOiAoMCwgX21vbWVudC5kZWZhdWx0KShjb25maWcucGxvdEVhcmxpZXN0KSwKICAgICAgICAgIG1heDogKDAsIF9tb21lbnQuZGVmYXVsdCkoY29uZmlnLnBsb3RMYXRlc3QpCiAgICAgICAgfTsKICAgICAgICB0aW1lQnVja2V0cy5zZXRCb3VuZHMoYm91bmRzKTsKICAgICAgICB0aW1lQnVja2V0cy5zZXRJbnRlcnZhbCgnYXV0bycpOwogICAgICAgIHZhciB4QXhpc1RpY2tGb3JtYXQgPSB0aW1lQnVja2V0cy5nZXRTY2FsZWREYXRlRm9ybWF0KCk7CiAgICAgICAgdmFyIHRpY2tWYWx1ZXNTdGFydCA9IE1hdGgubWF4KGNvbmZpZy5zZWxlY3RlZEVhcmxpZXN0LCBjb25maWcucGxvdEVhcmxpZXN0KTsgLy8gKzEgbXMgdG8gYWNjb3VudCBmb3IgdGhlIG1zIHRoYXQgd2FzIHN1YnRyYWN0ZWQgZm9yIHF1ZXJ5IGFnZ3JlZ2F0aW9ucy4KCiAgICAgICAgdmFyIGludGVydmFsID0gY29uZmlnLnNlbGVjdGVkTGF0ZXN0IC0gY29uZmlnLnNlbGVjdGVkRWFybGllc3QgKyAxOwogICAgICAgIHZhciB0aWNrVmFsdWVzID0gKDAsIF9jaGFydF91dGlscy5nZXRUaWNrVmFsdWVzKSh0aWNrVmFsdWVzU3RhcnQsIGludGVydmFsLCBjb25maWcucGxvdEVhcmxpZXN0LCBjb25maWcucGxvdExhdGVzdCk7CgogICAgICAgIHZhciB4QXhpcyA9IF9kLmRlZmF1bHQuc3ZnLmF4aXMoKS5zY2FsZShsaW5lQ2hhcnRYU2NhbGUpLm9yaWVudCgnYm90dG9tJykuaW5uZXJUaWNrU2l6ZSgtY2hhcnRIZWlnaHQpLm91dGVyVGlja1NpemUoMCkudGlja1BhZGRpbmcoMTApLnRpY2tGb3JtYXQoZnVuY3Rpb24gKGQpIHsKICAgICAgICAgIHJldHVybiAoMCwgX21vbWVudC5kZWZhdWx0KShkKS5mb3JtYXQoeEF4aXNUaWNrRm9ybWF0KTsKICAgICAgICB9KTsgLy8gV2l0aCB0b29NYW55QnVja2V0cyB0aGUgY2hhcnQgd291bGQgZW5kIHVwIHdpdGggbm8geC1heGlzIGxhYmVscwogICAgICAgIC8vIGJlY2F1c2UgdGhlIHRpY2tzIGFyZSBiYXNlZCBvbiB0aGUgc3BhbiBvZiB0aGUgZW1waGFzaXMgc2VjdGlvbiwKICAgICAgICAvLyBhbmQgdGhlIGhpZ2hsaWdodGVkIGFyZWEgc3BhbnMgdGhlIHdob2xlIGNoYXJ0LgoKCiAgICAgICAgaWYgKHRvb01hbnlCdWNrZXRzID09PSBmYWxzZSkgewogICAgICAgICAgeEF4aXMudGlja1ZhbHVlcyh0aWNrVmFsdWVzKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgeEF4aXMudGlja3MoKDAsIF9jaGFydF91dGlscy5udW1UaWNrc0ZvckRhdGVGb3JtYXQpKHZpeldpZHRoLCB4QXhpc1RpY2tGb3JtYXQpKTsKICAgICAgICB9CgogICAgICAgIHZhciB5QXhpcyA9IF9kLmRlZmF1bHQuc3ZnLmF4aXMoKS5zY2FsZShsaW5lQ2hhcnRZU2NhbGUpLm9yaWVudCgnbGVmdCcpLmlubmVyVGlja1NpemUoMCkub3V0ZXJUaWNrU2l6ZSgwKS50aWNrUGFkZGluZygxMCk7CgogICAgICAgIGlmIChmaWVsZEZvcm1hdCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICB5QXhpcy50aWNrRm9ybWF0KGZ1bmN0aW9uIChkKSB7CiAgICAgICAgICAgIHJldHVybiBmaWVsZEZvcm1hdC5jb252ZXJ0KGQsICd0ZXh0Jyk7CiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIHZhciBheGVzID0gbGluZUNoYXJ0R3JvdXAuYXBwZW5kKCdnJyk7CiAgICAgICAgdmFyIGdBeGlzID0gYXhlcy5hcHBlbmQoJ2cnKS5hdHRyKCdjbGFzcycsICd4IGF4aXMnKS5hdHRyKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlKDAsJyArIGNoYXJ0SGVpZ2h0ICsgJyknKS5jYWxsKHhBeGlzKTsKICAgICAgICBheGVzLmFwcGVuZCgnZycpLmF0dHIoJ2NsYXNzJywgJ3kgYXhpcycpLmNhbGwoeUF4aXMpOwoKICAgICAgICBpZiAodG9vTWFueUJ1Y2tldHMgPT09IGZhbHNlKSB7CiAgICAgICAgICAoMCwgX2NoYXJ0X3V0aWxzLnJlbW92ZUxhYmVsT3ZlcmxhcCkoZ0F4aXMsIHRpY2tWYWx1ZXNTdGFydCwgaW50ZXJ2YWwsIHZpeldpZHRoKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGRyYXdMaW5lQ2hhcnRIaWdobGlnaHRlZFNwYW4oKSB7CiAgICAgICAgLy8gRHJhd3MgYSByZWN0YW5nbGUgd2hpY2ggaGlnaGxpZ2h0cyB0aGUgdGltZSBzcGFuIHRoYXQgaGFzIGJlZW4gc2VsZWN0ZWQgZm9yIHZpZXcuCiAgICAgICAgLy8gTm90ZSBkZXBlbmRpbmcgb24gdGhlIG92ZXJhbGwgdGltZSByYW5nZSBhbmQgdGhlIGJ1Y2tldCBzcGFuLCB0aGUgc2VsZWN0ZWQgdGltZQogICAgICAgIC8vIHNwYW4gbWF5IGJlIGxvbmdlciB0aGFuIHRoZSByYW5nZSBhY3R1YWxseSBiZWluZyBwbG90dGVkLgogICAgICAgIHZhciByZWN0U3RhcnQgPSBNYXRoLm1heChjb25maWcuc2VsZWN0ZWRFYXJsaWVzdCwgY29uZmlnLnBsb3RFYXJsaWVzdCk7CiAgICAgICAgdmFyIHJlY3RFbmQgPSBNYXRoLm1pbihjb25maWcuc2VsZWN0ZWRMYXRlc3QsIGNvbmZpZy5wbG90TGF0ZXN0KTsKICAgICAgICB2YXIgcmVjdFdpZHRoID0gbGluZUNoYXJ0WFNjYWxlKHJlY3RFbmQpIC0gbGluZUNoYXJ0WFNjYWxlKHJlY3RTdGFydCk7CiAgICAgICAgbGluZUNoYXJ0R3JvdXAuYXBwZW5kKCdyZWN0JykuYXR0cignY2xhc3MnLCAnc2VsZWN0ZWQtaW50ZXJ2YWwnKS5hdHRyKCd4JywgbGluZUNoYXJ0WFNjYWxlKG5ldyBEYXRlKHJlY3RTdGFydCkpICsgMikuYXR0cigneScsIDIpLmF0dHIoJ3J4JywgMykuYXR0cigncnknLCAzKS5hdHRyKCd3aWR0aCcsIHJlY3RXaWR0aCAtIDQpLmF0dHIoJ2hlaWdodCcsIGNoYXJ0SGVpZ2h0IC0gNCk7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGRyYXdMaW5lQ2hhcnRQYXRocyhkYXRhKSB7CiAgICAgICAgbGluZUNoYXJ0R3JvdXAuYXBwZW5kKCdwYXRoJykuYXR0cignY2xhc3MnLCAndmFsdWVzLWxpbmUnKS5hdHRyKCdkJywgbGluZUNoYXJ0VmFsdWVzTGluZShkYXRhKSk7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGRyYXdMaW5lQ2hhcnRNYXJrZXJzKGRhdGEpIHsKICAgICAgICAvLyBSZW5kZXIgY2lyY2xlIG1hcmtlcnMgZm9yIHRoZSBwb2ludHMuCiAgICAgICAgLy8gVGhlc2UgYXJlIHVzZWQgZm9yIGRpc3BsYXlpbmcgdG9vbHRpcHMgb24gbW91c2VvdmVyLgogICAgICAgIC8vIERvbid0IHJlbmRlciBkb3RzIHdoZXJlIHZhbHVlPW51bGwgKGRhdGEgZ2Fwcywgd2l0aCBubyBhbm9tYWxpZXMpCiAgICAgICAgLy8gb3IgZm9yIG11bHRpLWJ1Y2tldCBhbm9tYWxpZXMuCiAgICAgICAgdmFyIGRvdHMgPSBsaW5lQ2hhcnRHcm91cC5hcHBlbmQoJ2cnKS5hdHRyKCdjbGFzcycsICdjaGFydC1tYXJrZXJzJykuc2VsZWN0QWxsKCcubWV0cmljLXZhbHVlJykuZGF0YShkYXRhLmZpbHRlcihmdW5jdGlvbiAoZCkgewogICAgICAgICAgcmV0dXJuIChkLnZhbHVlICE9PSBudWxsIHx8IHR5cGVvZiBkLmFub21hbHlTY29yZSA9PT0gJ251bWJlcicpICYmICEoMCwgX2NoYXJ0X3V0aWxzLnNob3dNdWx0aUJ1Y2tldEFub21hbHlNYXJrZXIpKGQpOwogICAgICAgIH0pKTsgLy8gUmVtb3ZlIGRvdHMgdGhhdCBhcmUgbm8gbG9uZ2VyIG5lZWRlZCBpLmUuIGlmIG51bWJlciBvZiBjaGFydCBwb2ludHMgaGFzIGRlY3JlYXNlZC4KCiAgICAgICAgZG90cy5leGl0KCkucmVtb3ZlKCk7IC8vIENyZWF0ZSBhbnkgbmV3IGRvdHMgdGhhdCBhcmUgbmVlZGVkIGkuZS4gaWYgbnVtYmVyIG9mIGNoYXJ0IHBvaW50cyBoYXMgaW5jcmVhc2VkLgoKICAgICAgICBkb3RzLmVudGVyKCkuYXBwZW5kKCdjaXJjbGUnKS5hdHRyKCdyJywgX2NoYXJ0X3V0aWxzLkxJTkVfQ0hBUlRfQU5PTUFMWV9SQURJVVMpIC8vIERvbid0IHVzZSBhbiBhcnJvdyBmdW5jdGlvbiBzaW5jZSB3ZSBuZWVkIGFjY2VzcyB0byBgdGhpc2AuCiAgICAgICAgLm9uKCdtb3VzZW92ZXInLCBmdW5jdGlvbiAoZCkgewogICAgICAgICAgc2hvd0xpbmVDaGFydFRvb2x0aXAoZCwgdGhpcyk7CiAgICAgICAgfSkub24oJ21vdXNlb3V0JywgZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIF9jaGFydF90b29sdGlwX3NlcnZpY2UubWxDaGFydFRvb2x0aXBTZXJ2aWNlLmhpZGUoKTsKICAgICAgICB9KTsKCiAgICAgICAgdmFyIGlzQW5vbWFseVZpc2libGUgPSBmdW5jdGlvbiBpc0Fub21hbHlWaXNpYmxlKGQpIHsKICAgICAgICAgIHJldHVybiBfbG9kYXNoLmRlZmF1bHQuaGFzKGQsICdhbm9tYWx5U2NvcmUnKSAmJiBOdW1iZXIoZC5hbm9tYWx5U2NvcmUpID49IHNldmVyaXR5OwogICAgICAgIH07IC8vIFVwZGF0ZSBhbGwgZG90cyB0byBuZXcgcG9zaXRpb25zLgoKCiAgICAgICAgZG90cy5hdHRyKCdjeCcsIGZ1bmN0aW9uIChkKSB7CiAgICAgICAgICByZXR1cm4gbGluZUNoYXJ0WFNjYWxlKGQuZGF0ZSk7CiAgICAgICAgfSkuYXR0cignY3knLCBmdW5jdGlvbiAoZCkgewogICAgICAgICAgcmV0dXJuIGxpbmVDaGFydFlTY2FsZShkLnZhbHVlKTsKICAgICAgICB9KS5hdHRyKCdjbGFzcycsIGZ1bmN0aW9uIChkKSB7CiAgICAgICAgICB2YXIgbWFya2VyQ2xhc3MgPSAnbWV0cmljLXZhbHVlJzsKCiAgICAgICAgICBpZiAoaXNBbm9tYWx5VmlzaWJsZShkKSkgewogICAgICAgICAgICBtYXJrZXJDbGFzcyArPSAiIGFub21hbHktbWFya2VyICIuY29uY2F0KCgwLCBfYW5vbWFseV91dGlscy5nZXRTZXZlcml0eVdpdGhMb3cpKGQuYW5vbWFseVNjb3JlKS5pZCk7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIG1hcmtlckNsYXNzOwogICAgICAgIH0pOyAvLyBSZW5kZXIgY3Jvc3Mgc3ltYm9scyBmb3IgYW55IG11bHRpLWJ1Y2tldCBhbm9tYWxpZXMuCgogICAgICAgIHZhciBtdWx0aUJ1Y2tldE1hcmtlcnMgPSBsaW5lQ2hhcnRHcm91cC5zZWxlY3QoJy5jaGFydC1tYXJrZXJzJykuc2VsZWN0QWxsKCcubXVsdGktYnVja2V0JykuZGF0YShkYXRhLmZpbHRlcihmdW5jdGlvbiAoZCkgewogICAgICAgICAgcmV0dXJuIGlzQW5vbWFseVZpc2libGUoZCkgJiYgKDAsIF9jaGFydF91dGlscy5zaG93TXVsdGlCdWNrZXRBbm9tYWx5TWFya2VyKShkKSA9PT0gdHJ1ZTsKICAgICAgICB9KSk7IC8vIFJlbW92ZSBtdWx0aS1idWNrZXQgbWFya2VycyB0aGF0IGFyZSBubyBsb25nZXIgbmVlZGVkCgogICAgICAgIG11bHRpQnVja2V0TWFya2Vycy5leGl0KCkucmVtb3ZlKCk7IC8vIEFwcGVuZCB0aGUgbXVsdGktYnVja2V0IG1hcmtlcnMgYW5kIHBvc2l0aW9uIG9uIGNoYXJ0LgoKICAgICAgICBtdWx0aUJ1Y2tldE1hcmtlcnMuZW50ZXIoKS5hcHBlbmQoJ3BhdGgnKS5hdHRyKCdkJywgX2QuZGVmYXVsdC5zdmcuc3ltYm9sKCkuc2l6ZShfY2hhcnRfdXRpbHMuTVVMVElfQlVDS0VUX1NZTUJPTF9TSVpFKS50eXBlKCdjcm9zcycpKS5hdHRyKCd0cmFuc2Zvcm0nLCBmdW5jdGlvbiAoZCkgewogICAgICAgICAgcmV0dXJuICJ0cmFuc2xhdGUoIi5jb25jYXQobGluZUNoYXJ0WFNjYWxlKGQuZGF0ZSksICIsICIpLmNvbmNhdChsaW5lQ2hhcnRZU2NhbGUoZC52YWx1ZSksICIpIik7CiAgICAgICAgfSkuYXR0cignY2xhc3MnLCBmdW5jdGlvbiAoZCkgewogICAgICAgICAgcmV0dXJuICJhbm9tYWx5LW1hcmtlciBtdWx0aS1idWNrZXQgIi5jb25jYXQoKDAsIF9hbm9tYWx5X3V0aWxzLmdldFNldmVyaXR5V2l0aExvdykoZC5hbm9tYWx5U2NvcmUpLmlkKTsKICAgICAgICB9KSAvLyBEb24ndCB1c2UgYW4gYXJyb3cgZnVuY3Rpb24gc2luY2Ugd2UgbmVlZCBhY2Nlc3MgdG8gYHRoaXNgLgogICAgICAgIC5vbignbW91c2VvdmVyJywgZnVuY3Rpb24gKGQpIHsKICAgICAgICAgIHNob3dMaW5lQ2hhcnRUb29sdGlwKGQsIHRoaXMpOwogICAgICAgIH0pLm9uKCdtb3VzZW91dCcsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBfY2hhcnRfdG9vbHRpcF9zZXJ2aWNlLm1sQ2hhcnRUb29sdGlwU2VydmljZS5oaWRlKCk7CiAgICAgICAgfSk7IC8vIEFkZCByZWN0YW5ndWxhciBtYXJrZXJzIGZvciBhbnkgc2NoZWR1bGVkIGV2ZW50cy4KCiAgICAgICAgdmFyIHNjaGVkdWxlZEV2ZW50TWFya2VycyA9IGxpbmVDaGFydEdyb3VwLnNlbGVjdCgnLmNoYXJ0LW1hcmtlcnMnKS5zZWxlY3RBbGwoJy5zY2hlZHVsZWQtZXZlbnQtbWFya2VyJykuZGF0YShkYXRhLmZpbHRlcihmdW5jdGlvbiAoZCkgewogICAgICAgICAgcmV0dXJuIGQuc2NoZWR1bGVkRXZlbnRzICE9PSB1bmRlZmluZWQ7CiAgICAgICAgfSkpOyAvLyBSZW1vdmUgbWFya2VycyB0aGF0IGFyZSBubyBsb25nZXIgbmVlZGVkIGkuZS4gaWYgbnVtYmVyIG9mIGNoYXJ0IHBvaW50cyBoYXMgZGVjcmVhc2VkLgoKICAgICAgICBzY2hlZHVsZWRFdmVudE1hcmtlcnMuZXhpdCgpLnJlbW92ZSgpOyAvLyBDcmVhdGUgYW55IG5ldyBtYXJrZXJzIHRoYXQgYXJlIG5lZWRlZCBpLmUuIGlmIG51bWJlciBvZiBjaGFydCBwb2ludHMgaGFzIGluY3JlYXNlZC4KCiAgICAgICAgc2NoZWR1bGVkRXZlbnRNYXJrZXJzLmVudGVyKCkuYXBwZW5kKCdyZWN0JykuYXR0cignd2lkdGgnLCBfY2hhcnRfdXRpbHMuTElORV9DSEFSVF9BTk9NQUxZX1JBRElVUyAqIDIpLmF0dHIoJ2hlaWdodCcsIF9jaGFydF91dGlscy5TQ0hFRFVMRURfRVZFTlRfU1lNQk9MX0hFSUdIVCkuYXR0cignY2xhc3MnLCAnc2NoZWR1bGVkLWV2ZW50LW1hcmtlcicpLmF0dHIoJ3J4JywgMSkuYXR0cigncnknLCAxKTsgLy8gVXBkYXRlIGFsbCBtYXJrZXJzIHRvIG5ldyBwb3NpdGlvbnMuCgogICAgICAgIHNjaGVkdWxlZEV2ZW50TWFya2Vycy5hdHRyKCd4JywgZnVuY3Rpb24gKGQpIHsKICAgICAgICAgIHJldHVybiBsaW5lQ2hhcnRYU2NhbGUoZC5kYXRlKSAtIF9jaGFydF91dGlscy5MSU5FX0NIQVJUX0FOT01BTFlfUkFESVVTOwogICAgICAgIH0pLmF0dHIoJ3knLCBmdW5jdGlvbiAoZCkgewogICAgICAgICAgcmV0dXJuIGxpbmVDaGFydFlTY2FsZShkLnZhbHVlKSAtIF9jaGFydF91dGlscy5TQ0hFRFVMRURfRVZFTlRfU1lNQk9MX0hFSUdIVCAvIDI7CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIHNob3dMaW5lQ2hhcnRUb29sdGlwKG1hcmtlciwgY2lyY2xlKSB7CiAgICAgICAgLy8gU2hvdyB0aGUgdGltZSBhbmQgbWV0cmljIHZhbHVlcyBpbiB0aGUgdG9vbHRpcC4KICAgICAgICAvLyBVc2VzIGRhdGUsIHZhbHVlLCB1cHBlciwgbG93ZXIgYW5kIGFub21hbHlTY29yZSAob3B0aW9uYWwpIG1hcmtlciBwcm9wZXJ0aWVzLgogICAgICAgIHZhciBmb3JtYXR0ZWREYXRlID0gKDAsIF9kYXRlX3V0aWxzLmZvcm1hdEh1bWFuUmVhZGFibGVEYXRlVGltZSkobWFya2VyLmRhdGUpOwogICAgICAgIHZhciB0b29sdGlwRGF0YSA9IFt7CiAgICAgICAgICBuYW1lOiBmb3JtYXR0ZWREYXRlCiAgICAgICAgfV07CiAgICAgICAgdmFyIHNlcmllc0tleSA9IGNvbmZpZy5kZXRlY3RvckxhYmVsOwoKICAgICAgICBpZiAoX2xvZGFzaC5kZWZhdWx0LmhhcyhtYXJrZXIsICdhbm9tYWx5U2NvcmUnKSkgewogICAgICAgICAgdmFyIHNjb3JlID0gcGFyc2VJbnQobWFya2VyLmFub21hbHlTY29yZSk7CiAgICAgICAgICB2YXIgZGlzcGxheVNjb3JlID0gc2NvcmUgPiAwID8gc2NvcmUgOiAnPCAxJzsKICAgICAgICAgIHRvb2x0aXBEYXRhLnB1c2goewogICAgICAgICAgICBuYW1lOiBpbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgICAgIGlkOiAneHBhY2subWwuZXhwbG9yZXIuc2luZ2xlTWV0cmljQ2hhcnQuYW5vbWFseVNjb3JlTGFiZWwnLAogICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnYW5vbWFseSBzY29yZScKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIHZhbHVlOiBkaXNwbGF5U2NvcmUsCiAgICAgICAgICAgIGNvbG9yOiAoMCwgX2Fub21hbHlfdXRpbHMuZ2V0U2V2ZXJpdHlDb2xvcikoc2NvcmUpLAogICAgICAgICAgICBzZXJpZXNLZXk6IHNlcmllc0tleSwKICAgICAgICAgICAgeUFjY2Vzc29yOiAnYW5vbWFseV9zY29yZScKICAgICAgICAgIH0pOwoKICAgICAgICAgIGlmICgoMCwgX2NoYXJ0X3V0aWxzLnNob3dNdWx0aUJ1Y2tldEFub21hbHlUb29sdGlwKShtYXJrZXIpID09PSB0cnVlKSB7CiAgICAgICAgICAgIHRvb2x0aXBEYXRhLnB1c2goewogICAgICAgICAgICAgIG5hbWU6IGludGwuZm9ybWF0TWVzc2FnZSh7CiAgICAgICAgICAgICAgICBpZDogJ3hwYWNrLm1sLmV4cGxvcmVyLnNpbmdsZU1ldHJpY0NoYXJ0Lm11bHRpQnVja2V0SW1wYWN0TGFiZWwnLAogICAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdtdWx0aS1idWNrZXQgaW1wYWN0JwogICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgIHZhbHVlOiAoMCwgX2Fub21hbHlfdXRpbHMuZ2V0TXVsdGlCdWNrZXRJbXBhY3RMYWJlbCkobWFya2VyLm11bHRpQnVja2V0SW1wYWN0KSwKICAgICAgICAgICAgICBzZXJpZXNLZXk6IHNlcmllc0tleSwKICAgICAgICAgICAgICB5QWNjZXNzb3I6ICdtdWx0aV9idWNrZXRfaW1wYWN0JwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gLy8gU2hvdyBhY3R1YWwvdHlwaWNhbCB3aGVuIGF2YWlsYWJsZSBleGNlcHQgZm9yIHJhcmUgZGV0ZWN0b3JzLgogICAgICAgICAgLy8gUmFyZSBkZXRlY3RvcnMgYWx3YXlzIGhhdmUgMSBhcyBhY3R1YWwgYW5kIHRoZSBwcm9iYWJpbGl0eSBhcyB0eXBpY2FsLgogICAgICAgICAgLy8gRXhwb3NpbmcgdGhvc2UgdmFsdWVzIGluIHRoZSB0b29sdGlwIHdpdGggYWN0dWFsL3R5cGljYWwgbGFiZWxzIG1pZ2h0IGlycml0YXRlIHVzZXJzLgoKCiAgICAgICAgICBpZiAoX2xvZGFzaC5kZWZhdWx0LmhhcyhtYXJrZXIsICdhY3R1YWwnKSAmJiBjb25maWcuZnVuY3Rpb25EZXNjcmlwdGlvbiAhPT0gJ3JhcmUnKSB7CiAgICAgICAgICAgIC8vIERpc3BsYXkgdGhlIHJlY29yZCBhY3R1YWwgaW4gcHJlZmVyZW5jZSB0byB0aGUgY2hhcnQgdmFsdWUsIHdoaWNoIG1heSBiZQogICAgICAgICAgICAvLyBkaWZmZXJlbnQgZGVwZW5kaW5nIG9uIHRoZSBhZ2dyZWdhdGlvbiBpbnRlcnZhbCBvZiB0aGUgY2hhcnQuCiAgICAgICAgICAgIHRvb2x0aXBEYXRhLnB1c2goewogICAgICAgICAgICAgIG5hbWU6IGludGwuZm9ybWF0TWVzc2FnZSh7CiAgICAgICAgICAgICAgICBpZDogJ3hwYWNrLm1sLmV4cGxvcmVyLnNpbmdsZU1ldHJpY0NoYXJ0LmFjdHVhbExhYmVsJywKICAgICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnYWN0dWFsJwogICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgIHZhbHVlOiAoMCwgX2Zvcm1hdF92YWx1ZS5mb3JtYXRWYWx1ZSkobWFya2VyLmFjdHVhbCwgY29uZmlnLmZ1bmN0aW9uRGVzY3JpcHRpb24sIGZpZWxkRm9ybWF0KSwKICAgICAgICAgICAgICBzZXJpZXNLZXk6IHNlcmllc0tleSwKICAgICAgICAgICAgICB5QWNjZXNzb3I6ICdhY3R1YWwnCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB0b29sdGlwRGF0YS5wdXNoKHsKICAgICAgICAgICAgICBuYW1lOiBpbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgICAgICAgaWQ6ICd4cGFjay5tbC5leHBsb3Jlci5zaW5nbGVNZXRyaWNDaGFydC50eXBpY2FsTGFiZWwnLAogICAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICd0eXBpY2FsJwogICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgIHZhbHVlOiAoMCwgX2Zvcm1hdF92YWx1ZS5mb3JtYXRWYWx1ZSkobWFya2VyLnR5cGljYWwsIGNvbmZpZy5mdW5jdGlvbkRlc2NyaXB0aW9uLCBmaWVsZEZvcm1hdCksCiAgICAgICAgICAgICAgc2VyaWVzS2V5OiBzZXJpZXNLZXksCiAgICAgICAgICAgICAgeUFjY2Vzc29yOiAndHlwaWNhbCcKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0b29sdGlwRGF0YS5wdXNoKHsKICAgICAgICAgICAgICBuYW1lOiBpbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgICAgICAgaWQ6ICd4cGFjay5tbC5leHBsb3Jlci5zaW5nbGVNZXRyaWNDaGFydC52YWx1ZUxhYmVsJywKICAgICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAndmFsdWUnCiAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgdmFsdWU6ICgwLCBfZm9ybWF0X3ZhbHVlLmZvcm1hdFZhbHVlKShtYXJrZXIudmFsdWUsIGNvbmZpZy5mdW5jdGlvbkRlc2NyaXB0aW9uLCBmaWVsZEZvcm1hdCksCiAgICAgICAgICAgICAgc2VyaWVzS2V5OiBzZXJpZXNLZXksCiAgICAgICAgICAgICAgeUFjY2Vzc29yOiAndmFsdWUnCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgaWYgKF9sb2Rhc2guZGVmYXVsdC5oYXMobWFya2VyLCAnYnlGaWVsZE5hbWUnKSAmJiBfbG9kYXNoLmRlZmF1bHQuaGFzKG1hcmtlciwgJ251bWJlck9mQ2F1c2VzJykpIHsKICAgICAgICAgICAgICB0b29sdGlwRGF0YS5wdXNoKHsKICAgICAgICAgICAgICAgIG5hbWU6IGludGwuZm9ybWF0TWVzc2FnZSh7CiAgICAgICAgICAgICAgICAgIGlkOiAneHBhY2subWwuZXhwbG9yZXIuZGlzdHJpYnV0aW9uQ2hhcnQudW51c3VhbEJ5RmllbGRWYWx1ZXNMYWJlbCcsCiAgICAgICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAneyBudW1iZXJPZkNhdXNlcywgcGx1cmFsLCBvbmUgeyMgdW51c3VhbCB7YnlGaWVsZE5hbWV9IHZhbHVlfSBvdGhlciB7I3twbHVzU2lnbn0gdW51c3VhbCB7YnlGaWVsZE5hbWV9IHZhbHVlc319JwogICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgICBudW1iZXJPZkNhdXNlczogbWFya2VyLm51bWJlck9mQ2F1c2VzLAogICAgICAgICAgICAgICAgICBieUZpZWxkTmFtZTogbWFya2VyLmJ5RmllbGROYW1lLAogICAgICAgICAgICAgICAgICAvLyBNYXhpbXVtIG9mIDEwIGNhdXNlcyBhcmUgc3RvcmVkIGluIHRoZSByZWNvcmQsIHNvICcxMCcgbWF5IG1lYW4gbW9yZSB0aGFuIDEwLgogICAgICAgICAgICAgICAgICBwbHVzU2lnbjogbWFya2VyLm51bWJlck9mQ2F1c2VzIDwgMTAgPyAnJyA6ICcrJwogICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgICBzZXJpZXNLZXk6IHNlcmllc0tleSwKICAgICAgICAgICAgICAgIHlBY2Nlc3NvcjogJ251bWJlck9mQ2F1c2VzJwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRvb2x0aXBEYXRhLnB1c2goewogICAgICAgICAgICBuYW1lOiBpbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgICAgIGlkOiAneHBhY2subWwuZXhwbG9yZXIuc2luZ2xlTWV0cmljQ2hhcnQudmFsdWVXaXRob3V0QW5vbWFseVNjb3JlTGFiZWwnLAogICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAndmFsdWUnCiAgICAgICAgICAgIH0pLAogICAgICAgICAgICB2YWx1ZTogKDAsIF9mb3JtYXRfdmFsdWUuZm9ybWF0VmFsdWUpKG1hcmtlci52YWx1ZSwgY29uZmlnLmZ1bmN0aW9uRGVzY3JpcHRpb24sIGZpZWxkRm9ybWF0KSwKICAgICAgICAgICAgc2VyaWVzS2V5OiBzZXJpZXNLZXksCiAgICAgICAgICAgIHlBY2Nlc3NvcjogJ3ZhbHVlJwogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoX2xvZGFzaC5kZWZhdWx0LmhhcyhtYXJrZXIsICdzY2hlZHVsZWRFdmVudHMnKSkgewogICAgICAgICAgdG9vbHRpcERhdGEucHVzaCh7CiAgICAgICAgICAgIG5hbWU6IGludGwuZm9ybWF0TWVzc2FnZSh7CiAgICAgICAgICAgICAgaWQ6ICd4cGFjay5tbC5leHBsb3Jlci5zaW5nbGVNZXRyaWNDaGFydC5zY2hlZHVsZWRFdmVudHNMYWJlbCcsCiAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdTY2hlZHVsZWQgZXZlbnRzJwogICAgICAgICAgICB9KSwKICAgICAgICAgICAgdmFsdWU6IG1hcmtlci5zY2hlZHVsZWRFdmVudHMubWFwKF9zdHJpbmdfdXRpbHMubWxFc2NhcGUpLmpvaW4oJzxici8+JykKICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgX2NoYXJ0X3Rvb2x0aXBfc2VydmljZS5tbENoYXJ0VG9vbHRpcFNlcnZpY2Uuc2hvdyh0b29sdGlwRGF0YSwgY2lyY2xlLCB7CiAgICAgICAgICB4OiBfY2hhcnRfdXRpbHMuTElORV9DSEFSVF9BTk9NQUxZX1JBRElVUyAqIDMsCiAgICAgICAgICB5OiBfY2hhcnRfdXRpbHMuTElORV9DSEFSVF9BTk9NQUxZX1JBRElVUyAqIDIKICAgICAgICB9KTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogInNob3VsZENvbXBvbmVudFVwZGF0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2hvdWxkQ29tcG9uZW50VXBkYXRlKCkgewogICAgICAvLyBBbHdheXMgcmV0dXJuIHRydWUsIGQzIHdpbGwgdGFrZSBjYXJlIG9mIGFwcHJvcHJpYXRlIHJlLXJlbmRlcmluZy4KICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0UmVmIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRSZWYoY29tcG9uZW50Tm9kZSkgewogICAgICB0aGlzLnJvb3ROb2RlID0gY29tcG9uZW50Tm9kZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHsKICAgICAgdmFyIHNlcmllc0NvbmZpZyA9IHRoaXMucHJvcHMuc2VyaWVzQ29uZmlnOwoKICAgICAgaWYgKHR5cGVvZiBzZXJpZXNDb25maWcgPT09ICd1bmRlZmluZWQnKSB7CiAgICAgICAgLy8ganVzdCByZXR1cm4gc28gdGhlIGVtcHR5IGRpcmVjdGl2ZSByZW5kZXJzIHdpdGhvdXQgYW4gZXJyb3IgbGF0ZXIgb24KICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfSAvLyBjcmVhdGUgYSBjaGFydCBsb2FkaW5nIHBsYWNlaG9sZGVyCgoKICAgICAgdmFyIGlzTG9hZGluZyA9IHNlcmllc0NvbmZpZy5sb2FkaW5nOwogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgIGNsYXNzTmFtZTogIm1sLWV4cGxvcmVyLWNoYXJ0IiwKICAgICAgICByZWY6IHRoaXMuc2V0UmVmLmJpbmQodGhpcykKICAgICAgfSwgaXNMb2FkaW5nICYmIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2xvYWRpbmdfaW5kaWNhdG9yLkxvYWRpbmdJbmRpY2F0b3IsIHsKICAgICAgICBoZWlnaHQ6IENPTlRFTlRfV1JBUFBFUl9IRUlHSFQKICAgICAgfSksICFpc0xvYWRpbmcgJiYgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgIGNsYXNzTmFtZTogQ09OVEVOVF9XUkFQUEVSX0NMQVNTCiAgICAgIH0pKTsKICAgIH0KICB9XSk7CgogIHJldHVybiBFeHBsb3JlckNoYXJ0U2luZ2xlTWV0cmljOwp9KF9yZWFjdC5kZWZhdWx0LkNvbXBvbmVudCksIF9kZWZpbmVQcm9wZXJ0eShfY2xhc3MsICJwcm9wVHlwZXMiLCB7CiAgdG9vTWFueUJ1Y2tldHM6IF9wcm9wVHlwZXMuZGVmYXVsdC5ib29sLAogIHNlcmllc0NvbmZpZzogX3Byb3BUeXBlcy5kZWZhdWx0Lm9iamVjdCwKICBzZXZlcml0eTogX3Byb3BUeXBlcy5kZWZhdWx0Lm51bWJlci5pc1JlcXVpcmVkCn0pLCBfdGVtcCkpOwpleHBvcnRzLkV4cGxvcmVyQ2hhcnRTaW5nbGVNZXRyaWMgPSBFeHBsb3JlckNoYXJ0U2luZ2xlTWV0cmljOw=="},null]}