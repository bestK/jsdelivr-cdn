{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/ml/public/application/components/annotations/annotations_table/annotations_table.js","dependencies":[{"path":"x-pack/legacy/plugins/ml/public/application/components/annotations/annotations_table/annotations_table.js","mtime":1585205045433},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkFubm90YXRpb25zVGFibGUgPSB2b2lkIDA7Cgp2YXIgX2xvZGFzaCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgibG9kYXNoIikpOwoKdmFyIF9wcm9wVHlwZXMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoInByb3AtdHlwZXMiKSk7Cgp2YXIgX3Jpc29uTm9kZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgicmlzb24tbm9kZSIpKTsKCnZhciBfcmVhY3QgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKCJyZWFjdCIpKTsKCnZhciBfZXVpID0gcmVxdWlyZSgiQGVsYXN0aWMvZXVpIik7Cgp2YXIgX3NlcnZpY2VzID0gcmVxdWlyZSgiQGVsYXN0aWMvZXVpL2xpYi9zZXJ2aWNlcyIpOwoKdmFyIF9mb3JtYXQgPSByZXF1aXJlKCJAZWxhc3RpYy9ldWkvbGliL3NlcnZpY2VzL2Zvcm1hdCIpOwoKdmFyIF9yZWNlbnRseV9hY2Nlc3NlZCA9IHJlcXVpcmUoIi4uLy4uLy4uL3V0aWwvcmVjZW50bHlfYWNjZXNzZWQiKTsKCnZhciBfbWxfYXBpX3NlcnZpY2UgPSByZXF1aXJlKCIuLi8uLi8uLi9zZXJ2aWNlcy9tbF9hcGlfc2VydmljZSIpOwoKdmFyIF9qb2Jfc2VydmljZSA9IHJlcXVpcmUoIi4uLy4uLy4uL3NlcnZpY2VzL2pvYl9zZXJ2aWNlIik7Cgp2YXIgX3RhYmxlX3NlcnZpY2UgPSByZXF1aXJlKCIuLi8uLi8uLi9zZXJ2aWNlcy90YWJsZV9zZXJ2aWNlIik7Cgp2YXIgX3NlYXJjaCA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uLy4uL2NvbW1vbi9jb25zdGFudHMvc2VhcmNoIik7Cgp2YXIgX2pvYl91dGlscyA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uLy4uL2NvbW1vbi91dGlsL2pvYl91dGlscyIpOwoKdmFyIF9hbm5vdGF0aW9uc19zZXJ2aWNlID0gcmVxdWlyZSgiLi4vLi4vLi4vc2VydmljZXMvYW5ub3RhdGlvbnNfc2VydmljZSIpOwoKdmFyIF9yZWFjdDIgPSByZXF1aXJlKCJAa2JuL2kxOG4vcmVhY3QiKTsKCnZhciBfY2xhc3MsIF90ZW1wOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7IGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsgcmV0dXJuIG9iajsgfSBlbHNlIHsgdmFyIG5ld09iaiA9IHt9OyBpZiAob2JqICE9IG51bGwpIHsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgeyB2YXIgZGVzYyA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSAmJiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID8gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIGtleSkgOiB7fTsgaWYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmosIGtleSwgZGVzYyk7IH0gZWxzZSB7IG5ld09ialtrZXldID0gb2JqW2tleV07IH0gfSB9IH0gbmV3T2JqLmRlZmF1bHQgPSBvYmo7IHJldHVybiBuZXdPYmo7IH0gfQoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiKSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfTsgfSBlbHNlIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyAic3ltYm9sIiA6IHR5cGVvZiBvYmo7IH07IH0gcmV0dXJuIF90eXBlb2Yob2JqKTsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH0KCmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKGNhbGwgJiYgKF90eXBlb2YoY2FsbCkgPT09ICJvYmplY3QiIHx8IHR5cGVvZiBjYWxsID09PSAiZnVuY3Rpb24iKSkgeyByZXR1cm4gY2FsbDsgfSByZXR1cm4gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKTsgfQoKZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgX2dldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LmdldFByb3RvdHlwZU9mIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgcmV0dXJuIG8uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihvKTsgfTsgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsgfQoKZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7IGlmIChzZWxmID09PSB2b2lkIDApIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsgfSByZXR1cm4gc2VsZjsgfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uIik7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTsgfQoKZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgX3NldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IGZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IG8uX19wcm90b19fID0gcDsgcmV0dXJuIG87IH07IHJldHVybiBfc2V0UHJvdG90eXBlT2YobywgcCk7IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsgaWYgKGtleSBpbiBvYmopIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7IHZhbHVlOiB2YWx1ZSwgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTsgfSBlbHNlIHsgb2JqW2tleV0gPSB2YWx1ZTsgfSByZXR1cm4gb2JqOyB9Cgp2YXIgVElNRV9GT1JNQVQgPSAnWVlZWS1NTS1ERCBISDptbTpzcyc7Ci8qKgogKiBUYWJsZSBjb21wb25lbnQgZm9yIHJlbmRlcmluZyB0aGUgbGlzdHMgb2YgYW5ub3RhdGlvbnMgZm9yIGFuIE1MIGpvYi4KICovCgp2YXIgQW5ub3RhdGlvbnNUYWJsZSA9ICgwLCBfcmVhY3QyLmluamVjdEkxOG4pKChfdGVtcCA9IF9jbGFzcyA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKF9Db21wb25lbnQpIHsKICBfaW5oZXJpdHMoQW5ub3RhdGlvbnNUYWJsZSwgX0NvbXBvbmVudCk7CgogIGZ1bmN0aW9uIEFubm90YXRpb25zVGFibGUocHJvcHMpIHsKICAgIHZhciBfdGhpczsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQW5ub3RhdGlvbnNUYWJsZSk7CgogICAgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfZ2V0UHJvdG90eXBlT2YoQW5ub3RhdGlvbnNUYWJsZSkuY2FsbCh0aGlzLCBwcm9wcykpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImFubm90YXRpb25zUmVmcmVzaFN1YnNjcmlwdGlvbiIsIG51bGwpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInByZXZpb3VzSm9iSWQiLCB1bmRlZmluZWQpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIm9wZW5TaW5nbGVNZXRyaWNWaWV3IiwgZnVuY3Rpb24gKCkgewogICAgICB2YXIgYW5ub3RhdGlvbiA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307CgogICAgICAvLyBDcmVhdGVzIHRoZSBsaW5rIHRvIHRoZSBTaW5nbGUgTWV0cmljIFZpZXdlci4KICAgICAgLy8gU2V0IHRoZSB0b3RhbCB0aW1lIHJhbmdlIGZyb20gdGhlIHN0YXJ0IHRvIHRoZSBlbmQgb2YgdGhlIGFubm90YXRpb24uCiAgICAgIHZhciBqb2IgPSBfdGhpcy5nZXRKb2IoYW5ub3RhdGlvbi5qb2JfaWQpOwoKICAgICAgdmFyIGRhdGFDb3VudHMgPSBqb2IuZGF0YV9jb3VudHM7CiAgICAgIHZhciByZXN1bHRMYXRlc3QgPSAoMCwgX2pvYl91dGlscy5nZXRMYXRlc3REYXRhT3JCdWNrZXRUaW1lc3RhbXApKGRhdGFDb3VudHMubGF0ZXN0X3JlY29yZF90aW1lc3RhbXAsIGRhdGFDb3VudHMubGF0ZXN0X2J1Y2tldF90aW1lc3RhbXApOwogICAgICB2YXIgZnJvbSA9IG5ldyBEYXRlKGRhdGFDb3VudHMuZWFybGllc3RfcmVjb3JkX3RpbWVzdGFtcCkudG9JU09TdHJpbmcoKTsKICAgICAgdmFyIHRvID0gbmV3IERhdGUocmVzdWx0TGF0ZXN0KS50b0lTT1N0cmluZygpOwogICAgICB2YXIgZ2xvYmFsU2V0dGluZ3MgPSB7CiAgICAgICAgbWw6IHsKICAgICAgICAgIGpvYklkczogW2pvYi5qb2JfaWRdCiAgICAgICAgfSwKICAgICAgICByZWZyZXNoSW50ZXJ2YWw6IHsKICAgICAgICAgIGRpc3BsYXk6ICdPZmYnLAogICAgICAgICAgcGF1c2U6IGZhbHNlLAogICAgICAgICAgdmFsdWU6IDAKICAgICAgICB9LAogICAgICAgIHRpbWU6IHsKICAgICAgICAgIGZyb206IGZyb20sCiAgICAgICAgICB0bzogdG8sCiAgICAgICAgICBtb2RlOiAnYWJzb2x1dGUnCiAgICAgICAgfQogICAgICB9OwogICAgICB2YXIgYXBwU3RhdGUgPSB7CiAgICAgICAgcXVlcnk6IHsKICAgICAgICAgIHF1ZXJ5X3N0cmluZzogewogICAgICAgICAgICBhbmFseXplX3dpbGRjYXJkOiB0cnVlLAogICAgICAgICAgICBxdWVyeTogJyonCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9OwoKICAgICAgaWYgKGFubm90YXRpb24udGltZXN0YW1wICE9PSB1bmRlZmluZWQgJiYgYW5ub3RhdGlvbi5lbmRfdGltZXN0YW1wICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBhcHBTdGF0ZS5tbFRpbWVTZXJpZXNFeHBsb3JlciA9IHsKICAgICAgICAgIHpvb206IHsKICAgICAgICAgICAgZnJvbTogbmV3IERhdGUoYW5ub3RhdGlvbi50aW1lc3RhbXApLnRvSVNPU3RyaW5nKCksCiAgICAgICAgICAgIHRvOiBuZXcgRGF0ZShhbm5vdGF0aW9uLmVuZF90aW1lc3RhbXApLnRvSVNPU3RyaW5nKCkKICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICBpZiAoYW5ub3RhdGlvbi50aW1lc3RhbXAgPCBkYXRhQ291bnRzLmVhcmxpZXN0X3JlY29yZF90aW1lc3RhbXApIHsKICAgICAgICAgIGdsb2JhbFNldHRpbmdzLnRpbWUuZnJvbSA9IG5ldyBEYXRlKGFubm90YXRpb24udGltZXN0YW1wKS50b0lTT1N0cmluZygpOwogICAgICAgIH0KCiAgICAgICAgaWYgKGFubm90YXRpb24uZW5kX3RpbWVzdGFtcCA+IGRhdGFDb3VudHMubGF0ZXN0X3JlY29yZF90aW1lc3RhbXApIHsKICAgICAgICAgIGdsb2JhbFNldHRpbmdzLnRpbWUudG8gPSBuZXcgRGF0ZShhbm5vdGF0aW9uLmVuZF90aW1lc3RhbXApLnRvSVNPU3RyaW5nKCk7CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgX2cgPSBfcmlzb25Ob2RlLmRlZmF1bHQuZW5jb2RlKGdsb2JhbFNldHRpbmdzKTsKCiAgICAgIHZhciBfYSA9IF9yaXNvbk5vZGUuZGVmYXVsdC5lbmNvZGUoYXBwU3RhdGUpOwoKICAgICAgdmFyIHVybCA9ICI/X2c9Ii5jb25jYXQoX2csICImX2E9IikuY29uY2F0KF9hKTsKICAgICAgKDAsIF9yZWNlbnRseV9hY2Nlc3NlZC5hZGRJdGVtVG9SZWNlbnRseUFjY2Vzc2VkKSgndGltZXNlcmllc2V4cGxvcmVyJywgam9iLmpvYl9pZCwgdXJsKTsKICAgICAgd2luZG93Lm9wZW4oIiMvdGltZXNlcmllc2V4cGxvcmVyIi5jb25jYXQodXJsKSwgJ19zZWxmJyk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJvbk1vdXNlT3ZlclJvdyIsIGZ1bmN0aW9uIChyZWNvcmQpIHsKICAgICAgaWYgKF90aGlzLm1vdXNlT3ZlclJlY29yZCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgaWYgKF90aGlzLm1vdXNlT3ZlclJlY29yZC5yb3dJZCAhPT0gcmVjb3JkLnJvd0lkKSB7CiAgICAgICAgICAvLyBNb3VzZSBpcyBvdmVyIGEgZGlmZmVyZW50IHJvdywgZmlyZSBtb3VzZWxlYXZlIG9uIHRoZSBwcmV2aW91cyByZWNvcmQuCiAgICAgICAgICBfdGFibGVfc2VydmljZS5tbFRhYmxlU2VydmljZS5yb3dNb3VzZWxlYXZlJC5uZXh0KHsKICAgICAgICAgICAgcmVjb3JkOiBfdGhpcy5tb3VzZU92ZXJSZWNvcmQsCiAgICAgICAgICAgIHR5cGU6ICdhbm5vdGF0aW9uJwogICAgICAgICAgfSk7IC8vIGZpcmUgbW91c2VlbnRlciBvbiB0aGUgbmV3IHJlY29yZC4KCgogICAgICAgICAgX3RhYmxlX3NlcnZpY2UubWxUYWJsZVNlcnZpY2Uucm93TW91c2VlbnRlciQubmV4dCh7CiAgICAgICAgICAgIHJlY29yZDogcmVjb3JkLAogICAgICAgICAgICB0eXBlOiAnYW5ub3RhdGlvbicKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBNb3VzZSBpcyBub3cgb3ZlciBhIHJvdywgZmlyZSBtb3VzZWVudGVyIG9uIHRoZSByZWNvcmQuCiAgICAgICAgX3RhYmxlX3NlcnZpY2UubWxUYWJsZVNlcnZpY2Uucm93TW91c2VlbnRlciQubmV4dCh7CiAgICAgICAgICByZWNvcmQ6IHJlY29yZCwKICAgICAgICAgIHR5cGU6ICdhbm5vdGF0aW9uJwogICAgICAgIH0pOwogICAgICB9CgogICAgICBfdGhpcy5tb3VzZU92ZXJSZWNvcmQgPSByZWNvcmQ7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJvbk1vdXNlTGVhdmVSb3ciLCBmdW5jdGlvbiAoKSB7CiAgICAgIGlmIChfdGhpcy5tb3VzZU92ZXJSZWNvcmQgIT09IHVuZGVmaW5lZCkgewogICAgICAgIF90YWJsZV9zZXJ2aWNlLm1sVGFibGVTZXJ2aWNlLnJvd01vdXNlbGVhdmUkLm5leHQoewogICAgICAgICAgcmVjb3JkOiBfdGhpcy5tb3VzZU92ZXJSZWNvcmQsCiAgICAgICAgICB0eXBlOiAnYW5ub3RhdGlvbicKICAgICAgICB9KTsKCiAgICAgICAgX3RoaXMubW91c2VPdmVyUmVjb3JkID0gdW5kZWZpbmVkOwogICAgICB9CiAgICB9KTsKCiAgICBfdGhpcy5zdGF0ZSA9IHsKICAgICAgYW5ub3RhdGlvbnM6IFtdLAogICAgICBpc0xvYWRpbmc6IGZhbHNlLAogICAgICAvLyBOZWVkIHRvIGRvIGEgZGV0YWlsZWQgY2hlY2sgaGVyZSBiZWNhdXNlIHRoZSBhbmd1bGFyIHdyYXBwZXIgY291bGQgcGFzcyBvbiBzb21ldGhpbmcgbGlrZSBgW3VuZGVmaW5lZF1gLgogICAgICBqb2JJZDogQXJyYXkuaXNBcnJheShfdGhpcy5wcm9wcy5qb2JzKSAmJiBfdGhpcy5wcm9wcy5qb2JzLmxlbmd0aCA+IDAgJiYgX3RoaXMucHJvcHMuam9ic1swXSAhPT0gdW5kZWZpbmVkID8gX3RoaXMucHJvcHMuam9ic1swXS5qb2JfaWQgOiB1bmRlZmluZWQKICAgIH07CiAgICByZXR1cm4gX3RoaXM7CiAgfQoKICBfY3JlYXRlQ2xhc3MoQW5ub3RhdGlvbnNUYWJsZSwgW3sKICAgIGtleTogImdldEFubm90YXRpb25zIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRBbm5vdGF0aW9ucygpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB2YXIgam9iID0gdGhpcy5wcm9wcy5qb2JzWzBdOwogICAgICB2YXIgZGF0YUNvdW50cyA9IGpvYi5kYXRhX2NvdW50czsKICAgICAgdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgaXNMb2FkaW5nOiB0cnVlCiAgICAgIH0pOwoKICAgICAgaWYgKGRhdGFDb3VudHMucHJvY2Vzc2VkX3JlY29yZF9jb3VudCA+IDApIHsKICAgICAgICAvLyBMb2FkIGFubm90YXRpb25zIGZvciB0aGUgc2VsZWN0ZWQgam9iLgogICAgICAgIF9tbF9hcGlfc2VydmljZS5tbC5hbm5vdGF0aW9ucy5nZXRBbm5vdGF0aW9ucyh7CiAgICAgICAgICBqb2JJZHM6IFtqb2Iuam9iX2lkXSwKICAgICAgICAgIGVhcmxpZXN0TXM6IG51bGwsCiAgICAgICAgICBsYXRlc3RNczogbnVsbCwKICAgICAgICAgIG1heEFubm90YXRpb25zOiBfc2VhcmNoLkFOTk9UQVRJT05TX1RBQkxFX0RFRkFVTFRfUVVFUllfU0laRQogICAgICAgIH0pLnRvUHJvbWlzZSgpLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHsKICAgICAgICAgIF90aGlzMi5zZXRTdGF0ZShmdW5jdGlvbiAocHJldlN0YXRlLCBwcm9wcykgewogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgIGFubm90YXRpb25zOiByZXNwLmFubm90YXRpb25zW3Byb3BzLmpvYnNbMF0uam9iX2lkXSB8fCBbXSwKICAgICAgICAgICAgICBlcnJvck1lc3NhZ2U6IHVuZGVmaW5lZCwKICAgICAgICAgICAgICBpc0xvYWRpbmc6IGZhbHNlLAogICAgICAgICAgICAgIGpvYklkOiBwcm9wcy5qb2JzWzBdLmpvYl9pZAogICAgICAgICAgICB9OwogICAgICAgICAgfSk7CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlc3ApIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdFcnJvciBsb2FkaW5nIGxpc3Qgb2YgYW5ub3RhdGlvbnMgZm9yIGpvYnMgbGlzdDonLCByZXNwKTsKCiAgICAgICAgICBfdGhpczIuc2V0U3RhdGUoewogICAgICAgICAgICBhbm5vdGF0aW9uczogW10sCiAgICAgICAgICAgIGVycm9yTWVzc2FnZTogJ0Vycm9yIGxvYWRpbmcgdGhlIGxpc3Qgb2YgYW5ub3RhdGlvbnMgZm9yIHRoaXMgam9iJywKICAgICAgICAgICAgaXNMb2FkaW5nOiBmYWxzZSwKICAgICAgICAgICAgam9iSWQ6IHVuZGVmaW5lZAogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRKb2IiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEpvYihqb2JJZCkgewogICAgICAvLyBjaGVjayBpZiB0aGUgam9iIHdhcyBzdXBwbGllZCB2aWEgcHJvcHMgYW5kIG1hdGNoZXMgdGhlIHN1cHBsaWVkIGpvYklkCiAgICAgIGlmIChBcnJheS5pc0FycmF5KHRoaXMucHJvcHMuam9icykgJiYgdGhpcy5wcm9wcy5qb2JzLmxlbmd0aCA+IDApIHsKICAgICAgICB2YXIgam9iID0gdGhpcy5wcm9wcy5qb2JzWzBdOwoKICAgICAgICBpZiAoam9iSWQgPT09IHVuZGVmaW5lZCB8fCBqb2Iuam9iX2lkID09PSBqb2JJZCkgewogICAgICAgICAgcmV0dXJuIGpvYjsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBfam9iX3NlcnZpY2UubWxKb2JTZXJ2aWNlLmdldEpvYihqb2JJZCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiY29tcG9uZW50RGlkTW91bnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudERpZE1vdW50KCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIGlmICh0aGlzLnByb3BzLmFubm90YXRpb25zID09PSB1bmRlZmluZWQgJiYgQXJyYXkuaXNBcnJheSh0aGlzLnByb3BzLmpvYnMpICYmIHRoaXMucHJvcHMuam9icy5sZW5ndGggPiAwKSB7CiAgICAgICAgdGhpcy5hbm5vdGF0aW9uc1JlZnJlc2hTdWJzY3JpcHRpb24gPSBfYW5ub3RhdGlvbnNfc2VydmljZS5hbm5vdGF0aW9uc1JlZnJlc2gkLnN1YnNjcmliZShmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXMzLmdldEFubm90YXRpb25zKCk7CiAgICAgICAgfSk7CiAgICAgICAgKDAsIF9hbm5vdGF0aW9uc19zZXJ2aWNlLmFubm90YXRpb25zUmVmcmVzaGVkKSgpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAiY29tcG9uZW50RGlkVXBkYXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnREaWRVcGRhdGUoKSB7CiAgICAgIGlmIChBcnJheS5pc0FycmF5KHRoaXMucHJvcHMuam9icykgJiYgdGhpcy5wcm9wcy5qb2JzLmxlbmd0aCA+IDAgJiYgdGhpcy5wcmV2aW91c0pvYklkICE9PSB0aGlzLnByb3BzLmpvYnNbMF0uam9iX2lkICYmIHRoaXMucHJvcHMuYW5ub3RhdGlvbnMgPT09IHVuZGVmaW5lZCAmJiB0aGlzLnN0YXRlLmlzTG9hZGluZyA9PT0gZmFsc2UgJiYgdGhpcy5zdGF0ZS5qb2JJZCAhPT0gdGhpcy5wcm9wcy5qb2JzWzBdLmpvYl9pZCkgewogICAgICAgICgwLCBfYW5ub3RhdGlvbnNfc2VydmljZS5hbm5vdGF0aW9uc1JlZnJlc2hlZCkoKTsKICAgICAgICB0aGlzLnByZXZpb3VzSm9iSWQgPSB0aGlzLnByb3BzLmpvYnNbMF0uam9iX2lkOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAiY29tcG9uZW50V2lsbFVubW91bnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxVbm1vdW50KCkgewogICAgICBpZiAodGhpcy5hbm5vdGF0aW9uc1JlZnJlc2hTdWJzY3JpcHRpb24gIT09IG51bGwpIHsKICAgICAgICB0aGlzLmFubm90YXRpb25zUmVmcmVzaFN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAicmVuZGVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgdmFyIF90aGlzJHByb3BzID0gdGhpcy5wcm9wcywKICAgICAgICAgIF90aGlzJHByb3BzJGlzU2luZ2xlTSA9IF90aGlzJHByb3BzLmlzU2luZ2xlTWV0cmljVmlld2VyTGlua1Zpc2libGUsCiAgICAgICAgICBpc1NpbmdsZU1ldHJpY1ZpZXdlckxpbmtWaXNpYmxlID0gX3RoaXMkcHJvcHMkaXNTaW5nbGVNID09PSB2b2lkIDAgPyB0cnVlIDogX3RoaXMkcHJvcHMkaXNTaW5nbGVNLAogICAgICAgICAgX3RoaXMkcHJvcHMkaXNOdW1iZXJCID0gX3RoaXMkcHJvcHMuaXNOdW1iZXJCYWRnZVZpc2libGUsCiAgICAgICAgICBpc051bWJlckJhZGdlVmlzaWJsZSA9IF90aGlzJHByb3BzJGlzTnVtYmVyQiA9PT0gdm9pZCAwID8gZmFsc2UgOiBfdGhpcyRwcm9wcyRpc051bWJlckIsCiAgICAgICAgICBpbnRsID0gX3RoaXMkcHJvcHMuaW50bDsKCiAgICAgIGlmICh0aGlzLnByb3BzLmFubm90YXRpb25zID09PSB1bmRlZmluZWQpIHsKICAgICAgICBpZiAodGhpcy5zdGF0ZS5pc0xvYWRpbmcgPT09IHRydWUpIHsKICAgICAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEdyb3VwLCB7CiAgICAgICAgICAgIGp1c3RpZnlDb250ZW50OiAic3BhY2VBcm91bmQiCiAgICAgICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgICAgICAgICAgZ3JvdzogZmFsc2UKICAgICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlMb2FkaW5nU3Bpbm5lciwgewogICAgICAgICAgICBzaXplOiAibCIKICAgICAgICAgIH0pKSk7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5zdGF0ZS5lcnJvck1lc3NhZ2UgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlDYWxsT3V0LCB7CiAgICAgICAgICAgIHRpdGxlOiB0aGlzLnN0YXRlLmVycm9yTWVzc2FnZSwKICAgICAgICAgICAgY29sb3I6ICJkYW5nZXIiLAogICAgICAgICAgICBpY29uVHlwZTogImNyb3NzIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgYW5ub3RhdGlvbnMgPSB0aGlzLnByb3BzLmFubm90YXRpb25zIHx8IHRoaXMuc3RhdGUuYW5ub3RhdGlvbnM7CgogICAgICBpZiAoYW5ub3RhdGlvbnMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlDYWxsT3V0LCB7CiAgICAgICAgICB0aXRsZTogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICAgICAgaWQ6ICJ4cGFjay5tbC5hbm5vdGF0aW9uc1RhYmxlLmFubm90YXRpb25zTm90Q3JlYXRlZFRpdGxlIiwKICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJObyBhbm5vdGF0aW9ucyBjcmVhdGVkIGZvciB0aGlzIGpvYiIKICAgICAgICAgIH0pLAogICAgICAgICAgaWNvblR5cGU6ICJpSW5DaXJjbGUiLAogICAgICAgICAgcm9sZTogImFsZXJ0IgogICAgICAgIH0sIHRoaXMuc3RhdGUuam9iSWQgJiYgKDAsIF9qb2JfdXRpbHMuaXNUaW1lU2VyaWVzVmlld0pvYikodGhpcy5nZXRKb2IodGhpcy5zdGF0ZS5qb2JJZCkpICYmIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoInAiLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgICAgaWQ6ICJ4cGFjay5tbC5hbm5vdGF0aW9uc1RhYmxlLmhvd1RvQ3JlYXRlQW5ub3RhdGlvbkRlc2NyaXB0aW9uIiwKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiVG8gY3JlYXRlIGFuIGFubm90YXRpb24sIG9wZW4gdGhlIHtsaW5rVG9TaW5nbGVNZXRyaWNWaWV3fSIsCiAgICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgICAgbGlua1RvU2luZ2xlTWV0cmljVmlldzogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUxpbmssIHsKICAgICAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNC5vcGVuU2luZ2xlTWV0cmljVmlldygpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICAgICAgICBpZDogInhwYWNrLm1sLmFubm90YXRpb25zVGFibGUuaG93VG9DcmVhdGVBbm5vdGF0aW9uRGVzY3JpcHRpb24uc2luZ2xlTWV0cmljVmlld2VyTGlua1RleHQiLAogICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiU2luZ2xlIE1ldHJpYyBWaWV3ZXIiCiAgICAgICAgICAgIH0pKQogICAgICAgICAgfQogICAgICAgIH0pKSk7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIHJlbmRlckRhdGUoZGF0ZSkgewogICAgICAgIHJldHVybiAoMCwgX2Zvcm1hdC5mb3JtYXREYXRlKShkYXRlLCBUSU1FX0ZPUk1BVCk7CiAgICAgIH0KCiAgICAgIHZhciBjb2x1bW5zID0gW3sKICAgICAgICBmaWVsZDogJ2Fubm90YXRpb24nLAogICAgICAgIG5hbWU6IGludGwuZm9ybWF0TWVzc2FnZSh7CiAgICAgICAgICBpZDogJ3hwYWNrLm1sLmFubm90YXRpb25zVGFibGUuYW5ub3RhdGlvbkNvbHVtbk5hbWUnLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdBbm5vdGF0aW9uJwogICAgICAgIH0pLAogICAgICAgIHNvcnRhYmxlOiB0cnVlLAogICAgICAgIHdpZHRoOiAnNTAlJywKICAgICAgICBzY29wZTogJ3JvdycKICAgICAgfSwgewogICAgICAgIGZpZWxkOiAndGltZXN0YW1wJywKICAgICAgICBuYW1lOiBpbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgaWQ6ICd4cGFjay5tbC5hbm5vdGF0aW9uc1RhYmxlLmZyb21Db2x1bW5OYW1lJywKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnRnJvbScKICAgICAgICB9KSwKICAgICAgICBkYXRhVHlwZTogJ2RhdGUnLAogICAgICAgIHJlbmRlcjogcmVuZGVyRGF0ZSwKICAgICAgICBzb3J0YWJsZTogdHJ1ZQogICAgICB9LCB7CiAgICAgICAgZmllbGQ6ICdlbmRfdGltZXN0YW1wJywKICAgICAgICBuYW1lOiBpbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgaWQ6ICd4cGFjay5tbC5hbm5vdGF0aW9uc1RhYmxlLnRvQ29sdW1uTmFtZScsCiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1RvJwogICAgICAgIH0pLAogICAgICAgIGRhdGFUeXBlOiAnZGF0ZScsCiAgICAgICAgcmVuZGVyOiByZW5kZXJEYXRlLAogICAgICAgIHNvcnRhYmxlOiB0cnVlCiAgICAgIH0sIHsKICAgICAgICBmaWVsZDogJ21vZGlmaWVkX3RpbWUnLAogICAgICAgIG5hbWU6IGludGwuZm9ybWF0TWVzc2FnZSh7CiAgICAgICAgICBpZDogJ3hwYWNrLm1sLmFubm90YXRpb25zVGFibGUubGFzdE1vZGlmaWVkRGF0ZUNvbHVtbk5hbWUnLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdMYXN0IG1vZGlmaWVkIGRhdGUnCiAgICAgICAgfSksCiAgICAgICAgZGF0YVR5cGU6ICdkYXRlJywKICAgICAgICByZW5kZXI6IHJlbmRlckRhdGUsCiAgICAgICAgc29ydGFibGU6IHRydWUKICAgICAgfSwgewogICAgICAgIGZpZWxkOiAnbW9kaWZpZWRfdXNlcm5hbWUnLAogICAgICAgIG5hbWU6IGludGwuZm9ybWF0TWVzc2FnZSh7CiAgICAgICAgICBpZDogJ3hwYWNrLm1sLmFubm90YXRpb25zVGFibGUubGFzdE1vZGlmaWVkQnlDb2x1bW5OYW1lJywKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnTGFzdCBtb2RpZmllZCBieScKICAgICAgICB9KSwKICAgICAgICBzb3J0YWJsZTogdHJ1ZQogICAgICB9XTsKCiAgICAgIHZhciBqb2JJZHMgPSBfbG9kYXNoLmRlZmF1bHQudW5pcShhbm5vdGF0aW9ucy5tYXAoZnVuY3Rpb24gKGEpIHsKICAgICAgICByZXR1cm4gYS5qb2JfaWQ7CiAgICAgIH0pKTsKCiAgICAgIGlmIChqb2JJZHMubGVuZ3RoID4gMSkgewogICAgICAgIGNvbHVtbnMudW5zaGlmdCh7CiAgICAgICAgICBmaWVsZDogJ2pvYl9pZCcsCiAgICAgICAgICBuYW1lOiBpbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgICBpZDogJ3hwYWNrLm1sLmFubm90YXRpb25zVGFibGUuam9iSWRDb2x1bW5OYW1lJywKICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdqb2IgSUQnCiAgICAgICAgICB9KSwKICAgICAgICAgIHNvcnRhYmxlOiB0cnVlCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGlmIChpc051bWJlckJhZGdlVmlzaWJsZSkgewogICAgICAgIGNvbHVtbnMudW5zaGlmdCh7CiAgICAgICAgICBmaWVsZDogJ2tleScsCiAgICAgICAgICBuYW1lOiBpbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgICBpZDogJ3hwYWNrLm1sLmFubm90YXRpb25zVGFibGUubGFiZWxDb2x1bW5OYW1lJywKICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdMYWJlbCcKICAgICAgICAgIH0pLAogICAgICAgICAgc29ydGFibGU6IHRydWUsCiAgICAgICAgICB3aWR0aDogJzYwcHgnLAogICAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoa2V5KSB7CiAgICAgICAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQmFkZ2UsIHsKICAgICAgICAgICAgICBjb2xvcjogImRlZmF1bHQiCiAgICAgICAgICAgIH0sIGtleSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHZhciBhY3Rpb25zID0gW107CiAgICAgIGFjdGlvbnMucHVzaCh7CiAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoYW5ub3RhdGlvbikgewogICAgICAgICAgdmFyIGVkaXRBbm5vdGF0aW9uc1Rvb2x0aXBUZXh0ID0gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICAgICAgaWQ6ICJ4cGFjay5tbC5hbm5vdGF0aW9uc1RhYmxlLmVkaXRBbm5vdGF0aW9uc1Rvb2x0aXAiLAogICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkVkaXQgYW5ub3RhdGlvbiIKICAgICAgICAgIH0pOwoKICAgICAgICAgIHZhciBlZGl0QW5ub3RhdGlvbnNUb29sdGlwQXJpYUxhYmVsVGV4dCA9IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICAgIGlkOiAieHBhY2subWwuYW5ub3RhdGlvbnNUYWJsZS5lZGl0QW5ub3RhdGlvbnNUb29sdGlwQXJpYUxhYmVsIiwKICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJFZGl0IGFubm90YXRpb24iCiAgICAgICAgICB9KTsKCiAgICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRvb2xUaXAsIHsKICAgICAgICAgICAgcG9zaXRpb246ICJib3R0b20iLAogICAgICAgICAgICBjb250ZW50OiBlZGl0QW5ub3RhdGlvbnNUb29sdGlwVGV4dAogICAgICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUJ1dHRvbkljb24sIHsKICAgICAgICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHsKICAgICAgICAgICAgICByZXR1cm4gX2Fubm90YXRpb25zX3NlcnZpY2UuYW5ub3RhdGlvbiQubmV4dChhbm5vdGF0aW9uKTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgaWNvblR5cGU6ICJwZW5jaWwiLAogICAgICAgICAgICAiYXJpYS1sYWJlbCI6IGVkaXRBbm5vdGF0aW9uc1Rvb2x0aXBBcmlhTGFiZWxUZXh0CiAgICAgICAgICB9KSk7CiAgICAgICAgfQogICAgICB9KTsKCiAgICAgIGlmIChpc1NpbmdsZU1ldHJpY1ZpZXdlckxpbmtWaXNpYmxlKSB7CiAgICAgICAgYWN0aW9ucy5wdXNoKHsKICAgICAgICAgIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKGFubm90YXRpb24pIHsKICAgICAgICAgICAgdmFyIGlzRHJpbGxEb3duQXZhaWxhYmxlID0gKDAsIF9qb2JfdXRpbHMuaXNUaW1lU2VyaWVzVmlld0pvYikoX3RoaXM0LmdldEpvYihhbm5vdGF0aW9uLmpvYl9pZCkpOwogICAgICAgICAgICB2YXIgb3BlbkluU2luZ2xlTWV0cmljVmlld2VyVG9vbHRpcFRleHQgPSBpc0RyaWxsRG93bkF2YWlsYWJsZSA/IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICAgICAgaWQ6ICJ4cGFjay5tbC5hbm5vdGF0aW9uc1RhYmxlLm9wZW5JblNpbmdsZU1ldHJpY1ZpZXdlclRvb2x0aXAiLAogICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiT3BlbiBpbiBTaW5nbGUgTWV0cmljIFZpZXdlciIKICAgICAgICAgICAgfSkgOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgICAgICAgIGlkOiAieHBhY2subWwuYW5ub3RhdGlvbnNUYWJsZS5qb2JDb25maWd1cmF0aW9uTm90U3VwcG9ydGVkSW5TaW5nbGVNZXRyaWNWaWV3ZXJUb29sdGlwIiwKICAgICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkpvYiBjb25maWd1cmF0aW9uIG5vdCBzdXBwb3J0ZWQgaW4gU2luZ2xlIE1ldHJpYyBWaWV3ZXIiCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB2YXIgb3BlbkluU2luZ2xlTWV0cmljVmlld2VyQXJpYUxhYmVsVGV4dCA9IGlzRHJpbGxEb3duQXZhaWxhYmxlID8gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICAgICAgICBpZDogInhwYWNrLm1sLmFubm90YXRpb25zVGFibGUub3BlbkluU2luZ2xlTWV0cmljVmlld2VyQXJpYUxhYmVsIiwKICAgICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIk9wZW4gaW4gU2luZ2xlIE1ldHJpYyBWaWV3ZXIiCiAgICAgICAgICAgIH0pIDogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICAgICAgICBpZDogInhwYWNrLm1sLmFubm90YXRpb25zVGFibGUuam9iQ29uZmlndXJhdGlvbk5vdFN1cHBvcnRlZEluU2luZ2xlTWV0cmljVmlld2VyQXJpYUxhYmVsIiwKICAgICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkpvYiBjb25maWd1cmF0aW9uIG5vdCBzdXBwb3J0ZWQgaW4gU2luZ2xlIE1ldHJpYyBWaWV3ZXIiCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRvb2xUaXAsIHsKICAgICAgICAgICAgICBwb3NpdGlvbjogImJvdHRvbSIsCiAgICAgICAgICAgICAgY29udGVudDogb3BlbkluU2luZ2xlTWV0cmljVmlld2VyVG9vbHRpcFRleHQKICAgICAgICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUJ1dHRvbkljb24sIHsKICAgICAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNC5vcGVuU2luZ2xlTWV0cmljVmlldyhhbm5vdGF0aW9uKTsKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIGRpc2FibGVkOiAhaXNEcmlsbERvd25BdmFpbGFibGUsCiAgICAgICAgICAgICAgaWNvblR5cGU6ICJzdGF0cyIsCiAgICAgICAgICAgICAgImFyaWEtbGFiZWwiOiBvcGVuSW5TaW5nbGVNZXRyaWNWaWV3ZXJBcmlhTGFiZWxUZXh0CiAgICAgICAgICAgIH0pKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQoKICAgICAgY29sdW1ucy5wdXNoKHsKICAgICAgICBhbGlnbjogX3NlcnZpY2VzLlJJR0hUX0FMSUdOTUVOVCwKICAgICAgICB3aWR0aDogJzYwcHgnLAogICAgICAgIG5hbWU6IGludGwuZm9ybWF0TWVzc2FnZSh7CiAgICAgICAgICBpZDogJ3hwYWNrLm1sLmFubm90YXRpb25zVGFibGUuYWN0aW9uc0NvbHVtbk5hbWUnLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdBY3Rpb25zJwogICAgICAgIH0pLAogICAgICAgIGFjdGlvbnM6IGFjdGlvbnMKICAgICAgfSk7CgogICAgICB2YXIgZ2V0Um93UHJvcHMgPSBmdW5jdGlvbiBnZXRSb3dQcm9wcyhpdGVtKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIG9uTW91c2VPdmVyOiBmdW5jdGlvbiBvbk1vdXNlT3ZlcigpIHsKICAgICAgICAgICAgcmV0dXJuIF90aGlzNC5vbk1vdXNlT3ZlclJvdyhpdGVtKTsKICAgICAgICAgIH0sCiAgICAgICAgICBvbk1vdXNlTGVhdmU6IGZ1bmN0aW9uIG9uTW91c2VMZWF2ZSgpIHsKICAgICAgICAgICAgcmV0dXJuIF90aGlzNC5vbk1vdXNlTGVhdmVSb3coKTsKICAgICAgICAgIH0KICAgICAgICB9OwogICAgICB9OwoKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LkZyYWdtZW50LCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpSW5NZW1vcnlUYWJsZSwgewogICAgICAgIGNsYXNzTmFtZTogImV1aS10ZXh0T3ZlcmZsb3dXcmFwIiwKICAgICAgICBjb21wcmVzc2VkOiB0cnVlLAogICAgICAgIGl0ZW1zOiBhbm5vdGF0aW9ucywKICAgICAgICBjb2x1bW5zOiBjb2x1bW5zLAogICAgICAgIHBhZ2luYXRpb246IHsKICAgICAgICAgIHBhZ2VTaXplT3B0aW9uczogWzUsIDEwLCAyNV0KICAgICAgICB9LAogICAgICAgIHNvcnRpbmc6IHsKICAgICAgICAgIHNvcnQ6IHsKICAgICAgICAgICAgZmllbGQ6ICd0aW1lc3RhbXAnLAogICAgICAgICAgICBkaXJlY3Rpb246ICdhc2MnCiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICByb3dQcm9wczogZ2V0Um93UHJvcHMKICAgICAgfSkpOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIEFubm90YXRpb25zVGFibGU7Cn0oX3JlYWN0LkNvbXBvbmVudCksIF9kZWZpbmVQcm9wZXJ0eShfY2xhc3MsICJwcm9wVHlwZXMiLCB7CiAgYW5ub3RhdGlvbnM6IF9wcm9wVHlwZXMuZGVmYXVsdC5hcnJheSwKICBqb2JzOiBfcHJvcFR5cGVzLmRlZmF1bHQuYXJyYXksCiAgaXNTaW5nbGVNZXRyaWNWaWV3ZXJMaW5rVmlzaWJsZTogX3Byb3BUeXBlcy5kZWZhdWx0LmJvb2wsCiAgaXNOdW1iZXJCYWRnZVZpc2libGU6IF9wcm9wVHlwZXMuZGVmYXVsdC5ib29sCn0pLCBfdGVtcCkpOwpleHBvcnRzLkFubm90YXRpb25zVGFibGUgPSBBbm5vdGF0aW9uc1RhYmxlOw=="},null]}