{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/ml/public/application/data_frame_analytics/pages/analytics_management/components/create_analytics_form/create_analytics_form.js","dependencies":[{"path":"x-pack/legacy/plugins/ml/public/application/data_frame_analytics/pages/analytics_management/components/create_analytics_form/create_analytics_form.js","mtime":1585205045585},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkNyZWF0ZUFuYWx5dGljc0Zvcm0gPSB2b2lkIDA7Cgp2YXIgX3JlYWN0ID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgicmVhY3QiKSk7Cgp2YXIgX2V1aSA9IHJlcXVpcmUoIkBlbGFzdGljL2V1aSIpOwoKdmFyIF9sb2Rhc2ggPSByZXF1aXJlKCJsb2Rhc2giKTsKCnZhciBfaTE4biA9IHJlcXVpcmUoIkBrYm4vaTE4biIpOwoKdmFyIF9yZWFjdDIgPSByZXF1aXJlKCJAa2JuL2kxOG4vcmVhY3QiKTsKCnZhciBfbWV0YWRhdGEgPSByZXF1aXJlKCJ1aS9tZXRhZGF0YSIpOwoKdmFyIF9tbF9hcGlfc2VydmljZSA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uLy4uL3NlcnZpY2VzL21sX2FwaV9zZXJ2aWNlIik7Cgp2YXIgX25ld19qb2JfY2FwYWJpbGl0aWVzX3NlcnZpY2UgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi8uLi9zZXJ2aWNlcy9uZXdfam9iX2NhcGFiaWxpdGllc19zZXJ2aWNlIik7Cgp2YXIgX2tpYmFuYSA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uLy4uL2NvbnRleHRzL2tpYmFuYSIpOwoKdmFyIF9zdGF0ZSA9IHJlcXVpcmUoIi4uLy4uL2hvb2tzL3VzZV9jcmVhdGVfYW5hbHl0aWNzX2Zvcm0vc3RhdGUiKTsKCnZhciBfdmFsaWRhdGlvbiA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uLy4uLy4uLy4uL2NvbW1vbi9jb25zdGFudHMvdmFsaWRhdGlvbiIpOwoKdmFyIF9tZXNzYWdlcyA9IHJlcXVpcmUoIi4vbWVzc2FnZXMiKTsKCnZhciBfam9iX3R5cGUgPSByZXF1aXJlKCIuL2pvYl90eXBlIik7Cgp2YXIgX2pvYl9kZXNjcmlwdGlvbiA9IHJlcXVpcmUoIi4vam9iX2Rlc2NyaXB0aW9uIik7Cgp2YXIgX3JlZHVjZXIgPSByZXF1aXJlKCIuLi8uLi9ob29rcy91c2VfY3JlYXRlX2FuYWx5dGljc19mb3JtL3JlZHVjZXIiKTsKCnZhciBfcHVibGljID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vc3JjL3BsdWdpbnMvZGF0YS9wdWJsaWMiKTsKCnZhciBfZm9ybV9vcHRpb25zX3ZhbGlkYXRpb24gPSByZXF1aXJlKCIuL2Zvcm1fb3B0aW9uc192YWxpZGF0aW9uIik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsKICBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7CiAgICByZXR1cm4gb2JqOwogIH0gZWxzZSB7CiAgICB2YXIgbmV3T2JqID0ge307CgogICAgaWYgKG9iaiAhPSBudWxsKSB7CiAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHsKICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgewogICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvciA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpIDoge307CgogICAgICAgICAgaWYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSB7CiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmosIGtleSwgZGVzYyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBuZXdPYmpba2V5XSA9IG9ialtrZXldOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIG5ld09iai5kZWZhdWx0ID0gb2JqOwogICAgcmV0dXJuIG5ld09iajsKICB9Cn0KCmZ1bmN0aW9uIF90b0NvbnN1bWFibGVBcnJheShhcnIpIHsKICByZXR1cm4gX2FycmF5V2l0aG91dEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheShhcnIpIHx8IF9ub25JdGVyYWJsZVNwcmVhZCgpOwp9CgpmdW5jdGlvbiBfbm9uSXRlcmFibGVTcHJlYWQoKSB7CiAgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIHNwcmVhZCBub24taXRlcmFibGUgaW5zdGFuY2UiKTsKfQoKZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheShpdGVyKSB7CiAgaWYgKFN5bWJvbC5pdGVyYXRvciBpbiBPYmplY3QoaXRlcikgfHwgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGl0ZXIpID09PSAiW29iamVjdCBBcmd1bWVudHNdIikgcmV0dXJuIEFycmF5LmZyb20oaXRlcik7Cn0KCmZ1bmN0aW9uIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHsKICBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSB7CiAgICBmb3IgKHZhciBpID0gMCwgYXJyMiA9IG5ldyBBcnJheShhcnIubGVuZ3RoKTsgaSA8IGFyci5sZW5ndGg7IGkrKykgewogICAgICBhcnIyW2ldID0gYXJyW2ldOwogICAgfQoKICAgIHJldHVybiBhcnIyOwogIH0KfQoKdmFyIENyZWF0ZUFuYWx5dGljc0Zvcm0gPSBmdW5jdGlvbiBDcmVhdGVBbmFseXRpY3NGb3JtKF9yZWYpIHsKICB2YXIgYWN0aW9ucyA9IF9yZWYuYWN0aW9ucywKICAgICAgc3RhdGUgPSBfcmVmLnN0YXRlOwogIHZhciBzZXRGb3JtU3RhdGUgPSBhY3Rpb25zLnNldEZvcm1TdGF0ZTsKICB2YXIga2liYW5hQ29udGV4dCA9ICgwLCBfa2liYW5hLnVzZUtpYmFuYUNvbnRleHQpKCk7CiAgdmFyIGZvcm0gPSBzdGF0ZS5mb3JtLAogICAgICBpbmRleFBhdHRlcm5zTWFwID0gc3RhdGUuaW5kZXhQYXR0ZXJuc01hcCwKICAgICAgaXNBZHZhbmNlZEVkaXRvckVuYWJsZWQgPSBzdGF0ZS5pc0FkdmFuY2VkRWRpdG9yRW5hYmxlZCwKICAgICAgaXNKb2JDcmVhdGVkID0gc3RhdGUuaXNKb2JDcmVhdGVkLAogICAgICByZXF1ZXN0TWVzc2FnZXMgPSBzdGF0ZS5yZXF1ZXN0TWVzc2FnZXM7CiAgdmFyIGNyZWF0ZUluZGV4UGF0dGVybiA9IGZvcm0uY3JlYXRlSW5kZXhQYXR0ZXJuLAogICAgICBkZXBlbmRlbnRWYXJpYWJsZSA9IGZvcm0uZGVwZW5kZW50VmFyaWFibGUsCiAgICAgIGRlcGVuZGVudFZhcmlhYmxlRmV0Y2hGYWlsID0gZm9ybS5kZXBlbmRlbnRWYXJpYWJsZUZldGNoRmFpbCwKICAgICAgZGVwZW5kZW50VmFyaWFibGVPcHRpb25zID0gZm9ybS5kZXBlbmRlbnRWYXJpYWJsZU9wdGlvbnMsCiAgICAgIGRlc2NyaXB0aW9uID0gZm9ybS5kZXNjcmlwdGlvbiwKICAgICAgZGVzdGluYXRpb25JbmRleCA9IGZvcm0uZGVzdGluYXRpb25JbmRleCwKICAgICAgZGVzdGluYXRpb25JbmRleE5hbWVFbXB0eSA9IGZvcm0uZGVzdGluYXRpb25JbmRleE5hbWVFbXB0eSwKICAgICAgZGVzdGluYXRpb25JbmRleE5hbWVFeGlzdHMgPSBmb3JtLmRlc3RpbmF0aW9uSW5kZXhOYW1lRXhpc3RzLAogICAgICBkZXN0aW5hdGlvbkluZGV4TmFtZVZhbGlkID0gZm9ybS5kZXN0aW5hdGlvbkluZGV4TmFtZVZhbGlkLAogICAgICBkZXN0aW5hdGlvbkluZGV4UGF0dGVyblRpdGxlRXhpc3RzID0gZm9ybS5kZXN0aW5hdGlvbkluZGV4UGF0dGVyblRpdGxlRXhpc3RzLAogICAgICBleGNsdWRlcyA9IGZvcm0uZXhjbHVkZXMsCiAgICAgIGV4Y2x1ZGVzT3B0aW9ucyA9IGZvcm0uZXhjbHVkZXNPcHRpb25zLAogICAgICBmaWVsZE9wdGlvbnNGZXRjaEZhaWwgPSBmb3JtLmZpZWxkT3B0aW9uc0ZldGNoRmFpbCwKICAgICAgam9iSWQgPSBmb3JtLmpvYklkLAogICAgICBqb2JJZEVtcHR5ID0gZm9ybS5qb2JJZEVtcHR5LAogICAgICBqb2JJZEV4aXN0cyA9IGZvcm0uam9iSWRFeGlzdHMsCiAgICAgIGpvYklkVmFsaWQgPSBmb3JtLmpvYklkVmFsaWQsCiAgICAgIGpvYklkSW52YWxpZE1heExlbmd0aCA9IGZvcm0uam9iSWRJbnZhbGlkTWF4TGVuZ3RoLAogICAgICBqb2JUeXBlID0gZm9ybS5qb2JUeXBlLAogICAgICBsb2FkaW5nRGVwVmFyT3B0aW9ucyA9IGZvcm0ubG9hZGluZ0RlcFZhck9wdGlvbnMsCiAgICAgIGxvYWRpbmdGaWVsZE9wdGlvbnMgPSBmb3JtLmxvYWRpbmdGaWVsZE9wdGlvbnMsCiAgICAgIG1heERpc3RpbmN0VmFsdWVzRXJyb3IgPSBmb3JtLm1heERpc3RpbmN0VmFsdWVzRXJyb3IsCiAgICAgIG1vZGVsTWVtb3J5TGltaXQgPSBmb3JtLm1vZGVsTWVtb3J5TGltaXQsCiAgICAgIG1vZGVsTWVtb3J5TGltaXRVbml0VmFsaWQgPSBmb3JtLm1vZGVsTWVtb3J5TGltaXRVbml0VmFsaWQsCiAgICAgIHByZXZpb3VzSm9iVHlwZSA9IGZvcm0ucHJldmlvdXNKb2JUeXBlLAogICAgICBwcmV2aW91c1NvdXJjZUluZGV4ID0gZm9ybS5wcmV2aW91c1NvdXJjZUluZGV4LAogICAgICBzb3VyY2VJbmRleCA9IGZvcm0uc291cmNlSW5kZXgsCiAgICAgIHNvdXJjZUluZGV4TmFtZUVtcHR5ID0gZm9ybS5zb3VyY2VJbmRleE5hbWVFbXB0eSwKICAgICAgc291cmNlSW5kZXhOYW1lVmFsaWQgPSBmb3JtLnNvdXJjZUluZGV4TmFtZVZhbGlkLAogICAgICBzb3VyY2VJbmRleENvbnRhaW5zTnVtZXJpY2FsRmllbGRzID0gZm9ybS5zb3VyY2VJbmRleENvbnRhaW5zTnVtZXJpY2FsRmllbGRzLAogICAgICBzb3VyY2VJbmRleEZpZWxkc0NoZWNrRmFpbGVkID0gZm9ybS5zb3VyY2VJbmRleEZpZWxkc0NoZWNrRmFpbGVkLAogICAgICB0cmFpbmluZ1BlcmNlbnQgPSBmb3JtLnRyYWluaW5nUGVyY2VudDsKCiAgdmFyIGNoYXJhY3Rlckxpc3QgPSBfcHVibGljLmluZGV4UGF0dGVybnMuSUxMRUdBTF9DSEFSQUNURVJTX1ZJU0lCTEUuam9pbignLCAnKTsKCiAgdmFyIGlzSm9iVHlwZVdpdGhEZXBWYXIgPSBqb2JUeXBlID09PSBfc3RhdGUuSk9CX1RZUEVTLlJFR1JFU1NJT04gfHwgam9iVHlwZSA9PT0gX3N0YXRlLkpPQl9UWVBFUy5DTEFTU0lGSUNBVElPTjsgLy8gRmluZCBvdXQgaWYgaW5kZXggcGF0dGVybiBjb250YWluIG51bWVyaWMgZmllbGRzLiBQcm92aWRlcyBhIGhpbnQgaW4gdGhlIGZvcm0KICAvLyB0aGF0IGFuIGFuYWx5dGljcyBqb2JzIGlzIG5vdCBhYmxlIHRvIGlkZW50aWZ5IG91dGxpZXJzIGlmIHRoZXJlIGFyZSBubyBudW1lcmljIGZpZWxkcyBwcmVzZW50LgoKICB2YXIgdmFsaWRhdGVTb3VyY2VJbmRleEZpZWxkcyA9IGZ1bmN0aW9uIHZhbGlkYXRlU291cmNlSW5kZXhGaWVsZHMoKSB7CiAgICB2YXIgaW5kZXhQYXR0ZXJuLCBjb250YWluc051bWVyaWNhbEZpZWxkczsKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXN5bmMoZnVuY3Rpb24gdmFsaWRhdGVTb3VyY2VJbmRleEZpZWxkcyQoX2NvbnRleHQpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAwOwogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMzsKICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hd3JhcChraWJhbmFDb250ZXh0LmluZGV4UGF0dGVybnMuZ2V0KGluZGV4UGF0dGVybnNNYXBbc291cmNlSW5kZXhdLnZhbHVlKSk7CgogICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICBpbmRleFBhdHRlcm4gPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICBjb250YWluc051bWVyaWNhbEZpZWxkcyA9IGluZGV4UGF0dGVybi5maWVsZHMuc29tZShmdW5jdGlvbiAoX3JlZjIpIHsKICAgICAgICAgICAgICB2YXIgbmFtZSA9IF9yZWYyLm5hbWUsCiAgICAgICAgICAgICAgICAgIHR5cGUgPSBfcmVmMi50eXBlOwogICAgICAgICAgICAgIHJldHVybiAhX2Zvcm1fb3B0aW9uc192YWxpZGF0aW9uLk9NSVRfRklFTERTLmluY2x1ZGVzKG5hbWUpICYmIHR5cGUgPT09ICdudW1iZXInOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgc2V0Rm9ybVN0YXRlKHsKICAgICAgICAgICAgICBzb3VyY2VJbmRleENvbnRhaW5zTnVtZXJpY2FsRmllbGRzOiBjb250YWluc051bWVyaWNhbEZpZWxkcywKICAgICAgICAgICAgICBzb3VyY2VJbmRleEZpZWxkc0NoZWNrRmFpbGVkOiBmYWxzZQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDExOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSA4OwogICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDApOwogICAgICAgICAgICBzZXRGb3JtU3RhdGUoewogICAgICAgICAgICAgIHNvdXJjZUluZGV4RmllbGRzQ2hlY2tGYWlsZWQ6IHRydWUKICAgICAgICAgICAgfSk7CgogICAgICAgICAgY2FzZSAxMToKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBudWxsLCBudWxsLCBbWzAsIDhdXSk7CiAgfTsKCiAgdmFyIG9uQ3JlYXRlT3B0aW9uID0gZnVuY3Rpb24gb25DcmVhdGVPcHRpb24oc2VhcmNoVmFsdWUsIGZsYXR0ZW5lZE9wdGlvbnMpIHsKICAgIHZhciBub3JtYWxpemVkU2VhcmNoVmFsdWUgPSBzZWFyY2hWYWx1ZS50cmltKCkudG9Mb3dlckNhc2UoKTsKCiAgICBpZiAoIW5vcm1hbGl6ZWRTZWFyY2hWYWx1ZSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdmFyIG5ld09wdGlvbiA9IHsKICAgICAgbGFiZWw6IHNlYXJjaFZhbHVlCiAgICB9OyAvLyBDcmVhdGUgdGhlIG9wdGlvbiBpZiBpdCBkb2Vzbid0IGV4aXN0LgoKICAgIGlmICghZmxhdHRlbmVkT3B0aW9ucy5zb21lKGZ1bmN0aW9uIChvcHRpb24pIHsKICAgICAgcmV0dXJuIG9wdGlvbi5sYWJlbC50cmltKCkudG9Mb3dlckNhc2UoKSA9PT0gbm9ybWFsaXplZFNlYXJjaFZhbHVlOwogICAgfSkpIHsKICAgICAgZXhjbHVkZXNPcHRpb25zLnB1c2gobmV3T3B0aW9uKTsKICAgICAgc2V0Rm9ybVN0YXRlKHsKICAgICAgICBleGNsdWRlczogW10uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShleGNsdWRlcyksIFtuZXdPcHRpb24ubGFiZWxdKQogICAgICB9KTsKICAgIH0KICB9OwoKICB2YXIgZGVib3VuY2VkR2V0RXhwbGFpbkRhdGEgPSAoMCwgX2xvZGFzaC5kZWJvdW5jZSkoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgIHZhciBqb2JDb25maWcsIHJlc3AsIF9yZXNwJG1lbW9yeV9lc3RpbWF0aSwgYW5hbHl6ZWRGaWVsZHNPcHRpb25zLCBfcmVzcCRtZW1vcnlfZXN0aW1hdGkyLCBlcnJvck1lc3NhZ2U7CgogICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hc3luYyhmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dDIpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgLy8gUmVzZXQgaWYgc291cmNlSW5kZXggb3Igam9iVHlwZSBjaGFuZ2VzIChqb2JUeXBlIHJlcXVpcmVzIGRlcGVuZGVudF92YXJpYWJsZSB0byBiZSBzZXQgLQogICAgICAgICAgICAvLyB3aGljaCB3b24ndCBiZSB0aGUgY2FzZSBpZiBzd2l0Y2hpbmcgZnJvbSBvdXRsaWVyIGRldGVjdGlvbikKICAgICAgICAgICAgaWYgKHByZXZpb3VzU291cmNlSW5kZXggIT09IHNvdXJjZUluZGV4IHx8IHByZXZpb3VzSm9iVHlwZSAhPT0gam9iVHlwZSkgewogICAgICAgICAgICAgIHNldEZvcm1TdGF0ZSh7CiAgICAgICAgICAgICAgICBsb2FkaW5nRmllbGRPcHRpb25zOiB0cnVlCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIF9jb250ZXh0Mi5wcmV2ID0gMTsKICAgICAgICAgICAgam9iQ29uZmlnID0gKDAsIF9zdGF0ZS5nZXRKb2JDb25maWdGcm9tRm9ybVN0YXRlKShmb3JtKTsKICAgICAgICAgICAgZGVsZXRlIGpvYkNvbmZpZy5kZXN0OwogICAgICAgICAgICBkZWxldGUgam9iQ29uZmlnLm1vZGVsX21lbW9yeV9saW1pdDsKICAgICAgICAgICAgZGVsZXRlIGpvYkNvbmZpZy5hbmFseXplZF9maWVsZHM7CiAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gODsKICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hd3JhcChfbWxfYXBpX3NlcnZpY2UubWwuZGF0YUZyYW1lQW5hbHl0aWNzLmV4cGxhaW5EYXRhRnJhbWVBbmFseXRpY3Moam9iQ29uZmlnKSk7CgogICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICByZXNwID0gX2NvbnRleHQyLnNlbnQ7IC8vIElmIHNvdXJjZUluZGV4IGhhcyBjaGFuZ2VkIGxvYWQgYW5hbHlzaXMgZmllbGQgb3B0aW9ucyBhZ2FpbgoKICAgICAgICAgICAgaWYgKHByZXZpb3VzU291cmNlSW5kZXggIT09IHNvdXJjZUluZGV4IHx8IHByZXZpb3VzSm9iVHlwZSAhPT0gam9iVHlwZSkgewogICAgICAgICAgICAgIGFuYWx5emVkRmllbGRzT3B0aW9ucyA9IFtdOwoKICAgICAgICAgICAgICBpZiAocmVzcC5maWVsZF9zZWxlY3Rpb24pIHsKICAgICAgICAgICAgICAgIHJlc3AuZmllbGRfc2VsZWN0aW9uLmZvckVhY2goZnVuY3Rpb24gKHNlbGVjdGVkRmllbGQpIHsKICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkRmllbGQuaXNfaW5jbHVkZWQgPT09IHRydWUgJiYgc2VsZWN0ZWRGaWVsZC5uYW1lICE9PSBkZXBlbmRlbnRWYXJpYWJsZSkgewogICAgICAgICAgICAgICAgICAgIGFuYWx5emVkRmllbGRzT3B0aW9ucy5wdXNoKHsKICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiBzZWxlY3RlZEZpZWxkLm5hbWUKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBzZXRGb3JtU3RhdGUoewogICAgICAgICAgICAgICAgbW9kZWxNZW1vcnlMaW1pdDogKF9yZXNwJG1lbW9yeV9lc3RpbWF0aSA9IHJlc3AubWVtb3J5X2VzdGltYXRpb24pID09PSBudWxsIHx8IF9yZXNwJG1lbW9yeV9lc3RpbWF0aSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3Jlc3AkbWVtb3J5X2VzdGltYXRpLmV4cGVjdGVkX21lbW9yeV93aXRob3V0X2Rpc2ssCiAgICAgICAgICAgICAgICBleGNsdWRlc09wdGlvbnM6IGFuYWx5emVkRmllbGRzT3B0aW9ucywKICAgICAgICAgICAgICAgIGxvYWRpbmdGaWVsZE9wdGlvbnM6IGZhbHNlLAogICAgICAgICAgICAgICAgZmllbGRPcHRpb25zRmV0Y2hGYWlsOiBmYWxzZSwKICAgICAgICAgICAgICAgIG1heERpc3RpbmN0VmFsdWVzRXJyb3I6IHVuZGVmaW5lZAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHNldEZvcm1TdGF0ZSh7CiAgICAgICAgICAgICAgICBtb2RlbE1lbW9yeUxpbWl0OiAoX3Jlc3AkbWVtb3J5X2VzdGltYXRpMiA9IHJlc3AubWVtb3J5X2VzdGltYXRpb24pID09PSBudWxsIHx8IF9yZXNwJG1lbW9yeV9lc3RpbWF0aTIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9yZXNwJG1lbW9yeV9lc3RpbWF0aTIuZXhwZWN0ZWRfbWVtb3J5X3dpdGhvdXRfZGlzawogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDE2OwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICBfY29udGV4dDIucHJldiA9IDEyOwogICAgICAgICAgICBfY29udGV4dDIudDAgPSBfY29udGV4dDJbImNhdGNoIl0oMSk7CgogICAgICAgICAgICBpZiAoam9iVHlwZSA9PT0gX3N0YXRlLkpPQl9UWVBFUy5DTEFTU0lGSUNBVElPTiAmJiBfY29udGV4dDIudDAubWVzc2FnZSAhPT0gdW5kZWZpbmVkICYmIF9jb250ZXh0Mi50MC5tZXNzYWdlLmluY2x1ZGVzKCdzdGF0dXNfZXhjZXB0aW9uJykgJiYgX2NvbnRleHQyLnQwLm1lc3NhZ2UuaW5jbHVkZXMoJ211c3QgaGF2ZSBhdCBtb3N0JykpIHsKICAgICAgICAgICAgICBlcnJvck1lc3NhZ2UgPSBfY29udGV4dDIudDAubWVzc2FnZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgc2V0Rm9ybVN0YXRlKHsKICAgICAgICAgICAgICBmaWVsZE9wdGlvbnNGZXRjaEZhaWw6IHRydWUsCiAgICAgICAgICAgICAgbWF4RGlzdGluY3RWYWx1ZXNFcnJvcjogZXJyb3JNZXNzYWdlLAogICAgICAgICAgICAgIGxvYWRpbmdGaWVsZE9wdGlvbnM6IGZhbHNlLAogICAgICAgICAgICAgIG1vZGVsTWVtb3J5TGltaXQ6IGpvYlR5cGUgIT09IHVuZGVmaW5lZCA/IF9zdGF0ZS5ERUZBVUxUX01PREVMX01FTU9SWV9MSU1JVFtqb2JUeXBlXSA6IF9zdGF0ZS5ERUZBVUxUX01PREVMX01FTU9SWV9MSU1JVC5vdXRsaWVyX2RldGVjdGlvbgogICAgICAgICAgICB9KTsKCiAgICAgICAgICBjYXNlIDE2OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBudWxsLCBudWxsLCBbWzEsIDEyXV0pOwogIH0sIDQwMCk7CgogIHZhciBsb2FkRGVwVmFyT3B0aW9ucyA9IGZ1bmN0aW9uIGxvYWREZXBWYXJPcHRpb25zKCkgewogICAgdmFyIF9pbmRleFBhdHRlcm4sIGZpZWxkcywgZGVwVmFyT3B0aW9uczsKCiAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmFzeW5jKGZ1bmN0aW9uIGxvYWREZXBWYXJPcHRpb25zJChfY29udGV4dDMpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgc2V0Rm9ybVN0YXRlKHsKICAgICAgICAgICAgICBsb2FkaW5nRGVwVmFyT3B0aW9uczogdHJ1ZSwKICAgICAgICAgICAgICAvLyBjbGVhciB3aGVuIHRoZSBzb3VyY2UgaW5kZXggY2hhbmdlcwogICAgICAgICAgICAgIGRlcGVuZGVudFZhcmlhYmxlOiAnJywKICAgICAgICAgICAgICBtYXhEaXN0aW5jdFZhbHVlc0Vycm9yOiB1bmRlZmluZWQsCiAgICAgICAgICAgICAgc291cmNlSW5kZXhGaWVsZHNDaGVja0ZhaWxlZDogZmFsc2UsCiAgICAgICAgICAgICAgc291cmNlSW5kZXhDb250YWluc051bWVyaWNhbEZpZWxkczogdHJ1ZQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgX2NvbnRleHQzLnByZXYgPSAxOwogICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDQ7CiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAoa2liYW5hQ29udGV4dC5pbmRleFBhdHRlcm5zLmdldChpbmRleFBhdHRlcm5zTWFwW3NvdXJjZUluZGV4XS52YWx1ZSkpOwoKICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgX2luZGV4UGF0dGVybiA9IF9jb250ZXh0My5zZW50OwoKICAgICAgICAgICAgaWYgKCEoX2luZGV4UGF0dGVybiAhPT0gdW5kZWZpbmVkKSkgewogICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMTI7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gODsKICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hd3JhcChfbmV3X2pvYl9jYXBhYmlsaXRpZXNfc2VydmljZS5uZXdKb2JDYXBzU2VydmljZS5pbml0aWFsaXplRnJvbUluZGV4UGF0dGVybihfaW5kZXhQYXR0ZXJuKSk7CgogICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAvLyBHZXQgZmllbGRzIGFuZCBmaWx0ZXIgZm9yIHN1cHBvcnRlZCB0eXBlcyBmb3Igam9iIHR5cGUKICAgICAgICAgICAgZmllbGRzID0gX25ld19qb2JfY2FwYWJpbGl0aWVzX3NlcnZpY2UubmV3Sm9iQ2Fwc1NlcnZpY2UuZmllbGRzOwogICAgICAgICAgICBkZXBWYXJPcHRpb25zID0gW107CiAgICAgICAgICAgIGZpZWxkcy5mb3JFYWNoKGZ1bmN0aW9uIChmaWVsZCkgewogICAgICAgICAgICAgIGlmICgoMCwgX2Zvcm1fb3B0aW9uc192YWxpZGF0aW9uLnNob3VsZEFkZEFzRGVwVmFyT3B0aW9uKShmaWVsZCwgam9iVHlwZSkpIHsKICAgICAgICAgICAgICAgIGRlcFZhck9wdGlvbnMucHVzaCh7CiAgICAgICAgICAgICAgICAgIGxhYmVsOiBmaWVsZC5pZAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgc2V0Rm9ybVN0YXRlKHsKICAgICAgICAgICAgICBkZXBlbmRlbnRWYXJpYWJsZU9wdGlvbnM6IGRlcFZhck9wdGlvbnMsCiAgICAgICAgICAgICAgbG9hZGluZ0RlcFZhck9wdGlvbnM6IGZhbHNlLAogICAgICAgICAgICAgIGRlcGVuZGVudFZhcmlhYmxlRmV0Y2hGYWlsOiBmYWxzZQogICAgICAgICAgICB9KTsKCiAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDE3OwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICBfY29udGV4dDMucHJldiA9IDE0OwogICAgICAgICAgICBfY29udGV4dDMudDAgPSBfY29udGV4dDNbImNhdGNoIl0oMSk7CiAgICAgICAgICAgIHNldEZvcm1TdGF0ZSh7CiAgICAgICAgICAgICAgbG9hZGluZ0RlcFZhck9wdGlvbnM6IGZhbHNlLAogICAgICAgICAgICAgIGRlcGVuZGVudFZhcmlhYmxlRmV0Y2hGYWlsOiB0cnVlCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgIGNhc2UgMTc6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIG51bGwsIG51bGwsIFtbMSwgMTRdXSk7CiAgfTsKCiAgdmFyIGdldFNvdXJjZUluZGV4RXJyb3JNZXNzYWdlcyA9IGZ1bmN0aW9uIGdldFNvdXJjZUluZGV4RXJyb3JNZXNzYWdlcygpIHsKICAgIHZhciBlcnJvcnMgPSBbXTsKCiAgICBpZiAoIXNvdXJjZUluZGV4TmFtZUVtcHR5ICYmICFzb3VyY2VJbmRleE5hbWVWYWxpZCkgewogICAgICBlcnJvcnMucHVzaChfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5GcmFnbWVudCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogInhwYWNrLm1sLmRhdGFmcmFtZS5hbmFseXRpY3MuY3JlYXRlLnNvdXJjZUluZGV4SW52YWxpZEVycm9yIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkludmFsaWQgc291cmNlIGluZGV4IG5hbWUsIGl0IGNhbm5vdCBjb250YWluIHNwYWNlcyBvciB0aGUgY2hhcmFjdGVyczoge2NoYXJhY3Rlckxpc3R9IiwKICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgIGNoYXJhY3Rlckxpc3Q6IGNoYXJhY3Rlckxpc3QKICAgICAgICB9CiAgICAgIH0pKSk7CiAgICB9CgogICAgaWYgKHNvdXJjZUluZGV4RmllbGRzQ2hlY2tGYWlsZWQgPT09IHRydWUpIHsKICAgICAgZXJyb3JzLnB1c2goX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRnJhZ21lbnQsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJ4cGFjay5tbC5kYXRhZnJhbWUuYW5hbHl0aWNzLmNyZWF0ZS5zb3VyY2VJbmRleEZpZWxkQ2hlY2tFcnJvciIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJUaGVyZSB3YXMgYSBwcm9ibGVtIGNoZWNraW5nIGZvciBudW1lcmljYWwgZmllbGRzLiBQbGVhc2UgcmVmcmVzaCB0aGUgcGFnZSBhbmQgdHJ5IGFnYWluLiIKICAgICAgfSkpKTsKICAgIH0KCiAgICByZXR1cm4gZXJyb3JzOwogIH07CgogIHZhciBvblNvdXJjZUluZGV4Q2hhbmdlID0gZnVuY3Rpb24gb25Tb3VyY2VJbmRleENoYW5nZShzZWxlY3RlZE9wdGlvbnMpIHsKICAgIHNldEZvcm1TdGF0ZSh7CiAgICAgIGV4Y2x1ZGVzOiBbXSwKICAgICAgZXhjbHVkZXNPcHRpb25zOiBbXSwKICAgICAgcHJldmlvdXNTb3VyY2VJbmRleDogc291cmNlSW5kZXgsCiAgICAgIHNvdXJjZUluZGV4OiBzZWxlY3RlZE9wdGlvbnNbMF0ubGFiZWwgfHwgJycKICAgIH0pOwogIH07CgogICgwLCBfcmVhY3QudXNlRWZmZWN0KShmdW5jdGlvbiAoKSB7CiAgICBpZiAoaXNKb2JUeXBlV2l0aERlcFZhciAmJiBzb3VyY2VJbmRleE5hbWVFbXB0eSA9PT0gZmFsc2UpIHsKICAgICAgbG9hZERlcFZhck9wdGlvbnMoKTsKICAgIH0KCiAgICBpZiAoam9iVHlwZSA9PT0gX3N0YXRlLkpPQl9UWVBFUy5PVVRMSUVSX0RFVEVDVElPTiAmJiBzb3VyY2VJbmRleE5hbWVFbXB0eSA9PT0gZmFsc2UpIHsKICAgICAgdmFsaWRhdGVTb3VyY2VJbmRleEZpZWxkcygpOwogICAgfQogIH0sIFtzb3VyY2VJbmRleCwgam9iVHlwZSwgc291cmNlSW5kZXhOYW1lRW1wdHldKTsKICAoMCwgX3JlYWN0LnVzZUVmZmVjdCkoZnVuY3Rpb24gKCkgewogICAgdmFyIGhhc0Jhc2ljUmVxdWlyZWRGaWVsZHMgPSBqb2JUeXBlICE9PSB1bmRlZmluZWQgJiYgc291cmNlSW5kZXggIT09ICcnICYmIHNvdXJjZUluZGV4TmFtZVZhbGlkID09PSB0cnVlOwogICAgdmFyIGhhc1JlcXVpcmVkQW5hbHlzaXNGaWVsZHMgPSBpc0pvYlR5cGVXaXRoRGVwVmFyICYmIGRlcGVuZGVudFZhcmlhYmxlICE9PSAnJyB8fCBqb2JUeXBlID09PSBfc3RhdGUuSk9CX1RZUEVTLk9VVExJRVJfREVURUNUSU9OOwoKICAgIGlmIChoYXNCYXNpY1JlcXVpcmVkRmllbGRzICYmIGhhc1JlcXVpcmVkQW5hbHlzaXNGaWVsZHMpIHsKICAgICAgZGVib3VuY2VkR2V0RXhwbGFpbkRhdGEoKTsKICAgIH0KCiAgICByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICBkZWJvdW5jZWRHZXRFeHBsYWluRGF0YS5jYW5jZWwoKTsKICAgIH07CiAgfSwgW2pvYlR5cGUsIHNvdXJjZUluZGV4LCBzb3VyY2VJbmRleE5hbWVFbXB0eSwgZGVwZW5kZW50VmFyaWFibGUsIHRyYWluaW5nUGVyY2VudF0pOwogIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRm9ybSwgewogICAgY2xhc3NOYW1lOiAibWxEYXRhRnJhbWVBbmFseXRpY3NDcmVhdGVGb3JtIgogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX21lc3NhZ2VzLk1lc3NhZ2VzLCB7CiAgICBtZXNzYWdlczogcmVxdWVzdE1lc3NhZ2VzCiAgfSksICFpc0pvYkNyZWF0ZWQgJiYgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRnJhZ21lbnQsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2pvYl90eXBlLkpvYlR5cGUsIHsKICAgIHR5cGU6IGpvYlR5cGUsCiAgICBzZXRGb3JtU3RhdGU6IHNldEZvcm1TdGF0ZQogIH0pLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRm9ybVJvdywgewogICAgaGVscFRleHQ6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tbC5kYXRhZnJhbWUuYW5hbHl0aWNzLmNyZWF0ZS5lbmFibGVBZHZhbmNlZEVkaXRvckhlbHBUZXh0JywgewogICAgICBkZWZhdWx0TWVzc2FnZTogJ1lvdSBjYW5ub3Qgc3dpdGNoIGJhY2sgdG8gdGhpcyBmb3JtIGZyb20gdGhlIGFkdmFuY2VkIGVkaXRvci4nCiAgICB9KQogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTd2l0Y2gsIHsKICAgIGRpc2FibGVkOiBqb2JUeXBlID09PSB1bmRlZmluZWQsCiAgICBjb21wcmVzc2VkOiB0cnVlLAogICAgbmFtZTogIm1sRGF0YUZyYW1lQW5hbHl0aWNzRW5hYmxlQWR2YW5jZWRFZGl0b3IiLAogICAgbGFiZWw6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tbC5kYXRhZnJhbWUuYW5hbHl0aWNzLmNyZWF0ZS5lbmFibGVBZHZhbmNlZEVkaXRvclN3aXRjaCcsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdFbmFibGUgYWR2YW5jZWQgZWRpdG9yJwogICAgfSksCiAgICBjaGVja2VkOiBpc0FkdmFuY2VkRWRpdG9yRW5hYmxlZCwKICAgIG9uQ2hhbmdlOiBhY3Rpb25zLnN3aXRjaFRvQWR2YW5jZWRFZGl0b3IsCiAgICAiZGF0YS10ZXN0LXN1YmoiOiAibWxBbmFseXRpY3NDcmVhdGVKb2JGbHlvdXRBZHZhbmNlZEVkaXRvclN3aXRjaCIKICB9KSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGb3JtUm93LCB7CiAgICBsYWJlbDogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1sLmRhdGFmcmFtZS5hbmFseXRpY3MuY3JlYXRlLmpvYklkTGFiZWwnLCB7CiAgICAgIGRlZmF1bHRNZXNzYWdlOiAnSm9iIElEJwogICAgfSksCiAgICBpc0ludmFsaWQ6ICFqb2JJZEVtcHR5ICYmICFqb2JJZFZhbGlkIHx8IGpvYklkRXhpc3RzIHx8IGpvYklkSW52YWxpZE1heExlbmd0aCwKICAgIGVycm9yOiBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KCFqb2JJZEVtcHR5ICYmICFqb2JJZFZhbGlkID8gW19pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tbC5kYXRhZnJhbWUuYW5hbHl0aWNzLmNyZWF0ZS5qb2JJZEludmFsaWRFcnJvcicsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdNdXN0IGNvbnRhaW4gbG93ZXJjYXNlIGFscGhhbnVtZXJpYyBjaGFyYWN0ZXJzIChhLXogYW5kIDAtOSksIGh5cGhlbnMsIGFuZCB1bmRlcnNjb3JlcyBvbmx5IGFuZCBtdXN0IHN0YXJ0IGFuZCBlbmQgd2l0aCBhbHBoYW51bWVyaWMgY2hhcmFjdGVycy4nCiAgICB9KV0gOiBbXSksIF90b0NvbnN1bWFibGVBcnJheShqb2JJZEV4aXN0cyA/IFtfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWwuZGF0YWZyYW1lLmFuYWx5dGljcy5jcmVhdGUuam9iSWRFeGlzdHNFcnJvcicsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdBbiBhbmFseXRpY3Mgam9iIHdpdGggdGhpcyBJRCBhbHJlYWR5IGV4aXN0cy4nCiAgICB9KV0gOiBbXSksIF90b0NvbnN1bWFibGVBcnJheShqb2JJZEludmFsaWRNYXhMZW5ndGggPyBbX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1sLmRhdGFmcmFtZS5hbmFseXRpY3MuY3JlYXRlLmpvYklkSW52YWxpZE1heExlbmd0aEVycm9yTWVzc2FnZScsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdKb2IgSUQgbXVzdCBiZSBubyBtb3JlIHRoYW4ge21heExlbmd0aCwgcGx1cmFsLCBvbmUgeyMgY2hhcmFjdGVyfSBvdGhlciB7IyBjaGFyYWN0ZXJzfX0gbG9uZy4nLAogICAgICB2YWx1ZXM6IHsKICAgICAgICBtYXhMZW5ndGg6IF92YWxpZGF0aW9uLkpPQl9JRF9NQVhfTEVOR1RICiAgICAgIH0KICAgIH0pXSA6IFtdKSkKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmllbGRUZXh0LCB7CiAgICBkaXNhYmxlZDogaXNKb2JDcmVhdGVkLAogICAgcGxhY2Vob2xkZXI6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tbC5kYXRhZnJhbWUuYW5hbHl0aWNzLmNyZWF0ZS5qb2JJZFBsYWNlaG9sZGVyJywgewogICAgICBkZWZhdWx0TWVzc2FnZTogJ0pvYiBJRCcKICAgIH0pLAogICAgdmFsdWU6IGpvYklkLAogICAgb25DaGFuZ2U6IGZ1bmN0aW9uIG9uQ2hhbmdlKGUpIHsKICAgICAgcmV0dXJuIHNldEZvcm1TdGF0ZSh7CiAgICAgICAgam9iSWQ6IGUudGFyZ2V0LnZhbHVlCiAgICAgIH0pOwogICAgfSwKICAgICJhcmlhLWxhYmVsIjogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1sLmRhdGFmcmFtZS5hbmFseXRpY3MuY3JlYXRlLmpvYklkSW5wdXRBcmlhTGFiZWwnLCB7CiAgICAgIGRlZmF1bHRNZXNzYWdlOiAnQ2hvb3NlIGEgdW5pcXVlIGFuYWx5dGljcyBqb2IgSUQuJwogICAgfSksCiAgICBpc0ludmFsaWQ6ICFqb2JJZEVtcHR5ICYmICFqb2JJZFZhbGlkIHx8IGpvYklkRXhpc3RzLAogICAgImRhdGEtdGVzdC1zdWJqIjogIm1sQW5hbHl0aWNzQ3JlYXRlSm9iRmx5b3V0Sm9iSWRJbnB1dCIKICB9KSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2pvYl9kZXNjcmlwdGlvbi5Kb2JEZXNjcmlwdGlvbklucHV0LCB7CiAgICBkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24sCiAgICBzZXRGb3JtU3RhdGU6IHNldEZvcm1TdGF0ZQogIH0pLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRm9ybVJvdywgewogICAgbGFiZWw6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tbC5kYXRhZnJhbWUuYW5hbHl0aWNzLmNyZWF0ZS5zb3VyY2VJbmRleExhYmVsJywgewogICAgICBkZWZhdWx0TWVzc2FnZTogJ1NvdXJjZSBpbmRleCcKICAgIH0pLAogICAgaGVscFRleHQ6ICFzb3VyY2VJbmRleE5hbWVFbXB0eSAmJiAhc291cmNlSW5kZXhDb250YWluc051bWVyaWNhbEZpZWxkcyAmJiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWwuZGF0YWZyYW1lLmFuYWx5dGljcy5jcmVhdGUuc291cmNlSW5kZXhIZWxwVGV4dCcsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdUaGlzIGluZGV4IHBhdHRlcm4gZG9lcyBub3QgY29udGFpbiBhbnkgbnVtZXJpYyB0eXBlIGZpZWxkcy4gVGhlIGFuYWx5dGljcyBqb2IgbWF5IG5vdCBiZSBhYmxlIHRvIGNvbWUgdXAgd2l0aCBhbnkgb3V0bGllcnMuJwogICAgfSksCiAgICBpc0ludmFsaWQ6ICFzb3VyY2VJbmRleE5hbWVFbXB0eSAmJiAhc291cmNlSW5kZXhOYW1lVmFsaWQsCiAgICBlcnJvcjogZ2V0U291cmNlSW5kZXhFcnJvck1lc3NhZ2VzKCkKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5GcmFnbWVudCwgbnVsbCwgIWlzSm9iQ3JlYXRlZCAmJiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQ29tYm9Cb3gsIHsKICAgIHBsYWNlaG9sZGVyOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWwuZGF0YWZyYW1lLmFuYWx5dGljcy5jcmVhdGUuc291cmNlSW5kZXhQbGFjZWhvbGRlcicsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdDaG9vc2UgYSBzb3VyY2UgaW5kZXggcGF0dGVybi4nCiAgICB9KSwKICAgIHNpbmdsZVNlbGVjdGlvbjogewogICAgICBhc1BsYWluVGV4dDogdHJ1ZQogICAgfSwKICAgIG9wdGlvbnM6IE9iamVjdC52YWx1ZXMoaW5kZXhQYXR0ZXJuc01hcCkuc29ydChmdW5jdGlvbiAoYSwgYikgewogICAgICByZXR1cm4gYS5sYWJlbC5sb2NhbGVDb21wYXJlKGIubGFiZWwpOwogICAgfSksCiAgICBzZWxlY3RlZE9wdGlvbnM6IGluZGV4UGF0dGVybnNNYXBbc291cmNlSW5kZXhdICE9PSB1bmRlZmluZWQgPyBbewogICAgICBsYWJlbDogc291cmNlSW5kZXgKICAgIH1dIDogW10sCiAgICBvbkNoYW5nZTogb25Tb3VyY2VJbmRleENoYW5nZSwKICAgIGlzQ2xlYXJhYmxlOiBmYWxzZSwKICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJtbEFuYWx5dGljc0NyZWF0ZUpvYkZseW91dFNvdXJjZUluZGV4U2VsZWN0IgogIH0pLCBpc0pvYkNyZWF0ZWQgJiYgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZpZWxkVGV4dCwgewogICAgZGlzYWJsZWQ6IHRydWUsCiAgICB2YWx1ZTogc291cmNlSW5kZXgsCiAgICAiYXJpYS1sYWJlbCI6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tbC5kYXRhZnJhbWUuYW5hbHl0aWNzLmNyZWF0ZS5zb3VyY2VJbmRleElucHV0QXJpYUxhYmVsJywgewogICAgICBkZWZhdWx0TWVzc2FnZTogJ1NvdXJjZSBpbmRleCBwYXR0ZXJuIG9yIHNlYXJjaC4nCiAgICB9KQogIH0pKSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGb3JtUm93LCB7CiAgICBsYWJlbDogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1sLmRhdGFmcmFtZS5hbmFseXRpY3MuY3JlYXRlLmRlc3RpbmF0aW9uSW5kZXhMYWJlbCcsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdEZXN0aW5hdGlvbiBpbmRleCcKICAgIH0pLAogICAgaXNJbnZhbGlkOiAhZGVzdGluYXRpb25JbmRleE5hbWVFbXB0eSAmJiAhZGVzdGluYXRpb25JbmRleE5hbWVWYWxpZCwKICAgIGhlbHBUZXh0OiBkZXN0aW5hdGlvbkluZGV4TmFtZUV4aXN0cyAmJiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWwuZGF0YWZyYW1lLmFuYWx5dGljcy5jcmVhdGUuZGVzdGluYXRpb25JbmRleEhlbHBUZXh0JywgewogICAgICBkZWZhdWx0TWVzc2FnZTogJ0FuIGluZGV4IHdpdGggdGhpcyBuYW1lIGFscmVhZHkgZXhpc3RzLiBCZSBhd2FyZSB0aGF0IHJ1bm5pbmcgdGhpcyBhbmFseXRpY3Mgam9iIHdpbGwgbW9kaWZ5IHRoaXMgZGVzdGluYXRpb24gaW5kZXguJwogICAgfSksCiAgICBlcnJvcjogIWRlc3RpbmF0aW9uSW5kZXhOYW1lRW1wdHkgJiYgIWRlc3RpbmF0aW9uSW5kZXhOYW1lVmFsaWQgJiYgW19yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LkZyYWdtZW50LCBudWxsLCBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWwuZGF0YWZyYW1lLmFuYWx5dGljcy5jcmVhdGUuZGVzdGluYXRpb25JbmRleEludmFsaWRFcnJvcicsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdJbnZhbGlkIGRlc3RpbmF0aW9uIGluZGV4IG5hbWUuJwogICAgfSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImJyIiwgbnVsbCksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlMaW5rLCB7CiAgICAgIGhyZWY6ICJodHRwczovL3d3dy5lbGFzdGljLmNvL2d1aWRlL2VuL2VsYXN0aWNzZWFyY2gvcmVmZXJlbmNlLyIuY29uY2F0KF9tZXRhZGF0YS5tZXRhZGF0YS5icmFuY2gsICIvaW5kaWNlcy1jcmVhdGUtaW5kZXguaHRtbCNpbmRpY2VzLWNyZWF0ZS1pbmRleCIpLAogICAgICB0YXJnZXQ6ICJfYmxhbmsiCiAgICB9LCBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWwuZGF0YWZyYW1lLnN0ZXBEZXRhaWxzRm9ybS5kZXN0aW5hdGlvbkluZGV4SW52YWxpZEVycm9yTGluaycsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdMZWFybiBtb3JlIGFib3V0IGluZGV4IG5hbWUgbGltaXRhdGlvbnMuJwogICAgfSkpKV0KICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmllbGRUZXh0LCB7CiAgICBkaXNhYmxlZDogaXNKb2JDcmVhdGVkLAogICAgcGxhY2Vob2xkZXI6ICJkZXN0aW5hdGlvbiBpbmRleCIsCiAgICB2YWx1ZTogZGVzdGluYXRpb25JbmRleCwKICAgIG9uQ2hhbmdlOiBmdW5jdGlvbiBvbkNoYW5nZShlKSB7CiAgICAgIHJldHVybiBzZXRGb3JtU3RhdGUoewogICAgICAgIGRlc3RpbmF0aW9uSW5kZXg6IGUudGFyZ2V0LnZhbHVlCiAgICAgIH0pOwogICAgfSwKICAgICJhcmlhLWxhYmVsIjogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1sLmRhdGFmcmFtZS5hbmFseXRpY3MuY3JlYXRlLmRlc3RpbmF0aW9uSW5kZXhJbnB1dEFyaWFMYWJlbCcsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdDaG9vc2UgYSB1bmlxdWUgZGVzdGluYXRpb24gaW5kZXggbmFtZS4nCiAgICB9KSwKICAgIGlzSW52YWxpZDogIWRlc3RpbmF0aW9uSW5kZXhOYW1lRW1wdHkgJiYgIWRlc3RpbmF0aW9uSW5kZXhOYW1lVmFsaWQsCiAgICAiZGF0YS10ZXN0LXN1YmoiOiAibWxBbmFseXRpY3NDcmVhdGVKb2JGbHlvdXREZXN0aW5hdGlvbkluZGV4SW5wdXQiCiAgfSkpLCAoam9iVHlwZSA9PT0gX3N0YXRlLkpPQl9UWVBFUy5SRUdSRVNTSU9OIHx8IGpvYlR5cGUgPT09IF9zdGF0ZS5KT0JfVFlQRVMuQ0xBU1NJRklDQVRJT04pICYmIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LkZyYWdtZW50LCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRm9ybVJvdywgewogICAgZnVsbFdpZHRoOiB0cnVlLAogICAgaXNJbnZhbGlkOiBtYXhEaXN0aW5jdFZhbHVlc0Vycm9yICE9PSB1bmRlZmluZWQsCiAgICBlcnJvcjogX3RvQ29uc3VtYWJsZUFycmF5KGZpZWxkT3B0aW9uc0ZldGNoRmFpbCA9PT0gdHJ1ZSAmJiBtYXhEaXN0aW5jdFZhbHVlc0Vycm9yICE9PSB1bmRlZmluZWQgPyBbX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRnJhZ21lbnQsIG51bGwsIF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tbC5kYXRhZnJhbWUuYW5hbHl0aWNzLmNyZWF0ZS5kZXBlbmRlbnRWYXJpYWJsZU1heERpc3RpY3RWYWx1ZXNFcnJvcicsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdJbnZhbGlkLiB7bWVzc2FnZX0nLAogICAgICB2YWx1ZXM6IHsKICAgICAgICBtZXNzYWdlOiBtYXhEaXN0aW5jdFZhbHVlc0Vycm9yCiAgICAgIH0KICAgIH0pKV0gOiBbXSkKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5GcmFnbWVudCwgbnVsbCkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRm9ybVJvdywgewogICAgbGFiZWw6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tbC5kYXRhZnJhbWUuYW5hbHl0aWNzLmNyZWF0ZS5kZXBlbmRlbnRWYXJpYWJsZUxhYmVsJywgewogICAgICBkZWZhdWx0TWVzc2FnZTogJ0RlcGVuZGVudCB2YXJpYWJsZScKICAgIH0pLAogICAgaGVscFRleHQ6IGRlcGVuZGVudFZhcmlhYmxlT3B0aW9ucy5sZW5ndGggPT09IDAgJiYgZGVwZW5kZW50VmFyaWFibGVGZXRjaEZhaWwgPT09IGZhbHNlICYmICFzb3VyY2VJbmRleE5hbWVFbXB0eSAmJiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWwuZGF0YWZyYW1lLmFuYWx5dGljcy5jcmVhdGUuZGVwZW5kZW50VmFyaWFibGVPcHRpb25zTm9OdW1lcmljYWxGaWVsZHMnLCB7CiAgICAgIGRlZmF1bHRNZXNzYWdlOiAnTm8gbnVtZXJpYyB0eXBlIGZpZWxkcyB3ZXJlIGZvdW5kIGZvciB0aGlzIGluZGV4IHBhdHRlcm4uJwogICAgfSksCiAgICBpc0ludmFsaWQ6IG1heERpc3RpbmN0VmFsdWVzRXJyb3IgIT09IHVuZGVmaW5lZCwKICAgIGVycm9yOiBfdG9Db25zdW1hYmxlQXJyYXkoZGVwZW5kZW50VmFyaWFibGVGZXRjaEZhaWwgPT09IHRydWUgPyBbX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRnJhZ21lbnQsIG51bGwsIF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tbC5kYXRhZnJhbWUuYW5hbHl0aWNzLmNyZWF0ZS5kZXBlbmRlbnRWYXJpYWJsZU9wdGlvbnNGZXRjaEVycm9yJywgewogICAgICBkZWZhdWx0TWVzc2FnZTogJ1RoZXJlIHdhcyBhIHByb2JsZW0gZmV0Y2hpbmcgZmllbGRzLiBQbGVhc2UgcmVmcmVzaCB0aGUgcGFnZSBhbmQgdHJ5IGFnYWluLicKICAgIH0pKV0gOiBbXSkKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQ29tYm9Cb3gsIHsKICAgICJhcmlhLWxhYmVsIjogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1sLmRhdGFmcmFtZS5hbmFseXRpY3MuY3JlYXRlLmRlcGVuZGVudFZhcmlhYmxlSW5wdXRBcmlhTGFiZWwnLCB7CiAgICAgIGRlZmF1bHRNZXNzYWdlOiAnRW50ZXIgZmllbGQgdG8gYmUgdXNlZCBhcyBkZXBlbmRlbnQgdmFyaWFibGUuJwogICAgfSksCiAgICBwbGFjZWhvbGRlcjogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1sLmRhdGFmcmFtZS5hbmFseXRpY3MuY3JlYXRlLmRlcGVuZGVudFZhcmlhYmxlUGxhY2Vob2xkZXInLCB7CiAgICAgIGRlZmF1bHRNZXNzYWdlOiAnZGVwZW5kZW50IHZhcmlhYmxlJwogICAgfSksCiAgICBpc0Rpc2FibGVkOiBpc0pvYkNyZWF0ZWQsCiAgICBpc0xvYWRpbmc6IGxvYWRpbmdEZXBWYXJPcHRpb25zLAogICAgc2luZ2xlU2VsZWN0aW9uOiB0cnVlLAogICAgb3B0aW9uczogZGVwZW5kZW50VmFyaWFibGVPcHRpb25zLAogICAgc2VsZWN0ZWRPcHRpb25zOiBkZXBlbmRlbnRWYXJpYWJsZSA/IFt7CiAgICAgIGxhYmVsOiBkZXBlbmRlbnRWYXJpYWJsZQogICAgfV0gOiBbXSwKICAgIG9uQ2hhbmdlOiBmdW5jdGlvbiBvbkNoYW5nZShzZWxlY3RlZE9wdGlvbnMpIHsKICAgICAgcmV0dXJuIHNldEZvcm1TdGF0ZSh7CiAgICAgICAgZGVwZW5kZW50VmFyaWFibGU6IHNlbGVjdGVkT3B0aW9uc1swXS5sYWJlbCB8fCAnJwogICAgICB9KTsKICAgIH0sCiAgICBpc0NsZWFyYWJsZTogZmFsc2UsCiAgICBpc0ludmFsaWQ6IGRlcGVuZGVudFZhcmlhYmxlID09PSAnJywKICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJtbEFuYWx5dGljc0NyZWF0ZUpvYkZseW91dERlcGVuZGVudFZhcmlhYmxlU2VsZWN0IgogIH0pKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZvcm1Sb3csIHsKICAgIGxhYmVsOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWwuZGF0YWZyYW1lLmFuYWx5dGljcy5jcmVhdGUudHJhaW5pbmdQZXJjZW50TGFiZWwnLCB7CiAgICAgIGRlZmF1bHRNZXNzYWdlOiAnVHJhaW5pbmcgcGVyY2VudCcKICAgIH0pCiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVJhbmdlLCB7CiAgICBtaW46IDAsCiAgICBtYXg6IDEwMCwKICAgIHN0ZXA6IDEsCiAgICBzaG93TGFiZWxzOiB0cnVlLAogICAgc2hvd1JhbmdlOiB0cnVlLAogICAgc2hvd1ZhbHVlOiB0cnVlLAogICAgdmFsdWU6IHRyYWluaW5nUGVyY2VudCAvLyBAdHMtaWdub3JlIFByb3BlcnR5ICd2YWx1ZScgZG9lcyBub3QgZXhpc3Qgb24gdHlwZSAnRXZlbnRUYXJnZXQnIHwgKEV2ZW50VGFyZ2V0ICYgSFRNTElucHV0RWxlbWVudCkKICAgICwKICAgIG9uQ2hhbmdlOiBmdW5jdGlvbiBvbkNoYW5nZShlKSB7CiAgICAgIHJldHVybiBzZXRGb3JtU3RhdGUoewogICAgICAgIHRyYWluaW5nUGVyY2VudDogZS50YXJnZXQudmFsdWUKICAgICAgfSk7CiAgICB9LAogICAgImRhdGEtdGVzdC1zdWJqIjogIm1sQW5hbHl0aWNzQ3JlYXRlSm9iRmx5b3V0VHJhaW5pbmdQZXJjZW50U2xpZGVyIgogIH0pKSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGb3JtUm93LCB7CiAgICBsYWJlbDogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1sLmRhdGFmcmFtZS5hbmFseXRpY3MuY3JlYXRlLmV4Y2x1ZGVkRmllbGRzTGFiZWwnLCB7CiAgICAgIGRlZmF1bHRNZXNzYWdlOiAnRXhjbHVkZWQgZmllbGRzJwogICAgfSksCiAgICBoZWxwVGV4dDogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1sLmRhdGFmcmFtZS5hbmFseXRpY3MuY3JlYXRlLmV4Y2x1ZGVkRmllbGRzSGVscFRleHQnLCB7CiAgICAgIGRlZmF1bHRNZXNzYWdlOiAnT3B0aW9uYWxseSBzZWxlY3QgZmllbGRzIHRvIGJlIGV4Y2x1ZGVkIGZyb20gYW5hbHlzaXMuIEFsbCBvdGhlciBzdXBwb3J0ZWQgZmllbGRzIHdpbGwgYmUgaW5jbHVkZWQnCiAgICB9KSwKICAgIGVycm9yOiBleGNsdWRlc09wdGlvbnMubGVuZ3RoID09PSAwICYmIGZpZWxkT3B0aW9uc0ZldGNoRmFpbCA9PT0gZmFsc2UgJiYgIXNvdXJjZUluZGV4TmFtZUVtcHR5ICYmIFtfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWwuZGF0YWZyYW1lLmFuYWx5dGljcy5jcmVhdGUuZXhjbHVkZXNPcHRpb25zTm9TdXBwb3J0ZWRGaWVsZHMnLCB7CiAgICAgIGRlZmF1bHRNZXNzYWdlOiAnTm8gc3VwcG9ydGVkIGFuYWx5c2lzIGZpZWxkcyB3ZXJlIGZvdW5kIGZvciB0aGlzIGluZGV4IHBhdHRlcm4uJwogICAgfSldCiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUNvbWJvQm94LCB7CiAgICAiYXJpYS1sYWJlbCI6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tbC5kYXRhZnJhbWUuYW5hbHl0aWNzLmNyZWF0ZS5leGNsdWRlc0lucHV0QXJpYUxhYmVsJywgewogICAgICBkZWZhdWx0TWVzc2FnZTogJ09wdGlvbmFsLiBFbnRlciBvciBzZWxlY3QgZmllbGQgdG8gYmUgZXhjbHVkZWQuJwogICAgfSksCiAgICBpc0Rpc2FibGVkOiBpc0pvYkNyZWF0ZWQsCiAgICBpc0xvYWRpbmc6IGxvYWRpbmdGaWVsZE9wdGlvbnMsCiAgICBvcHRpb25zOiBleGNsdWRlc09wdGlvbnMsCiAgICBzZWxlY3RlZE9wdGlvbnM6IGV4Y2x1ZGVzLm1hcChmdW5jdGlvbiAoZmllbGQpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBsYWJlbDogZmllbGQKICAgICAgfTsKICAgIH0pLAogICAgb25DcmVhdGVPcHRpb246IG9uQ3JlYXRlT3B0aW9uLAogICAgb25DaGFuZ2U6IGZ1bmN0aW9uIG9uQ2hhbmdlKHNlbGVjdGVkT3B0aW9ucykgewogICAgICByZXR1cm4gc2V0Rm9ybVN0YXRlKHsKICAgICAgICBleGNsdWRlczogc2VsZWN0ZWRPcHRpb25zLm1hcChmdW5jdGlvbiAob3B0aW9uKSB7CiAgICAgICAgICByZXR1cm4gb3B0aW9uLmxhYmVsOwogICAgICAgIH0pCiAgICAgIH0pOwogICAgfSwKICAgIGlzQ2xlYXJhYmxlOiB0cnVlLAogICAgImRhdGEtdGVzdC1zdWJqIjogIm1sQW5hbHl0aWNzQ3JlYXRlSm9iRmx5b3V0RXhjbHVkZXNTZWxlY3QiCiAgfSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRm9ybVJvdywgewogICAgbGFiZWw6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tbC5kYXRhZnJhbWUuYW5hbHl0aWNzLmNyZWF0ZS5tb2RlbE1lbW9yeUxpbWl0TGFiZWwnLCB7CiAgICAgIGRlZmF1bHRNZXNzYWdlOiAnTW9kZWwgbWVtb3J5IGxpbWl0JwogICAgfSksCiAgICBoZWxwVGV4dDogIW1vZGVsTWVtb3J5TGltaXRVbml0VmFsaWQgJiYgX3JlZHVjZXIubW1sVW5pdEludmFsaWRFcnJvck1lc3NhZ2UKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmllbGRUZXh0LCB7CiAgICBwbGFjZWhvbGRlcjogam9iVHlwZSAhPT0gdW5kZWZpbmVkID8gX3N0YXRlLkRFRkFVTFRfTU9ERUxfTUVNT1JZX0xJTUlUW2pvYlR5cGVdIDogX3N0YXRlLkRFRkFVTFRfTU9ERUxfTUVNT1JZX0xJTUlULm91dGxpZXJfZGV0ZWN0aW9uLAogICAgZGlzYWJsZWQ6IGlzSm9iQ3JlYXRlZCwKICAgIHZhbHVlOiBtb2RlbE1lbW9yeUxpbWl0IHx8ICcnLAogICAgb25DaGFuZ2U6IGZ1bmN0aW9uIG9uQ2hhbmdlKGUpIHsKICAgICAgcmV0dXJuIHNldEZvcm1TdGF0ZSh7CiAgICAgICAgbW9kZWxNZW1vcnlMaW1pdDogZS50YXJnZXQudmFsdWUKICAgICAgfSk7CiAgICB9LAogICAgaXNJbnZhbGlkOiBtb2RlbE1lbW9yeUxpbWl0ID09PSAnJywKICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJtbEFuYWx5dGljc0NyZWF0ZUpvYkZseW91dE1vZGVsTWVtb3J5SW5wdXQiCiAgfSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRm9ybVJvdywgewogICAgaXNJbnZhbGlkOiBjcmVhdGVJbmRleFBhdHRlcm4gJiYgZGVzdGluYXRpb25JbmRleFBhdHRlcm5UaXRsZUV4aXN0cywKICAgIGVycm9yOiBjcmVhdGVJbmRleFBhdHRlcm4gJiYgZGVzdGluYXRpb25JbmRleFBhdHRlcm5UaXRsZUV4aXN0cyAmJiBbX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1sLmRhdGFmcmFtZS5hbmFseXRpY3MuY3JlYXRlLmluZGV4UGF0dGVybkV4aXN0c0Vycm9yJywgewogICAgICBkZWZhdWx0TWVzc2FnZTogJ0FuIGluZGV4IHBhdHRlcm4gd2l0aCB0aGlzIHRpdGxlIGFscmVhZHkgZXhpc3RzLicKICAgIH0pXQogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTd2l0Y2gsIHsKICAgIGRpc2FibGVkOiBpc0pvYkNyZWF0ZWQsCiAgICBuYW1lOiAibWxEYXRhRnJhbWVBbmFseXRpY3NDcmVhdGVJbmRleFBhdHRlcm4iLAogICAgbGFiZWw6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tbC5kYXRhZnJhbWUuYW5hbHl0aWNzLmNyZWF0ZS5jcmVhdGVJbmRleFBhdHRlcm5MYWJlbCcsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdDcmVhdGUgaW5kZXggcGF0dGVybicKICAgIH0pLAogICAgY2hlY2tlZDogY3JlYXRlSW5kZXhQYXR0ZXJuID09PSB0cnVlLAogICAgb25DaGFuZ2U6IGZ1bmN0aW9uIG9uQ2hhbmdlKCkgewogICAgICByZXR1cm4gc2V0Rm9ybVN0YXRlKHsKICAgICAgICBjcmVhdGVJbmRleFBhdHRlcm46ICFjcmVhdGVJbmRleFBhdHRlcm4KICAgICAgfSk7CiAgICB9LAogICAgImRhdGEtdGVzdC1zdWJqIjogIm1sQW5hbHl0aWNzQ3JlYXRlSm9iRmx5b3V0Q3JlYXRlSW5kZXhQYXR0ZXJuU3dpdGNoIgogIH0pKSkpOwp9OwoKZXhwb3J0cy5DcmVhdGVBbmFseXRpY3NGb3JtID0gQ3JlYXRlQW5hbHl0aWNzRm9ybTs="},null]}