{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/siem/public/containers/detection_engine/rules/use_rules.js","dependencies":[{"path":"x-pack/legacy/plugins/siem/public/containers/detection_engine/rules/use_rules.js","mtime":1585205047787},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLnVzZVJ1bGVzID0gdm9pZCAwOwoKdmFyIF9mcCA9IHJlcXVpcmUoImxvZGFzaC9mcCIpOwoKdmFyIF9yZWFjdCA9IHJlcXVpcmUoInJlYWN0Iik7Cgp2YXIgX3RvYXN0ZXJzID0gcmVxdWlyZSgiLi4vLi4vLi4vY29tcG9uZW50cy90b2FzdGVycyIpOwoKdmFyIF9hcGkgPSByZXF1aXJlKCIuL2FwaSIpOwoKdmFyIF9lcnJvcl90b190b2FzdGVyID0gcmVxdWlyZSgiLi4vLi4vLi4vY29tcG9uZW50cy9tbC9hcGkvZXJyb3JfdG9fdG9hc3RlciIpOwoKdmFyIGkxOG4gPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKCIuL3RyYW5zbGF0aW9ucyIpKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgewogIGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsKICAgIHJldHVybiBvYmo7CiAgfSBlbHNlIHsKICAgIHZhciBuZXdPYmogPSB7fTsKCiAgICBpZiAob2JqICE9IG51bGwpIHsKICAgICAgZm9yICh2YXIga2V5IGluIG9iaikgewogICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7CiAgICAgICAgICB2YXIgZGVzYyA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSAmJiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID8gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIGtleSkgOiB7fTsKCiAgICAgICAgICBpZiAoZGVzYy5nZXQgfHwgZGVzYy5zZXQpIHsKICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5ld09iaiwga2V5LCBkZXNjKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG5ld09ialtrZXldID0gb2JqW2tleV07CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgbmV3T2JqLmRlZmF1bHQgPSBvYmo7CiAgICByZXR1cm4gbmV3T2JqOwogIH0KfQoKZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7CiAgcmV0dXJuIF9hcnJheVdpdGhIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHx8IF9ub25JdGVyYWJsZVJlc3QoKTsKfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlUmVzdCgpIHsKICB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7Cn0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHsKICB2YXIgX2FyciA9IFtdOwogIHZhciBfbiA9IHRydWU7CiAgdmFyIF9kID0gZmFsc2U7CiAgdmFyIF9lID0gdW5kZWZpbmVkOwoKICB0cnkgewogICAgZm9yICh2YXIgX2kgPSBhcnJbU3ltYm9sLml0ZXJhdG9yXSgpLCBfczsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSkgewogICAgICBfYXJyLnB1c2goX3MudmFsdWUpOwoKICAgICAgaWYgKGkgJiYgX2Fyci5sZW5ndGggPT09IGkpIGJyZWFrOwogICAgfQogIH0gY2F0Y2ggKGVycikgewogICAgX2QgPSB0cnVlOwogICAgX2UgPSBlcnI7CiAgfSBmaW5hbGx5IHsKICAgIHRyeSB7CiAgICAgIGlmICghX24gJiYgX2lbInJldHVybiJdICE9IG51bGwpIF9pWyJyZXR1cm4iXSgpOwogICAgfSBmaW5hbGx5IHsKICAgICAgaWYgKF9kKSB0aHJvdyBfZTsKICAgIH0KICB9CgogIHJldHVybiBfYXJyOwp9CgpmdW5jdGlvbiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsKfQovKioKICogSG9vayBmb3IgdXNpbmcgdGhlIGxpc3Qgb2YgUnVsZXMgZnJvbSB0aGUgRGV0ZWN0aW9uIEVuZ2luZSBBUEkKICoKICogQHBhcmFtIHBhZ2luYXRpb24gZGVzaXJlZCBwYWdpbmF0aW9uIG9wdGlvbnMgKGUuZy4gcGFnZS9wZXJQYWdlKQogKiBAcGFyYW0gZmlsdGVyT3B0aW9ucyBkZXNpcmVkIGZpbHRlcnMgKGUuZy4gZmlsdGVyL3NvcnRGaWVsZC9zb3J0T3JkZXIpCiAqLwoKCnZhciB1c2VSdWxlcyA9IGZ1bmN0aW9uIHVzZVJ1bGVzKF9yZWYpIHsKICB2YXIgX2ZpbHRlck9wdGlvbnMkdGFnczsKCiAgdmFyIHBhZ2luYXRpb24gPSBfcmVmLnBhZ2luYXRpb24sCiAgICAgIGZpbHRlck9wdGlvbnMgPSBfcmVmLmZpbHRlck9wdGlvbnMsCiAgICAgIHJlZmV0Y2hQcmVQYWNrYWdlZFJ1bGVzU3RhdHVzID0gX3JlZi5yZWZldGNoUHJlUGFja2FnZWRSdWxlc1N0YXR1cywKICAgICAgZGlzcGF0Y2hSdWxlc0luUmVkdWNlciA9IF9yZWYuZGlzcGF0Y2hSdWxlc0luUmVkdWNlcjsKCiAgdmFyIF91c2VTdGF0ZSA9ICgwLCBfcmVhY3QudXNlU3RhdGUpKG51bGwpLAogICAgICBfdXNlU3RhdGUyID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlLCAyKSwKICAgICAgcnVsZXMgPSBfdXNlU3RhdGUyWzBdLAogICAgICBzZXRSdWxlcyA9IF91c2VTdGF0ZTJbMV07CgogIHZhciByZUZldGNoUnVsZXMgPSAoMCwgX3JlYWN0LnVzZVJlZikoX2ZwLm5vb3ApOwoKICB2YXIgX3VzZVN0YXRlMyA9ICgwLCBfcmVhY3QudXNlU3RhdGUpKHRydWUpLAogICAgICBfdXNlU3RhdGU0ID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlMywgMiksCiAgICAgIGxvYWRpbmcgPSBfdXNlU3RhdGU0WzBdLAogICAgICBzZXRMb2FkaW5nID0gX3VzZVN0YXRlNFsxXTsKCiAgdmFyIF91c2VTdGF0ZVRvYXN0ZXIgPSAoMCwgX3RvYXN0ZXJzLnVzZVN0YXRlVG9hc3RlcikoKSwKICAgICAgX3VzZVN0YXRlVG9hc3RlcjIgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGVUb2FzdGVyLCAyKSwKICAgICAgZGlzcGF0Y2hUb2FzdGVyID0gX3VzZVN0YXRlVG9hc3RlcjJbMV07CgogICgwLCBfcmVhY3QudXNlRWZmZWN0KShmdW5jdGlvbiAoKSB7CiAgICB2YXIgaXNTdWJzY3JpYmVkID0gdHJ1ZTsKICAgIHZhciBhYm9ydEN0cmwgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7CgogICAgZnVuY3Rpb24gZmV0Y2hEYXRhKCkgewogICAgICB2YXIgZm9yY2VSZWxvYWQsCiAgICAgICAgICBmZXRjaFJ1bGVzUmVzdWx0LAogICAgICAgICAgX2FyZ3MgPSBhcmd1bWVudHM7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXN5bmMoZnVuY3Rpb24gZmV0Y2hEYXRhJChfY29udGV4dCkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBmb3JjZVJlbG9hZCA9IF9hcmdzLmxlbmd0aCA+IDAgJiYgX2FyZ3NbMF0gIT09IHVuZGVmaW5lZCA/IF9hcmdzWzBdIDogZmFsc2U7CiAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDE7CiAgICAgICAgICAgICAgc2V0TG9hZGluZyh0cnVlKTsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNTsKICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKCgwLCBfYXBpLmZldGNoUnVsZXMpKHsKICAgICAgICAgICAgICAgIGZpbHRlck9wdGlvbnM6IGZpbHRlck9wdGlvbnMsCiAgICAgICAgICAgICAgICBwYWdpbmF0aW9uOiBwYWdpbmF0aW9uLAogICAgICAgICAgICAgICAgc2lnbmFsOiBhYm9ydEN0cmwuc2lnbmFsCiAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgIGZldGNoUnVsZXNSZXN1bHQgPSBfY29udGV4dC5zZW50OwoKICAgICAgICAgICAgICBpZiAoaXNTdWJzY3JpYmVkKSB7CiAgICAgICAgICAgICAgICBzZXRSdWxlcyhmZXRjaFJ1bGVzUmVzdWx0KTsKCiAgICAgICAgICAgICAgICBpZiAoZGlzcGF0Y2hSdWxlc0luUmVkdWNlciAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICAgIGRpc3BhdGNoUnVsZXNJblJlZHVjZXIoZmV0Y2hSdWxlc1Jlc3VsdC5kYXRhLCB7CiAgICAgICAgICAgICAgICAgICAgcGFnZTogZmV0Y2hSdWxlc1Jlc3VsdC5wYWdlLAogICAgICAgICAgICAgICAgICAgIHBlclBhZ2U6IGZldGNoUnVsZXNSZXN1bHQucGVyUGFnZSwKICAgICAgICAgICAgICAgICAgICB0b3RhbDogZmV0Y2hSdWxlc1Jlc3VsdC50b3RhbAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMjsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gOTsKICAgICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDEpOwoKICAgICAgICAgICAgICBpZiAoaXNTdWJzY3JpYmVkKSB7CiAgICAgICAgICAgICAgICAoMCwgX2Vycm9yX3RvX3RvYXN0ZXIuZXJyb3JUb1RvYXN0ZXIpKHsKICAgICAgICAgICAgICAgICAgdGl0bGU6IGkxOG4uUlVMRV9GRVRDSF9GQUlMVVJFLAogICAgICAgICAgICAgICAgICBlcnJvcjogX2NvbnRleHQudDAsCiAgICAgICAgICAgICAgICAgIGRpc3BhdGNoVG9hc3RlcjogZGlzcGF0Y2hUb2FzdGVyCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICBpZiAoZGlzcGF0Y2hSdWxlc0luUmVkdWNlciAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICAgIGRpc3BhdGNoUnVsZXNJblJlZHVjZXIoW10sIHt9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CgogICAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICAgIGlmIChpc1N1YnNjcmliZWQpIHsKICAgICAgICAgICAgICAgIHNldExvYWRpbmcoZmFsc2UpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIG51bGwsIG51bGwsIFtbMSwgOV1dKTsKICAgIH0KCiAgICBmZXRjaERhdGEoKTsKCiAgICByZUZldGNoUnVsZXMuY3VycmVudCA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHJlZnJlc2hQcmVQYWNrYWdlZFJ1bGUgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IGZhbHNlOwogICAgICBmZXRjaERhdGEodHJ1ZSk7CgogICAgICBpZiAocmVmcmVzaFByZVBhY2thZ2VkUnVsZSAmJiByZWZldGNoUHJlUGFja2FnZWRSdWxlc1N0YXR1cyAhPSBudWxsKSB7CiAgICAgICAgcmVmZXRjaFByZVBhY2thZ2VkUnVsZXNTdGF0dXMoKTsKICAgICAgfQogICAgfTsKCiAgICByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICBpc1N1YnNjcmliZWQgPSBmYWxzZTsKICAgICAgYWJvcnRDdHJsLmFib3J0KCk7CiAgICB9OwogIH0sIFtwYWdpbmF0aW9uLnBhZ2UsIHBhZ2luYXRpb24ucGVyUGFnZSwgZmlsdGVyT3B0aW9ucy5maWx0ZXIsIGZpbHRlck9wdGlvbnMuc29ydEZpZWxkLCBmaWx0ZXJPcHRpb25zLnNvcnRPcmRlciwgKF9maWx0ZXJPcHRpb25zJHRhZ3MgPSBmaWx0ZXJPcHRpb25zLnRhZ3MpID09PSBudWxsIHx8IF9maWx0ZXJPcHRpb25zJHRhZ3MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9maWx0ZXJPcHRpb25zJHRhZ3Muc29ydCgpLmpvaW4oKSwgZmlsdGVyT3B0aW9ucy5zaG93Q3VzdG9tUnVsZXMsIGZpbHRlck9wdGlvbnMuc2hvd0VsYXN0aWNSdWxlcywgcmVmZXRjaFByZVBhY2thZ2VkUnVsZXNTdGF0dXNdKTsKICByZXR1cm4gW2xvYWRpbmcsIHJ1bGVzLCByZUZldGNoUnVsZXMuY3VycmVudF07Cn07CgpleHBvcnRzLnVzZVJ1bGVzID0gdXNlUnVsZXM7"},null]}