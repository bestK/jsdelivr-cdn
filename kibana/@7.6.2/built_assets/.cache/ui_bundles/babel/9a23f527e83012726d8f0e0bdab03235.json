{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/ml/public/application/components/annotations/annotation_flyout/index.js","dependencies":[{"path":"x-pack/legacy/plugins/ml/public/application/components/annotations/annotation_flyout/index.js","mtime":1585205045421},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiKSB7IF90eXBlb2YyID0gZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mMiA9IGZ1bmN0aW9uIF90eXBlb2YyKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mMihvYmopOyB9CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuQW5ub3RhdGlvbkZseW91dCA9IHZvaWQgMDsKCnZhciBfcmVhY3QgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKCJyZWFjdCIpKTsKCnZhciBfdXNlT2JzZXJ2YWJsZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgicmVhY3QtdXNlL2xpYi91c2VPYnNlcnZhYmxlIikpOwoKdmFyIF9ldWkgPSByZXF1aXJlKCJAZWxhc3RpYy9ldWkiKTsKCnZhciBfaTE4biA9IHJlcXVpcmUoIkBrYm4vaTE4biIpOwoKdmFyIF9yZWFjdDIgPSByZXF1aXJlKCJAa2JuL2kxOG4vcmVhY3QiKTsKCnZhciBfbm90aWZ5ID0gcmVxdWlyZSgidWkvbm90aWZ5Iik7Cgp2YXIgX2Fubm90YXRpb25zID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vLi4vY29tbW9uL2NvbnN0YW50cy9hbm5vdGF0aW9ucyIpOwoKdmFyIF9hbm5vdGF0aW9uc19zZXJ2aWNlID0gcmVxdWlyZSgiLi4vLi4vLi4vc2VydmljZXMvYW5ub3RhdGlvbnNfc2VydmljZSIpOwoKdmFyIF9hbm5vdGF0aW9uX2Rlc2NyaXB0aW9uX2xpc3QgPSByZXF1aXJlKCIuLi9hbm5vdGF0aW9uX2Rlc2NyaXB0aW9uX2xpc3QiKTsKCnZhciBfZGVsZXRlX2Fubm90YXRpb25fbW9kYWwgPSByZXF1aXJlKCIuLi9kZWxldGVfYW5ub3RhdGlvbl9tb2RhbCIpOwoKdmFyIF9tbF9hcGlfc2VydmljZSA9IHJlcXVpcmUoIi4uLy4uLy4uL3NlcnZpY2VzL21sX2FwaV9zZXJ2aWNlIik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgewogIHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7CiAgICBkZWZhdWx0OiBvYmoKICB9Owp9CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsKICBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7CiAgICByZXR1cm4gb2JqOwogIH0gZWxzZSB7CiAgICB2YXIgbmV3T2JqID0ge307CgogICAgaWYgKG9iaiAhPSBudWxsKSB7CiAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHsKICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgewogICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvciA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpIDoge307CgogICAgICAgICAgaWYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSB7CiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmosIGtleSwgZGVzYyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBuZXdPYmpba2V5XSA9IG9ialtrZXldOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIG5ld09iai5kZWZhdWx0ID0gb2JqOwogICAgcmV0dXJuIG5ld09iajsKICB9Cn0KCmZ1bmN0aW9uIF9leHRlbmRzKCkgewogIF9leHRlbmRzID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiAodGFyZ2V0KSB7CiAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgewogICAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldOwoKICAgICAgZm9yICh2YXIga2V5IGluIHNvdXJjZSkgewogICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoc291cmNlLCBrZXkpKSB7CiAgICAgICAgICB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHJldHVybiB0YXJnZXQ7CiAgfTsKCiAgcmV0dXJuIF9leHRlbmRzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn0KCmZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7CiAgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgX3R5cGVvZjIoU3ltYm9sLml0ZXJhdG9yKSA9PT0gInN5bWJvbCIpIHsKICAgIF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgewogICAgICByZXR1cm4gX3R5cGVvZjIob2JqKTsKICAgIH07CiAgfSBlbHNlIHsKICAgIF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgewogICAgICByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiBfdHlwZW9mMihvYmopOwogICAgfTsKICB9CgogIHJldHVybiBfdHlwZW9mKG9iaik7Cn0KCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgewogIHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsKCiAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsKICAgIHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOwogICAgaWYgKGVudW1lcmFibGVPbmx5KSBzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgewogICAgICByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsKICAgIH0pOwogICAga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOwogIH0KCiAgcmV0dXJuIGtleXM7Cn0KCmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7CiAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsKICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OwoKICAgIGlmIChpICUgMikgewogICAgICBvd25LZXlzKHNvdXJjZSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7CiAgICAgIH0pOwogICAgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgewogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpOwogICAgfSBlbHNlIHsKICAgICAgb3duS2V5cyhzb3VyY2UpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOwogICAgICB9KTsKICAgIH0KICB9CgogIHJldHVybiB0YXJnZXQ7Cn0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsKICBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7CiAgfQp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgewogICAgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsKICAgIGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsKICAgIGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsKICAgIGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOwogIH0KfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgewogIGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOwogIGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsKICByZXR1cm4gQ29uc3RydWN0b3I7Cn0KCmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsKICBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpKSB7CiAgICByZXR1cm4gY2FsbDsKICB9CgogIHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOwp9CgpmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgewogIF9nZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7CiAgICByZXR1cm4gby5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKG8pOwogIH07CiAgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsKfQoKZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7CiAgaWYgKHNlbGYgPT09IHZvaWQgMCkgewogICAgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsKICB9CgogIHJldHVybiBzZWxmOwp9CgpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsKICBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICJmdW5jdGlvbiIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24iKTsKICB9CgogIHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgewogICAgY29uc3RydWN0b3I6IHsKICAgICAgdmFsdWU6IHN1YkNsYXNzLAogICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlCiAgICB9CiAgfSk7CiAgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcyk7Cn0KCmZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7CiAgX3NldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IGZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7CiAgICBvLl9fcHJvdG9fXyA9IHA7CiAgICByZXR1cm4gbzsKICB9OwoKICByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApOwp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7CiAgaWYgKGtleSBpbiBvYmopIHsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgICB2YWx1ZTogdmFsdWUsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgd3JpdGFibGU6IHRydWUKICAgIH0pOwogIH0gZWxzZSB7CiAgICBvYmpba2V5XSA9IHZhbHVlOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKdmFyIEFubm90YXRpb25GbHlvdXRJbnRsID0KLyojX19QVVJFX18qLwpmdW5jdGlvbiAoX0NvbXBvbmVudCkgewogIF9pbmhlcml0cyhBbm5vdGF0aW9uRmx5b3V0SW50bCwgX0NvbXBvbmVudCk7CgogIGZ1bmN0aW9uIEFubm90YXRpb25GbHlvdXRJbnRsKCkgewogICAgdmFyIF9nZXRQcm90b3R5cGVPZjI7CgogICAgdmFyIF90aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBBbm5vdGF0aW9uRmx5b3V0SW50bCk7CgogICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbiksIF9rZXkgPSAwOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7CiAgICAgIGFyZ3NbX2tleV0gPSBhcmd1bWVudHNbX2tleV07CiAgICB9CgogICAgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoX2dldFByb3RvdHlwZU9mMiA9IF9nZXRQcm90b3R5cGVPZihBbm5vdGF0aW9uRmx5b3V0SW50bCkpLmNhbGwuYXBwbHkoX2dldFByb3RvdHlwZU9mMiwgW3RoaXNdLmNvbmNhdChhcmdzKSkpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInN0YXRlIiwgewogICAgICBpc0RlbGV0ZU1vZGFsVmlzaWJsZTogZmFsc2UKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImFubm90YXRpb25TdWIiLCBudWxsKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJhbm5vdGF0aW9uVGV4dENoYW5nZUhhbmRsZXIiLCBmdW5jdGlvbiAoZSkgewogICAgICBpZiAoX3RoaXMucHJvcHMuYW5ub3RhdGlvbiA9PT0gbnVsbCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgX2Fubm90YXRpb25zX3NlcnZpY2UuYW5ub3RhdGlvbiQubmV4dChfb2JqZWN0U3ByZWFkKHt9LCBfdGhpcy5wcm9wcy5hbm5vdGF0aW9uLCB7CiAgICAgICAgYW5ub3RhdGlvbjogZS50YXJnZXQudmFsdWUKICAgICAgfSkpOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiY2FuY2VsRWRpdGluZ0hhbmRsZXIiLCBmdW5jdGlvbiAoKSB7CiAgICAgIF9hbm5vdGF0aW9uc19zZXJ2aWNlLmFubm90YXRpb24kLm5leHQobnVsbCk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJkZWxldGVDb25maXJtSGFuZGxlciIsIGZ1bmN0aW9uICgpIHsKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIGlzRGVsZXRlTW9kYWxWaXNpYmxlOiB0cnVlCiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiZGVsZXRlSGFuZGxlciIsIGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgIHZhciBhbm5vdGF0aW9uOwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmFzeW5jKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGFubm90YXRpb24gPSBfdGhpcy5wcm9wcy5hbm5vdGF0aW9uOwoKICAgICAgICAgICAgICBpZiAoIShhbm5vdGF0aW9uID09PSBudWxsKSkgewogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDM7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAzOwogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA2OwogICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAoX21sX2FwaV9zZXJ2aWNlLm1sLmFubm90YXRpb25zLmRlbGV0ZUFubm90YXRpb24oYW5ub3RhdGlvbi5faWQpKTsKCiAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICBfbm90aWZ5LnRvYXN0Tm90aWZpY2F0aW9ucy5hZGRTdWNjZXNzKF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tbC50aW1lU2VyaWVzRXhwbG9yZXIudGltZVNlcmllc0NoYXJ0LmRlbGV0ZWRBbm5vdGF0aW9uTm90aWZpY2F0aW9uTWVzc2FnZScsIHsKICAgICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnRGVsZXRlZCBhbm5vdGF0aW9uIGZvciBqb2Igd2l0aCBJRCB7am9iSWR9LicsCiAgICAgICAgICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgICAgICAgICAgam9iSWQ6IGFubm90YXRpb24uam9iX2lkCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTI7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDk7CiAgICAgICAgICAgICAgX2NvbnRleHQudDAgPSBfY29udGV4dFsiY2F0Y2giXSgzKTsKCiAgICAgICAgICAgICAgX25vdGlmeS50b2FzdE5vdGlmaWNhdGlvbnMuYWRkRGFuZ2VyKF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tbC50aW1lU2VyaWVzRXhwbG9yZXIudGltZVNlcmllc0NoYXJ0LmVycm9yV2l0aERlbGV0aW5nQW5ub3RhdGlvbk5vdGlmaWNhdGlvbkVycm9yTWVzc2FnZScsIHsKICAgICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnQW4gZXJyb3Igb2NjdXJyZWQgZGVsZXRpbmcgdGhlIGFubm90YXRpb24gZm9yIGpvYiB3aXRoIElEIHtqb2JJZH06IHtlcnJvcn0nLAogICAgICAgICAgICAgICAgdmFsdWVzOiB7CiAgICAgICAgICAgICAgICAgIGpvYklkOiBhbm5vdGF0aW9uLmpvYl9pZCwKICAgICAgICAgICAgICAgICAgZXJyb3I6IEpTT04uc3RyaW5naWZ5KF9jb250ZXh0LnQwKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgX3RoaXMuY2xvc2VEZWxldGVNb2RhbCgpOwoKICAgICAgICAgICAgICBfYW5ub3RhdGlvbnNfc2VydmljZS5hbm5vdGF0aW9uJC5uZXh0KG51bGwpOwoKICAgICAgICAgICAgICAoMCwgX2Fubm90YXRpb25zX3NlcnZpY2UuYW5ub3RhdGlvbnNSZWZyZXNoZWQpKCk7CgogICAgICAgICAgICBjYXNlIDE1OgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBudWxsLCBudWxsLCBbWzMsIDldXSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJjbG9zZURlbGV0ZU1vZGFsIiwgZnVuY3Rpb24gKCkgewogICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgaXNEZWxldGVNb2RhbFZpc2libGU6IGZhbHNlCiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAidmFsaWRhdGVBbm5vdGF0aW9uVGV4dCIsIGZ1bmN0aW9uICgpIHsKICAgICAgLy8gVmFsaWRhdGVzIHRoZSBlbnRlcmVkIHRleHQsIHJldHVybmluZyBhbiBhcnJheSBvZiBlcnJvciBtZXNzYWdlcwogICAgICAvLyBmb3IgZGlzcGxheSBpbiB0aGUgZm9ybS4gQW4gZW1wdHkgYXJyYXkgaXMgcmV0dXJuZWQgaWYgdGhlIHRleHQgaXMgdmFsaWQuCiAgICAgIHZhciBhbm5vdGF0aW9uID0gX3RoaXMucHJvcHMuYW5ub3RhdGlvbjsKICAgICAgdmFyIGVycm9ycyA9IFtdOwoKICAgICAgaWYgKGFubm90YXRpb24gPT09IG51bGwpIHsKICAgICAgICByZXR1cm4gZXJyb3JzOwogICAgICB9CgogICAgICBpZiAoYW5ub3RhdGlvbi5hbm5vdGF0aW9uLnRyaW0oKS5sZW5ndGggPT09IDApIHsKICAgICAgICBlcnJvcnMucHVzaChfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWwudGltZVNlcmllc0V4cGxvcmVyLmFubm90YXRpb25GbHlvdXQubm9Bbm5vdGF0aW9uVGV4dEVycm9yJywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdFbnRlciBhbm5vdGF0aW9uIHRleHQnCiAgICAgICAgfSkpOwogICAgICB9CgogICAgICB2YXIgdGV4dExlbmd0aCA9IGFubm90YXRpb24uYW5ub3RhdGlvbi5sZW5ndGg7CgogICAgICBpZiAodGV4dExlbmd0aCA+IF9hbm5vdGF0aW9ucy5BTk5PVEFUSU9OX01BWF9MRU5HVEhfQ0hBUlMpIHsKICAgICAgICB2YXIgY2hhcnNPdmVyID0gdGV4dExlbmd0aCAtIF9hbm5vdGF0aW9ucy5BTk5PVEFUSU9OX01BWF9MRU5HVEhfQ0hBUlM7CiAgICAgICAgZXJyb3JzLnB1c2goX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1sLnRpbWVTZXJpZXNFeHBsb3Jlci5hbm5vdGF0aW9uRmx5b3V0Lm1heExlbmd0aEVycm9yJywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICd7Y2hhcnNPdmVyLCBudW1iZXJ9IHtjaGFyc092ZXIsIHBsdXJhbCwgb25lIHtjaGFyYWN0ZXJ9IG90aGVyIHtjaGFyYWN0ZXJzfX0gYWJvdmUgbWF4aW11bSBsZW5ndGggb2Yge21heENoYXJzfScsCiAgICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgICAgbWF4Q2hhcnM6IF9hbm5vdGF0aW9ucy5BTk5PVEFUSU9OX01BWF9MRU5HVEhfQ0hBUlMsCiAgICAgICAgICAgIGNoYXJzT3ZlcjogY2hhcnNPdmVyCiAgICAgICAgICB9CiAgICAgICAgfSkpOwogICAgICB9CgogICAgICByZXR1cm4gZXJyb3JzOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAic2F2ZU9yVXBkYXRlQW5ub3RhdGlvbiIsIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIGFubm90YXRpb24gPSBfdGhpcy5wcm9wcy5hbm5vdGF0aW9uOwoKICAgICAgaWYgKGFubm90YXRpb24gPT09IG51bGwpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIF9hbm5vdGF0aW9uc19zZXJ2aWNlLmFubm90YXRpb24kLm5leHQobnVsbCk7CgogICAgICBfbWxfYXBpX3NlcnZpY2UubWwuYW5ub3RhdGlvbnMuaW5kZXhBbm5vdGF0aW9uKGFubm90YXRpb24pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICgwLCBfYW5ub3RhdGlvbnNfc2VydmljZS5hbm5vdGF0aW9uc1JlZnJlc2hlZCkoKTsKCiAgICAgICAgaWYgKHR5cGVvZiBhbm5vdGF0aW9uLl9pZCA9PT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICAgIF9ub3RpZnkudG9hc3ROb3RpZmljYXRpb25zLmFkZFN1Y2Nlc3MoX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1sLnRpbWVTZXJpZXNFeHBsb3Jlci50aW1lU2VyaWVzQ2hhcnQuYWRkZWRBbm5vdGF0aW9uTm90aWZpY2F0aW9uTWVzc2FnZScsIHsKICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdBZGRlZCBhbiBhbm5vdGF0aW9uIGZvciBqb2Igd2l0aCBJRCB7am9iSWR9LicsCiAgICAgICAgICAgIHZhbHVlczogewogICAgICAgICAgICAgIGpvYklkOiBhbm5vdGF0aW9uLmpvYl9pZAogICAgICAgICAgICB9CiAgICAgICAgICB9KSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIF9ub3RpZnkudG9hc3ROb3RpZmljYXRpb25zLmFkZFN1Y2Nlc3MoX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1sLnRpbWVTZXJpZXNFeHBsb3Jlci50aW1lU2VyaWVzQ2hhcnQudXBkYXRlZEFubm90YXRpb25Ob3RpZmljYXRpb25NZXNzYWdlJywgewogICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1VwZGF0ZWQgYW5ub3RhdGlvbiBmb3Igam9iIHdpdGggSUQge2pvYklkfS4nLAogICAgICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgICAgICBqb2JJZDogYW5ub3RhdGlvbi5qb2JfaWQKICAgICAgICAgICAgfQogICAgICAgICAgfSkpOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlc3ApIHsKICAgICAgICBpZiAodHlwZW9mIGFubm90YXRpb24uX2lkID09PSAndW5kZWZpbmVkJykgewogICAgICAgICAgX25vdGlmeS50b2FzdE5vdGlmaWNhdGlvbnMuYWRkRGFuZ2VyKF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tbC50aW1lU2VyaWVzRXhwbG9yZXIudGltZVNlcmllc0NoYXJ0LmVycm9yV2l0aENyZWF0aW5nQW5ub3RhdGlvbk5vdGlmaWNhdGlvbkVycm9yTWVzc2FnZScsIHsKICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdBbiBlcnJvciBvY2N1cnJlZCBjcmVhdGluZyB0aGUgYW5ub3RhdGlvbiBmb3Igam9iIHdpdGggSUQge2pvYklkfToge2Vycm9yfScsCiAgICAgICAgICAgIHZhbHVlczogewogICAgICAgICAgICAgIGpvYklkOiBhbm5vdGF0aW9uLmpvYl9pZCwKICAgICAgICAgICAgICBlcnJvcjogSlNPTi5zdHJpbmdpZnkocmVzcCkKICAgICAgICAgICAgfQogICAgICAgICAgfSkpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBfbm90aWZ5LnRvYXN0Tm90aWZpY2F0aW9ucy5hZGREYW5nZXIoX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1sLnRpbWVTZXJpZXNFeHBsb3Jlci50aW1lU2VyaWVzQ2hhcnQuZXJyb3JXaXRoVXBkYXRpbmdBbm5vdGF0aW9uTm90aWZpY2F0aW9uRXJyb3JNZXNzYWdlJywgewogICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0FuIGVycm9yIG9jY3VycmVkIHVwZGF0aW5nIHRoZSBhbm5vdGF0aW9uIGZvciBqb2Igd2l0aCBJRCB7am9iSWR9OiB7ZXJyb3J9JywKICAgICAgICAgICAgdmFsdWVzOiB7CiAgICAgICAgICAgICAgam9iSWQ6IGFubm90YXRpb24uam9iX2lkLAogICAgICAgICAgICAgIGVycm9yOiBKU09OLnN0cmluZ2lmeShyZXNwKQogICAgICAgICAgICB9CiAgICAgICAgICB9KSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0pOwoKICAgIHJldHVybiBfdGhpczsKICB9CgogIF9jcmVhdGVDbGFzcyhBbm5vdGF0aW9uRmx5b3V0SW50bCwgW3sKICAgIGtleTogInJlbmRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkgewogICAgICB2YXIgYW5ub3RhdGlvbiA9IHRoaXMucHJvcHMuYW5ub3RhdGlvbjsKICAgICAgdmFyIGlzRGVsZXRlTW9kYWxWaXNpYmxlID0gdGhpcy5zdGF0ZS5pc0RlbGV0ZU1vZGFsVmlzaWJsZTsKCiAgICAgIGlmIChhbm5vdGF0aW9uID09PSBudWxsKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIHZhciBpc0V4aXN0aW5nQW5ub3RhdGlvbiA9IHR5cGVvZiBhbm5vdGF0aW9uLl9pZCAhPT0gJ3VuZGVmaW5lZCc7IC8vIENoZWNrIHRoZSBsZW5ndGggb2YgdGhlIHRleHQgaXMgd2l0aGluIHRoZSBtYXggbGVuZ3RoIGxpbWl0LAogICAgICAvLyBhbmQgd2FybiBpZiB0aGUgbGVuZ3RoIGlzIGFwcHJvYWNoaW5nIHRoZSBsaW1pdC4KCiAgICAgIHZhciB2YWxpZGF0aW9uRXJyb3JzID0gdGhpcy52YWxpZGF0ZUFubm90YXRpb25UZXh0KCk7CiAgICAgIHZhciBpc0ludmFsaWQgPSB2YWxpZGF0aW9uRXJyb3JzLmxlbmd0aCA+IDA7CiAgICAgIHZhciBsZW5ndGhSYXRpb1RvU2hvd1dhcm5pbmcgPSAwLjk1OwogICAgICB2YXIgaGVscFRleHQgPSBudWxsOwoKICAgICAgaWYgKGlzSW52YWxpZCA9PT0gZmFsc2UgJiYgYW5ub3RhdGlvbi5hbm5vdGF0aW9uLmxlbmd0aCA+IF9hbm5vdGF0aW9ucy5BTk5PVEFUSU9OX01BWF9MRU5HVEhfQ0hBUlMgKiBsZW5ndGhSYXRpb1RvU2hvd1dhcm5pbmcpIHsKICAgICAgICBoZWxwVGV4dCA9IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tbC50aW1lU2VyaWVzRXhwbG9yZXIuYW5ub3RhdGlvbkZseW91dC5hcHByb2FjaGluZ01heExlbmd0aFdhcm5pbmcnLCB7CiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ3tjaGFyc1JlbWFpbmluZywgbnVtYmVyfSB7Y2hhcnNSZW1haW5pbmcsIHBsdXJhbCwgb25lIHtjaGFyYWN0ZXJ9IG90aGVyIHtjaGFyYWN0ZXJzfX0gcmVtYWluaW5nJywKICAgICAgICAgIHZhbHVlczogewogICAgICAgICAgICBjaGFyc1JlbWFpbmluZzogX2Fubm90YXRpb25zLkFOTk9UQVRJT05fTUFYX0xFTkdUSF9DSEFSUyAtIGFubm90YXRpb24uYW5ub3RhdGlvbi5sZW5ndGgKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQoKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LkZyYWdtZW50LCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmx5b3V0LCB7CiAgICAgICAgb25DbG9zZTogdGhpcy5jYW5jZWxFZGl0aW5nSGFuZGxlciwKICAgICAgICBzaXplOiAicyIsCiAgICAgICAgImFyaWEtbGFiZWxsZWRieSI6ICJBZGQgYW5ub3RhdGlvbiIKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZseW91dEhlYWRlciwgewogICAgICAgIGhhc0JvcmRlcjogdHJ1ZQogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVGl0bGUsIHsKICAgICAgICBzaXplOiAicyIKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgiaDIiLCB7CiAgICAgICAgaWQ6ICJtbEFubm90YXRpb25GbHlvdXRUaXRsZSIKICAgICAgfSwgaXNFeGlzdGluZ0Fubm90YXRpb24gPyBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAieHBhY2subWwudGltZVNlcmllc0V4cGxvcmVyLmFubm90YXRpb25GbHlvdXQuZWRpdEFubm90YXRpb25UaXRsZSIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJFZGl0IGFubm90YXRpb24iCiAgICAgIH0pIDogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogInhwYWNrLm1sLnRpbWVTZXJpZXNFeHBsb3Jlci5hbm5vdGF0aW9uRmx5b3V0LmFkZEFubm90YXRpb25UaXRsZSIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJBZGQgYW5ub3RhdGlvbiIKICAgICAgfSkpKSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbHlvdXRCb2R5LCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9hbm5vdGF0aW9uX2Rlc2NyaXB0aW9uX2xpc3QuQW5ub3RhdGlvbkRlc2NyaXB0aW9uTGlzdCwgewogICAgICAgIGFubm90YXRpb246IGFubm90YXRpb24KICAgICAgfSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTcGFjZXIsIHsKICAgICAgICBzaXplOiAibSIKICAgICAgfSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGb3JtUm93LCB7CiAgICAgICAgbGFiZWw6IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICBpZDogInhwYWNrLm1sLnRpbWVTZXJpZXNFeHBsb3Jlci5hbm5vdGF0aW9uRmx5b3V0LmFubm90YXRpb25UZXh0TGFiZWwiLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJBbm5vdGF0aW9uIHRleHQiCiAgICAgICAgfSksCiAgICAgICAgZnVsbFdpZHRoOiB0cnVlLAogICAgICAgIGhlbHBUZXh0OiBoZWxwVGV4dCwKICAgICAgICBpc0ludmFsaWQ6IGlzSW52YWxpZCwKICAgICAgICBlcnJvcjogdmFsaWRhdGlvbkVycm9ycwogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVGV4dEFyZWEsIHsKICAgICAgICBmdWxsV2lkdGg6IHRydWUsCiAgICAgICAgaXNJbnZhbGlkOiBpc0ludmFsaWQsCiAgICAgICAgb25DaGFuZ2U6IHRoaXMuYW5ub3RhdGlvblRleHRDaGFuZ2VIYW5kbGVyLAogICAgICAgIHBsYWNlaG9sZGVyOiAiLi4uIiwKICAgICAgICB2YWx1ZTogYW5ub3RhdGlvbi5hbm5vdGF0aW9uCiAgICAgIH0pKSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbHlvdXRGb290ZXIsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4R3JvdXAsIHsKICAgICAgICBqdXN0aWZ5Q29udGVudDogInNwYWNlQmV0d2VlbiIKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICAgICAgZ3JvdzogZmFsc2UKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUJ1dHRvbkVtcHR5LCB7CiAgICAgICAgaWNvblR5cGU6ICJjcm9zcyIsCiAgICAgICAgb25DbGljazogdGhpcy5jYW5jZWxFZGl0aW5nSGFuZGxlciwKICAgICAgICBmbHVzaDogImxlZnQiCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJ4cGFjay5tbC50aW1lU2VyaWVzRXhwbG9yZXIuYW5ub3RhdGlvbkZseW91dC5jYW5jZWxCdXR0b25MYWJlbCIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJDYW5jZWwiCiAgICAgIH0pKSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgICAgIGdyb3c6IGZhbHNlCiAgICAgIH0sIGlzRXhpc3RpbmdBbm5vdGF0aW9uICYmIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlCdXR0b25FbXB0eSwgewogICAgICAgIGNvbG9yOiAiZGFuZ2VyIiwKICAgICAgICBvbkNsaWNrOiB0aGlzLmRlbGV0ZUNvbmZpcm1IYW5kbGVyCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJ4cGFjay5tbC50aW1lU2VyaWVzRXhwbG9yZXIuYW5ub3RhdGlvbkZseW91dC5kZWxldGVCdXR0b25MYWJlbCIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJEZWxldGUiCiAgICAgIH0pKSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgICAgIGdyb3c6IGZhbHNlCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlCdXR0b24sIHsKICAgICAgICBmaWxsOiB0cnVlLAogICAgICAgIGlzRGlzYWJsZWQ6IGlzSW52YWxpZCA9PT0gdHJ1ZSwKICAgICAgICBvbkNsaWNrOiB0aGlzLnNhdmVPclVwZGF0ZUFubm90YXRpb24KICAgICAgfSwgaXNFeGlzdGluZ0Fubm90YXRpb24gPyBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAieHBhY2subWwudGltZVNlcmllc0V4cGxvcmVyLmFubm90YXRpb25GbHlvdXQudXBkYXRlQnV0dG9uTGFiZWwiLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiVXBkYXRlIgogICAgICB9KSA6IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJ4cGFjay5tbC50aW1lU2VyaWVzRXhwbG9yZXIuYW5ub3RhdGlvbkZseW91dC5jcmVhdGVCdXR0b25MYWJlbCIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJDcmVhdGUiCiAgICAgIH0pKSkpKSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2RlbGV0ZV9hbm5vdGF0aW9uX21vZGFsLkRlbGV0ZUFubm90YXRpb25Nb2RhbCwgewogICAgICAgIGNhbmNlbEFjdGlvbjogdGhpcy5jbG9zZURlbGV0ZU1vZGFsLAogICAgICAgIGRlbGV0ZUFjdGlvbjogdGhpcy5kZWxldGVIYW5kbGVyLAogICAgICAgIGlzVmlzaWJsZTogaXNEZWxldGVNb2RhbFZpc2libGUKICAgICAgfSkpOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIEFubm90YXRpb25GbHlvdXRJbnRsOwp9KF9yZWFjdC5Db21wb25lbnQpOwoKdmFyIEFubm90YXRpb25GbHlvdXQgPSBmdW5jdGlvbiBBbm5vdGF0aW9uRmx5b3V0KHByb3BzKSB7CiAgdmFyIGFubm90YXRpb25Qcm9wID0gKDAsIF91c2VPYnNlcnZhYmxlLmRlZmF1bHQpKF9hbm5vdGF0aW9uc19zZXJ2aWNlLmFubm90YXRpb24kKTsKCiAgaWYgKGFubm90YXRpb25Qcm9wID09PSB1bmRlZmluZWQpIHsKICAgIHJldHVybiBudWxsOwogIH0KCiAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoQW5ub3RhdGlvbkZseW91dEludGwsIF9leHRlbmRzKHsKICAgIGFubm90YXRpb246IGFubm90YXRpb25Qcm9wCiAgfSwgcHJvcHMpKTsKfTsKCmV4cG9ydHMuQW5ub3RhdGlvbkZseW91dCA9IEFubm90YXRpb25GbHlvdXQ7"},null]}