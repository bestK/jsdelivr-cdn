{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/siem/public/components/timeline/body/events/stateful_event.js","dependencies":[{"path":"x-pack/legacy/plugins/siem/public/components/timeline/body/events/stateful_event.js","mtime":1585205047695},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLlN0YXRlZnVsRXZlbnQgPSBleHBvcnRzLmdldE5ld05vdGVJZCA9IHZvaWQgMDsKCnZhciBfcmVhY3QgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKCJyZWFjdCIpKTsKCnZhciBfdXVpZCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgidXVpZCIpKTsKCnZhciBfcmVhY3RWaXNpYmlsaXR5U2Vuc29yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJyZWFjdC12aXNpYmlsaXR5LXNlbnNvciIpKTsKCnZhciBfZGV0YWlscyA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL2NvbnRhaW5lcnMvdGltZWxpbmUvZGV0YWlscyIpOwoKdmFyIF9zY2hlZHVsZXIgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9saWIvaGVscGVycy9zY2hlZHVsZXIiKTsKCnZhciBfc2tlbGV0b25fcm93ID0gcmVxdWlyZSgiLi4vLi4vLi4vc2tlbGV0b25fcm93Iik7Cgp2YXIgX2V4cGFuZGFibGVfZXZlbnQgPSByZXF1aXJlKCIuLi8uLi9leHBhbmRhYmxlX2V2ZW50Iik7Cgp2YXIgX2hlbHBlcnMgPSByZXF1aXJlKCIuLi8uLi9oZWxwZXJzIik7Cgp2YXIgX3N0eWxlcyA9IHJlcXVpcmUoIi4uLy4uL3N0eWxlcyIpOwoKdmFyIF90aW1lbGluZV9jb250ZXh0ID0gcmVxdWlyZSgiLi4vLi4vdGltZWxpbmVfY29udGV4dCIpOwoKdmFyIF9nZXRfcm93X3JlbmRlcmVyID0gcmVxdWlyZSgiLi4vcmVuZGVyZXJzL2dldF9yb3dfcmVuZGVyZXIiKTsKCnZhciBfaGVscGVyczIgPSByZXF1aXJlKCIuLi9oZWxwZXJzIik7Cgp2YXIgX3N0YXRlZnVsX2V2ZW50X2NoaWxkID0gcmVxdWlyZSgiLi9zdGF0ZWZ1bF9ldmVudF9jaGlsZCIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsKICByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogewogICAgZGVmYXVsdDogb2JqCiAgfTsKfQoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7CiAgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgewogICAgcmV0dXJuIG9iajsKICB9IGVsc2UgewogICAgdmFyIG5ld09iaiA9IHt9OwoKICAgIGlmIChvYmogIT0gbnVsbCkgewogICAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7CiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHsKICAgICAgICAgIHZhciBkZXNjID0gT2JqZWN0LmRlZmluZVByb3BlcnR5ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KSA6IHt9OwoKICAgICAgICAgIGlmIChkZXNjLmdldCB8fCBkZXNjLnNldCkgewogICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobmV3T2JqLCBrZXksIGRlc2MpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBuZXdPYmouZGVmYXVsdCA9IG9iajsKICAgIHJldHVybiBuZXdPYmo7CiAgfQp9CgpmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsKICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7CgogIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7CiAgICB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsKICAgIGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsKICAgICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7CiAgICB9KTsKICAgIGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsKICB9CgogIHJldHVybiBrZXlzOwp9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgewogIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsKCiAgICBpZiAoaSAlIDIpIHsKICAgICAgb3duS2V5cyhzb3VyY2UsIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOwogICAgICB9KTsKICAgIH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsKICAgIH0gZWxzZSB7CiAgICAgIG93bktleXMoc291cmNlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsKICAgICAgfSk7CiAgICB9CiAgfQoKICByZXR1cm4gdGFyZ2V0Owp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7CiAgaWYgKGtleSBpbiBvYmopIHsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgICB2YWx1ZTogdmFsdWUsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgd3JpdGFibGU6IHRydWUKICAgIH0pOwogIH0gZWxzZSB7CiAgICBvYmpba2V5XSA9IHZhbHVlOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7CiAgcmV0dXJuIF9hcnJheVdpdGhIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHx8IF9ub25JdGVyYWJsZVJlc3QoKTsKfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlUmVzdCgpIHsKICB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7Cn0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHsKICB2YXIgX2FyciA9IFtdOwogIHZhciBfbiA9IHRydWU7CiAgdmFyIF9kID0gZmFsc2U7CiAgdmFyIF9lID0gdW5kZWZpbmVkOwoKICB0cnkgewogICAgZm9yICh2YXIgX2kgPSBhcnJbU3ltYm9sLml0ZXJhdG9yXSgpLCBfczsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSkgewogICAgICBfYXJyLnB1c2goX3MudmFsdWUpOwoKICAgICAgaWYgKGkgJiYgX2Fyci5sZW5ndGggPT09IGkpIGJyZWFrOwogICAgfQogIH0gY2F0Y2ggKGVycikgewogICAgX2QgPSB0cnVlOwogICAgX2UgPSBlcnI7CiAgfSBmaW5hbGx5IHsKICAgIHRyeSB7CiAgICAgIGlmICghX24gJiYgX2lbInJldHVybiJdICE9IG51bGwpIF9pWyJyZXR1cm4iXSgpOwogICAgfSBmaW5hbGx5IHsKICAgICAgaWYgKF9kKSB0aHJvdyBfZTsKICAgIH0KICB9CgogIHJldHVybiBfYXJyOwp9CgpmdW5jdGlvbiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsKfQoKdmFyIGdldE5ld05vdGVJZCA9IGZ1bmN0aW9uIGdldE5ld05vdGVJZCgpIHsKICByZXR1cm4gX3V1aWQuZGVmYXVsdC52NCgpOwp9OwoKZXhwb3J0cy5nZXROZXdOb3RlSWQgPSBnZXROZXdOb3RlSWQ7CnZhciBlbXB0eURldGFpbHMgPSBbXTsKLyoqCiAqIFRoaXMgaXMgdGhlIGRlZmF1bHQgcm93IGhlaWdodCB3aGVuZXZlciBpdCBpcyBhIHBsYWluIHJvdyByZW5kZXJlciBhbmQgbm90IGEgY3VzdG9tIHJvdyBoZWlnaHQuCiAqIFdlIHVzZSB0aGlzIHZhbHVlIHdoZW4gd2UgZG8gbm90IGtub3cgdGhlIGhlaWdodCBvZiBhIHBhcnRpY3VsYXIgcm93LgogKi8KCnZhciBERUZBVUxUX1JPV19IRUlHSFQgPSAnMzJweCc7Ci8qKgogKiBUaGlzIGlzIHRoZSB0b3Agb2Zmc2V0IGluIHBpeGVscyBvZiB0aGUgdG9wIHBhcnQgb2YgdGhlIHRpbWVsaW5lLiBUaGUgVUkgYXJlYSB3aGVyZSB5b3UgZG8geW91cgogKiBkcmFnIGFuZCBkcm9wIGFuZCBmaWx0ZXJpbmcuICBJdCBpcyBhIHBvc2l0aXZlIG51bWJlciBpbiBwaXhlbHMgb2YgX1BBUlRfIG9mIHRoZSBoZWFkZXIgYnV0IG5vdAogKiB0aGUgZW50aXJlIGhlYWRlci4gV2UgbGVhdmUgcm9vbSBmb3Igc29tZSByb3dzIHRvIHJlbmRlciBiZWhpbmQgdGhlIGRyYWcgYW5kIGRyb3Agc28gdGhleSBtaWdodCBiZQogKiB2aXNpYmxlIGJ5IHRoZSB0aW1lIHRoZSB1c2VyIHNjcm9sbHMgdXB3YXJkcy4gQWxsIG90aGVyIERPTSBlbGVtZW50cyBhcmUgcmVwbGFjZWQgd2l0aCB0aGVpciAiYmxhbmsiCiAqIHJvd3MuCiAqLwoKdmFyIFRPUF9PRkZTRVQgPSA1MDsKLyoqCiAqIFRoaXMgaXMgdGhlIGJvdHRvbSBvZmZzZXQgaW4gcGl4ZWxzIG9mIHRoZSBib3R0b20gcGFydCBvZiB0aGUgdGltZWxpbmUuIFRoZSBVSSBhcmVhIHJpZ2h0IGJlbG93IHRoZQogKiB0aW1lbGluZSB3aGljaCBpcyB0aGUgZm9vdGVyLiAgU2luY2UgdGhlIGZvb3RlciBpcyBzbyBpbmNyZWRpYmx5IHNtYWxsIHdlIGRvbid0IGhhdmUgZW5vdWdoIHJvb20gdG8KICogcmVuZGVyIGFyb3VuZCA1IHJvd3MgYmVsb3cgdGhlIHRpbWVsaW5lIHRvIGdldCB0aGUgdXNlciB0aGUgYmVzdCBjaGFuY2Ugb2YgYWx3YXlzIHNjcm9sbGluZyB3aXRob3V0IHNlZWluZwogKiAiYmxhbmsgcm93cyIuIFRoZSBuZWdhdGl2ZSBudW1iZXIgaXMgdG8gZ2l2ZSB0aGUgYm90dG9tIG9mIHRoZSBicm93c2VyIHdpbmRvdyBhIGJpdCBvZiBpbnZpc2libGUgc3BhY2UgdG8KICoga2VlcCBhcm91bmQgNSByb3dzIHJlbmRlcmluZyBiZWxvdyBpdC4gQWxsIG90aGVyIERPTSBlbGVtZW50cyBhcmUgcmVwbGFjZWQgd2l0aCB0aGVpciAiYmxhbmsiCiAqIHJvd3MuCiAqLwoKdmFyIEJPVFRPTV9PRkZTRVQgPSAtNTAwOwoKdmFyIEF0dHJpYnV0ZXNDb21wb25lbnQgPSBmdW5jdGlvbiBBdHRyaWJ1dGVzQ29tcG9uZW50KF9yZWYpIHsKICB2YXIgY2hpbGRyZW4gPSBfcmVmLmNoaWxkcmVuOwogIHZhciB3aWR0aCA9ICgwLCBfdGltZWxpbmVfY29udGV4dC51c2VUaW1lbGluZVdpZHRoQ29udGV4dCkoKTsgLy8gUGFzc2luZyB0aGUgc3R5bGVzIGRpcmVjdGx5IHRvIHRoZSBjb21wb25lbnQgYmVjYXVzZSB0aGUgd2lkdGggaXMKICAvLyBiZWluZyBjYWxjdWxhdGVkIGFuZCBpcyByZWNvbW1lbmRlZCBieSBTdHlsZWQgQ29tcG9uZW50cyBmb3IgcGVyZm9ybWFuY2UKICAvLyBodHRwczovL2dpdGh1Yi5jb20vc3R5bGVkLWNvbXBvbmVudHMvc3R5bGVkLWNvbXBvbmVudHMvaXNzdWVzLzEzNCNpc3N1ZWNvbW1lbnQtMzEyNDE1MjkxCgogIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9zdHlsZXMuRXZlbnRzVHJTdXBwbGVtZW50LCB7CiAgICBjbGFzc05hbWU6ICJzaWVtRXZlbnRzVGFibGVfX3RyU3VwcGxlbWVudC0tYXR0cmlidXRlcyIsCiAgICAiZGF0YS10ZXN0LXN1YmoiOiAiZXZlbnQtZGV0YWlscyIsCiAgICBzdHlsZTogewogICAgICB3aWR0aDogIiIuY29uY2F0KHdpZHRoIC0gX3N0eWxlcy5PRkZTRVRfU0NST0xMQkFSLCAicHgiKQogICAgfQogIH0sIGNoaWxkcmVuKTsKfTsKCnZhciBBdHRyaWJ1dGVzID0gX3JlYWN0LmRlZmF1bHQubWVtbyhBdHRyaWJ1dGVzQ29tcG9uZW50KTsKCnZhciBTdGF0ZWZ1bEV2ZW50Q29tcG9uZW50ID0gZnVuY3Rpb24gU3RhdGVmdWxFdmVudENvbXBvbmVudChfcmVmMikgewogIHZhciBhY3Rpb25zQ29sdW1uV2lkdGggPSBfcmVmMi5hY3Rpb25zQ29sdW1uV2lkdGgsCiAgICAgIGFkZE5vdGVUb0V2ZW50ID0gX3JlZjIuYWRkTm90ZVRvRXZlbnQsCiAgICAgIGJyb3dzZXJGaWVsZHMgPSBfcmVmMi5icm93c2VyRmllbGRzLAogICAgICBjb250YWluZXJFbGVtZW50UmVmID0gX3JlZjIuY29udGFpbmVyRWxlbWVudFJlZiwKICAgICAgY29sdW1uSGVhZGVycyA9IF9yZWYyLmNvbHVtbkhlYWRlcnMsCiAgICAgIGNvbHVtblJlbmRlcmVycyA9IF9yZWYyLmNvbHVtblJlbmRlcmVycywKICAgICAgZXZlbnQgPSBfcmVmMi5ldmVudCwKICAgICAgZXZlbnRJZFRvTm90ZUlkcyA9IF9yZWYyLmV2ZW50SWRUb05vdGVJZHMsCiAgICAgIGdldE5vdGVzQnlJZHMgPSBfcmVmMi5nZXROb3Rlc0J5SWRzLAogICAgICBfcmVmMiRpc0V2ZW50Vmlld2VyID0gX3JlZjIuaXNFdmVudFZpZXdlciwKICAgICAgaXNFdmVudFZpZXdlciA9IF9yZWYyJGlzRXZlbnRWaWV3ZXIgPT09IHZvaWQgMCA/IGZhbHNlIDogX3JlZjIkaXNFdmVudFZpZXdlciwKICAgICAgX3JlZjIkaXNFdmVudFBpbm5lZCA9IF9yZWYyLmlzRXZlbnRQaW5uZWQsCiAgICAgIGlzRXZlbnRQaW5uZWQgPSBfcmVmMiRpc0V2ZW50UGlubmVkID09PSB2b2lkIDAgPyBmYWxzZSA6IF9yZWYyJGlzRXZlbnRQaW5uZWQsCiAgICAgIGxvYWRpbmdFdmVudElkcyA9IF9yZWYyLmxvYWRpbmdFdmVudElkcywKICAgICAgX3JlZjIkbWF4RGVsYXkgPSBfcmVmMi5tYXhEZWxheSwKICAgICAgbWF4RGVsYXkgPSBfcmVmMiRtYXhEZWxheSA9PT0gdm9pZCAwID8gMCA6IF9yZWYyJG1heERlbGF5LAogICAgICBvbkNvbHVtblJlc2l6ZWQgPSBfcmVmMi5vbkNvbHVtblJlc2l6ZWQsCiAgICAgIG9uUGluRXZlbnQgPSBfcmVmMi5vblBpbkV2ZW50LAogICAgICBvblJvd1NlbGVjdGVkID0gX3JlZjIub25Sb3dTZWxlY3RlZCwKICAgICAgb25VblBpbkV2ZW50ID0gX3JlZjIub25VblBpbkV2ZW50LAogICAgICBvblVwZGF0ZUNvbHVtbnMgPSBfcmVmMi5vblVwZGF0ZUNvbHVtbnMsCiAgICAgIHJvd1JlbmRlcmVycyA9IF9yZWYyLnJvd1JlbmRlcmVycywKICAgICAgc2VsZWN0ZWRFdmVudElkcyA9IF9yZWYyLnNlbGVjdGVkRXZlbnRJZHMsCiAgICAgIHNob3dDaGVja2JveGVzID0gX3JlZjIuc2hvd0NoZWNrYm94ZXMsCiAgICAgIHRpbWVsaW5lSWQgPSBfcmVmMi50aW1lbGluZUlkLAogICAgICB0b2dnbGVDb2x1bW4gPSBfcmVmMi50b2dnbGVDb2x1bW4sCiAgICAgIHVwZGF0ZU5vdGUgPSBfcmVmMi51cGRhdGVOb3RlOwoKICB2YXIgX3VzZVN0YXRlID0gKDAsIF9yZWFjdC51c2VTdGF0ZSkoe30pLAogICAgICBfdXNlU3RhdGUyID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlLCAyKSwKICAgICAgZXhwYW5kZWQgPSBfdXNlU3RhdGUyWzBdLAogICAgICBzZXRFeHBhbmRlZCA9IF91c2VTdGF0ZTJbMV07CgogIHZhciBfdXNlU3RhdGUzID0gKDAsIF9yZWFjdC51c2VTdGF0ZSkoZmFsc2UpLAogICAgICBfdXNlU3RhdGU0ID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlMywgMiksCiAgICAgIGluaXRpYWxSZW5kZXIgPSBfdXNlU3RhdGU0WzBdLAogICAgICBzZXRJbml0aWFsUmVuZGVyID0gX3VzZVN0YXRlNFsxXTsKCiAgdmFyIF91c2VTdGF0ZTUgPSAoMCwgX3JlYWN0LnVzZVN0YXRlKSh7fSksCiAgICAgIF91c2VTdGF0ZTYgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGU1LCAyKSwKICAgICAgc2hvd05vdGVzID0gX3VzZVN0YXRlNlswXSwKICAgICAgc2V0U2hvd05vdGVzID0gX3VzZVN0YXRlNlsxXTsKCiAgdmFyIGRpdkVsZW1lbnQgPSAoMCwgX3JlYWN0LnVzZVJlZikobnVsbCk7CiAgdmFyIG9uVG9nZ2xlU2hvd05vdGVzID0gKDAsIF9yZWFjdC51c2VDYWxsYmFjaykoZnVuY3Rpb24gKCkgewogICAgdmFyIGV2ZW50SWQgPSBldmVudC5faWQ7CiAgICBzZXRTaG93Tm90ZXMoX29iamVjdFNwcmVhZCh7fSwgc2hvd05vdGVzLCBfZGVmaW5lUHJvcGVydHkoe30sIGV2ZW50SWQsICFzaG93Tm90ZXNbZXZlbnRJZF0pKSk7CiAgfSwgW2V2ZW50LCBzaG93Tm90ZXNdKTsKICB2YXIgb25Ub2dnbGVFeHBhbmRlZCA9ICgwLCBfcmVhY3QudXNlQ2FsbGJhY2spKGZ1bmN0aW9uICgpIHsKICAgIHZhciBldmVudElkID0gZXZlbnQuX2lkOwogICAgc2V0RXhwYW5kZWQoX29iamVjdFNwcmVhZCh7fSwgZXhwYW5kZWQsIF9kZWZpbmVQcm9wZXJ0eSh7fSwgZXZlbnRJZCwgIWV4cGFuZGVkW2V2ZW50SWRdKSkpOwogIH0sIFtldmVudCwgZXhwYW5kZWRdKTsKICB2YXIgYXNzb2NpYXRlTm90ZSA9ICgwLCBfcmVhY3QudXNlQ2FsbGJhY2spKGZ1bmN0aW9uIChub3RlSWQpIHsKICAgIGFkZE5vdGVUb0V2ZW50KHsKICAgICAgZXZlbnRJZDogZXZlbnQuX2lkLAogICAgICBub3RlSWQ6IG5vdGVJZAogICAgfSk7CgogICAgaWYgKCFpc0V2ZW50UGlubmVkKSB7CiAgICAgIG9uUGluRXZlbnQoZXZlbnQuX2lkKTsgLy8gcGluIHRoZSBldmVudCwgYmVjYXVzZSBpdCBoYXMgbm90ZXMKICAgIH0KICB9LCBbYWRkTm90ZVRvRXZlbnQsIGV2ZW50LCBpc0V2ZW50UGlubmVkLCBvblBpbkV2ZW50XSk7CiAgLyoqCiAgICogSW5jcmVtZW50YWxseSBsb2FkcyB0aGUgZXZlbnRzIHdoZW4gaXQgbW91bnRzIGJ5IHRyeWluZyB0bwogICAqIHNlZSBpZiBpdCByZXNpZGVzIHdpdGhpbiBhIHdpbmRvdyBmcmFtZSBhbmQgaWYgaXQgaXMgaXQgd2lsbAogICAqIGluZGljYXRlIHRvIFJlYWN0IHRoYXQgaXQgc2hvdWxkIHJlbmRlciBpdHMgc2VsZiBieSBzZXR0aW5nCiAgICogaXRzIGluaXRpYWxSZW5kZXIgdG8gdHJ1ZS4KICAgKi8KCiAgKDAsIF9yZWFjdC51c2VFZmZlY3QpKGZ1bmN0aW9uICgpIHsKICAgIHZhciBfaXNNb3VudGVkID0gdHJ1ZTsKICAgICgwLCBfc2NoZWR1bGVyLnJlcXVlc3RJZGxlQ2FsbGJhY2tWaWFTY2hlZHVsZXIpKGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKCFpbml0aWFsUmVuZGVyICYmIF9pc01vdW50ZWQpIHsKICAgICAgICBzZXRJbml0aWFsUmVuZGVyKHRydWUpOwogICAgICB9CiAgICB9LCB7CiAgICAgIHRpbWVvdXQ6IG1heERlbGF5CiAgICB9KTsKICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgIF9pc01vdW50ZWQgPSBmYWxzZTsKICAgIH07CiAgfSwgW10pOyAvLyBOdW1iZXIgb2YgY3VycmVudCBjb2x1bW5zIHBsdXMgb25lIGZvciBhY3Rpb25zLgoKICB2YXIgY29sdW1uQ291bnQgPSBjb2x1bW5IZWFkZXJzLmxlbmd0aCArIDE7IC8vIElmIHdlIGFyZSBub3QgcmVhZHkgdG8gcmVuZGVyIHlldCwganVzdCByZXR1cm4gbnVsbAogIC8vIHNlZSB1c2VFZmZlY3QoKSBmb3Igd2hlbiBpdCBzY2hlZHVsZXMgdGhlIGZpcnN0CiAgLy8gdGltZSB0aGlzIHN0YXRlZnVsIGNvbXBvbmVudCBzaG91bGQgYmUgcmVuZGVyZWQuCgogIGlmICghaW5pdGlhbFJlbmRlcikgewogICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3NrZWxldG9uX3Jvdy5Ta2VsZXRvblJvdywgewogICAgICBjZWxsQ291bnQ6IGNvbHVtbkNvdW50CiAgICB9KTsKICB9CgogIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdFZpc2liaWxpdHlTZW5zb3IuZGVmYXVsdCwgewogICAgcGFydGlhbFZpc2liaWxpdHk6IHRydWUsCiAgICBzY3JvbGxDaGVjazogdHJ1ZSwKICAgIGNvbnRhaW5tZW50OiBjb250YWluZXJFbGVtZW50UmVmLAogICAgb2Zmc2V0OiB7CiAgICAgIHRvcDogVE9QX09GRlNFVCwKICAgICAgYm90dG9tOiBCT1RUT01fT0ZGU0VUCiAgICB9CiAgfSwgZnVuY3Rpb24gKF9yZWYzKSB7CiAgICB2YXIgaXNWaXNpYmxlID0gX3JlZjMuaXNWaXNpYmxlOwoKICAgIGlmIChpc1Zpc2libGUpIHsKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2RldGFpbHMuVGltZWxpbmVEZXRhaWxzUXVlcnksIHsKICAgICAgICBzb3VyY2VJZDogImRlZmF1bHQiLAogICAgICAgIGluZGV4TmFtZTogZXZlbnQuX2luZGV4LAogICAgICAgIGV2ZW50SWQ6IGV2ZW50Ll9pZCwKICAgICAgICBleGVjdXRlUXVlcnk6ICEhZXhwYW5kZWRbZXZlbnQuX2lkXQogICAgICB9LCBmdW5jdGlvbiAoX3JlZjQpIHsKICAgICAgICB2YXIgZGV0YWlsc0RhdGEgPSBfcmVmNC5kZXRhaWxzRGF0YSwKICAgICAgICAgICAgbG9hZGluZyA9IF9yZWY0LmxvYWRpbmc7CiAgICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3N0eWxlcy5FdmVudHNUckdyb3VwLCB7CiAgICAgICAgICBjbGFzc05hbWU6IF9oZWxwZXJzLlNUQVRFRlVMX0VWRU5UX0NTU19DTEFTU19OQU1FLAogICAgICAgICAgImRhdGEtdGVzdC1zdWJqIjogImV2ZW50IiwKICAgICAgICAgIGV2ZW50VHlwZTogKDAsIF9oZWxwZXJzMi5nZXRFdmVudFR5cGUpKGV2ZW50LmVjcyksCiAgICAgICAgICBzaG93TGVmdEJvcmRlcjogIWlzRXZlbnRWaWV3ZXIsCiAgICAgICAgICByZWY6IGZ1bmN0aW9uIHJlZihjKSB7CiAgICAgICAgICAgIGlmIChjICE9IG51bGwpIHsKICAgICAgICAgICAgICBkaXZFbGVtZW50LmN1cnJlbnQgPSBjOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgKDAsIF9nZXRfcm93X3JlbmRlcmVyLmdldFJvd1JlbmRlcmVyKShldmVudC5lY3MsIHJvd1JlbmRlcmVycykucmVuZGVyUm93KHsKICAgICAgICAgIGJyb3dzZXJGaWVsZHM6IGJyb3dzZXJGaWVsZHMsCiAgICAgICAgICBkYXRhOiBldmVudC5lY3MsCiAgICAgICAgICBjaGlsZHJlbjogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfc3RhdGVmdWxfZXZlbnRfY2hpbGQuU3RhdGVmdWxFdmVudENoaWxkLCB7CiAgICAgICAgICAgIGFjdGlvbnNDb2x1bW5XaWR0aDogYWN0aW9uc0NvbHVtbldpZHRoLAogICAgICAgICAgICBhZGROb3RlVG9FdmVudDogYWRkTm90ZVRvRXZlbnQsCiAgICAgICAgICAgIGFzc29jaWF0ZU5vdGU6IGFzc29jaWF0ZU5vdGUsCiAgICAgICAgICAgIGNvbHVtbkhlYWRlcnM6IGNvbHVtbkhlYWRlcnMsCiAgICAgICAgICAgIGNvbHVtblJlbmRlcmVyczogY29sdW1uUmVuZGVyZXJzLAogICAgICAgICAgICBkYXRhOiBldmVudC5kYXRhLAogICAgICAgICAgICBlY3NEYXRhOiBldmVudC5lY3MsCiAgICAgICAgICAgIGV2ZW50SWRUb05vdGVJZHM6IGV2ZW50SWRUb05vdGVJZHMsCiAgICAgICAgICAgIGV4cGFuZGVkOiAhIWV4cGFuZGVkW2V2ZW50Ll9pZF0sCiAgICAgICAgICAgIGdldE5vdGVzQnlJZHM6IGdldE5vdGVzQnlJZHMsCiAgICAgICAgICAgIGlkOiBldmVudC5faWQsCiAgICAgICAgICAgIGlzRXZlbnRQaW5uZWQ6IGlzRXZlbnRQaW5uZWQsCiAgICAgICAgICAgIGlzRXZlbnRWaWV3ZXI6IGlzRXZlbnRWaWV3ZXIsCiAgICAgICAgICAgIGxvYWRpbmc6IGxvYWRpbmcsCiAgICAgICAgICAgIGxvYWRpbmdFdmVudElkczogbG9hZGluZ0V2ZW50SWRzLAogICAgICAgICAgICBvbkNvbHVtblJlc2l6ZWQ6IG9uQ29sdW1uUmVzaXplZCwKICAgICAgICAgICAgb25QaW5FdmVudDogb25QaW5FdmVudCwKICAgICAgICAgICAgb25Sb3dTZWxlY3RlZDogb25Sb3dTZWxlY3RlZCwKICAgICAgICAgICAgb25Ub2dnbGVFeHBhbmRlZDogb25Ub2dnbGVFeHBhbmRlZCwKICAgICAgICAgICAgb25Ub2dnbGVTaG93Tm90ZXM6IG9uVG9nZ2xlU2hvd05vdGVzLAogICAgICAgICAgICBvblVuUGluRXZlbnQ6IG9uVW5QaW5FdmVudCwKICAgICAgICAgICAgc2VsZWN0ZWRFdmVudElkczogc2VsZWN0ZWRFdmVudElkcywKICAgICAgICAgICAgc2hvd0NoZWNrYm94ZXM6IHNob3dDaGVja2JveGVzLAogICAgICAgICAgICBzaG93Tm90ZXM6ICEhc2hvd05vdGVzW2V2ZW50Ll9pZF0sCiAgICAgICAgICAgIHRpbWVsaW5lSWQ6IHRpbWVsaW5lSWQsCiAgICAgICAgICAgIHVwZGF0ZU5vdGU6IHVwZGF0ZU5vdGUKICAgICAgICAgIH0pLAogICAgICAgICAgdGltZWxpbmVJZDogdGltZWxpbmVJZAogICAgICAgIH0pLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KEF0dHJpYnV0ZXMsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V4cGFuZGFibGVfZXZlbnQuRXhwYW5kYWJsZUV2ZW50LCB7CiAgICAgICAgICBicm93c2VyRmllbGRzOiBicm93c2VyRmllbGRzLAogICAgICAgICAgY29sdW1uSGVhZGVyczogY29sdW1uSGVhZGVycywKICAgICAgICAgIGV2ZW50OiBkZXRhaWxzRGF0YSB8fCBlbXB0eURldGFpbHMsCiAgICAgICAgICBmb3JjZUV4cGFuZDogISFleHBhbmRlZFtldmVudC5faWRdICYmICFsb2FkaW5nLAogICAgICAgICAgaWQ6IGV2ZW50Ll9pZCwKICAgICAgICAgIG9uVXBkYXRlQ29sdW1uczogb25VcGRhdGVDb2x1bW5zLAogICAgICAgICAgdGltZWxpbmVJZDogdGltZWxpbmVJZCwKICAgICAgICAgIHRvZ2dsZUNvbHVtbjogdG9nZ2xlQ29sdW1uCiAgICAgICAgfSkpKTsKICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICAvLyBIZWlnaHQgcGxhY2UgaG9sZGVyIGZvciB2aXNpYmlsaXR5IGRldGVjdGlvbiBhcyB3ZWxsIGFzIHJlLXJlbmRlcmluZyBzZWN0aW9ucy4KICAgICAgdmFyIGhlaWdodCA9IGRpdkVsZW1lbnQuY3VycmVudCAhPSBudWxsICYmIGRpdkVsZW1lbnQuY3VycmVudC5jbGllbnRIZWlnaHQgPyAiIi5jb25jYXQoZGl2RWxlbWVudC5jdXJyZW50LmNsaWVudEhlaWdodCwgInB4IikgOiBERUZBVUxUX1JPV19IRUlHSFQ7IC8vIGhlaWdodCBpcyBiZWluZyBpbmxpbmVkIGRpcmVjdGx5IGluIGhlcmUgYmVjYXVzZSBvZiBwZXJmb3JtYW5jZSB3aXRoIFN0eWxlZENvbXBvbmVudHMKICAgICAgLy8gaW52b2x2aW5nIHF1aWNrIGFuZCBjb25zdGFudCBjaGFuZ2VzIHRvIHRoZSBET00uCiAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9zdHlsZWQtY29tcG9uZW50cy9zdHlsZWQtY29tcG9uZW50cy9pc3N1ZXMvMTM0I2lzc3VlY29tbWVudC0zMTI0MTUyOTEKCiAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9za2VsZXRvbl9yb3cuU2tlbGV0b25Sb3csIHsKICAgICAgICBjZWxsQ291bnQ6IGNvbHVtbkNvdW50LAogICAgICAgIHN0eWxlOiB7CiAgICAgICAgICBoZWlnaHQ6IGhlaWdodAogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfSk7Cn07Cgp2YXIgU3RhdGVmdWxFdmVudCA9IF9yZWFjdC5kZWZhdWx0Lm1lbW8oU3RhdGVmdWxFdmVudENvbXBvbmVudCk7CgpleHBvcnRzLlN0YXRlZnVsRXZlbnQgPSBTdGF0ZWZ1bEV2ZW50Ow=="},null]}