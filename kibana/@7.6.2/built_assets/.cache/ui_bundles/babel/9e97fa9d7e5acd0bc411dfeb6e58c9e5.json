{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/legacy/core_plugins/kbn_vislib_vis_types/public/components/options/metrics_axes/index.js","dependencies":[{"path":"src/legacy/core_plugins/kbn_vislib_vis_types/public/components/options/metrics_axes/index.js","mtime":1585205039380},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLk1ldHJpY3NBeGlzT3B0aW9ucyA9IE1ldHJpY3NBeGlzT3B0aW9uczsKCnZhciBfcmVhY3QgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKCJyZWFjdCIpKTsKCnZhciBfbG9kYXNoID0gcmVxdWlyZSgibG9kYXNoIik7Cgp2YXIgX2V1aSA9IHJlcXVpcmUoIkBlbGFzdGljL2V1aSIpOwoKdmFyIF9zZXJpZXNfcGFuZWwgPSByZXF1aXJlKCIuL3Nlcmllc19wYW5lbCIpOwoKdmFyIF9jYXRlZ29yeV9heGlzX3BhbmVsID0gcmVxdWlyZSgiLi9jYXRlZ29yeV9heGlzX3BhbmVsIik7Cgp2YXIgX3ZhbHVlX2F4ZXNfcGFuZWwgPSByZXF1aXJlKCIuL3ZhbHVlX2F4ZXNfcGFuZWwiKTsKCnZhciBfdXRpbHMgPSByZXF1aXJlKCIuL3V0aWxzIik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsKICBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7CiAgICByZXR1cm4gb2JqOwogIH0gZWxzZSB7CiAgICB2YXIgbmV3T2JqID0ge307CgogICAgaWYgKG9iaiAhPSBudWxsKSB7CiAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHsKICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgewogICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvciA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpIDoge307CgogICAgICAgICAgaWYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSB7CiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmosIGtleSwgZGVzYyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBuZXdPYmpba2V5XSA9IG9ialtrZXldOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIG5ld09iai5kZWZhdWx0ID0gb2JqOwogICAgcmV0dXJuIG5ld09iajsKICB9Cn0KCmZ1bmN0aW9uIF9leHRlbmRzKCkgewogIF9leHRlbmRzID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiAodGFyZ2V0KSB7CiAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgewogICAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldOwoKICAgICAgZm9yICh2YXIga2V5IGluIHNvdXJjZSkgewogICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoc291cmNlLCBrZXkpKSB7CiAgICAgICAgICB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHJldHVybiB0YXJnZXQ7CiAgfTsKCiAgcmV0dXJuIF9leHRlbmRzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn0KCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgewogIHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsKCiAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsKICAgIHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOwogICAgaWYgKGVudW1lcmFibGVPbmx5KSBzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgewogICAgICByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsKICAgIH0pOwogICAga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOwogIH0KCiAgcmV0dXJuIGtleXM7Cn0KCmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7CiAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsKICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OwoKICAgIGlmIChpICUgMikgewogICAgICBvd25LZXlzKHNvdXJjZSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7CiAgICAgIH0pOwogICAgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgewogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpOwogICAgfSBlbHNlIHsKICAgICAgb3duS2V5cyhzb3VyY2UpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOwogICAgICB9KTsKICAgIH0KICB9CgogIHJldHVybiB0YXJnZXQ7Cn0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsKICBpZiAoa2V5IGluIG9iaikgewogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7CiAgICAgIHZhbHVlOiB2YWx1ZSwKICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICB3cml0YWJsZTogdHJ1ZQogICAgfSk7CiAgfSBlbHNlIHsKICAgIG9ialtrZXldID0gdmFsdWU7CiAgfQoKICByZXR1cm4gb2JqOwp9CgpmdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7CiAgcmV0dXJuIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfbm9uSXRlcmFibGVTcHJlYWQoKTsKfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlU3ByZWFkKCkgewogIHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7Cn0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXkoaXRlcikgewogIGlmIChTeW1ib2wuaXRlcmF0b3IgaW4gT2JqZWN0KGl0ZXIpIHx8IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChpdGVyKSA9PT0gIltvYmplY3QgQXJndW1lbnRzXSIpIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpOwp9CgpmdW5jdGlvbiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgewogICAgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkoYXJyLmxlbmd0aCk7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHsKICAgICAgYXJyMltpXSA9IGFycltpXTsKICAgIH0KCiAgICByZXR1cm4gYXJyMjsKICB9Cn0KCmZ1bmN0aW9uIF9zbGljZWRUb0FycmF5KGFyciwgaSkgewogIHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB8fCBfbm9uSXRlcmFibGVSZXN0KCk7Cn0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVJlc3QoKSB7CiAgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIGRlc3RydWN0dXJlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZSIpOwp9CgpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB7CiAgdmFyIF9hcnIgPSBbXTsKICB2YXIgX24gPSB0cnVlOwogIHZhciBfZCA9IGZhbHNlOwogIHZhciBfZSA9IHVuZGVmaW5lZDsKCiAgdHJ5IHsKICAgIGZvciAodmFyIF9pID0gYXJyW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3M7ICEoX24gPSAoX3MgPSBfaS5uZXh0KCkpLmRvbmUpOyBfbiA9IHRydWUpIHsKICAgICAgX2Fyci5wdXNoKF9zLnZhbHVlKTsKCiAgICAgIGlmIChpICYmIF9hcnIubGVuZ3RoID09PSBpKSBicmVhazsKICAgIH0KICB9IGNhdGNoIChlcnIpIHsKICAgIF9kID0gdHJ1ZTsKICAgIF9lID0gZXJyOwogIH0gZmluYWxseSB7CiAgICB0cnkgewogICAgICBpZiAoIV9uICYmIF9pWyJyZXR1cm4iXSAhPSBudWxsKSBfaVsicmV0dXJuIl0oKTsKICAgIH0gZmluYWxseSB7CiAgICAgIGlmIChfZCkgdGhyb3cgX2U7CiAgICB9CiAgfQoKICByZXR1cm4gX2FycjsKfQoKZnVuY3Rpb24gX2FycmF5V2l0aEhvbGVzKGFycikgewogIGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBhcnI7Cn0KCnZhciBWQUxVRV9BWElTX1BSRUZJWCA9ICdWYWx1ZUF4aXMtJzsKCmZ1bmN0aW9uIE1ldHJpY3NBeGlzT3B0aW9ucyhwcm9wcykgewogIHZhciBzdGF0ZVBhcmFtcyA9IHByb3BzLnN0YXRlUGFyYW1zLAogICAgICBzZXRWYWx1ZSA9IHByb3BzLnNldFZhbHVlLAogICAgICBhZ2dzID0gcHJvcHMuYWdncywKICAgICAgYWdnc0xhYmVscyA9IHByb3BzLmFnZ3NMYWJlbHMsCiAgICAgIHNldFZpc1R5cGUgPSBwcm9wcy5zZXRWaXNUeXBlLAogICAgICB2aXMgPSBwcm9wcy52aXM7CgogIHZhciBfdXNlU3RhdGUgPSAoMCwgX3JlYWN0LnVzZVN0YXRlKSh0cnVlKSwKICAgICAgX3VzZVN0YXRlMiA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZSwgMiksCiAgICAgIGlzQ2F0ZWdvcnlBeGlzSG9yaXpvbnRhbCA9IF91c2VTdGF0ZTJbMF0sCiAgICAgIHNldElzQ2F0ZWdvcnlBeGlzSG9yaXpvbnRhbCA9IF91c2VTdGF0ZTJbMV07CgogIHZhciBzZXRQYXJhbUJ5SW5kZXggPSAoMCwgX3JlYWN0LnVzZUNhbGxiYWNrKShmdW5jdGlvbiAoYXhlc05hbWUsIGluZGV4LCBwYXJhbU5hbWUsIHZhbHVlKSB7CiAgICB2YXIgaXRlbXMgPSBzdGF0ZVBhcmFtc1theGVzTmFtZV07CgogICAgdmFyIGFycmF5ID0gX3RvQ29uc3VtYWJsZUFycmF5KGl0ZW1zKTsKCiAgICBhcnJheVtpbmRleF0gPSBfb2JqZWN0U3ByZWFkKHt9LCBhcnJheVtpbmRleF0sIF9kZWZpbmVQcm9wZXJ0eSh7fSwgcGFyYW1OYW1lLCB2YWx1ZSkpOwogICAgc2V0VmFsdWUoYXhlc05hbWUsIGFycmF5KTsKICB9LCBbc3RhdGVQYXJhbXMsIHNldFZhbHVlXSk7CiAgdmFyIHNldENhdGVnb3J5QXhpcyA9ICgwLCBfcmVhY3QudXNlQ2FsbGJhY2spKGZ1bmN0aW9uICh2YWx1ZSkgewogICAgdmFyIGNhdGVnb3J5QXhlcyA9IF90b0NvbnN1bWFibGVBcnJheShzdGF0ZVBhcmFtcy5jYXRlZ29yeUF4ZXMpOwoKICAgIGNhdGVnb3J5QXhlc1swXSA9IHZhbHVlOwogICAgc2V0VmFsdWUoJ2NhdGVnb3J5QXhlcycsIGNhdGVnb3J5QXhlcyk7CiAgfSwgW3NldFZhbHVlLCBzdGF0ZVBhcmFtcy5jYXRlZ29yeUF4ZXNdKTsgLy8gc3RvcmVzIHByZXZpb3VzIGFnZ3MnIGN1c3RvbSBsYWJlbHMKCiAgdmFyIF91c2VTdGF0ZTMgPSAoMCwgX3JlYWN0LnVzZVN0YXRlKSh7fSksCiAgICAgIF91c2VTdGF0ZTQgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUzLCAyKSwKICAgICAgbGFzdEN1c3RvbUxhYmVscyA9IF91c2VTdGF0ZTRbMF0sCiAgICAgIHNldExhc3RDdXN0b21MYWJlbHMgPSBfdXNlU3RhdGU0WzFdOyAvLyBzdG9yZXMgcHJldmlvdXMgYWdncycgZmllbGQgYW5kIHR5cGUKCgogIHZhciBfdXNlU3RhdGU1ID0gKDAsIF9yZWFjdC51c2VTdGF0ZSkoe30pLAogICAgICBfdXNlU3RhdGU2ID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlNSwgMiksCiAgICAgIGxhc3RTZXJpZXNBZ2cgPSBfdXNlU3RhdGU2WzBdLAogICAgICBzZXRMYXN0U2VyaWVzQWdnID0gX3VzZVN0YXRlNlsxXTsKCiAgdmFyIHVwZGF0ZUF4aXNUaXRsZSA9IGZ1bmN0aW9uIHVwZGF0ZUF4aXNUaXRsZSgpIHsKICAgIHZhciBheGVzID0gKDAsIF9sb2Rhc2guY2xvbmVEZWVwKShzdGF0ZVBhcmFtcy52YWx1ZUF4ZXMpOwogICAgdmFyIGlzQXhlc0NoYW5nZWQgPSBmYWxzZTsKCiAgICB2YXIgbGFzdExhYmVscyA9IF9vYmplY3RTcHJlYWQoe30sIGxhc3RDdXN0b21MYWJlbHMpOwoKICAgIHZhciBsYXN0TWF0Y2hpbmdTZXJpZXNBZ2cgPSBfb2JqZWN0U3ByZWFkKHt9LCBsYXN0U2VyaWVzQWdnKTsKCiAgICBzdGF0ZVBhcmFtcy52YWx1ZUF4ZXMuZm9yRWFjaChmdW5jdGlvbiAoYXhpcywgYXhpc051bWJlcikgewogICAgICB2YXIgbmV3Q3VzdG9tTGFiZWwgPSAnJzsKICAgICAgdmFyIG1hdGNoaW5nU2VyaWVzID0gW107CiAgICAgIHN0YXRlUGFyYW1zLnNlcmllc1BhcmFtcy5mb3JFYWNoKGZ1bmN0aW9uIChzZXJpZXMsIHNlcmllc0luZGV4KSB7CiAgICAgICAgaWYgKGF4aXNOdW1iZXIgPT09IDAgJiYgIXNlcmllcy52YWx1ZUF4aXMgfHwgc2VyaWVzLnZhbHVlQXhpcyA9PT0gYXhpcy5pZCkgewogICAgICAgICAgdmFyIGFnZ0J5SW5kZXggPSBhZ2dzLmJ5U2NoZW1hTmFtZSgnbWV0cmljJylbc2VyaWVzSW5kZXhdOwogICAgICAgICAgbWF0Y2hpbmdTZXJpZXMucHVzaChhZ2dCeUluZGV4KTsKICAgICAgICB9CiAgICAgIH0pOwoKICAgICAgaWYgKG1hdGNoaW5nU2VyaWVzLmxlbmd0aCA9PT0gMSkgewogICAgICAgIC8vIGlmIHNldmVyYWwgc2VyaWVzIG1hdGNoZXMgdG8gdGhlIGF4aXMsIGF4aXMgdGl0bGUgaXMgc2V0IGFjY29yZGluZyB0byB0aGUgZmlyc3Qgc2VyaWUuCiAgICAgICAgbmV3Q3VzdG9tTGFiZWwgPSBtYXRjaGluZ1Nlcmllc1swXS5tYWtlTGFiZWwoKTsKICAgICAgfQoKICAgICAgaWYgKGxhc3RDdXN0b21MYWJlbHNbYXhpcy5pZF0gIT09IG5ld0N1c3RvbUxhYmVsICYmIG5ld0N1c3RvbUxhYmVsICE9PSAnJykgewogICAgICAgIHZhciBsYXN0U2VyaWVzQWdnVHlwZSA9ICgwLCBfbG9kYXNoLmdldCkobGFzdFNlcmllc0FnZywgIiIuY29uY2F0KG1hdGNoaW5nU2VyaWVzWzBdLmlkLCAiLnR5cGUiKSk7CiAgICAgICAgdmFyIGxhc3RTZXJpZXNBZ2dGaWVsZCA9ICgwLCBfbG9kYXNoLmdldCkobGFzdFNlcmllc0FnZywgIiIuY29uY2F0KG1hdGNoaW5nU2VyaWVzWzBdLmlkLCAiLmZpZWxkIikpOwogICAgICAgIHZhciBtYXRjaGluZ1Nlcmllc0FnZ1R5cGUgPSAoMCwgX2xvZGFzaC5nZXQpKG1hdGNoaW5nU2VyaWVzLCAnWzBddHlwZS5uYW1lJywgJycpOwogICAgICAgIHZhciBtYXRjaGluZ1Nlcmllc0FnZ0ZpZWxkID0gKDAsIF9sb2Rhc2guZ2V0KShtYXRjaGluZ1NlcmllcywgJ1swXXBhcmFtcy5maWVsZC5uYW1lJywgJycpOwogICAgICAgIHZhciBhZ2dUeXBlSXNDaGFuZ2VkID0gbGFzdFNlcmllc0FnZ1R5cGUgIT09IG1hdGNoaW5nU2VyaWVzQWdnVHlwZTsKICAgICAgICB2YXIgYWdnRmllbGRJc0NoYW5nZWQgPSBsYXN0U2VyaWVzQWdnRmllbGQgIT09IG1hdGNoaW5nU2VyaWVzQWdnRmllbGQ7CiAgICAgICAgbGFzdE1hdGNoaW5nU2VyaWVzQWdnW21hdGNoaW5nU2VyaWVzWzBdLmlkXSA9IHsKICAgICAgICAgIHR5cGU6IG1hdGNoaW5nU2VyaWVzQWdnVHlwZSwKICAgICAgICAgIGZpZWxkOiBtYXRjaGluZ1Nlcmllc0FnZ0ZpZWxkCiAgICAgICAgfTsKICAgICAgICBsYXN0TGFiZWxzW2F4aXMuaWRdID0gbmV3Q3VzdG9tTGFiZWw7CgogICAgICAgIGlmIChPYmplY3Qua2V5cyhsYXN0Q3VzdG9tTGFiZWxzKS5sZW5ndGggIT09IDAgJiYgKGFnZ1R5cGVJc0NoYW5nZWQgfHwgYWdnRmllbGRJc0NoYW5nZWQgfHwgYXhpcy50aXRsZS50ZXh0ID09PSAnJyB8fCBsYXN0Q3VzdG9tTGFiZWxzW2F4aXMuaWRdID09PSBheGlzLnRpdGxlLnRleHQpKSB7CiAgICAgICAgICAvLyBPdmVycmlkZSBheGlzIHRpdGxlIHdpdGggbmV3IGN1c3RvbSBsYWJlbAogICAgICAgICAgYXhlc1theGlzTnVtYmVyXSA9IF9vYmplY3RTcHJlYWQoe30sIGF4aXMsIHsKICAgICAgICAgICAgdGl0bGU6IF9vYmplY3RTcHJlYWQoe30sIGF4aXMudGl0bGUsIHsKICAgICAgICAgICAgICB0ZXh0OiBuZXdDdXN0b21MYWJlbAogICAgICAgICAgICB9KQogICAgICAgICAgfSk7CiAgICAgICAgICBpc0F4ZXNDaGFuZ2VkID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0pOwoKICAgIGlmIChpc0F4ZXNDaGFuZ2VkKSB7CiAgICAgIHNldFZhbHVlKCd2YWx1ZUF4ZXMnLCBheGVzKTsKICAgIH0KCiAgICBzZXRMYXN0U2VyaWVzQWdnKGxhc3RNYXRjaGluZ1Nlcmllc0FnZyk7CiAgICBzZXRMYXN0Q3VzdG9tTGFiZWxzKGxhc3RMYWJlbHMpOwogIH07CgogIHZhciBvblZhbHVlQXhpc1Bvc2l0aW9uQ2hhbmdlZCA9ICgwLCBfcmVhY3QudXNlQ2FsbGJhY2spKGZ1bmN0aW9uIChpbmRleCwgdmFsdWUpIHsKICAgIHZhciB2YWx1ZUF4ZXMgPSBfdG9Db25zdW1hYmxlQXJyYXkoc3RhdGVQYXJhbXMudmFsdWVBeGVzKTsKCiAgICB2YXIgbmFtZSA9ICgwLCBfdXRpbHMuZ2V0VXBkYXRlZEF4aXNOYW1lKSh2YWx1ZSwgdmFsdWVBeGVzKTsKICAgIHZhbHVlQXhlc1tpbmRleF0gPSBfb2JqZWN0U3ByZWFkKHt9LCB2YWx1ZUF4ZXNbaW5kZXhdLCB7CiAgICAgIG5hbWU6IG5hbWUsCiAgICAgIHBvc2l0aW9uOiB2YWx1ZQogICAgfSk7CiAgICBzZXRWYWx1ZSgndmFsdWVBeGVzJywgdmFsdWVBeGVzKTsKICB9LCBbc3RhdGVQYXJhbXMudmFsdWVBeGVzLCBfdXRpbHMuZ2V0VXBkYXRlZEF4aXNOYW1lLCBzZXRWYWx1ZV0pOwogIHZhciBvbkNhdGVnb3J5QXhpc1Bvc2l0aW9uQ2hhbmdlZCA9ICgwLCBfcmVhY3QudXNlQ2FsbGJhY2spKGZ1bmN0aW9uIChjaGFydFBvc2l0aW9uKSB7CiAgICB2YXIgaXNDaGFydEhvcml6b250YWwgPSAoMCwgX3V0aWxzLmlzQXhpc0hvcml6b250YWwpKGNoYXJ0UG9zaXRpb24pOwogICAgc2V0SXNDYXRlZ29yeUF4aXNIb3Jpem9udGFsKCgwLCBfdXRpbHMuaXNBeGlzSG9yaXpvbnRhbCkoY2hhcnRQb3NpdGlvbikpOwogICAgc3RhdGVQYXJhbXMudmFsdWVBeGVzLmZvckVhY2goZnVuY3Rpb24gKGF4aXMsIGluZGV4KSB7CiAgICAgIGlmICgoMCwgX3V0aWxzLmlzQXhpc0hvcml6b250YWwpKGF4aXMucG9zaXRpb24pID09PSBpc0NoYXJ0SG9yaXpvbnRhbCkgewogICAgICAgIHZhciBwb3NpdGlvbiA9ICgwLCBfdXRpbHMubWFwUG9zaXRpb24pKGF4aXMucG9zaXRpb24pOwogICAgICAgIG9uVmFsdWVBeGlzUG9zaXRpb25DaGFuZ2VkKGluZGV4LCBwb3NpdGlvbik7CiAgICAgIH0KICAgIH0pOwogIH0sIFtzdGF0ZVBhcmFtcy52YWx1ZUF4ZXMsIG9uVmFsdWVBeGlzUG9zaXRpb25DaGFuZ2VkXSk7CiAgdmFyIGFkZFZhbHVlQXhpcyA9ICgwLCBfcmVhY3QudXNlQ2FsbGJhY2spKGZ1bmN0aW9uICgpIHsKICAgIHZhciBuZXh0QXhpc0lkTnVtYmVyID0gc3RhdGVQYXJhbXMudmFsdWVBeGVzLnJlZHVjZSgoMCwgX3V0aWxzLmNvdW50TmV4dEF4aXNOdW1iZXIpKFZBTFVFX0FYSVNfUFJFRklYKSwgMSk7CiAgICB2YXIgbmV3QXhpcyA9ICgwLCBfbG9kYXNoLmNsb25lRGVlcCkoc3RhdGVQYXJhbXMudmFsdWVBeGVzWzBdKTsKICAgIG5ld0F4aXMuaWQgPSBWQUxVRV9BWElTX1BSRUZJWCArIG5leHRBeGlzSWROdW1iZXI7CiAgICBuZXdBeGlzLnBvc2l0aW9uID0gKDAsIF91dGlscy5tYXBQb3NpdGlvbk9wcG9zaXRlKShuZXdBeGlzLnBvc2l0aW9uKTsKICAgIG5ld0F4aXMubmFtZSA9ICgwLCBfdXRpbHMuZ2V0VXBkYXRlZEF4aXNOYW1lKShuZXdBeGlzLnBvc2l0aW9uLCBzdGF0ZVBhcmFtcy52YWx1ZUF4ZXMpOwogICAgc2V0VmFsdWUoJ3ZhbHVlQXhlcycsIFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkoc3RhdGVQYXJhbXMudmFsdWVBeGVzKSwgW25ld0F4aXNdKSk7CiAgICByZXR1cm4gbmV3QXhpczsKICB9LCBbc3RhdGVQYXJhbXMudmFsdWVBeGVzLCBzZXRWYWx1ZV0pOwogIHZhciByZW1vdmVWYWx1ZUF4aXMgPSAoMCwgX3JlYWN0LnVzZUNhbGxiYWNrKShmdW5jdGlvbiAoYXhpcykgewogICAgdmFyIG5ld1ZhbHVlQXhlcyA9IHN0YXRlUGFyYW1zLnZhbHVlQXhlcy5maWx0ZXIoZnVuY3Rpb24gKHZhbEF4aXMpIHsKICAgICAgcmV0dXJuIHZhbEF4aXMuaWQgIT09IGF4aXMuaWQ7CiAgICB9KTsKICAgIHNldFZhbHVlKCd2YWx1ZUF4ZXMnLCBuZXdWYWx1ZUF4ZXMpOwogICAgdmFyIGlzU2VyaWVzVXBkYXRlZCA9IGZhbHNlOwogICAgdmFyIHNlcmllcyA9IHN0YXRlUGFyYW1zLnNlcmllc1BhcmFtcy5tYXAoZnVuY3Rpb24gKHNlcikgewogICAgICBpZiAoYXhpcy5pZCA9PT0gc2VyLnZhbHVlQXhpcykgewogICAgICAgIGlzU2VyaWVzVXBkYXRlZCA9IHRydWU7CiAgICAgICAgcmV0dXJuIF9vYmplY3RTcHJlYWQoe30sIHNlciwgewogICAgICAgICAgdmFsdWVBeGlzOiBuZXdWYWx1ZUF4ZXNbMF0uaWQKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgcmV0dXJuIHNlcjsKICAgIH0pOwoKICAgIGlmIChpc1Nlcmllc1VwZGF0ZWQpIHsKICAgICAgLy8gaWYgc2VyaWVzUGFyYW1zIGhhdmUgdmFsdWVBeGlzIGVxdWFscyB0byByZW1vdmVkIG9uZSwgdGhlbiB3ZSByZXNldCBpdCB0byB0aGUgZmlyc3QgdmFsdWVBeGlzCiAgICAgIHNldFZhbHVlKCdzZXJpZXNQYXJhbXMnLCBzZXJpZXMpOwogICAgfQoKICAgIGlmIChzdGF0ZVBhcmFtcy5ncmlkLnZhbHVlQXhpcyA9PT0gYXhpcy5pZCkgewogICAgICAvLyByZXNldCBZLWF4aXMgZ3JpZCBsaW5lcyBzZXR0aW5nCiAgICAgIHNldFZhbHVlKCdncmlkJywgX29iamVjdFNwcmVhZCh7fSwgc3RhdGVQYXJhbXMuZ3JpZCwgewogICAgICAgIHZhbHVlQXhpczogdW5kZWZpbmVkCiAgICAgIH0pKTsKICAgIH0KICB9LCBbc3RhdGVQYXJhbXMuc2VyaWVzUGFyYW1zLCBzdGF0ZVBhcmFtcy52YWx1ZUF4ZXMsIHNldFZhbHVlXSk7CiAgdmFyIGNoYW5nZVZhbHVlQXhpcyA9ICgwLCBfcmVhY3QudXNlQ2FsbGJhY2spKGZ1bmN0aW9uIChpbmRleCwgcGFyYW1OYW1lLCBzZWxlY3RlZFZhbHVlQXhpcykgewogICAgdmFyIG5ld1ZhbHVlQXhpcyA9IHNlbGVjdGVkVmFsdWVBeGlzOwoKICAgIGlmIChzZWxlY3RlZFZhbHVlQXhpcyA9PT0gJ25ldycpIHsKICAgICAgdmFyIGF4aXMgPSBhZGRWYWx1ZUF4aXMoKTsKICAgICAgbmV3VmFsdWVBeGlzID0gYXhpcy5pZDsKICAgIH0KCiAgICBzZXRQYXJhbUJ5SW5kZXgoJ3Nlcmllc1BhcmFtcycsIGluZGV4LCBwYXJhbU5hbWUsIG5ld1ZhbHVlQXhpcyk7CiAgICB1cGRhdGVBeGlzVGl0bGUoKTsKICB9LCBbYWRkVmFsdWVBeGlzLCBzZXRQYXJhbUJ5SW5kZXhdKTsKICB2YXIgbWV0cmljcyA9ICgwLCBfcmVhY3QudXNlTWVtbykoZnVuY3Rpb24gKCkgewogICAgdmFyIHNjaGVtYU5hbWUgPSB2aXMudHlwZS5zY2hlbWFzLm1ldHJpY3NbMF0ubmFtZTsKICAgIHJldHVybiBhZ2dzLmJ5U2NoZW1hTmFtZShzY2hlbWFOYW1lKTsKICB9LCBbdmlzLnR5cGUuc2NoZW1hcy5tZXRyaWNzWzBdLm5hbWUsIGFnZ3MsIGFnZ3NMYWJlbHNdKTsKICB2YXIgZmlyc3RWYWx1ZUF4ZXNJZCA9IHN0YXRlUGFyYW1zLnZhbHVlQXhlc1swXS5pZDsKICAoMCwgX3JlYWN0LnVzZUVmZmVjdCkoZnVuY3Rpb24gKCkgewogICAgdmFyIHVwZGF0ZWRTZXJpZXMgPSBtZXRyaWNzLm1hcChmdW5jdGlvbiAoYWdnKSB7CiAgICAgIHZhciBwYXJhbXMgPSBzdGF0ZVBhcmFtcy5zZXJpZXNQYXJhbXMuZmluZChmdW5jdGlvbiAocGFyYW0pIHsKICAgICAgICByZXR1cm4gcGFyYW0uZGF0YS5pZCA9PT0gYWdnLmlkOwogICAgICB9KTsKICAgICAgdmFyIGxhYmVsID0gYWdnLm1ha2VMYWJlbCgpOyAvLyB1cGRhdGUgbGFiZWxzIGZvciBleGlzdGluZyBwYXJhbXMgb3IgY3JlYXRlIG5ldyBvbmUKCiAgICAgIGlmIChwYXJhbXMpIHsKICAgICAgICByZXR1cm4gX29iamVjdFNwcmVhZCh7fSwgcGFyYW1zLCB7CiAgICAgICAgICBkYXRhOiBfb2JqZWN0U3ByZWFkKHt9LCBwYXJhbXMuZGF0YSwgewogICAgICAgICAgICBsYWJlbDogbGFiZWwKICAgICAgICAgIH0pCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFyIHNlcmllcyA9ICgwLCBfdXRpbHMubWFrZVNlcmllKShhZ2cuaWQsIGxhYmVsLCBmaXJzdFZhbHVlQXhlc0lkLCBzdGF0ZVBhcmFtcy5zZXJpZXNQYXJhbXNbc3RhdGVQYXJhbXMuc2VyaWVzUGFyYW1zLmxlbmd0aCAtIDFdKTsKICAgICAgICByZXR1cm4gc2VyaWVzOwogICAgICB9CiAgICB9KTsKICAgIHNldFZhbHVlKCdzZXJpZXNQYXJhbXMnLCB1cGRhdGVkU2VyaWVzKTsKICB9LCBbYWdnc0xhYmVscywgbWV0cmljcywgZmlyc3RWYWx1ZUF4ZXNJZF0pOwogIHZhciB2aXNUeXBlID0gKDAsIF9yZWFjdC51c2VNZW1vKShmdW5jdGlvbiAoKSB7CiAgICB2YXIgdHlwZXMgPSAoMCwgX2xvZGFzaC51bmlxKShzdGF0ZVBhcmFtcy5zZXJpZXNQYXJhbXMubWFwKGZ1bmN0aW9uIChfcmVmKSB7CiAgICAgIHZhciB0eXBlID0gX3JlZi50eXBlOwogICAgICByZXR1cm4gdHlwZTsKICAgIH0pKTsKICAgIHJldHVybiB0eXBlcy5sZW5ndGggPT09IDEgPyB0eXBlc1swXSA6ICdoaXN0b2dyYW0nOwogIH0sIFtzdGF0ZVBhcmFtcy5zZXJpZXNQYXJhbXNdKTsKICAoMCwgX3JlYWN0LnVzZUVmZmVjdCkoZnVuY3Rpb24gKCkgewogICAgc2V0VmlzVHlwZSh2aXNUeXBlKTsKICB9LCBbdmlzVHlwZV0pOwogICgwLCBfcmVhY3QudXNlRWZmZWN0KShmdW5jdGlvbiAoKSB7CiAgICB1cGRhdGVBeGlzVGl0bGUoKTsKICB9LCBbYWdnc0xhYmVsc10pOwogIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5kZWZhdWx0LkZyYWdtZW50LCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9zZXJpZXNfcGFuZWwuU2VyaWVzUGFuZWwsIF9leHRlbmRzKHsKICAgIHNldFBhcmFtQnlJbmRleDogc2V0UGFyYW1CeUluZGV4LAogICAgY2hhbmdlVmFsdWVBeGlzOiBjaGFuZ2VWYWx1ZUF4aXMKICB9LCBwcm9wcykpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3BhY2VyLCB7CiAgICBzaXplOiAicyIKICB9KSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfdmFsdWVfYXhlc19wYW5lbC5WYWx1ZUF4ZXNQYW5lbCwgX2V4dGVuZHMoewogICAgYWRkVmFsdWVBeGlzOiBhZGRWYWx1ZUF4aXMsCiAgICBpc0NhdGVnb3J5QXhpc0hvcml6b250YWw6IGlzQ2F0ZWdvcnlBeGlzSG9yaXpvbnRhbCwKICAgIHJlbW92ZVZhbHVlQXhpczogcmVtb3ZlVmFsdWVBeGlzLAogICAgb25WYWx1ZUF4aXNQb3NpdGlvbkNoYW5nZWQ6IG9uVmFsdWVBeGlzUG9zaXRpb25DaGFuZ2VkLAogICAgc2V0UGFyYW1CeUluZGV4OiBzZXRQYXJhbUJ5SW5kZXgKICB9LCBwcm9wcykpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3BhY2VyLCB7CiAgICBzaXplOiAicyIKICB9KSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfY2F0ZWdvcnlfYXhpc19wYW5lbC5DYXRlZ29yeUF4aXNQYW5lbCwgX2V4dGVuZHMoe30sIHByb3BzLCB7CiAgICBheGlzOiBzdGF0ZVBhcmFtcy5jYXRlZ29yeUF4ZXNbMF0sCiAgICBvblBvc2l0aW9uQ2hhbmdlZDogb25DYXRlZ29yeUF4aXNQb3NpdGlvbkNoYW5nZWQsCiAgICBzZXRDYXRlZ29yeUF4aXM6IHNldENhdGVnb3J5QXhpcwogIH0pKSk7Cn0="},null]}