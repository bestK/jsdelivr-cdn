{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/lens/public/app_plugin/app.js","dependencies":[{"path":"x-pack/legacy/plugins/lens/public/app_plugin/app.js","mtime":1585205044957},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkFwcCA9IEFwcDsKZXhwb3J0cy5nZXRBbGxJbmRleFBhdHRlcm5zID0gZ2V0QWxsSW5kZXhQYXR0ZXJuczsKCnZhciBfbG9kYXNoID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJsb2Rhc2giKSk7Cgp2YXIgX3JlYWN0ID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgicmVhY3QiKSk7Cgp2YXIgX3JlYWN0MiA9IHJlcXVpcmUoIkBrYm4vaTE4bi9yZWFjdCIpOwoKdmFyIF9pMThuID0gcmVxdWlyZSgiQGtibi9pMThuIik7Cgp2YXIgX3NhdmVkX29iamVjdF9zYXZlX21vZGFsID0gcmVxdWlyZSgidWkvc2F2ZWRfb2JqZWN0cy9jb21wb25lbnRzL3NhdmVkX29iamVjdF9zYXZlX21vZGFsIik7Cgp2YXIgX25ld19wbGF0Zm9ybSA9IHJlcXVpcmUoInVpL25ld19wbGF0Zm9ybSIpOwoKdmFyIF9wdWJsaWMgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi8uLi8uLi9zcmMvcGx1Z2lucy9raWJhbmFfcmVhY3QvcHVibGljIik7Cgp2YXIgX25hdGl2ZV9yZW5kZXJlciA9IHJlcXVpcmUoIi4uL25hdGl2ZV9yZW5kZXJlciIpOwoKdmFyIF9sZW5zX3VpX3RlbGVtZXRyeSA9IHJlcXVpcmUoIi4uL2xlbnNfdWlfdGVsZW1ldHJ5Iik7Cgp2YXIgX3B1YmxpYzIgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi8uLi8uLi9zcmMvcGx1Z2lucy9kYXRhL3B1YmxpYyIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7CiAgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgewogICAgcmV0dXJuIG9iajsKICB9IGVsc2UgewogICAgdmFyIG5ld09iaiA9IHt9OwoKICAgIGlmIChvYmogIT0gbnVsbCkgewogICAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7CiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHsKICAgICAgICAgIHZhciBkZXNjID0gT2JqZWN0LmRlZmluZVByb3BlcnR5ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KSA6IHt9OwoKICAgICAgICAgIGlmIChkZXNjLmdldCB8fCBkZXNjLnNldCkgewogICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobmV3T2JqLCBrZXksIGRlc2MpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBuZXdPYmouZGVmYXVsdCA9IG9iajsKICAgIHJldHVybiBuZXdPYmo7CiAgfQp9CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgewogIHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7CiAgICBkZWZhdWx0OiBvYmoKICB9Owp9CgpmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsKICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7CgogIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7CiAgICB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsKICAgIGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsKICAgICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7CiAgICB9KTsKICAgIGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsKICB9CgogIHJldHVybiBrZXlzOwp9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgewogIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsKCiAgICBpZiAoaSAlIDIpIHsKICAgICAgb3duS2V5cyhzb3VyY2UsIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOwogICAgICB9KTsKICAgIH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsKICAgIH0gZWxzZSB7CiAgICAgIG93bktleXMoc291cmNlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsKICAgICAgfSk7CiAgICB9CiAgfQoKICByZXR1cm4gdGFyZ2V0Owp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7CiAgaWYgKGtleSBpbiBvYmopIHsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgICB2YWx1ZTogdmFsdWUsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgd3JpdGFibGU6IHRydWUKICAgIH0pOwogIH0gZWxzZSB7CiAgICBvYmpba2V5XSA9IHZhbHVlOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7CiAgcmV0dXJuIF9hcnJheVdpdGhIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHx8IF9ub25JdGVyYWJsZVJlc3QoKTsKfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlUmVzdCgpIHsKICB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7Cn0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHsKICB2YXIgX2FyciA9IFtdOwogIHZhciBfbiA9IHRydWU7CiAgdmFyIF9kID0gZmFsc2U7CiAgdmFyIF9lID0gdW5kZWZpbmVkOwoKICB0cnkgewogICAgZm9yICh2YXIgX2kgPSBhcnJbU3ltYm9sLml0ZXJhdG9yXSgpLCBfczsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSkgewogICAgICBfYXJyLnB1c2goX3MudmFsdWUpOwoKICAgICAgaWYgKGkgJiYgX2Fyci5sZW5ndGggPT09IGkpIGJyZWFrOwogICAgfQogIH0gY2F0Y2ggKGVycikgewogICAgX2QgPSB0cnVlOwogICAgX2UgPSBlcnI7CiAgfSBmaW5hbGx5IHsKICAgIHRyeSB7CiAgICAgIGlmICghX24gJiYgX2lbInJldHVybiJdICE9IG51bGwpIF9pWyJyZXR1cm4iXSgpOwogICAgfSBmaW5hbGx5IHsKICAgICAgaWYgKF9kKSB0aHJvdyBfZTsKICAgIH0KICB9CgogIHJldHVybiBfYXJyOwp9CgpmdW5jdGlvbiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsKfQoKZnVuY3Rpb24gQXBwKF9yZWYpIHsKICB2YXIgZWRpdG9yRnJhbWUgPSBfcmVmLmVkaXRvckZyYW1lLAogICAgICBkYXRhID0gX3JlZi5kYXRhLAogICAgICBjb3JlID0gX3JlZi5jb3JlLAogICAgICBzdG9yYWdlID0gX3JlZi5zdG9yYWdlLAogICAgICBkb2NJZCA9IF9yZWYuZG9jSWQsCiAgICAgIGRvY1N0b3JhZ2UgPSBfcmVmLmRvY1N0b3JhZ2UsCiAgICAgIHJlZGlyZWN0VG8gPSBfcmVmLnJlZGlyZWN0VG8sCiAgICAgIGFkZFRvRGFzaGJvYXJkTW9kZSA9IF9yZWYuYWRkVG9EYXNoYm9hcmRNb2RlOwogIHZhciBsYW5ndWFnZSA9IHN0b3JhZ2UuZ2V0KCdraWJhbmEudXNlclF1ZXJ5TGFuZ3VhZ2UnKSB8fCBjb3JlLnVpU2V0dGluZ3MuZ2V0KCdzZWFyY2g6cXVlcnlMYW5ndWFnZScpOwoKICB2YXIgX3VzZVN0YXRlID0gKDAsIF9yZWFjdC51c2VTdGF0ZSkoZnVuY3Rpb24gKCkgewogICAgdmFyIGN1cnJlbnRSYW5nZSA9IGRhdGEucXVlcnkudGltZWZpbHRlci50aW1lZmlsdGVyLmdldFRpbWUoKTsKICAgIHJldHVybiB7CiAgICAgIGlzTG9hZGluZzogISFkb2NJZCwKICAgICAgaXNTYXZlTW9kYWxWaXNpYmxlOiBmYWxzZSwKICAgICAgaW5kZXhQYXR0ZXJuc0ZvclRvcE5hdjogW10sCiAgICAgIHF1ZXJ5OiB7CiAgICAgICAgcXVlcnk6ICcnLAogICAgICAgIGxhbmd1YWdlOiBsYW5ndWFnZQogICAgICB9LAogICAgICBkYXRlUmFuZ2U6IHsKICAgICAgICBmcm9tRGF0ZTogY3VycmVudFJhbmdlLmZyb20sCiAgICAgICAgdG9EYXRlOiBjdXJyZW50UmFuZ2UudG8KICAgICAgfSwKICAgICAgZmlsdGVyczogZGF0YS5xdWVyeS5maWx0ZXJNYW5hZ2VyLmdldEZpbHRlcnMoKQogICAgfTsKICB9KSwKICAgICAgX3VzZVN0YXRlMiA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZSwgMiksCiAgICAgIHN0YXRlID0gX3VzZVN0YXRlMlswXSwKICAgICAgc2V0U3RhdGUgPSBfdXNlU3RhdGUyWzFdOwoKICB2YXIgbGFzdEtub3duRG9jID0gc3RhdGUubGFzdEtub3duRG9jOwogICgwLCBfcmVhY3QudXNlRWZmZWN0KShmdW5jdGlvbiAoKSB7CiAgICB2YXIgZmlsdGVyU3Vic2NyaXB0aW9uID0gZGF0YS5xdWVyeS5maWx0ZXJNYW5hZ2VyLmdldFVwZGF0ZXMkKCkuc3Vic2NyaWJlKHsKICAgICAgbmV4dDogZnVuY3Rpb24gbmV4dCgpIHsKICAgICAgICBzZXRTdGF0ZShmdW5jdGlvbiAocykgewogICAgICAgICAgcmV0dXJuIF9vYmplY3RTcHJlYWQoe30sIHMsIHsKICAgICAgICAgICAgZmlsdGVyczogZGF0YS5xdWVyeS5maWx0ZXJNYW5hZ2VyLmdldEZpbHRlcnMoKQogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgICAgKDAsIF9sZW5zX3VpX3RlbGVtZXRyeS50cmFja1VpRXZlbnQpKCdhcHBfZmlsdGVyc191cGRhdGVkJyk7CiAgICAgIH0KICAgIH0pOyAvLyBJZiBMZW5zIHdhcyBvcGVuZWQgZnJvbSBhbm90aGVyIGFwcCwgdW5waW5uZWQgZmlsdGVycyBuZWVkIHRvIGJlIGNsZWFyZWQKCiAgICBpZiAoZGF0YS5xdWVyeS5maWx0ZXJNYW5hZ2VyLmdldEFwcEZpbHRlcnMoKS5sZW5ndGggPiAwKSB7CiAgICAgIGRhdGEucXVlcnkuZmlsdGVyTWFuYWdlci5zZXRGaWx0ZXJzKGRhdGEucXVlcnkuZmlsdGVyTWFuYWdlci5nZXRHbG9iYWxGaWx0ZXJzKCkpOwogICAgfQoKICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgIGZpbHRlclN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpOwogICAgfTsKICB9LCBbXSk7IC8vIFN5bmMgS2liYW5hIGJyZWFkY3J1bWJzIGFueSB0aW1lIHRoZSBzYXZlZCBkb2N1bWVudCdzIHRpdGxlIGNoYW5nZXMKCiAgKDAsIF9yZWFjdC51c2VFZmZlY3QpKGZ1bmN0aW9uICgpIHsKICAgIGNvcmUuY2hyb21lLnNldEJyZWFkY3J1bWJzKFt7CiAgICAgIGhyZWY6IGNvcmUuaHR0cC5iYXNlUGF0aC5wcmVwZW5kKCIvYXBwL2tpYmFuYSMvdmlzdWFsaXplIiksCiAgICAgIHRleHQ6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5sZW5zLmJyZWFkY3J1bWJzVGl0bGUnLCB7CiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdWaXN1YWxpemUnCiAgICAgIH0pCiAgICB9LCB7CiAgICAgIHRleHQ6IHN0YXRlLnBlcnNpc3RlZERvYyA/IHN0YXRlLnBlcnNpc3RlZERvYy50aXRsZSA6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5sZW5zLmJyZWFkY3J1bWJzQ3JlYXRlJywgewogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnQ3JlYXRlJwogICAgICB9KQogICAgfV0pOwogIH0sIFtzdGF0ZS5wZXJzaXN0ZWREb2MgJiYgc3RhdGUucGVyc2lzdGVkRG9jLnRpdGxlXSk7CiAgKDAsIF9yZWFjdC51c2VFZmZlY3QpKGZ1bmN0aW9uICgpIHsKICAgIGlmIChkb2NJZCAmJiAoIXN0YXRlLnBlcnNpc3RlZERvYyB8fCBzdGF0ZS5wZXJzaXN0ZWREb2MuaWQgIT09IGRvY0lkKSkgewogICAgICBzZXRTdGF0ZShmdW5jdGlvbiAocykgewogICAgICAgIHJldHVybiBfb2JqZWN0U3ByZWFkKHt9LCBzLCB7CiAgICAgICAgICBpc0xvYWRpbmc6IHRydWUKICAgICAgICB9KTsKICAgICAgfSk7CiAgICAgIGRvY1N0b3JhZ2UubG9hZChkb2NJZCkudGhlbihmdW5jdGlvbiAoZG9jKSB7CiAgICAgICAgZ2V0QWxsSW5kZXhQYXR0ZXJucyhkb2Muc3RhdGUuZGF0YXNvdXJjZU1ldGFEYXRhLmZpbHRlcmFibGVJbmRleFBhdHRlcm5zLCBkYXRhLmluZGV4UGF0dGVybnMsIGNvcmUubm90aWZpY2F0aW9ucykudGhlbihmdW5jdGlvbiAoaW5kZXhQYXR0ZXJucykgewogICAgICAgICAgZGF0YS5xdWVyeS5maWx0ZXJNYW5hZ2VyLnNldEZpbHRlcnMoZGF0YS5xdWVyeS5maWx0ZXJNYW5hZ2VyLmdldEdsb2JhbEZpbHRlcnMoKS5jb25jYXQoKGRvYy5zdGF0ZS5maWx0ZXJzIHx8IFtdKS5maWx0ZXIoZnVuY3Rpb24gKGZpbHRlcikgewogICAgICAgICAgICB2YXIgX2ZpbHRlciQkc3RhdGU7CgogICAgICAgICAgICByZXR1cm4gKChfZmlsdGVyJCRzdGF0ZSA9IGZpbHRlci4kc3RhdGUpID09PSBudWxsIHx8IF9maWx0ZXIkJHN0YXRlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZmlsdGVyJCRzdGF0ZS5zdG9yZSkgPT09IF9wdWJsaWMyLmVzRmlsdGVycy5GaWx0ZXJTdGF0ZVN0b3JlLkFQUF9TVEFURTsKICAgICAgICAgIH0pKSk7CiAgICAgICAgICBzZXRTdGF0ZShmdW5jdGlvbiAocykgewogICAgICAgICAgICByZXR1cm4gX29iamVjdFNwcmVhZCh7fSwgcywgewogICAgICAgICAgICAgIGlzTG9hZGluZzogZmFsc2UsCiAgICAgICAgICAgICAgcGVyc2lzdGVkRG9jOiBkb2MsCiAgICAgICAgICAgICAgbGFzdEtub3duRG9jOiBkb2MsCiAgICAgICAgICAgICAgcXVlcnk6IGRvYy5zdGF0ZS5xdWVyeSwKICAgICAgICAgICAgICBpbmRleFBhdHRlcm5zRm9yVG9wTmF2OiBpbmRleFBhdHRlcm5zCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKCkgewogICAgICAgICAgc2V0U3RhdGUoZnVuY3Rpb24gKHMpIHsKICAgICAgICAgICAgcmV0dXJuIF9vYmplY3RTcHJlYWQoe30sIHMsIHsKICAgICAgICAgICAgICBpc0xvYWRpbmc6IGZhbHNlCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgICByZWRpcmVjdFRvKCk7CiAgICAgICAgfSk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uICgpIHsKICAgICAgICBzZXRTdGF0ZShmdW5jdGlvbiAocykgewogICAgICAgICAgcmV0dXJuIF9vYmplY3RTcHJlYWQoe30sIHMsIHsKICAgICAgICAgICAgaXNMb2FkaW5nOiBmYWxzZQogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgICAgY29yZS5ub3RpZmljYXRpb25zLnRvYXN0cy5hZGREYW5nZXIoX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLmxlbnMuYXBwLmRvY0xvYWRpbmdFcnJvcicsIHsKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnRXJyb3IgbG9hZGluZyBzYXZlZCBkb2N1bWVudCcKICAgICAgICB9KSk7CiAgICAgICAgcmVkaXJlY3RUbygpOwogICAgICB9KTsKICAgIH0KICB9LCBbZG9jSWRdKTsKICB2YXIgaXNTYXZlYWJsZSA9IGxhc3RLbm93bkRvYyAmJiBsYXN0S25vd25Eb2MuZXhwcmVzc2lvbiAmJiBsYXN0S25vd25Eb2MuZXhwcmVzc2lvbi5sZW5ndGggPiAwICYmIGNvcmUuYXBwbGljYXRpb24uY2FwYWJpbGl0aWVzLnZpc3VhbGl6ZS5zYXZlOwogIHZhciBvbkVycm9yID0gKDAsIF9yZWFjdC51c2VDYWxsYmFjaykoZnVuY3Rpb24gKGUpIHsKICAgIHJldHVybiBjb3JlLm5vdGlmaWNhdGlvbnMudG9hc3RzLmFkZERhbmdlcih7CiAgICAgIHRpdGxlOiBlLm1lc3NhZ2UKICAgIH0pOwogIH0sIFtdKTsKICB2YXIgVG9wTmF2TWVudSA9IF9uZXdfcGxhdGZvcm0ubnBTdGFydC5wbHVnaW5zLm5hdmlnYXRpb24udWkuVG9wTmF2TWVudTsKICB2YXIgY29uZmlybUJ1dHRvbiA9IGFkZFRvRGFzaGJvYXJkTW9kZSA/IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICBpZDogInhwYWNrLmxlbnMuYXBwLnNhdmVBZGRUb0Rhc2hib2FyZCIsCiAgICBkZWZhdWx0TWVzc2FnZTogIlNhdmUgYW5kIGFkZCB0byBkYXNoYm9hcmQiCiAgfSkgOiBudWxsOwogIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuSTE4blByb3ZpZGVyLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9wdWJsaWMuS2liYW5hQ29udGV4dFByb3ZpZGVyLCB7CiAgICBzZXJ2aWNlczogX29iamVjdFNwcmVhZCh7CiAgICAgIGFwcE5hbWU6ICdsZW5zJywKICAgICAgZGF0YTogZGF0YSwKICAgICAgc3RvcmFnZTogc3RvcmFnZQogICAgfSwgY29yZSkKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICBjbGFzc05hbWU6ICJsbnNBcHAiCiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgY2xhc3NOYW1lOiAibG5zQXBwX19oZWFkZXIiCiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChUb3BOYXZNZW51LCB7CiAgICBjb25maWc6IFt7CiAgICAgIGxhYmVsOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subGVucy5hcHAuc2F2ZScsIHsKICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1NhdmUnCiAgICAgIH0pLAogICAgICBydW46IGZ1bmN0aW9uIHJ1bigpIHsKICAgICAgICBpZiAoaXNTYXZlYWJsZSAmJiBsYXN0S25vd25Eb2MpIHsKICAgICAgICAgIHNldFN0YXRlKGZ1bmN0aW9uIChzKSB7CiAgICAgICAgICAgIHJldHVybiBfb2JqZWN0U3ByZWFkKHt9LCBzLCB7CiAgICAgICAgICAgICAgaXNTYXZlTW9kYWxWaXNpYmxlOiB0cnVlCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LAogICAgICB0ZXN0SWQ6ICdsbnNBcHBfc2F2ZUJ1dHRvbicsCiAgICAgIGRpc2FibGVCdXR0b246ICFpc1NhdmVhYmxlCiAgICB9XSwKICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJsbnNBcHBfdG9wTmF2IiwKICAgIHNjcmVlblRpdGxlOiAnbGVucycsCiAgICBvblF1ZXJ5U3VibWl0OiBmdW5jdGlvbiBvblF1ZXJ5U3VibWl0KHBheWxvYWQpIHsKICAgICAgdmFyIGRhdGVSYW5nZSA9IHBheWxvYWQuZGF0ZVJhbmdlLAogICAgICAgICAgcXVlcnkgPSBwYXlsb2FkLnF1ZXJ5OwoKICAgICAgaWYgKGRhdGVSYW5nZS5mcm9tICE9PSBzdGF0ZS5kYXRlUmFuZ2UuZnJvbURhdGUgfHwgZGF0ZVJhbmdlLnRvICE9PSBzdGF0ZS5kYXRlUmFuZ2UudG9EYXRlKSB7CiAgICAgICAgZGF0YS5xdWVyeS50aW1lZmlsdGVyLnRpbWVmaWx0ZXIuc2V0VGltZShkYXRlUmFuZ2UpOwogICAgICAgICgwLCBfbGVuc191aV90ZWxlbWV0cnkudHJhY2tVaUV2ZW50KSgnYXBwX2RhdGVfY2hhbmdlJyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgKDAsIF9sZW5zX3VpX3RlbGVtZXRyeS50cmFja1VpRXZlbnQpKCdhcHBfcXVlcnlfY2hhbmdlJyk7CiAgICAgIH0KCiAgICAgIHNldFN0YXRlKGZ1bmN0aW9uIChzKSB7CiAgICAgICAgcmV0dXJuIF9vYmplY3RTcHJlYWQoe30sIHMsIHsKICAgICAgICAgIGRhdGVSYW5nZTogewogICAgICAgICAgICBmcm9tRGF0ZTogZGF0ZVJhbmdlLmZyb20sCiAgICAgICAgICAgIHRvRGF0ZTogZGF0ZVJhbmdlLnRvCiAgICAgICAgICB9LAogICAgICAgICAgcXVlcnk6IHF1ZXJ5IHx8IHMucXVlcnkKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgYXBwTmFtZTogJ2xlbnMnLAogICAgaW5kZXhQYXR0ZXJuczogc3RhdGUuaW5kZXhQYXR0ZXJuc0ZvclRvcE5hdiwKICAgIHNob3dTZWFyY2hCYXI6IHRydWUsCiAgICBzaG93RGF0ZVBpY2tlcjogdHJ1ZSwKICAgIHNob3dRdWVyeUJhcjogdHJ1ZSwKICAgIHNob3dGaWx0ZXJCYXI6IHRydWUsCiAgICBzaG93U2F2ZVF1ZXJ5OiBjb3JlLmFwcGxpY2F0aW9uLmNhcGFiaWxpdGllcy52aXN1YWxpemUuc2F2ZVF1ZXJ5LAogICAgc2F2ZWRRdWVyeTogc3RhdGUuc2F2ZWRRdWVyeSwKICAgIG9uU2F2ZWQ6IGZ1bmN0aW9uIG9uU2F2ZWQoc2F2ZWRRdWVyeSkgewogICAgICBzZXRTdGF0ZShmdW5jdGlvbiAocykgewogICAgICAgIHJldHVybiBfb2JqZWN0U3ByZWFkKHt9LCBzLCB7CiAgICAgICAgICBzYXZlZFF1ZXJ5OiBzYXZlZFF1ZXJ5CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIG9uU2F2ZWRRdWVyeVVwZGF0ZWQ6IGZ1bmN0aW9uIG9uU2F2ZWRRdWVyeVVwZGF0ZWQoc2F2ZWRRdWVyeSkgewogICAgICBkYXRhLnF1ZXJ5LmZpbHRlck1hbmFnZXIuc2V0RmlsdGVycyhzYXZlZFF1ZXJ5LmF0dHJpYnV0ZXMuZmlsdGVycyB8fCBbXSk7CiAgICAgIHNldFN0YXRlKGZ1bmN0aW9uIChzKSB7CiAgICAgICAgcmV0dXJuIF9vYmplY3RTcHJlYWQoe30sIHMsIHsKICAgICAgICAgIHNhdmVkUXVlcnk6IF9vYmplY3RTcHJlYWQoe30sIHNhdmVkUXVlcnkpLAogICAgICAgICAgLy8gU2hhbGxvdyBxdWVyeSBmb3IgcmVmZXJlbmNlIGlzc3VlcwogICAgICAgICAgZGF0ZVJhbmdlOiBzYXZlZFF1ZXJ5LmF0dHJpYnV0ZXMudGltZWZpbHRlciA/IHsKICAgICAgICAgICAgZnJvbURhdGU6IHNhdmVkUXVlcnkuYXR0cmlidXRlcy50aW1lZmlsdGVyLmZyb20sCiAgICAgICAgICAgIHRvRGF0ZTogc2F2ZWRRdWVyeS5hdHRyaWJ1dGVzLnRpbWVmaWx0ZXIudG8KICAgICAgICAgIH0gOiBzLmRhdGVSYW5nZQogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICBvbkNsZWFyU2F2ZWRRdWVyeTogZnVuY3Rpb24gb25DbGVhclNhdmVkUXVlcnkoKSB7CiAgICAgIGRhdGEucXVlcnkuZmlsdGVyTWFuYWdlci5yZW1vdmVBbGwoKTsKICAgICAgc2V0U3RhdGUoZnVuY3Rpb24gKHMpIHsKICAgICAgICByZXR1cm4gX29iamVjdFNwcmVhZCh7fSwgcywgewogICAgICAgICAgc2F2ZWRRdWVyeTogdW5kZWZpbmVkLAogICAgICAgICAgcXVlcnk6IHsKICAgICAgICAgICAgcXVlcnk6ICcnLAogICAgICAgICAgICBsYW5ndWFnZTogc3RvcmFnZS5nZXQoJ2tpYmFuYS51c2VyUXVlcnlMYW5ndWFnZScpIHx8IGNvcmUudWlTZXR0aW5ncy5nZXQoJ3NlYXJjaDpxdWVyeUxhbmd1YWdlJykKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgcXVlcnk6IHN0YXRlLnF1ZXJ5LAogICAgZGF0ZVJhbmdlRnJvbTogc3RhdGUuZGF0ZVJhbmdlLmZyb21EYXRlLAogICAgZGF0ZVJhbmdlVG86IHN0YXRlLmRhdGVSYW5nZS50b0RhdGUKICB9KSksICghc3RhdGUuaXNMb2FkaW5nIHx8IHN0YXRlLnBlcnNpc3RlZERvYykgJiYgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfbmF0aXZlX3JlbmRlcmVyLk5hdGl2ZVJlbmRlcmVyLCB7CiAgICBjbGFzc05hbWU6ICJsbnNBcHBfX2ZyYW1lIiwKICAgIHJlbmRlcjogZWRpdG9yRnJhbWUubW91bnQsCiAgICBuYXRpdmVQcm9wczogewogICAgICBkYXRlUmFuZ2U6IHN0YXRlLmRhdGVSYW5nZSwKICAgICAgcXVlcnk6IHN0YXRlLnF1ZXJ5LAogICAgICBmaWx0ZXJzOiBzdGF0ZS5maWx0ZXJzLAogICAgICBzYXZlZFF1ZXJ5OiBzdGF0ZS5zYXZlZFF1ZXJ5LAogICAgICBkb2M6IHN0YXRlLnBlcnNpc3RlZERvYywKICAgICAgb25FcnJvcjogb25FcnJvciwKICAgICAgb25DaGFuZ2U6IGZ1bmN0aW9uIG9uQ2hhbmdlKF9yZWYyKSB7CiAgICAgICAgdmFyIGZpbHRlcmFibGVJbmRleFBhdHRlcm5zID0gX3JlZjIuZmlsdGVyYWJsZUluZGV4UGF0dGVybnMsCiAgICAgICAgICAgIGRvYyA9IF9yZWYyLmRvYzsKCiAgICAgICAgaWYgKCFfbG9kYXNoLmRlZmF1bHQuaXNFcXVhbChzdGF0ZS5wZXJzaXN0ZWREb2MsIGRvYykpIHsKICAgICAgICAgIHNldFN0YXRlKGZ1bmN0aW9uIChzKSB7CiAgICAgICAgICAgIHJldHVybiBfb2JqZWN0U3ByZWFkKHt9LCBzLCB7CiAgICAgICAgICAgICAgbGFzdEtub3duRG9jOiBkb2MKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICB9IC8vIFVwZGF0ZSB0aGUgY2FjaGVkIGluZGV4IHBhdHRlcm5zIGlmIHRoZSB1c2VyIG1hZGUgYSBjaGFuZ2UgdG8gYW55IG9mIHRoZW0KCgogICAgICAgIGlmIChzdGF0ZS5pbmRleFBhdHRlcm5zRm9yVG9wTmF2Lmxlbmd0aCAhPT0gZmlsdGVyYWJsZUluZGV4UGF0dGVybnMubGVuZ3RoIHx8IGZpbHRlcmFibGVJbmRleFBhdHRlcm5zLmZpbmQoZnVuY3Rpb24gKF9yZWYzKSB7CiAgICAgICAgICB2YXIgaWQgPSBfcmVmMy5pZDsKICAgICAgICAgIHJldHVybiAhc3RhdGUuaW5kZXhQYXR0ZXJuc0ZvclRvcE5hdi5maW5kKGZ1bmN0aW9uIChpbmRleFBhdHRlcm4pIHsKICAgICAgICAgICAgcmV0dXJuIGluZGV4UGF0dGVybi5pZCA9PT0gaWQ7CiAgICAgICAgICB9KTsKICAgICAgICB9KSkgewogICAgICAgICAgZ2V0QWxsSW5kZXhQYXR0ZXJucyhmaWx0ZXJhYmxlSW5kZXhQYXR0ZXJucywgZGF0YS5pbmRleFBhdHRlcm5zLCBjb3JlLm5vdGlmaWNhdGlvbnMpLnRoZW4oZnVuY3Rpb24gKGluZGV4UGF0dGVybnMpIHsKICAgICAgICAgICAgaWYgKGluZGV4UGF0dGVybnMpIHsKICAgICAgICAgICAgICBzZXRTdGF0ZShmdW5jdGlvbiAocykgewogICAgICAgICAgICAgICAgcmV0dXJuIF9vYmplY3RTcHJlYWQoe30sIHMsIHsKICAgICAgICAgICAgICAgICAgaW5kZXhQYXR0ZXJuc0ZvclRvcE5hdjogaW5kZXhQYXR0ZXJucwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0pKSwgbGFzdEtub3duRG9jICYmIHN0YXRlLmlzU2F2ZU1vZGFsVmlzaWJsZSAmJiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9zYXZlZF9vYmplY3Rfc2F2ZV9tb2RhbC5TYXZlZE9iamVjdFNhdmVNb2RhbCwgewogICAgb25TYXZlOiBmdW5jdGlvbiBvblNhdmUocHJvcHMpIHsKICAgICAgdmFyIGRvYyA9IF9vYmplY3RTcHJlYWQoe30sIGxhc3RLbm93bkRvYywgewogICAgICAgIGlkOiBwcm9wcy5uZXdDb3B5T25TYXZlID8gdW5kZWZpbmVkIDogbGFzdEtub3duRG9jLmlkLAogICAgICAgIHRpdGxlOiBwcm9wcy5uZXdUaXRsZQogICAgICB9KTsKCiAgICAgIGRvY1N0b3JhZ2Uuc2F2ZShkb2MpLnRoZW4oZnVuY3Rpb24gKF9yZWY0KSB7CiAgICAgICAgdmFyIGlkID0gX3JlZjQuaWQ7IC8vIFByZXZlbnRzIHVubmVjZXNzYXJ5IG5ldHdvcmsgcmVxdWVzdCBhbmQgZGlzYWJsZXMgc2F2ZSBidXR0b24KCiAgICAgICAgdmFyIG5ld0RvYyA9IF9vYmplY3RTcHJlYWQoe30sIGRvYywgewogICAgICAgICAgaWQ6IGlkCiAgICAgICAgfSk7CgogICAgICAgIHNldFN0YXRlKGZ1bmN0aW9uIChzKSB7CiAgICAgICAgICByZXR1cm4gX29iamVjdFNwcmVhZCh7fSwgcywgewogICAgICAgICAgICBpc1NhdmVNb2RhbFZpc2libGU6IGZhbHNlLAogICAgICAgICAgICBwZXJzaXN0ZWREb2M6IG5ld0RvYywKICAgICAgICAgICAgbGFzdEtub3duRG9jOiBuZXdEb2MKICAgICAgICAgIH0pOwogICAgICAgIH0pOwoKICAgICAgICBpZiAoZG9jSWQgIT09IGlkKSB7CiAgICAgICAgICByZWRpcmVjdFRvKGlkKTsKICAgICAgICB9CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGUKICAgICAgICBjb25zb2xlLmRpcihlKTsKICAgICAgICAoMCwgX2xlbnNfdWlfdGVsZW1ldHJ5LnRyYWNrVWlFdmVudCkoJ3NhdmVfZmFpbGVkJyk7CiAgICAgICAgY29yZS5ub3RpZmljYXRpb25zLnRvYXN0cy5hZGREYW5nZXIoX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLmxlbnMuYXBwLmRvY1NhdmluZ0Vycm9yJywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdFcnJvciBzYXZpbmcgZG9jdW1lbnQnCiAgICAgICAgfSkpOwogICAgICAgIHNldFN0YXRlKGZ1bmN0aW9uIChzKSB7CiAgICAgICAgICByZXR1cm4gX29iamVjdFNwcmVhZCh7fSwgcywgewogICAgICAgICAgICBpc1NhdmVNb2RhbFZpc2libGU6IGZhbHNlCiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgb25DbG9zZTogZnVuY3Rpb24gb25DbG9zZSgpIHsKICAgICAgcmV0dXJuIHNldFN0YXRlKGZ1bmN0aW9uIChzKSB7CiAgICAgICAgcmV0dXJuIF9vYmplY3RTcHJlYWQoe30sIHMsIHsKICAgICAgICAgIGlzU2F2ZU1vZGFsVmlzaWJsZTogZmFsc2UKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgdGl0bGU6IGxhc3RLbm93bkRvYy50aXRsZSB8fCAnJywKICAgIHNob3dDb3B5T25TYXZlOiAhYWRkVG9EYXNoYm9hcmRNb2RlLAogICAgb2JqZWN0VHlwZTogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLmxlbnMuYXBwLnNhdmVNb2RhbFR5cGUnLCB7CiAgICAgIGRlZmF1bHRNZXNzYWdlOiAnTGVucyB2aXN1YWxpemF0aW9uJwogICAgfSksCiAgICBjb25maXJtQnV0dG9uTGFiZWw6IGNvbmZpcm1CdXR0b24KICB9KSkpOwp9CgpmdW5jdGlvbiBnZXRBbGxJbmRleFBhdHRlcm5zKGlkcywgaW5kZXhQYXR0ZXJuc1NlcnZpY2UsIG5vdGlmaWNhdGlvbnMpIHsKICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmFzeW5jKGZ1bmN0aW9uIGdldEFsbEluZGV4UGF0dGVybnMkKF9jb250ZXh0KSB7CiAgICB3aGlsZSAoMSkgewogICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgX2NvbnRleHQucHJldiA9IDA7CiAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMzsKICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAoUHJvbWlzZS5hbGwoaWRzLm1hcChmdW5jdGlvbiAoX3JlZjUpIHsKICAgICAgICAgICAgdmFyIGlkID0gX3JlZjUuaWQ7CiAgICAgICAgICAgIHJldHVybiBpbmRleFBhdHRlcm5zU2VydmljZS5nZXQoaWQpOwogICAgICAgICAgfSkpKTsKCiAgICAgICAgY2FzZSAzOgogICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgX2NvbnRleHQuc2VudCk7CgogICAgICAgIGNhc2UgNjoKICAgICAgICAgIF9jb250ZXh0LnByZXYgPSA2OwogICAgICAgICAgX2NvbnRleHQudDAgPSBfY29udGV4dFsiY2F0Y2giXSgwKTsKICAgICAgICAgIG5vdGlmaWNhdGlvbnMudG9hc3RzLmFkZERhbmdlcihfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subGVucy5hcHAuaW5kZXhQYXR0ZXJuTG9hZGluZ0Vycm9yJywgewogICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0Vycm9yIGxvYWRpbmcgaW5kZXggcGF0dGVybnMnCiAgICAgICAgICB9KSk7CiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoX2NvbnRleHQudDApOwoKICAgICAgICBjYXNlIDEwOgogICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICB9CiAgICB9CiAgfSwgbnVsbCwgbnVsbCwgW1swLCA2XV0pOwp9"},null]}