{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/infra/public/components/logging/log_minimap/log_minimap.js","dependencies":[{"path":"x-pack/legacy/plugins/infra/public/components/logging/log_minimap/log_minimap.js","mtime":1585205044621},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiKSB7IF90eXBlb2YyID0gZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mMiA9IGZ1bmN0aW9uIF90eXBlb2YyKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mMihvYmopOyB9CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuTG9nTWluaW1hcCA9IHZvaWQgMDsKCnZhciBfZDNTY2FsZSA9IHJlcXVpcmUoImQzLXNjYWxlIik7Cgp2YXIgUmVhY3QgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKCJyZWFjdCIpKTsKCnZhciBfZXVpX3N0eWxlZF9jb21wb25lbnRzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCIuLi8uLi8uLi8uLi8uLi8uLi9jb21tb24vZXVpX3N0eWxlZF9jb21wb25lbnRzIikpOwoKdmFyIF9kZW5zaXR5X2NoYXJ0ID0gcmVxdWlyZSgiLi9kZW5zaXR5X2NoYXJ0Iik7Cgp2YXIgX2hpZ2hsaWdodGVkX2ludGVydmFsID0gcmVxdWlyZSgiLi9oaWdobGlnaHRlZF9pbnRlcnZhbCIpOwoKdmFyIF9zZWFyY2hfbWFya2VycyA9IHJlcXVpcmUoIi4vc2VhcmNoX21hcmtlcnMiKTsKCnZhciBfdGltZV9ydWxlciA9IHJlcXVpcmUoIi4vdGltZV9ydWxlciIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsKICByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogewogICAgZGVmYXVsdDogb2JqCiAgfTsKfQoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7CiAgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgewogICAgcmV0dXJuIG9iajsKICB9IGVsc2UgewogICAgdmFyIG5ld09iaiA9IHt9OwoKICAgIGlmIChvYmogIT0gbnVsbCkgewogICAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7CiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHsKICAgICAgICAgIHZhciBkZXNjID0gT2JqZWN0LmRlZmluZVByb3BlcnR5ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KSA6IHt9OwoKICAgICAgICAgIGlmIChkZXNjLmdldCB8fCBkZXNjLnNldCkgewogICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobmV3T2JqLCBrZXksIGRlc2MpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBuZXdPYmouZGVmYXVsdCA9IG9iajsKICAgIHJldHVybiBuZXdPYmo7CiAgfQp9CgpmdW5jdGlvbiBfdHlwZW9mKG9iaikgewogIGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIF90eXBlb2YyKFN5bWJvbC5pdGVyYXRvcikgPT09ICJzeW1ib2wiKSB7CiAgICBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsKICAgICAgcmV0dXJuIF90eXBlb2YyKG9iaik7CiAgICB9OwogIH0gZWxzZSB7CiAgICBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsKICAgICAgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogX3R5cGVvZjIob2JqKTsKICAgIH07CiAgfQoKICByZXR1cm4gX3R5cGVvZihvYmopOwp9CgpmdW5jdGlvbiBfdGVtcGxhdGVPYmplY3Q0KCkgewogIHZhciBkYXRhID0gX3RhZ2dlZFRlbXBsYXRlTGl0ZXJhbChbIlxuICBiYWNrZ3JvdW5kOiAiLCAiO1xuICAmICIsICIge1xuICAgIHZpc2liaWxpdHk6IGhpZGRlbjtcbiAgfVxuICAmOmhvdmVyICIsICIge1xuICAgIHZpc2liaWxpdHk6IHZpc2libGU7XG4gIH1cbiJdKTsKCiAgX3RlbXBsYXRlT2JqZWN0NCA9IGZ1bmN0aW9uIF90ZW1wbGF0ZU9iamVjdDQoKSB7CiAgICByZXR1cm4gZGF0YTsKICB9OwoKICByZXR1cm4gZGF0YTsKfQoKZnVuY3Rpb24gX3RlbXBsYXRlT2JqZWN0MygpIHsKICB2YXIgZGF0YSA9IF90YWdnZWRUZW1wbGF0ZUxpdGVyYWwoWyJcbiAgcG9pbnRlci1ldmVudHM6IG5vbmU7XG4gIHN0cm9rZS13aWR0aDogMXB4O1xuICBzdHJva2U6ICIsICI7XG4iXSk7CgogIF90ZW1wbGF0ZU9iamVjdDMgPSBmdW5jdGlvbiBfdGVtcGxhdGVPYmplY3QzKCkgewogICAgcmV0dXJuIGRhdGE7CiAgfTsKCiAgcmV0dXJuIGRhdGE7Cn0KCmZ1bmN0aW9uIF90ZW1wbGF0ZU9iamVjdDIoKSB7CiAgdmFyIGRhdGEgPSBfdGFnZ2VkVGVtcGxhdGVMaXRlcmFsKFsiXG4gIHN0cm9rZTogIiwgIjtcbiAgc3Ryb2tlLXdpZHRoOiAxcHg7XG4iXSk7CgogIF90ZW1wbGF0ZU9iamVjdDIgPSBmdW5jdGlvbiBfdGVtcGxhdGVPYmplY3QyKCkgewogICAgcmV0dXJuIGRhdGE7CiAgfTsKCiAgcmV0dXJuIGRhdGE7Cn0KCmZ1bmN0aW9uIF90ZW1wbGF0ZU9iamVjdCgpIHsKICB2YXIgZGF0YSA9IF90YWdnZWRUZW1wbGF0ZUxpdGVyYWwoWyJcbiAgZmlsbDogdHJhbnNwYXJlbnQ7XG4gIGN1cnNvcjogIiwgIjtcbiJdKTsKCiAgX3RlbXBsYXRlT2JqZWN0ID0gZnVuY3Rpb24gX3RlbXBsYXRlT2JqZWN0KCkgewogICAgcmV0dXJuIGRhdGE7CiAgfTsKCiAgcmV0dXJuIGRhdGE7Cn0KCmZ1bmN0aW9uIF90YWdnZWRUZW1wbGF0ZUxpdGVyYWwoc3RyaW5ncywgcmF3KSB7CiAgaWYgKCFyYXcpIHsKICAgIHJhdyA9IHN0cmluZ3Muc2xpY2UoMCk7CiAgfQoKICByZXR1cm4gT2JqZWN0LmZyZWV6ZShPYmplY3QuZGVmaW5lUHJvcGVydGllcyhzdHJpbmdzLCB7CiAgICByYXc6IHsKICAgICAgdmFsdWU6IE9iamVjdC5mcmVlemUocmF3KQogICAgfQogIH0pKTsKfQoKZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7CiAgcmV0dXJuIF9hcnJheVdpdGhIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHx8IF9ub25JdGVyYWJsZVJlc3QoKTsKfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlUmVzdCgpIHsKICB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7Cn0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHsKICB2YXIgX2FyciA9IFtdOwogIHZhciBfbiA9IHRydWU7CiAgdmFyIF9kID0gZmFsc2U7CiAgdmFyIF9lID0gdW5kZWZpbmVkOwoKICB0cnkgewogICAgZm9yICh2YXIgX2kgPSBhcnJbU3ltYm9sLml0ZXJhdG9yXSgpLCBfczsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSkgewogICAgICBfYXJyLnB1c2goX3MudmFsdWUpOwoKICAgICAgaWYgKGkgJiYgX2Fyci5sZW5ndGggPT09IGkpIGJyZWFrOwogICAgfQogIH0gY2F0Y2ggKGVycikgewogICAgX2QgPSB0cnVlOwogICAgX2UgPSBlcnI7CiAgfSBmaW5hbGx5IHsKICAgIHRyeSB7CiAgICAgIGlmICghX24gJiYgX2lbInJldHVybiJdICE9IG51bGwpIF9pWyJyZXR1cm4iXSgpOwogICAgfSBmaW5hbGx5IHsKICAgICAgaWYgKF9kKSB0aHJvdyBfZTsKICAgIH0KICB9CgogIHJldHVybiBfYXJyOwp9CgpmdW5jdGlvbiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsKfQoKZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7CiAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOwoKICBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgewogICAgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7CiAgICBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7CiAgICAgIHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOwogICAgfSk7CiAgICBrZXlzLnB1c2guYXBwbHkoa2V5cywgc3ltYm9scyk7CiAgfQoKICByZXR1cm4ga2V5czsKfQoKZnVuY3Rpb24gX29iamVjdFNwcmVhZCh0YXJnZXQpIHsKICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgewogICAgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXSAhPSBudWxsID8gYXJndW1lbnRzW2ldIDoge307CgogICAgaWYgKGkgJSAyKSB7CiAgICAgIG93bktleXMoc291cmNlLCB0cnVlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsKICAgICAgfSk7CiAgICB9IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKSB7CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoc291cmNlKSk7CiAgICB9IGVsc2UgewogICAgICBvd25LZXlzKHNvdXJjZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwga2V5KSk7CiAgICAgIH0pOwogICAgfQogIH0KCiAgcmV0dXJuIHRhcmdldDsKfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgewogIGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsKICB9Cn0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsKICBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOwogICAgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOwogICAgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOwogICAgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7CiAgfQp9CgpmdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7CiAgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7CiAgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOwogIHJldHVybiBDb25zdHJ1Y3RvcjsKfQoKZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgewogIGlmIChjYWxsICYmIChfdHlwZW9mKGNhbGwpID09PSAib2JqZWN0IiB8fCB0eXBlb2YgY2FsbCA9PT0gImZ1bmN0aW9uIikpIHsKICAgIHJldHVybiBjYWxsOwogIH0KCiAgcmV0dXJuIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZik7Cn0KCmZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7CiAgX2dldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LmdldFByb3RvdHlwZU9mIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsKICAgIHJldHVybiBvLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2Yobyk7CiAgfTsKICByZXR1cm4gX2dldFByb3RvdHlwZU9mKG8pOwp9CgpmdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsKICBpZiAoc2VsZiA9PT0gdm9pZCAwKSB7CiAgICB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOwogIH0KCiAgcmV0dXJuIHNlbGY7Cn0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgewogIGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiIpOwogIH0KCiAgc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7CiAgICBjb25zdHJ1Y3RvcjogewogICAgICB2YWx1ZTogc3ViQ2xhc3MsCiAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICBjb25maWd1cmFibGU6IHRydWUKICAgIH0KICB9KTsKICBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTsKfQoKZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsKICBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsKICAgIG8uX19wcm90b19fID0gcDsKICAgIHJldHVybiBvOwogIH07CgogIHJldHVybiBfc2V0UHJvdG90eXBlT2YobywgcCk7Cn0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsKICBpZiAoa2V5IGluIG9iaikgewogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7CiAgICAgIHZhbHVlOiB2YWx1ZSwKICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICB3cml0YWJsZTogdHJ1ZQogICAgfSk7CiAgfSBlbHNlIHsKICAgIG9ialtrZXldID0gdmFsdWU7CiAgfQoKICByZXR1cm4gb2JqOwp9CgpmdW5jdGlvbiBjYWxjdWxhdGVZU2NhbGUodGFyZ2V0LCBoZWlnaHQsIGludGVydmFsU2l6ZSkgewogIHZhciBkb21haW5TdGFydCA9IHRhcmdldCA/IHRhcmdldCAtIGludGVydmFsU2l6ZSAvIDIgOiAwOwogIHZhciBkb21haW5FbmQgPSB0YXJnZXQgPyB0YXJnZXQgKyBpbnRlcnZhbFNpemUgLyAyIDogMDsKICByZXR1cm4gKDAsIF9kM1NjYWxlLnNjYWxlTGluZWFyKSgpLmRvbWFpbihbZG9tYWluU3RhcnQsIGRvbWFpbkVuZF0pLnJhbmdlKFswLCBoZWlnaHRdKTsKfQoKdmFyIExvZ01pbmltYXAgPQovKiNfX1BVUkVfXyovCmZ1bmN0aW9uIChfUmVhY3QkQ29tcG9uZW50KSB7CiAgX2luaGVyaXRzKExvZ01pbmltYXAsIF9SZWFjdCRDb21wb25lbnQpOwoKICBmdW5jdGlvbiBMb2dNaW5pbWFwKHByb3BzKSB7CiAgICB2YXIgX3RoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIExvZ01pbmltYXApOwoKICAgIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgX2dldFByb3RvdHlwZU9mKExvZ01pbmltYXApLmNhbGwodGhpcywgcHJvcHMpKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJkcmFnVGFyZ2V0QXJlYSIsIG51bGwpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImhhbmRsZUNsaWNrIiwgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgIGlmICghX3RoaXMuZHJhZ1RhcmdldEFyZWEpIHJldHVybjsKCiAgICAgIHZhciBzdmdQb3NpdGlvbiA9IF90aGlzLmRyYWdUYXJnZXRBcmVhLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwoKICAgICAgdmFyIGNsaWNrZWRZUG9zaXRpb24gPSBldmVudC5jbGllbnRZIC0gc3ZnUG9zaXRpb24udG9wOwogICAgICB2YXIgY2xpY2tlZFRpbWUgPSBNYXRoLmZsb29yKF90aGlzLmdldFlTY2FsZSgpLmludmVydChjbGlja2VkWVBvc2l0aW9uKSk7CgogICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgZHJhZzogbnVsbAogICAgICB9KTsKCiAgICAgIF90aGlzLnByb3BzLmp1bXBUb1RhcmdldCh7CiAgICAgICAgdGllYnJlYWtlcjogMCwKICAgICAgICB0aW1lOiBjbGlja2VkVGltZQogICAgICB9KTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImhhbmRsZU1vdXNlRG93biIsIGZ1bmN0aW9uIChldmVudCkgewogICAgICB2YXIgY2xpZW50WSA9IGV2ZW50LmNsaWVudFksCiAgICAgICAgICB0YXJnZXQgPSBldmVudC50YXJnZXQ7CgogICAgICBpZiAodGFyZ2V0ID09PSBfdGhpcy5kcmFnVGFyZ2V0QXJlYSkgewogICAgICAgIHZhciBzdmdQb3NpdGlvbiA9IGV2ZW50LmN1cnJlbnRUYXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CgogICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgIGRyYWc6IHsKICAgICAgICAgICAgc3RhcnRZOiBjbGllbnRZLAogICAgICAgICAgICBjdXJyZW50WTogbnVsbAogICAgICAgICAgfSwKICAgICAgICAgIHN2Z1Bvc2l0aW9uOiBzdmdQb3NpdGlvbgogICAgICAgIH0pOwoKICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgX3RoaXMuaGFuZGxlRHJhZ01vdmUpOwogICAgICB9CgogICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIF90aGlzLmhhbmRsZU1vdXNlVXApOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiaGFuZGxlTW91c2VVcCIsIGZ1bmN0aW9uIChldmVudCkgewogICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgX3RoaXMuaGFuZGxlRHJhZ01vdmUpOwogICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIF90aGlzLmhhbmRsZU1vdXNlVXApOwogICAgICB2YXIgX3RoaXMkc3RhdGUgPSBfdGhpcy5zdGF0ZSwKICAgICAgICAgIGRyYWcgPSBfdGhpcyRzdGF0ZS5kcmFnLAogICAgICAgICAgc3ZnUG9zaXRpb24gPSBfdGhpcyRzdGF0ZS5zdmdQb3NpdGlvbjsKCiAgICAgIGlmICghZHJhZyB8fCAhZHJhZy5jdXJyZW50WSkgewogICAgICAgIF90aGlzLmhhbmRsZUNsaWNrKGV2ZW50KTsKCiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgZ2V0VGltZSA9IGZ1bmN0aW9uIGdldFRpbWUocG9zKSB7CiAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoX3RoaXMuZ2V0WVNjYWxlKCkuaW52ZXJ0KHBvcykpOwogICAgICB9OwoKICAgICAgdmFyIHN0YXJ0WVBvc2l0aW9uID0gZHJhZy5zdGFydFkgLSBzdmdQb3NpdGlvbi50b3A7CiAgICAgIHZhciBlbmRZUG9zaXRpb24gPSBldmVudC5jbGllbnRZIC0gc3ZnUG9zaXRpb24udG9wOwogICAgICB2YXIgc3RhcnRUaW1lID0gZ2V0VGltZShzdGFydFlQb3NpdGlvbik7CiAgICAgIHZhciBlbmRUaW1lID0gZ2V0VGltZShlbmRZUG9zaXRpb24pOwogICAgICB2YXIgdGltZURpZmZlcmVuY2UgPSBlbmRUaW1lIC0gc3RhcnRUaW1lOwogICAgICB2YXIgbmV3VGltZSA9IChfdGhpcy5wcm9wcy50YXJnZXQgfHwgMCkgLSB0aW1lRGlmZmVyZW5jZTsKCiAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICBkcmFnOiBudWxsLAogICAgICAgIHRhcmdldDogbmV3VGltZQogICAgICB9KTsKCiAgICAgIF90aGlzLnByb3BzLmp1bXBUb1RhcmdldCh7CiAgICAgICAgdGllYnJlYWtlcjogMCwKICAgICAgICB0aW1lOiBuZXdUaW1lCiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiaGFuZGxlRHJhZ01vdmUiLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgdmFyIGRyYWcgPSBfdGhpcy5zdGF0ZS5kcmFnOwogICAgICBpZiAoIWRyYWcpIHJldHVybjsKCiAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICBkcmFnOiBfb2JqZWN0U3ByZWFkKHt9LCBkcmFnLCB7CiAgICAgICAgICBjdXJyZW50WTogZXZlbnQuY2xpZW50WQogICAgICAgIH0pCiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiZ2V0WVNjYWxlIiwgZnVuY3Rpb24gKCkgewogICAgICB2YXIgdGFyZ2V0ID0gX3RoaXMuc3RhdGUudGFyZ2V0OwogICAgICB2YXIgX3RoaXMkcHJvcHMgPSBfdGhpcy5wcm9wcywKICAgICAgICAgIGhlaWdodCA9IF90aGlzJHByb3BzLmhlaWdodCwKICAgICAgICAgIGludGVydmFsU2l6ZSA9IF90aGlzJHByb3BzLmludGVydmFsU2l6ZTsKICAgICAgcmV0dXJuIGNhbGN1bGF0ZVlTY2FsZSh0YXJnZXQsIGhlaWdodCwgaW50ZXJ2YWxTaXplKTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImdldFBvc2l0aW9uT2ZUaW1lIiwgZnVuY3Rpb24gKHRpbWUpIHsKICAgICAgdmFyIF90aGlzJHByb3BzMiA9IF90aGlzLnByb3BzLAogICAgICAgICAgaGVpZ2h0ID0gX3RoaXMkcHJvcHMyLmhlaWdodCwKICAgICAgICAgIGludGVydmFsU2l6ZSA9IF90aGlzJHByb3BzMi5pbnRlcnZhbFNpemU7CgogICAgICB2YXIgX3RoaXMkZ2V0WVNjYWxlJGRvbWFpID0gX3RoaXMuZ2V0WVNjYWxlKCkuZG9tYWluKCksCiAgICAgICAgICBfdGhpcyRnZXRZU2NhbGUkZG9tYWkyID0gX3NsaWNlZFRvQXJyYXkoX3RoaXMkZ2V0WVNjYWxlJGRvbWFpLCAxKSwKICAgICAgICAgIG1pblRpbWUgPSBfdGhpcyRnZXRZU2NhbGUkZG9tYWkyWzBdOwoKICAgICAgcmV0dXJuICh0aW1lIC0gbWluVGltZSkgKiBoZWlnaHQgLyBpbnRlcnZhbFNpemU7IC8vCiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJ1cGRhdGVUaW1lQ3Vyc29yIiwgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgIHZhciBzdmdQb3NpdGlvbiA9IGV2ZW50LmN1cnJlbnRUYXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgIHZhciB0aW1lQ3Vyc29yWSA9IGV2ZW50LmNsaWVudFkgLSBzdmdQb3NpdGlvbi50b3A7CgogICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgdGltZUN1cnNvclk6IHRpbWVDdXJzb3JZCiAgICAgIH0pOwogICAgfSk7CgogICAgX3RoaXMuc3RhdGUgPSB7CiAgICAgIHRpbWVDdXJzb3JZOiAwLAogICAgICB0YXJnZXQ6IHByb3BzLnRhcmdldCwKICAgICAgZHJhZzogbnVsbCwKICAgICAgc3ZnUG9zaXRpb246IHsKICAgICAgICB3aWR0aDogMCwKICAgICAgICBoZWlnaHQ6IDAsCiAgICAgICAgdG9wOiAwLAogICAgICAgIHJpZ2h0OiAwLAogICAgICAgIGJvdHRvbTogMCwKICAgICAgICBsZWZ0OiAwCiAgICAgIH0KICAgIH07CiAgICByZXR1cm4gX3RoaXM7CiAgfQoKICBfY3JlYXRlQ2xhc3MoTG9nTWluaW1hcCwgW3sKICAgIGtleTogInJlbmRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHZhciBfdGhpcyRwcm9wczMgPSB0aGlzLnByb3BzLAogICAgICAgICAgY2xhc3NOYW1lID0gX3RoaXMkcHJvcHMzLmNsYXNzTmFtZSwKICAgICAgICAgIGhlaWdodCA9IF90aGlzJHByb3BzMy5oZWlnaHQsCiAgICAgICAgICBoaWdobGlnaHRlZEludGVydmFsID0gX3RoaXMkcHJvcHMzLmhpZ2hsaWdodGVkSW50ZXJ2YWwsCiAgICAgICAgICBqdW1wVG9UYXJnZXQgPSBfdGhpcyRwcm9wczMuanVtcFRvVGFyZ2V0LAogICAgICAgICAgc3VtbWFyeUJ1Y2tldHMgPSBfdGhpcyRwcm9wczMuc3VtbWFyeUJ1Y2tldHMsCiAgICAgICAgICBzdW1tYXJ5SGlnaGxpZ2h0QnVja2V0cyA9IF90aGlzJHByb3BzMy5zdW1tYXJ5SGlnaGxpZ2h0QnVja2V0cywKICAgICAgICAgIHdpZHRoID0gX3RoaXMkcHJvcHMzLndpZHRoLAogICAgICAgICAgaW50ZXJ2YWxTaXplID0gX3RoaXMkcHJvcHMzLmludGVydmFsU2l6ZTsKICAgICAgdmFyIF90aGlzJHN0YXRlMiA9IHRoaXMuc3RhdGUsCiAgICAgICAgICB0aW1lQ3Vyc29yWSA9IF90aGlzJHN0YXRlMi50aW1lQ3Vyc29yWSwKICAgICAgICAgIGRyYWcgPSBfdGhpcyRzdGF0ZTIuZHJhZywKICAgICAgICAgIHRhcmdldCA9IF90aGlzJHN0YXRlMi50YXJnZXQ7IC8vIFJlbmRlciB0aGUgdGltZSBydWxlciBhbmQgZGVuc2l0eSBtYXAgYmV5b25kIHRoZSB2aXNpYmxlIHJhbmdlIG9mIHRpbWUsIHNvIHRoYXQKICAgICAgLy8gdGhlIHVzZXIgZG9lc24ndCBydW4gb3V0IG9mIHJ1bGVyIHdoZW4gdGhleSBjbGljayBhbmQgZHJhZwoKICAgICAgdmFyIG92ZXJzY2FuSGVpZ2h0ID0gTWF0aC5yb3VuZCh3aW5kb3cuc2NyZWVuLmF2YWlsSGVpZ2h0ICogMi41KSB8fCBoZWlnaHQgKiAzOwoKICAgICAgdmFyIF9jYWxjdWxhdGVZU2NhbGUkZG9tYSA9IGNhbGN1bGF0ZVlTY2FsZSh0YXJnZXQsIG92ZXJzY2FuSGVpZ2h0LCBpbnRlcnZhbFNpemUgKiAob3ZlcnNjYW5IZWlnaHQgLyBoZWlnaHQpKS5kb21haW4oKSwKICAgICAgICAgIF9jYWxjdWxhdGVZU2NhbGUkZG9tYTIgPSBfc2xpY2VkVG9BcnJheShfY2FsY3VsYXRlWVNjYWxlJGRvbWEsIDIpLAogICAgICAgICAgbWluVGltZSA9IF9jYWxjdWxhdGVZU2NhbGUkZG9tYTJbMF0sCiAgICAgICAgICBtYXhUaW1lID0gX2NhbGN1bGF0ZVlTY2FsZSRkb21hMlsxXTsKCiAgICAgIHZhciB0aWNrQ291bnQgPSBoZWlnaHQgPyBNYXRoLnJvdW5kKG92ZXJzY2FuSGVpZ2h0IC8gaGVpZ2h0ICogMTQ0KSA6IDEyOwogICAgICB2YXIgb3ZlcnNjYW5UcmFuc2xhdGUgPSBoZWlnaHQgPyAtKG92ZXJzY2FuSGVpZ2h0IC0gaGVpZ2h0KSAvIDIgOiAwOwogICAgICB2YXIgZHJhZ1RyYW5zZm9ybSA9ICFkcmFnIHx8ICFkcmFnLmN1cnJlbnRZID8gMCA6IGRyYWcuY3VycmVudFkgLSBkcmFnLnN0YXJ0WTsKICAgICAgcmV0dXJuIFJlYWN0LmNyZWF0ZUVsZW1lbnQoTWluaW1hcFdyYXBwZXIsIHsKICAgICAgICBjbGFzc05hbWU6IGNsYXNzTmFtZSwKICAgICAgICBoZWlnaHQ6IGhlaWdodCwKICAgICAgICBwcmVzZXJ2ZUFzcGVjdFJhdGlvOiAibm9uZSIsCiAgICAgICAgdmlld0JveDogIjAgMCAiLmNvbmNhdCh3aWR0aCwgIiAiKS5jb25jYXQoaGVpZ2h0KSwKICAgICAgICB3aWR0aDogd2lkdGgsCiAgICAgICAgb25Nb3VzZURvd246IHRoaXMuaGFuZGxlTW91c2VEb3duLAogICAgICAgIG9uTW91c2VNb3ZlOiB0aGlzLnVwZGF0ZVRpbWVDdXJzb3IsCiAgICAgICAgc2hvd092ZXJzY2FuQm91bmRhcmllczogQm9vbGVhbihoZWlnaHQgJiYgc3VtbWFyeUJ1Y2tldHMubGVuZ3RoKQogICAgICB9LCBSZWFjdC5jcmVhdGVFbGVtZW50KCJnIiwgewogICAgICAgIHRyYW5zZm9ybTogInRyYW5zbGF0ZSgwLCAiLmNvbmNhdChkcmFnVHJhbnNmb3JtICsgb3ZlcnNjYW5UcmFuc2xhdGUsICIpIikKICAgICAgfSwgUmVhY3QuY3JlYXRlRWxlbWVudChfZGVuc2l0eV9jaGFydC5EZW5zaXR5Q2hhcnQsIHsKICAgICAgICBidWNrZXRzOiBzdW1tYXJ5QnVja2V0cywKICAgICAgICBzdGFydDogbWluVGltZSwKICAgICAgICBlbmQ6IG1heFRpbWUsCiAgICAgICAgd2lkdGg6IHdpZHRoLAogICAgICAgIGhlaWdodDogb3ZlcnNjYW5IZWlnaHQKICAgICAgfSksIFJlYWN0LmNyZWF0ZUVsZW1lbnQoTWluaW1hcEJvcmRlciwgewogICAgICAgIHgxOiB3aWR0aCAvIDMsCiAgICAgICAgeTE6IDAsCiAgICAgICAgeDI6IHdpZHRoIC8gMywKICAgICAgICB5Mjogb3ZlcnNjYW5IZWlnaHQKICAgICAgfSksIFJlYWN0LmNyZWF0ZUVsZW1lbnQoX3RpbWVfcnVsZXIuVGltZVJ1bGVyLCB7CiAgICAgICAgc3RhcnQ6IG1pblRpbWUsCiAgICAgICAgZW5kOiBtYXhUaW1lLAogICAgICAgIHdpZHRoOiB3aWR0aCwKICAgICAgICBoZWlnaHQ6IG92ZXJzY2FuSGVpZ2h0LAogICAgICAgIHRpY2tDb3VudDogdGlja0NvdW50CiAgICAgIH0pLCBSZWFjdC5jcmVhdGVFbGVtZW50KF9zZWFyY2hfbWFya2Vycy5TZWFyY2hNYXJrZXJzLCB7CiAgICAgICAgYnVja2V0czogc3VtbWFyeUhpZ2hsaWdodEJ1Y2tldHMgfHwgW10sCiAgICAgICAgc3RhcnQ6IG1pblRpbWUsCiAgICAgICAgZW5kOiBtYXhUaW1lLAogICAgICAgIHdpZHRoOiB3aWR0aCwKICAgICAgICBoZWlnaHQ6IG92ZXJzY2FuSGVpZ2h0LAogICAgICAgIGp1bXBUb1RhcmdldDoganVtcFRvVGFyZ2V0CiAgICAgIH0pKSwgaGlnaGxpZ2h0ZWRJbnRlcnZhbCA/IFJlYWN0LmNyZWF0ZUVsZW1lbnQoX2hpZ2hsaWdodGVkX2ludGVydmFsLkhpZ2hsaWdodGVkSW50ZXJ2YWwsIHsKICAgICAgICBlbmQ6IGhpZ2hsaWdodGVkSW50ZXJ2YWwuZW5kLAogICAgICAgIGdldFBvc2l0aW9uT2ZUaW1lOiB0aGlzLmdldFBvc2l0aW9uT2ZUaW1lLAogICAgICAgIHN0YXJ0OiBoaWdobGlnaHRlZEludGVydmFsLnN0YXJ0LAogICAgICAgIHdpZHRoOiB3aWR0aCwKICAgICAgICB0YXJnZXQ6IHRhcmdldAogICAgICB9KSA6IG51bGwsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoVGltZUN1cnNvciwgewogICAgICAgIHgxOiB3aWR0aCAvIDMsCiAgICAgICAgeDI6IHdpZHRoLAogICAgICAgIHkxOiB0aW1lQ3Vyc29yWSwKICAgICAgICB5MjogdGltZUN1cnNvclkKICAgICAgfSksIFJlYWN0LmNyZWF0ZUVsZW1lbnQoRHJhZ1RhcmdldEFyZWEsIHsKICAgICAgICBpc0dyYWJiaW5nOiBCb29sZWFuKGRyYWcpLAogICAgICAgIHJlZjogZnVuY3Rpb24gcmVmKG5vZGUpIHsKICAgICAgICAgIF90aGlzMi5kcmFnVGFyZ2V0QXJlYSA9IG5vZGU7CiAgICAgICAgfSwKICAgICAgICB4OiAwLAogICAgICAgIHk6IDAsCiAgICAgICAgd2lkdGg6IHdpZHRoIC8gMywKICAgICAgICBoZWlnaHQ6IGhlaWdodAogICAgICB9KSk7CiAgICB9CiAgfV0sIFt7CiAgICBrZXk6ICJnZXREZXJpdmVkU3RhdGVGcm9tUHJvcHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldERlcml2ZWRTdGF0ZUZyb21Qcm9wcyhfcmVmLCBfcmVmMikgewogICAgICB2YXIgdGFyZ2V0ID0gX3JlZi50YXJnZXQ7CiAgICAgIHZhciBkcmFnID0gX3JlZjIuZHJhZzsKCiAgICAgIGlmICghZHJhZykgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICB0YXJnZXQ6IHRhcmdldAogICAgICAgIH07CiAgICAgIH0KCiAgICAgIHJldHVybiBudWxsOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIExvZ01pbmltYXA7Cn0oUmVhY3QuQ29tcG9uZW50KTsKCmV4cG9ydHMuTG9nTWluaW1hcCA9IExvZ01pbmltYXA7Cgp2YXIgRHJhZ1RhcmdldEFyZWEgPSBfZXVpX3N0eWxlZF9jb21wb25lbnRzLmRlZmF1bHQucmVjdChfdGVtcGxhdGVPYmplY3QoKSwgZnVuY3Rpb24gKF9yZWYzKSB7CiAgdmFyIGlzR3JhYmJpbmcgPSBfcmVmMy5pc0dyYWJiaW5nOwogIHJldHVybiBpc0dyYWJiaW5nID8gJ2dyYWJiaW5nJyA6ICdncmFiJzsKfSk7Cgp2YXIgTWluaW1hcEJvcmRlciA9IF9ldWlfc3R5bGVkX2NvbXBvbmVudHMuZGVmYXVsdC5saW5lKF90ZW1wbGF0ZU9iamVjdDIoKSwgZnVuY3Rpb24gKHByb3BzKSB7CiAgcmV0dXJuIHByb3BzLnRoZW1lLmV1aS5ldWlDb2xvck1lZGl1bVNoYWRlOwp9KTsKCnZhciBUaW1lQ3Vyc29yID0gX2V1aV9zdHlsZWRfY29tcG9uZW50cy5kZWZhdWx0LmxpbmUoX3RlbXBsYXRlT2JqZWN0MygpLCBmdW5jdGlvbiAocHJvcHMpIHsKICByZXR1cm4gcHJvcHMudGhlbWUuZGFya01vZGUgPyBwcm9wcy50aGVtZS5ldWkuZXVpQ29sb3JEYXJrZXN0U2hhZGUgOiBwcm9wcy50aGVtZS5ldWkuZXVpQ29sb3JEYXJrU2hhZGU7Cn0pOwoKdmFyIE1pbmltYXBXcmFwcGVyID0gX2V1aV9zdHlsZWRfY29tcG9uZW50cy5kZWZhdWx0LnN2ZyhfdGVtcGxhdGVPYmplY3Q0KCksIGZ1bmN0aW9uIChwcm9wcykgewogIHJldHVybiBwcm9wcy5zaG93T3ZlcnNjYW5Cb3VuZGFyaWVzID8gcHJvcHMudGhlbWUuZXVpLmV1aUNvbG9yTWVkaXVtU2hhZGUgOiAndHJhbnNwYXJlbnQnOwp9LCBUaW1lQ3Vyc29yLCBUaW1lQ3Vyc29yKTs="},null]}