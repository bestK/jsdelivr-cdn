{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/maps/public/layers/sources/es_search_source/update_source_editor.js","dependencies":[{"path":"x-pack/legacy/plugins/maps/public/layers/sources/es_search_source/update_source_editor.js","mtime":1585205045341},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLlVwZGF0ZVNvdXJjZUVkaXRvciA9IHZvaWQgMDsKCnZhciBfcmVhY3QgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKCJyZWFjdCIpKTsKCnZhciBfcHJvcFR5cGVzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJwcm9wLXR5cGVzIikpOwoKdmFyIF9ldWkgPSByZXF1aXJlKCJAZWxhc3RpYy9ldWkiKTsKCnZhciBfc2luZ2xlX2ZpZWxkX3NlbGVjdCA9IHJlcXVpcmUoIi4uLy4uLy4uL2NvbXBvbmVudHMvc2luZ2xlX2ZpZWxkX3NlbGVjdCIpOwoKdmFyIF90b29sdGlwX3NlbGVjdG9yID0gcmVxdWlyZSgiLi4vLi4vLi4vY29tcG9uZW50cy90b29sdGlwX3NlbGVjdG9yIik7Cgp2YXIgX2tpYmFuYV9zZXJ2aWNlcyA9IHJlcXVpcmUoIi4uLy4uLy4uL2tpYmFuYV9zZXJ2aWNlcyIpOwoKdmFyIF9pMThuID0gcmVxdWlyZSgiQGtibi9pMThuIik7Cgp2YXIgX2luZGV4X3BhdHRlcm5fdXRpbCA9IHJlcXVpcmUoIi4uLy4uLy4uL2luZGV4X3BhdHRlcm5fdXRpbCIpOwoKdmFyIF92YWxpZGF0ZWRfcmFuZ2UgPSByZXF1aXJlKCIuLi8uLi8uLi9jb21wb25lbnRzL3ZhbGlkYXRlZF9yYW5nZSIpOwoKdmFyIF9jb25zdGFudHMgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9jb21tb24vY29uc3RhbnRzIik7Cgp2YXIgX2VzX2RvY19maWVsZCA9IHJlcXVpcmUoIi4uLy4uL2ZpZWxkcy9lc19kb2NfZmllbGQiKTsKCnZhciBfcmVhY3QyID0gcmVxdWlyZSgiQGtibi9pMThuL3JlYWN0Iik7Cgp2YXIgX2xvYWRfaW5kZXhfc2V0dGluZ3MgPSByZXF1aXJlKCIuL2xvYWRfaW5kZXhfc2V0dGluZ3MiKTsKCnZhciBfcHVibGljID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vc3JjL3BsdWdpbnMvZGF0YS9wdWJsaWMiKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGVsc2UgeyB2YXIgbmV3T2JqID0ge307IGlmIChvYmogIT0gbnVsbCkgeyBmb3IgKHZhciBrZXkgaW4gb2JqKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7IHZhciBkZXNjID0gT2JqZWN0LmRlZmluZVByb3BlcnR5ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KSA6IHt9OyBpZiAoZGVzYy5nZXQgfHwgZGVzYy5zZXQpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5ld09iaiwga2V5LCBkZXNjKTsgfSBlbHNlIHsgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IH0gfSBuZXdPYmouZGVmYXVsdCA9IG9iajsgcmV0dXJuIG5ld09iajsgfSB9CgpmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyBpZiAodHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSAic3ltYm9sIikgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH07IH0gZWxzZSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mKG9iaik7IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0KCmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9CgpmdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmIChjYWxsICYmIChfdHlwZW9mKGNhbGwpID09PSAib2JqZWN0IiB8fCB0eXBlb2YgY2FsbCA9PT0gImZ1bmN0aW9uIikpIHsgcmV0dXJuIGNhbGw7IH0gcmV0dXJuIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZik7IH0KCmZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IF9nZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IHJldHVybiBvLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2Yobyk7IH07IHJldHVybiBfZ2V0UHJvdG90eXBlT2Yobyk7IH0KCmZ1bmN0aW9uIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZikgeyBpZiAoc2VsZiA9PT0gdm9pZCAwKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcigidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkIik7IH0gcmV0dXJuIHNlbGY7IH0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICJmdW5jdGlvbiIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiIpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcyk7IH0KCmZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IF9zZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBvLl9fcHJvdG9fXyA9IHA7IHJldHVybiBvOyB9OyByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApOyB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7IGlmIChrZXkgaW4gb2JqKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgeyB2YWx1ZTogdmFsdWUsIGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUgfSk7IH0gZWxzZSB7IG9ialtrZXldID0gdmFsdWU7IH0gcmV0dXJuIG9iajsgfQoKdmFyIFVwZGF0ZVNvdXJjZUVkaXRvciA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKF9Db21wb25lbnQpIHsKICBfaW5oZXJpdHMoVXBkYXRlU291cmNlRWRpdG9yLCBfQ29tcG9uZW50KTsKCiAgZnVuY3Rpb24gVXBkYXRlU291cmNlRWRpdG9yKCkgewogICAgdmFyIF9nZXRQcm90b3R5cGVPZjI7CgogICAgdmFyIF90aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBVcGRhdGVTb3VyY2VFZGl0b3IpOwoKICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykgewogICAgICBhcmdzW19rZXldID0gYXJndW1lbnRzW19rZXldOwogICAgfQoKICAgIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKF9nZXRQcm90b3R5cGVPZjIgPSBfZ2V0UHJvdG90eXBlT2YoVXBkYXRlU291cmNlRWRpdG9yKSkuY2FsbC5hcHBseShfZ2V0UHJvdG90eXBlT2YyLCBbdGhpc10uY29uY2F0KGFyZ3MpKSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAic3RhdGUiLCB7CiAgICAgIHNvdXJjZUZpZWxkczogbnVsbCwKICAgICAgdGVybUZpZWxkczogbnVsbCwKICAgICAgc29ydEZpZWxkczogbnVsbCwKICAgICAgbWF4SW5uZXJSZXN1bHRXaW5kb3c6IF9jb25zdGFudHMuREVGQVVMVF9NQVhfSU5ORVJfUkVTVUxUX1dJTkRPVwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiX29uVG9vbHRpcFByb3BlcnRpZXNDaGFuZ2UiLCBmdW5jdGlvbiAocHJvcGVydHlOYW1lcykgewogICAgICBfdGhpcy5wcm9wcy5vbkNoYW5nZSh7CiAgICAgICAgcHJvcE5hbWU6ICd0b29sdGlwUHJvcGVydGllcycsCiAgICAgICAgdmFsdWU6IHByb3BlcnR5TmFtZXMKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJvblVzZVRvcEhpdHNDaGFuZ2UiLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgX3RoaXMucHJvcHMub25DaGFuZ2UoewogICAgICAgIHByb3BOYW1lOiAndXNlVG9wSGl0cycsCiAgICAgICAgdmFsdWU6IGV2ZW50LnRhcmdldC5jaGVja2VkCiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAib25Ub3BIaXRzU3BsaXRGaWVsZENoYW5nZSIsIGZ1bmN0aW9uICh0b3BIaXRzU3BsaXRGaWVsZCkgewogICAgICBfdGhpcy5wcm9wcy5vbkNoYW5nZSh7CiAgICAgICAgcHJvcE5hbWU6ICd0b3BIaXRzU3BsaXRGaWVsZCcsCiAgICAgICAgdmFsdWU6IHRvcEhpdHNTcGxpdEZpZWxkCiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAib25Tb3J0RmllbGRDaGFuZ2UiLCBmdW5jdGlvbiAoc29ydEZpZWxkKSB7CiAgICAgIF90aGlzLnByb3BzLm9uQ2hhbmdlKHsKICAgICAgICBwcm9wTmFtZTogJ3NvcnRGaWVsZCcsCiAgICAgICAgdmFsdWU6IHNvcnRGaWVsZAogICAgICB9KTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIm9uU29ydE9yZGVyQ2hhbmdlIiwgZnVuY3Rpb24gKGUpIHsKICAgICAgX3RoaXMucHJvcHMub25DaGFuZ2UoewogICAgICAgIHByb3BOYW1lOiAnc29ydE9yZGVyJywKICAgICAgICB2YWx1ZTogZS50YXJnZXQudmFsdWUKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJvblRvcEhpdHNTaXplQ2hhbmdlIiwgZnVuY3Rpb24gKHNpemUpIHsKICAgICAgX3RoaXMucHJvcHMub25DaGFuZ2UoewogICAgICAgIHByb3BOYW1lOiAndG9wSGl0c1NpemUnLAogICAgICAgIHZhbHVlOiBzaXplCiAgICAgIH0pOwogICAgfSk7CgogICAgcmV0dXJuIF90aGlzOwogIH0KCiAgX2NyZWF0ZUNsYXNzKFVwZGF0ZVNvdXJjZUVkaXRvciwgW3sKICAgIGtleTogImNvbXBvbmVudERpZE1vdW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnREaWRNb3VudCgpIHsKICAgICAgdGhpcy5faXNNb3VudGVkID0gdHJ1ZTsKICAgICAgdGhpcy5sb2FkRmllbGRzKCk7CiAgICAgIHRoaXMubG9hZEluZGV4U2V0dGluZ3MoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjb21wb25lbnRXaWxsVW5tb3VudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50V2lsbFVubW91bnQoKSB7CiAgICAgIHRoaXMuX2lzTW91bnRlZCA9IGZhbHNlOwogICAgfQogIH0sIHsKICAgIGtleTogImxvYWRJbmRleFNldHRpbmdzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBsb2FkSW5kZXhTZXR0aW5ncygpIHsKICAgICAgdmFyIGluZGV4UGF0dGVybiwgX3JlZiwgbWF4SW5uZXJSZXN1bHRXaW5kb3c7CgogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmFzeW5jKGZ1bmN0aW9uIGxvYWRJbmRleFNldHRpbmdzJChfY29udGV4dCkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMDsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMzsKICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKF9raWJhbmFfc2VydmljZXMuaW5kZXhQYXR0ZXJuU2VydmljZS5nZXQodGhpcy5wcm9wcy5pbmRleFBhdHRlcm5JZCkpOwoKICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgIGluZGV4UGF0dGVybiA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDY7CiAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hd3JhcCgoMCwgX2xvYWRfaW5kZXhfc2V0dGluZ3MubG9hZEluZGV4U2V0dGluZ3MpKGluZGV4UGF0dGVybi50aXRsZSkpOwoKICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgIF9yZWYgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICAgIG1heElubmVyUmVzdWx0V2luZG93ID0gX3JlZi5tYXhJbm5lclJlc3VsdFdpbmRvdzsKCiAgICAgICAgICAgICAgaWYgKHRoaXMuX2lzTW91bnRlZCkgewogICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICAgIG1heElubmVyUmVzdWx0V2luZG93OiBtYXhJbm5lclJlc3VsdFdpbmRvdwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTQ7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAxMTsKICAgICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDApOwogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgbnVsbCwgdGhpcywgW1swLCAxMV1dKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJsb2FkRmllbGRzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBsb2FkRmllbGRzKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHZhciBpbmRleFBhdHRlcm4sIHJhd1Rvb2x0aXBGaWVsZHMsIHNvdXJjZUZpZWxkczsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hc3luYyhmdW5jdGlvbiBsb2FkRmllbGRzJChfY29udGV4dDIpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfY29udGV4dDIucHJldiA9IDA7CiAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzOwogICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAoX2tpYmFuYV9zZXJ2aWNlcy5pbmRleFBhdHRlcm5TZXJ2aWNlLmdldCh0aGlzLnByb3BzLmluZGV4UGF0dGVybklkKSk7CgogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgaW5kZXhQYXR0ZXJuID0gX2NvbnRleHQyLnNlbnQ7CiAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxMDsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICBfY29udGV4dDIucHJldiA9IDY7CiAgICAgICAgICAgICAgX2NvbnRleHQyLnQwID0gX2NvbnRleHQyWyJjYXRjaCJdKDApOwoKICAgICAgICAgICAgICBpZiAodGhpcy5faXNNb3VudGVkKSB7CiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgICAgbG9hZEVycm9yOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWFwcy5zb3VyY2UuZXNTZWFyY2gubG9hZEVycm9yTWVzc2FnZScsIHsKICAgICAgICAgICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIlVuYWJsZSB0byBmaW5kIEluZGV4IHBhdHRlcm4ge2lkfSIsCiAgICAgICAgICAgICAgICAgICAgdmFsdWVzOiB7CiAgICAgICAgICAgICAgICAgICAgICBpZDogdGhpcy5wcm9wcy5pbmRleFBhdHRlcm5JZAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICBpZiAodGhpcy5faXNNb3VudGVkKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDEyOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICAgIC8vdG9kbyBtb3ZlIHRoaXMgYWxsIHRvIHRoZSBzb3VyY2UKICAgICAgICAgICAgICByYXdUb29sdGlwRmllbGRzID0gKDAsIF9pbmRleF9wYXR0ZXJuX3V0aWwuZ2V0U291cmNlRmllbGRzKShpbmRleFBhdHRlcm4uZmllbGRzKTsKICAgICAgICAgICAgICBzb3VyY2VGaWVsZHMgPSByYXdUb29sdGlwRmllbGRzLm1hcChmdW5jdGlvbiAoZmllbGQpIHsKICAgICAgICAgICAgICAgIHJldHVybiBuZXcgX2VzX2RvY19maWVsZC5FU0RvY0ZpZWxkKHsKICAgICAgICAgICAgICAgICAgZmllbGROYW1lOiBmaWVsZC5uYW1lLAogICAgICAgICAgICAgICAgICBzb3VyY2U6IF90aGlzMi5wcm9wcy5zb3VyY2UKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgc291cmNlRmllbGRzOiBzb3VyY2VGaWVsZHMsCiAgICAgICAgICAgICAgICB0ZXJtRmllbGRzOiAoMCwgX2luZGV4X3BhdHRlcm5fdXRpbC5nZXRUZXJtc0ZpZWxkcykoaW5kZXhQYXR0ZXJuLmZpZWxkcyksCiAgICAgICAgICAgICAgICAvL3RvZG8gY2hhbmdlIHRlcm0gZmllbGRzIHRvIHVzZSBmaWVsZHMKICAgICAgICAgICAgICAgIHNvcnRGaWVsZHM6IGluZGV4UGF0dGVybi5maWVsZHMuZmlsdGVyKGZ1bmN0aW9uIChmaWVsZCkgewogICAgICAgICAgICAgICAgICByZXR1cm4gZmllbGQuc29ydGFibGUgJiYgISgwLCBfcHVibGljLmlzTmVzdGVkRmllbGQpKGZpZWxkKTsKICAgICAgICAgICAgICAgIH0pIC8vdG9kbyBjaGFuZ2Ugc29ydCBmaWVsZHMgdG8gdXNlIGZpZWxkcwoKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgMTU6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBudWxsLCB0aGlzLCBbWzAsIDZdXSk7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVuZGVyVG9wSGl0c0Zvcm0iLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlclRvcEhpdHNGb3JtKCkgewogICAgICB2YXIgdG9wSGl0c1N3aXRjaCA9IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGb3JtUm93LCB7CiAgICAgICAgbGFiZWw6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tYXBzLnNvdXJjZS5lc1NlYXJjaC50b3BIaXRzTGFiZWwnLCB7CiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIlRvcCBoaXRzIgogICAgICAgIH0pLAogICAgICAgIGRpc3BsYXk6ICJjb2x1bW5Db21wcmVzc2VkIgogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3dpdGNoLCB7CiAgICAgICAgbGFiZWw6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tYXBzLnNvdXJjZS5lc1NlYXJjaC51c2VUb3BIaXRzTGFiZWwnLCB7CiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIlNob3cgdG9wIGhpdHMgcGVyIGVudGl0eSIKICAgICAgICB9KSwKICAgICAgICBjaGVja2VkOiB0aGlzLnByb3BzLnVzZVRvcEhpdHMsCiAgICAgICAgb25DaGFuZ2U6IHRoaXMub25Vc2VUb3BIaXRzQ2hhbmdlLAogICAgICAgIGNvbXByZXNzZWQ6IHRydWUKICAgICAgfSkpOwoKICAgICAgaWYgKCF0aGlzLnByb3BzLnVzZVRvcEhpdHMpIHsKICAgICAgICByZXR1cm4gdG9wSGl0c1N3aXRjaDsKICAgICAgfQoKICAgICAgdmFyIHNpemVTbGlkZXI7CgogICAgICBpZiAodGhpcy5wcm9wcy50b3BIaXRzU3BsaXRGaWVsZCkgewogICAgICAgIHNpemVTbGlkZXIgPSBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRm9ybVJvdywgewogICAgICAgICAgbGFiZWw6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tYXBzLnNvdXJjZS5lc1NlYXJjaC50b3BIaXRzU2l6ZUxhYmVsJywgewogICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0RvY3VtZW50cyBwZXIgZW50aXR5JwogICAgICAgICAgfSksCiAgICAgICAgICBkaXNwbGF5OiAiY29sdW1uQ29tcHJlc3NlZCIKICAgICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF92YWxpZGF0ZWRfcmFuZ2UuVmFsaWRhdGVkUmFuZ2UsIHsKICAgICAgICAgIG1pbjogMSwKICAgICAgICAgIG1heDogdGhpcy5zdGF0ZS5tYXhJbm5lclJlc3VsdFdpbmRvdywKICAgICAgICAgIHN0ZXA6IDEsCiAgICAgICAgICB2YWx1ZTogdGhpcy5wcm9wcy50b3BIaXRzU2l6ZSwKICAgICAgICAgIG9uQ2hhbmdlOiB0aGlzLm9uVG9wSGl0c1NpemVDaGFuZ2UsCiAgICAgICAgICBzaG93TGFiZWxzOiB0cnVlLAogICAgICAgICAgc2hvd0lucHV0OiB0cnVlLAogICAgICAgICAgc2hvd1JhbmdlOiB0cnVlLAogICAgICAgICAgImRhdGEtdGVzdC1zdWJqIjogImxheWVyUGFuZWxUb3BIaXRzU2l6ZSIsCiAgICAgICAgICBjb21wcmVzc2VkOiB0cnVlCiAgICAgICAgfSkpOwogICAgICB9CgogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRnJhZ21lbnQsIG51bGwsIHRvcEhpdHNTd2l0Y2gsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGb3JtUm93LCB7CiAgICAgICAgbGFiZWw6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tYXBzLnNvdXJjZS5lc1NlYXJjaC50b3BIaXRzU3BsaXRGaWVsZExhYmVsJywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdFbnRpdHknCiAgICAgICAgfSksCiAgICAgICAgZGlzcGxheTogImNvbHVtbkNvbXByZXNzZWQiCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3NpbmdsZV9maWVsZF9zZWxlY3QuU2luZ2xlRmllbGRTZWxlY3QsIHsKICAgICAgICBwbGFjZWhvbGRlcjogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1hcHMuc291cmNlLmVzU2VhcmNoLnRvcEhpdHNTcGxpdEZpZWxkU2VsZWN0UGxhY2Vob2xkZXInLCB7CiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1NlbGVjdCBlbnRpdHkgZmllbGQnCiAgICAgICAgfSksCiAgICAgICAgdmFsdWU6IHRoaXMucHJvcHMudG9wSGl0c1NwbGl0RmllbGQsCiAgICAgICAgb25DaGFuZ2U6IHRoaXMub25Ub3BIaXRzU3BsaXRGaWVsZENoYW5nZSwKICAgICAgICBmaWVsZHM6IHRoaXMuc3RhdGUudGVybUZpZWxkcywKICAgICAgICBjb21wcmVzc2VkOiB0cnVlCiAgICAgIH0pKSwgc2l6ZVNsaWRlcik7CiAgICB9CiAgfSwgewogICAga2V5OiAiX3JlbmRlclRvb2x0aXBzUGFuZWwiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9yZW5kZXJUb29sdGlwc1BhbmVsKCkgewogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVBhbmVsLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVGl0bGUsIHsKICAgICAgICBzaXplOiAieHMiCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImg1IiwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogInhwYWNrLm1hcHMuZXNTZWFyY2gudG9vbHRpcHNUaXRsZSIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJUb29sdGlwIGZpZWxkcyIKICAgICAgfSkpKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgewogICAgICAgIHNpemU6ICJtIgogICAgICB9KSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfdG9vbHRpcF9zZWxlY3Rvci5Ub29sdGlwU2VsZWN0b3IsIHsKICAgICAgICB0b29sdGlwRmllbGRzOiB0aGlzLnByb3BzLnRvb2x0aXBGaWVsZHMsCiAgICAgICAgb25DaGFuZ2U6IHRoaXMuX29uVG9vbHRpcFByb3BlcnRpZXNDaGFuZ2UsCiAgICAgICAgZmllbGRzOiB0aGlzLnN0YXRlLnNvdXJjZUZpZWxkcwogICAgICB9KSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiX3JlbmRlclNvcnRQYW5lbCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3JlbmRlclNvcnRQYW5lbCgpIHsKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlQYW5lbCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRpdGxlLCB7CiAgICAgICAgc2l6ZTogInhzIgogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJoNSIsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJ4cGFjay5tYXBzLmVzU2VhcmNoLnNvcnRUaXRsZSIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJTb3J0aW5nIgogICAgICB9KSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3BhY2VyLCB7CiAgICAgICAgc2l6ZTogIm0iCiAgICAgIH0pLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRm9ybVJvdywgewogICAgICAgIGxhYmVsOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWFwcy5zb3VyY2UuZXNTZWFyY2guc29ydEZpZWxkTGFiZWwnLCB7CiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0ZpZWxkJwogICAgICAgIH0pLAogICAgICAgIGRpc3BsYXk6ICJjb2x1bW5Db21wcmVzc2VkIgogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9zaW5nbGVfZmllbGRfc2VsZWN0LlNpbmdsZUZpZWxkU2VsZWN0LCB7CiAgICAgICAgcGxhY2Vob2xkZXI6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tYXBzLnNvdXJjZS5lc1NlYXJjaC5zb3J0RmllbGRTZWxlY3RQbGFjZWhvbGRlcicsIHsKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnU2VsZWN0IHNvcnQgZmllbGQnCiAgICAgICAgfSksCiAgICAgICAgdmFsdWU6IHRoaXMucHJvcHMuc29ydEZpZWxkLAogICAgICAgIG9uQ2hhbmdlOiB0aGlzLm9uU29ydEZpZWxkQ2hhbmdlLAogICAgICAgIGZpZWxkczogdGhpcy5zdGF0ZS5zb3J0RmllbGRzLAogICAgICAgIGNvbXByZXNzZWQ6IHRydWUKICAgICAgfSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRm9ybVJvdywgewogICAgICAgIGxhYmVsOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWFwcy5zb3VyY2UuZXNTZWFyY2guc29ydE9yZGVyTGFiZWwnLCB7CiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ09yZGVyJwogICAgICAgIH0pLAogICAgICAgIGRpc3BsYXk6ICJjb2x1bW5Db21wcmVzc2VkIgogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU2VsZWN0LCB7CiAgICAgICAgZGlzYWJsZWQ6ICF0aGlzLnByb3BzLnNvcnRGaWVsZCwKICAgICAgICBvcHRpb25zOiBbewogICAgICAgICAgdGV4dDogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1hcHMuc291cmNlLmVzU2VhcmNoLmFzY2VuZGluZ0xhYmVsJywgewogICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ2FzY2VuZGluZycKICAgICAgICAgIH0pLAogICAgICAgICAgdmFsdWU6IF9jb25zdGFudHMuU09SVF9PUkRFUi5BU0MKICAgICAgICB9LCB7CiAgICAgICAgICB0ZXh0OiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWFwcy5zb3VyY2UuZXNTZWFyY2guZGVzY2VuZGluZ0xhYmVsJywgewogICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ2Rlc2NlbmRpbmcnCiAgICAgICAgICB9KSwKICAgICAgICAgIHZhbHVlOiBfY29uc3RhbnRzLlNPUlRfT1JERVIuREVTQwogICAgICAgIH1dLAogICAgICAgIHZhbHVlOiB0aGlzLnByb3BzLnNvcnRPcmRlciwKICAgICAgICBvbkNoYW5nZTogdGhpcy5vblNvcnRPcmRlckNoYW5nZSwKICAgICAgICBjb21wcmVzc2VkOiB0cnVlCiAgICAgIH0pKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUhvcml6b250YWxSdWxlLCB7CiAgICAgICAgbWFyZ2luOiAieHMiCiAgICAgIH0pLCB0aGlzLnJlbmRlclRvcEhpdHNGb3JtKCkpOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkgewogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRnJhZ21lbnQsIG51bGwsIHRoaXMuX3JlbmRlclRvb2x0aXBzUGFuZWwoKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgewogICAgICAgIHNpemU6ICJzIgogICAgICB9KSwgdGhpcy5fcmVuZGVyU29ydFBhbmVsKCksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTcGFjZXIsIHsKICAgICAgICBzaXplOiAicyIKICAgICAgfSkpOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIFVwZGF0ZVNvdXJjZUVkaXRvcjsKfShfcmVhY3QuQ29tcG9uZW50KTsKCmV4cG9ydHMuVXBkYXRlU291cmNlRWRpdG9yID0gVXBkYXRlU291cmNlRWRpdG9yOwoKX2RlZmluZVByb3BlcnR5KFVwZGF0ZVNvdXJjZUVkaXRvciwgInByb3BUeXBlcyIsIHsKICBpbmRleFBhdHRlcm5JZDogX3Byb3BUeXBlcy5kZWZhdWx0LnN0cmluZy5pc1JlcXVpcmVkLAogIG9uQ2hhbmdlOiBfcHJvcFR5cGVzLmRlZmF1bHQuZnVuYy5pc1JlcXVpcmVkLAogIHRvb2x0aXBGaWVsZHM6IF9wcm9wVHlwZXMuZGVmYXVsdC5hcnJheU9mKF9wcm9wVHlwZXMuZGVmYXVsdC5vYmplY3QpLmlzUmVxdWlyZWQsCiAgc29ydEZpZWxkOiBfcHJvcFR5cGVzLmRlZmF1bHQuc3RyaW5nLAogIHNvcnRPcmRlcjogX3Byb3BUeXBlcy5kZWZhdWx0LnN0cmluZy5pc1JlcXVpcmVkLAogIHVzZVRvcEhpdHM6IF9wcm9wVHlwZXMuZGVmYXVsdC5ib29sLmlzUmVxdWlyZWQsCiAgdG9wSGl0c1NwbGl0RmllbGQ6IF9wcm9wVHlwZXMuZGVmYXVsdC5zdHJpbmcsCiAgdG9wSGl0c1NpemU6IF9wcm9wVHlwZXMuZGVmYXVsdC5udW1iZXIuaXNSZXF1aXJlZCwKICBzb3VyY2U6IF9wcm9wVHlwZXMuZGVmYXVsdC5vYmplY3QKfSk7"},null]}