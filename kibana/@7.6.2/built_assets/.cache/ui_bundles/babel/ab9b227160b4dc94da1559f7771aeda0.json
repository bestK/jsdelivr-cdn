{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/maps/public/layers/layer.js","dependencies":[{"path":"x-pack/legacy/plugins/maps/public/layers/layer.js","mtime":1585205045313},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkFic3RyYWN0TGF5ZXIgPSB2b2lkIDA7Cgp2YXIgX2xvZGFzaCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgibG9kYXNoIikpOwoKdmFyIF9yZWFjdCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgicmVhY3QiKSk7Cgp2YXIgX2V1aSA9IHJlcXVpcmUoIkBlbGFzdGljL2V1aSIpOwoKdmFyIF9kYXRhX3JlcXVlc3QgPSByZXF1aXJlKCIuL3V0aWwvZGF0YV9yZXF1ZXN0Iik7Cgp2YXIgX2NvbnN0YW50cyA9IHJlcXVpcmUoIi4uLy4uL2NvbW1vbi9jb25zdGFudHMiKTsKCnZhciBfdiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgidXVpZC92NCIpKTsKCnZhciBfdXRpbCA9IHJlcXVpcmUoIi4uL3JlZHVjZXJzL3V0aWwiKTsKCnZhciBfaTE4biA9IHJlcXVpcmUoIkBrYm4vaTE4biIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgeyB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7IGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7IHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOyBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOyB9KTsga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOyB9IHJldHVybiBrZXlzOyB9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsgaWYgKGkgJSAyKSB7IG93bktleXMoc291cmNlLCB0cnVlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7IH0pOyB9IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoc291cmNlKSk7IH0gZWxzZSB7IG93bktleXMoc291cmNlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwga2V5KSk7IH0pOyB9IH0gcmV0dXJuIHRhcmdldDsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsgaWYgKGtleSBpbiBvYmopIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7IHZhbHVlOiB2YWx1ZSwgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTsgfSBlbHNlIHsgb2JqW2tleV0gPSB2YWx1ZTsgfSByZXR1cm4gb2JqOyB9Cgp2YXIgQWJzdHJhY3RMYXllciA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIEFic3RyYWN0TGF5ZXIoX3JlZikgewogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICB2YXIgbGF5ZXJEZXNjcmlwdG9yID0gX3JlZi5sYXllckRlc2NyaXB0b3IsCiAgICAgICAgc291cmNlID0gX3JlZi5zb3VyY2U7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEFic3RyYWN0TGF5ZXIpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAicmVuZGVyU291cmNlU2V0dGluZ3NFZGl0b3IiLCBmdW5jdGlvbiAoX3JlZjIpIHsKICAgICAgdmFyIG9uQ2hhbmdlID0gX3JlZjIub25DaGFuZ2U7CiAgICAgIHJldHVybiBfdGhpcy5fc291cmNlLnJlbmRlclNvdXJjZVNldHRpbmdzRWRpdG9yKHsKICAgICAgICBvbkNoYW5nZTogb25DaGFuZ2UKICAgICAgfSk7CiAgICB9KTsKCiAgICB0aGlzLl9kZXNjcmlwdG9yID0gQWJzdHJhY3RMYXllci5jcmVhdGVEZXNjcmlwdG9yKGxheWVyRGVzY3JpcHRvcik7CiAgICB0aGlzLl9zb3VyY2UgPSBzb3VyY2U7CgogICAgaWYgKHRoaXMuX2Rlc2NyaXB0b3IuX19kYXRhUmVxdWVzdHMpIHsKICAgICAgdGhpcy5fZGF0YVJlcXVlc3RzID0gdGhpcy5fZGVzY3JpcHRvci5fX2RhdGFSZXF1ZXN0cy5tYXAoZnVuY3Rpb24gKGRhdGFSZXF1ZXN0KSB7CiAgICAgICAgcmV0dXJuIG5ldyBfZGF0YV9yZXF1ZXN0LkRhdGFSZXF1ZXN0KGRhdGFSZXF1ZXN0KTsKICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLl9kYXRhUmVxdWVzdHMgPSBbXTsKICAgIH0KICB9CgogIF9jcmVhdGVDbGFzcyhBYnN0cmFjdExheWVyLCBbewogICAga2V5OiAiZGVzdHJveSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSgpIHsKICAgICAgaWYgKHRoaXMuX3NvdXJjZSkgewogICAgICAgIHRoaXMuX3NvdXJjZS5kZXN0cm95KCk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJjbG9uZURlc2NyaXB0b3IiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNsb25lRGVzY3JpcHRvcigpIHsKICAgICAgdmFyIGNsb25lZERlc2NyaXB0b3IsIGRpc3BsYXlOYW1lOwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmFzeW5jKGZ1bmN0aW9uIGNsb25lRGVzY3JpcHRvciQoX2NvbnRleHQpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgY2xvbmVkRGVzY3JpcHRvciA9ICgwLCBfdXRpbC5jb3B5UGVyc2lzdGVudFN0YXRlKSh0aGlzLl9kZXNjcmlwdG9yKTsgLy8gbGF5ZXIgaWQgaXMgdXVpZCB1c2VkIHRvIHRyYWNrIHN0eWxlcy9sYXllcnMgaW4gbWFwYm94CgogICAgICAgICAgICAgIGNsb25lZERlc2NyaXB0b3IuaWQgPSAoMCwgX3YuZGVmYXVsdCkoKTsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNDsKICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKHRoaXMuZ2V0RGlzcGxheU5hbWUoKSk7CgogICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgZGlzcGxheU5hbWUgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICAgIGNsb25lZERlc2NyaXB0b3IubGFiZWwgPSAiQ2xvbmUgb2YgIi5jb25jYXQoZGlzcGxheU5hbWUpOwogICAgICAgICAgICAgIGNsb25lZERlc2NyaXB0b3Iuc291cmNlRGVzY3JpcHRvciA9IHRoaXMuX3NvdXJjZS5jbG9uZURlc2NyaXB0b3IoKTsKCiAgICAgICAgICAgICAgaWYgKGNsb25lZERlc2NyaXB0b3Iuam9pbnMpIHsKICAgICAgICAgICAgICAgIGNsb25lZERlc2NyaXB0b3Iuam9pbnMuZm9yRWFjaChmdW5jdGlvbiAoam9pbkRlc2NyaXB0b3IpIHsKICAgICAgICAgICAgICAgICAgLy8gcmlnaHQuaWQgaXMgdXVpZCB1c2VkIHRvIHRyYWNrIHJlcXVlc3RzIGluIGluc3BlY3RvcgogICAgICAgICAgICAgICAgICBqb2luRGVzY3JpcHRvci5yaWdodC5pZCA9ICgwLCBfdi5kZWZhdWx0KSgpOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBjbG9uZWREZXNjcmlwdG9yKTsKCiAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgbnVsbCwgdGhpcyk7CiAgICB9CiAgfSwgewogICAga2V5OiAibWFrZU1iTGF5ZXJJZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbWFrZU1iTGF5ZXJJZChsYXllck5hbWVTdWZmaXgpIHsKICAgICAgcmV0dXJuICIiLmNvbmNhdCh0aGlzLmdldElkKCkpLmNvbmNhdChfY29uc3RhbnRzLk1CX1NPVVJDRV9JRF9MQVlFUl9JRF9QUkVGSVhfREVMSU1JVEVSKS5jb25jYXQobGF5ZXJOYW1lU3VmZml4KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJpc0pvaW5hYmxlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpc0pvaW5hYmxlKCkgewogICAgICByZXR1cm4gdGhpcy5fc291cmNlLmlzSm9pbmFibGUoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzdXBwb3J0c0VsYXN0aWNzZWFyY2hGaWx0ZXJzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzdXBwb3J0c0VsYXN0aWNzZWFyY2hGaWx0ZXJzKCkgewogICAgICByZXR1cm4gdGhpcy5fc291cmNlLmlzRVNTb3VyY2UoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzdXBwb3J0c0ZpdFRvQm91bmRzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzdXBwb3J0c0ZpdFRvQm91bmRzKCkgewogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmFzeW5jKGZ1bmN0aW9uIHN1cHBvcnRzRml0VG9Cb3VuZHMkKF9jb250ZXh0MikgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMjsKICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKHRoaXMuX3NvdXJjZS5zdXBwb3J0c0ZpdFRvQm91bmRzKCkpOwoKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iLCBfY29udGV4dDIuc2VudCk7CgogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBudWxsLCB0aGlzKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXREaXNwbGF5TmFtZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0RGlzcGxheU5hbWUoKSB7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXN5bmMoZnVuY3Rpb24gZ2V0RGlzcGxheU5hbWUkKF9jb250ZXh0MykgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGlmICghdGhpcy5fZGVzY3JpcHRvci5sYWJlbCkgewogICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAyOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIiwgdGhpcy5fZGVzY3JpcHRvci5sYWJlbCk7CgogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA0OwogICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAodGhpcy5fc291cmNlLmdldERpc3BsYXlOYW1lKCkpOwoKICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIF9jb250ZXh0My50MCA9IF9jb250ZXh0My5zZW50OwoKICAgICAgICAgICAgICBpZiAoX2NvbnRleHQzLnQwKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDc7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIF9jb250ZXh0My50MCA9ICJMYXllciAiLmNvbmNhdCh0aGlzLl9kZXNjcmlwdG9yLmlkKTsKCiAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIiwgX2NvbnRleHQzLnQwKTsKCiAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIG51bGwsIHRoaXMpOwogICAgfQogIH0sIHsKICAgIGtleTogImdldEF0dHJpYnV0aW9ucyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0QXR0cmlidXRpb25zKCkgewogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmFzeW5jKGZ1bmN0aW9uIGdldEF0dHJpYnV0aW9ucyQoX2NvbnRleHQ0KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ0LnByZXYgPSBfY29udGV4dDQubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgaWYgKHRoaXMuaGFzRXJyb3JzKCkpIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gNDsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAzOwogICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAodGhpcy5fc291cmNlLmdldEF0dHJpYnV0aW9ucygpKTsKCiAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LmFicnVwdCgicmV0dXJuIiwgX2NvbnRleHQ0LnNlbnQpOwoKICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KCJyZXR1cm4iLCBbXSk7CgogICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBudWxsLCB0aGlzKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRMYWJlbCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TGFiZWwoKSB7CiAgICAgIHJldHVybiB0aGlzLl9kZXNjcmlwdG9yLmxhYmVsID8gdGhpcy5fZGVzY3JpcHRvci5sYWJlbCA6ICcnOwogICAgfQogIH0sIHsKICAgIGtleTogImdldEN1c3RvbUljb25BbmRUb29sdGlwQ29udGVudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q3VzdG9tSWNvbkFuZFRvb2x0aXBDb250ZW50KCkgewogICAgICByZXR1cm4gewogICAgICAgIGljb246IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlJY29uLCB7CiAgICAgICAgICBzaXplOiAibSIsCiAgICAgICAgICB0eXBlOiB0aGlzLmdldExheWVyVHlwZUljb25OYW1lKCkKICAgICAgICB9KQogICAgICB9OwogICAgfQogIH0sIHsKICAgIGtleTogImdldEljb25BbmRUb29sdGlwQ29udGVudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0SWNvbkFuZFRvb2x0aXBDb250ZW50KHpvb21MZXZlbCwgaXNVc2luZ1NlYXJjaCkgewogICAgICB2YXIgaWNvbjsKICAgICAgdmFyIHRvb2x0aXBDb250ZW50ID0gbnVsbDsKICAgICAgdmFyIGZvb3Rub3RlcyA9IFtdOwoKICAgICAgaWYgKHRoaXMuaGFzRXJyb3JzKCkpIHsKICAgICAgICBpY29uID0gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUljb24sIHsKICAgICAgICAgICJhcmlhLWxhYmVsIjogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1hcHMubGF5ZXIubG9hZFdhcm5pbmdBcmlhTGFiZWwnLCB7CiAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnTG9hZCB3YXJuaW5nJwogICAgICAgICAgfSksCiAgICAgICAgICBzaXplOiAibSIsCiAgICAgICAgICB0eXBlOiAiYWxlcnQiLAogICAgICAgICAgY29sb3I6ICJ3YXJuaW5nIgogICAgICAgIH0pOwogICAgICAgIHRvb2x0aXBDb250ZW50ID0gdGhpcy5nZXRFcnJvcnMoKTsKICAgICAgfSBlbHNlIGlmICh0aGlzLmlzTGF5ZXJMb2FkaW5nKCkpIHsKICAgICAgICBpY29uID0gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUxvYWRpbmdTcGlubmVyLCB7CiAgICAgICAgICBzaXplOiAibSIKICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmICghdGhpcy5pc1Zpc2libGUoKSkgewogICAgICAgIGljb24gPSBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpSWNvbiwgewogICAgICAgICAgc2l6ZTogIm0iLAogICAgICAgICAgdHlwZTogImV5ZUNsb3NlZCIKICAgICAgICB9KTsKICAgICAgICB0b29sdGlwQ29udGVudCA9IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tYXBzLmxheWVyLmxheWVySGlkZGVuVG9vbHRpcCcsIHsKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiTGF5ZXIgaXMgaGlkZGVuLiIKICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmICghdGhpcy5zaG93QXRab29tTGV2ZWwoem9vbUxldmVsKSkgewogICAgICAgIHZhciBfdGhpcyRnZXRab29tQ29uZmlnID0gdGhpcy5nZXRab29tQ29uZmlnKCksCiAgICAgICAgICAgIG1pblpvb20gPSBfdGhpcyRnZXRab29tQ29uZmlnLm1pblpvb20sCiAgICAgICAgICAgIG1heFpvb20gPSBfdGhpcyRnZXRab29tQ29uZmlnLm1heFpvb207CgogICAgICAgIGljb24gPSBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpSWNvbiwgewogICAgICAgICAgc2l6ZTogIm0iLAogICAgICAgICAgdHlwZTogImV4cGFuZCIKICAgICAgICB9KTsKICAgICAgICB0b29sdGlwQ29udGVudCA9IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tYXBzLmxheWVyLnpvb21GZWVkYmFja1Rvb2x0aXAnLCB7CiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkxheWVyIGlzIHZpc2libGUgYmV0d2VlbiB6b29tIGxldmVscyB7bWluWm9vbX0gYW5kIHttYXhab29tfS4iLAogICAgICAgICAgdmFsdWVzOiB7CiAgICAgICAgICAgIG1pblpvb206IG1pblpvb20sCiAgICAgICAgICAgIG1heFpvb206IG1heFpvb20KICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgY3VzdG9tSWNvbkFuZFRvb2x0aXBDb250ZW50ID0gdGhpcy5nZXRDdXN0b21JY29uQW5kVG9vbHRpcENvbnRlbnQoKTsKCiAgICAgICAgaWYgKGN1c3RvbUljb25BbmRUb29sdGlwQ29udGVudCkgewogICAgICAgICAgaWNvbiA9IGN1c3RvbUljb25BbmRUb29sdGlwQ29udGVudC5pY29uOwoKICAgICAgICAgIGlmICghY3VzdG9tSWNvbkFuZFRvb2x0aXBDb250ZW50LmFyZVJlc3VsdHNUcmltbWVkKSB7CiAgICAgICAgICAgIHRvb2x0aXBDb250ZW50ID0gY3VzdG9tSWNvbkFuZFRvb2x0aXBDb250ZW50LnRvb2x0aXBDb250ZW50OwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZm9vdG5vdGVzLnB1c2goewogICAgICAgICAgICAgIGljb246IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlJY29uLCB7CiAgICAgICAgICAgICAgICBjb2xvcjogInN1YmR1ZWQiLAogICAgICAgICAgICAgICAgdHlwZTogInBhcnRpYWwiLAogICAgICAgICAgICAgICAgc2l6ZTogInMiCiAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgbWVzc2FnZTogY3VzdG9tSWNvbkFuZFRvb2x0aXBDb250ZW50LnRvb2x0aXBDb250ZW50CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKGlzVXNpbmdTZWFyY2ggJiYgdGhpcy5nZXRRdWVyeWFibGVJbmRleFBhdHRlcm5JZHMoKS5sZW5ndGgpIHsKICAgICAgICAgIGZvb3Rub3Rlcy5wdXNoKHsKICAgICAgICAgICAgaWNvbjogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUljb24sIHsKICAgICAgICAgICAgICBjb2xvcjogInN1YmR1ZWQiLAogICAgICAgICAgICAgIHR5cGU6ICJmaWx0ZXIiLAogICAgICAgICAgICAgIHNpemU6ICJzIgogICAgICAgICAgICB9KSwKICAgICAgICAgICAgbWVzc2FnZTogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1hcHMubGF5ZXIuaXNVc2luZ1NlYXJjaE1zZycsIHsKICAgICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1Jlc3VsdHMgbmFycm93ZWQgYnkgc2VhcmNoIGJhcicKICAgICAgICAgICAgfSkKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHsKICAgICAgICBpY29uOiBpY29uLAogICAgICAgIHRvb2x0aXBDb250ZW50OiB0b29sdGlwQ29udGVudCwKICAgICAgICBmb290bm90ZXM6IGZvb3Rub3RlcwogICAgICB9OwogICAgfQogIH0sIHsKICAgIGtleTogImhhc0xlZ2VuZERldGFpbHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGhhc0xlZ2VuZERldGFpbHMoKSB7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXN5bmMoZnVuY3Rpb24gaGFzTGVnZW5kRGV0YWlscyQoX2NvbnRleHQ1KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ1LnByZXYgPSBfY29udGV4dDUubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5hYnJ1cHQoInJldHVybiIsIGZhbHNlKTsKCiAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlckxlZ2VuZERldGFpbHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlckxlZ2VuZERldGFpbHMoKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQogIH0sIHsKICAgIGtleTogImdldElkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRJZCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2Rlc2NyaXB0b3IuaWQ7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0U291cmNlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRTb3VyY2UoKSB7CiAgICAgIHJldHVybiB0aGlzLl9zb3VyY2U7CiAgICB9CiAgfSwgewogICAga2V5OiAiaXNWaXNpYmxlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpc1Zpc2libGUoKSB7CiAgICAgIHJldHVybiB0aGlzLl9kZXNjcmlwdG9yLnZpc2libGU7CiAgICB9CiAgfSwgewogICAga2V5OiAic2hvd0F0Wm9vbUxldmVsIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzaG93QXRab29tTGV2ZWwoem9vbSkgewogICAgICByZXR1cm4gem9vbSA+PSB0aGlzLl9kZXNjcmlwdG9yLm1pblpvb20gJiYgem9vbSA8PSB0aGlzLl9kZXNjcmlwdG9yLm1heFpvb207CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0TWluWm9vbSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TWluWm9vbSgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2Rlc2NyaXB0b3IubWluWm9vbTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRNYXhab29tIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRNYXhab29tKCkgewogICAgICByZXR1cm4gdGhpcy5fZGVzY3JpcHRvci5tYXhab29tOwogICAgfQogIH0sIHsKICAgIGtleTogImdldEFscGhhIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRBbHBoYSgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2Rlc2NyaXB0b3IuYWxwaGE7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0UXVlcnkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFF1ZXJ5KCkgewogICAgICByZXR1cm4gdGhpcy5fZGVzY3JpcHRvci5xdWVyeTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRab29tQ29uZmlnIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRab29tQ29uZmlnKCkgewogICAgICByZXR1cm4gewogICAgICAgIG1pblpvb206IHRoaXMuX2Rlc2NyaXB0b3IubWluWm9vbSwKICAgICAgICBtYXhab29tOiB0aGlzLl9kZXNjcmlwdG9yLm1heFpvb20KICAgICAgfTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRDdXJyZW50U3R5bGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEN1cnJlbnRTdHlsZSgpIHsKICAgICAgcmV0dXJuIHRoaXMuX3N0eWxlOwogICAgfQogIH0sIHsKICAgIGtleTogImdldEltbXV0YWJsZVNvdXJjZVByb3BlcnRpZXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEltbXV0YWJsZVNvdXJjZVByb3BlcnRpZXMoKSB7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXN5bmMoZnVuY3Rpb24gZ2V0SW1tdXRhYmxlU291cmNlUHJvcGVydGllcyQoX2NvbnRleHQ2KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ2LnByZXYgPSBfY29udGV4dDYubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5hYnJ1cHQoInJldHVybiIsIHRoaXMuX3NvdXJjZS5nZXRJbW11dGFibGVQcm9wZXJ0aWVzKCkpOwoKICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgbnVsbCwgdGhpcyk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0UHJldlJlcXVlc3RUb2tlbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0UHJldlJlcXVlc3RUb2tlbihkYXRhSWQpIHsKICAgICAgdmFyIHByZXZEYXRhUmVxdWVzdCA9IHRoaXMuZ2V0RGF0YVJlcXVlc3QoZGF0YUlkKTsKCiAgICAgIGlmICghcHJldkRhdGFSZXF1ZXN0KSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICByZXR1cm4gcHJldkRhdGFSZXF1ZXN0LmdldFJlcXVlc3RUb2tlbigpOwogICAgfQogIH0sIHsKICAgIGtleTogImdldEluRmxpZ2h0UmVxdWVzdFRva2VucyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0SW5GbGlnaHRSZXF1ZXN0VG9rZW5zKCkgewogICAgICBpZiAoIXRoaXMuX2RhdGFSZXF1ZXN0cykgewogICAgICAgIHJldHVybiBbXTsKICAgICAgfQoKICAgICAgdmFyIHJlcXVlc3RUb2tlbnMgPSB0aGlzLl9kYXRhUmVxdWVzdHMubWFwKGZ1bmN0aW9uIChkYXRhUmVxdWVzdCkgewogICAgICAgIHJldHVybiBkYXRhUmVxdWVzdC5nZXRSZXF1ZXN0VG9rZW4oKTsKICAgICAgfSk7CgogICAgICByZXR1cm4gX2xvZGFzaC5kZWZhdWx0LmNvbXBhY3QocmVxdWVzdFRva2Vucyk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0U291cmNlRGF0YVJlcXVlc3QiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFNvdXJjZURhdGFSZXF1ZXN0KCkgewogICAgICByZXR1cm4gdGhpcy5nZXREYXRhUmVxdWVzdChfY29uc3RhbnRzLlNPVVJDRV9EQVRBX0lEX09SSUdJTik7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0RGF0YVJlcXVlc3QiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldERhdGFSZXF1ZXN0KGlkKSB7CiAgICAgIHJldHVybiB0aGlzLl9kYXRhUmVxdWVzdHMuZmluZChmdW5jdGlvbiAoZGF0YVJlcXVlc3QpIHsKICAgICAgICByZXR1cm4gZGF0YVJlcXVlc3QuZ2V0RGF0YUlkKCkgPT09IGlkOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJpc0xheWVyTG9hZGluZyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaXNMYXllckxvYWRpbmcoKSB7CiAgICAgIHJldHVybiB0aGlzLl9kYXRhUmVxdWVzdHMuc29tZShmdW5jdGlvbiAoZGF0YVJlcXVlc3QpIHsKICAgICAgICByZXR1cm4gZGF0YVJlcXVlc3QuaXNMb2FkaW5nKCk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogImhhc0Vycm9ycyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaGFzRXJyb3JzKCkgewogICAgICByZXR1cm4gX2xvZGFzaC5kZWZhdWx0LmdldCh0aGlzLl9kZXNjcmlwdG9yLCAnX19pc0luRXJyb3JTdGF0ZScsIGZhbHNlKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRFcnJvcnMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEVycm9ycygpIHsKICAgICAgcmV0dXJuIHRoaXMuaGFzRXJyb3JzKCkgPyB0aGlzLl9kZXNjcmlwdG9yLl9fZXJyb3JNZXNzYWdlIDogJyc7CiAgICB9CiAgfSwgewogICAga2V5OiAidG9MYXllckRlc2NyaXB0b3IiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHRvTGF5ZXJEZXNjcmlwdG9yKCkgewogICAgICByZXR1cm4gdGhpcy5fZGVzY3JpcHRvcjsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzeW5jRGF0YSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc3luY0RhdGEoKSB7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXN5bmMoZnVuY3Rpb24gc3luY0RhdGEkKF9jb250ZXh0NykgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Ny5wcmV2ID0gX2NvbnRleHQ3Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0TWJMYXllcklkcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TWJMYXllcklkcygpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdTaG91bGQgaW1wbGVtZW50IEFic3RyYWN0TGF5ZXIjZ2V0TWJMYXllcklkcycpOwogICAgfQogIH0sIHsKICAgIGtleTogIm93bnNNYkxheWVySWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG93bnNNYkxheWVySWQoKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignU2hvdWxkIGltcGxlbWVudCBBYnN0cmFjdExheWVyI293bnNNYkxheWVySWQnKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJvd25zTWJTb3VyY2VJZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb3duc01iU291cmNlSWQoKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignU2hvdWxkIGltcGxlbWVudCBBYnN0cmFjdExheWVyI293bnNNYlNvdXJjZUlkJyk7CiAgICB9CiAgfSwgewogICAga2V5OiAiY2FuU2hvd1Rvb2x0aXAiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNhblNob3dUb29sdGlwKCkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfSwgewogICAga2V5OiAic3luY0xheWVyV2l0aE1CIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzeW5jTGF5ZXJXaXRoTUIoKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignU2hvdWxkIGltcGxlbWVudCBBYnN0cmFjdExheWVyI3N5bmNMYXllcldpdGhNQicpOwogICAgfQogIH0sIHsKICAgIGtleTogImdldExheWVyVHlwZUljb25OYW1lIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRMYXllclR5cGVJY29uTmFtZSgpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdzaG91bGQgaW1wbGVtZW50IExheWVyI2dldExheWVyVHlwZUljb25OYW1lJyk7CiAgICB9CiAgfSwgewogICAga2V5OiAiaXNEYXRhTG9hZGVkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpc0RhdGFMb2FkZWQoKSB7CiAgICAgIHZhciBzb3VyY2VEYXRhUmVxdWVzdCA9IHRoaXMuZ2V0U291cmNlRGF0YVJlcXVlc3QoKTsKICAgICAgcmV0dXJuIHNvdXJjZURhdGFSZXF1ZXN0ICYmIHNvdXJjZURhdGFSZXF1ZXN0Lmhhc0RhdGEoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRCb3VuZHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEJvdW5kcygpIHsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hc3luYyhmdW5jdGlvbiBnZXRCb3VuZHMkKF9jb250ZXh0OCkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0OC5wcmV2ID0gX2NvbnRleHQ4Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDguYWJydXB0KCJyZXR1cm4iLCB7CiAgICAgICAgICAgICAgICBtaW5fbG9uOiAtMTgwLAogICAgICAgICAgICAgICAgbWF4X2xvbjogMTgwLAogICAgICAgICAgICAgICAgbWluX2xhdDogLTg5LAogICAgICAgICAgICAgICAgbWF4X2xhdDogODkKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlclN0eWxlRWRpdG9yIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJTdHlsZUVkaXRvcihfcmVmMykgewogICAgICB2YXIgb25TdHlsZURlc2NyaXB0b3JDaGFuZ2UgPSBfcmVmMy5vblN0eWxlRGVzY3JpcHRvckNoYW5nZTsKCiAgICAgIGlmICghdGhpcy5fc3R5bGUpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXMuX3N0eWxlLnJlbmRlckVkaXRvcih7CiAgICAgICAgbGF5ZXI6IHRoaXMsCiAgICAgICAgb25TdHlsZURlc2NyaXB0b3JDaGFuZ2U6IG9uU3R5bGVEZXNjcmlwdG9yQ2hhbmdlCiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogImdldEluZGV4UGF0dGVybklkcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0SW5kZXhQYXR0ZXJuSWRzKCkgewogICAgICByZXR1cm4gW107CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0UXVlcnlhYmxlSW5kZXhQYXR0ZXJuSWRzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRRdWVyeWFibGVJbmRleFBhdHRlcm5JZHMoKSB7CiAgICAgIHJldHVybiBbXTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXREYXRlRmllbGRzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXREYXRlRmllbGRzKCkgewogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmFzeW5jKGZ1bmN0aW9uIGdldERhdGVGaWVsZHMkKF9jb250ZXh0OSkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0OS5wcmV2ID0gX2NvbnRleHQ5Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDkuYWJydXB0KCJyZXR1cm4iLCBbXSk7CgogICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OS5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXROdW1iZXJGaWVsZHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldE51bWJlckZpZWxkcygpIHsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hc3luYyhmdW5jdGlvbiBnZXROdW1iZXJGaWVsZHMkKF9jb250ZXh0MTApIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDEwLnByZXYgPSBfY29udGV4dDEwLm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEwLmFicnVwdCgicmV0dXJuIiwgW10pOwoKICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEwLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogImdldENhdGVnb3JpY2FsRmllbGRzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRDYXRlZ29yaWNhbEZpZWxkcygpIHsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hc3luYyhmdW5jdGlvbiBnZXRDYXRlZ29yaWNhbEZpZWxkcyQoX2NvbnRleHQxMSkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTEucHJldiA9IF9jb250ZXh0MTEubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTEuYWJydXB0KCJyZXR1cm4iLCBbXSk7CgogICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTEuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0RmllbGRzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRGaWVsZHMoKSB7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXN5bmMoZnVuY3Rpb24gZ2V0RmllbGRzJChfY29udGV4dDEyKSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMi5wcmV2ID0gX2NvbnRleHQxMi5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMi5hYnJ1cHQoInJldHVybiIsIFtdKTsKCiAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMi5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzeW5jVmlzaWJpbGl0eVdpdGhNYiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc3luY1Zpc2liaWxpdHlXaXRoTWIobWJNYXAsIG1iTGF5ZXJJZCkgewogICAgICBtYk1hcC5zZXRMYXlvdXRQcm9wZXJ0eShtYkxheWVySWQsICd2aXNpYmlsaXR5JywgdGhpcy5pc1Zpc2libGUoKSA/ICd2aXNpYmxlJyA6ICdub25lJyk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0VHlwZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0VHlwZSgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2Rlc2NyaXB0b3IudHlwZTsKICAgIH0KICB9XSwgW3sKICAgIGtleTogImdldEJvdW5kRGF0YUZvclNvdXJjZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Qm91bmREYXRhRm9yU291cmNlKG1iTWFwLCBzb3VyY2VJZCkgewogICAgICB2YXIgbWJTdHlsZSA9IG1iTWFwLmdldFN0eWxlKCk7CiAgICAgIHJldHVybiBtYlN0eWxlLnNvdXJjZXNbc291cmNlSWRdLmRhdGE7CiAgICB9CiAgfSwgewogICAga2V5OiAiY3JlYXRlRGVzY3JpcHRvciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlRGVzY3JpcHRvcigpIHsKICAgICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9OwoKICAgICAgdmFyIGxheWVyRGVzY3JpcHRvciA9IF9vYmplY3RTcHJlYWQoe30sIG9wdGlvbnMpOwoKICAgICAgbGF5ZXJEZXNjcmlwdG9yLl9fZGF0YVJlcXVlc3RzID0gX2xvZGFzaC5kZWZhdWx0LmdldChvcHRpb25zLCAnX19kYXRhUmVxdWVzdHMnLCBbXSk7CiAgICAgIGxheWVyRGVzY3JpcHRvci5pZCA9IF9sb2Rhc2guZGVmYXVsdC5nZXQob3B0aW9ucywgJ2lkJywgKDAsIF92LmRlZmF1bHQpKCkpOwogICAgICBsYXllckRlc2NyaXB0b3IubGFiZWwgPSBvcHRpb25zLmxhYmVsICYmIG9wdGlvbnMubGFiZWwubGVuZ3RoID4gMCA/IG9wdGlvbnMubGFiZWwgOiBudWxsOwogICAgICBsYXllckRlc2NyaXB0b3IubWluWm9vbSA9IF9sb2Rhc2guZGVmYXVsdC5nZXQob3B0aW9ucywgJ21pblpvb20nLCBfY29uc3RhbnRzLk1JTl9aT09NKTsKICAgICAgbGF5ZXJEZXNjcmlwdG9yLm1heFpvb20gPSBfbG9kYXNoLmRlZmF1bHQuZ2V0KG9wdGlvbnMsICdtYXhab29tJywgX2NvbnN0YW50cy5NQVhfWk9PTSk7CiAgICAgIGxheWVyRGVzY3JpcHRvci5hbHBoYSA9IF9sb2Rhc2guZGVmYXVsdC5nZXQob3B0aW9ucywgJ2FscGhhJywgMC43NSk7CiAgICAgIGxheWVyRGVzY3JpcHRvci52aXNpYmxlID0gX2xvZGFzaC5kZWZhdWx0LmdldChvcHRpb25zLCAndmlzaWJsZScsIHRydWUpOwogICAgICBsYXllckRlc2NyaXB0b3Iuc3R5bGUgPSBfbG9kYXNoLmRlZmF1bHQuZ2V0KG9wdGlvbnMsICdzdHlsZScsIHt9KTsKICAgICAgcmV0dXJuIGxheWVyRGVzY3JpcHRvcjsKICAgIH0KICB9XSk7CgogIHJldHVybiBBYnN0cmFjdExheWVyOwp9KCk7CgpleHBvcnRzLkFic3RyYWN0TGF5ZXIgPSBBYnN0cmFjdExheWVyOw=="},null]}