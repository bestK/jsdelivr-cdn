{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/watcher/public/np_ready/application/sections/watch_edit/components/threshold_watch_edit/threshold_watch_edit.js","dependencies":[{"path":"x-pack/legacy/plugins/watcher/public/np_ready/application/sections/watch_edit/components/threshold_watch_edit/threshold_watch_edit.js","mtime":1585205048903},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLlRocmVzaG9sZFdhdGNoRWRpdCA9IHZvaWQgMDsKCnZhciBfcmVhY3QgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKCJyZWFjdCIpKTsKCnZhciBfZXVpID0gcmVxdWlyZSgiQGVsYXN0aWMvZXVpIik7Cgp2YXIgX2kxOG4gPSByZXF1aXJlKCJAa2JuL2kxOG4iKTsKCnZhciBfcmVhY3QyID0gcmVxdWlyZSgiQGtibi9pMThuL3JlYWN0Iik7Cgp2YXIgX2NvbnN0YW50cyA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uLy4uLy4uLy4uL2NvbW1vbi9jb25zdGFudHMiKTsKCnZhciBfc2VyaWFsaXphdGlvbiA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uLy4uLy4uLy4uL2NvbW1vbi9saWIvc2VyaWFsaXphdGlvbiIpOwoKdmFyIF9jb21wb25lbnRzID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vY29tcG9uZW50cyIpOwoKdmFyIF9hcGkgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9saWIvYXBpIik7Cgp2YXIgX2FnZ190eXBlcyA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL21vZGVscy93YXRjaC9hZ2dfdHlwZXMiKTsKCnZhciBfZ3JvdXBfYnlfdHlwZXMgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9tb2RlbHMvd2F0Y2gvZ3JvdXBfYnlfdHlwZXMiKTsKCnZhciBfY29tcGFyYXRvcnMgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9tb2RlbHMvd2F0Y2gvY29tcGFyYXRvcnMiKTsKCnZhciBfd2F0Y2hfZWRpdF9hY3Rpb25zID0gcmVxdWlyZSgiLi4vLi4vd2F0Y2hfZWRpdF9hY3Rpb25zIik7Cgp2YXIgX3dhdGNoX2NvbnRleHQgPSByZXF1aXJlKCIuLi8uLi93YXRjaF9jb250ZXh0Iik7Cgp2YXIgX3dhdGNoX3Zpc3VhbGl6YXRpb24gPSByZXF1aXJlKCIuL3dhdGNoX3Zpc3VhbGl6YXRpb24iKTsKCnZhciBfdGhyZXNob2xkX3dhdGNoX2FjdGlvbl9wYW5lbCA9IHJlcXVpcmUoIi4vdGhyZXNob2xkX3dhdGNoX2FjdGlvbl9wYW5lbCIpOwoKdmFyIF9nZXRfdGltZV91bml0X2xhYmVsID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vbGliL2dldF90aW1lX3VuaXRfbGFiZWwiKTsKCnZhciBfbmF2aWdhdGlvbiA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL2xpYi9uYXZpZ2F0aW9uIik7Cgp2YXIgX3JlcXVlc3RfZmx5b3V0ID0gcmVxdWlyZSgiLi4vcmVxdWVzdF9mbHlvdXQiKTsKCnZhciBfYXBwX2NvbnRleHQgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9hcHBfY29udGV4dCIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7CiAgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgewogICAgcmV0dXJuIG9iajsKICB9IGVsc2UgewogICAgdmFyIG5ld09iaiA9IHt9OwoKICAgIGlmIChvYmogIT0gbnVsbCkgewogICAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7CiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHsKICAgICAgICAgIHZhciBkZXNjID0gT2JqZWN0LmRlZmluZVByb3BlcnR5ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KSA6IHt9OwoKICAgICAgICAgIGlmIChkZXNjLmdldCB8fCBkZXNjLnNldCkgewogICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobmV3T2JqLCBrZXksIGRlc2MpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBuZXdPYmouZGVmYXVsdCA9IG9iajsKICAgIHJldHVybiBuZXdPYmo7CiAgfQp9CgpmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsKICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7CgogIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7CiAgICB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsKICAgIGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsKICAgICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7CiAgICB9KTsKICAgIGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsKICB9CgogIHJldHVybiBrZXlzOwp9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgewogIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsKCiAgICBpZiAoaSAlIDIpIHsKICAgICAgb3duS2V5cyhzb3VyY2UsIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOwogICAgICB9KTsKICAgIH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsKICAgIH0gZWxzZSB7CiAgICAgIG93bktleXMoc291cmNlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsKICAgICAgfSk7CiAgICB9CiAgfQoKICByZXR1cm4gdGFyZ2V0Owp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7CiAgaWYgKGtleSBpbiBvYmopIHsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgICB2YWx1ZTogdmFsdWUsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgd3JpdGFibGU6IHRydWUKICAgIH0pOwogIH0gZWxzZSB7CiAgICBvYmpba2V5XSA9IHZhbHVlOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKZnVuY3Rpb24gX3RvQ29uc3VtYWJsZUFycmF5KGFycikgewogIHJldHVybiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5KGFycikgfHwgX25vbkl0ZXJhYmxlU3ByZWFkKCk7Cn0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVNwcmVhZCgpIHsKICB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gc3ByZWFkIG5vbi1pdGVyYWJsZSBpbnN0YW5jZSIpOwp9CgpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5KGl0ZXIpIHsKICBpZiAoU3ltYm9sLml0ZXJhdG9yIGluIE9iamVjdChpdGVyKSB8fCBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoaXRlcikgPT09ICJbb2JqZWN0IEFyZ3VtZW50c10iKSByZXR1cm4gQXJyYXkuZnJvbShpdGVyKTsKfQoKZnVuY3Rpb24gX2FycmF5V2l0aG91dEhvbGVzKGFycikgewogIGlmIChBcnJheS5pc0FycmF5KGFycikpIHsKICAgIGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGFyci5sZW5ndGgpOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7CiAgICAgIGFycjJbaV0gPSBhcnJbaV07CiAgICB9CgogICAgcmV0dXJuIGFycjI7CiAgfQp9CgpmdW5jdGlvbiBfc2xpY2VkVG9BcnJheShhcnIsIGkpIHsKICByZXR1cm4gX2FycmF5V2l0aEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgfHwgX25vbkl0ZXJhYmxlUmVzdCgpOwp9CgpmdW5jdGlvbiBfbm9uSXRlcmFibGVSZXN0KCkgewogIHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2UiKTsKfQoKZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgewogIHZhciBfYXJyID0gW107CiAgdmFyIF9uID0gdHJ1ZTsKICB2YXIgX2QgPSBmYWxzZTsKICB2YXIgX2UgPSB1bmRlZmluZWQ7CgogIHRyeSB7CiAgICBmb3IgKHZhciBfaSA9IGFycltTeW1ib2wuaXRlcmF0b3JdKCksIF9zOyAhKF9uID0gKF9zID0gX2kubmV4dCgpKS5kb25lKTsgX24gPSB0cnVlKSB7CiAgICAgIF9hcnIucHVzaChfcy52YWx1ZSk7CgogICAgICBpZiAoaSAmJiBfYXJyLmxlbmd0aCA9PT0gaSkgYnJlYWs7CiAgICB9CiAgfSBjYXRjaCAoZXJyKSB7CiAgICBfZCA9IHRydWU7CiAgICBfZSA9IGVycjsKICB9IGZpbmFsbHkgewogICAgdHJ5IHsKICAgICAgaWYgKCFfbiAmJiBfaVsicmV0dXJuIl0gIT0gbnVsbCkgX2lbInJldHVybiJdKCk7CiAgICB9IGZpbmFsbHkgewogICAgICBpZiAoX2QpIHRocm93IF9lOwogICAgfQogIH0KCiAgcmV0dXJuIF9hcnI7Cn0KCmZ1bmN0aW9uIF9hcnJheVdpdGhIb2xlcyhhcnIpIHsKICBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSByZXR1cm4gYXJyOwp9Cgp2YXIgZXhwcmVzc2lvbkZpZWxkc1dpdGhWYWxpZGF0aW9uID0gWydhZ2dGaWVsZCcsICd0ZXJtU2l6ZScsICd0ZXJtRmllbGQnLCAndGhyZXNob2xkMCcsICd0aHJlc2hvbGQxJywgJ3RpbWVXaW5kb3dTaXplJ107CnZhciBleHByZXNzaW9uRmllbGRzID0gWydhZ2dUeXBlJywgJ2FnZ0ZpZWxkJywgJ3Rlcm1TaXplJywgJ3Rlcm1GaWVsZCcsICd0aHJlc2hvbGRDb21wYXJhdG9yJywgJ3RpbWVXaW5kb3dTaXplJywgJ3RpbWVXaW5kb3dVbml0JywgJ3RyaWdnZXJJbnRlcnZhbFNpemUnLCAndHJpZ2dlckludGVydmFsVW5pdCcsICd0aHJlc2hvbGQnLCAnZ3JvdXBCeSddOwoKdmFyIGV4cHJlc3Npb25FcnJvck1lc3NhZ2UgPSBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2sud2F0Y2hlci50aHJlc2hvbGRXYXRjaEV4cHJlc3Npb24uZml4RXJyb3JJbkV4cHJlc3Npb25CZWxvd1ZhbGlkYXRpb25NZXNzYWdlJywgewogIGRlZmF1bHRNZXNzYWdlOiAnRXhwcmVzc2lvbiBjb250YWlucyBlcnJvcnMuJwp9KTsKCnZhciBmaXJzdEZpZWxkT3B0aW9uID0gewogIHRleHQ6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay53YXRjaGVyLnNlY3Rpb25zLndhdGNoRWRpdC50aXRsZVBhbmVsLnRpbWVGaWVsZE9wdGlvbkxhYmVsJywgewogICAgZGVmYXVsdE1lc3NhZ2U6ICdTZWxlY3QgYSBmaWVsZCcKICB9KSwKICB2YWx1ZTogJycKfTsKCnZhciBnZXRUaW1lT3B0aW9ucyA9IGZ1bmN0aW9uIGdldFRpbWVPcHRpb25zKHVuaXRTaXplKSB7CiAgcmV0dXJuIE9iamVjdC5lbnRyaWVzKF9jb25zdGFudHMuVElNRV9VTklUUykubWFwKGZ1bmN0aW9uIChfcmVmKSB7CiAgICB2YXIgX3JlZjIgPSBfc2xpY2VkVG9BcnJheShfcmVmLCAyKSwKICAgICAgICBfa2V5ID0gX3JlZjJbMF0sCiAgICAgICAgdmFsdWUgPSBfcmVmMlsxXTsKCiAgICByZXR1cm4gewogICAgICB0ZXh0OiAoMCwgX2dldF90aW1lX3VuaXRfbGFiZWwuZ2V0VGltZVVuaXRMYWJlbCkodmFsdWUsIHVuaXRTaXplKSwKICAgICAgdmFsdWU6IHZhbHVlCiAgICB9OwogIH0pOwp9OwoKdmFyIGdldEZpZWxkcyA9IGZ1bmN0aW9uIGdldEZpZWxkcyhpbmRpY2VzKSB7CiAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hc3luYyhmdW5jdGlvbiBnZXRGaWVsZHMkKF9jb250ZXh0KSB7CiAgICB3aGlsZSAoMSkgewogICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI7CiAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKCgwLCBfYXBpLmZldGNoRmllbGRzKShpbmRpY2VzKSk7CgogICAgICAgIGNhc2UgMjoKICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIF9jb250ZXh0LnNlbnQpOwoKICAgICAgICBjYXNlIDM6CiAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgIH0KICAgIH0KICB9KTsKfTsKCnZhciBnZXRUaW1lRmllbGRPcHRpb25zID0gZnVuY3Rpb24gZ2V0VGltZUZpZWxkT3B0aW9ucyhmaWVsZHMpIHsKICB2YXIgb3B0aW9ucyA9IFtmaXJzdEZpZWxkT3B0aW9uXTsKICBmaWVsZHMuZm9yRWFjaChmdW5jdGlvbiAoZmllbGQpIHsKICAgIGlmIChmaWVsZC50eXBlID09PSAnZGF0ZScpIHsKICAgICAgb3B0aW9ucy5wdXNoKHsKICAgICAgICB0ZXh0OiBmaWVsZC5uYW1lLAogICAgICAgIHZhbHVlOiBmaWVsZC5uYW1lCiAgICAgIH0pOwogICAgfQogIH0pOwogIHJldHVybiBvcHRpb25zOwp9OwoKdmFyIGdldEluZGV4T3B0aW9ucyA9IGZ1bmN0aW9uIGdldEluZGV4T3B0aW9ucyhwYXR0ZXJuU3RyaW5nLCBpbmRleFBhdHRlcm5zKSB7CiAgdmFyIG9wdGlvbnMsIG1hdGNoaW5nSW5kaWNlcywgbWF0Y2hpbmdJbmRleFBhdHRlcm5zLCBtYXRjaGluZ09wdGlvbnM7CiAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hc3luYyhmdW5jdGlvbiBnZXRJbmRleE9wdGlvbnMkKF9jb250ZXh0MikgewogICAgd2hpbGUgKDEpIHsKICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgb3B0aW9ucyA9IFtdOwoKICAgICAgICAgIGlmIChwYXR0ZXJuU3RyaW5nKSB7CiAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMzsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIsIG9wdGlvbnMpOwoKICAgICAgICBjYXNlIDM6CiAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDU7CiAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKCgwLCBfYXBpLmdldE1hdGNoaW5nSW5kaWNlcykocGF0dGVyblN0cmluZykpOwoKICAgICAgICBjYXNlIDU6CiAgICAgICAgICBtYXRjaGluZ0luZGljZXMgPSBfY29udGV4dDIuc2VudDsKICAgICAgICAgIG1hdGNoaW5nSW5kZXhQYXR0ZXJucyA9IGluZGV4UGF0dGVybnMuZmlsdGVyKGZ1bmN0aW9uIChhbkluZGV4UGF0dGVybikgewogICAgICAgICAgICByZXR1cm4gYW5JbmRleFBhdHRlcm4uaW5jbHVkZXMocGF0dGVyblN0cmluZyk7CiAgICAgICAgICB9KTsKCiAgICAgICAgICBpZiAobWF0Y2hpbmdJbmRpY2VzLmxlbmd0aCB8fCBtYXRjaGluZ0luZGV4UGF0dGVybnMubGVuZ3RoKSB7CiAgICAgICAgICAgIG1hdGNoaW5nT3B0aW9ucyA9IF8udW5pcShbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KG1hdGNoaW5nSW5kaWNlcyksIF90b0NvbnN1bWFibGVBcnJheShtYXRjaGluZ0luZGV4UGF0dGVybnMpKSk7CiAgICAgICAgICAgIG9wdGlvbnMucHVzaCh7CiAgICAgICAgICAgICAgbGFiZWw6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay53YXRjaGVyLnNlY3Rpb25zLndhdGNoRWRpdC50aXRsZVBhbmVsLmluZGljZXNBbmRJbmRleFBhdHRlcm5zTGFiZWwnLCB7CiAgICAgICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0Jhc2VkIG9uIHlvdXIgaW5kaWNlcyBhbmQgaW5kZXggcGF0dGVybnMnCiAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgb3B0aW9uczogbWF0Y2hpbmdPcHRpb25zLm1hcChmdW5jdGlvbiAobWF0Y2gpIHsKICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgIGxhYmVsOiBtYXRjaCwKICAgICAgICAgICAgICAgICAgdmFsdWU6IG1hdGNoCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgIH0pLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgICAgICAgICAgIHJldHVybiBTdHJpbmcoYS5sYWJlbCkubG9jYWxlQ29tcGFyZShiLmxhYmVsKTsKICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KCiAgICAgICAgICBvcHRpb25zLnB1c2goewogICAgICAgICAgICBsYWJlbDogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLndhdGNoZXIuc2VjdGlvbnMud2F0Y2hFZGl0LnRpdGxlUGFuZWwuY2hvb3NlTGFiZWwnLCB7CiAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdDaG9vc2XigKYnCiAgICAgICAgICAgIH0pLAogICAgICAgICAgICBvcHRpb25zOiBbewogICAgICAgICAgICAgIGtleTogJ1VOSVFVRV9DSE9PU0VfS0VZJywKICAgICAgICAgICAgICB2YWx1ZTogcGF0dGVyblN0cmluZywKICAgICAgICAgICAgICBsYWJlbDogcGF0dGVyblN0cmluZwogICAgICAgICAgICB9XQogICAgICAgICAgfSk7CiAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIiwgb3B0aW9ucyk7CgogICAgICAgIGNhc2UgMTA6CiAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICB9CiAgICB9CiAgfSk7Cn07Cgp2YXIgVGhyZXNob2xkV2F0Y2hFZGl0ID0gZnVuY3Rpb24gVGhyZXNob2xkV2F0Y2hFZGl0KF9yZWYzKSB7CiAgdmFyIHBhZ2VUaXRsZSA9IF9yZWYzLnBhZ2VUaXRsZTsgLy8gaG9va3MKCiAgdmFyIF91c2VBcHBDb250ZXh0ID0gKDAsIF9hcHBfY29udGV4dC51c2VBcHBDb250ZXh0KSgpLAogICAgICB0b2FzdHMgPSBfdXNlQXBwQ29udGV4dC50b2FzdHM7CgogIHZhciBfdXNlU3RhdGUgPSAoMCwgX3JlYWN0LnVzZVN0YXRlKShbXSksCiAgICAgIF91c2VTdGF0ZTIgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUsIDIpLAogICAgICBpbmRleFBhdHRlcm5zID0gX3VzZVN0YXRlMlswXSwKICAgICAgc2V0SW5kZXhQYXR0ZXJucyA9IF91c2VTdGF0ZTJbMV07CgogIHZhciBfdXNlU3RhdGUzID0gKDAsIF9yZWFjdC51c2VTdGF0ZSkoW10pLAogICAgICBfdXNlU3RhdGU0ID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlMywgMiksCiAgICAgIGVzRmllbGRzID0gX3VzZVN0YXRlNFswXSwKICAgICAgc2V0RXNGaWVsZHMgPSBfdXNlU3RhdGU0WzFdOwoKICB2YXIgX3VzZVN0YXRlNSA9ICgwLCBfcmVhY3QudXNlU3RhdGUpKFtdKSwKICAgICAgX3VzZVN0YXRlNiA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZTUsIDIpLAogICAgICBpbmRleE9wdGlvbnMgPSBfdXNlU3RhdGU2WzBdLAogICAgICBzZXRJbmRleE9wdGlvbnMgPSBfdXNlU3RhdGU2WzFdOwoKICB2YXIgX3VzZVN0YXRlNyA9ICgwLCBfcmVhY3QudXNlU3RhdGUpKFtmaXJzdEZpZWxkT3B0aW9uXSksCiAgICAgIF91c2VTdGF0ZTggPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGU3LCAyKSwKICAgICAgdGltZUZpZWxkT3B0aW9ucyA9IF91c2VTdGF0ZThbMF0sCiAgICAgIHNldFRpbWVGaWVsZE9wdGlvbnMgPSBfdXNlU3RhdGU4WzFdOwoKICB2YXIgX3VzZVN0YXRlOSA9ICgwLCBfcmVhY3QudXNlU3RhdGUpKGZhbHNlKSwKICAgICAgX3VzZVN0YXRlMTAgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGU5LCAyKSwKICAgICAgYWdnRmllbGRQb3BvdmVyT3BlbiA9IF91c2VTdGF0ZTEwWzBdLAogICAgICBzZXRBZ2dGaWVsZFBvcG92ZXJPcGVuID0gX3VzZVN0YXRlMTBbMV07CgogIHZhciBfdXNlU3RhdGUxMSA9ICgwLCBfcmVhY3QudXNlU3RhdGUpKGZhbHNlKSwKICAgICAgX3VzZVN0YXRlMTIgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUxMSwgMiksCiAgICAgIGdyb3VwQnlQb3BvdmVyT3BlbiA9IF91c2VTdGF0ZTEyWzBdLAogICAgICBzZXRHcm91cEJ5UG9wb3Zlck9wZW4gPSBfdXNlU3RhdGUxMlsxXTsKCiAgdmFyIF91c2VTdGF0ZTEzID0gKDAsIF9yZWFjdC51c2VTdGF0ZSkoZmFsc2UpLAogICAgICBfdXNlU3RhdGUxNCA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZTEzLCAyKSwKICAgICAgd2F0Y2hUaHJlc2hvbGRQb3BvdmVyT3BlbiA9IF91c2VTdGF0ZTE0WzBdLAogICAgICBzZXRXYXRjaFRocmVzaG9sZFBvcG92ZXJPcGVuID0gX3VzZVN0YXRlMTRbMV07CgogIHZhciBfdXNlU3RhdGUxNSA9ICgwLCBfcmVhY3QudXNlU3RhdGUpKGZhbHNlKSwKICAgICAgX3VzZVN0YXRlMTYgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUxNSwgMiksCiAgICAgIHdhdGNoRHVyYXRpb25Qb3BvdmVyT3BlbiA9IF91c2VTdGF0ZTE2WzBdLAogICAgICBzZXRXYXRjaER1cmF0aW9uUG9wb3Zlck9wZW4gPSBfdXNlU3RhdGUxNlsxXTsKCiAgdmFyIF91c2VTdGF0ZTE3ID0gKDAsIF9yZWFjdC51c2VTdGF0ZSkoZmFsc2UpLAogICAgICBfdXNlU3RhdGUxOCA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZTE3LCAyKSwKICAgICAgYWdnVHlwZVBvcG92ZXJPcGVuID0gX3VzZVN0YXRlMThbMF0sCiAgICAgIHNldEFnZ1R5cGVQb3BvdmVyT3BlbiA9IF91c2VTdGF0ZTE4WzFdOwoKICB2YXIgX3VzZVN0YXRlMTkgPSAoMCwgX3JlYWN0LnVzZVN0YXRlKShudWxsKSwKICAgICAgX3VzZVN0YXRlMjAgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUxOSwgMiksCiAgICAgIHNlcnZlckVycm9yID0gX3VzZVN0YXRlMjBbMF0sCiAgICAgIHNldFNlcnZlckVycm9yID0gX3VzZVN0YXRlMjBbMV07CgogIHZhciBfdXNlU3RhdGUyMSA9ICgwLCBfcmVhY3QudXNlU3RhdGUpKGZhbHNlKSwKICAgICAgX3VzZVN0YXRlMjIgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUyMSwgMiksCiAgICAgIGlzU2F2aW5nID0gX3VzZVN0YXRlMjJbMF0sCiAgICAgIHNldElzU2F2aW5nID0gX3VzZVN0YXRlMjJbMV07CgogIHZhciBfdXNlU3RhdGUyMyA9ICgwLCBfcmVhY3QudXNlU3RhdGUpKGZhbHNlKSwKICAgICAgX3VzZVN0YXRlMjQgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUyMywgMiksCiAgICAgIGlzSW5kaWNpZXNMb2FkaW5nID0gX3VzZVN0YXRlMjRbMF0sCiAgICAgIHNldElzSW5kaWNpZXNMb2FkaW5nID0gX3VzZVN0YXRlMjRbMV07CgogIHZhciBfdXNlU3RhdGUyNSA9ICgwLCBfcmVhY3QudXNlU3RhdGUpKGZhbHNlKSwKICAgICAgX3VzZVN0YXRlMjYgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUyNSwgMiksCiAgICAgIGlzUmVxdWVzdFZpc2libGUgPSBfdXNlU3RhdGUyNlswXSwKICAgICAgc2V0SXNSZXF1ZXN0VmlzaWJsZSA9IF91c2VTdGF0ZTI2WzFdOwoKICB2YXIgX3VzZUNvbnRleHQgPSAoMCwgX3JlYWN0LnVzZUNvbnRleHQpKF93YXRjaF9jb250ZXh0LldhdGNoQ29udGV4dCksCiAgICAgIHdhdGNoID0gX3VzZUNvbnRleHQud2F0Y2gsCiAgICAgIHNldFdhdGNoUHJvcGVydHkgPSBfdXNlQ29udGV4dC5zZXRXYXRjaFByb3BlcnR5OwoKICAoMCwgX3JlYWN0LnVzZUVmZmVjdCkoZnVuY3Rpb24gKCkgewogICAgdmFyIGdldEluZGV4UGF0dGVybnMgPSBmdW5jdGlvbiBnZXRJbmRleFBhdHRlcm5zKCkgewogICAgICB2YXIgaW5kZXhQYXR0ZXJuT2JqZWN0cywgdGl0bGVzOwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmFzeW5jKGZ1bmN0aW9uIGdldEluZGV4UGF0dGVybnMkKF9jb250ZXh0MykgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMjsKICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKCgwLCBfYXBpLmxvYWRJbmRleFBhdHRlcm5zKSgpKTsKCiAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICBpbmRleFBhdHRlcm5PYmplY3RzID0gX2NvbnRleHQzLnNlbnQ7CiAgICAgICAgICAgICAgdGl0bGVzID0gaW5kZXhQYXR0ZXJuT2JqZWN0cy5tYXAoZnVuY3Rpb24gKGluZGV4UGF0dGVybikgewogICAgICAgICAgICAgICAgcmV0dXJuIGluZGV4UGF0dGVybi5hdHRyaWJ1dGVzLnRpdGxlOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIHNldEluZGV4UGF0dGVybnModGl0bGVzKTsKCiAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfTsKCiAgICB2YXIgbG9hZERhdGEgPSBmdW5jdGlvbiBsb2FkRGF0YSgpIHsKICAgICAgdmFyIGFsbEVzRmllbGRzLCB0aW1lRmllbGRzOwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmFzeW5jKGZ1bmN0aW9uIGxvYWREYXRhJChfY29udGV4dDQpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDQucHJldiA9IF9jb250ZXh0NC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBpZiAoISh3YXRjaC5pbmRleCAmJiB3YXRjaC5pbmRleC5sZW5ndGggPiAwKSkgewogICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSA4OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDM7CiAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hd3JhcChnZXRGaWVsZHMod2F0Y2guaW5kZXgpKTsKCiAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICBhbGxFc0ZpZWxkcyA9IF9jb250ZXh0NC5zZW50OwogICAgICAgICAgICAgIHRpbWVGaWVsZHMgPSBnZXRUaW1lRmllbGRPcHRpb25zKGFsbEVzRmllbGRzKTsKICAgICAgICAgICAgICBzZXRFc0ZpZWxkcyhhbGxFc0ZpZWxkcyk7CiAgICAgICAgICAgICAgc2V0VGltZUZpZWxkT3B0aW9ucyh0aW1lRmllbGRzKTsKICAgICAgICAgICAgICBzZXRXYXRjaFByb3BlcnR5KCd0aW1lRmllbGRzJywgdGltZUZpZWxkcyk7CgogICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgZ2V0SW5kZXhQYXR0ZXJucygpOwoKICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9OwoKICAgIGxvYWREYXRhKCk7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC1ob29rcy9leGhhdXN0aXZlLWRlcHMKICB9LCBbXSk7CgogIHZhciBfd2F0Y2gkdmFsaWRhdGUgPSB3YXRjaC52YWxpZGF0ZSgpLAogICAgICBlcnJvcnMgPSBfd2F0Y2gkdmFsaWRhdGUuZXJyb3JzOwoKICB2YXIgaGFzRXJyb3JzID0gISFPYmplY3Qua2V5cyhlcnJvcnMpLmZpbmQoZnVuY3Rpb24gKGVycm9yS2V5KSB7CiAgICByZXR1cm4gZXJyb3JzW2Vycm9yS2V5XS5sZW5ndGggPj0gMTsKICB9KTsKICB2YXIgYWN0aW9uRXJyb3JzID0gd2F0Y2guYWN0aW9ucy5yZWR1Y2UoZnVuY3Rpb24gKGFjYywgYWN0aW9uKSB7CiAgICB2YXIgYWN0aW9uVmFsaWRhdGlvbkVycm9ycyA9IGFjdGlvbi52YWxpZGF0ZSgpOwogICAgYWNjW2FjdGlvbi5pZF0gPSBhY3Rpb25WYWxpZGF0aW9uRXJyb3JzOwogICAgcmV0dXJuIGFjYzsKICB9LCB7fSk7CiAgdmFyIGhhc0FjdGlvbkVycm9ycyA9ICEhT2JqZWN0LmtleXMoYWN0aW9uRXJyb3JzKS5maW5kKGZ1bmN0aW9uIChhY3Rpb25FcnJvcikgewogICAgcmV0dXJuICEhT2JqZWN0LmtleXMoYWN0aW9uRXJyb3JzW2FjdGlvbkVycm9yXSkuZmluZChmdW5jdGlvbiAoYWN0aW9uRXJyb3JLZXkpIHsKICAgICAgcmV0dXJuIGFjdGlvbkVycm9yc1thY3Rpb25FcnJvcl1bYWN0aW9uRXJyb3JLZXldLmxlbmd0aCA+PSAxOwogICAgfSk7CiAgfSk7CiAgdmFyIGhhc0V4cHJlc3Npb25FcnJvcnMgPSAhIU9iamVjdC5rZXlzKGVycm9ycykuZmluZChmdW5jdGlvbiAoZXJyb3JLZXkpIHsKICAgIHJldHVybiBleHByZXNzaW9uRmllbGRzV2l0aFZhbGlkYXRpb24uaW5jbHVkZXMoZXJyb3JLZXkpICYmIGVycm9yc1tlcnJvcktleV0ubGVuZ3RoID49IDE7CiAgfSk7CiAgdmFyIHNob3VsZFNob3dUaHJlc2hvbGRFeHByZXNzaW9uID0gd2F0Y2guaW5kZXggJiYgd2F0Y2guaW5kZXgubGVuZ3RoID4gMCAmJiB3YXRjaC50aW1lRmllbGQ7CgogIHZhciBhbmRUaHJlc2hvbGRUZXh0ID0gX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLndhdGNoZXIuc2VjdGlvbnMud2F0Y2hFZGl0LnRocmVzaG9sZC5hbmRMYWJlbCcsIHsKICAgIGRlZmF1bHRNZXNzYWdlOiAnQU5EJwogIH0pOyAvLyBVc2VycyBtaWdodCBlZGl0IHRoZSByZXF1ZXN0IGZvciB1c2Ugb3V0c2lkZSBvZiB0aGUgV2F0Y2hlciBhcHAuIElmIHRoZXkgZG8gbWFrZSBjaGFuZ2VzIHRvIGl0LAogIC8vIHdlIGhhdmUgbm8gZ3VhcmFudGVlIGl0IHdpbGwgc3RpbGwgYmUgY29tcGF0aWJsZSB3aXRoIHRoZSB0aHJlc2hvbGQgYWxlcnQgZm9ybSwgc28gd2Ugc3RyaXAKICAvLyB0aGUgbWV0YWRhdGEgdG8gYXZvaWQgcG90ZW50aWFsIGNvbmZsaWN0cy4KCgogIHZhciByZXF1ZXN0UHJldmlld1dhdGNoRGF0YSA9IF9vYmplY3RTcHJlYWQoe30sIHdhdGNoLnVwc3RyZWFtSnNvbiwgewogICAgaW5jbHVkZU1ldGFkYXRhOiBmYWxzZQogIH0pOwoKICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVBhZ2VDb250ZW50LCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEdyb3VwLCB7CiAgICBqdXN0aWZ5Q29udGVudDogInNwYWNlQmV0d2VlbiIsCiAgICBhbGlnbkl0ZW1zOiAiZmxleEVuZCIKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgIGdyb3c6IGZhbHNlCiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRpdGxlLCB7CiAgICBzaXplOiAibSIKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJoMSIsIHsKICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJwYWdlVGl0bGUiCiAgfSwgcGFnZVRpdGxlKSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTcGFjZXIsIHsKICAgIHNpemU6ICJzIgogIH0pLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVGV4dCwgewogICAgc2l6ZTogInMiLAogICAgY29sb3I6ICJzdWJkdWVkIgogIH0sIHdhdGNoLnRpdGxlRGVzY3JpcHRpb24pKSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTcGFjZXIsIG51bGwpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRm9ybSwgewogICAgImRhdGEtdGVzdC1zdWJqIjogInRocmVzaG9sZFdhdGNoRm9ybSIKICB9LCBzZXJ2ZXJFcnJvciAmJiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5GcmFnbWVudCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfY29tcG9uZW50cy5TZWN0aW9uRXJyb3IsIHsKICAgIHRpdGxlOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICBpZDogInhwYWNrLndhdGNoZXIuc2VjdGlvbnMud2F0Y2hFZGl0Lmpzb24uc2F2ZVdhdGNoRXJyb3JUaXRsZSIsCiAgICAgIGRlZmF1bHRNZXNzYWdlOiAiRXJyb3Igc2F2aW5nIHdhdGNoIgogICAgfSksCiAgICBlcnJvcjogc2VydmVyRXJyb3IKICB9KSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgbnVsbCkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9jb21wb25lbnRzLkVycmFibGVGb3JtUm93LCB7CiAgICBpZDogIndhdGNoTmFtZSIsCiAgICBsYWJlbDogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgaWQ6ICJ4cGFjay53YXRjaGVyLnNlY3Rpb25zLndhdGNoRWRpdC50aXRsZVBhbmVsLndhdGNoTmFtZUxhYmVsIiwKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJOYW1lIgogICAgfSksCiAgICBlcnJvcktleTogIm5hbWUiLAogICAgaXNTaG93aW5nRXJyb3JzOiBoYXNFcnJvcnMgJiYgd2F0Y2gubmFtZSAhPT0gdW5kZWZpbmVkLAogICAgZXJyb3JzOiBlcnJvcnMKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmllbGRUZXh0LCB7CiAgICBuYW1lOiAibmFtZSIsCiAgICAiZGF0YS10ZXN0LXN1YmoiOiAibmFtZUlucHV0IiwKICAgIHZhbHVlOiB3YXRjaC5uYW1lIHx8ICcnLAogICAgb25DaGFuZ2U6IGZ1bmN0aW9uIG9uQ2hhbmdlKGUpIHsKICAgICAgc2V0V2F0Y2hQcm9wZXJ0eSgnbmFtZScsIGUudGFyZ2V0LnZhbHVlKTsKICAgIH0sCiAgICBvbkJsdXI6IGZ1bmN0aW9uIG9uQmx1cigpIHsKICAgICAgaWYgKCF3YXRjaC5uYW1lKSB7CiAgICAgICAgc2V0V2F0Y2hQcm9wZXJ0eSgnbmFtZScsICcnKTsKICAgICAgfQogICAgfQogIH0pKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgbnVsbCksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4R3JvdXAsIHsKICAgIGp1c3RpZnlDb250ZW50OiAic3BhY2VCZXR3ZWVuIgogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfY29tcG9uZW50cy5FcnJhYmxlRm9ybVJvdywgewogICAgaWQ6ICJpbmRleFNlbGVjdFNlYXJjaEJveCIsCiAgICBmdWxsV2lkdGg6IHRydWUsCiAgICBsYWJlbDogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgaWQ6ICJ4cGFjay53YXRjaGVyLnNlY3Rpb25zLndhdGNoRWRpdC50aXRsZVBhbmVsLmluZGljZXNUb1F1ZXJ5TGFiZWwiLAogICAgICBkZWZhdWx0TWVzc2FnZTogIkluZGljZXMgdG8gcXVlcnkiCiAgICB9KSwKICAgIGVycm9yS2V5OiAiaW5kZXgiLAogICAgaXNTaG93aW5nRXJyb3JzOiBoYXNFcnJvcnMgJiYgd2F0Y2guaW5kZXggIT09IHVuZGVmaW5lZCwKICAgIGVycm9yczogZXJyb3JzLAogICAgaGVscFRleHQ6IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgIGlkOiAieHBhY2sud2F0Y2hlci5zZWN0aW9ucy53YXRjaEVkaXQudGl0bGVQYW5lbC5ob3dUb0Jyb2FkZW5TZWFyY2hRdWVyeURlc2NyaXB0aW9uIiwKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJVc2UgKiB0byBicm9hZGVuIHlvdXIgcXVlcnkuIgogICAgfSkKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQ29tYm9Cb3gsIHsKICAgIGZ1bGxXaWR0aDogdHJ1ZSwKICAgIGFzeW5jOiB0cnVlLAogICAgaXNMb2FkaW5nOiBpc0luZGljaWVzTG9hZGluZywKICAgIG5vU3VnZ2VzdGlvbnM6ICFpbmRleE9wdGlvbnMubGVuZ3RoLAogICAgb3B0aW9uczogaW5kZXhPcHRpb25zLAogICAgImRhdGEtdGVzdC1zdWJqIjogImluZGljZXNDb21ib0JveCIsCiAgICBzZWxlY3RlZE9wdGlvbnM6ICh3YXRjaC5pbmRleCB8fCBbXSkubWFwKGZ1bmN0aW9uIChhbkluZGV4KSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgbGFiZWw6IGFuSW5kZXgsCiAgICAgICAgdmFsdWU6IGFuSW5kZXgKICAgICAgfTsKICAgIH0pLAogICAgb25DaGFuZ2U6IGZ1bmN0aW9uIF9jYWxsZWUoc2VsZWN0ZWQpIHsKICAgICAgdmFyIGluZGljZXMsIGN1cnJlbnRFc0ZpZWxkcywgdGltZUZpZWxkczsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hc3luYyhmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dDUpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDUucHJldiA9IF9jb250ZXh0NS5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBzZXRXYXRjaFByb3BlcnR5KCdpbmRleCcsIHNlbGVjdGVkLm1hcChmdW5jdGlvbiAoYVNlbGVjdGVkKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gYVNlbGVjdGVkLnZhbHVlOwogICAgICAgICAgICAgIH0pKTsKICAgICAgICAgICAgICBpbmRpY2VzID0gc2VsZWN0ZWQubWFwKGZ1bmN0aW9uIChzKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gcy52YWx1ZTsKICAgICAgICAgICAgICB9KTsgLy8gcmVzZXQgdGltZSBmaWVsZCBhbmQgZXhwcmVzc2lvbiBmaWVsZHMgaWYgaW5kaWNlcyBhcmUgZGVsZXRlZAoKICAgICAgICAgICAgICBpZiAoIShpbmRpY2VzLmxlbmd0aCA9PT0gMCkpIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gNzsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgc2V0VGltZUZpZWxkT3B0aW9ucyhnZXRUaW1lRmllbGRPcHRpb25zKFtdKSk7CiAgICAgICAgICAgICAgc2V0V2F0Y2hQcm9wZXJ0eSgndGltZUZpZWxkcycsIFtdKTsKICAgICAgICAgICAgICBleHByZXNzaW9uRmllbGRzLmZvckVhY2goZnVuY3Rpb24gKGV4cHJlc3Npb25GaWVsZCkgewogICAgICAgICAgICAgICAgc2V0V2F0Y2hQcm9wZXJ0eShleHByZXNzaW9uRmllbGQsIG51bGwpOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDk7CiAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hd3JhcChnZXRGaWVsZHMoaW5kaWNlcykpOwoKICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgIGN1cnJlbnRFc0ZpZWxkcyA9IF9jb250ZXh0NS5zZW50OwogICAgICAgICAgICAgIHRpbWVGaWVsZHMgPSBnZXRUaW1lRmllbGRPcHRpb25zKGN1cnJlbnRFc0ZpZWxkcyk7CiAgICAgICAgICAgICAgc2V0RXNGaWVsZHMoY3VycmVudEVzRmllbGRzKTsKICAgICAgICAgICAgICBzZXRXYXRjaFByb3BlcnR5KCd0aW1lRmllbGRzJywgdGltZUZpZWxkcyk7CiAgICAgICAgICAgICAgc2V0VGltZUZpZWxkT3B0aW9ucyh0aW1lRmllbGRzKTsKCiAgICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBvblNlYXJjaENoYW5nZTogZnVuY3Rpb24gX2NhbGxlZTIoc2VhcmNoKSB7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXN5bmMoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0NikgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Ni5wcmV2ID0gX2NvbnRleHQ2Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIHNldElzSW5kaWNpZXNMb2FkaW5nKHRydWUpOwogICAgICAgICAgICAgIF9jb250ZXh0Ni50MCA9IHNldEluZGV4T3B0aW9uczsKICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDQ7CiAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hd3JhcChnZXRJbmRleE9wdGlvbnMoc2VhcmNoLCBpbmRleFBhdHRlcm5zKSk7CgogICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgX2NvbnRleHQ2LnQxID0gX2NvbnRleHQ2LnNlbnQ7CiAgICAgICAgICAgICAgKDAsIF9jb250ZXh0Ni50MCkoX2NvbnRleHQ2LnQxKTsKICAgICAgICAgICAgICBzZXRJc0luZGljaWVzTG9hZGluZyhmYWxzZSk7CgogICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBvbkJsdXI6IGZ1bmN0aW9uIG9uQmx1cigpIHsKICAgICAgaWYgKCF3YXRjaC5pbmRleCkgewogICAgICAgIHNldFdhdGNoUHJvcGVydHkoJ2luZGV4JywgW10pOwogICAgICB9CiAgICB9CiAgfSkpKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICBncm93OiBmYWxzZQogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2NvbXBvbmVudHMuRXJyYWJsZUZvcm1Sb3csIHsKICAgIGlkOiAidGltZUZpZWxkIiwKICAgIGZ1bGxXaWR0aDogdHJ1ZSwKICAgIGxhYmVsOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICBpZDogInhwYWNrLndhdGNoZXIuc2VjdGlvbnMud2F0Y2hFZGl0LnRpdGxlUGFuZWwudGltZUZpZWxkTGFiZWwiLAogICAgICBkZWZhdWx0TWVzc2FnZTogIlRpbWUgZmllbGQiCiAgICB9KSwKICAgIGVycm9yS2V5OiAidGltZUZpZWxkIiwKICAgIGlzU2hvd2luZ0Vycm9yczogaGFzRXJyb3JzICYmIHdhdGNoLnRpbWVGaWVsZCAhPT0gdW5kZWZpbmVkLAogICAgZXJyb3JzOiBlcnJvcnMKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU2VsZWN0LCB7CiAgICBvcHRpb25zOiB0aW1lRmllbGRPcHRpb25zLAogICAgZnVsbFdpZHRoOiB0cnVlLAogICAgbmFtZTogIndhdGNoVGltZUZpZWxkIiwKICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJ3YXRjaFRpbWVGaWVsZFNlbGVjdCIsCiAgICB2YWx1ZTogd2F0Y2gudGltZUZpZWxkLAogICAgb25DaGFuZ2U6IGZ1bmN0aW9uIG9uQ2hhbmdlKGUpIHsKICAgICAgc2V0V2F0Y2hQcm9wZXJ0eSgndGltZUZpZWxkJywgZS50YXJnZXQudmFsdWUpOwogICAgfSwKICAgIG9uQmx1cjogZnVuY3Rpb24gb25CbHVyKCkgewogICAgICBpZiAod2F0Y2gudGltZUZpZWxkID09PSB1bmRlZmluZWQpIHsKICAgICAgICBzZXRXYXRjaFByb3BlcnR5KCd0aW1lRmllbGQnLCAnJyk7CiAgICAgIH0KICAgIH0KICB9KSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2NvbXBvbmVudHMuRXJyYWJsZUZvcm1Sb3csIHsKICAgIGlkOiAid2F0Y2hJbnRlcnZhbCIsCiAgICBmdWxsV2lkdGg6IHRydWUsCiAgICBsYWJlbDogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgaWQ6ICJ4cGFjay53YXRjaGVyLnNlY3Rpb25zLndhdGNoRWRpdC50aXRsZVBhbmVsLndhdGNoSW50ZXJ2YWxMYWJlbCIsCiAgICAgIGRlZmF1bHRNZXNzYWdlOiAiUnVuIHdhdGNoIGV2ZXJ5IgogICAgfSksCiAgICBlcnJvcktleTogInRyaWdnZXJJbnRlcnZhbFNpemUiLAogICAgaXNTaG93aW5nRXJyb3JzOiBoYXNFcnJvcnMgJiYgd2F0Y2gudHJpZ2dlckludGVydmFsU2l6ZSAhPT0gdW5kZWZpbmVkLAogICAgZXJyb3JzOiBlcnJvcnMKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEdyb3VwLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGaWVsZE51bWJlciwgewogICAgZnVsbFdpZHRoOiB0cnVlLAogICAgbWluOiAxLAogICAgdmFsdWU6IHdhdGNoLnRyaWdnZXJJbnRlcnZhbFNpemUsCiAgICAiZGF0YS10ZXN0LXN1YmoiOiAidHJpZ2dlckludGVydmFsU2l6ZUlucHV0IiwKICAgIG9uQ2hhbmdlOiBmdW5jdGlvbiBvbkNoYW5nZShlKSB7CiAgICAgIHZhciB2YWx1ZSA9IGUudGFyZ2V0LnZhbHVlOwogICAgICB2YXIgdHJpZ2dlckludGVydmFsU2l6ZSA9IHZhbHVlICE9PSAnJyA/IHBhcnNlSW50KHZhbHVlLCAxMCkgOiB2YWx1ZTsKICAgICAgc2V0V2F0Y2hQcm9wZXJ0eSgndHJpZ2dlckludGVydmFsU2l6ZScsIHRyaWdnZXJJbnRlcnZhbFNpemUpOwogICAgfSwKICAgIG9uQmx1cjogZnVuY3Rpb24gb25CbHVyKGUpIHsKICAgICAgaWYgKHdhdGNoLnRyaWdnZXJJbnRlcnZhbFNpemUgPT09IHVuZGVmaW5lZCkgewogICAgICAgIHNldFdhdGNoUHJvcGVydHkoJ3RyaWdnZXJJbnRlcnZhbFNpemUnLCAnJyk7CiAgICAgIH0KICAgIH0KICB9KSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNlbGVjdCwgewogICAgZnVsbFdpZHRoOiB0cnVlLAogICAgdmFsdWU6IHdhdGNoLnRyaWdnZXJJbnRlcnZhbFVuaXQsCiAgICAiYXJpYS1sYWJlbCI6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay53YXRjaGVyLnNlY3Rpb25zLndhdGNoRWRpdC50aXRsZVBhbmVsLmR1cmF0aW9uQXJpYUxhYmVsJywgewogICAgICBkZWZhdWx0TWVzc2FnZTogJ0R1cmF0aW9uIHRpbWUgdW5pdCcKICAgIH0pLAogICAgb25DaGFuZ2U6IGZ1bmN0aW9uIG9uQ2hhbmdlKGUpIHsKICAgICAgc2V0V2F0Y2hQcm9wZXJ0eSgndHJpZ2dlckludGVydmFsVW5pdCcsIGUudGFyZ2V0LnZhbHVlKTsKICAgIH0sCiAgICBvcHRpb25zOiBnZXRUaW1lT3B0aW9ucyh3YXRjaC50cmlnZ2VySW50ZXJ2YWxTaXplKQogIH0pKSkpKSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTcGFjZXIsIG51bGwpLCBzaG91bGRTaG93VGhyZXNob2xkRXhwcmVzc2lvbiA/IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LkZyYWdtZW50LCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVGl0bGUsIHsKICAgIHNpemU6ICJzIgogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImgyIiwgewogICAgImRhdGEtdGVzdC1zdWJqIjogIndhdGNoQ29uZGl0aW9uVGl0bGUiCiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgIGlkOiAieHBhY2sud2F0Y2hlci5zZWN0aW9ucy53YXRjaEVkaXQud2F0Y2hDb25kaXRpb25TZWN0aW9uVGl0bGUiLAogICAgZGVmYXVsdE1lc3NhZ2U6ICJNYXRjaCB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbiIKICB9KSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3BhY2VyLCB7CiAgICBzaXplOiAibSIKICB9KSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhHcm91cCwgewogICAgZ3V0dGVyU2l6ZTogInMiCiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICBncm93OiBmYWxzZQogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlQb3BvdmVyLCB7CiAgICBpZDogImFnZ1R5cGVQb3BvdmVyIiwKICAgIGJ1dHRvbjogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUV4cHJlc3Npb24sIHsKICAgICAgZGVzY3JpcHRpb246IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay53YXRjaGVyLnNlY3Rpb25zLndhdGNoRWRpdC50aHJlc2hvbGQud2hlbkxhYmVsJywgewogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnd2hlbicKICAgICAgfSksCiAgICAgIHZhbHVlOiBfYWdnX3R5cGVzLmFnZ1R5cGVzW3dhdGNoLmFnZ1R5cGVdLnRleHQsCiAgICAgIGlzQWN0aXZlOiBhZ2dUeXBlUG9wb3Zlck9wZW4sCiAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7CiAgICAgICAgc2V0QWdnVHlwZVBvcG92ZXJPcGVuKHRydWUpOwogICAgICB9CiAgICB9KSwKICAgIGlzT3BlbjogYWdnVHlwZVBvcG92ZXJPcGVuLAogICAgY2xvc2VQb3BvdmVyOiBmdW5jdGlvbiBjbG9zZVBvcG92ZXIoKSB7CiAgICAgIHNldEFnZ1R5cGVQb3BvdmVyT3BlbihmYWxzZSk7CiAgICB9LAogICAgb3duRm9jdXM6IHRydWUsCiAgICB3aXRoVGl0bGU6IHRydWUsCiAgICBhbmNob3JQb3NpdGlvbjogImRvd25MZWZ0IgogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlQb3BvdmVyVGl0bGUsIG51bGwsIF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay53YXRjaGVyLnNlY3Rpb25zLndhdGNoRWRpdC50aHJlc2hvbGQud2hlbkJ1dHRvbkxhYmVsJywgewogICAgZGVmYXVsdE1lc3NhZ2U6ICd3aGVuJwogIH0pKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNlbGVjdCwgewogICAgdmFsdWU6IHdhdGNoLmFnZ1R5cGUsCiAgICBvbkNoYW5nZTogZnVuY3Rpb24gb25DaGFuZ2UoZSkgewogICAgICBzZXRXYXRjaFByb3BlcnR5KCdhZ2dUeXBlJywgZS50YXJnZXQudmFsdWUpOwogICAgICBzZXRBZ2dUeXBlUG9wb3Zlck9wZW4oZmFsc2UpOwogICAgfSwKICAgIG9wdGlvbnM6IE9iamVjdC52YWx1ZXMoX2FnZ190eXBlcy5hZ2dUeXBlcykubWFwKGZ1bmN0aW9uIChfcmVmNCkgewogICAgICB2YXIgdGV4dCA9IF9yZWY0LnRleHQsCiAgICAgICAgICB2YWx1ZSA9IF9yZWY0LnZhbHVlOwogICAgICByZXR1cm4gewogICAgICAgIHRleHQ6IHRleHQsCiAgICAgICAgdmFsdWU6IHZhbHVlCiAgICAgIH07CiAgICB9KQogIH0pKSkpLCB3YXRjaC5hZ2dUeXBlICYmIF9hZ2dfdHlwZXMuYWdnVHlwZXNbd2F0Y2guYWdnVHlwZV0uZmllbGRSZXF1aXJlZCA/IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgZ3JvdzogZmFsc2UKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpUG9wb3ZlciwgewogICAgaWQ6ICJhZ2dGaWVsZFBvcG92ZXIiLAogICAgYnV0dG9uOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRXhwcmVzc2lvbiwgewogICAgICBkZXNjcmlwdGlvbjogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLndhdGNoZXIuc2VjdGlvbnMud2F0Y2hFZGl0LnRocmVzaG9sZC5vZkxhYmVsJywgewogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnb2YnCiAgICAgIH0pLAogICAgICB2YWx1ZTogd2F0Y2guYWdnRmllbGQgfHwgZmlyc3RGaWVsZE9wdGlvbi50ZXh0LAogICAgICBpc0FjdGl2ZTogYWdnRmllbGRQb3BvdmVyT3BlbiB8fCAhd2F0Y2guYWdnRmllbGQsCiAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7CiAgICAgICAgc2V0QWdnRmllbGRQb3BvdmVyT3Blbih0cnVlKTsKICAgICAgfSwKICAgICAgY29sb3I6IHdhdGNoLmFnZ0ZpZWxkID8gJ3NlY29uZGFyeScgOiAnZGFuZ2VyJwogICAgfSksCiAgICBpc09wZW46IGFnZ0ZpZWxkUG9wb3Zlck9wZW4sCiAgICBjbG9zZVBvcG92ZXI6IGZ1bmN0aW9uIGNsb3NlUG9wb3ZlcigpIHsKICAgICAgc2V0QWdnRmllbGRQb3BvdmVyT3BlbihmYWxzZSk7CiAgICB9LAogICAgYW5jaG9yUG9zaXRpb246ICJkb3duTGVmdCIKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJkaXYiLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpUG9wb3ZlclRpdGxlLCBudWxsLCBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2sud2F0Y2hlci5zZWN0aW9ucy53YXRjaEVkaXQudGhyZXNob2xkLm9mQnV0dG9uTGFiZWwnLCB7CiAgICBkZWZhdWx0TWVzc2FnZTogJ29mJwogIH0pKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhHcm91cCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICBncm93OiBmYWxzZSwKICAgIGNsYXNzTmFtZTogIndhdGNoZXJUaHJlc2hvbGRBbGVydEFnZ0ZpZWxkQ29udGFpbmVyIgogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2NvbXBvbmVudHMuRXJyYWJsZUZvcm1Sb3csIHsKICAgIGVycm9yS2V5OiAiYWdnRmllbGQiLAogICAgaXNTaG93aW5nRXJyb3JzOiBoYXNFcnJvcnMgJiYgd2F0Y2guYWdnRmllbGQgIT09IHVuZGVmaW5lZCwKICAgIGVycm9yczogZXJyb3JzCiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUNvbWJvQm94LCB7CiAgICBzaW5nbGVTZWxlY3Rpb246IHsKICAgICAgYXNQbGFpblRleHQ6IHRydWUKICAgIH0sCiAgICBwbGFjZWhvbGRlcjogZmlyc3RGaWVsZE9wdGlvbi50ZXh0LAogICAgb3B0aW9uczogZXNGaWVsZHMucmVkdWNlKGZ1bmN0aW9uIChlc0ZpZWxkT3B0aW9ucywgZmllbGQpIHsKICAgICAgaWYgKF9hZ2dfdHlwZXMuYWdnVHlwZXNbd2F0Y2guYWdnVHlwZV0udmFsaWROb3JtYWxpemVkVHlwZXMuaW5jbHVkZXMoZmllbGQubm9ybWFsaXplZFR5cGUpKSB7CiAgICAgICAgZXNGaWVsZE9wdGlvbnMucHVzaCh7CiAgICAgICAgICBsYWJlbDogZmllbGQubmFtZQogICAgICAgIH0pOwogICAgICB9CgogICAgICByZXR1cm4gZXNGaWVsZE9wdGlvbnM7CiAgICB9LCBbXSksCiAgICBzZWxlY3RlZE9wdGlvbnM6IHdhdGNoLmFnZ0ZpZWxkID8gW3sKICAgICAgbGFiZWw6IHdhdGNoLmFnZ0ZpZWxkCiAgICB9XSA6IFtdLAogICAgb25DaGFuZ2U6IGZ1bmN0aW9uIG9uQ2hhbmdlKHNlbGVjdGVkT3B0aW9ucykgewogICAgICBzZXRXYXRjaFByb3BlcnR5KCdhZ2dGaWVsZCcsIHNlbGVjdGVkT3B0aW9ucy5sZW5ndGggPT09IDEgPyBzZWxlY3RlZE9wdGlvbnNbMF0ubGFiZWwgOiB1bmRlZmluZWQpOwogICAgICBzZXRBZ2dGaWVsZFBvcG92ZXJPcGVuKGZhbHNlKTsKICAgIH0KICB9KSkpKSkpKSA6IG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgZ3JvdzogZmFsc2UKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpUG9wb3ZlciwgewogICAgaWQ6ICJncm91cEJ5UG9wb3ZlciIsCiAgICBidXR0b246IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlFeHByZXNzaW9uLCB7CiAgICAgIGRlc2NyaXB0aW9uOiAiIi5jb25jYXQoX2dyb3VwX2J5X3R5cGVzLmdyb3VwQnlUeXBlc1t3YXRjaC5ncm91cEJ5XS5zaXplUmVxdWlyZWQgPyBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2sud2F0Y2hlci5zZWN0aW9ucy53YXRjaEVkaXQudGhyZXNob2xkLmdyb3VwZWRPdmVyTGFiZWwnLCB7CiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdncm91cGVkIG92ZXInCiAgICAgIH0pIDogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLndhdGNoZXIuc2VjdGlvbnMud2F0Y2hFZGl0LnRocmVzaG9sZC5vdmVyTGFiZWwnLCB7CiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdvdmVyJwogICAgICB9KSksCiAgICAgIHZhbHVlOiAiIi5jb25jYXQoX2dyb3VwX2J5X3R5cGVzLmdyb3VwQnlUeXBlc1t3YXRjaC5ncm91cEJ5XS50ZXh0LCAiICIpLmNvbmNhdChfZ3JvdXBfYnlfdHlwZXMuZ3JvdXBCeVR5cGVzW3dhdGNoLmdyb3VwQnldLnNpemVSZXF1aXJlZCA/ICIiLmNvbmNhdCh3YXRjaC50ZXJtU2l6ZSB8fCAnJywgIiAiKS5jb25jYXQod2F0Y2gudGVybUZpZWxkID8gIiciLmNvbmNhdCh3YXRjaC50ZXJtRmllbGQsICInIikgOiAnJykgOiAnJyksCiAgICAgIGlzQWN0aXZlOiBncm91cEJ5UG9wb3Zlck9wZW4gfHwgd2F0Y2guZ3JvdXBCeSA9PT0gJ3RvcCcgJiYgISh3YXRjaC50ZXJtU2l6ZSAmJiB3YXRjaC50ZXJtRmllbGQpLAogICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgIHNldEdyb3VwQnlQb3BvdmVyT3Blbih0cnVlKTsKICAgICAgfSwKICAgICAgY29sb3I6IHdhdGNoLmdyb3VwQnkgPT09ICdhbGwnIHx8IHdhdGNoLnRlcm1TaXplICYmIHdhdGNoLnRlcm1GaWVsZCA/ICdzZWNvbmRhcnknIDogJ2RhbmdlcicKICAgIH0pLAogICAgaXNPcGVuOiBncm91cEJ5UG9wb3Zlck9wZW4sCiAgICBjbG9zZVBvcG92ZXI6IGZ1bmN0aW9uIGNsb3NlUG9wb3ZlcigpIHsKICAgICAgc2V0R3JvdXBCeVBvcG92ZXJPcGVuKGZhbHNlKTsKICAgIH0sCiAgICBvd25Gb2N1czogdHJ1ZSwKICAgIHdpdGhUaXRsZTogdHJ1ZSwKICAgIGFuY2hvclBvc2l0aW9uOiAiZG93bkxlZnQiCiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgiZGl2IiwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVBvcG92ZXJUaXRsZSwgbnVsbCwgX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLndhdGNoZXIuc2VjdGlvbnMud2F0Y2hFZGl0LnRocmVzaG9sZC5vdmVyQnV0dG9uTGFiZWwnLCB7CiAgICBkZWZhdWx0TWVzc2FnZTogJ292ZXInCiAgfSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEdyb3VwLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgIGdyb3c6IGZhbHNlCiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNlbGVjdCwgewogICAgdmFsdWU6IHdhdGNoLmdyb3VwQnksCiAgICBvbkNoYW5nZTogZnVuY3Rpb24gb25DaGFuZ2UoZSkgewogICAgICBzZXRXYXRjaFByb3BlcnR5KCd0ZXJtU2l6ZScsIG51bGwpOwogICAgICBzZXRXYXRjaFByb3BlcnR5KCd0ZXJtRmllbGQnLCBudWxsKTsKICAgICAgc2V0V2F0Y2hQcm9wZXJ0eSgnZ3JvdXBCeScsIGUudGFyZ2V0LnZhbHVlKTsKICAgIH0sCiAgICBvcHRpb25zOiBPYmplY3QudmFsdWVzKF9ncm91cF9ieV90eXBlcy5ncm91cEJ5VHlwZXMpLm1hcChmdW5jdGlvbiAoX3JlZjUpIHsKICAgICAgdmFyIHRleHQgPSBfcmVmNS50ZXh0LAogICAgICAgICAgdmFsdWUgPSBfcmVmNS52YWx1ZTsKICAgICAgcmV0dXJuIHsKICAgICAgICB0ZXh0OiB0ZXh0LAogICAgICAgIHZhbHVlOiB2YWx1ZQogICAgICB9OwogICAgfSkKICB9KSksIF9ncm91cF9ieV90eXBlcy5ncm91cEJ5VHlwZXNbd2F0Y2guZ3JvdXBCeV0uc2l6ZVJlcXVpcmVkID8gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRnJhZ21lbnQsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgZ3JvdzogZmFsc2UKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9jb21wb25lbnRzLkVycmFibGVGb3JtUm93LCB7CiAgICBlcnJvcktleTogInRlcm1TaXplIiwKICAgIGlzU2hvd2luZ0Vycm9yczogaGFzRXJyb3JzLAogICAgZXJyb3JzOiBlcnJvcnMKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmllbGROdW1iZXIsIHsKICAgIHZhbHVlOiB3YXRjaC50ZXJtU2l6ZSwKICAgIG9uQ2hhbmdlOiBmdW5jdGlvbiBvbkNoYW5nZShlKSB7CiAgICAgIHNldFdhdGNoUHJvcGVydHkoJ3Rlcm1TaXplJywgZS50YXJnZXQudmFsdWUpOwogICAgfSwKICAgIG1pbjogMQogIH0pKSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgZ3JvdzogZmFsc2UKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9jb21wb25lbnRzLkVycmFibGVGb3JtUm93LCB7CiAgICBlcnJvcktleTogInRlcm1GaWVsZCIsCiAgICBpc1Nob3dpbmdFcnJvcnM6IGhhc0Vycm9ycyAmJiB3YXRjaC50ZXJtRmllbGQgIT09IHVuZGVmaW5lZCwKICAgIGVycm9yczogZXJyb3JzCiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNlbGVjdCwgewogICAgdmFsdWU6IHdhdGNoLnRlcm1GaWVsZCB8fCAnJywKICAgIG9uQ2hhbmdlOiBmdW5jdGlvbiBvbkNoYW5nZShlKSB7CiAgICAgIHNldFdhdGNoUHJvcGVydHkoJ3Rlcm1GaWVsZCcsIGUudGFyZ2V0LnZhbHVlKTsKICAgIH0sCiAgICBvcHRpb25zOiBlc0ZpZWxkcy5yZWR1Y2UoZnVuY3Rpb24gKG9wdGlvbnMsIGZpZWxkKSB7CiAgICAgIGlmIChfZ3JvdXBfYnlfdHlwZXMuZ3JvdXBCeVR5cGVzW3dhdGNoLmdyb3VwQnldLnZhbGlkTm9ybWFsaXplZFR5cGVzLmluY2x1ZGVzKGZpZWxkLm5vcm1hbGl6ZWRUeXBlKSkgewogICAgICAgIG9wdGlvbnMucHVzaCh7CiAgICAgICAgICB0ZXh0OiBmaWVsZC5uYW1lLAogICAgICAgICAgdmFsdWU6IGZpZWxkLm5hbWUKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgcmV0dXJuIG9wdGlvbnM7CiAgICB9LCBbZmlyc3RGaWVsZE9wdGlvbl0pCiAgfSkpKSkgOiBudWxsKSkpKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICBncm93OiBmYWxzZQogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlQb3BvdmVyLCB7CiAgICBpZDogIndhdGNoVGhyZXNob2xkUG9wb3ZlciIsCiAgICBidXR0b246IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlFeHByZXNzaW9uLCB7CiAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJ3YXRjaFRocmVzaG9sZEJ1dHRvbiIsCiAgICAgIGRlc2NyaXB0aW9uOiBfY29tcGFyYXRvcnMuY29tcGFyYXRvcnNbd2F0Y2gudGhyZXNob2xkQ29tcGFyYXRvcl0udGV4dCwKICAgICAgdmFsdWU6IHdhdGNoLnRocmVzaG9sZC5zbGljZSgwLCBfY29tcGFyYXRvcnMuY29tcGFyYXRvcnNbd2F0Y2gudGhyZXNob2xkQ29tcGFyYXRvcl0ucmVxdWlyZWRWYWx1ZXMpLmpvaW4oIiAiLmNvbmNhdChhbmRUaHJlc2hvbGRUZXh0LCAiICIpKSwKICAgICAgaXNBY3RpdmU6IEJvb2xlYW4od2F0Y2hUaHJlc2hvbGRQb3BvdmVyT3BlbiB8fCBlcnJvcnMudGhyZXNob2xkMC5sZW5ndGggfHwgZXJyb3JzLnRocmVzaG9sZDEgJiYgZXJyb3JzLnRocmVzaG9sZDEubGVuZ3RoKSwKICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHsKICAgICAgICBzZXRXYXRjaFRocmVzaG9sZFBvcG92ZXJPcGVuKHRydWUpOwogICAgICB9LAogICAgICBjb2xvcjogZXJyb3JzLnRocmVzaG9sZDAubGVuZ3RoIHx8IGVycm9ycy50aHJlc2hvbGQxICYmIGVycm9ycy50aHJlc2hvbGQxLmxlbmd0aCA/ICdkYW5nZXInIDogJ3NlY29uZGFyeScKICAgIH0pLAogICAgaXNPcGVuOiB3YXRjaFRocmVzaG9sZFBvcG92ZXJPcGVuLAogICAgY2xvc2VQb3BvdmVyOiBmdW5jdGlvbiBjbG9zZVBvcG92ZXIoKSB7CiAgICAgIHNldFdhdGNoVGhyZXNob2xkUG9wb3Zlck9wZW4oZmFsc2UpOwogICAgfSwKICAgIG93bkZvY3VzOiB0cnVlLAogICAgd2l0aFRpdGxlOiB0cnVlLAogICAgYW5jaG9yUG9zaXRpb246ICJkb3duTGVmdCIKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJkaXYiLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpUG9wb3ZlclRpdGxlLCBudWxsLCBfY29tcGFyYXRvcnMuY29tcGFyYXRvcnNbd2F0Y2gudGhyZXNob2xkQ29tcGFyYXRvcl0udGV4dCksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4R3JvdXAsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgZ3JvdzogZmFsc2UKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU2VsZWN0LCB7CiAgICB2YWx1ZTogd2F0Y2gudGhyZXNob2xkQ29tcGFyYXRvciwKICAgIG9uQ2hhbmdlOiBmdW5jdGlvbiBvbkNoYW5nZShlKSB7CiAgICAgIHNldFdhdGNoUHJvcGVydHkoJ3RocmVzaG9sZENvbXBhcmF0b3InLCBlLnRhcmdldC52YWx1ZSk7CiAgICB9LAogICAgb3B0aW9uczogT2JqZWN0LnZhbHVlcyhfY29tcGFyYXRvcnMuY29tcGFyYXRvcnMpLm1hcChmdW5jdGlvbiAoX3JlZjYpIHsKICAgICAgdmFyIHRleHQgPSBfcmVmNi50ZXh0LAogICAgICAgICAgdmFsdWUgPSBfcmVmNi52YWx1ZTsKICAgICAgcmV0dXJuIHsKICAgICAgICB0ZXh0OiB0ZXh0LAogICAgICAgIHZhbHVlOiB2YWx1ZQogICAgICB9OwogICAgfSkKICB9KSksIEFycmF5LmZyb20oQXJyYXkoX2NvbXBhcmF0b3JzLmNvbXBhcmF0b3JzW3dhdGNoLnRocmVzaG9sZENvbXBhcmF0b3JdLnJlcXVpcmVkVmFsdWVzKSkubWFwKGZ1bmN0aW9uIChfbm90VXNlZCwgaSkgewogICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LkZyYWdtZW50LCB7CiAgICAgIGtleTogInRocmVzaG9sZCIuY29uY2F0KGkpCiAgICB9LCBpID4gMCA/IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgICBncm93OiBmYWxzZSwKICAgICAgY2xhc3NOYW1lOiAid2F0Y2hlclRocmVzaG9sZFdhdGNoSW5CZXR3ZWVuQ29tcGFyYXRvclRleHQiCiAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVGV4dCwgbnVsbCwgYW5kVGhyZXNob2xkVGV4dCksIGhhc0Vycm9ycyAmJiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3BhY2VyLCBudWxsKSkgOiBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgICAgZ3JvdzogZmFsc2UKICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2NvbXBvbmVudHMuRXJyYWJsZUZvcm1Sb3csIHsKICAgICAgZXJyb3JLZXk6ICJ0aHJlc2hvbGQiLmNvbmNhdChpKSwKICAgICAgaXNTaG93aW5nRXJyb3JzOiBoYXNFcnJvcnMsCiAgICAgIGVycm9yczogZXJyb3JzCiAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmllbGROdW1iZXIsIHsKICAgICAgImRhdGEtdGVzdC1zdWJqIjogIndhdGNoVGhyZXNob2xkSW5wdXQiLAogICAgICB2YWx1ZTogd2F0Y2gudGhyZXNob2xkW2ldID09IG51bGwgPyAnJyA6IHdhdGNoLnRocmVzaG9sZFtpXSwKICAgICAgbWluOiAwLAogICAgICBzdGVwOiAwLjEsCiAgICAgIG9uQ2hhbmdlOiBmdW5jdGlvbiBvbkNoYW5nZShlKSB7CiAgICAgICAgdmFyIHZhbHVlID0gZS50YXJnZXQudmFsdWU7CiAgICAgICAgdmFyIHRocmVzaG9sZCA9IHZhbHVlICE9PSAnJyA/IHBhcnNlRmxvYXQodmFsdWUpIDogdmFsdWU7CgogICAgICAgIHZhciBuZXdUaHJlc2hvbGQgPSBfdG9Db25zdW1hYmxlQXJyYXkod2F0Y2gudGhyZXNob2xkKTsKCiAgICAgICAgbmV3VGhyZXNob2xkW2ldID0gdGhyZXNob2xkOwogICAgICAgIHNldFdhdGNoUHJvcGVydHkoJ3RocmVzaG9sZCcsIG5ld1RocmVzaG9sZCk7CiAgICAgIH0KICAgIH0pKSkpOwogIH0pKSkpKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICBncm93OiBmYWxzZQogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlQb3BvdmVyLCB7CiAgICBpZDogIndhdGNoRHVyYXRpb25Qb3BvdmVyIiwKICAgIGJ1dHRvbjogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUV4cHJlc3Npb24sIHsKICAgICAgZGVzY3JpcHRpb246IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay53YXRjaGVyLnNlY3Rpb25zLndhdGNoRWRpdC50aHJlc2hvbGQuZm9yVGhlTGFzdExhYmVsJywgewogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnZm9yIHRoZSBsYXN0JwogICAgICB9KSwKICAgICAgdmFsdWU6ICIiLmNvbmNhdCh3YXRjaC50aW1lV2luZG93U2l6ZSwgIiAiKS5jb25jYXQoKDAsIF9nZXRfdGltZV91bml0X2xhYmVsLmdldFRpbWVVbml0TGFiZWwpKHdhdGNoLnRpbWVXaW5kb3dVbml0LCBwYXJzZUludCh3YXRjaC50aW1lV2luZG93U2l6ZSwgMTApLnRvU3RyaW5nKCkpKSwKICAgICAgaXNBY3RpdmU6IHdhdGNoRHVyYXRpb25Qb3BvdmVyT3BlbiB8fCAhd2F0Y2gudGltZVdpbmRvd1NpemUsCiAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7CiAgICAgICAgc2V0V2F0Y2hEdXJhdGlvblBvcG92ZXJPcGVuKHRydWUpOwogICAgICB9LAogICAgICBjb2xvcjogd2F0Y2gudGltZVdpbmRvd1NpemUgPyAnc2Vjb25kYXJ5JyA6ICdkYW5nZXInCiAgICB9KSwKICAgIGlzT3Blbjogd2F0Y2hEdXJhdGlvblBvcG92ZXJPcGVuLAogICAgY2xvc2VQb3BvdmVyOiBmdW5jdGlvbiBjbG9zZVBvcG92ZXIoKSB7CiAgICAgIHNldFdhdGNoRHVyYXRpb25Qb3BvdmVyT3BlbihmYWxzZSk7CiAgICB9LAogICAgb3duRm9jdXM6IHRydWUsCiAgICB3aXRoVGl0bGU6IHRydWUsCiAgICBhbmNob3JQb3NpdGlvbjogImRvd25MZWZ0IgogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlQb3BvdmVyVGl0bGUsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICBpZDogInhwYWNrLndhdGNoZXIuc2VjdGlvbnMud2F0Y2hFZGl0LnRocmVzaG9sZC5mb3JUaGVMYXN0QnV0dG9uTGFiZWwiLAogICAgZGVmYXVsdE1lc3NhZ2U6ICJGb3IgdGhlIGxhc3QiCiAgfSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEdyb3VwLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgIGdyb3c6IGZhbHNlCiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfY29tcG9uZW50cy5FcnJhYmxlRm9ybVJvdywgewogICAgZXJyb3JLZXk6ICJ0aW1lV2luZG93U2l6ZSIsCiAgICBpc1Nob3dpbmdFcnJvcnM6IGhhc0Vycm9ycywKICAgIGVycm9yczogZXJyb3JzCiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZpZWxkTnVtYmVyLCB7CiAgICBtaW46IDEsCiAgICB2YWx1ZTogd2F0Y2gudGltZVdpbmRvd1NpemUgfHwgJycsCiAgICBvbkNoYW5nZTogZnVuY3Rpb24gb25DaGFuZ2UoZSkgewogICAgICB2YXIgdmFsdWUgPSBlLnRhcmdldC52YWx1ZTsKICAgICAgdmFyIHRpbWVXaW5kb3dTaXplID0gdmFsdWUgIT09ICcnID8gcGFyc2VJbnQodmFsdWUsIDEwKSA6IHZhbHVlOwogICAgICBzZXRXYXRjaFByb3BlcnR5KCd0aW1lV2luZG93U2l6ZScsIHRpbWVXaW5kb3dTaXplKTsKICAgIH0KICB9KSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgIGdyb3c6IGZhbHNlCiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNlbGVjdCwgewogICAgdmFsdWU6IHdhdGNoLnRpbWVXaW5kb3dVbml0LAogICAgb25DaGFuZ2U6IGZ1bmN0aW9uIG9uQ2hhbmdlKGUpIHsKICAgICAgc2V0V2F0Y2hQcm9wZXJ0eSgndGltZVdpbmRvd1VuaXQnLCBlLnRhcmdldC52YWx1ZSk7CiAgICB9LAogICAgb3B0aW9uczogZ2V0VGltZU9wdGlvbnMod2F0Y2gudGltZVdpbmRvd1NpemUpCiAgfSkpKSkpKSksIGhhc0V4cHJlc3Npb25FcnJvcnMgPyBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5GcmFnbWVudCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgewogICAgc2l6ZTogIm0iCiAgfSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUZXh0LCB7CiAgICBjb2xvcjogImRhbmdlciIsCiAgICBzaXplOiAicyIKICB9LCBleHByZXNzaW9uRXJyb3JNZXNzYWdlKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgewogICAgc2l6ZTogIm0iCiAgfSkpIDogbnVsbCwgaGFzRXJyb3JzID8gbnVsbCA6IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LkZyYWdtZW50LCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF93YXRjaF92aXN1YWxpemF0aW9uLldhdGNoVmlzdWFsaXphdGlvbiwgbnVsbCksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3RocmVzaG9sZF93YXRjaF9hY3Rpb25fcGFuZWwuV2F0Y2hBY3Rpb25zUGFuZWwsIHsKICAgIGFjdGlvbkVycm9yczogYWN0aW9uRXJyb3JzCiAgfSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3BhY2VyLCBudWxsKSkgOiBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEdyb3VwLCB7CiAgICBqdXN0aWZ5Q29udGVudDogInNwYWNlQmV0d2VlbiIsCiAgICBhbGlnbkl0ZW1zOiAiY2VudGVyIgogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgZ3JvdzogZmFsc2UKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEdyb3VwLCB7CiAgICBndXR0ZXJTaXplOiAibSIsCiAgICBhbGlnbkl0ZW1zOiAiY2VudGVyIgogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgZ3JvdzogZmFsc2UKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQnV0dG9uLCB7CiAgICBmaWxsOiB0cnVlLAogICAgY29sb3I6ICJzZWNvbmRhcnkiLAogICAgImRhdGEtdGVzdC1zdWJqIjogInNhdmVXYXRjaEJ1dHRvbiIsCiAgICB0eXBlOiAic3VibWl0IiwKICAgIGljb25UeXBlOiAiY2hlY2siLAogICAgaXNEaXNhYmxlZDogaGFzRXJyb3JzIHx8IGhhc0FjdGlvbkVycm9ycywKICAgIGlzTG9hZGluZzogaXNTYXZpbmcsCiAgICBvbkNsaWNrOiBmdW5jdGlvbiBfY2FsbGVlMygpIHsKICAgICAgdmFyIHNhdmVkV2F0Y2g7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXN5bmMoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0NykgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Ny5wcmV2ID0gX2NvbnRleHQ3Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIHNldElzU2F2aW5nKHRydWUpOwogICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMzsKICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKCgwLCBfd2F0Y2hfZWRpdF9hY3Rpb25zLm9uV2F0Y2hTYXZlKSh3YXRjaCwgdG9hc3RzKSk7CgogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgc2F2ZWRXYXRjaCA9IF9jb250ZXh0Ny5zZW50OwoKICAgICAgICAgICAgICBpZiAoIShzYXZlZFdhdGNoICYmIHNhdmVkV2F0Y2guZXJyb3IpKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDcubmV4dCA9IDc7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHNldElzU2F2aW5nKGZhbHNlKTsKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LmFicnVwdCgicmV0dXJuIiwgc2V0U2VydmVyRXJyb3Ioc2F2ZWRXYXRjaC5lcnJvcikpOwoKICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfSwgd2F0Y2guaXNOZXcgPyBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgaWQ6ICJ4cGFjay53YXRjaGVyLnNlY3Rpb25zLndhdGNoRWRpdC50aHJlc2hvbGQuY3JlYXRlQnV0dG9uTGFiZWwiLAogICAgZGVmYXVsdE1lc3NhZ2U6ICJDcmVhdGUgYWxlcnQiCiAgfSkgOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgaWQ6ICJ4cGFjay53YXRjaGVyLnNlY3Rpb25zLndhdGNoRWRpdC50aHJlc2hvbGQuc2F2ZUJ1dHRvbkxhYmVsIiwKICAgIGRlZmF1bHRNZXNzYWdlOiAiU2F2ZSBhbGVydCIKICB9KSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgIGdyb3c6IGZhbHNlCiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUJ1dHRvbkVtcHR5LCB7CiAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICByZXR1cm4gKDAsIF9uYXZpZ2F0aW9uLmdvVG9XYXRjaExpc3QpKCk7CiAgICB9CiAgfSwgX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLndhdGNoZXIuc2VjdGlvbnMud2F0Y2hFZGl0LnRocmVzaG9sZC5jYW5jZWxCdXR0b25MYWJlbCcsIHsKICAgIGRlZmF1bHRNZXNzYWdlOiAnQ2FuY2VsJwogIH0pKSkpKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICBncm93OiBmYWxzZQogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlCdXR0b25FbXB0eSwgewogICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHsKICAgICAgcmV0dXJuIHNldElzUmVxdWVzdFZpc2libGUoIWlzUmVxdWVzdFZpc2libGUpOwogICAgfQogIH0sIGlzUmVxdWVzdFZpc2libGUgPyBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgaWQ6ICJ4cGFjay53YXRjaGVyLnNlY3Rpb25zLndhdGNoRWRpdC5qc29uLmhpZGVSZXF1ZXN0QnV0dG9uTGFiZWwiLAogICAgZGVmYXVsdE1lc3NhZ2U6ICJIaWRlIHJlcXVlc3QiCiAgfSkgOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgaWQ6ICJ4cGFjay53YXRjaGVyLnNlY3Rpb25zLndhdGNoRWRpdC5qc29uLnNob3dSZXF1ZXN0QnV0dG9uTGFiZWwiLAogICAgZGVmYXVsdE1lc3NhZ2U6ICJTaG93IHJlcXVlc3QiCiAgfSkpKSkpLCBpc1JlcXVlc3RWaXNpYmxlID8gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVxdWVzdF9mbHlvdXQuUmVxdWVzdEZseW91dCwgewogICAgaWQ6IHdhdGNoLmlkLAogICAgcGF5bG9hZDogKDAsIF9zZXJpYWxpemF0aW9uLnNlcmlhbGl6ZVRocmVzaG9sZFdhdGNoKShyZXF1ZXN0UHJldmlld1dhdGNoRGF0YSksCiAgICBjbG9zZTogZnVuY3Rpb24gY2xvc2UoKSB7CiAgICAgIHJldHVybiBzZXRJc1JlcXVlc3RWaXNpYmxlKGZhbHNlKTsKICAgIH0KICB9KSA6IG51bGwpOwp9OwoKZXhwb3J0cy5UaHJlc2hvbGRXYXRjaEVkaXQgPSBUaHJlc2hvbGRXYXRjaEVkaXQ7"},null]}