{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/ml/public/application/components/anomalies_table/links_menu.js","dependencies":[{"path":"x-pack/legacy/plugins/ml/public/application/components/anomalies_table/links_menu.js","mtime":1585205045457},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkxpbmtzTWVudSA9IHZvaWQgMDsKCnZhciBfbG9kYXNoID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJsb2Rhc2giKSk7Cgp2YXIgX21vbWVudCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgibW9tZW50IikpOwoKdmFyIF9yaXNvbk5vZGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoInJpc29uLW5vZGUiKSk7Cgp2YXIgX3Byb3BUeXBlcyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgicHJvcC10eXBlcyIpKTsKCnZhciBfcmVhY3QgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKCJyZWFjdCIpKTsKCnZhciBfZXVpID0gcmVxdWlyZSgiQGVsYXN0aWMvZXVpIik7Cgp2YXIgX3JlYWN0MiA9IHJlcXVpcmUoIkBrYm4vaTE4bi9yZWFjdCIpOwoKdmFyIF9jaHJvbWUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoInVpL2Nocm9tZSIpKTsKCnZhciBfbm90aWZ5ID0gcmVxdWlyZSgidWkvbm90aWZ5Iik7Cgp2YXIgX3B1YmxpYyA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uL3NyYy9wbHVnaW5zL2RhdGEvcHVibGljIik7Cgp2YXIgX2NoZWNrX3ByaXZpbGVnZSA9IHJlcXVpcmUoIi4uLy4uL3ByaXZpbGVnZS9jaGVja19wcml2aWxlZ2UiKTsKCnZhciBfc2VhcmNoID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vY29tbW9uL2NvbnN0YW50cy9zZWFyY2giKTsKCnZhciBfYW5vbWFseV91dGlscyA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL2NvbW1vbi91dGlsL2Fub21hbHlfdXRpbHMiKTsKCnZhciBfcGFyc2VfaW50ZXJ2YWwgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9jb21tb24vdXRpbC9wYXJzZV9pbnRlcnZhbCIpOwoKdmFyIF91dGlscyA9IHJlcXVpcmUoIi4uL2txbF9maWx0ZXJfYmFyL3V0aWxzIik7Cgp2YXIgX21hcHBpbmdfc2VydmljZSA9IHJlcXVpcmUoIi4uLy4uL3NlcnZpY2VzL21hcHBpbmdfc2VydmljZSIpOwoKdmFyIF9tbF9hcGlfc2VydmljZSA9IHJlcXVpcmUoIi4uLy4uL3NlcnZpY2VzL21sX2FwaV9zZXJ2aWNlIik7Cgp2YXIgX2pvYl9zZXJ2aWNlID0gcmVxdWlyZSgiLi4vLi4vc2VydmljZXMvam9iX3NlcnZpY2UiKTsKCnZhciBfY3VzdG9tX3VybF91dGlscyA9IHJlcXVpcmUoIi4uLy4uL3V0aWwvY3VzdG9tX3VybF91dGlscyIpOwoKdmFyIF9kYXRlX3V0aWxzID0gcmVxdWlyZSgiLi4vLi4vdXRpbC9kYXRlX3V0aWxzIik7Cgp2YXIgX2luZGV4X3V0aWxzID0gcmVxdWlyZSgiLi4vLi4vdXRpbC9pbmRleF91dGlscyIpOwoKdmFyIF9zdHJpbmdfdXRpbHMgPSByZXF1aXJlKCIuLi8uLi91dGlsL3N0cmluZ191dGlscyIpOwoKdmFyIF9jbGFzcywgX3RlbXA7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGVsc2UgeyB2YXIgbmV3T2JqID0ge307IGlmIChvYmogIT0gbnVsbCkgeyBmb3IgKHZhciBrZXkgaW4gb2JqKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7IHZhciBkZXNjID0gT2JqZWN0LmRlZmluZVByb3BlcnR5ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KSA6IHt9OyBpZiAoZGVzYy5nZXQgfHwgZGVzYy5zZXQpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5ld09iaiwga2V5LCBkZXNjKTsgfSBlbHNlIHsgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IH0gfSBuZXdPYmouZGVmYXVsdCA9IG9iajsgcmV0dXJuIG5ld09iajsgfSB9CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gInN5bWJvbCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9CgpmdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfQoKZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpKSB7IHJldHVybiBjYWxsOyB9IHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOyB9CgpmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyBfZ2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3QuZ2V0UHJvdG90eXBlT2YgOiBmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyByZXR1cm4gby5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKG8pOyB9OyByZXR1cm4gX2dldFByb3RvdHlwZU9mKG8pOyB9CgpmdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsgaWYgKHNlbGYgPT09IHZvaWQgMCkgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOyB9IHJldHVybiBzZWxmOyB9CgpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAiZnVuY3Rpb24iICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24iKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBfc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpOyB9CgpmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgby5fX3Byb3RvX18gPSBwOyByZXR1cm4gbzsgfTsgcmV0dXJuIF9zZXRQcm90b3R5cGVPZihvLCBwKTsgfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgeyBpZiAoa2V5IGluIG9iaikgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsgdmFsdWU6IHZhbHVlLCBlbnVtZXJhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlIH0pOyB9IGVsc2UgeyBvYmpba2V5XSA9IHZhbHVlOyB9IHJldHVybiBvYmo7IH0KCi8qCiAqIENvbXBvbmVudCBmb3IgcmVuZGVyaW5nIHRoZSBsaW5rcyBtZW51IGluc2lkZSBhIGNlbGwgaW4gdGhlIGFub21hbGllcyB0YWJsZS4KICovCnZhciBMaW5rc01lbnUgPSAoMCwgX3JlYWN0Mi5pbmplY3RJMThuKSgoX3RlbXAgPSBfY2xhc3MgPQovKiNfX1BVUkVfXyovCmZ1bmN0aW9uIChfQ29tcG9uZW50KSB7CiAgX2luaGVyaXRzKExpbmtzTWVudSwgX0NvbXBvbmVudCk7CgogIGZ1bmN0aW9uIExpbmtzTWVudShwcm9wcykgewogICAgdmFyIF90aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBMaW5rc01lbnUpOwoKICAgIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgX2dldFByb3RvdHlwZU9mKExpbmtzTWVudSkuY2FsbCh0aGlzLCBwcm9wcykpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIm9wZW5DdXN0b21VcmwiLCBmdW5jdGlvbiAoY3VzdG9tVXJsKSB7CiAgICAgIHZhciBfdGhpcyRwcm9wcyA9IF90aGlzLnByb3BzLAogICAgICAgICAgYW5vbWFseSA9IF90aGlzJHByb3BzLmFub21hbHksCiAgICAgICAgICBpbnRlcnZhbCA9IF90aGlzJHByb3BzLmludGVydmFsLAogICAgICAgICAgaXNBZ2dyZWdhdGVkRGF0YSA9IF90aGlzJHByb3BzLmlzQWdncmVnYXRlZERhdGEsCiAgICAgICAgICBpbnRsID0gX3RoaXMkcHJvcHMuaW50bDsKICAgICAgY29uc29sZS5sb2coJ0Fub21hbGllcyBUYWJsZSAtIG9wZW4gY3VzdG9tVXJsIGZvciByZWNvcmQ6JywgYW5vbWFseSk7IC8vIElmIHVybF92YWx1ZSBjb250YWlucyAkZWFybGllc3QkIGFuZCAkbGF0ZXN0JCB0b2tlbnMsIGFkZCBpbiB0aW1lcyB0byB0aGUgc291cmNlIHJlY29yZC4KICAgICAgLy8gQ3JlYXRlIGEgY29weSBvZiB0aGUgcmVjb3JkIGFzIHdlIGFyZSBhZGRpbmcgcHJvcGVydGllcyBpbnRvIGl0LgoKICAgICAgdmFyIHJlY29yZCA9IF9sb2Rhc2guZGVmYXVsdC5jbG9uZURlZXAoYW5vbWFseS5zb3VyY2UpOwoKICAgICAgdmFyIHRpbWVzdGFtcCA9IHJlY29yZC50aW1lc3RhbXA7CiAgICAgIHZhciBjb25maWd1cmVkVXJsVmFsdWUgPSBjdXN0b21VcmwudXJsX3ZhbHVlOwogICAgICB2YXIgdGltZVJhbmdlSW50ZXJ2YWwgPSAoMCwgX3BhcnNlX2ludGVydmFsLnBhcnNlSW50ZXJ2YWwpKGN1c3RvbVVybC50aW1lX3JhbmdlKTsKCiAgICAgIGlmIChjb25maWd1cmVkVXJsVmFsdWUuaW5jbHVkZXMoJyRlYXJsaWVzdCQnKSkgewogICAgICAgIHZhciBlYXJsaWVzdE1vbWVudCA9ICgwLCBfbW9tZW50LmRlZmF1bHQpKHRpbWVzdGFtcCk7CgogICAgICAgIGlmICh0aW1lUmFuZ2VJbnRlcnZhbCAhPT0gbnVsbCkgewogICAgICAgICAgZWFybGllc3RNb21lbnQuc3VidHJhY3QodGltZVJhbmdlSW50ZXJ2YWwpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBlYXJsaWVzdE1vbWVudCA9ICgwLCBfbW9tZW50LmRlZmF1bHQpKHRpbWVzdGFtcCkuc3RhcnRPZihpbnRlcnZhbCk7CgogICAgICAgICAgaWYgKGludGVydmFsID09PSAnaG91cicpIHsKICAgICAgICAgICAgLy8gU3RhcnQgZnJvbSB0aGUgcHJldmlvdXMgaG91ci4KICAgICAgICAgICAgZWFybGllc3RNb21lbnQuc3VidHJhY3QoMSwgJ2gnKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJlY29yZC5lYXJsaWVzdCA9IGVhcmxpZXN0TW9tZW50LnRvSVNPU3RyaW5nKCk7IC8vIGUuZy4gMjAxNi0wMi0wOFQxNjowMDowMC4wMDBaCiAgICAgIH0KCiAgICAgIGlmIChjb25maWd1cmVkVXJsVmFsdWUuaW5jbHVkZXMoJyRsYXRlc3QkJykpIHsKICAgICAgICB2YXIgbGF0ZXN0TW9tZW50ID0gKDAsIF9tb21lbnQuZGVmYXVsdCkodGltZXN0YW1wKS5hZGQocmVjb3JkLmJ1Y2tldF9zcGFuLCAncycpOwoKICAgICAgICBpZiAodGltZVJhbmdlSW50ZXJ2YWwgIT09IG51bGwpIHsKICAgICAgICAgIGxhdGVzdE1vbWVudC5hZGQodGltZVJhbmdlSW50ZXJ2YWwpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZiAoaXNBZ2dyZWdhdGVkRGF0YSA9PT0gdHJ1ZSkgewogICAgICAgICAgICBsYXRlc3RNb21lbnQgPSAoMCwgX21vbWVudC5kZWZhdWx0KSh0aW1lc3RhbXApLmVuZE9mKGludGVydmFsKTsKCiAgICAgICAgICAgIGlmIChpbnRlcnZhbCA9PT0gJ2hvdXInKSB7CiAgICAgICAgICAgICAgLy8gU2hvdyB0byB0aGUgZW5kIG9mIHRoZSBuZXh0IGhvdXIuCiAgICAgICAgICAgICAgbGF0ZXN0TW9tZW50LmFkZCgxLCAnaCcpOyAvLyBlLmcuIDIwMTYtMDItMDhUMTg6NTk6NTkuOTk5WgogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZWNvcmQubGF0ZXN0ID0gbGF0ZXN0TW9tZW50LnRvSVNPU3RyaW5nKCk7CiAgICAgIH0gLy8gSWYgdXJsX3ZhbHVlIGNvbnRhaW5zICRtbGNhdGVnb3J5dGVybXMkIG9yICRtbGNhdGVnb3J5cmVnZXgkLCBhZGQgaW4gdGhlCiAgICAgIC8vIHRlcm1zIGFuZCByZWdleCBmb3IgdGhlIHNlbGVjdGVkIGNhdGVnb3J5SWQgdG8gdGhlIHNvdXJjZSByZWNvcmQuCgoKICAgICAgaWYgKChjb25maWd1cmVkVXJsVmFsdWUuaW5jbHVkZXMoJyRtbGNhdGVnb3J5dGVybXMkJykgfHwgY29uZmlndXJlZFVybFZhbHVlLmluY2x1ZGVzKCckbWxjYXRlZ29yeXJlZ2V4JCcpKSAmJiBfbG9kYXNoLmRlZmF1bHQuaGFzKHJlY29yZCwgJ21sY2F0ZWdvcnknKSkgewogICAgICAgIHZhciBqb2JJZCA9IHJlY29yZC5qb2JfaWQ7IC8vIG1sY2F0ZWdvcnkgaW4gdGhlIHNvdXJjZSByZWNvcmQgd2lsbCBiZSBhbiBhcnJheQogICAgICAgIC8vIC0gdXNlIGZpcnN0IHZhbHVlICh3aWxsIG9ubHkgZXZlciBiZSBtb3JlIHRoYW4gb25lIGlmIGluZmx1ZW5jZWQgYnkgY2F0ZWdvcnkgb3RoZXIgdGhhbiBieS9wYXJ0aXRpb24vb3ZlcikuCgogICAgICAgIHZhciBjYXRlZ29yeUlkID0gcmVjb3JkLm1sY2F0ZWdvcnlbMF07CgogICAgICAgIF9tbF9hcGlfc2VydmljZS5tbC5yZXN1bHRzLmdldENhdGVnb3J5RGVmaW5pdGlvbihqb2JJZCwgY2F0ZWdvcnlJZCkudGhlbihmdW5jdGlvbiAocmVzcCkgewogICAgICAgICAgLy8gUHJlZml4IGVhY2ggb2YgdGhlIHRlcm1zIHdpdGggJysnIHNvIHRoYXQgdGhlIEVsYXN0aWNzZWFyY2ggUXVlcnkgU3RyaW5nIHF1ZXJ5CiAgICAgICAgICAvLyBydW4gaW4gYSBkcmlsbGRvd24gS2liYW5hIGRhc2hib2FyZCBoYXMgdG8gbWF0Y2ggb24gYWxsIHRlcm1zLgogICAgICAgICAgdmFyIHRlcm1zQXJyYXkgPSByZXNwLnRlcm1zLnNwbGl0KCcgJykubWFwKGZ1bmN0aW9uICh0ZXJtKSB7CiAgICAgICAgICAgIHJldHVybiAiKyIuY29uY2F0KHRlcm0pOwogICAgICAgICAgfSk7CiAgICAgICAgICByZWNvcmQubWxjYXRlZ29yeXRlcm1zID0gdGVybXNBcnJheS5qb2luKCcgJyk7CiAgICAgICAgICByZWNvcmQubWxjYXRlZ29yeXJlZ2V4ID0gcmVzcC5yZWdleDsgLy8gUmVwbGFjZSBhbnkgdG9rZW5zIGluIHRoZSBjb25maWd1cmVkIHVybF92YWx1ZSB3aXRoIHZhbHVlcyBmcm9tIHRoZSBzb3VyY2UgcmVjb3JkLAogICAgICAgICAgLy8gYW5kIHRoZW4gb3BlbiBsaW5rIGluIGEgbmV3IHRhYi93aW5kb3cuCgogICAgICAgICAgdmFyIHVybFBhdGggPSAoMCwgX3N0cmluZ191dGlscy5yZXBsYWNlU3RyaW5nVG9rZW5zKShjdXN0b21VcmwudXJsX3ZhbHVlLCByZWNvcmQsIHRydWUpOwogICAgICAgICAgKDAsIF9jdXN0b21fdXJsX3V0aWxzLm9wZW5DdXN0b21VcmxXaW5kb3cpKHVybFBhdGgsIGN1c3RvbVVybCk7CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlc3ApIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdvcGVuQ3VzdG9tVXJsKCk6IGVycm9yIGxvYWRpbmcgY2F0ZWdvcnlEZWZpbml0aW9uOicsIHJlc3ApOwoKICAgICAgICAgIF9ub3RpZnkudG9hc3ROb3RpZmljYXRpb25zLmFkZERhbmdlcihpbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgICBpZDogJ3hwYWNrLm1sLmFub21hbGllc1RhYmxlLmxpbmtzTWVudS51bmFibGVUb09wZW5MaW5rRXJyb3JNZXNzYWdlJywKICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdVbmFibGUgdG8gb3BlbiBsaW5rIGFzIGFuIGVycm9yIG9jY3VycmVkIGxvYWRpbmcgZGV0YWlscyBvbiBjYXRlZ29yeSBJRCB7Y2F0ZWdvcnlJZH0nCiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIGNhdGVnb3J5SWQ6IGNhdGVnb3J5SWQKICAgICAgICAgIH0pKTsKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBSZXBsYWNlIGFueSB0b2tlbnMgaW4gdGhlIGNvbmZpZ3VyZWQgdXJsX3ZhbHVlIHdpdGggdmFsdWVzIGZyb20gdGhlIHNvdXJjZSByZWNvcmQsCiAgICAgICAgLy8gYW5kIHRoZW4gb3BlbiBsaW5rIGluIGEgbmV3IHRhYi93aW5kb3cuCiAgICAgICAgdmFyIHVybFBhdGggPSAoMCwgX2N1c3RvbV91cmxfdXRpbHMuZ2V0VXJsRm9yUmVjb3JkKShjdXN0b21VcmwsIHJlY29yZCk7CiAgICAgICAgKDAsIF9jdXN0b21fdXJsX3V0aWxzLm9wZW5DdXN0b21VcmxXaW5kb3cpKHVybFBhdGgsIGN1c3RvbVVybCk7CiAgICAgIH0KICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInZpZXdTZXJpZXMiLCBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciByZWNvcmQgPSBfdGhpcy5wcm9wcy5hbm9tYWx5LnNvdXJjZTsKICAgICAgdmFyIGJvdW5kcyA9IF90aGlzLnByb3BzLmJvdW5kczsKICAgICAgdmFyIGZyb20gPSBib3VuZHMubWluLnRvSVNPU3RyaW5nKCk7IC8vIGUuZy4gMjAxNi0wMi0wOFQxNjowMDowMC4wMDBaCgogICAgICB2YXIgdG8gPSBib3VuZHMubWF4LnRvSVNPU3RyaW5nKCk7IC8vIFpvb20gdG8gc2hvdyA1MCBidWNrZXRzIGVpdGhlciBzaWRlIG9mIHRoZSByZWNvcmQuCgogICAgICB2YXIgcmVjb3JkVGltZSA9ICgwLCBfbW9tZW50LmRlZmF1bHQpKHJlY29yZC50aW1lc3RhbXApOwogICAgICB2YXIgem9vbUZyb20gPSByZWNvcmRUaW1lLnN1YnRyYWN0KDUwICogcmVjb3JkLmJ1Y2tldF9zcGFuLCAncycpLnRvSVNPU3RyaW5nKCk7CiAgICAgIHZhciB6b29tVG8gPSByZWNvcmRUaW1lLmFkZCgxMDAgKiByZWNvcmQuYnVja2V0X3NwYW4sICdzJykudG9JU09TdHJpbmcoKTsgLy8gRXh0cmFjdCB0aGUgYnksIG92ZXIgYW5kIHBhcnRpdGlvbiBmaWVsZHMgZm9yIHRoZSByZWNvcmQuCgogICAgICB2YXIgZW50aXR5Q29uZGl0aW9uID0ge307CgogICAgICBpZiAoX2xvZGFzaC5kZWZhdWx0LmhhcyhyZWNvcmQsICdwYXJ0aXRpb25fZmllbGRfdmFsdWUnKSkgewogICAgICAgIGVudGl0eUNvbmRpdGlvbltyZWNvcmQucGFydGl0aW9uX2ZpZWxkX25hbWVdID0gcmVjb3JkLnBhcnRpdGlvbl9maWVsZF92YWx1ZTsKICAgICAgfQoKICAgICAgaWYgKF9sb2Rhc2guZGVmYXVsdC5oYXMocmVjb3JkLCAnb3Zlcl9maWVsZF92YWx1ZScpKSB7CiAgICAgICAgZW50aXR5Q29uZGl0aW9uW3JlY29yZC5vdmVyX2ZpZWxkX25hbWVdID0gcmVjb3JkLm92ZXJfZmllbGRfdmFsdWU7CiAgICAgIH0KCiAgICAgIGlmIChfbG9kYXNoLmRlZmF1bHQuaGFzKHJlY29yZCwgJ2J5X2ZpZWxkX3ZhbHVlJykpIHsKICAgICAgICAvLyBOb3RlIHRoYXQgYW5hbHlzZXMgd2l0aCBieSBhbmQgb3ZlciBmaWVsZHMsIHdpbGwgaGF2ZSBhIHRvcC1sZXZlbCBieV9maWVsZF9uYW1lLAogICAgICAgIC8vIGJ1dCB0aGUgYnlfZmllbGRfdmFsdWUocykgd2lsbCBiZSBpbiB0aGUgbmVzdGVkIGNhdXNlcyBhcnJheS4KICAgICAgICAvLyBUT0RPIC0gZHJpbGxkb3duIGZyb20gY2F1c2UgaW4gZXhwYW5kZWQgcm93IG9ubHk/CiAgICAgICAgZW50aXR5Q29uZGl0aW9uW3JlY29yZC5ieV9maWVsZF9uYW1lXSA9IHJlY29yZC5ieV9maWVsZF92YWx1ZTsKICAgICAgfSAvLyBVc2Ugcmlzb24gdG8gYnVpbGQgdGhlIFVSTCAuCgoKICAgICAgdmFyIF9nID0gX3Jpc29uTm9kZS5kZWZhdWx0LmVuY29kZSh7CiAgICAgICAgbWw6IHsKICAgICAgICAgIGpvYklkczogW3JlY29yZC5qb2JfaWRdCiAgICAgICAgfSwKICAgICAgICByZWZyZXNoSW50ZXJ2YWw6IHsKICAgICAgICAgIGRpc3BsYXk6ICdPZmYnLAogICAgICAgICAgcGF1c2U6IGZhbHNlLAogICAgICAgICAgdmFsdWU6IDAKICAgICAgICB9LAogICAgICAgIHRpbWU6IHsKICAgICAgICAgIGZyb206IGZyb20sCiAgICAgICAgICB0bzogdG8sCiAgICAgICAgICBtb2RlOiAnYWJzb2x1dGUnCiAgICAgICAgfQogICAgICB9KTsKCiAgICAgIHZhciBfYSA9IF9yaXNvbk5vZGUuZGVmYXVsdC5lbmNvZGUoewogICAgICAgIG1sVGltZVNlcmllc0V4cGxvcmVyOiB7CiAgICAgICAgICB6b29tOiB7CiAgICAgICAgICAgIGZyb206IHpvb21Gcm9tLAogICAgICAgICAgICB0bzogem9vbVRvCiAgICAgICAgICB9LAogICAgICAgICAgZGV0ZWN0b3JJbmRleDogcmVjb3JkLmRldGVjdG9yX2luZGV4LAogICAgICAgICAgZW50aXRpZXM6IGVudGl0eUNvbmRpdGlvbgogICAgICAgIH0sCiAgICAgICAgcXVlcnk6IHsKICAgICAgICAgIHF1ZXJ5X3N0cmluZzogewogICAgICAgICAgICBhbmFseXplX3dpbGRjYXJkOiB0cnVlLAogICAgICAgICAgICBxdWVyeTogJyonCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsgLy8gTmVlZCB0byBlbmNvZGUgdGhlIF9hIHBhcmFtZXRlciBpbiBjYXNlIGFueSBlbnRpdGllcyBjb250YWluIHVuc2FmZSBjaGFyYWN0ZXJzIHN1Y2ggYXMgJysnLgoKCiAgICAgIHZhciBwYXRoID0gJyMvdGltZXNlcmllc2V4cGxvcmVyJzsKICAgICAgcGF0aCArPSAiP19nPSIuY29uY2F0KF9nLCAiJl9hPSIpLmNvbmNhdChlbmNvZGVVUklDb21wb25lbnQoX2EpKTsKICAgICAgd2luZG93Lm9wZW4ocGF0aCwgJ19ibGFuaycpOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAidmlld0V4YW1wbGVzIiwgZnVuY3Rpb24gKCkgewogICAgICB2YXIgaW50bCA9IF90aGlzLnByb3BzLmludGw7CiAgICAgIHZhciBjYXRlZ29yeUlkID0gX3RoaXMucHJvcHMuYW5vbWFseS5lbnRpdHlWYWx1ZTsKICAgICAgdmFyIHJlY29yZCA9IF90aGlzLnByb3BzLmFub21hbHkuc291cmNlOwoKICAgICAgdmFyIGpvYiA9IF9qb2Jfc2VydmljZS5tbEpvYlNlcnZpY2UuZ2V0Sm9iKF90aGlzLnByb3BzLmFub21hbHkuam9iSWQpOwoKICAgICAgaWYgKGpvYiA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgY29uc29sZS5sb2coInZpZXdFeGFtcGxlcygpOiBubyBqb2IgZm91bmQgd2l0aCBJRDogIi5jb25jYXQoX3RoaXMucHJvcHMuYW5vbWFseS5qb2JJZCkpOwoKICAgICAgICBfbm90aWZ5LnRvYXN0Tm90aWZpY2F0aW9ucy5hZGREYW5nZXIoaW50bC5mb3JtYXRNZXNzYWdlKHsKICAgICAgICAgIGlkOiAneHBhY2subWwuYW5vbWFsaWVzVGFibGUubGlua3NNZW51LnVuYWJsZVRvVmlld0V4YW1wbGVzRXJyb3JNZXNzYWdlJywKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnVW5hYmxlIHRvIHZpZXcgZXhhbXBsZXMgYXMgbm8gZGV0YWlscyBjb3VsZCBiZSBmb3VuZCBmb3Igam9iIElEIHtqb2JJZH0nCiAgICAgICAgfSwgewogICAgICAgICAgam9iSWQ6IF90aGlzLnByb3BzLmFub21hbHkuam9iSWQKICAgICAgICB9KSk7CgogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIGNhdGVnb3JpemF0aW9uRmllbGROYW1lID0gam9iLmFuYWx5c2lzX2NvbmZpZy5jYXRlZ29yaXphdGlvbl9maWVsZF9uYW1lOwogICAgICB2YXIgZGF0YWZlZWRJbmRpY2VzID0gam9iLmRhdGFmZWVkX2NvbmZpZy5pbmRpY2VzOyAvLyBGaW5kIHRoZSB0eXBlIG9mIHRoZSBjYXRlZ29yaXphdGlvbiBmaWVsZCBpLmUuIHRleHQgKHByZWZlcnJlZCkgb3Iga2V5d29yZC4KICAgICAgLy8gVXNlcyB0aGUgZmlyc3QgbWF0Y2hpbmcgZmllbGQgZm91bmQgaW4gdGhlIGxpc3Qgb2YgaW5kaWNlcyBpbiB0aGUgZGF0YWZlZWRfY29uZmlnLgogICAgICAvLyBhdHRlbXB0IHRvIGxvYWQgdGhlIGZpZWxkIHR5cGUgdXNpbmcgZWFjaCBpbmRleC4gd2UgaGF2ZSB0byBkbyBpdCB0aGlzIHdheSBhcyBfZmllbGRfY2FwcwogICAgICAvLyBkb2Vzbid0IHNwZWNpZnkgd2hpY2ggaW5kZXggYSBmaWVsZCBjYW1lIGZyb20gdW5sZXNzIHRoZXJlIGlzIGEgY2xhc2guCgogICAgICB2YXIgaSA9IDA7CiAgICAgIGZpbmRGaWVsZFR5cGUoZGF0YWZlZWRJbmRpY2VzW2ldKTsKCiAgICAgIGZ1bmN0aW9uIGZpbmRGaWVsZFR5cGUoaW5kZXgpIHsKICAgICAgICAoMCwgX21hcHBpbmdfc2VydmljZS5nZXRGaWVsZFR5cGVGcm9tTWFwcGluZykoaW5kZXgsIGNhdGVnb3JpemF0aW9uRmllbGROYW1lKS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7CiAgICAgICAgICBpZiAocmVzcCAhPT0gJycpIHsKICAgICAgICAgICAgY3JlYXRlQW5kT3BlblVybChpbmRleCwgcmVzcCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpKys7CgogICAgICAgICAgICBpZiAoaSA8IGRhdGFmZWVkSW5kaWNlcy5sZW5ndGgpIHsKICAgICAgICAgICAgICBmaW5kRmllbGRUeXBlKGRhdGFmZWVkSW5kaWNlc1tpXSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgZXJyb3IoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGVycm9yKCk7CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGNyZWF0ZUFuZE9wZW5VcmwoaW5kZXgsIGNhdGVnb3JpemF0aW9uRmllbGRUeXBlKSB7CiAgICAgICAgLy8gRmluZCB0aGUgSUQgb2YgdGhlIGluZGV4IHBhdHRlcm4gd2l0aCBhIHRpdGxlIGF0dHJpYnV0ZSB3aGljaCBtYXRjaGVzIHRoZQogICAgICAgIC8vIGluZGV4IGNvbmZpZ3VyZWQgaW4gdGhlIGRhdGFmZWVkLiBJZiBhIEtpYmFuYSBpbmRleCBwYXR0ZXJuIGhhcyBub3QgYmVlbiBjcmVhdGVkCiAgICAgICAgLy8gZm9yIHRoaXMgaW5kZXgsIHRoZW4gdGhlIHVzZXIgd2lsbCBzZWUgYSB3YXJuaW5nIG1lc3NhZ2Ugb24gdGhlIERpc2NvdmVyIHRhYiBhZHZpc2luZwogICAgICAgIC8vIHRoZW0gdGhhdCBubyBtYXRjaGluZyBpbmRleCBwYXR0ZXJuIGhhcyBiZWVuIGNvbmZpZ3VyZWQuCiAgICAgICAgdmFyIGluZGV4UGF0dGVybklkID0gKDAsIF9pbmRleF91dGlscy5nZXRJbmRleFBhdHRlcm5JZEZyb21OYW1lKShpbmRleCkgfHwgaW5kZXg7IC8vIEdldCB0aGUgZGVmaW5pdGlvbiBvZiB0aGUgY2F0ZWdvcnkgYW5kIHVzZSB0aGUgdGVybXMgb3IgcmVnZXggdG8gdmlldyB0aGUKICAgICAgICAvLyBtYXRjaGluZyBldmVudHMgaW4gdGhlIEtpYmFuYSBEaXNjb3ZlciB0YWIgZGVwZW5kaW5nIG9uIHdoZXRoZXIgdGhlCiAgICAgICAgLy8gY2F0ZWdvcml6YXRpb24gZmllbGQgaXMgb2YgbWFwcGluZyB0eXBlIHRleHQgKHByZWZlcnJlZCkgb3Iga2V5d29yZC4KCiAgICAgICAgX21sX2FwaV9zZXJ2aWNlLm1sLnJlc3VsdHMuZ2V0Q2F0ZWdvcnlEZWZpbml0aW9uKHJlY29yZC5qb2JfaWQsIGNhdGVnb3J5SWQpLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHsKICAgICAgICAgIHZhciBxdWVyeSA9IG51bGw7IC8vIEJ1aWxkIHF1ZXJ5IHVzaW5nIGNhdGVnb3JpemF0aW9uIHJlZ2V4IChpZiBrZXl3b3JkIHR5cGUpIG9yIHRlcm1zIChpZiB0ZXh0IHR5cGUpLgogICAgICAgICAgLy8gQ2hlY2sgZm9yIHRlcm1zIG9yIHJlZ2V4IGluIGNhc2UgY2F0ZWdvcnlJZCByZXByZXNlbnRzIGFuIGFub21hbHkgZnJvbSB0aGUgYWJzZW5jZSBvZiB0aGUKICAgICAgICAgIC8vIGNhdGVnb3JpemF0aW9uIGZpZWxkIGluIGRvY3VtZW50cyAodXN1YWxseSBpbmRpY2F0ZWQgYnkgYSBjYXRlZ29yeUlkIG9mIC0xKS4KCiAgICAgICAgICBpZiAoY2F0ZWdvcml6YXRpb25GaWVsZFR5cGUgPT09IF9wdWJsaWMuRVNfRklFTERfVFlQRVMuS0VZV09SRCkgewogICAgICAgICAgICBpZiAocmVzcC5yZWdleCkgewogICAgICAgICAgICAgIHF1ZXJ5ID0gewogICAgICAgICAgICAgICAgbGFuZ3VhZ2U6IF9zZWFyY2guU0VBUkNIX1FVRVJZX0xBTkdVQUdFLkxVQ0VORSwKICAgICAgICAgICAgICAgIHF1ZXJ5OiAiIi5jb25jYXQoY2F0ZWdvcml6YXRpb25GaWVsZE5hbWUsICI6LyIpLmNvbmNhdChyZXNwLnJlZ2V4LCAiLyIpCiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaWYgKHJlc3AudGVybXMpIHsKICAgICAgICAgICAgICB2YXIgZXNjYXBlZFRlcm1zID0gKDAsIF91dGlscy5lc2NhcGVEb3VibGVRdW90ZXMpKHJlc3AudGVybXMpOwogICAgICAgICAgICAgIHF1ZXJ5ID0gewogICAgICAgICAgICAgICAgbGFuZ3VhZ2U6IF9zZWFyY2guU0VBUkNIX1FVRVJZX0xBTkdVQUdFLktVRVJZLAogICAgICAgICAgICAgICAgcXVlcnk6ICIiLmNvbmNhdChjYXRlZ29yaXphdGlvbkZpZWxkTmFtZSwgIjpcIiIpICsgZXNjYXBlZFRlcm1zLnNwbGl0KCcgJykuam9pbigiXCIgYW5kICIuY29uY2F0KGNhdGVnb3JpemF0aW9uRmllbGROYW1lLCAiOlwiIikpICsgJyInCiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIHZhciByZWNvcmRUaW1lID0gKDAsIF9tb21lbnQuZGVmYXVsdCkocmVjb3JkLnRpbWVzdGFtcCk7CiAgICAgICAgICB2YXIgZnJvbSA9IHJlY29yZFRpbWUudG9JU09TdHJpbmcoKTsKICAgICAgICAgIHZhciB0byA9IHJlY29yZFRpbWUuYWRkKHJlY29yZC5idWNrZXRfc3BhbiwgJ3MnKS50b0lTT1N0cmluZygpOyAvLyBVc2Ugcmlzb24gdG8gYnVpbGQgdGhlIFVSTCAuCgogICAgICAgICAgdmFyIF9nID0gX3Jpc29uTm9kZS5kZWZhdWx0LmVuY29kZSh7CiAgICAgICAgICAgIHJlZnJlc2hJbnRlcnZhbDogewogICAgICAgICAgICAgIGRpc3BsYXk6ICdPZmYnLAogICAgICAgICAgICAgIHBhdXNlOiBmYWxzZSwKICAgICAgICAgICAgICB2YWx1ZTogMAogICAgICAgICAgICB9LAogICAgICAgICAgICB0aW1lOiB7CiAgICAgICAgICAgICAgZnJvbTogZnJvbSwKICAgICAgICAgICAgICB0bzogdG8sCiAgICAgICAgICAgICAgbW9kZTogJ2Fic29sdXRlJwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKCiAgICAgICAgICB2YXIgYXBwU3RhdGVQcm9wcyA9IHsKICAgICAgICAgICAgaW5kZXg6IGluZGV4UGF0dGVybklkLAogICAgICAgICAgICBmaWx0ZXJzOiBbXQogICAgICAgICAgfTsKCiAgICAgICAgICBpZiAocXVlcnkgIT09IG51bGwpIHsKICAgICAgICAgICAgYXBwU3RhdGVQcm9wcy5xdWVyeSA9IHF1ZXJ5OwogICAgICAgICAgfQoKICAgICAgICAgIHZhciBfYSA9IF9yaXNvbk5vZGUuZGVmYXVsdC5lbmNvZGUoYXBwU3RhdGVQcm9wcyk7IC8vIE5lZWQgdG8gZW5jb2RlIHRoZSBfYSBwYXJhbWV0ZXIgYXMgaXQgd2lsbCBjb250YWluIGNoYXJhY3RlcnMgc3VjaCBhcyAnKycgaWYgdXNpbmcgdGhlIHJlZ2V4LgoKCiAgICAgICAgICB2YXIgcGF0aCA9IF9jaHJvbWUuZGVmYXVsdC5nZXRCYXNlUGF0aCgpOwoKICAgICAgICAgIHBhdGggKz0gJy9hcHAva2liYW5hIy9kaXNjb3Zlcic7CiAgICAgICAgICBwYXRoICs9ICc/X2c9JyArIF9nOwogICAgICAgICAgcGF0aCArPSAnJl9hPScgKyBlbmNvZGVVUklDb21wb25lbnQoX2EpOwogICAgICAgICAgd2luZG93Lm9wZW4ocGF0aCwgJ19ibGFuaycpOwogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChyZXNwKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygndmlld0V4YW1wbGVzKCk6IGVycm9yIGxvYWRpbmcgY2F0ZWdvcnlEZWZpbml0aW9uOicsIHJlc3ApOwoKICAgICAgICAgIF9ub3RpZnkudG9hc3ROb3RpZmljYXRpb25zLmFkZERhbmdlcihpbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgICBpZDogJ3hwYWNrLm1sLmFub21hbGllc1RhYmxlLmxpbmtzTWVudS5sb2FkaW5nRGV0YWlsc0Vycm9yTWVzc2FnZScsCiAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnVW5hYmxlIHRvIHZpZXcgZXhhbXBsZXMgYXMgYW4gZXJyb3Igb2NjdXJyZWQgbG9hZGluZyBkZXRhaWxzIG9uIGNhdGVnb3J5IElEIHtjYXRlZ29yeUlkfScKICAgICAgICAgIH0sIHsKICAgICAgICAgICAgY2F0ZWdvcnlJZDogY2F0ZWdvcnlJZAogICAgICAgICAgfSkpOwogICAgICAgIH0pOwogICAgICB9CgogICAgICBmdW5jdGlvbiBlcnJvcigpIHsKICAgICAgICBjb25zb2xlLmxvZygidmlld0V4YW1wbGVzKCk6IGVycm9yIGZpbmRpbmcgdHlwZSBvZiBmaWVsZCAiLmNvbmNhdChjYXRlZ29yaXphdGlvbkZpZWxkTmFtZSwgIiBpbiBpbmRpY2VzOiIpLCBkYXRhZmVlZEluZGljZXMpOwoKICAgICAgICBfbm90aWZ5LnRvYXN0Tm90aWZpY2F0aW9ucy5hZGREYW5nZXIoaW50bC5mb3JtYXRNZXNzYWdlKHsKICAgICAgICAgIGlkOiAneHBhY2subWwuYW5vbWFsaWVzVGFibGUubGlua3NNZW51Lm5vTWFwcGluZ0NvdWxkQmVGb3VuZEVycm9yTWVzc2FnZScsCiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1VuYWJsZSB0byB2aWV3IGV4YW1wbGVzIG9mIGRvY3VtZW50cyB3aXRoIG1sY2F0ZWdvcnkge2NhdGVnb3J5SWR9ICcgKyAnYXMgbm8gbWFwcGluZyBjb3VsZCBiZSBmb3VuZCBmb3IgdGhlIGNhdGVnb3JpemF0aW9uIGZpZWxkIHtjYXRlZ29yaXphdGlvbkZpZWxkTmFtZX0nCiAgICAgICAgfSwgewogICAgICAgICAgY2F0ZWdvcnlJZDogY2F0ZWdvcnlJZCwKICAgICAgICAgIGNhdGVnb3JpemF0aW9uRmllbGROYW1lOiBjYXRlZ29yaXphdGlvbkZpZWxkTmFtZQogICAgICAgIH0pKTsKICAgICAgfQogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAib25CdXR0b25DbGljayIsIGZ1bmN0aW9uICgpIHsKICAgICAgX3RoaXMuc2V0U3RhdGUoZnVuY3Rpb24gKHByZXZTdGF0ZSkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICBpc1BvcG92ZXJPcGVuOiAhcHJldlN0YXRlLmlzUG9wb3Zlck9wZW4KICAgICAgICB9OwogICAgICB9KTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImNsb3NlUG9wb3ZlciIsIGZ1bmN0aW9uICgpIHsKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIGlzUG9wb3Zlck9wZW46IGZhbHNlCiAgICAgIH0pOwogICAgfSk7CgogICAgX3RoaXMuc3RhdGUgPSB7CiAgICAgIGlzUG9wb3Zlck9wZW46IGZhbHNlLAogICAgICB0b2FzdHM6IFtdCiAgICB9OwogICAgcmV0dXJuIF90aGlzOwogIH0KCiAgX2NyZWF0ZUNsYXNzKExpbmtzTWVudSwgW3sKICAgIGtleTogInJlbmRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHZhciBfdGhpcyRwcm9wczIgPSB0aGlzLnByb3BzLAogICAgICAgICAgYW5vbWFseSA9IF90aGlzJHByb3BzMi5hbm9tYWx5LAogICAgICAgICAgc2hvd1ZpZXdTZXJpZXNMaW5rID0gX3RoaXMkcHJvcHMyLnNob3dWaWV3U2VyaWVzTGluaywKICAgICAgICAgIGludGwgPSBfdGhpcyRwcm9wczIuaW50bDsKICAgICAgdmFyIGNhbkNvbmZpZ3VyZVJ1bGVzID0gKDAsIF9hbm9tYWx5X3V0aWxzLmlzUnVsZVN1cHBvcnRlZCkoYW5vbWFseS5zb3VyY2UpICYmICgwLCBfY2hlY2tfcHJpdmlsZWdlLmNoZWNrUGVybWlzc2lvbikoJ2NhblVwZGF0ZUpvYicpOwoKICAgICAgdmFyIGJ1dHRvbiA9IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlCdXR0b25JY29uLCB7CiAgICAgICAgc2l6ZTogInMiLAogICAgICAgIGNvbG9yOiAidGV4dCIsCiAgICAgICAgb25DbGljazogdGhpcy5vbkJ1dHRvbkNsaWNrLAogICAgICAgIGljb25UeXBlOiAiZ2VhciIsCiAgICAgICAgImFyaWEtbGFiZWwiOiBpbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgaWQ6ICd4cGFjay5tbC5hbm9tYWxpZXNUYWJsZS5saW5rc01lbnUuc2VsZWN0QWN0aW9uQXJpYUxhYmVsJywKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnU2VsZWN0IGFjdGlvbiBmb3IgYW5vbWFseSBhdCB7dGltZX0nCiAgICAgICAgfSwgewogICAgICAgICAgdGltZTogKDAsIF9kYXRlX3V0aWxzLmZvcm1hdEh1bWFuUmVhZGFibGVEYXRlVGltZVNlY29uZHMpKGFub21hbHkudGltZSkKICAgICAgICB9KQogICAgICB9KTsKCiAgICAgIHZhciBpdGVtcyA9IFtdOwoKICAgICAgaWYgKGFub21hbHkuY3VzdG9tVXJscyAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgYW5vbWFseS5jdXN0b21VcmxzLmZvckVhY2goZnVuY3Rpb24gKGN1c3RvbVVybCwgaW5kZXgpIHsKICAgICAgICAgIGl0ZW1zLnB1c2goX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUNvbnRleHRNZW51SXRlbSwgewogICAgICAgICAgICBrZXk6ICJjdXN0b21fdXJsXyIuY29uY2F0KGluZGV4KSwKICAgICAgICAgICAgaWNvbjogInBvcG91dCIsCiAgICAgICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7CiAgICAgICAgICAgICAgX3RoaXMyLmNsb3NlUG9wb3ZlcigpOwoKICAgICAgICAgICAgICBfdGhpczIub3BlbkN1c3RvbVVybChjdXN0b21VcmwpOwogICAgICAgICAgICB9CiAgICAgICAgICB9LCBjdXN0b21VcmwudXJsX25hbWUpKTsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgaWYgKHNob3dWaWV3U2VyaWVzTGluayA9PT0gdHJ1ZSAmJiBhbm9tYWx5LmlzVGltZVNlcmllc1ZpZXdSZWNvcmQgPT09IHRydWUpIHsKICAgICAgICBpdGVtcy5wdXNoKF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlDb250ZXh0TWVudUl0ZW0sIHsKICAgICAgICAgIGtleTogInZpZXdfc2VyaWVzIiwKICAgICAgICAgIGljb246ICJzdGF0cyIsCiAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgICBfdGhpczIuY2xvc2VQb3BvdmVyKCk7CgogICAgICAgICAgICBfdGhpczIudmlld1NlcmllcygpOwogICAgICAgICAgfQogICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICBpZDogInhwYWNrLm1sLmFub21hbGllc1RhYmxlLmxpbmtzTWVudS52aWV3U2VyaWVzTGFiZWwiLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJWaWV3IHNlcmllcyIKICAgICAgICB9KSkpOwogICAgICB9CgogICAgICBpZiAoYW5vbWFseS5lbnRpdHlOYW1lID09PSAnbWxjYXRlZ29yeScpIHsKICAgICAgICBpdGVtcy5wdXNoKF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlDb250ZXh0TWVudUl0ZW0sIHsKICAgICAgICAgIGtleTogInZpZXdfZXhhbXBsZXMiLAogICAgICAgICAgaWNvbjogInBvcG91dCIsCiAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgICBfdGhpczIuY2xvc2VQb3BvdmVyKCk7CgogICAgICAgICAgICBfdGhpczIudmlld0V4YW1wbGVzKCk7CiAgICAgICAgICB9CiAgICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICAgIGlkOiAieHBhY2subWwuYW5vbWFsaWVzVGFibGUubGlua3NNZW51LnZpZXdFeGFtcGxlc0xhYmVsIiwKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiVmlldyBleGFtcGxlcyIKICAgICAgICB9KSkpOwogICAgICB9CgogICAgICBpZiAoY2FuQ29uZmlndXJlUnVsZXMpIHsKICAgICAgICBpdGVtcy5wdXNoKF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlDb250ZXh0TWVudUl0ZW0sIHsKICAgICAgICAgIGtleTogImNyZWF0ZV9ydWxlIiwKICAgICAgICAgIGljb246ICJjb250cm9sc0hvcml6b250YWwiLAogICAgICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHsKICAgICAgICAgICAgX3RoaXMyLmNsb3NlUG9wb3ZlcigpOwoKICAgICAgICAgICAgX3RoaXMyLnByb3BzLnNob3dSdWxlRWRpdG9yRmx5b3V0KGFub21hbHkpOwogICAgICAgICAgfQogICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICBpZDogInhwYWNrLm1sLmFub21hbGllc1RhYmxlLmxpbmtzTWVudS5jb25maWd1cmVSdWxlc0xhYmVsIiwKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiQ29uZmlndXJlIHJ1bGVzIgogICAgICAgIH0pKSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpUG9wb3ZlciwgewogICAgICAgIGJ1dHRvbjogYnV0dG9uLAogICAgICAgIGlzT3BlbjogdGhpcy5zdGF0ZS5pc1BvcG92ZXJPcGVuLAogICAgICAgIGNsb3NlUG9wb3ZlcjogdGhpcy5jbG9zZVBvcG92ZXIsCiAgICAgICAgcGFuZWxQYWRkaW5nU2l6ZTogIm5vbmUiLAogICAgICAgIGFuY2hvclBvc2l0aW9uOiAiZG93bkxlZnQiCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlDb250ZXh0TWVudVBhbmVsLCB7CiAgICAgICAgaXRlbXM6IGl0ZW1zCiAgICAgIH0pKTsKICAgIH0KICB9XSk7CgogIHJldHVybiBMaW5rc01lbnU7Cn0oX3JlYWN0LkNvbXBvbmVudCksIF9kZWZpbmVQcm9wZXJ0eShfY2xhc3MsICJwcm9wVHlwZXMiLCB7CiAgYW5vbWFseTogX3Byb3BUeXBlcy5kZWZhdWx0Lm9iamVjdC5pc1JlcXVpcmVkLAogIGJvdW5kczogX3Byb3BUeXBlcy5kZWZhdWx0Lm9iamVjdC5pc1JlcXVpcmVkLAogIHNob3dWaWV3U2VyaWVzTGluazogX3Byb3BUeXBlcy5kZWZhdWx0LmJvb2wsCiAgaXNBZ2dyZWdhdGVkRGF0YTogX3Byb3BUeXBlcy5kZWZhdWx0LmJvb2wsCiAgaW50ZXJ2YWw6IF9wcm9wVHlwZXMuZGVmYXVsdC5zdHJpbmcsCiAgc2hvd1J1bGVFZGl0b3JGbHlvdXQ6IF9wcm9wVHlwZXMuZGVmYXVsdC5mdW5jCn0pLCBfdGVtcCkpOwpleHBvcnRzLkxpbmtzTWVudSA9IExpbmtzTWVudTs="},null]}