{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/security/public/views/management/edit_role/components/privileges/kibana/feature_table/feature_table.js","dependencies":[{"path":"x-pack/legacy/plugins/security/public/views/management/edit_role/components/privileges/kibana/feature_table/feature_table.js","mtime":1585205047204},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiKSB7IF90eXBlb2YyID0gZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mMiA9IGZ1bmN0aW9uIF90eXBlb2YyKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mMihvYmopOyB9CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuRmVhdHVyZVRhYmxlID0gdm9pZCAwOwoKdmFyIF9ldWkgPSByZXF1aXJlKCJAZWxhc3RpYy9ldWkiKTsKCnZhciBfcmVhY3QgPSByZXF1aXJlKCJAa2JuL2kxOG4vcmVhY3QiKTsKCnZhciBfbG9kYXNoID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJsb2Rhc2giKSk7Cgp2YXIgX3JlYWN0MiA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoInJlYWN0IikpOwoKdmFyIF9wcml2aWxlZ2VfdXRpbHMgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi8uLi8uLi8uLi9saWIvcHJpdmlsZWdlX3V0aWxzIik7Cgp2YXIgX2NvbnN0YW50cyA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL2xpYi9jb25zdGFudHMiKTsKCnZhciBfcHJpdmlsZWdlX2Rpc3BsYXkgPSByZXF1aXJlKCIuLi9zcGFjZV9hd2FyZV9wcml2aWxlZ2Vfc2VjdGlvbi9wcml2aWxlZ2VfZGlzcGxheSIpOwoKdmFyIF9jaGFuZ2VfYWxsX3ByaXZpbGVnZXMgPSByZXF1aXJlKCIuL2NoYW5nZV9hbGxfcHJpdmlsZWdlcyIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7CiAgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgewogICAgcmV0dXJuIG9iajsKICB9IGVsc2UgewogICAgdmFyIG5ld09iaiA9IHt9OwoKICAgIGlmIChvYmogIT0gbnVsbCkgewogICAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7CiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHsKICAgICAgICAgIHZhciBkZXNjID0gT2JqZWN0LmRlZmluZVByb3BlcnR5ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KSA6IHt9OwoKICAgICAgICAgIGlmIChkZXNjLmdldCB8fCBkZXNjLnNldCkgewogICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobmV3T2JqLCBrZXksIGRlc2MpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBuZXdPYmouZGVmYXVsdCA9IG9iajsKICAgIHJldHVybiBuZXdPYmo7CiAgfQp9CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgewogIHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7CiAgICBkZWZhdWx0OiBvYmoKICB9Owp9CgpmdW5jdGlvbiBfdHlwZW9mKG9iaikgewogIGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIF90eXBlb2YyKFN5bWJvbC5pdGVyYXRvcikgPT09ICJzeW1ib2wiKSB7CiAgICBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsKICAgICAgcmV0dXJuIF90eXBlb2YyKG9iaik7CiAgICB9OwogIH0gZWxzZSB7CiAgICBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsKICAgICAgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogX3R5cGVvZjIob2JqKTsKICAgIH07CiAgfQoKICByZXR1cm4gX3R5cGVvZihvYmopOwp9CgpmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsKICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7CgogIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7CiAgICB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsKICAgIGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsKICAgICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7CiAgICB9KTsKICAgIGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsKICB9CgogIHJldHVybiBrZXlzOwp9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgewogIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsKCiAgICBpZiAoaSAlIDIpIHsKICAgICAgb3duS2V5cyhzb3VyY2UsIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOwogICAgICB9KTsKICAgIH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsKICAgIH0gZWxzZSB7CiAgICAgIG93bktleXMoc291cmNlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsKICAgICAgfSk7CiAgICB9CiAgfQoKICByZXR1cm4gdGFyZ2V0Owp9CgpmdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7CiAgcmV0dXJuIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfbm9uSXRlcmFibGVTcHJlYWQoKTsKfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlU3ByZWFkKCkgewogIHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7Cn0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXkoaXRlcikgewogIGlmIChTeW1ib2wuaXRlcmF0b3IgaW4gT2JqZWN0KGl0ZXIpIHx8IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChpdGVyKSA9PT0gIltvYmplY3QgQXJndW1lbnRzXSIpIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpOwp9CgpmdW5jdGlvbiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgewogICAgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkoYXJyLmxlbmd0aCk7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHsKICAgICAgYXJyMltpXSA9IGFycltpXTsKICAgIH0KCiAgICByZXR1cm4gYXJyMjsKICB9Cn0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsKICBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7CiAgfQp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgewogICAgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsKICAgIGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsKICAgIGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsKICAgIGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOwogIH0KfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgewogIGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOwogIGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsKICByZXR1cm4gQ29uc3RydWN0b3I7Cn0KCmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsKICBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpKSB7CiAgICByZXR1cm4gY2FsbDsKICB9CgogIHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOwp9CgpmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgewogIF9nZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7CiAgICByZXR1cm4gby5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKG8pOwogIH07CiAgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsKfQoKZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7CiAgaWYgKHNlbGYgPT09IHZvaWQgMCkgewogICAgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsKICB9CgogIHJldHVybiBzZWxmOwp9CgpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsKICBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICJmdW5jdGlvbiIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24iKTsKICB9CgogIHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgewogICAgY29uc3RydWN0b3I6IHsKICAgICAgdmFsdWU6IHN1YkNsYXNzLAogICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlCiAgICB9CiAgfSk7CiAgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcyk7Cn0KCmZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7CiAgX3NldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IGZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7CiAgICBvLl9fcHJvdG9fXyA9IHA7CiAgICByZXR1cm4gbzsKICB9OwoKICByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApOwp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7CiAgaWYgKGtleSBpbiBvYmopIHsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgICB2YWx1ZTogdmFsdWUsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgd3JpdGFibGU6IHRydWUKICAgIH0pOwogIH0gZWxzZSB7CiAgICBvYmpba2V5XSA9IHZhbHVlOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKdmFyIEZlYXR1cmVUYWJsZSA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKF9Db21wb25lbnQpIHsKICBfaW5oZXJpdHMoRmVhdHVyZVRhYmxlLCBfQ29tcG9uZW50KTsKCiAgZnVuY3Rpb24gRmVhdHVyZVRhYmxlKCkgewogICAgdmFyIF9nZXRQcm90b3R5cGVPZjI7CgogICAgdmFyIF90aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBGZWF0dXJlVGFibGUpOwoKICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykgewogICAgICBhcmdzW19rZXldID0gYXJndW1lbnRzW19rZXldOwogICAgfQoKICAgIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKF9nZXRQcm90b3R5cGVPZjIgPSBfZ2V0UHJvdG90eXBlT2YoRmVhdHVyZVRhYmxlKSkuY2FsbC5hcHBseShfZ2V0UHJvdG90eXBlT2YyLCBbdGhpc10uY29uY2F0KGFyZ3MpKSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAib25DaGFuZ2UiLCBmdW5jdGlvbiAoZmVhdHVyZUlkKSB7CiAgICAgIHJldHVybiBmdW5jdGlvbiAoZmVhdHVyZVByaXZpbGVnZUlkKSB7CiAgICAgICAgdmFyIHByaXZpbGVnZSA9IGZlYXR1cmVQcml2aWxlZ2VJZC5zdWJzdHIoIiIuY29uY2F0KGZlYXR1cmVJZCwgIl8iKS5sZW5ndGgpOwoKICAgICAgICBpZiAocHJpdmlsZWdlID09PSBfY29uc3RhbnRzLk5PX1BSSVZJTEVHRV9WQUxVRSkgewogICAgICAgICAgX3RoaXMucHJvcHMub25DaGFuZ2UoZmVhdHVyZUlkLCBbXSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIF90aGlzLnByb3BzLm9uQ2hhbmdlKGZlYXR1cmVJZCwgW3ByaXZpbGVnZV0pOwogICAgICAgIH0KICAgICAgfTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImdldENvbHVtbnMiLCBmdW5jdGlvbiAoYXZhaWxhYmxlUHJpdmlsZWdlcykgewogICAgICByZXR1cm4gW3sKICAgICAgICBmaWVsZDogJ2ZlYXR1cmUnLAogICAgICAgIG5hbWU6IF90aGlzLnByb3BzLmludGwuZm9ybWF0TWVzc2FnZSh7CiAgICAgICAgICBpZDogJ3hwYWNrLnNlY3VyaXR5Lm1hbmFnZW1lbnQuZWRpdFJvbGUuZmVhdHVyZVRhYmxlLmVuYWJsZWRSb2xlRmVhdHVyZXNGZWF0dXJlQ29sdW1uVGl0bGUnLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdGZWF0dXJlJwogICAgICAgIH0pLAogICAgICAgIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKGZlYXR1cmUpIHsKICAgICAgICAgIHZhciB0b29sdGlwRWxlbWVudCA9IG51bGw7CgogICAgICAgICAgaWYgKGZlYXR1cmUucHJpdmlsZWdlc1Rvb2x0aXApIHsKICAgICAgICAgICAgdmFyIHRvb2x0aXBDb250ZW50ID0gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUZXh0LCBudWxsLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudCgicCIsIG51bGwsIGZlYXR1cmUucHJpdmlsZWdlc1Rvb2x0aXApKTsKCiAgICAgICAgICAgIHRvb2x0aXBFbGVtZW50ID0gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlJY29uVGlwLCB7CiAgICAgICAgICAgICAgaWNvblByb3BzOiB7CiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdldWktYWxpZ25Ub3AnCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICB0eXBlOiAnaUluQ2lyY2xlJywKICAgICAgICAgICAgICBjb2xvcjogJ3N1YmR1ZWQnLAogICAgICAgICAgICAgIGNvbnRlbnQ6IHRvb2x0aXBDb250ZW50CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudCgic3BhbiIsIG51bGwsIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpSWNvbiwgewogICAgICAgICAgICBzaXplOiAibSIsCiAgICAgICAgICAgIHR5cGU6IGZlYXR1cmUuaWNvbiwKICAgICAgICAgICAgY2xhc3NOYW1lOiAic2VjUHJpdmlsZWdlRmVhdHVyZUljb24iCiAgICAgICAgICB9KSwgZmVhdHVyZS5uYW1lLCAiICIsIHRvb2x0aXBFbGVtZW50KTsKICAgICAgICB9CiAgICAgIH0sIHsKICAgICAgICBmaWVsZDogJ3ByaXZpbGVnZScsCiAgICAgICAgbmFtZTogX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCBudWxsLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgICAgaWQ6ICJ4cGFjay5zZWN1cml0eS5tYW5hZ2VtZW50LmVkaXRSb2xlLmZlYXR1cmVUYWJsZS5lbmFibGVkUm9sZUZlYXR1cmVzRW5hYmxlZENvbHVtblRpdGxlIiwKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiUHJpdmlsZWdlIgogICAgICAgIH0pLCAhX3RoaXMucHJvcHMuZGlzYWJsZWQgJiYgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2NoYW5nZV9hbGxfcHJpdmlsZWdlcy5DaGFuZ2VBbGxQcml2aWxlZ2VzQ29udHJvbCwgewogICAgICAgICAgcHJpdmlsZWdlczogW10uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShhdmFpbGFibGVQcml2aWxlZ2VzKSwgW19jb25zdGFudHMuTk9fUFJJVklMRUdFX1ZBTFVFXSksCiAgICAgICAgICBvbkNoYW5nZTogX3RoaXMub25DaGFuZ2VBbGxGZWF0dXJlUHJpdmlsZWdlcwogICAgICAgIH0pKSwKICAgICAgICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcihyb2xlRW50cnksIHJlY29yZCkgewogICAgICAgICAgdmFyIF9yZWNvcmQkZmVhdHVyZSA9IHJlY29yZC5mZWF0dXJlLAogICAgICAgICAgICAgIGZlYXR1cmVJZCA9IF9yZWNvcmQkZmVhdHVyZS5pZCwKICAgICAgICAgICAgICBmZWF0dXJlTmFtZSA9IF9yZWNvcmQkZmVhdHVyZS5uYW1lLAogICAgICAgICAgICAgIHJlc2VydmVkID0gX3JlY29yZCRmZWF0dXJlLnJlc2VydmVkLAogICAgICAgICAgICAgIHByaXZpbGVnZXMgPSBfcmVjb3JkJGZlYXR1cmUucHJpdmlsZWdlczsKCiAgICAgICAgICBpZiAocmVzZXJ2ZWQgJiYgT2JqZWN0LmtleXMocHJpdmlsZWdlcykubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgIHJldHVybiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRleHQsIHsKICAgICAgICAgICAgICBzaXplOiAncycKICAgICAgICAgICAgfSwgcmVzZXJ2ZWQuZGVzY3JpcHRpb24pOwogICAgICAgICAgfQoKICAgICAgICAgIHZhciBmZWF0dXJlUHJpdmlsZWdlcyA9IF90aGlzLnByb3BzLmtpYmFuYVByaXZpbGVnZXMuZ2V0RmVhdHVyZVByaXZpbGVnZXMoKS5nZXRQcml2aWxlZ2VzKGZlYXR1cmVJZCk7CgogICAgICAgICAgaWYgKGZlYXR1cmVQcml2aWxlZ2VzLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgZW5hYmxlZEZlYXR1cmVQcml2aWxlZ2VzID0gX3RoaXMuZ2V0RW5hYmxlZEZlYXR1cmVQcml2aWxlZ2VzKGZlYXR1cmVQcml2aWxlZ2VzLCBmZWF0dXJlSWQpOwoKICAgICAgICAgIHZhciBwcml2aWxlZ2VFeHBsYW5hdGlvbiA9IF90aGlzLmdldFByaXZpbGVnZUV4cGxhbmF0aW9uKGZlYXR1cmVJZCk7CgogICAgICAgICAgdmFyIGFsbG93c05vbmUgPSBfdGhpcy5hbGxvd3NOb25lRm9yUHJpdmlsZWdlQXNzaWdubWVudChmZWF0dXJlSWQpOwoKICAgICAgICAgIHZhciBhY3R1YWxQcml2aWxlZ2VWYWx1ZSA9IHByaXZpbGVnZUV4cGxhbmF0aW9uLmFjdHVhbFByaXZpbGVnZTsKICAgICAgICAgIHZhciBjYW5DaGFuZ2VQcml2aWxlZ2UgPSAhX3RoaXMucHJvcHMuZGlzYWJsZWQgJiYgKGFsbG93c05vbmUgfHwgZW5hYmxlZEZlYXR1cmVQcml2aWxlZ2VzLmxlbmd0aCA+IDEpOwoKICAgICAgICAgIGlmICghY2FuQ2hhbmdlUHJpdmlsZWdlKSB7CiAgICAgICAgICAgIHZhciBhc3NpZ25lZEJhc2VQcml2aWxlZ2UgPSBfdGhpcy5wcm9wcy5yb2xlLmtpYmFuYVtfdGhpcy5wcm9wcy5zcGFjZXNJbmRleF0uYmFzZS5sZW5ndGggPiAwOwoKICAgICAgICAgICAgdmFyIGV4Y2x1ZGVkRnJvbUJhc2VQcml2aWxlZ3NUb29sdGlwID0gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICAgICAgICBpZDogInhwYWNrLnNlY3VyaXR5Lm1hbmFnZW1lbnQuZWRpdFJvbGUuZmVhdHVyZVRhYmxlLmV4Y2x1ZGVkRnJvbUJhc2VQcml2aWxlZ3NUb29sdGlwIiwKICAgICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIlVzZSBcIkN1c3RvbVwiIHByaXZpbGVnZXMgdG8gZ3JhbnQgYWNjZXNzLiB7ZmVhdHVyZU5hbWV9IGlzbid0IHBhcnQgb2YgdGhlIGJhc2UgcHJpdmlsZWdlcy4iLAogICAgICAgICAgICAgIHZhbHVlczogewogICAgICAgICAgICAgICAgZmVhdHVyZU5hbWU6IGZlYXR1cmVOYW1lCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIHJldHVybiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcHJpdmlsZWdlX2Rpc3BsYXkuUHJpdmlsZWdlRGlzcGxheSwgewogICAgICAgICAgICAgIHByaXZpbGVnZTogYWN0dWFsUHJpdmlsZWdlVmFsdWUsCiAgICAgICAgICAgICAgZXhwbGFuYXRpb246IHByaXZpbGVnZUV4cGxhbmF0aW9uLAogICAgICAgICAgICAgIHRvb2x0aXBDb250ZW50OiBhc3NpZ25lZEJhc2VQcml2aWxlZ2UgJiYgYWN0dWFsUHJpdmlsZWdlVmFsdWUgPT09IF9jb25zdGFudHMuTk9fUFJJVklMRUdFX1ZBTFVFID8gZXhjbHVkZWRGcm9tQmFzZVByaXZpbGVnc1Rvb2x0aXAgOiB1bmRlZmluZWQKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIG9wdGlvbnMgPSBhdmFpbGFibGVQcml2aWxlZ2VzLm1hcChmdW5jdGlvbiAocHJpdikgewogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgIGlkOiAiIi5jb25jYXQoZmVhdHVyZUlkLCAiXyIpLmNvbmNhdChwcml2KSwKICAgICAgICAgICAgICBsYWJlbDogX2xvZGFzaC5kZWZhdWx0LmNhcGl0YWxpemUocHJpdiksCiAgICAgICAgICAgICAgaXNEaXNhYmxlZDogIWVuYWJsZWRGZWF0dXJlUHJpdmlsZWdlcy5pbmNsdWRlcyhwcml2KQogICAgICAgICAgICB9OwogICAgICAgICAgfSk7CiAgICAgICAgICBvcHRpb25zLnB1c2goewogICAgICAgICAgICBpZDogIiIuY29uY2F0KGZlYXR1cmVJZCwgIl8iKS5jb25jYXQoX2NvbnN0YW50cy5OT19QUklWSUxFR0VfVkFMVUUpLAogICAgICAgICAgICBsYWJlbDogJ05vbmUnLAogICAgICAgICAgICBpc0Rpc2FibGVkOiAhYWxsb3dzTm9uZQogICAgICAgICAgfSk7CiAgICAgICAgICByZXR1cm4gKC8vIEB0cy1pZ25vcmUgbWlzc2luZyBuYW1lIGZyb20gdHlwZWRlZgogICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUJ1dHRvbkdyb3VwIC8vIEB0cy1pZ25vcmUgbWlzc2luZyByb3dQcm9wcyBmcm9tIHR5cGVkZWYKICAgICAgICAgICAgLCB7CiAgICAgICAgICAgICAgbmFtZTogImZlYXR1cmVQcml2aWxlZ2VfIi5jb25jYXQoZmVhdHVyZUlkKSwKICAgICAgICAgICAgICBvcHRpb25zOiBvcHRpb25zLAogICAgICAgICAgICAgIGlkU2VsZWN0ZWQ6ICIiLmNvbmNhdChmZWF0dXJlSWQsICJfIikuY29uY2F0KGFjdHVhbFByaXZpbGVnZVZhbHVlIHx8IF9jb25zdGFudHMuTk9fUFJJVklMRUdFX1ZBTFVFKSwKICAgICAgICAgICAgICBvbkNoYW5nZTogX3RoaXMub25DaGFuZ2UoZmVhdHVyZUlkKQogICAgICAgICAgICB9KQogICAgICAgICAgKTsKICAgICAgICB9CiAgICAgIH1dOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiZ2V0RW5hYmxlZEZlYXR1cmVQcml2aWxlZ2VzIiwgZnVuY3Rpb24gKGZlYXR1cmVQcml2aWxlZ2VzLCBmZWF0dXJlSWQpIHsKICAgICAgdmFyIGFsbG93ZWRQcml2aWxlZ2VzID0gX3RoaXMucHJvcHMuYWxsb3dlZFByaXZpbGVnZXM7CgogICAgICBpZiAoX3RoaXMuaXNDb25maWd1cmluZ0dsb2JhbFByaXZpbGVnZXMoKSkgewogICAgICAgIC8vIEdsb2JhbCBmZWF0dXJlIHByaXZpbGVnZXMgYXJlIG5vdCBsaW1pdGVkIGJ5IGVmZmVjdGl2ZSBwcml2aWxlZ2VzLgogICAgICAgIHJldHVybiBmZWF0dXJlUHJpdmlsZWdlczsKICAgICAgfQoKICAgICAgdmFyIGFsbG93ZWRGZWF0dXJlUHJpdmlsZWdlcyA9IGFsbG93ZWRQcml2aWxlZ2VzLmZlYXR1cmVbZmVhdHVyZUlkXTsKCiAgICAgIGlmIChhbGxvd2VkRmVhdHVyZVByaXZpbGVnZXMgPT0gbnVsbCkgewogICAgICAgIHRocm93IG5ldyBFcnJvcignVW5hYmxlIHRvIGdldCBlbmFibGVkIGZlYXR1cmUgcHJpdmlsZWdlcyBmb3IgYSBmZWF0dXJlIHdpdGhvdXQgcHJpdmlsZWdlcycpOwogICAgICB9CgogICAgICByZXR1cm4gYWxsb3dlZEZlYXR1cmVQcml2aWxlZ2VzLnByaXZpbGVnZXM7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJnZXRQcml2aWxlZ2VFeHBsYW5hdGlvbiIsIGZ1bmN0aW9uIChmZWF0dXJlSWQpIHsKICAgICAgdmFyIGNhbGN1bGF0ZWRQcml2aWxlZ2VzID0gX3RoaXMucHJvcHMuY2FsY3VsYXRlZFByaXZpbGVnZXM7CiAgICAgIHZhciBjYWxjdWxhdGVkRmVhdHVyZVByaXZpbGVnZXMgPSBjYWxjdWxhdGVkUHJpdmlsZWdlcy5mZWF0dXJlW2ZlYXR1cmVJZF07CgogICAgICBpZiAoY2FsY3VsYXRlZEZlYXR1cmVQcml2aWxlZ2VzID09IG51bGwpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VuYWJsZSB0byBnZXQgcHJpdmlsZWdlIGV4cGxhbmF0aW9uIGZvciBhIGZlYXR1cmUgd2l0aG91dCBwcml2aWxlZ2VzJyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBjYWxjdWxhdGVkRmVhdHVyZVByaXZpbGVnZXM7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJhbGxvd3NOb25lRm9yUHJpdmlsZWdlQXNzaWdubWVudCIsIGZ1bmN0aW9uIChmZWF0dXJlSWQpIHsKICAgICAgdmFyIGFsbG93ZWRQcml2aWxlZ2VzID0gX3RoaXMucHJvcHMuYWxsb3dlZFByaXZpbGVnZXM7CiAgICAgIHZhciBhbGxvd2VkRmVhdHVyZVByaXZpbGVnZXMgPSBhbGxvd2VkUHJpdmlsZWdlcy5mZWF0dXJlW2ZlYXR1cmVJZF07CgogICAgICBpZiAoYWxsb3dlZEZlYXR1cmVQcml2aWxlZ2VzID09IG51bGwpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VuYWJsZSB0byBkZXRlcm1pbmUgaWYgbm9uZSBpcyBhbGxvd2VkIGZvciBhIGZlYXR1cmUgd2l0aG91dCBwcml2aWxlZ2VzJyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBhbGxvd2VkRmVhdHVyZVByaXZpbGVnZXMuY2FuVW5hc3NpZ247CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJvbkNoYW5nZUFsbEZlYXR1cmVQcml2aWxlZ2VzIiwgZnVuY3Rpb24gKHByaXZpbGVnZSkgewogICAgICBpZiAocHJpdmlsZWdlID09PSBfY29uc3RhbnRzLk5PX1BSSVZJTEVHRV9WQUxVRSkgewogICAgICAgIF90aGlzLnByb3BzLm9uQ2hhbmdlQWxsKFtdKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBfdGhpcy5wcm9wcy5vbkNoYW5nZUFsbChbcHJpdmlsZWdlXSk7CiAgICAgIH0KICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImlzQ29uZmlndXJpbmdHbG9iYWxQcml2aWxlZ2VzIiwgZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gKDAsIF9wcml2aWxlZ2VfdXRpbHMuaXNHbG9iYWxQcml2aWxlZ2VEZWZpbml0aW9uKShfdGhpcy5wcm9wcy5yb2xlLmtpYmFuYVtfdGhpcy5wcm9wcy5zcGFjZXNJbmRleF0pOwogICAgfSk7CgogICAgcmV0dXJuIF90aGlzOwogIH0KCiAgX2NyZWF0ZUNsYXNzKEZlYXR1cmVUYWJsZSwgW3sKICAgIGtleTogInJlbmRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkgewogICAgICB2YXIgX3RoaXMkcHJvcHMgPSB0aGlzLnByb3BzLAogICAgICAgICAgcm9sZSA9IF90aGlzJHByb3BzLnJvbGUsCiAgICAgICAgICBmZWF0dXJlcyA9IF90aGlzJHByb3BzLmZlYXR1cmVzLAogICAgICAgICAgY2FsY3VsYXRlZFByaXZpbGVnZXMgPSBfdGhpcyRwcm9wcy5jYWxjdWxhdGVkUHJpdmlsZWdlcywKICAgICAgICAgIHJhbmtlZEZlYXR1cmVQcml2aWxlZ2VzID0gX3RoaXMkcHJvcHMucmFua2VkRmVhdHVyZVByaXZpbGVnZXM7CiAgICAgIHZhciBpdGVtcyA9IGZlYXR1cmVzLnNvcnQoZnVuY3Rpb24gKGZlYXR1cmUxLCBmZWF0dXJlMikgewogICAgICAgIGlmIChPYmplY3Qua2V5cyhmZWF0dXJlMS5wcml2aWxlZ2VzKS5sZW5ndGggPT09IDAgJiYgT2JqZWN0LmtleXMoZmVhdHVyZTIucHJpdmlsZWdlcykubGVuZ3RoID4gMCkgewogICAgICAgICAgcmV0dXJuIDE7CiAgICAgICAgfQoKICAgICAgICBpZiAoT2JqZWN0LmtleXMoZmVhdHVyZTIucHJpdmlsZWdlcykubGVuZ3RoID09PSAwICYmIE9iamVjdC5rZXlzKGZlYXR1cmUxLnByaXZpbGVnZXMpLmxlbmd0aCA+IDApIHsKICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICB9CgogICAgICAgIHJldHVybiAwOwogICAgICB9KS5tYXAoZnVuY3Rpb24gKGZlYXR1cmUpIHsKICAgICAgICB2YXIgY2FsY3VsYXRlZEZlYXR1cmVQcml2aWxlZ2VzID0gY2FsY3VsYXRlZFByaXZpbGVnZXMuZmVhdHVyZVtmZWF0dXJlLmlkXTsKICAgICAgICB2YXIgaGFzQW55UHJpdmlsZWdlQXNzaWduZWQgPSBCb29sZWFuKGNhbGN1bGF0ZWRGZWF0dXJlUHJpdmlsZWdlcyAmJiBjYWxjdWxhdGVkRmVhdHVyZVByaXZpbGVnZXMuYWN0dWFsUHJpdmlsZWdlICE9PSBfY29uc3RhbnRzLk5PX1BSSVZJTEVHRV9WQUxVRSk7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIGZlYXR1cmU6IF9vYmplY3RTcHJlYWQoe30sIGZlYXR1cmUsIHsKICAgICAgICAgICAgaGFzQW55UHJpdmlsZWdlQXNzaWduZWQ6IGhhc0FueVByaXZpbGVnZUFzc2lnbmVkCiAgICAgICAgICB9KSwKICAgICAgICAgIHJvbGU6IHJvbGUKICAgICAgICB9OwogICAgICB9KTsgLy8gVE9ETzogVGhpcyBzaW1wbHkgZ3JhYnMgdGhlIGF2YWlsYWJsZSBwcml2aWxlZ2VzIGZyb20gdGhlIGZpcnN0IGZlYXR1cmUgd2UgZW5jb3VudGVyLgogICAgICAvLyBBcyBvZiBub3csIGZlYXR1cmVzIGNhbiBoYXZlICdhbGwnIGFuZCAncmVhZCcgYXMgYXZhaWxhYmxlIHByaXZpbGVnZXMuIE9uY2UgdGhhdCBhc3N1bXB0aW9uIGJyZWFrcywKICAgICAgLy8gdGhpcyB3aWxsIG5lZWQgdXBkYXRpbmcuIFRoaXMgaXMgYSBzaW1wbGlmeWluZyBtZWFzdXJlIHRvIGVuYWJsZSB0aGUgbmV3IFVJLgoKICAgICAgdmFyIGF2YWlsYWJsZVByaXZpbGVnZXMgPSBPYmplY3QudmFsdWVzKHJhbmtlZEZlYXR1cmVQcml2aWxlZ2VzKVswXTsKICAgICAgcmV0dXJuICgvLyBAdHMtaWdub3JlIG1pc3NpbmcgcmVzcG9uc2l2ZSBmcm9tIHR5cGVkZWYKICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUluTWVtb3J5VGFibGUgLy8gQHRzLWlnbm9yZSBtaXNzaW5nIHJvd1Byb3BzIGZyb20gdHlwZWRlZgogICAgICAgICwgewogICAgICAgICAgcmVzcG9uc2l2ZTogZmFsc2UsCiAgICAgICAgICBjb2x1bW5zOiB0aGlzLmdldENvbHVtbnMoYXZhaWxhYmxlUHJpdmlsZWdlcyksCiAgICAgICAgICBpdGVtczogaXRlbXMKICAgICAgICB9KQogICAgICApOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIEZlYXR1cmVUYWJsZTsKfShfcmVhY3QyLkNvbXBvbmVudCk7CgpleHBvcnRzLkZlYXR1cmVUYWJsZSA9IEZlYXR1cmVUYWJsZTsKCl9kZWZpbmVQcm9wZXJ0eShGZWF0dXJlVGFibGUsICJkZWZhdWx0UHJvcHMiLCB7CiAgc3BhY2VzSW5kZXg6IC0xLAogIHNob3dMb2NrczogdHJ1ZQp9KTs="},null]}