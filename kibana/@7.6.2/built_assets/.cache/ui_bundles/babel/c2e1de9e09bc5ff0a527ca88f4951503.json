{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/siem/public/pages/detection_engine/components/signals/index.js","dependencies":[{"path":"x-pack/legacy/plugins/siem/public/pages/detection_engine/components/signals/index.js","mtime":1585205047851},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLlNpZ25hbHNUYWJsZSA9IGV4cG9ydHMuU0lHTkFMU19QQUdFX1RJTUVMSU5FX0lEID0gdm9pZCAwOwoKdmFyIF9ldWkgPSByZXF1aXJlKCJAZWxhc3RpYy9ldWkiKTsKCnZhciBfZnAgPSByZXF1aXJlKCJsb2Rhc2gvZnAiKTsKCnZhciBfcmVhY3QgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKCJyZWFjdCIpKTsKCnZhciBfcmVhY3RSZWR1eCA9IHJlcXVpcmUoInJlYWN0LXJlZHV4Iik7Cgp2YXIgX2VzX3F1ZXJ5ID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vc3JjL3BsdWdpbnMvZGF0YS9jb21tb24vZXNfcXVlcnkiKTsKCnZhciBfZmV0Y2hfaW5kZXhfcGF0dGVybnMgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9jb250YWluZXJzL2RldGVjdGlvbl9lbmdpbmUvcnVsZXMvZmV0Y2hfaW5kZXhfcGF0dGVybnMiKTsKCnZhciBfZXZlbnRzX3ZpZXdlciA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL2NvbXBvbmVudHMvZXZlbnRzX3ZpZXdlciIpOwoKdmFyIF9oZWFkZXJfc2VjdGlvbiA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL2NvbXBvbmVudHMvaGVhZGVyX3NlY3Rpb24iKTsKCnZhciBfaGVscGVycyA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL2NvbXBvbmVudHMvdGltZWxpbmUvaGVscGVycyIpOwoKdmFyIF9raWJhbmEgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9saWIva2liYW5hIik7Cgp2YXIgX3N0b3JlID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vc3RvcmUiKTsKCnZhciBfdGltZWxpbmUgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9zdG9yZS90aW1lbGluZSIpOwoKdmFyIF9kZWZhdWx0cyA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL3N0b3JlL3RpbWVsaW5lL2RlZmF1bHRzIik7Cgp2YXIgX2Fwb2xsb19jb250ZXh0ID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vdXRpbHMvYXBvbGxvX2NvbnRleHQiKTsKCnZhciBfYWN0aW9ucyA9IHJlcXVpcmUoIi4vYWN0aW9ucyIpOwoKdmFyIF9kZWZhdWx0X2NvbmZpZyA9IHJlcXVpcmUoIi4vZGVmYXVsdF9jb25maWciKTsKCnZhciBfc2lnbmFsc19maWx0ZXJfZ3JvdXAgPSByZXF1aXJlKCIuL3NpZ25hbHNfZmlsdGVyX2dyb3VwIik7Cgp2YXIgX3NpZ25hbHNfdXRpbGl0eV9iYXIgPSByZXF1aXJlKCIuL3NpZ25hbHNfdXRpbGl0eV9iYXIiKTsKCnZhciBpMThuID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgiLi90cmFuc2xhdGlvbnMiKSk7Cgp2YXIgX2hlbHBlcnMyID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vY29tcG9uZW50cy9vcGVuX3RpbWVsaW5lL2hlbHBlcnMiKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgewogIGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsKICAgIHJldHVybiBvYmo7CiAgfSBlbHNlIHsKICAgIHZhciBuZXdPYmogPSB7fTsKCiAgICBpZiAob2JqICE9IG51bGwpIHsKICAgICAgZm9yICh2YXIga2V5IGluIG9iaikgewogICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7CiAgICAgICAgICB2YXIgZGVzYyA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSAmJiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID8gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIGtleSkgOiB7fTsKCiAgICAgICAgICBpZiAoZGVzYy5nZXQgfHwgZGVzYy5zZXQpIHsKICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5ld09iaiwga2V5LCBkZXNjKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG5ld09ialtrZXldID0gb2JqW2tleV07CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgbmV3T2JqLmRlZmF1bHQgPSBvYmo7CiAgICByZXR1cm4gbmV3T2JqOwogIH0KfQoKZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7CiAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOwoKICBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgewogICAgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7CiAgICBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7CiAgICAgIHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOwogICAgfSk7CiAgICBrZXlzLnB1c2guYXBwbHkoa2V5cywgc3ltYm9scyk7CiAgfQoKICByZXR1cm4ga2V5czsKfQoKZnVuY3Rpb24gX29iamVjdFNwcmVhZCh0YXJnZXQpIHsKICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgewogICAgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXSAhPSBudWxsID8gYXJndW1lbnRzW2ldIDoge307CgogICAgaWYgKGkgJSAyKSB7CiAgICAgIG93bktleXMoc291cmNlLCB0cnVlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsKICAgICAgfSk7CiAgICB9IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKSB7CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoc291cmNlKSk7CiAgICB9IGVsc2UgewogICAgICBvd25LZXlzKHNvdXJjZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwga2V5KSk7CiAgICAgIH0pOwogICAgfQogIH0KCiAgcmV0dXJuIHRhcmdldDsKfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgewogIGlmIChrZXkgaW4gb2JqKSB7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsKICAgICAgdmFsdWU6IHZhbHVlLAogICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgIHdyaXRhYmxlOiB0cnVlCiAgICB9KTsKICB9IGVsc2UgewogICAgb2JqW2tleV0gPSB2YWx1ZTsKICB9CgogIHJldHVybiBvYmo7Cn0KCmZ1bmN0aW9uIF90b0NvbnN1bWFibGVBcnJheShhcnIpIHsKICByZXR1cm4gX2FycmF5V2l0aG91dEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheShhcnIpIHx8IF9ub25JdGVyYWJsZVNwcmVhZCgpOwp9CgpmdW5jdGlvbiBfbm9uSXRlcmFibGVTcHJlYWQoKSB7CiAgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIHNwcmVhZCBub24taXRlcmFibGUgaW5zdGFuY2UiKTsKfQoKZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheShpdGVyKSB7CiAgaWYgKFN5bWJvbC5pdGVyYXRvciBpbiBPYmplY3QoaXRlcikgfHwgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGl0ZXIpID09PSAiW29iamVjdCBBcmd1bWVudHNdIikgcmV0dXJuIEFycmF5LmZyb20oaXRlcik7Cn0KCmZ1bmN0aW9uIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHsKICBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSB7CiAgICBmb3IgKHZhciBpID0gMCwgYXJyMiA9IG5ldyBBcnJheShhcnIubGVuZ3RoKTsgaSA8IGFyci5sZW5ndGg7IGkrKykgewogICAgICBhcnIyW2ldID0gYXJyW2ldOwogICAgfQoKICAgIHJldHVybiBhcnIyOwogIH0KfQoKZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7CiAgcmV0dXJuIF9hcnJheVdpdGhIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHx8IF9ub25JdGVyYWJsZVJlc3QoKTsKfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlUmVzdCgpIHsKICB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7Cn0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHsKICB2YXIgX2FyciA9IFtdOwogIHZhciBfbiA9IHRydWU7CiAgdmFyIF9kID0gZmFsc2U7CiAgdmFyIF9lID0gdW5kZWZpbmVkOwoKICB0cnkgewogICAgZm9yICh2YXIgX2kgPSBhcnJbU3ltYm9sLml0ZXJhdG9yXSgpLCBfczsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSkgewogICAgICBfYXJyLnB1c2goX3MudmFsdWUpOwoKICAgICAgaWYgKGkgJiYgX2Fyci5sZW5ndGggPT09IGkpIGJyZWFrOwogICAgfQogIH0gY2F0Y2ggKGVycikgewogICAgX2QgPSB0cnVlOwogICAgX2UgPSBlcnI7CiAgfSBmaW5hbGx5IHsKICAgIHRyeSB7CiAgICAgIGlmICghX24gJiYgX2lbInJldHVybiJdICE9IG51bGwpIF9pWyJyZXR1cm4iXSgpOwogICAgfSBmaW5hbGx5IHsKICAgICAgaWYgKF9kKSB0aHJvdyBfZTsKICAgIH0KICB9CgogIHJldHVybiBfYXJyOwp9CgpmdW5jdGlvbiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsKfQoKdmFyIFNJR05BTFNfUEFHRV9USU1FTElORV9JRCA9ICdzaWduYWxzLXBhZ2UnOwpleHBvcnRzLlNJR05BTFNfUEFHRV9USU1FTElORV9JRCA9IFNJR05BTFNfUEFHRV9USU1FTElORV9JRDsKCnZhciBTaWduYWxzVGFibGVDb21wb25lbnQgPSBmdW5jdGlvbiBTaWduYWxzVGFibGVDb21wb25lbnQoX3JlZikgewogIHZhciBjYW5Vc2VyQ1JVRCA9IF9yZWYuY2FuVXNlckNSVUQsCiAgICAgIGNsZWFyRXZlbnRzRGVsZXRlZCA9IF9yZWYuY2xlYXJFdmVudHNEZWxldGVkLAogICAgICBjbGVhckV2ZW50c0xvYWRpbmcgPSBfcmVmLmNsZWFyRXZlbnRzTG9hZGluZywKICAgICAgY2xlYXJTZWxlY3RlZCA9IF9yZWYuY2xlYXJTZWxlY3RlZCwKICAgICAgZGVmYXVsdEZpbHRlcnMgPSBfcmVmLmRlZmF1bHRGaWx0ZXJzLAogICAgICBmcm9tID0gX3JlZi5mcm9tLAogICAgICBnbG9iYWxGaWx0ZXJzID0gX3JlZi5nbG9iYWxGaWx0ZXJzLAogICAgICBnbG9iYWxRdWVyeSA9IF9yZWYuZ2xvYmFsUXVlcnksCiAgICAgIGhhc0luZGV4V3JpdGUgPSBfcmVmLmhhc0luZGV4V3JpdGUsCiAgICAgIGlzU2VsZWN0QWxsQ2hlY2tlZCA9IF9yZWYuaXNTZWxlY3RBbGxDaGVja2VkLAogICAgICBsb2FkaW5nID0gX3JlZi5sb2FkaW5nLAogICAgICBsb2FkaW5nRXZlbnRJZHMgPSBfcmVmLmxvYWRpbmdFdmVudElkcywKICAgICAgc2VsZWN0ZWRFdmVudElkcyA9IF9yZWYuc2VsZWN0ZWRFdmVudElkcywKICAgICAgc2V0RXZlbnRzRGVsZXRlZCA9IF9yZWYuc2V0RXZlbnRzRGVsZXRlZCwKICAgICAgc2V0RXZlbnRzTG9hZGluZyA9IF9yZWYuc2V0RXZlbnRzTG9hZGluZywKICAgICAgc2lnbmFsc0luZGV4ID0gX3JlZi5zaWduYWxzSW5kZXgsCiAgICAgIHRvID0gX3JlZi50bywKICAgICAgdXBkYXRlVGltZWxpbmUgPSBfcmVmLnVwZGF0ZVRpbWVsaW5lLAogICAgICB1cGRhdGVUaW1lbGluZUlzTG9hZGluZyA9IF9yZWYudXBkYXRlVGltZWxpbmVJc0xvYWRpbmc7CgogIHZhciBfdXNlU3RhdGUgPSAoMCwgX3JlYWN0LnVzZVN0YXRlKShmYWxzZSksCiAgICAgIF91c2VTdGF0ZTIgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUsIDIpLAogICAgICBzZWxlY3RBbGwgPSBfdXNlU3RhdGUyWzBdLAogICAgICBzZXRTZWxlY3RBbGwgPSBfdXNlU3RhdGUyWzFdOwoKICB2YXIgYXBvbGxvQ2xpZW50ID0gKDAsIF9hcG9sbG9fY29udGV4dC51c2VBcG9sbG9DbGllbnQpKCk7CgogIHZhciBfdXNlU3RhdGUzID0gKDAsIF9yZWFjdC51c2VTdGF0ZSkoZmFsc2UpLAogICAgICBfdXNlU3RhdGU0ID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlMywgMiksCiAgICAgIHNob3dDbGVhclNlbGVjdGlvbkFjdGlvbiA9IF91c2VTdGF0ZTRbMF0sCiAgICAgIHNldFNob3dDbGVhclNlbGVjdGlvbkFjdGlvbiA9IF91c2VTdGF0ZTRbMV07CgogIHZhciBfdXNlU3RhdGU1ID0gKDAsIF9yZWFjdC51c2VTdGF0ZSkoX3NpZ25hbHNfZmlsdGVyX2dyb3VwLkZJTFRFUl9PUEVOKSwKICAgICAgX3VzZVN0YXRlNiA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZTUsIDIpLAogICAgICBmaWx0ZXJHcm91cCA9IF91c2VTdGF0ZTZbMF0sCiAgICAgIHNldEZpbHRlckdyb3VwID0gX3VzZVN0YXRlNlsxXTsKCiAgdmFyIF91c2VGZXRjaEluZGV4UGF0dGVybiA9ICgwLCBfZmV0Y2hfaW5kZXhfcGF0dGVybnMudXNlRmV0Y2hJbmRleFBhdHRlcm5zKShzaWduYWxzSW5kZXggIT09ICcnID8gW3NpZ25hbHNJbmRleF0gOiBbXSksCiAgICAgIF91c2VGZXRjaEluZGV4UGF0dGVybjIgPSBfc2xpY2VkVG9BcnJheShfdXNlRmV0Y2hJbmRleFBhdHRlcm4sIDEpLAogICAgICBfdXNlRmV0Y2hJbmRleFBhdHRlcm4zID0gX3VzZUZldGNoSW5kZXhQYXR0ZXJuMlswXSwKICAgICAgYnJvd3NlckZpZWxkcyA9IF91c2VGZXRjaEluZGV4UGF0dGVybjMuYnJvd3NlckZpZWxkcywKICAgICAgaW5kZXhQYXR0ZXJucyA9IF91c2VGZXRjaEluZGV4UGF0dGVybjMuaW5kZXhQYXR0ZXJuczsKCiAgdmFyIGtpYmFuYSA9ICgwLCBfa2liYW5hLnVzZUtpYmFuYSkoKTsKICB2YXIgZ2V0R2xvYmFsUXVlcnkgPSAoMCwgX3JlYWN0LnVzZUNhbGxiYWNrKShmdW5jdGlvbiAoKSB7CiAgICBpZiAoYnJvd3NlckZpZWxkcyAhPSBudWxsICYmIGluZGV4UGF0dGVybnMgIT0gbnVsbCkgewogICAgICByZXR1cm4gKDAsIF9oZWxwZXJzLmNvbWJpbmVRdWVyaWVzKSh7CiAgICAgICAgY29uZmlnOiBfZXNfcXVlcnkuZXNRdWVyeS5nZXRFc1F1ZXJ5Q29uZmlnKGtpYmFuYS5zZXJ2aWNlcy51aVNldHRpbmdzKSwKICAgICAgICBkYXRhUHJvdmlkZXJzOiBbXSwKICAgICAgICBpbmRleFBhdHRlcm46IGluZGV4UGF0dGVybnMsCiAgICAgICAgYnJvd3NlckZpZWxkczogYnJvd3NlckZpZWxkcywKICAgICAgICBmaWx0ZXJzOiAoMCwgX2ZwLmlzRW1wdHkpKGRlZmF1bHRGaWx0ZXJzKSA/IGdsb2JhbEZpbHRlcnMgOiBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KGRlZmF1bHRGaWx0ZXJzICE9PSBudWxsICYmIGRlZmF1bHRGaWx0ZXJzICE9PSB2b2lkIDAgPyBkZWZhdWx0RmlsdGVycyA6IFtdKSwgX3RvQ29uc3VtYWJsZUFycmF5KGdsb2JhbEZpbHRlcnMpKSwKICAgICAgICBrcWxRdWVyeTogZ2xvYmFsUXVlcnksCiAgICAgICAga3FsTW9kZTogZ2xvYmFsUXVlcnkubGFuZ3VhZ2UsCiAgICAgICAgc3RhcnQ6IGZyb20sCiAgICAgICAgZW5kOiB0bywKICAgICAgICBpc0V2ZW50Vmlld2VyOiB0cnVlCiAgICAgIH0pOwogICAgfQoKICAgIHJldHVybiBudWxsOwogIH0sIFticm93c2VyRmllbGRzLCBnbG9iYWxGaWx0ZXJzLCBnbG9iYWxRdWVyeSwgaW5kZXhQYXR0ZXJucywga2liYW5hLCB0bywgZnJvbV0pOyAvLyBDYWxsYmFjayBmb3IgY3JlYXRpbmcgYSBuZXcgdGltZWxpbmUgLS0gdXRpbGl6ZWQgYnkgcm93L2JhdGNoIGFjdGlvbnMKCiAgdmFyIGNyZWF0ZVRpbWVsaW5lQ2FsbGJhY2sgPSAoMCwgX3JlYWN0LnVzZUNhbGxiYWNrKShmdW5jdGlvbiAoX3JlZjIpIHsKICAgIHZhciBmcm9tVGltZWxpbmUgPSBfcmVmMi5mcm9tLAogICAgICAgIHRpbWVsaW5lID0gX3JlZjIudGltZWxpbmUsCiAgICAgICAgdG9UaW1lbGluZSA9IF9yZWYyLnRvOwogICAgdXBkYXRlVGltZWxpbmVJc0xvYWRpbmcoewogICAgICBpZDogJ3RpbWVsaW5lLTEnLAogICAgICBpc0xvYWRpbmc6IGZhbHNlCiAgICB9KTsKICAgIHVwZGF0ZVRpbWVsaW5lKHsKICAgICAgZHVwbGljYXRlOiB0cnVlLAogICAgICBmcm9tOiBmcm9tVGltZWxpbmUsCiAgICAgIGlkOiAndGltZWxpbmUtMScsCiAgICAgIG5vdGVzOiBbXSwKICAgICAgdGltZWxpbmU6IF9vYmplY3RTcHJlYWQoe30sIHRpbWVsaW5lLCB7CiAgICAgICAgc2hvdzogdHJ1ZQogICAgICB9KSwKICAgICAgdG86IHRvVGltZWxpbmUKICAgIH0pKCk7CiAgfSwgW3VwZGF0ZVRpbWVsaW5lLCB1cGRhdGVUaW1lbGluZUlzTG9hZGluZ10pOwogIHZhciBzZXRFdmVudHNMb2FkaW5nQ2FsbGJhY2sgPSAoMCwgX3JlYWN0LnVzZUNhbGxiYWNrKShmdW5jdGlvbiAoX3JlZjMpIHsKICAgIHZhciBldmVudElkcyA9IF9yZWYzLmV2ZW50SWRzLAogICAgICAgIGlzTG9hZGluZyA9IF9yZWYzLmlzTG9hZGluZzsKICAgIHNldEV2ZW50c0xvYWRpbmcoewogICAgICBpZDogU0lHTkFMU19QQUdFX1RJTUVMSU5FX0lELAogICAgICBldmVudElkczogZXZlbnRJZHMsCiAgICAgIGlzTG9hZGluZzogaXNMb2FkaW5nCiAgICB9KTsKICB9LCBbc2V0RXZlbnRzTG9hZGluZywgU0lHTkFMU19QQUdFX1RJTUVMSU5FX0lEXSk7CiAgdmFyIHNldEV2ZW50c0RlbGV0ZWRDYWxsYmFjayA9ICgwLCBfcmVhY3QudXNlQ2FsbGJhY2spKGZ1bmN0aW9uIChfcmVmNCkgewogICAgdmFyIGV2ZW50SWRzID0gX3JlZjQuZXZlbnRJZHMsCiAgICAgICAgaXNEZWxldGVkID0gX3JlZjQuaXNEZWxldGVkOwogICAgc2V0RXZlbnRzRGVsZXRlZCh7CiAgICAgIGlkOiBTSUdOQUxTX1BBR0VfVElNRUxJTkVfSUQsCiAgICAgIGV2ZW50SWRzOiBldmVudElkcywKICAgICAgaXNEZWxldGVkOiBpc0RlbGV0ZWQKICAgIH0pOwogIH0sIFtzZXRFdmVudHNEZWxldGVkLCBTSUdOQUxTX1BBR0VfVElNRUxJTkVfSURdKTsgLy8gQ2F0Y2hlcyBzdGF0ZSBjaGFuZ2UgaXNTZWxlY3RBbGxDaGVja2VkLT5mYWxzZSB1cG9uIHVzZXIgc2VsZWN0aW9uIGNoYW5nZSB0byByZXNldCB1dGlsaXR5IGJhcgoKICAoMCwgX3JlYWN0LnVzZUVmZmVjdCkoZnVuY3Rpb24gKCkgewogICAgaWYgKCFpc1NlbGVjdEFsbENoZWNrZWQpIHsKICAgICAgc2V0U2hvd0NsZWFyU2VsZWN0aW9uQWN0aW9uKGZhbHNlKTsKICAgIH0gZWxzZSB7CiAgICAgIHNldFNlbGVjdEFsbChmYWxzZSk7CiAgICB9CiAgfSwgW2lzU2VsZWN0QWxsQ2hlY2tlZF0pOyAvLyBDYWxsYmFjayBmb3Igd2hlbiBvcGVuL2Nsb3NlZCBmaWx0ZXIgY2hhbmdlcwoKICB2YXIgb25GaWx0ZXJHcm91cENoYW5nZWRDYWxsYmFjayA9ICgwLCBfcmVhY3QudXNlQ2FsbGJhY2spKGZ1bmN0aW9uIChuZXdGaWx0ZXJHcm91cCkgewogICAgY2xlYXJFdmVudHNMb2FkaW5nKHsKICAgICAgaWQ6IFNJR05BTFNfUEFHRV9USU1FTElORV9JRAogICAgfSk7CiAgICBjbGVhckV2ZW50c0RlbGV0ZWQoewogICAgICBpZDogU0lHTkFMU19QQUdFX1RJTUVMSU5FX0lECiAgICB9KTsKICAgIGNsZWFyU2VsZWN0ZWQoewogICAgICBpZDogU0lHTkFMU19QQUdFX1RJTUVMSU5FX0lECiAgICB9KTsKICAgIHNldEZpbHRlckdyb3VwKG5ld0ZpbHRlckdyb3VwKTsKICB9LCBbY2xlYXJFdmVudHNMb2FkaW5nLCBjbGVhckV2ZW50c0RlbGV0ZWQsIGNsZWFyU2VsZWN0ZWQsIHNldEZpbHRlckdyb3VwXSk7IC8vIENhbGxiYWNrIGZvciBjbGVhcmluZyBlbnRpcmUgc2VsZWN0aW9uIGZyb20gdXRpbGl0eSBiYXIKCiAgdmFyIGNsZWFyU2VsZWN0aW9uQ2FsbGJhY2sgPSAoMCwgX3JlYWN0LnVzZUNhbGxiYWNrKShmdW5jdGlvbiAoKSB7CiAgICBjbGVhclNlbGVjdGVkKHsKICAgICAgaWQ6IFNJR05BTFNfUEFHRV9USU1FTElORV9JRAogICAgfSk7CiAgICBzZXRTZWxlY3RBbGwoZmFsc2UpOwogICAgc2V0U2hvd0NsZWFyU2VsZWN0aW9uQWN0aW9uKGZhbHNlKTsKICB9LCBbY2xlYXJTZWxlY3RlZCwgc2V0U2VsZWN0QWxsLCBzZXRTaG93Q2xlYXJTZWxlY3Rpb25BY3Rpb25dKTsgLy8gQ2FsbGJhY2sgZm9yIHNlbGVjdGluZyBhbGwgZXZlbnRzIG9uIGFsbCBwYWdlcyBmcm9tIHV0aWxpdHkgYmFyCiAgLy8gRGlzcGF0Y2hlcyB0byBzdGF0ZWZ1bF9ib2R5J3Mgc2VsZWN0QWxsIHZpYSBUaW1lbGluZVR5cGVDb250ZXh0IHByb3BzCiAgLy8gYXMgc2NvcGUgb2YgcmVzcG9uc2UgZGF0YSByZXF1aXJlZCB0byBhY3R1YWxseSBzZXQgc2VsZWN0ZWRFdmVudHMKCiAgdmFyIHNlbGVjdEFsbENhbGxiYWNrID0gKDAsIF9yZWFjdC51c2VDYWxsYmFjaykoZnVuY3Rpb24gKCkgewogICAgc2V0U2VsZWN0QWxsKHRydWUpOwogICAgc2V0U2hvd0NsZWFyU2VsZWN0aW9uQWN0aW9uKHRydWUpOwogIH0sIFtzZXRTZWxlY3RBbGwsIHNldFNob3dDbGVhclNlbGVjdGlvbkFjdGlvbl0pOwogIHZhciB1cGRhdGVTaWduYWxzU3RhdHVzQ2FsbGJhY2sgPSAoMCwgX3JlYWN0LnVzZUNhbGxiYWNrKShmdW5jdGlvbiBfY2FsbGVlKHJlZmV0Y2hRdWVyeSwgX3JlZjUpIHsKICAgIHZhciBfZ2V0R2xvYmFsUXVlcnk7CgogICAgdmFyIHNpZ25hbElkcywgc3RhdHVzOwogICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hc3luYyhmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgc2lnbmFsSWRzID0gX3JlZjUuc2lnbmFsSWRzLCBzdGF0dXMgPSBfcmVmNS5zdGF0dXM7CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzOwogICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKCgwLCBfYWN0aW9ucy51cGRhdGVTaWduYWxTdGF0dXNBY3Rpb24pKHsKICAgICAgICAgICAgICBxdWVyeTogc2hvd0NsZWFyU2VsZWN0aW9uQWN0aW9uID8gKF9nZXRHbG9iYWxRdWVyeSA9IGdldEdsb2JhbFF1ZXJ5KCkpID09PSBudWxsIHx8IF9nZXRHbG9iYWxRdWVyeSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2dldEdsb2JhbFF1ZXJ5LmZpbHRlclF1ZXJ5IDogdW5kZWZpbmVkLAogICAgICAgICAgICAgIHNpZ25hbElkczogT2JqZWN0LmtleXMoc2VsZWN0ZWRFdmVudElkcyksCiAgICAgICAgICAgICAgc3RhdHVzOiBzdGF0dXMsCiAgICAgICAgICAgICAgc2V0RXZlbnRzRGVsZXRlZDogc2V0RXZlbnRzRGVsZXRlZENhbGxiYWNrLAogICAgICAgICAgICAgIHNldEV2ZW50c0xvYWRpbmc6IHNldEV2ZW50c0xvYWRpbmdDYWxsYmFjawogICAgICAgICAgICB9KSk7CgogICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICByZWZldGNoUXVlcnkoKTsKCiAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSk7CiAgfSwgW2dldEdsb2JhbFF1ZXJ5LCBzZWxlY3RlZEV2ZW50SWRzLCBzZXRFdmVudHNEZWxldGVkQ2FsbGJhY2ssIHNldEV2ZW50c0xvYWRpbmdDYWxsYmFjaywgc2hvd0NsZWFyU2VsZWN0aW9uQWN0aW9uXSk7IC8vIENhbGxiYWNrIGZvciBjcmVhdGluZyB0aGUgU2lnbmFsVXRpbGl0eUJhciB3aGljaCByZWNlaXZlcyB0b3RhbENvdW50IGZyb20gRXZlbnRzVmlld2VyIGNvbXBvbmVudAoKICB2YXIgdXRpbGl0eUJhckNhbGxiYWNrID0gKDAsIF9yZWFjdC51c2VDYWxsYmFjaykoZnVuY3Rpb24gKHJlZmV0Y2hRdWVyeSwgdG90YWxDb3VudCkgewogICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3NpZ25hbHNfdXRpbGl0eV9iYXIuU2lnbmFsc1V0aWxpdHlCYXIsIHsKICAgICAgY2FuVXNlckNSVUQ6IGNhblVzZXJDUlVELAogICAgICBhcmVFdmVudHNMb2FkaW5nOiBsb2FkaW5nRXZlbnRJZHMubGVuZ3RoID4gMCwKICAgICAgY2xlYXJTZWxlY3Rpb246IGNsZWFyU2VsZWN0aW9uQ2FsbGJhY2ssCiAgICAgIGhhc0luZGV4V3JpdGU6IGhhc0luZGV4V3JpdGUsCiAgICAgIGlzRmlsdGVyZWRUb09wZW46IGZpbHRlckdyb3VwID09PSBfc2lnbmFsc19maWx0ZXJfZ3JvdXAuRklMVEVSX09QRU4sCiAgICAgIHNlbGVjdEFsbDogc2VsZWN0QWxsQ2FsbGJhY2ssCiAgICAgIHNlbGVjdGVkRXZlbnRJZHM6IHNlbGVjdGVkRXZlbnRJZHMsCiAgICAgIHNob3dDbGVhclNlbGVjdGlvbjogc2hvd0NsZWFyU2VsZWN0aW9uQWN0aW9uLAogICAgICB0b3RhbENvdW50OiB0b3RhbENvdW50LAogICAgICB1cGRhdGVTaWduYWxzU3RhdHVzOiB1cGRhdGVTaWduYWxzU3RhdHVzQ2FsbGJhY2suYmluZChudWxsLCByZWZldGNoUXVlcnkpCiAgICB9KTsKICB9LCBbY2FuVXNlckNSVUQsIGhhc0luZGV4V3JpdGUsIGNsZWFyU2VsZWN0aW9uQ2FsbGJhY2ssIGZpbHRlckdyb3VwLCBsb2FkaW5nRXZlbnRJZHMubGVuZ3RoLCBzZWxlY3RBbGxDYWxsYmFjaywgc2VsZWN0ZWRFdmVudElkcywgc2hvd0NsZWFyU2VsZWN0aW9uQWN0aW9uLCB1cGRhdGVTaWduYWxzU3RhdHVzQ2FsbGJhY2tdKTsgLy8gU2VuZCB0byBUaW1lbGluZSAvIFVwZGF0ZSBTaWduYWwgU3RhdHVzIEFjdGlvbnMgZm9yIGVhY2ggdGFibGUgcm93CgogIHZhciBhZGRpdGlvbmFsQWN0aW9ucyA9ICgwLCBfcmVhY3QudXNlTWVtbykoZnVuY3Rpb24gKCkgewogICAgcmV0dXJuICgwLCBfZGVmYXVsdF9jb25maWcuZ2V0U2lnbmFsc0FjdGlvbnMpKHsKICAgICAgYXBvbGxvQ2xpZW50OiBhcG9sbG9DbGllbnQsCiAgICAgIGNhblVzZXJDUlVEOiBjYW5Vc2VyQ1JVRCwKICAgICAgaGFzSW5kZXhXcml0ZTogaGFzSW5kZXhXcml0ZSwKICAgICAgY3JlYXRlVGltZWxpbmU6IGNyZWF0ZVRpbWVsaW5lQ2FsbGJhY2ssCiAgICAgIHNldEV2ZW50c0xvYWRpbmc6IHNldEV2ZW50c0xvYWRpbmdDYWxsYmFjaywKICAgICAgc2V0RXZlbnRzRGVsZXRlZDogc2V0RXZlbnRzRGVsZXRlZENhbGxiYWNrLAogICAgICBzdGF0dXM6IGZpbHRlckdyb3VwID09PSBfc2lnbmFsc19maWx0ZXJfZ3JvdXAuRklMVEVSX09QRU4gPyBfc2lnbmFsc19maWx0ZXJfZ3JvdXAuRklMVEVSX0NMT1NFRCA6IF9zaWduYWxzX2ZpbHRlcl9ncm91cC5GSUxURVJfT1BFTiwKICAgICAgdXBkYXRlVGltZWxpbmVJc0xvYWRpbmc6IHVwZGF0ZVRpbWVsaW5lSXNMb2FkaW5nCiAgICB9KTsKICB9LCBbYXBvbGxvQ2xpZW50LCBjYW5Vc2VyQ1JVRCwgY3JlYXRlVGltZWxpbmVDYWxsYmFjaywgaGFzSW5kZXhXcml0ZSwgZmlsdGVyR3JvdXAsIHNldEV2ZW50c0xvYWRpbmdDYWxsYmFjaywgc2V0RXZlbnRzRGVsZXRlZENhbGxiYWNrLCB1cGRhdGVUaW1lbGluZUlzTG9hZGluZ10pOwogIHZhciBkZWZhdWx0SW5kaWNlcyA9ICgwLCBfcmVhY3QudXNlTWVtbykoZnVuY3Rpb24gKCkgewogICAgcmV0dXJuIFtzaWduYWxzSW5kZXhdOwogIH0sIFtzaWduYWxzSW5kZXhdKTsKICB2YXIgZGVmYXVsdEZpbHRlcnNNZW1vID0gKDAsIF9yZWFjdC51c2VNZW1vKShmdW5jdGlvbiAoKSB7CiAgICBpZiAoKDAsIF9mcC5pc0VtcHR5KShkZWZhdWx0RmlsdGVycykpIHsKICAgICAgcmV0dXJuIGZpbHRlckdyb3VwID09PSBfc2lnbmFsc19maWx0ZXJfZ3JvdXAuRklMVEVSX09QRU4gPyBfZGVmYXVsdF9jb25maWcuc2lnbmFsc09wZW5GaWx0ZXJzIDogX2RlZmF1bHRfY29uZmlnLnNpZ25hbHNDbG9zZWRGaWx0ZXJzOwogICAgfSBlbHNlIGlmIChkZWZhdWx0RmlsdGVycyAhPSBudWxsICYmICEoMCwgX2ZwLmlzRW1wdHkpKGRlZmF1bHRGaWx0ZXJzKSkgewogICAgICByZXR1cm4gW10uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShkZWZhdWx0RmlsdGVycyksIF90b0NvbnN1bWFibGVBcnJheShmaWx0ZXJHcm91cCA9PT0gX3NpZ25hbHNfZmlsdGVyX2dyb3VwLkZJTFRFUl9PUEVOID8gX2RlZmF1bHRfY29uZmlnLnNpZ25hbHNPcGVuRmlsdGVycyA6IF9kZWZhdWx0X2NvbmZpZy5zaWduYWxzQ2xvc2VkRmlsdGVycykpOwogICAgfQogIH0sIFtkZWZhdWx0RmlsdGVycywgZmlsdGVyR3JvdXBdKTsKICB2YXIgdGltZWxpbmVUeXBlQ29udGV4dCA9ICgwLCBfcmVhY3QudXNlTWVtbykoZnVuY3Rpb24gKCkgewogICAgcmV0dXJuIHsKICAgICAgZG9jdW1lbnRUeXBlOiBpMThuLlNJR05BTFNfRE9DVU1FTlRfVFlQRSwKICAgICAgZm9vdGVyVGV4dDogaTE4bi5UT1RBTF9DT1VOVF9PRl9TSUdOQUxTLAogICAgICBsb2FkaW5nVGV4dDogaTE4bi5MT0FESU5HX1NJR05BTFMsCiAgICAgIHF1ZXJ5RmllbGRzOiBfZGVmYXVsdF9jb25maWcucmVxdWlyZWRGaWVsZHNGb3JBY3Rpb25zLAogICAgICB0aW1lbGluZUFjdGlvbnM6IGFkZGl0aW9uYWxBY3Rpb25zLAogICAgICB0aXRsZTogaTE4bi5TSUdOQUxTX1RBQkxFX1RJVExFLAogICAgICBzZWxlY3RBbGw6IGNhblVzZXJDUlVEID8gc2VsZWN0QWxsIDogZmFsc2UKICAgIH07CiAgfSwgW2FkZGl0aW9uYWxBY3Rpb25zLCBjYW5Vc2VyQ1JVRCwgc2VsZWN0QWxsXSk7CiAgdmFyIGhlYWRlckZpbHRlckdyb3VwID0gKDAsIF9yZWFjdC51c2VNZW1vKShmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfc2lnbmFsc19maWx0ZXJfZ3JvdXAuU2lnbmFsc1RhYmxlRmlsdGVyR3JvdXAsIHsKICAgICAgb25GaWx0ZXJHcm91cENoYW5nZWQ6IG9uRmlsdGVyR3JvdXBDaGFuZ2VkQ2FsbGJhY2sKICAgIH0pOwogIH0sIFtvbkZpbHRlckdyb3VwQ2hhbmdlZENhbGxiYWNrXSk7CgogIGlmIChsb2FkaW5nIHx8ICgwLCBfZnAuaXNFbXB0eSkoc2lnbmFsc0luZGV4KSkgewogICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlQYW5lbCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfaGVhZGVyX3NlY3Rpb24uSGVhZGVyU2VjdGlvbiwgewogICAgICB0aXRsZTogaTE4bi5TSUdOQUxTX1RBQkxFX1RJVExFCiAgICB9KSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUxvYWRpbmdDb250ZW50LCBudWxsKSk7CiAgfQoKICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXZlbnRzX3ZpZXdlci5TdGF0ZWZ1bEV2ZW50c1ZpZXdlciwgewogICAgZGVmYXVsdEluZGljZXM6IGRlZmF1bHRJbmRpY2VzLAogICAgcGFnZUZpbHRlcnM6IGRlZmF1bHRGaWx0ZXJzTWVtbywKICAgIGRlZmF1bHRNb2RlbDogX2RlZmF1bHRfY29uZmlnLnNpZ25hbHNEZWZhdWx0TW9kZWwsCiAgICBlbmQ6IHRvLAogICAgaGVhZGVyRmlsdGVyR3JvdXA6IGhlYWRlckZpbHRlckdyb3VwLAogICAgaWQ6IFNJR05BTFNfUEFHRV9USU1FTElORV9JRCwKICAgIHN0YXJ0OiBmcm9tLAogICAgdGltZWxpbmVUeXBlQ29udGV4dDogdGltZWxpbmVUeXBlQ29udGV4dCwKICAgIHV0aWxpdHlCYXI6IHV0aWxpdHlCYXJDYWxsYmFjawogIH0pOwp9OwoKdmFyIG1ha2VNYXBTdGF0ZVRvUHJvcHMgPSBmdW5jdGlvbiBtYWtlTWFwU3RhdGVUb1Byb3BzKCkgewogIHZhciBnZXRUaW1lbGluZSA9IF90aW1lbGluZS50aW1lbGluZVNlbGVjdG9ycy5nZXRUaW1lbGluZUJ5SWRTZWxlY3RvcigpOwoKICB2YXIgZ2V0R2xvYmFsSW5wdXRzID0gX3N0b3JlLmlucHV0c1NlbGVjdG9ycy5nbG9iYWxTZWxlY3RvcigpOwoKICB2YXIgbWFwU3RhdGVUb1Byb3BzID0gZnVuY3Rpb24gbWFwU3RhdGVUb1Byb3BzKHN0YXRlKSB7CiAgICB2YXIgX2dldFRpbWVsaW5lOwoKICAgIHZhciB0aW1lbGluZSA9IChfZ2V0VGltZWxpbmUgPSBnZXRUaW1lbGluZShzdGF0ZSwgU0lHTkFMU19QQUdFX1RJTUVMSU5FX0lEKSkgIT09IG51bGwgJiYgX2dldFRpbWVsaW5lICE9PSB2b2lkIDAgPyBfZ2V0VGltZWxpbmUgOiBfZGVmYXVsdHMudGltZWxpbmVEZWZhdWx0czsKICAgIHZhciBkZWxldGVkRXZlbnRJZHMgPSB0aW1lbGluZS5kZWxldGVkRXZlbnRJZHMsCiAgICAgICAgaXNTZWxlY3RBbGxDaGVja2VkID0gdGltZWxpbmUuaXNTZWxlY3RBbGxDaGVja2VkLAogICAgICAgIGxvYWRpbmdFdmVudElkcyA9IHRpbWVsaW5lLmxvYWRpbmdFdmVudElkcywKICAgICAgICBzZWxlY3RlZEV2ZW50SWRzID0gdGltZWxpbmUuc2VsZWN0ZWRFdmVudElkczsKICAgIHZhciBnbG9iYWxJbnB1dHMgPSBnZXRHbG9iYWxJbnB1dHMoc3RhdGUpOwogICAgdmFyIHF1ZXJ5ID0gZ2xvYmFsSW5wdXRzLnF1ZXJ5LAogICAgICAgIGZpbHRlcnMgPSBnbG9iYWxJbnB1dHMuZmlsdGVyczsKICAgIHJldHVybiB7CiAgICAgIGdsb2JhbFF1ZXJ5OiBxdWVyeSwKICAgICAgZ2xvYmFsRmlsdGVyczogZmlsdGVycywKICAgICAgZGVsZXRlZEV2ZW50SWRzOiBkZWxldGVkRXZlbnRJZHMsCiAgICAgIGlzU2VsZWN0QWxsQ2hlY2tlZDogaXNTZWxlY3RBbGxDaGVja2VkLAogICAgICBsb2FkaW5nRXZlbnRJZHM6IGxvYWRpbmdFdmVudElkcywKICAgICAgc2VsZWN0ZWRFdmVudElkczogc2VsZWN0ZWRFdmVudElkcwogICAgfTsKICB9OwoKICByZXR1cm4gbWFwU3RhdGVUb1Byb3BzOwp9OwoKdmFyIG1hcERpc3BhdGNoVG9Qcm9wcyA9IGZ1bmN0aW9uIG1hcERpc3BhdGNoVG9Qcm9wcyhkaXNwYXRjaCkgewogIHJldHVybiB7CiAgICBjbGVhclNlbGVjdGVkOiBmdW5jdGlvbiBjbGVhclNlbGVjdGVkKF9yZWY2KSB7CiAgICAgIHZhciBpZCA9IF9yZWY2LmlkOwogICAgICByZXR1cm4gZGlzcGF0Y2goX3RpbWVsaW5lLnRpbWVsaW5lQWN0aW9ucy5jbGVhclNlbGVjdGVkKHsKICAgICAgICBpZDogaWQKICAgICAgfSkpOwogICAgfSwKICAgIHNldEV2ZW50c0xvYWRpbmc6IGZ1bmN0aW9uIHNldEV2ZW50c0xvYWRpbmcoX3JlZjcpIHsKICAgICAgdmFyIGlkID0gX3JlZjcuaWQsCiAgICAgICAgICBldmVudElkcyA9IF9yZWY3LmV2ZW50SWRzLAogICAgICAgICAgaXNMb2FkaW5nID0gX3JlZjcuaXNMb2FkaW5nOwogICAgICByZXR1cm4gZGlzcGF0Y2goX3RpbWVsaW5lLnRpbWVsaW5lQWN0aW9ucy5zZXRFdmVudHNMb2FkaW5nKHsKICAgICAgICBpZDogaWQsCiAgICAgICAgZXZlbnRJZHM6IGV2ZW50SWRzLAogICAgICAgIGlzTG9hZGluZzogaXNMb2FkaW5nCiAgICAgIH0pKTsKICAgIH0sCiAgICBjbGVhckV2ZW50c0xvYWRpbmc6IGZ1bmN0aW9uIGNsZWFyRXZlbnRzTG9hZGluZyhfcmVmOCkgewogICAgICB2YXIgaWQgPSBfcmVmOC5pZDsKICAgICAgcmV0dXJuIGRpc3BhdGNoKF90aW1lbGluZS50aW1lbGluZUFjdGlvbnMuY2xlYXJFdmVudHNMb2FkaW5nKHsKICAgICAgICBpZDogaWQKICAgICAgfSkpOwogICAgfSwKICAgIHNldEV2ZW50c0RlbGV0ZWQ6IGZ1bmN0aW9uIHNldEV2ZW50c0RlbGV0ZWQoX3JlZjkpIHsKICAgICAgdmFyIGlkID0gX3JlZjkuaWQsCiAgICAgICAgICBldmVudElkcyA9IF9yZWY5LmV2ZW50SWRzLAogICAgICAgICAgaXNEZWxldGVkID0gX3JlZjkuaXNEZWxldGVkOwogICAgICByZXR1cm4gZGlzcGF0Y2goX3RpbWVsaW5lLnRpbWVsaW5lQWN0aW9ucy5zZXRFdmVudHNEZWxldGVkKHsKICAgICAgICBpZDogaWQsCiAgICAgICAgZXZlbnRJZHM6IGV2ZW50SWRzLAogICAgICAgIGlzRGVsZXRlZDogaXNEZWxldGVkCiAgICAgIH0pKTsKICAgIH0sCiAgICBjbGVhckV2ZW50c0RlbGV0ZWQ6IGZ1bmN0aW9uIGNsZWFyRXZlbnRzRGVsZXRlZChfcmVmMTApIHsKICAgICAgdmFyIGlkID0gX3JlZjEwLmlkOwogICAgICByZXR1cm4gZGlzcGF0Y2goX3RpbWVsaW5lLnRpbWVsaW5lQWN0aW9ucy5jbGVhckV2ZW50c0RlbGV0ZWQoewogICAgICAgIGlkOiBpZAogICAgICB9KSk7CiAgICB9LAogICAgdXBkYXRlVGltZWxpbmVJc0xvYWRpbmc6IGZ1bmN0aW9uIHVwZGF0ZVRpbWVsaW5lSXNMb2FkaW5nKF9yZWYxMSkgewogICAgICB2YXIgaWQgPSBfcmVmMTEuaWQsCiAgICAgICAgICBpc0xvYWRpbmcgPSBfcmVmMTEuaXNMb2FkaW5nOwogICAgICByZXR1cm4gZGlzcGF0Y2goX3RpbWVsaW5lLnRpbWVsaW5lQWN0aW9ucy51cGRhdGVJc0xvYWRpbmcoewogICAgICAgIGlkOiBpZCwKICAgICAgICBpc0xvYWRpbmc6IGlzTG9hZGluZwogICAgICB9KSk7CiAgICB9LAogICAgdXBkYXRlVGltZWxpbmU6ICgwLCBfaGVscGVyczIuZGlzcGF0Y2hVcGRhdGVUaW1lbGluZSkoZGlzcGF0Y2gpCiAgfTsKfTsKCnZhciBTaWduYWxzVGFibGUgPSAoMCwgX3JlYWN0UmVkdXguY29ubmVjdCkobWFrZU1hcFN0YXRlVG9Qcm9wcywgbWFwRGlzcGF0Y2hUb1Byb3BzKShfcmVhY3QuZGVmYXVsdC5tZW1vKFNpZ25hbHNUYWJsZUNvbXBvbmVudCkpOwpleHBvcnRzLlNpZ25hbHNUYWJsZSA9IFNpZ25hbHNUYWJsZTs="},null]}