{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/legacy/core_plugins/kibana/public/discover/np_ready/angular/directives/histogram.js","dependencies":[{"path":"src/legacy/core_plugins/kibana/public/discover/np_ready/angular/directives/histogram.js","mtime":1585205039504},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiKSB7IF90eXBlb2YyID0gZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mMiA9IGZ1bmN0aW9uIF90eXBlb2YyKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mMihvYmopOyB9CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuZmluZE1pbkludGVydmFsID0gZmluZE1pbkludGVydmFsOwpleHBvcnRzLkRpc2NvdmVySGlzdG9ncmFtID0gdm9pZCAwOwoKdmFyIF9ldWkgPSByZXF1aXJlKCJAZWxhc3RpYy9ldWkiKTsKCnZhciBfbW9tZW50VGltZXpvbmUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIm1vbWVudC10aW1lem9uZSIpKTsKCnZhciBfcmVhY3QgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKCJyZWFjdCIpKTsKCnZhciBfcHJvcFR5cGVzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJwcm9wLXR5cGVzIikpOwoKdmFyIF9ldWlfdGhlbWVfbGlnaHQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIkBlbGFzdGljL2V1aS9kaXN0L2V1aV90aGVtZV9saWdodC5qc29uIikpOwoKdmFyIF9ldWlfdGhlbWVfZGFyayA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiQGVsYXN0aWMvZXVpL2Rpc3QvZXVpX3RoZW1lX2RhcmsuanNvbiIpKTsKCnZhciBfY2hhcnRzID0gcmVxdWlyZSgiQGVsYXN0aWMvY2hhcnRzIik7Cgp2YXIgX2kxOG4gPSByZXF1aXJlKCJAa2JuL2kxOG4iKTsKCnZhciBfa2liYW5hX3NlcnZpY2VzID0gcmVxdWlyZSgiLi4vLi4vLi4va2liYW5hX3NlcnZpY2VzIik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsKICBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7CiAgICByZXR1cm4gb2JqOwogIH0gZWxzZSB7CiAgICB2YXIgbmV3T2JqID0ge307CgogICAgaWYgKG9iaiAhPSBudWxsKSB7CiAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHsKICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgewogICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvciA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpIDoge307CgogICAgICAgICAgaWYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSB7CiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmosIGtleSwgZGVzYyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBuZXdPYmpba2V5XSA9IG9ialtrZXldOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIG5ld09iai5kZWZhdWx0ID0gb2JqOwogICAgcmV0dXJuIG5ld09iajsKICB9Cn0KCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7CiAgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsKICAgIGRlZmF1bHQ6IG9iagogIH07Cn0KCmZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7CiAgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgX3R5cGVvZjIoU3ltYm9sLml0ZXJhdG9yKSA9PT0gInN5bWJvbCIpIHsKICAgIF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgewogICAgICByZXR1cm4gX3R5cGVvZjIob2JqKTsKICAgIH07CiAgfSBlbHNlIHsKICAgIF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgewogICAgICByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiBfdHlwZW9mMihvYmopOwogICAgfTsKICB9CgogIHJldHVybiBfdHlwZW9mKG9iaik7Cn0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsKICBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7CiAgfQp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgewogICAgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsKICAgIGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsKICAgIGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsKICAgIGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOwogIH0KfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgewogIGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOwogIGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsKICByZXR1cm4gQ29uc3RydWN0b3I7Cn0KCmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsKICBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpKSB7CiAgICByZXR1cm4gY2FsbDsKICB9CgogIHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOwp9CgpmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgewogIF9nZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7CiAgICByZXR1cm4gby5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKG8pOwogIH07CiAgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsKfQoKZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7CiAgaWYgKHNlbGYgPT09IHZvaWQgMCkgewogICAgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsKICB9CgogIHJldHVybiBzZWxmOwp9CgpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsKICBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICJmdW5jdGlvbiIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24iKTsKICB9CgogIHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgewogICAgY29uc3RydWN0b3I6IHsKICAgICAgdmFsdWU6IHN1YkNsYXNzLAogICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlCiAgICB9CiAgfSk7CiAgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcyk7Cn0KCmZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7CiAgX3NldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IGZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7CiAgICBvLl9fcHJvdG9fXyA9IHA7CiAgICByZXR1cm4gbzsKICB9OwoKICByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApOwp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7CiAgaWYgKGtleSBpbiBvYmopIHsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgICB2YWx1ZTogdmFsdWUsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgd3JpdGFibGU6IHRydWUKICAgIH0pOwogIH0gZWxzZSB7CiAgICBvYmpba2V5XSA9IHZhbHVlOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKZnVuY3Rpb24gZmluZEludGVydmFsRnJvbUR1cmF0aW9uKGRhdGVWYWx1ZSwgZXNWYWx1ZSwgZXNVbml0LCB0aW1lWm9uZSkgewogIHZhciBkYXRlID0gX21vbWVudFRpbWV6b25lLmRlZmF1bHQudHooZGF0ZVZhbHVlLCB0aW1lWm9uZSk7CgogIHZhciBzdGFydE9mRGF0ZSA9IF9tb21lbnRUaW1lem9uZS5kZWZhdWx0LnR6KGRhdGUsIHRpbWVab25lKS5zdGFydE9mKGVzVW5pdCk7CgogIHZhciBlbmRPZkRhdGUgPSBfbW9tZW50VGltZXpvbmUuZGVmYXVsdC50eihkYXRlLCB0aW1lWm9uZSkuc3RhcnRPZihlc1VuaXQpLmFkZChlc1ZhbHVlLCBlc1VuaXQpOwoKICByZXR1cm4gZW5kT2ZEYXRlLnZhbHVlT2YoKSAtIHN0YXJ0T2ZEYXRlLnZhbHVlT2YoKTsKfQoKZnVuY3Rpb24gZ2V0SW50ZXJ2YWxJbk1zKHZhbHVlLCBlc1ZhbHVlLCBlc1VuaXQsIHRpbWVab25lKSB7CiAgc3dpdGNoIChlc1VuaXQpIHsKICAgIGNhc2UgJ3MnOgogICAgICByZXR1cm4gMTAwMCAqIGVzVmFsdWU7CgogICAgY2FzZSAnbXMnOgogICAgICByZXR1cm4gMSAqIGVzVmFsdWU7CgogICAgZGVmYXVsdDoKICAgICAgcmV0dXJuIGZpbmRJbnRlcnZhbEZyb21EdXJhdGlvbih2YWx1ZSwgZXNWYWx1ZSwgZXNVbml0LCB0aW1lWm9uZSk7CiAgfQp9CgpmdW5jdGlvbiBmaW5kTWluSW50ZXJ2YWwoeFZhbHVlcywgZXNWYWx1ZSwgZXNVbml0LCB0aW1lWm9uZSkgewogIHJldHVybiB4VmFsdWVzLnJlZHVjZShmdW5jdGlvbiAobWluSW50ZXJ2YWwsIGN1cnJlbnRYdmFsdWUsIGluZGV4KSB7CiAgICB2YXIgY3VycmVudERpZmYgPSBtaW5JbnRlcnZhbDsKCiAgICBpZiAoaW5kZXggPiAwKSB7CiAgICAgIGN1cnJlbnREaWZmID0gTWF0aC5hYnMoeFZhbHVlc1tpbmRleCAtIDFdIC0gY3VycmVudFh2YWx1ZSk7CiAgICB9CgogICAgdmFyIHNpbmdsZVVuaXRJbnRlcnZhbCA9IGdldEludGVydmFsSW5NcyhjdXJyZW50WHZhbHVlLCBlc1ZhbHVlLCBlc1VuaXQsIHRpbWVab25lKTsKICAgIHJldHVybiBNYXRoLm1pbihtaW5JbnRlcnZhbCwgc2luZ2xlVW5pdEludGVydmFsLCBjdXJyZW50RGlmZik7CiAgfSwgTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIpOwp9Cgp2YXIgRGlzY292ZXJIaXN0b2dyYW0gPQovKiNfX1BVUkVfXyovCmZ1bmN0aW9uIChfQ29tcG9uZW50KSB7CiAgX2luaGVyaXRzKERpc2NvdmVySGlzdG9ncmFtLCBfQ29tcG9uZW50KTsKCiAgZnVuY3Rpb24gRGlzY292ZXJIaXN0b2dyYW0oKSB7CiAgICB2YXIgX2dldFByb3RvdHlwZU9mMjsKCiAgICB2YXIgX3RoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIERpc2NvdmVySGlzdG9ncmFtKTsKCiAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuKSwgX2tleSA9IDA7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHsKICAgICAgYXJnc1tfa2V5XSA9IGFyZ3VtZW50c1tfa2V5XTsKICAgIH0KCiAgICBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChfZ2V0UHJvdG90eXBlT2YyID0gX2dldFByb3RvdHlwZU9mKERpc2NvdmVySGlzdG9ncmFtKSkuY2FsbC5hcHBseShfZ2V0UHJvdG90eXBlT2YyLCBbdGhpc10uY29uY2F0KGFyZ3MpKSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAic3Vic2NyaXB0aW9uIiwgdm9pZCAwKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJzdGF0ZSIsIHsKICAgICAgY2hhcnRzVGhlbWU6ICgwLCBfa2liYW5hX3NlcnZpY2VzLmdldFNlcnZpY2VzKSgpLmV1aV91dGlscy5nZXRDaGFydHNUaGVtZURlZmF1bHQoKQogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAib25CcnVzaEVuZCIsIGZ1bmN0aW9uIChtaW4sIG1heCkgewogICAgICB2YXIgcmFuZ2UgPSB7CiAgICAgICAgZnJvbTogbWluLAogICAgICAgIHRvOiBtYXgKICAgICAgfTsKCiAgICAgIF90aGlzLnByb3BzLnRpbWVmaWx0ZXJVcGRhdGVIYW5kbGVyKHJhbmdlKTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIm9uRWxlbWVudENsaWNrIiwgZnVuY3Rpb24gKHhJbnRlcnZhbCkgewogICAgICByZXR1cm4gZnVuY3Rpb24gKGVsZW1lbnREYXRhKSB7CiAgICAgICAgdmFyIHN0YXJ0UmFuZ2UgPSBlbGVtZW50RGF0YVswXS54OwogICAgICAgIHZhciByYW5nZSA9IHsKICAgICAgICAgIGZyb206IHN0YXJ0UmFuZ2UsCiAgICAgICAgICB0bzogc3RhcnRSYW5nZSArIHhJbnRlcnZhbAogICAgICAgIH07CgogICAgICAgIF90aGlzLnByb3BzLnRpbWVmaWx0ZXJVcGRhdGVIYW5kbGVyKHJhbmdlKTsKICAgICAgfTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImZvcm1hdFhWYWx1ZSIsIGZ1bmN0aW9uICh2YWwpIHsKICAgICAgdmFyIHhBeGlzRm9ybWF0ID0gX3RoaXMucHJvcHMuY2hhcnREYXRhLnhBeGlzRm9ybWF0LnBhcmFtcy5wYXR0ZXJuOwogICAgICByZXR1cm4gKDAsIF9tb21lbnRUaW1lem9uZS5kZWZhdWx0KSh2YWwpLmZvcm1hdCh4QXhpc0Zvcm1hdCk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJyZW5kZXJCYXJUb29sdGlwIiwgZnVuY3Rpb24gKHhJbnRlcnZhbCwgZG9tYWluU3RhcnQsIGRvbWFpbkVuZCkgewogICAgICByZXR1cm4gZnVuY3Rpb24gKGhlYWRlckRhdGEpIHsKICAgICAgICB2YXIgaGVhZGVyRGF0YVZhbHVlID0gaGVhZGVyRGF0YS52YWx1ZTsKCiAgICAgICAgdmFyIGZvcm1hdHRlZFZhbHVlID0gX3RoaXMuZm9ybWF0WFZhbHVlKGhlYWRlckRhdGFWYWx1ZSk7CgogICAgICAgIHZhciBwYXJ0aWFsRGF0YVRleHQgPSBfaTE4bi5pMThuLnRyYW5zbGF0ZSgna2JuLmRpc2NvdmVyLmhpc3RvZ3JhbS5wYXJ0aWFsRGF0YS5idWNrZXRUb29sdGlwVGV4dCcsIHsKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnVGhlIHNlbGVjdGVkIHRpbWUgcmFuZ2UgZG9lcyBub3QgaW5jbHVkZSB0aGlzIGVudGlyZSBidWNrZXQsIGl0IG1heSBjb250YWluIHBhcnRpYWwgZGF0YS4nCiAgICAgICAgfSk7CgogICAgICAgIGlmIChoZWFkZXJEYXRhVmFsdWUgPCBkb21haW5TdGFydCB8fCBoZWFkZXJEYXRhVmFsdWUgKyB4SW50ZXJ2YWwgPiBkb21haW5FbmQpIHsKICAgICAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5kZWZhdWx0LkZyYWdtZW50LCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEdyb3VwLCB7CiAgICAgICAgICAgIGFsaWduSXRlbXM6ICJjZW50ZXIiLAogICAgICAgICAgICBjbGFzc05hbWU6ICJkc2NIaXN0b2dyYW1fX2hlYWRlci0tcGFydGlhbCIsCiAgICAgICAgICAgIHJlc3BvbnNpdmU6IGZhbHNlLAogICAgICAgICAgICBndXR0ZXJTaXplOiAieHMiCiAgICAgICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgICAgICAgICAgZ3JvdzogZmFsc2UKICAgICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlJY29uLCB7CiAgICAgICAgICAgIHR5cGU6ICJpSW5DaXJjbGUiCiAgICAgICAgICB9KSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgbnVsbCwgcGFydGlhbERhdGFUZXh0KSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTcGFjZXIsIHsKICAgICAgICAgICAgc2l6ZTogInhzIgogICAgICAgICAgfSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoInAiLCBudWxsLCBmb3JtYXR0ZWRWYWx1ZSkpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGZvcm1hdHRlZFZhbHVlOwogICAgICB9OwogICAgfSk7CgogICAgcmV0dXJuIF90aGlzOwogIH0KCiAgX2NyZWF0ZUNsYXNzKERpc2NvdmVySGlzdG9ncmFtLCBbewogICAga2V5OiAiY29tcG9uZW50RGlkTW91bnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudERpZE1vdW50KCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHRoaXMuc3Vic2NyaXB0aW9uID0gKDAsIF9raWJhbmFfc2VydmljZXMuZ2V0U2VydmljZXMpKCkuZXVpX3V0aWxzLmdldENoYXJ0c1RoZW1lJCgpLnN1YnNjcmliZShmdW5jdGlvbiAoY2hhcnRzVGhlbWUpIHsKICAgICAgICByZXR1cm4gX3RoaXMyLnNldFN0YXRlKHsKICAgICAgICAgIGNoYXJ0c1RoZW1lOiBjaGFydHNUaGVtZQogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjb21wb25lbnRXaWxsVW5tb3VudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50V2lsbFVubW91bnQoKSB7CiAgICAgIGlmICh0aGlzLnN1YnNjcmlwdGlvbikgewogICAgICAgIHRoaXMuc3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7CiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb24gPSB1bmRlZmluZWQ7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHsKICAgICAgdmFyIHVpU2V0dGluZ3MgPSAoMCwgX2tpYmFuYV9zZXJ2aWNlcy5nZXRTZXJ2aWNlcykoKS51aVNldHRpbmdzOwogICAgICB2YXIgdGltZVpvbmUgPSAoMCwgX2tpYmFuYV9zZXJ2aWNlcy50aW1lem9uZVByb3ZpZGVyKSh1aVNldHRpbmdzKSgpOwogICAgICB2YXIgY2hhcnREYXRhID0gdGhpcy5wcm9wcy5jaGFydERhdGE7CiAgICAgIHZhciBjaGFydHNUaGVtZSA9IHRoaXMuc3RhdGUuY2hhcnRzVGhlbWU7CgogICAgICBpZiAoIWNoYXJ0RGF0YSB8fCAhY2hhcnREYXRhLnNlcmllc1swXSkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICB2YXIgZGF0YSA9IGNoYXJ0RGF0YS5zZXJpZXNbMF0udmFsdWVzOwogICAgICAvKioKICAgICAgICogRGVwcmVjYXRpb246IFtpbnRlcnZhbF0gb24gW2RhdGVfaGlzdG9ncmFtXSBpcyBkZXByZWNhdGVkLCB1c2UgW2ZpeGVkX2ludGVydmFsXSBvciBbY2FsZW5kYXJfaW50ZXJ2YWxdLgogICAgICAgKiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2VsYXN0aWMva2liYW5hL2lzc3Vlcy8yNzQxMAogICAgICAgKiBUT0RPOiBPbmNlIHRoZSBEaXNjb3ZlciBxdWVyeSBoYXMgYmVlbiB1cGRhdGUsIHdlIHNob3VsZCBjaGFuZ2UgdGhlIGJlbG93IHRvIHVzZSB0aGUgbmV3IGZpZWxkCiAgICAgICAqLwoKICAgICAgdmFyIF9jaGFydERhdGEkb3JkZXJlZCA9IGNoYXJ0RGF0YS5vcmRlcmVkLAogICAgICAgICAgaW50ZXJ2YWxFU1ZhbHVlID0gX2NoYXJ0RGF0YSRvcmRlcmVkLmludGVydmFsRVNWYWx1ZSwKICAgICAgICAgIGludGVydmFsRVNVbml0ID0gX2NoYXJ0RGF0YSRvcmRlcmVkLmludGVydmFsRVNVbml0LAogICAgICAgICAgeEludGVydmFsID0gX2NoYXJ0RGF0YSRvcmRlcmVkLmludGVydmFsOwogICAgICB2YXIgeFZhbHVlcyA9IGNoYXJ0RGF0YS54QXhpc09yZGVyZWRWYWx1ZXM7CiAgICAgIHZhciBsYXN0WFZhbHVlID0geFZhbHVlc1t4VmFsdWVzLmxlbmd0aCAtIDFdOwogICAgICB2YXIgZG9tYWluID0gY2hhcnREYXRhLm9yZGVyZWQ7CiAgICAgIHZhciBkb21haW5TdGFydCA9IGRvbWFpbi5taW4udmFsdWVPZigpOwogICAgICB2YXIgZG9tYWluRW5kID0gZG9tYWluLm1heC52YWx1ZU9mKCk7CiAgICAgIHZhciBkb21haW5NaW4gPSBkYXRhWzBdLnggPiBkb21haW5TdGFydCA/IGRvbWFpblN0YXJ0IDogZGF0YVswXS54OwogICAgICB2YXIgZG9tYWluTWF4ID0gZG9tYWluRW5kIC0geEludGVydmFsID4gbGFzdFhWYWx1ZSA/IGRvbWFpbkVuZCAtIHhJbnRlcnZhbCA6IGxhc3RYVmFsdWU7CiAgICAgIHZhciB4RG9tYWluID0gewogICAgICAgIG1pbjogZG9tYWluTWluLAogICAgICAgIG1heDogZG9tYWluTWF4LAogICAgICAgIG1pbkludGVydmFsOiBmaW5kTWluSW50ZXJ2YWwoeFZhbHVlcywgaW50ZXJ2YWxFU1ZhbHVlLCBpbnRlcnZhbEVTVW5pdCwgdGltZVpvbmUpCiAgICAgIH07IC8vIERvbWFpbiBlbmQgb2YgJ25vdycgd2lsbCBiZSBtaWxsaXNlY29uZHMgYmVoaW5kIGN1cnJlbnQgdGltZSwgc28gd2UgZXh0ZW5kIHRpbWUgYnkgMSBtaW51dGUgYW5kIGNoZWNrIGlmCiAgICAgIC8vIHRoZSBhbm5vdGF0aW9uIGlzIHdpdGhpbiB0aGlzIHJhbmdlOyBpZiBzbywgdGhlIGxpbmUgYW5ub3RhdGlvbiB1c2VzIHRoZSBkb21haW5FbmQgYXMgaXRzIHZhbHVlCgogICAgICB2YXIgbm93ID0gKDAsIF9tb21lbnRUaW1lem9uZS5kZWZhdWx0KSgpOwogICAgICB2YXIgaXNBbm5vdGF0aW9uQXRFZGdlID0gKDAsIF9tb21lbnRUaW1lem9uZS5kZWZhdWx0KShkb21haW5FbmQpLmFkZCg2MDAwMCkuaXNBZnRlcihub3cpICYmIG5vdy5pc0FmdGVyKGRvbWFpbkVuZCk7CiAgICAgIHZhciBsaW5lQW5ub3RhdGlvblZhbHVlID0gaXNBbm5vdGF0aW9uQXRFZGdlID8gZG9tYWluRW5kIDogbm93OwogICAgICB2YXIgbGluZUFubm90YXRpb25EYXRhID0gW3sKICAgICAgICBkYXRhVmFsdWU6IGxpbmVBbm5vdGF0aW9uVmFsdWUKICAgICAgfV07CiAgICAgIHZhciBpc0RhcmtNb2RlID0gdWlTZXR0aW5ncy5nZXQoJ3RoZW1lOmRhcmtNb2RlJyk7CiAgICAgIHZhciBsaW5lQW5ub3RhdGlvblN0eWxlID0gewogICAgICAgIGxpbmU6IHsKICAgICAgICAgIHN0cm9rZVdpZHRoOiAyLAogICAgICAgICAgc3Ryb2tlOiBpc0RhcmtNb2RlID8gX2V1aV90aGVtZV9kYXJrLmRlZmF1bHQuZXVpQ29sb3JEYW5nZXIgOiBfZXVpX3RoZW1lX2xpZ2h0LmRlZmF1bHQuZXVpQ29sb3JEYW5nZXIsCiAgICAgICAgICBvcGFjaXR5OiAwLjcKICAgICAgICB9CiAgICAgIH07CiAgICAgIHZhciByZWN0QW5ub3RhdGlvbnMgPSBbXTsKCiAgICAgIGlmIChkb21haW5TdGFydCAhPT0gZG9tYWluTWluKSB7CiAgICAgICAgcmVjdEFubm90YXRpb25zLnB1c2goewogICAgICAgICAgY29vcmRpbmF0ZXM6IHsKICAgICAgICAgICAgeDE6IGRvbWFpblN0YXJ0CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGlmIChkb21haW5FbmQgIT09IGRvbWFpbk1heCkgewogICAgICAgIHJlY3RBbm5vdGF0aW9ucy5wdXNoKHsKICAgICAgICAgIGNvb3JkaW5hdGVzOiB7CiAgICAgICAgICAgIHgwOiBkb21haW5FbmQKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQoKICAgICAgdmFyIHJlY3RBbm5vdGF0aW9uU3R5bGUgPSB7CiAgICAgICAgc3Ryb2tlOiBpc0RhcmtNb2RlID8gX2V1aV90aGVtZV9kYXJrLmRlZmF1bHQuZXVpQ29sb3JMaWdodFNoYWRlIDogX2V1aV90aGVtZV9saWdodC5kZWZhdWx0LmV1aUNvbG9yRGFya1NoYWRlLAogICAgICAgIHN0cm9rZVdpZHRoOiAwLAogICAgICAgIG9wYWNpdHk6IGlzRGFya01vZGUgPyAwLjYgOiAwLjIsCiAgICAgICAgZmlsbDogaXNEYXJrTW9kZSA/IF9ldWlfdGhlbWVfZGFyay5kZWZhdWx0LmV1aUNvbG9yTGlnaHRTaGFkZSA6IF9ldWlfdGhlbWVfbGlnaHQuZGVmYXVsdC5ldWlDb2xvckRhcmtTaGFkZQogICAgICB9OwogICAgICB2YXIgdG9vbHRpcFByb3BzID0gewogICAgICAgIGhlYWRlckZvcm1hdHRlcjogdGhpcy5yZW5kZXJCYXJUb29sdGlwKHhJbnRlcnZhbCwgZG9tYWluU3RhcnQsIGRvbWFpbkVuZCksCiAgICAgICAgdHlwZTogX2NoYXJ0cy5Ub29sdGlwVHlwZS5WZXJ0aWNhbEN1cnNvcgogICAgICB9OwogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfY2hhcnRzLkNoYXJ0LCB7CiAgICAgICAgc2l6ZTogIjEwMCUiCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2NoYXJ0cy5TZXR0aW5ncywgewogICAgICAgIHhEb21haW46IHhEb21haW4sCiAgICAgICAgb25CcnVzaEVuZDogdGhpcy5vbkJydXNoRW5kLAogICAgICAgIG9uRWxlbWVudENsaWNrOiB0aGlzLm9uRWxlbWVudENsaWNrKHhJbnRlcnZhbCksCiAgICAgICAgdG9vbHRpcDogdG9vbHRpcFByb3BzLAogICAgICAgIHRoZW1lOiBjaGFydHNUaGVtZQogICAgICB9KSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfY2hhcnRzLkF4aXMsIHsKICAgICAgICBpZDogImRpc2NvdmVyLWhpc3RvZ3JhbS1sZWZ0LWF4aXMiLAogICAgICAgIHBvc2l0aW9uOiBfY2hhcnRzLlBvc2l0aW9uLkxlZnQsCiAgICAgICAgdGlja3M6IDUsCiAgICAgICAgdGl0bGU6IGNoYXJ0RGF0YS55QXhpc0xhYmVsCiAgICAgIH0pLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9jaGFydHMuQXhpcywgewogICAgICAgIGlkOiAiZGlzY292ZXItaGlzdG9ncmFtLWJvdHRvbS1heGlzIiwKICAgICAgICBwb3NpdGlvbjogX2NoYXJ0cy5Qb3NpdGlvbi5Cb3R0b20sCiAgICAgICAgdGl0bGU6IGNoYXJ0RGF0YS54QXhpc0xhYmVsLAogICAgICAgIHRpY2tGb3JtYXQ6IHRoaXMuZm9ybWF0WFZhbHVlLAogICAgICAgIHRpY2tzOiAxMAogICAgICB9KSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfY2hhcnRzLkxpbmVBbm5vdGF0aW9uLCB7CiAgICAgICAgaWQ6ICJsaW5lLWFubm90YXRpb24iLAogICAgICAgIGRvbWFpblR5cGU6IF9jaGFydHMuQW5ub3RhdGlvbkRvbWFpblR5cGVzLlhEb21haW4sCiAgICAgICAgZGF0YVZhbHVlczogbGluZUFubm90YXRpb25EYXRhLAogICAgICAgIGhpZGVUb29sdGlwczogdHJ1ZSwKICAgICAgICBzdHlsZTogbGluZUFubm90YXRpb25TdHlsZQogICAgICB9KSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfY2hhcnRzLlJlY3RBbm5vdGF0aW9uLCB7CiAgICAgICAgZGF0YVZhbHVlczogcmVjdEFubm90YXRpb25zLAogICAgICAgIGlkOiAicmVjdC1hbm5vdGF0aW9uIiwKICAgICAgICB6SW5kZXg6IDIsCiAgICAgICAgc3R5bGU6IHJlY3RBbm5vdGF0aW9uU3R5bGUsCiAgICAgICAgaGlkZVRvb2x0aXBzOiB0cnVlCiAgICAgIH0pLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9jaGFydHMuSGlzdG9ncmFtQmFyU2VyaWVzLCB7CiAgICAgICAgaWQ6ICJkaXNjb3Zlci1oaXN0b2dyYW0iLAogICAgICAgIHhTY2FsZVR5cGU6IF9jaGFydHMuU2NhbGVUeXBlLlRpbWUsCiAgICAgICAgeVNjYWxlVHlwZTogX2NoYXJ0cy5TY2FsZVR5cGUuTGluZWFyLAogICAgICAgIHhBY2Nlc3NvcjogIngiLAogICAgICAgIHlBY2Nlc3NvcnM6IFsneSddLAogICAgICAgIGRhdGE6IGRhdGEsCiAgICAgICAgdGltZVpvbmU6IHRpbWVab25lLAogICAgICAgIG5hbWU6IGNoYXJ0RGF0YS55QXhpc0xhYmVsCiAgICAgIH0pKTsKICAgIH0KICB9XSk7CgogIHJldHVybiBEaXNjb3Zlckhpc3RvZ3JhbTsKfShfcmVhY3QuQ29tcG9uZW50KTsKCmV4cG9ydHMuRGlzY292ZXJIaXN0b2dyYW0gPSBEaXNjb3Zlckhpc3RvZ3JhbTsKCl9kZWZpbmVQcm9wZXJ0eShEaXNjb3Zlckhpc3RvZ3JhbSwgInByb3BUeXBlcyIsIHsKICBjaGFydERhdGE6IF9wcm9wVHlwZXMuZGVmYXVsdC5vYmplY3QsCiAgdGltZWZpbHRlclVwZGF0ZUhhbmRsZXI6IF9wcm9wVHlwZXMuZGVmYXVsdC5mdW5jCn0pOw=="},null]}