{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/legacy/ui/public/vis/vis_types/vislib_vis_legend/vislib_vis_legend.js","dependencies":[{"path":"src/legacy/ui/public/vis/vis_types/vislib_vis_legend/vislib_vis_legend.js","mtime":1585205041315},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiKSB7IF90eXBlb2YyID0gZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mMiA9IGZ1bmN0aW9uIF90eXBlb2YyKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mMihvYmopOyB9CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuVmlzTGVnZW5kID0gdm9pZCAwOwoKdmFyIF9yZWFjdCA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoInJlYWN0IikpOwoKdmFyIF9jbGFzc25hbWVzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJjbGFzc25hbWVzIikpOwoKdmFyIF9sb2Rhc2ggPSByZXF1aXJlKCJsb2Rhc2giKTsKCnZhciBfaTE4biA9IHJlcXVpcmUoIkBrYm4vaTE4biIpOwoKdmFyIF9ldWkgPSByZXF1aXJlKCJAZWxhc3RpYy9ldWkiKTsKCnZhciBfZGF0YSA9IHJlcXVpcmUoIi4uLy4uLy4uL3Zpc2xpYi9saWIvZGF0YSIpOwoKdmFyIF9wdWJsaWMgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi8uLi9jb3JlX3BsdWdpbnMvdmlzdWFsaXphdGlvbnMvcHVibGljIik7Cgp2YXIgX21vZGVscyA9IHJlcXVpcmUoIi4vbW9kZWxzIik7Cgp2YXIgX3Zpc2xpYl92aXNfbGVnZW5kX2l0ZW0gPSByZXF1aXJlKCIuL3Zpc2xpYl92aXNfbGVnZW5kX2l0ZW0iKTsKCnZhciBfdXRpbGl0aWVzID0gcmVxdWlyZSgiLi4vLi4vLi4vdmlzdWFsaXplL2xvYWRlci9waXBlbGluZV9oZWxwZXJzL3V0aWxpdGllcyIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsKICByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogewogICAgZGVmYXVsdDogb2JqCiAgfTsKfQoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7CiAgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgewogICAgcmV0dXJuIG9iajsKICB9IGVsc2UgewogICAgdmFyIG5ld09iaiA9IHt9OwoKICAgIGlmIChvYmogIT0gbnVsbCkgewogICAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7CiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHsKICAgICAgICAgIHZhciBkZXNjID0gT2JqZWN0LmRlZmluZVByb3BlcnR5ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KSA6IHt9OwoKICAgICAgICAgIGlmIChkZXNjLmdldCB8fCBkZXNjLnNldCkgewogICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobmV3T2JqLCBrZXksIGRlc2MpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBuZXdPYmouZGVmYXVsdCA9IG9iajsKICAgIHJldHVybiBuZXdPYmo7CiAgfQp9CgpmdW5jdGlvbiBfdHlwZW9mKG9iaikgewogIGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIF90eXBlb2YyKFN5bWJvbC5pdGVyYXRvcikgPT09ICJzeW1ib2wiKSB7CiAgICBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsKICAgICAgcmV0dXJuIF90eXBlb2YyKG9iaik7CiAgICB9OwogIH0gZWxzZSB7CiAgICBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsKICAgICAgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogX3R5cGVvZjIob2JqKTsKICAgIH07CiAgfQoKICByZXR1cm4gX3R5cGVvZihvYmopOwp9CgpmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsKICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7CgogIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7CiAgICB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsKICAgIGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsKICAgICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7CiAgICB9KTsKICAgIGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsKICB9CgogIHJldHVybiBrZXlzOwp9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgewogIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsKCiAgICBpZiAoaSAlIDIpIHsKICAgICAgb3duS2V5cyhzb3VyY2UsIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOwogICAgICB9KTsKICAgIH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsKICAgIH0gZWxzZSB7CiAgICAgIG93bktleXMoc291cmNlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsKICAgICAgfSk7CiAgICB9CiAgfQoKICByZXR1cm4gdGFyZ2V0Owp9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7CiAgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOwogIH0KfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgewogIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsKICAgIHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07CiAgICBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7CiAgICBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7CiAgICBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsKICB9Cn0KCmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsKICBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsKICBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7CiAgcmV0dXJuIENvbnN0cnVjdG9yOwp9CgpmdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7CiAgaWYgKGNhbGwgJiYgKF90eXBlb2YoY2FsbCkgPT09ICJvYmplY3QiIHx8IHR5cGVvZiBjYWxsID09PSAiZnVuY3Rpb24iKSkgewogICAgcmV0dXJuIGNhbGw7CiAgfQoKICByZXR1cm4gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKTsKfQoKZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsKICBfZ2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3QuZ2V0UHJvdG90eXBlT2YgOiBmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgewogICAgcmV0dXJuIG8uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihvKTsKICB9OwogIHJldHVybiBfZ2V0UHJvdG90eXBlT2Yobyk7Cn0KCmZ1bmN0aW9uIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZikgewogIGlmIChzZWxmID09PSB2b2lkIDApIHsKICAgIHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcigidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkIik7CiAgfQoKICByZXR1cm4gc2VsZjsKfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7CiAgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAiZnVuY3Rpb24iICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uIik7CiAgfQoKICBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsKICAgIGNvbnN0cnVjdG9yOiB7CiAgICAgIHZhbHVlOiBzdWJDbGFzcywKICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZQogICAgfQogIH0pOwogIGlmIChzdXBlckNsYXNzKSBfc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpOwp9CgpmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgewogIF9zZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgewogICAgby5fX3Byb3RvX18gPSBwOwogICAgcmV0dXJuIG87CiAgfTsKCiAgcmV0dXJuIF9zZXRQcm90b3R5cGVPZihvLCBwKTsKfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgewogIGlmIChrZXkgaW4gb2JqKSB7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsKICAgICAgdmFsdWU6IHZhbHVlLAogICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgIHdyaXRhYmxlOiB0cnVlCiAgICB9KTsKICB9IGVsc2UgewogICAgb2JqW2tleV0gPSB2YWx1ZTsKICB9CgogIHJldHVybiBvYmo7Cn0KCnZhciBWaXNMZWdlbmQgPQovKiNfX1BVUkVfXyovCmZ1bmN0aW9uIChfUHVyZUNvbXBvbmVudCkgewogIF9pbmhlcml0cyhWaXNMZWdlbmQsIF9QdXJlQ29tcG9uZW50KTsKCiAgZnVuY3Rpb24gVmlzTGVnZW5kKHByb3BzKSB7CiAgICB2YXIgX3RoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFZpc0xlZ2VuZCk7CgogICAgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfZ2V0UHJvdG90eXBlT2YoVmlzTGVnZW5kKS5jYWxsKHRoaXMsIHByb3BzKSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAibGVnZW5kSWQiLCAoMCwgX2V1aS5odG1sSWRHZW5lcmF0b3IpKCkoJ2xlZ2VuZCcpKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJnZXRDb2xvciIsIGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuICcnOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAidG9nZ2xlTGVnZW5kIiwgZnVuY3Rpb24gKCkgewogICAgICB2YXIgYndjQWRkTGVnZW5kID0gX3RoaXMucHJvcHMudmlzLnBhcmFtcy5hZGRMZWdlbmQ7CiAgICAgIHZhciBid2NMZWdlbmRTdGF0ZURlZmF1bHQgPSBid2NBZGRMZWdlbmQgPT0gbnVsbCA/IHRydWUgOiBid2NBZGRMZWdlbmQ7CiAgICAgIHZhciBuZXdPcGVuID0gIV90aGlzLnByb3BzLnVpU3RhdGUuZ2V0KCd2aXMubGVnZW5kT3BlbicsIGJ3Y0xlZ2VuZFN0YXRlRGVmYXVsdCk7CgogICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgb3BlbjogbmV3T3BlbgogICAgICB9KTsgLy8gb3BlbiBzaG91bGQgYmUgYXBwbGllZCBvbiB0ZW1wbGF0ZSBiZWZvcmUgd2UgdXBkYXRlIHVpU3RhdGUKCgogICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpcy5wcm9wcy51aVN0YXRlLnNldCgndmlzLmxlZ2VuZE9wZW4nLCBuZXdPcGVuKTsKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJzZXRDb2xvciIsIGZ1bmN0aW9uIChsYWJlbCwgY29sb3IpIHsKICAgICAgcmV0dXJuIGZ1bmN0aW9uIChldmVudCkgewogICAgICAgIGlmIChldmVudC5rZXlDb2RlICYmIGV2ZW50LmtleUNvZGUgIT09IF9ldWkua2V5Q29kZXMuRU5URVIpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHZhciBjb2xvcnMgPSBfdGhpcy5wcm9wcy51aVN0YXRlLmdldCgndmlzLmNvbG9ycycpIHx8IHt9OwogICAgICAgIGlmIChjb2xvcnNbbGFiZWxdID09PSBjb2xvcikgZGVsZXRlIGNvbG9yc1tsYWJlbF07ZWxzZSBjb2xvcnNbbGFiZWxdID0gY29sb3I7CgogICAgICAgIF90aGlzLnByb3BzLnVpU3RhdGUuc2V0U2lsZW50KCd2aXMuY29sb3JzJywgbnVsbCk7CgogICAgICAgIF90aGlzLnByb3BzLnVpU3RhdGUuc2V0KCd2aXMuY29sb3JzJywgY29sb3JzKTsKCiAgICAgICAgX3RoaXMucHJvcHMudWlTdGF0ZS5lbWl0KCdjb2xvckNoYW5nZWQnKTsKCiAgICAgICAgX3RoaXMucmVmcmVzaCgpOwogICAgICB9OwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiZmlsdGVyIiwgZnVuY3Rpb24gKF9yZWYsIG5lZ2F0ZSkgewogICAgICB2YXIgZGF0YSA9IF9yZWYudmFsdWVzOwoKICAgICAgX3RoaXMucHJvcHMudmlzLkFQSS5ldmVudHMuZmlsdGVyKHsKICAgICAgICBkYXRhOiBkYXRhLAogICAgICAgIG5lZ2F0ZTogbmVnYXRlCiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiY2FuRmlsdGVyIiwgZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgaWYgKF9tb2RlbHMuQ1VTVE9NX0xFR0VORF9WSVNfVFlQRVMuaW5jbHVkZXMoX3RoaXMucHJvcHMudmlzbGliVmlzLnZpc0NvbmZpZ0FyZ3MudHlwZSkpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHZhciBmaWx0ZXJzID0gKDAsIF9wdWJsaWMuY3JlYXRlRmlsdGVyc0Zyb21FdmVudCkoewogICAgICAgIGFnZ0NvbmZpZ3M6IF90aGlzLnN0YXRlLnRhYmxlQWdncywKICAgICAgICBkYXRhOiBpdGVtLnZhbHVlcwogICAgICB9KTsKICAgICAgcmV0dXJuIEJvb2xlYW4oZmlsdGVycy5sZW5ndGgpOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAidG9nZ2xlRGV0YWlscyIsIGZ1bmN0aW9uIChsYWJlbCkgewogICAgICByZXR1cm4gZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgaWYgKGV2ZW50ICYmIGV2ZW50LmtleUNvZGUgJiYgZXZlbnQua2V5Q29kZSAhPT0gX2V1aS5rZXlDb2Rlcy5FTlRFUikgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgc2VsZWN0ZWRMYWJlbDogX3RoaXMuc3RhdGUuc2VsZWN0ZWRMYWJlbCA9PT0gbGFiZWwgPyBudWxsIDogbGFiZWwKICAgICAgICB9KTsKICAgICAgfTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImdldFNlcmllc0xhYmVscyIsIGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgIHZhciB2YWx1ZXMgPSBkYXRhLm1hcChmdW5jdGlvbiAoY2hhcnQpIHsKICAgICAgICByZXR1cm4gY2hhcnQuc2VyaWVzOwogICAgICB9KS5yZWR1Y2UoZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgICByZXR1cm4gYS5jb25jYXQoYik7CiAgICAgIH0sIFtdKTsKICAgICAgcmV0dXJuICgwLCBfbG9kYXNoLmNvbXBhY3QpKCgwLCBfbG9kYXNoLnVuaXEpKHZhbHVlcywgJ2xhYmVsJykpLm1hcChmdW5jdGlvbiAobGFiZWwpIHsKICAgICAgICByZXR1cm4gX29iamVjdFNwcmVhZCh7fSwgbGFiZWwsIHsKICAgICAgICAgIHZhbHVlczogW2xhYmVsLnZhbHVlc1swXS5zZXJpZXNSYXddCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiZ2V0TGFiZWxzIiwgZnVuY3Rpb24gKGRhdGEsIHR5cGUpIHsKICAgICAgaWYgKCFkYXRhKSByZXR1cm4gW107CiAgICAgIGRhdGEgPSBkYXRhLmNvbHVtbnMgfHwgZGF0YS5yb3dzIHx8IFtkYXRhXTsKICAgICAgaWYgKHR5cGUgPT09ICdwaWUnKSByZXR1cm4gX2RhdGEuRGF0YS5wcm90b3R5cGUucGllTmFtZXMoZGF0YSk7CiAgICAgIHJldHVybiBfdGhpcy5nZXRTZXJpZXNMYWJlbHMoZGF0YSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJyZWZyZXNoIiwgZnVuY3Rpb24gKCkgewogICAgICB2YXIgdmlzbGliVmlzID0gX3RoaXMucHJvcHMudmlzbGliVmlzOwoKICAgICAgaWYgKCF2aXNsaWJWaXMgfHwgIXZpc2xpYlZpcy52aXNDb25maWcpIHsKICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICBsYWJlbHM6IFt7CiAgICAgICAgICAgIGxhYmVsOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgnY29tbW9uLnVpLnZpcy52aXNUeXBlcy5sZWdlbmQubG9hZGluZ0xhYmVsJywgewogICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnbG9hZGluZ+KApicKICAgICAgICAgICAgfSkKICAgICAgICAgIH1dCiAgICAgICAgfSk7CgogICAgICAgIHJldHVybjsKICAgICAgfSAvLyBtYWtlIHN1cmUgdmlzbGliIGlzIGRlZmluZWQgYXQgdGhpcyBwb2ludAoKCiAgICAgIGlmIChfdGhpcy5wcm9wcy51aVN0YXRlLmdldCgndmlzLmxlZ2VuZE9wZW4nKSA9PSBudWxsICYmIF90aGlzLnByb3BzLnZpcy5wYXJhbXMuYWRkTGVnZW5kICE9IG51bGwpIHsKICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICBvcGVuOiBfdGhpcy5wcm9wcy52aXMucGFyYW1zLmFkZExlZ2VuZAogICAgICAgIH0pOwogICAgICB9CgogICAgICBpZiAoX21vZGVscy5DVVNUT01fTEVHRU5EX1ZJU19UWVBFUy5pbmNsdWRlcyh2aXNsaWJWaXMudmlzQ29uZmlnQXJncy50eXBlKSkgewogICAgICAgIHZhciBsZWdlbmRMYWJlbHMgPSBfdGhpcy5wcm9wcy52aXNsaWJWaXMuZ2V0TGVnZW5kTGFiZWxzKCk7CgogICAgICAgIGlmIChsZWdlbmRMYWJlbHMpIHsKICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgbGFiZWxzOiAoMCwgX2xvZGFzaC5tYXApKGxlZ2VuZExhYmVscywgZnVuY3Rpb24gKGxhYmVsKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgIGxhYmVsOiBsYWJlbAogICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0pCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgbGFiZWxzOiBfdGhpcy5nZXRMYWJlbHMoX3RoaXMucHJvcHMudmlzRGF0YSwgdmlzbGliVmlzLnZpc0NvbmZpZ0FyZ3MudHlwZSkKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgaWYgKHZpc2xpYlZpcy52aXNDb25maWcpIHsKICAgICAgICBfdGhpcy5nZXRDb2xvciA9IF90aGlzLnByb3BzLnZpc2xpYlZpcy52aXNDb25maWcuZGF0YS5nZXRDb2xvckZ1bmMoKTsKICAgICAgfQoKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIHRhYmxlQWdnczogKDAsIF91dGlsaXRpZXMuZ2V0VGFibGVBZ2dzKShfdGhpcy5wcm9wcy52aXMpCiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiaGlnaGxpZ2h0IiwgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgIHZhciBlbCA9IGV2ZW50LmN1cnJlbnRUYXJnZXQ7CiAgICAgIHZhciBoYW5kbGVyID0gX3RoaXMucHJvcHMudmlzbGliVmlzICYmIF90aGlzLnByb3BzLnZpc2xpYlZpcy5oYW5kbGVyOyAvLyB0aGVyZSBpcyBubyBndWFyYW50ZWUgdGhhdCBhIENoYXJ0IHdpbGwgc2V0IHRoZSBoaWdobGlnaHQtZnVuY3Rpb24gb24gaXRzIGhhbmRsZXIKCiAgICAgIGlmICghaGFuZGxlciB8fCB0eXBlb2YgaGFuZGxlci5oaWdobGlnaHQgIT09ICdmdW5jdGlvbicpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGhhbmRsZXIuaGlnaGxpZ2h0LmNhbGwoZWwsIGhhbmRsZXIuZWwpOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAidW5oaWdobGlnaHQiLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgdmFyIGVsID0gZXZlbnQuY3VycmVudFRhcmdldDsKICAgICAgdmFyIGhhbmRsZXIgPSBfdGhpcy5wcm9wcy52aXNsaWJWaXMgJiYgX3RoaXMucHJvcHMudmlzbGliVmlzLmhhbmRsZXI7IC8vIHRoZXJlIGlzIG5vIGd1YXJhbnRlZSB0aGF0IGEgQ2hhcnQgd2lsbCBzZXQgdGhlIHVuaGlnaGxpZ2h0LWZ1bmN0aW9uIG9uIGl0cyBoYW5kbGVyCgogICAgICBpZiAoIWhhbmRsZXIgfHwgdHlwZW9mIGhhbmRsZXIudW5IaWdobGlnaHQgIT09ICdmdW5jdGlvbicpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGhhbmRsZXIudW5IaWdobGlnaHQuY2FsbChlbCwgaGFuZGxlci5lbCk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJnZXRBbmNob3JQb3NpdGlvbiIsIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHBvc2l0aW9uID0gX3RoaXMucHJvcHMucG9zaXRpb247CgogICAgICBzd2l0Y2ggKHBvc2l0aW9uKSB7CiAgICAgICAgY2FzZSAnYm90dG9tJzoKICAgICAgICAgIHJldHVybiAndXBDZW50ZXInOwoKICAgICAgICBjYXNlICdsZWZ0JzoKICAgICAgICAgIHJldHVybiAncmlnaHRVcCc7CgogICAgICAgIGNhc2UgJ3JpZ2h0JzoKICAgICAgICAgIHJldHVybiAnbGVmdFVwJzsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIHJldHVybiAnZG93bkNlbnRlcic7CiAgICAgIH0KICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInJlbmRlckxlZ2VuZCIsIGZ1bmN0aW9uIChhbmNob3JQb3NpdGlvbikgewogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgidWwiLCB7CiAgICAgICAgY2xhc3NOYW1lOiAidmlzTGVnZW5kX19saXN0IiwKICAgICAgICBpZDogX3RoaXMubGVnZW5kSWQKICAgICAgfSwgX3RoaXMuc3RhdGUubGFiZWxzLm1hcChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF92aXNsaWJfdmlzX2xlZ2VuZF9pdGVtLlZpc0xlZ2VuZEl0ZW0sIHsKICAgICAgICAgIGl0ZW06IGl0ZW0sCiAgICAgICAgICBrZXk6IGl0ZW0ubGFiZWwsCiAgICAgICAgICBhbmNob3JQb3NpdGlvbjogYW5jaG9yUG9zaXRpb24sCiAgICAgICAgICBzZWxlY3RlZDogX3RoaXMuc3RhdGUuc2VsZWN0ZWRMYWJlbCA9PT0gaXRlbS5sYWJlbCwKICAgICAgICAgIGNhbkZpbHRlcjogX3RoaXMuY2FuRmlsdGVyKGl0ZW0pLAogICAgICAgICAgb25GaWx0ZXI6IF90aGlzLmZpbHRlciwKICAgICAgICAgIG9uU2VsZWN0OiBfdGhpcy50b2dnbGVEZXRhaWxzLAogICAgICAgICAgbGVnZW5kSWQ6IF90aGlzLmxlZ2VuZElkLAogICAgICAgICAgc2V0Q29sb3I6IF90aGlzLnNldENvbG9yLAogICAgICAgICAgZ2V0Q29sb3I6IF90aGlzLmdldENvbG9yLAogICAgICAgICAgb25IaWdobGlnaHQ6IF90aGlzLmhpZ2hsaWdodCwKICAgICAgICAgIG9uVW5oaWdobGlnaHQ6IF90aGlzLnVuaGlnaGxpZ2h0CiAgICAgICAgfSk7CiAgICAgIH0pKTsKICAgIH0pOwoKICAgIHZhciBvcGVuID0gcHJvcHMudWlTdGF0ZS5nZXQoJ3Zpcy5sZWdlbmRPcGVuJywgdHJ1ZSk7CiAgICBfdGhpcy5zdGF0ZSA9IHsKICAgICAgb3Blbjogb3BlbiwKICAgICAgbGFiZWxzOiBbXSwKICAgICAgdGFibGVBZ2dzOiBbXSwKICAgICAgc2VsZWN0ZWRMYWJlbDogbnVsbAogICAgfTsKICAgIHJldHVybiBfdGhpczsKICB9CgogIF9jcmVhdGVDbGFzcyhWaXNMZWdlbmQsIFt7CiAgICBrZXk6ICJjb21wb25lbnREaWRNb3VudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50RGlkTW91bnQoKSB7CiAgICAgIHRoaXMucmVmcmVzaCgpOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkgewogICAgICB2YXIgb3BlbiA9IHRoaXMuc3RhdGUub3BlbjsKICAgICAgdmFyIGFuY2hvclBvc2l0aW9uID0gdGhpcy5nZXRBbmNob3JQb3NpdGlvbigpOwogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgIGNsYXNzTmFtZTogInZpc0xlZ2VuZCIKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgiYnV0dG9uIiwgewogICAgICAgIHR5cGU6ICJidXR0b24iLAogICAgICAgIG9uQ2xpY2s6IHRoaXMudG9nZ2xlTGVnZW5kLAogICAgICAgIGNsYXNzTmFtZTogKDAsIF9jbGFzc25hbWVzLmRlZmF1bHQpKCd2aXNMZWdlbmRfX3RvZ2dsZSBrYm4tcmVzZXRGb2N1c1N0YXRlJywgewogICAgICAgICAgJ3Zpc0xlZ2VuZF9fdG9nZ2xlLS1pc09wZW4nOiBvcGVuCiAgICAgICAgfSksCiAgICAgICAgImFyaWEtbGFiZWwiOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgnY29tbW9uLnVpLnZpcy52aXNUeXBlcy5sZWdlbmQudG9nZ2xlTGVnZW5kQnV0dG9uQXJpYUxhYmVsJywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdUb2dnbGUgbGVnZW5kJwogICAgICAgIH0pLAogICAgICAgICJhcmlhLWV4cGFuZGVkIjogQm9vbGVhbihvcGVuKSwKICAgICAgICAiYXJpYS1jb250cm9scyI6IHRoaXMubGVnZW5kSWQsCiAgICAgICAgImRhdGEtdGVzdC1zdWJqIjogInZpc2xpYlRvZ2dsZUxlZ2VuZCIsCiAgICAgICAgdGl0bGU6IF9pMThuLmkxOG4udHJhbnNsYXRlKCdjb21tb24udWkudmlzLnZpc1R5cGVzLmxlZ2VuZC50b2dnbGVMZWdlbmRCdXR0b25UaXRsZScsIHsKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnVG9nZ2xlIGxlZ2VuZCcKICAgICAgICB9KQogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpSWNvbiwgewogICAgICAgIGNvbG9yOiAidGV4dCIsCiAgICAgICAgdHlwZTogImxpc3QiCiAgICAgIH0pKSwgb3BlbiAmJiB0aGlzLnJlbmRlckxlZ2VuZChhbmNob3JQb3NpdGlvbikpOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIFZpc0xlZ2VuZDsKfShfcmVhY3QuUHVyZUNvbXBvbmVudCk7CgpleHBvcnRzLlZpc0xlZ2VuZCA9IFZpc0xlZ2VuZDs="},null]}