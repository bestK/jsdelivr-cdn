{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/maps/public/components/map_listing.js","dependencies":[{"path":"x-pack/legacy/plugins/maps/public/components/map_listing.js","mtime":1585205045229},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLk1hcExpc3RpbmcgPSBleHBvcnRzLkVNUFRZX0ZJTFRFUiA9IHZvaWQgMDsKCnZhciBfcmVhY3QgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoInJlYWN0IikpOwoKdmFyIF9wcm9wVHlwZXMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoInByb3AtdHlwZXMiKSk7Cgp2YXIgX2xvZGFzaCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgibG9kYXNoIikpOwoKdmFyIF9ub3RpZnkgPSByZXF1aXJlKCJ1aS9ub3RpZnkiKTsKCnZhciBfZXVpID0gcmVxdWlyZSgiQGVsYXN0aWMvZXVpIik7Cgp2YXIgX2kxOG4gPSByZXF1aXJlKCJAa2JuL2kxOG4iKTsKCnZhciBfcmVhY3QyID0gcmVxdWlyZSgiQGtibi9pMThuL3JlYWN0Iik7Cgp2YXIgX2hlbHBfbWVudV91dGlsID0gcmVxdWlyZSgiLi4vaGVscF9tZW51X3V0aWwiKTsKCnZhciBfY2hyb21lID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJ1aS9jaHJvbWUiKSk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gInN5bWJvbCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9CgpmdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfQoKZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpKSB7IHJldHVybiBjYWxsOyB9IHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOyB9CgpmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyBfZ2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3QuZ2V0UHJvdG90eXBlT2YgOiBmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyByZXR1cm4gby5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKG8pOyB9OyByZXR1cm4gX2dldFByb3RvdHlwZU9mKG8pOyB9CgpmdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsgaWYgKHNlbGYgPT09IHZvaWQgMCkgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOyB9IHJldHVybiBzZWxmOyB9CgpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAiZnVuY3Rpb24iICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24iKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBfc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpOyB9CgpmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgby5fX3Byb3RvX18gPSBwOyByZXR1cm4gbzsgfTsgcmV0dXJuIF9zZXRQcm90b3R5cGVPZihvLCBwKTsgfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgeyBpZiAoa2V5IGluIG9iaikgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsgdmFsdWU6IHZhbHVlLCBlbnVtZXJhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlIH0pOyB9IGVsc2UgeyBvYmpba2V5XSA9IHZhbHVlOyB9IHJldHVybiBvYmo7IH0KCnZhciBFTVBUWV9GSUxURVIgPSAnJzsKZXhwb3J0cy5FTVBUWV9GSUxURVIgPSBFTVBUWV9GSUxURVI7Cgp2YXIgTWFwTGlzdGluZyA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKF9SZWFjdCRDb21wb25lbnQpIHsKICBfaW5oZXJpdHMoTWFwTGlzdGluZywgX1JlYWN0JENvbXBvbmVudCk7CgogIGZ1bmN0aW9uIE1hcExpc3RpbmcoKSB7CiAgICB2YXIgX2dldFByb3RvdHlwZU9mMjsKCiAgICB2YXIgX3RoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE1hcExpc3RpbmcpOwoKICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykgewogICAgICBhcmdzW19rZXldID0gYXJndW1lbnRzW19rZXldOwogICAgfQoKICAgIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKF9nZXRQcm90b3R5cGVPZjIgPSBfZ2V0UHJvdG90eXBlT2YoTWFwTGlzdGluZykpLmNhbGwuYXBwbHkoX2dldFByb3RvdHlwZU9mMiwgW3RoaXNdLmNvbmNhdChhcmdzKSkpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInN0YXRlIiwgewogICAgICBoYXNJbml0aWFsRmV0Y2hSZXR1cm5lZDogZmFsc2UsCiAgICAgIGlzRmV0Y2hpbmdJdGVtczogZmFsc2UsCiAgICAgIHNob3dEZWxldGVNb2RhbDogZmFsc2UsCiAgICAgIHNob3dMaW1pdEVycm9yOiBmYWxzZSwKICAgICAgZmlsdGVyOiBFTVBUWV9GSUxURVIsCiAgICAgIGl0ZW1zOiBbXSwKICAgICAgc2VsZWN0ZWRJZHM6IFtdLAogICAgICBwYWdlOiAwLAogICAgICBwZXJQYWdlOiAyMAogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiZGVib3VuY2VkRmV0Y2giLCBfbG9kYXNoLmRlZmF1bHQuZGVib3VuY2UoZnVuY3Rpb24gX2NhbGxlZShmaWx0ZXIpIHsKICAgICAgdmFyIHJlc3BvbnNlOwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmFzeW5jKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyOwogICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAoX3RoaXMucHJvcHMuZmluZChmaWx0ZXIpKTsKCiAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICByZXNwb25zZSA9IF9jb250ZXh0LnNlbnQ7CgogICAgICAgICAgICAgIGlmIChfdGhpcy5faXNNb3VudGVkKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgLy8gV2UgbmVlZCB0aGlzIGNoZWNrIHRvIGhhbmRsZSB0aGUgY2FzZSB3aGVyZSBzZWFyY2ggcmVzdWx0cyBjb21lIGJhY2sgaW4gYSBkaWZmZXJlbnQKICAgICAgICAgICAgICAvLyBvcmRlciB0aGFuIHRoZXkgd2VyZSBzZW50IG91dC4gT25seSBsb2FkIHJlc3VsdHMgZm9yIHRoZSBtb3N0IHJlY2VudCBzZWFyY2guCiAgICAgICAgICAgICAgaWYgKGZpbHRlciA9PT0gX3RoaXMuc3RhdGUuZmlsdGVyKSB7CiAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICAgIGhhc0luaXRpYWxGZXRjaFJldHVybmVkOiB0cnVlLAogICAgICAgICAgICAgICAgICBpc0ZldGNoaW5nSXRlbXM6IGZhbHNlLAogICAgICAgICAgICAgICAgICBpdGVtczogcmVzcG9uc2UuaGl0cywKICAgICAgICAgICAgICAgICAgdG90YWxJdGVtczogcmVzcG9uc2UudG90YWwsCiAgICAgICAgICAgICAgICAgIHNob3dMaW1pdEVycm9yOiByZXNwb25zZS50b3RhbCA+IF90aGlzLnByb3BzLmxpc3RpbmdMaW1pdAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sIDMwMCkpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImZldGNoSXRlbXMiLCBmdW5jdGlvbiAoKSB7CiAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICBpc0ZldGNoaW5nSXRlbXM6IHRydWUKICAgICAgfSwgX3RoaXMuZGVib3VuY2VkRmV0Y2guYmluZChudWxsLCBfdGhpcy5zdGF0ZS5maWx0ZXIpKTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImRlbGV0ZVNlbGVjdGVkSXRlbXMiLCBmdW5jdGlvbiBfY2FsbGVlMigpIHsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hc3luYyhmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgX2NvbnRleHQyLnByZXYgPSAwOwogICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMzsKICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKF90aGlzLnByb3BzLmRlbGV0ZShfdGhpcy5zdGF0ZS5zZWxlY3RlZElkcykpOwoKICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gODsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICBfY29udGV4dDIucHJldiA9IDU7CiAgICAgICAgICAgICAgX2NvbnRleHQyLnQwID0gX2NvbnRleHQyWyJjYXRjaCJdKDApOwoKICAgICAgICAgICAgICBfbm90aWZ5LnRvYXN0Tm90aWZpY2F0aW9ucy5hZGREYW5nZXIoewogICAgICAgICAgICAgICAgdGl0bGU6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tYXBzLm1hcExpc3RpbmcudW5hYmxlVG9EZWxldGVUb2FzdFRpdGxlJywgewogICAgICAgICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIlVuYWJsZSB0byBkZWxldGUgbWFwKHMpIgogICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgICB0ZXh0OiAiIi5jb25jYXQoX2NvbnRleHQyLnQwKQogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgIF90aGlzLmZldGNoSXRlbXMoKTsKCiAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgc2VsZWN0ZWRJZHM6IFtdCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIF90aGlzLmNsb3NlRGVsZXRlTW9kYWwoKTsKCiAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBudWxsLCBudWxsLCBbWzAsIDVdXSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJjbG9zZURlbGV0ZU1vZGFsIiwgZnVuY3Rpb24gKCkgewogICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgc2hvd0RlbGV0ZU1vZGFsOiBmYWxzZQogICAgICB9KTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIm9wZW5EZWxldGVNb2RhbCIsIGZ1bmN0aW9uICgpIHsKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIHNob3dEZWxldGVNb2RhbDogdHJ1ZQogICAgICB9KTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIm9uVGFibGVDaGFuZ2UiLCBmdW5jdGlvbiAoX3JlZikgewogICAgICB2YXIgcGFnZSA9IF9yZWYucGFnZSwKICAgICAgICAgIF9yZWYkc29ydCA9IF9yZWYuc29ydCwKICAgICAgICAgIHNvcnQgPSBfcmVmJHNvcnQgPT09IHZvaWQgMCA/IHt9IDogX3JlZiRzb3J0OwogICAgICB2YXIgcGFnZUluZGV4ID0gcGFnZS5pbmRleCwKICAgICAgICAgIHBhZ2VTaXplID0gcGFnZS5zaXplOwogICAgICB2YXIgc29ydEZpZWxkID0gc29ydC5maWVsZCwKICAgICAgICAgIHNvcnREaXJlY3Rpb24gPSBzb3J0LmRpcmVjdGlvbjsgLy8gM3JkIHNvcnRpbmcgc3RhdGUgdGhhdCBpcyBub3QgY2FwdHVyZWQgYnkgc29ydCAtIG5hdGl2ZSBvcmRlciAobm8gc29ydCkKICAgICAgLy8gd2hlbiBzd2l0Y2hpbmcgZnJvbSBkZXNjIHRvIGFzYyBmb3IgdGhlIHNhbWUgZmllbGQgLSB1c2UgbmF0aXZlIG9yZGVyCgogICAgICBpZiAoX3RoaXMuc3RhdGUuc29ydEZpZWxkID09PSBzb3J0RmllbGQgJiYgX3RoaXMuc3RhdGUuc29ydERpcmVjdGlvbiA9PT0gJ2Rlc2MnICYmIHNvcnREaXJlY3Rpb24gPT09ICdhc2MnKSB7CiAgICAgICAgc29ydEZpZWxkID0gbnVsbDsKICAgICAgICBzb3J0RGlyZWN0aW9uID0gbnVsbDsKICAgICAgfQoKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIHBhZ2U6IHBhZ2VJbmRleCwKICAgICAgICBwZXJQYWdlOiBwYWdlU2l6ZSwKICAgICAgICBzb3J0RmllbGQ6IHNvcnRGaWVsZCwKICAgICAgICBzb3J0RGlyZWN0aW9uOiBzb3J0RGlyZWN0aW9uCiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiZ2V0UGFnZU9mSXRlbXMiLCBmdW5jdGlvbiAoKSB7CiAgICAgIC8vIGRvIG5vdCBzb3J0IG9yaWdpbmFsIGxpc3QgdG8gcHJlc2VydmUgZWxhc3RpY3NlYXJjaCByYW5raW5nIG9yZGVyCiAgICAgIHZhciBpdGVtc0NvcHkgPSBfdGhpcy5zdGF0ZS5pdGVtcy5zbGljZSgpOwoKICAgICAgaWYgKF90aGlzLnN0YXRlLnNvcnRGaWVsZCkgewogICAgICAgIGl0ZW1zQ29weS5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgICAgICB2YXIgZmllbGRBID0gX2xvZGFzaC5kZWZhdWx0LmdldChhLCBfdGhpcy5zdGF0ZS5zb3J0RmllbGQsICcnKTsKCiAgICAgICAgICB2YXIgZmllbGRCID0gX2xvZGFzaC5kZWZhdWx0LmdldChiLCBfdGhpcy5zdGF0ZS5zb3J0RmllbGQsICcnKTsKCiAgICAgICAgICB2YXIgb3JkZXIgPSAxOwoKICAgICAgICAgIGlmIChfdGhpcy5zdGF0ZS5zb3J0RGlyZWN0aW9uID09PSAnZGVzYycpIHsKICAgICAgICAgICAgb3JkZXIgPSAtMTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gb3JkZXIgKiBmaWVsZEEudG9Mb3dlckNhc2UoKS5sb2NhbGVDb21wYXJlKGZpZWxkQi50b0xvd2VyQ2FzZSgpKTsKICAgICAgICB9KTsKICAgICAgfSAvLyBJZiBiZWdpbiBpcyBncmVhdGVyIHRoYW4gdGhlIGxlbmd0aCBvZiB0aGUgc2VxdWVuY2UsIGFuIGVtcHR5IGFycmF5IGlzIHJldHVybmVkLgoKCiAgICAgIHZhciBzdGFydEluZGV4ID0gX3RoaXMuc3RhdGUucGFnZSAqIF90aGlzLnN0YXRlLnBlclBhZ2U7IC8vIElmIGVuZCBpcyBncmVhdGVyIHRoYW4gdGhlIGxlbmd0aCBvZiB0aGUgc2VxdWVuY2UsIHNsaWNlIGV4dHJhY3RzIHRocm91Z2ggdG8gdGhlIGVuZCBvZiB0aGUgc2VxdWVuY2UgKGFyci5sZW5ndGgpLgoKICAgICAgdmFyIGxhc3RJbmRleCA9IHN0YXJ0SW5kZXggKyBfdGhpcy5zdGF0ZS5wZXJQYWdlOwogICAgICByZXR1cm4gaXRlbXNDb3B5LnNsaWNlKHN0YXJ0SW5kZXgsIGxhc3RJbmRleCk7CiAgICB9KTsKCiAgICByZXR1cm4gX3RoaXM7CiAgfQoKICBfY3JlYXRlQ2xhc3MoTWFwTGlzdGluZywgW3sKICAgIGtleTogIlVOU0FGRV9jb21wb25lbnRXaWxsTW91bnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIFVOU0FGRV9jb21wb25lbnRXaWxsTW91bnQoKSB7CiAgICAgIHRoaXMuX2lzTW91bnRlZCA9IHRydWU7CiAgICB9CiAgfSwgewogICAga2V5OiAiY29tcG9uZW50V2lsbFVubW91bnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxVbm1vdW50KCkgewogICAgICB0aGlzLl9pc01vdW50ZWQgPSBmYWxzZTsKICAgICAgdGhpcy5kZWJvdW5jZWRGZXRjaC5jYW5jZWwoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjb21wb25lbnREaWRNb3VudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50RGlkTW91bnQoKSB7CiAgICAgIHRoaXMuZmV0Y2hJdGVtcygpOwogICAgICAoMCwgX2hlbHBfbWVudV91dGlsLmFkZEhlbHBNZW51VG9BcHBDaHJvbWUpKF9jaHJvbWUuZGVmYXVsdCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiaGFzTm9JdGVtcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaGFzTm9JdGVtcygpIHsKICAgICAgaWYgKCF0aGlzLnN0YXRlLmlzRmV0Y2hpbmdJdGVtcyAmJiB0aGlzLnN0YXRlLml0ZW1zLmxlbmd0aCA9PT0gMCAmJiAhdGhpcy5zdGF0ZS5maWx0ZXIpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlckNvbmZpcm1EZWxldGVNb2RhbCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyQ29uZmlybURlbGV0ZU1vZGFsKCkgewogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aU92ZXJsYXlNYXNrLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQ29uZmlybU1vZGFsLCB7CiAgICAgICAgdGl0bGU6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tYXBzLm1hcExpc3RpbmcuZGVsZXRlU2VsZWN0ZWRJdGVtc1RpdGxlJywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdEZWxldGUgc2VsZWN0ZWQgaXRlbXM/JwogICAgICAgIH0pLAogICAgICAgIG9uQ2FuY2VsOiB0aGlzLmNsb3NlRGVsZXRlTW9kYWwsCiAgICAgICAgb25Db25maXJtOiB0aGlzLmRlbGV0ZVNlbGVjdGVkSXRlbXMsCiAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1hcHMubWFwTGlzdGluZy5jYW5jZWxUaXRsZScsIHsKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnQ2FuY2VsJwogICAgICAgIH0pLAogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWFwcy5tYXBMaXN0aW5nLmRlbGV0ZVRpdGxlJywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdEZWxldGUnCiAgICAgICAgfSksCiAgICAgICAgZGVmYXVsdEZvY3VzZWRCdXR0b246ICJjYW5jZWwiCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoInAiLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAieHBhY2subWFwcy5tYXBMaXN0aW5nLmRlbGV0ZVdhcm5pbmciLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiWW91IGNhbid0IHJlY292ZXIgZGVsZXRlZCBpdGVtcy4iCiAgICAgIH0pKSkpOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlckxpc3RpbmdMaW1pdFdhcm5pbmciLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlckxpc3RpbmdMaW1pdFdhcm5pbmcoKSB7CiAgICAgIGlmICh0aGlzLnN0YXRlLnNob3dMaW1pdEVycm9yKSB7CiAgICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LmRlZmF1bHQuRnJhZ21lbnQsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlDYWxsT3V0LCB7CiAgICAgICAgICB0aXRsZTogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1hcHMubWFwTGlzdGluZy5saW1pdEV4Y2VlZGVkVGl0bGUnLCB7CiAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnTGlzdGluZyBsaW1pdCBleGNlZWRlZCcKICAgICAgICAgIH0pLAogICAgICAgICAgY29sb3I6ICJ3YXJuaW5nIiwKICAgICAgICAgIGljb25UeXBlOiAiaGVscCIKICAgICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJwIiwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICAgIGlkOiAieHBhY2subWFwcy5tYXBMaXN0aW5nLmxpbWl0SGVscERlc2NyaXB0aW9uIiwKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiWW91IGhhdmUge3RvdGFsSXRlbXN9IGl0ZW1zLCBidXQgeW91ciA8c3Ryb25nPmxpc3RpbmdMaW1pdDwvc3Ryb25nPiBzZXR0aW5nIHByZXZlbnRzIHRoZSB0YWJsZSBiZWxvdyBmcm9tIGRpc3BsYXlpbmcgbW9yZSB0aGFuIHtsaXN0aW5nTGltaXR9LiBZb3UgY2FuIGNoYW5nZSB0aGlzIHNldHRpbmcgdW5kZXIgIiwKICAgICAgICAgIHZhbHVlczogewogICAgICAgICAgICB0b3RhbEl0ZW1zOiB0aGlzLnN0YXRlLnRvdGFsSXRlbXMsCiAgICAgICAgICAgIGxpc3RpbmdMaW1pdDogdGhpcy5wcm9wcy5saXN0aW5nTGltaXQKICAgICAgICAgIH0KICAgICAgICB9KSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUxpbmssIHsKICAgICAgICAgIGhyZWY6ICIjL21hbmFnZW1lbnQva2liYW5hL3NldHRpbmdzIgogICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICBpZDogInhwYWNrLm1hcHMubWFwTGlzdGluZy5hZHZhbmNlZFNldHRpbmdzTGlua1RleHQiLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJBZHZhbmNlZCBTZXR0aW5ncyIKICAgICAgICB9KSksICIuIikpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3BhY2VyLCB7CiAgICAgICAgICBzaXplOiAibSIKICAgICAgICB9KSk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXJOb1Jlc3VsdHNNZXNzYWdlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJOb1Jlc3VsdHNNZXNzYWdlKCkgewogICAgICBpZiAodGhpcy5zdGF0ZS5pc0ZldGNoaW5nSXRlbXMpIHsKICAgICAgICByZXR1cm4gJyc7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmhhc05vSXRlbXMoKSkgewogICAgICAgIHJldHVybiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWFwcy5tYXBMaXN0aW5nLm5vSXRlbXNEZXNjcmlwdGlvbicsIHsKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiTG9va3MgbGlrZSB5b3UgZG9uJ3QgaGF2ZSBhbnkgbWFwcy4gQ2xpY2sgdGhlIGNyZWF0ZSBidXR0b24gdG8gY3JlYXRlIG9uZS4iCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWFwcy5tYXBMaXN0aW5nLm5vTWF0Y2hEZXNjcmlwdGlvbicsIHsKICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ05vIGl0ZW1zIG1hdGNoZWQgeW91ciBzZWFyY2guJwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXJTZWFyY2hCYXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlclNlYXJjaEJhcigpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB2YXIgZGVsZXRlQnRuOwoKICAgICAgaWYgKHRoaXMuc3RhdGUuc2VsZWN0ZWRJZHMubGVuZ3RoID4gMCkgewogICAgICAgIGRlbGV0ZUJ0biA9IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgICAgICAgZ3JvdzogZmFsc2UKICAgICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQnV0dG9uLCB7CiAgICAgICAgICBjb2xvcjogImRhbmdlciIsCiAgICAgICAgICBvbkNsaWNrOiB0aGlzLm9wZW5EZWxldGVNb2RhbCwKICAgICAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJkZWxldGVTZWxlY3RlZEl0ZW1zIiwKICAgICAgICAgIGtleTogImRlbGV0ZSIKICAgICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgICAgaWQ6ICJ4cGFjay5tYXBzLm1hcExpc3RpbmcuZGVsZXRlU2VsZWN0ZWRCdXR0b25MYWJlbCIsCiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkRlbGV0ZSBzZWxlY3RlZCIKICAgICAgICB9KSkpOwogICAgICB9CgogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhHcm91cCwgbnVsbCwgZGVsZXRlQnRuLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgICAgICBncm93OiB0cnVlCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGaWVsZFNlYXJjaCwgewogICAgICAgICJhcmlhLWxhYmVsIjogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1hcHMubWFwTGlzdGluZy5zZWFyY2hBcmlhTGFiZWwnLCB7CiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0ZpbHRlciBpdGVtcycKICAgICAgICB9KSwKICAgICAgICBwbGFjZWhvbGRlcjogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1hcHMubWFwTGlzdGluZy5zZWFyY2hQbGFjZWhvbGRlcicsIHsKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnU2VhcmNoLi4uJwogICAgICAgIH0pLAogICAgICAgIGZ1bGxXaWR0aDogdHJ1ZSwKICAgICAgICB2YWx1ZTogdGhpcy5zdGF0ZS5maWx0ZXIsCiAgICAgICAgb25DaGFuZ2U6IGZ1bmN0aW9uIG9uQ2hhbmdlKGUpIHsKICAgICAgICAgIF90aGlzMi5zZXRTdGF0ZSh7CiAgICAgICAgICAgIGZpbHRlcjogZS50YXJnZXQudmFsdWUKICAgICAgICAgIH0sIF90aGlzMi5mZXRjaEl0ZW1zKTsKICAgICAgICB9LAogICAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJzZWFyY2hGaWx0ZXIiCiAgICAgIH0pKSk7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVuZGVyVGFibGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlclRhYmxlKCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHZhciB0YWJsZUNvbHVtbnMgPSBbewogICAgICAgIGZpZWxkOiAndGl0bGUnLAogICAgICAgIG5hbWU6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tYXBzLm1hcExpc3RpbmcudGl0bGVGaWVsZFRpdGxlJywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdUaXRsZScKICAgICAgICB9KSwKICAgICAgICBzb3J0YWJsZTogdHJ1ZSwKICAgICAgICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcihmaWVsZCwgcmVjb3JkKSB7CiAgICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUxpbmssIHsKICAgICAgICAgICAgaHJlZjogIiMvbWFwLyIuY29uY2F0KHJlY29yZC5pZCksCiAgICAgICAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJtYXBMaXN0aW5nVGl0bGVMaW5rLSIuY29uY2F0KHJlY29yZC50aXRsZS5zcGxpdCgnICcpLmpvaW4oJy0nKSkKICAgICAgICAgIH0sIGZpZWxkKTsKICAgICAgICB9CiAgICAgIH0sIHsKICAgICAgICBmaWVsZDogJ2Rlc2NyaXB0aW9uJywKICAgICAgICBuYW1lOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWFwcy5tYXBMaXN0aW5nLmRlc2NyaXB0aW9uRmllbGRUaXRsZScsIHsKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnRGVzY3JpcHRpb24nCiAgICAgICAgfSksCiAgICAgICAgZGF0YVR5cGU6ICdzdHJpbmcnLAogICAgICAgIHNvcnRhYmxlOiB0cnVlCiAgICAgIH1dOwogICAgICB2YXIgcGFnaW5hdGlvbiA9IHsKICAgICAgICBwYWdlSW5kZXg6IHRoaXMuc3RhdGUucGFnZSwKICAgICAgICBwYWdlU2l6ZTogdGhpcy5zdGF0ZS5wZXJQYWdlLAogICAgICAgIHRvdGFsSXRlbUNvdW50OiB0aGlzLnN0YXRlLml0ZW1zLmxlbmd0aCwKICAgICAgICBwYWdlU2l6ZU9wdGlvbnM6IFsxMCwgMjAsIDUwXQogICAgICB9OwogICAgICB2YXIgc2VsZWN0aW9uID0gZmFsc2U7CgogICAgICBpZiAoIXRoaXMucHJvcHMucmVhZE9ubHkpIHsKICAgICAgICBzZWxlY3Rpb24gPSB7CiAgICAgICAgICBvblNlbGVjdGlvbkNoYW5nZTogZnVuY3Rpb24gb25TZWxlY3Rpb25DaGFuZ2Uoc2VsZWN0aW9uKSB7CiAgICAgICAgICAgIF90aGlzMy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgc2VsZWN0ZWRJZHM6IHNlbGVjdGlvbi5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLmlkOwogICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH07CiAgICAgIH0KCiAgICAgIHZhciBzb3J0aW5nID0ge307CgogICAgICBpZiAodGhpcy5zdGF0ZS5zb3J0RmllbGQpIHsKICAgICAgICBzb3J0aW5nLnNvcnQgPSB7CiAgICAgICAgICBmaWVsZDogdGhpcy5zdGF0ZS5zb3J0RmllbGQsCiAgICAgICAgICBkaXJlY3Rpb246IHRoaXMuc3RhdGUuc29ydERpcmVjdGlvbgogICAgICAgIH07CiAgICAgIH0KCiAgICAgIHZhciBpdGVtcyA9IHRoaXMuc3RhdGUuaXRlbXMubGVuZ3RoID09PSAwID8gW10gOiB0aGlzLmdldFBhZ2VPZkl0ZW1zKCk7CiAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQmFzaWNUYWJsZSwgewogICAgICAgIGl0ZW1JZDogJ2lkJywKICAgICAgICBpdGVtczogaXRlbXMsCiAgICAgICAgbG9hZGluZzogdGhpcy5zdGF0ZS5pc0ZldGNoaW5nSXRlbXMsCiAgICAgICAgY29sdW1uczogdGFibGVDb2x1bW5zLAogICAgICAgIHNlbGVjdGlvbjogc2VsZWN0aW9uLAogICAgICAgIG5vSXRlbXNNZXNzYWdlOiB0aGlzLnJlbmRlck5vUmVzdWx0c01lc3NhZ2UoKSwKICAgICAgICBwYWdpbmF0aW9uOiBwYWdpbmF0aW9uLAogICAgICAgIHNvcnRpbmc6IHNvcnRpbmcsCiAgICAgICAgb25DaGFuZ2U6IHRoaXMub25UYWJsZUNoYW5nZQogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXJMaXN0aW5nIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJMaXN0aW5nKCkgewogICAgICB2YXIgY3JlYXRlQnV0dG9uOwoKICAgICAgaWYgKCF0aGlzLnByb3BzLnJlYWRPbmx5KSB7CiAgICAgICAgY3JlYXRlQnV0dG9uID0gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUJ1dHRvbiwgewogICAgICAgICAgaHJlZjogIiMvbWFwIiwKICAgICAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJuZXdNYXBMaW5rIiwKICAgICAgICAgIGZpbGw6IHRydWUKICAgICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgICAgaWQ6ICJ4cGFjay5tYXBzLm1hcExpc3RpbmcuY3JlYXRlTWFwQnV0dG9uTGFiZWwiLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJDcmVhdGUgbWFwIgogICAgICAgIH0pKTsKICAgICAgfQoKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LmRlZmF1bHQuRnJhZ21lbnQsIG51bGwsIHRoaXMuc3RhdGUuc2hvd0RlbGV0ZU1vZGFsICYmIHRoaXMucmVuZGVyQ29uZmlybURlbGV0ZU1vZGFsKCksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4R3JvdXAsIHsKICAgICAgICBqdXN0aWZ5Q29udGVudDogInNwYWNlQmV0d2VlbiIsCiAgICAgICAgYWxpZ25JdGVtczogImNlbnRlciIsCiAgICAgICAgImRhdGEtdGVzdC1zdWJqIjogInRvcC1uYXYiCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgICAgIGdyb3c6IGZhbHNlCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUaXRsZSwgewogICAgICAgIHNpemU6ICJsIgogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJoMSIsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJ4cGFjay5tYXBzLm1hcExpc3RpbmcubGlzdGluZ1RhYmxlVGl0bGUiLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiTWFwcyIKICAgICAgfSkpKSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgICAgIGdyb3c6IGZhbHNlCiAgICAgIH0sIGNyZWF0ZUJ1dHRvbikpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3BhY2VyLCB7CiAgICAgICAgc2l6ZTogIm0iCiAgICAgIH0pLCB0aGlzLnJlbmRlckxpc3RpbmdMaW1pdFdhcm5pbmcoKSwgdGhpcy5yZW5kZXJTZWFyY2hCYXIoKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgewogICAgICAgIHNpemU6ICJtIgogICAgICB9KSwgdGhpcy5yZW5kZXJUYWJsZSgpKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXJQYWdlQ29udGVudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyUGFnZUNvbnRlbnQoKSB7CiAgICAgIGlmICghdGhpcy5zdGF0ZS5oYXNJbml0aWFsRmV0Y2hSZXR1cm5lZCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlQYWdlQ29udGVudCwgewogICAgICAgIGhvcml6b250YWxQb3NpdGlvbjogImNlbnRlciIKICAgICAgfSwgdGhpcy5yZW5kZXJMaXN0aW5nKCkpOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkgewogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVBhZ2UsIHsKICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiAibWFwc0xpc3RpbmdQYWdlIiwKICAgICAgICByZXN0cmljdFdpZHRoOiB0cnVlCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlQYWdlQm9keSwgbnVsbCwgdGhpcy5yZW5kZXJQYWdlQ29udGVudCgpKSk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gTWFwTGlzdGluZzsKfShfcmVhY3QuZGVmYXVsdC5Db21wb25lbnQpOwoKZXhwb3J0cy5NYXBMaXN0aW5nID0gTWFwTGlzdGluZzsKTWFwTGlzdGluZy5wcm9wVHlwZXMgPSB7CiAgcmVhZE9ubHk6IF9wcm9wVHlwZXMuZGVmYXVsdC5ib29sLmlzUmVxdWlyZWQsCiAgZmluZDogX3Byb3BUeXBlcy5kZWZhdWx0LmZ1bmMuaXNSZXF1aXJlZCwKICBkZWxldGU6IF9wcm9wVHlwZXMuZGVmYXVsdC5mdW5jLmlzUmVxdWlyZWQsCiAgbGlzdGluZ0xpbWl0OiBfcHJvcFR5cGVzLmRlZmF1bHQubnVtYmVyLmlzUmVxdWlyZWQKfTs="},null]}