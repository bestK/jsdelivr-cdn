{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/spaces/public/management/spaces_grid/spaces_grid_page.js","dependencies":[{"path":"x-pack/legacy/plugins/spaces/public/management/spaces_grid/spaces_grid_page.js","mtime":1585205048355},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiKSB7IF90eXBlb2YyID0gZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mMiA9IGZ1bmN0aW9uIF90eXBlb2YyKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mMihvYmopOyB9CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuU3BhY2VzR3JpZFBhZ2UgPSB2b2lkIDA7Cgp2YXIgX3JlYWN0ID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgicmVhY3QiKSk7Cgp2YXIgX2V1aSA9IHJlcXVpcmUoIkBlbGFzdGljL2V1aSIpOwoKdmFyIF9yZWFjdDIgPSByZXF1aXJlKCJAa2JuL2kxOG4vcmVhY3QiKTsKCnZhciBfa2ZldGNoID0gcmVxdWlyZSgidWkva2ZldGNoIik7Cgp2YXIgX25vdGlmeSA9IHJlcXVpcmUoInVpL25vdGlmeSIpOwoKdmFyIF9jb21tb24gPSByZXF1aXJlKCIuLi8uLi8uLi9jb21tb24iKTsKCnZhciBfY29uc3RhbnRzID0gcmVxdWlyZSgiLi4vLi4vLi4vY29tbW9uL2NvbnN0YW50cyIpOwoKdmFyIF9zcGFjZV9hdmF0YXIgPSByZXF1aXJlKCIuLi8uLi9zcGFjZV9hdmF0YXIiKTsKCnZhciBfY29uc3RhbnRzMiA9IHJlcXVpcmUoIi4uLy4uL2NvbnN0YW50cyIpOwoKdmFyIF9jb25maXJtX2RlbGV0ZV9tb2RhbCA9IHJlcXVpcmUoIi4uL2NvbXBvbmVudHMvY29uZmlybV9kZWxldGVfbW9kYWwiKTsKCnZhciBfc2VjdXJlX3NwYWNlX21lc3NhZ2UgPSByZXF1aXJlKCIuLi9jb21wb25lbnRzL3NlY3VyZV9zcGFjZV9tZXNzYWdlIik7Cgp2YXIgX3VuYXV0aG9yaXplZF9wcm9tcHQgPSByZXF1aXJlKCIuLi9jb21wb25lbnRzL3VuYXV0aG9yaXplZF9wcm9tcHQiKTsKCnZhciBfZmVhdHVyZV91dGlscyA9IHJlcXVpcmUoIi4uL2xpYi9mZWF0dXJlX3V0aWxzIik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsKICBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7CiAgICByZXR1cm4gb2JqOwogIH0gZWxzZSB7CiAgICB2YXIgbmV3T2JqID0ge307CgogICAgaWYgKG9iaiAhPSBudWxsKSB7CiAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHsKICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgewogICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvciA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpIDoge307CgogICAgICAgICAgaWYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSB7CiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmosIGtleSwgZGVzYyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBuZXdPYmpba2V5XSA9IG9ialtrZXldOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIG5ld09iai5kZWZhdWx0ID0gb2JqOwogICAgcmV0dXJuIG5ld09iajsKICB9Cn0KCmZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7CiAgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgX3R5cGVvZjIoU3ltYm9sLml0ZXJhdG9yKSA9PT0gInN5bWJvbCIpIHsKICAgIF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgewogICAgICByZXR1cm4gX3R5cGVvZjIob2JqKTsKICAgIH07CiAgfSBlbHNlIHsKICAgIF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgewogICAgICByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiBfdHlwZW9mMihvYmopOwogICAgfTsKICB9CgogIHJldHVybiBfdHlwZW9mKG9iaik7Cn0KCmZ1bmN0aW9uIF9zbGljZWRUb0FycmF5KGFyciwgaSkgewogIHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB8fCBfbm9uSXRlcmFibGVSZXN0KCk7Cn0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVJlc3QoKSB7CiAgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIGRlc3RydWN0dXJlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZSIpOwp9CgpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB7CiAgdmFyIF9hcnIgPSBbXTsKICB2YXIgX24gPSB0cnVlOwogIHZhciBfZCA9IGZhbHNlOwogIHZhciBfZSA9IHVuZGVmaW5lZDsKCiAgdHJ5IHsKICAgIGZvciAodmFyIF9pID0gYXJyW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3M7ICEoX24gPSAoX3MgPSBfaS5uZXh0KCkpLmRvbmUpOyBfbiA9IHRydWUpIHsKICAgICAgX2Fyci5wdXNoKF9zLnZhbHVlKTsKCiAgICAgIGlmIChpICYmIF9hcnIubGVuZ3RoID09PSBpKSBicmVhazsKICAgIH0KICB9IGNhdGNoIChlcnIpIHsKICAgIF9kID0gdHJ1ZTsKICAgIF9lID0gZXJyOwogIH0gZmluYWxseSB7CiAgICB0cnkgewogICAgICBpZiAoIV9uICYmIF9pWyJyZXR1cm4iXSAhPSBudWxsKSBfaVsicmV0dXJuIl0oKTsKICAgIH0gZmluYWxseSB7CiAgICAgIGlmIChfZCkgdGhyb3cgX2U7CiAgICB9CiAgfQoKICByZXR1cm4gX2FycjsKfQoKZnVuY3Rpb24gX2FycmF5V2l0aEhvbGVzKGFycikgewogIGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBhcnI7Cn0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsKICBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7CiAgfQp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgewogICAgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsKICAgIGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsKICAgIGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsKICAgIGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOwogIH0KfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgewogIGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOwogIGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsKICByZXR1cm4gQ29uc3RydWN0b3I7Cn0KCmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsKICBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpKSB7CiAgICByZXR1cm4gY2FsbDsKICB9CgogIHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOwp9CgpmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgewogIF9nZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7CiAgICByZXR1cm4gby5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKG8pOwogIH07CiAgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsKfQoKZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7CiAgaWYgKHNlbGYgPT09IHZvaWQgMCkgewogICAgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsKICB9CgogIHJldHVybiBzZWxmOwp9CgpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsKICBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICJmdW5jdGlvbiIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24iKTsKICB9CgogIHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgewogICAgY29uc3RydWN0b3I6IHsKICAgICAgdmFsdWU6IHN1YkNsYXNzLAogICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlCiAgICB9CiAgfSk7CiAgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcyk7Cn0KCmZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7CiAgX3NldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IGZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7CiAgICBvLl9fcHJvdG9fXyA9IHA7CiAgICByZXR1cm4gbzsKICB9OwoKICByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApOwp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7CiAgaWYgKGtleSBpbiBvYmopIHsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgICB2YWx1ZTogdmFsdWUsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgd3JpdGFibGU6IHRydWUKICAgIH0pOwogIH0gZWxzZSB7CiAgICBvYmpba2V5XSA9IHZhbHVlOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKdmFyIFNwYWNlc0dyaWRQYWdlVUkgPQovKiNfX1BVUkVfXyovCmZ1bmN0aW9uIChfQ29tcG9uZW50KSB7CiAgX2luaGVyaXRzKFNwYWNlc0dyaWRQYWdlVUksIF9Db21wb25lbnQpOwoKICBmdW5jdGlvbiBTcGFjZXNHcmlkUGFnZVVJKHByb3BzKSB7CiAgICB2YXIgX3RoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFNwYWNlc0dyaWRQYWdlVUkpOwoKICAgIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgX2dldFByb3RvdHlwZU9mKFNwYWNlc0dyaWRQYWdlVUkpLmNhbGwodGhpcywgcHJvcHMpKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJnZXRDb25maXJtRGVsZXRlTW9kYWwiLCBmdW5jdGlvbiAoKSB7CiAgICAgIGlmICghX3RoaXMuc3RhdGUuc2hvd0NvbmZpcm1EZWxldGVNb2RhbCB8fCAhX3RoaXMuc3RhdGUuc2VsZWN0ZWRTcGFjZSkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICB2YXIgc3BhY2VzTWFuYWdlciA9IF90aGlzLnByb3BzLnNwYWNlc01hbmFnZXI7CiAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9jb25maXJtX2RlbGV0ZV9tb2RhbC5Db25maXJtRGVsZXRlTW9kYWwsIHsKICAgICAgICBzcGFjZTogX3RoaXMuc3RhdGUuc2VsZWN0ZWRTcGFjZSwKICAgICAgICBzcGFjZXNNYW5hZ2VyOiBzcGFjZXNNYW5hZ2VyLAogICAgICAgIG9uQ2FuY2VsOiBmdW5jdGlvbiBvbkNhbmNlbCgpIHsKICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgc2hvd0NvbmZpcm1EZWxldGVNb2RhbDogZmFsc2UKICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgb25Db25maXJtOiBfdGhpcy5kZWxldGVTcGFjZQogICAgICB9KTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImRlbGV0ZVNwYWNlIiwgZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgdmFyIGludGwsIHNwYWNlc01hbmFnZXIsIHNwYWNlLCBfcmVmLCBfcmVmJG1lc3NhZ2UsIGVycm9yTWVzc2FnZSwgbWVzc2FnZTsKCiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXN5bmMoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgaW50bCA9IF90aGlzLnByb3BzLmludGw7CiAgICAgICAgICAgICAgc3BhY2VzTWFuYWdlciA9IF90aGlzLnByb3BzLnNwYWNlc01hbmFnZXI7CiAgICAgICAgICAgICAgc3BhY2UgPSBfdGhpcy5zdGF0ZS5zZWxlY3RlZFNwYWNlOwoKICAgICAgICAgICAgICBpZiAoc3BhY2UpIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA1OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gNTsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gODsKICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKHNwYWNlc01hbmFnZXIuZGVsZXRlU3BhY2Uoc3BhY2UpKTsKCiAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTQ7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAxMDsKICAgICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDUpOwogICAgICAgICAgICAgIF9yZWYgPSBfY29udGV4dC50MC5kYXRhIHx8IHt9LCBfcmVmJG1lc3NhZ2UgPSBfcmVmLm1lc3NhZ2UsIGVycm9yTWVzc2FnZSA9IF9yZWYkbWVzc2FnZSA9PT0gdm9pZCAwID8gJycgOiBfcmVmJG1lc3NhZ2U7CgogICAgICAgICAgICAgIF9ub3RpZnkudG9hc3ROb3RpZmljYXRpb25zLmFkZERhbmdlcihpbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgICAgICAgaWQ6ICd4cGFjay5zcGFjZXMubWFuYWdlbWVudC5zcGFjZXNHcmlkUGFnZS5lcnJvckRlbGV0aW5nU3BhY2VFcnJvck1lc3NhZ2UnLAogICAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdFcnJvciBkZWxldGluZyBzcGFjZToge2Vycm9yTWVzc2FnZX0nCiAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlOiBlcnJvck1lc3NhZ2UKICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgIHNob3dDb25maXJtRGVsZXRlTW9kYWw6IGZhbHNlCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIF90aGlzLmxvYWRHcmlkKCk7CgogICAgICAgICAgICAgIG1lc3NhZ2UgPSBpbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgICAgICAgaWQ6ICd4cGFjay5zcGFjZXMubWFuYWdlbWVudC5zcGFjZXNHcmlkUGFnZS5zcGFjZVN1Y2Nlc3NmdWxseURlbGV0ZWROb3RpZmljYXRpb25NZXNzYWdlJywKICAgICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnRGVsZXRlZCAie3NwYWNlTmFtZX0iIHNwYWNlLicKICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICBzcGFjZU5hbWU6IHNwYWNlLm5hbWUKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgX25vdGlmeS50b2FzdE5vdGlmaWNhdGlvbnMuYWRkU3VjY2VzcyhtZXNzYWdlKTsKCiAgICAgICAgICAgIGNhc2UgMTg6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIG51bGwsIG51bGwsIFtbNSwgMTBdXSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJsb2FkR3JpZCIsIGZ1bmN0aW9uIF9jYWxsZWUyKCkgewogICAgICB2YXIgc3BhY2VzTWFuYWdlciwgZ2V0U3BhY2VzLCBnZXRGZWF0dXJlcywgX3JlZjIsIF9yZWYzLCBzcGFjZXMsIGZlYXR1cmVzOwoKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hc3luYyhmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgc3BhY2VzTWFuYWdlciA9IF90aGlzLnByb3BzLnNwYWNlc01hbmFnZXI7CgogICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgIGxvYWRpbmc6IHRydWUsCiAgICAgICAgICAgICAgICBzcGFjZXM6IFtdLAogICAgICAgICAgICAgICAgZmVhdHVyZXM6IFtdCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGdldFNwYWNlcyA9IHNwYWNlc01hbmFnZXIuZ2V0U3BhY2VzKCk7CiAgICAgICAgICAgICAgZ2V0RmVhdHVyZXMgPSAoMCwgX2tmZXRjaC5rZmV0Y2gpKHsKICAgICAgICAgICAgICAgIG1ldGhvZDogJ2dldCcsCiAgICAgICAgICAgICAgICBwYXRobmFtZTogJy9hcGkvZmVhdHVyZXMnCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgX2NvbnRleHQyLnByZXYgPSA0OwogICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNzsKICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKFByb21pc2UuYWxsKFtnZXRTcGFjZXMsIGdldEZlYXR1cmVzXSkpOwoKICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgIF9yZWYyID0gX2NvbnRleHQyLnNlbnQ7CiAgICAgICAgICAgICAgX3JlZjMgPSBfc2xpY2VkVG9BcnJheShfcmVmMiwgMik7CiAgICAgICAgICAgICAgc3BhY2VzID0gX3JlZjNbMF07CiAgICAgICAgICAgICAgZmVhdHVyZXMgPSBfcmVmM1sxXTsKCiAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgICAgICAgICAgICBzcGFjZXM6IHNwYWNlcywKICAgICAgICAgICAgICAgIGZlYXR1cmVzOiBmZWF0dXJlcwogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDE3OwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICBfY29udGV4dDIucHJldiA9IDE0OwogICAgICAgICAgICAgIF9jb250ZXh0Mi50MCA9IF9jb250ZXh0MlsiY2F0Y2giXSg0KTsKCiAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgICAgICAgICAgICBlcnJvcjogX2NvbnRleHQyLnQwCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjYXNlIDE3OgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgbnVsbCwgbnVsbCwgW1s0LCAxNF1dKTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIm9uRWRpdFNwYWNlQ2xpY2siLCBmdW5jdGlvbiAoc3BhY2UpIHsKICAgICAgd2luZG93LmxvY2F0aW9uLmhhc2ggPSAiIy9tYW5hZ2VtZW50L3NwYWNlcy9lZGl0LyIuY29uY2F0KGVuY29kZVVSSUNvbXBvbmVudChzcGFjZS5pZCkpOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAib25EZWxldGVTcGFjZUNsaWNrIiwgZnVuY3Rpb24gKHNwYWNlKSB7CiAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICBzZWxlY3RlZFNwYWNlOiBzcGFjZSwKICAgICAgICBzaG93Q29uZmlybURlbGV0ZU1vZGFsOiB0cnVlCiAgICAgIH0pOwogICAgfSk7CgogICAgX3RoaXMuc3RhdGUgPSB7CiAgICAgIHNwYWNlczogW10sCiAgICAgIGZlYXR1cmVzOiBbXSwKICAgICAgbG9hZGluZzogdHJ1ZSwKICAgICAgc2hvd0NvbmZpcm1EZWxldGVNb2RhbDogZmFsc2UsCiAgICAgIHNlbGVjdGVkU3BhY2U6IG51bGwsCiAgICAgIGVycm9yOiBudWxsCiAgICB9OwogICAgcmV0dXJuIF90aGlzOwogIH0KCiAgX2NyZWF0ZUNsYXNzKFNwYWNlc0dyaWRQYWdlVUksIFt7CiAgICBrZXk6ICJjb21wb25lbnREaWRNb3VudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50RGlkTW91bnQoKSB7CiAgICAgIGlmICh0aGlzLnByb3BzLmNhcGFiaWxpdGllcy5zcGFjZXMubWFuYWdlKSB7CiAgICAgICAgdGhpcy5sb2FkR3JpZCgpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAicmVuZGVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7CiAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgY2xhc3NOYW1lOiAic3BjR3JpZFBhZ2UiLAogICAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJzcGFjZXMtZ3JpZC1wYWdlIgogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpUGFnZUNvbnRlbnQsIHsKICAgICAgICBob3Jpem9udGFsUG9zaXRpb246ICJjZW50ZXIiCiAgICAgIH0sIHRoaXMuZ2V0UGFnZUNvbnRlbnQoKSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3NlY3VyZV9zcGFjZV9tZXNzYWdlLlNlY3VyZVNwYWNlTWVzc2FnZSwgbnVsbCksIHRoaXMuZ2V0Q29uZmlybURlbGV0ZU1vZGFsKCkpOwogICAgfQogIH0sIHsKICAgIGtleTogImdldFBhZ2VDb250ZW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRQYWdlQ29udGVudCgpIHsKICAgICAgdmFyIGludGwgPSB0aGlzLnByb3BzLmludGw7CgogICAgICBpZiAoIXRoaXMucHJvcHMuY2FwYWJpbGl0aWVzLnNwYWNlcy5tYW5hZ2UpIHsKICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfdW5hdXRob3JpemVkX3Byb21wdC5VbmF1dGhvcml6ZWRQcm9tcHQsIG51bGwpOwogICAgICB9CgogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRnJhZ21lbnQsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4R3JvdXAsIHsKICAgICAgICBqdXN0aWZ5Q29udGVudDogJ3NwYWNlQmV0d2VlbicKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICAgICAgZ3JvdzogZmFsc2UKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRpdGxlLCB7CiAgICAgICAgc2l6ZTogIm0iCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImgxIiwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogInhwYWNrLnNwYWNlcy5tYW5hZ2VtZW50LnNwYWNlc0dyaWRQYWdlLnNwYWNlc1RpdGxlIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIlNwYWNlcyIKICAgICAgfSkpKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRleHQsIHsKICAgICAgICBjb2xvcjogInN1YmR1ZWQiLAogICAgICAgIHNpemU6ICJzIgogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJwIiwgbnVsbCwgKDAsIF9jb25zdGFudHMyLmdldFNwYWNlc0ZlYXR1cmVEZXNjcmlwdGlvbikoKSkpKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICAgICAgZ3JvdzogZmFsc2UKICAgICAgfSwgdGhpcy5nZXRQcmltYXJ5QWN0aW9uQnV0dG9uKCkpKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgewogICAgICAgIHNpemU6ICJsIgogICAgICB9KSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUluTWVtb3J5VGFibGUsIHsKICAgICAgICBpdGVtSWQ6ICdpZCcsCiAgICAgICAgaXRlbXM6IHRoaXMuc3RhdGUuc3BhY2VzLAogICAgICAgIGNvbHVtbnM6IHRoaXMuZ2V0Q29sdW1uQ29uZmlnKCksCiAgICAgICAgaGFzQWN0aW9uczogdHJ1ZSwKICAgICAgICBwYWdpbmF0aW9uOiB0cnVlLAogICAgICAgIHNvcnRpbmc6IHRydWUsCiAgICAgICAgc2VhcmNoOiB7CiAgICAgICAgICBib3g6IHsKICAgICAgICAgICAgcGxhY2Vob2xkZXI6IGludGwuZm9ybWF0TWVzc2FnZSh7CiAgICAgICAgICAgICAgaWQ6ICd4cGFjay5zcGFjZXMubWFuYWdlbWVudC5zcGFjZXNHcmlkUGFnZS5zZWFyY2hQbGFjZWhvbGRlcicsCiAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdTZWFyY2gnCiAgICAgICAgICAgIH0pCiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBsb2FkaW5nOiB0aGlzLnN0YXRlLmxvYWRpbmcsCiAgICAgICAgbWVzc2FnZTogdGhpcy5zdGF0ZS5sb2FkaW5nID8gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICAgIGlkOiAieHBhY2suc3BhY2VzLm1hbmFnZW1lbnQuc3BhY2VzR3JpZFBhZ2UubG9hZGluZ1RpdGxlIiwKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAibG9hZGluZ1x1MjAyNiIKICAgICAgICB9KSA6IHVuZGVmaW5lZAogICAgICB9KSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0UHJpbWFyeUFjdGlvbkJ1dHRvbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0UHJpbWFyeUFjdGlvbkJ1dHRvbigpIHsKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlCdXR0b24sIHsKICAgICAgICBmaWxsOiB0cnVlLAogICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7CiAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaGFzaCA9ICIjL21hbmFnZW1lbnQvc3BhY2VzL2NyZWF0ZSI7CiAgICAgICAgfQogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAieHBhY2suc3BhY2VzLm1hbmFnZW1lbnQuc3BhY2VzR3JpZFBhZ2UuY3JlYXRlU3BhY2VCdXR0b25MYWJlbCIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJDcmVhdGUgYSBzcGFjZSIKICAgICAgfSkpOwogICAgfQogIH0sIHsKICAgIGtleTogImdldENvbHVtbkNvbmZpZyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q29sdW1uQ29uZmlnKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHZhciBpbnRsID0gdGhpcy5wcm9wcy5pbnRsOwogICAgICByZXR1cm4gW3sKICAgICAgICBmaWVsZDogJ2luaXRpYWxzJywKICAgICAgICBuYW1lOiAnJywKICAgICAgICB3aWR0aDogJzUwcHgnLAogICAgICAgIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKHZhbHVlLCByZWNvcmQpIHsKICAgICAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpTGluaywgewogICAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgICAgIF90aGlzMi5vbkVkaXRTcGFjZUNsaWNrKHJlY29yZCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3NwYWNlX2F2YXRhci5TcGFjZUF2YXRhciwgewogICAgICAgICAgICBzcGFjZTogcmVjb3JkLAogICAgICAgICAgICBzaXplOiAicyIKICAgICAgICAgIH0pKTsKICAgICAgICB9CiAgICAgIH0sIHsKICAgICAgICBmaWVsZDogJ25hbWUnLAogICAgICAgIG5hbWU6IGludGwuZm9ybWF0TWVzc2FnZSh7CiAgICAgICAgICBpZDogJ3hwYWNrLnNwYWNlcy5tYW5hZ2VtZW50LnNwYWNlc0dyaWRQYWdlLnNwYWNlQ29sdW1uTmFtZScsCiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1NwYWNlJwogICAgICAgIH0pLAogICAgICAgIHNvcnRhYmxlOiB0cnVlLAogICAgICAgIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKHZhbHVlLCByZWNvcmQpIHsKICAgICAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpTGluaywgewogICAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgICAgIF90aGlzMi5vbkVkaXRTcGFjZUNsaWNrKHJlY29yZCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sIHZhbHVlKTsKICAgICAgICB9CiAgICAgIH0sIHsKICAgICAgICBmaWVsZDogJ2Rlc2NyaXB0aW9uJywKICAgICAgICBuYW1lOiBpbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgaWQ6ICd4cGFjay5zcGFjZXMubWFuYWdlbWVudC5zcGFjZXNHcmlkUGFnZS5kZXNjcmlwdGlvbkNvbHVtbk5hbWUnLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdEZXNjcmlwdGlvbicKICAgICAgICB9KSwKICAgICAgICBzb3J0YWJsZTogdHJ1ZQogICAgICB9LCB7CiAgICAgICAgZmllbGQ6ICdkaXNhYmxlZEZlYXR1cmVzJywKICAgICAgICBuYW1lOiBpbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgaWQ6ICd4cGFjay5zcGFjZXMubWFuYWdlbWVudC5zcGFjZXNHcmlkUGFnZS5mZWF0dXJlc0NvbHVtbk5hbWUnLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdGZWF0dXJlcycKICAgICAgICB9KSwKICAgICAgICBzb3J0YWJsZTogZnVuY3Rpb24gc29ydGFibGUoc3BhY2UpIHsKICAgICAgICAgIHJldHVybiAoMCwgX2ZlYXR1cmVfdXRpbHMuZ2V0RW5hYmxlZEZlYXR1cmVzKShfdGhpczIuc3RhdGUuZmVhdHVyZXMsIHNwYWNlKS5sZW5ndGg7CiAgICAgICAgfSwKICAgICAgICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcihkaXNhYmxlZEZlYXR1cmVzLCByZWNvcmQpIHsKICAgICAgICAgIHZhciBlbmFibGVkRmVhdHVyZUNvdW50ID0gKDAsIF9mZWF0dXJlX3V0aWxzLmdldEVuYWJsZWRGZWF0dXJlcykoX3RoaXMyLnN0YXRlLmZlYXR1cmVzLCByZWNvcmQpLmxlbmd0aDsKCiAgICAgICAgICBpZiAoZW5hYmxlZEZlYXR1cmVDb3VudCA9PT0gX3RoaXMyLnN0YXRlLmZlYXR1cmVzLmxlbmd0aCkgewogICAgICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICAgICAgICBpZDogInhwYWNrLnNwYWNlcy5tYW5hZ2VtZW50LnNwYWNlc0dyaWRQYWdlLmFsbEZlYXR1cmVzRW5hYmxlZCIsCiAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJBbGwgZmVhdHVyZXMgdmlzaWJsZSIKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGVuYWJsZWRGZWF0dXJlQ291bnQgPT09IDApIHsKICAgICAgICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUZXh0LCB7CiAgICAgICAgICAgICAgY29sb3I6ICdkYW5nZXInCiAgICAgICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICAgICAgaWQ6ICJ4cGFjay5zcGFjZXMubWFuYWdlbWVudC5zcGFjZXNHcmlkUGFnZS5ub0ZlYXR1cmVzRW5hYmxlZCIsCiAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJObyBmZWF0dXJlcyB2aXNpYmxlIgogICAgICAgICAgICB9KSk7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICAgIGlkOiAieHBhY2suc3BhY2VzLm1hbmFnZW1lbnQuc3BhY2VzR3JpZFBhZ2Uuc29tZUZlYXR1cmVzRW5hYmxlZCIsCiAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAie2VuYWJsZWRGZWF0dXJlQ291bnR9IC8ge3RvdGFsRmVhdHVyZUNvdW50fSBmZWF0dXJlcyB2aXNpYmxlIiwKICAgICAgICAgICAgdmFsdWVzOiB7CiAgICAgICAgICAgICAgZW5hYmxlZEZlYXR1cmVDb3VudDogZW5hYmxlZEZlYXR1cmVDb3VudCwKICAgICAgICAgICAgICB0b3RhbEZlYXR1cmVDb3VudDogX3RoaXMyLnN0YXRlLmZlYXR1cmVzLmxlbmd0aAogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0sIHsKICAgICAgICBmaWVsZDogJ2lkJywKICAgICAgICBuYW1lOiBpbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgaWQ6ICd4cGFjay5zcGFjZXMubWFuYWdlbWVudC5zcGFjZXNHcmlkUGFnZS5pZGVudGlmaWVyQ29sdW1uTmFtZScsCiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0lkZW50aWZpZXInCiAgICAgICAgfSksCiAgICAgICAgc29ydGFibGU6IHRydWUsCiAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoaWQpIHsKICAgICAgICAgIGlmIChpZCA9PT0gX2NvbnN0YW50cy5ERUZBVUxUX1NQQUNFX0lEKSB7CiAgICAgICAgICAgIHJldHVybiAnJzsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gaWQ7CiAgICAgICAgfQogICAgICB9LCB7CiAgICAgICAgbmFtZTogaW50bC5mb3JtYXRNZXNzYWdlKHsKICAgICAgICAgIGlkOiAneHBhY2suc3BhY2VzLm1hbmFnZW1lbnQuc3BhY2VzR3JpZFBhZ2UuYWN0aW9uc0NvbHVtbk5hbWUnLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdBY3Rpb25zJwogICAgICAgIH0pLAogICAgICAgIGFjdGlvbnM6IFt7CiAgICAgICAgICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcihyZWNvcmQpIHsKICAgICAgICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlCdXR0b25JY29uLCB7CiAgICAgICAgICAgICAgImFyaWEtbGFiZWwiOiBpbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgICAgICAgaWQ6ICd4cGFjay5zcGFjZXMubWFuYWdlbWVudC5zcGFjZXNHcmlkUGFnZS5lZGl0U3BhY2VBY3Rpb25OYW1lJywKICAgICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiRWRpdCB7c3BhY2VOYW1lfS4iCiAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgc3BhY2VOYW1lOiByZWNvcmQubmFtZQogICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgIGNvbG9yOiAncHJpbWFyeScsCiAgICAgICAgICAgICAgaWNvblR5cGU6ICdwZW5jaWwnLAogICAgICAgICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMyLm9uRWRpdFNwYWNlQ2xpY2socmVjb3JkKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0sIHsKICAgICAgICAgIGF2YWlsYWJsZTogZnVuY3Rpb24gYXZhaWxhYmxlKHJlY29yZCkgewogICAgICAgICAgICByZXR1cm4gISgwLCBfY29tbW9uLmlzUmVzZXJ2ZWRTcGFjZSkocmVjb3JkKTsKICAgICAgICAgIH0sCiAgICAgICAgICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcihyZWNvcmQpIHsKICAgICAgICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlCdXR0b25JY29uLCB7CiAgICAgICAgICAgICAgImFyaWEtbGFiZWwiOiBpbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgICAgICAgaWQ6ICd4cGFjay5zcGFjZXMubWFuYWdlbWVudC5zcGFjZXNHcmlkUGFnZS5kZWxldGVBY3Rpb25OYW1lJywKICAgICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiRGVsZXRlIHtzcGFjZU5hbWV9LiIKICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICBzcGFjZU5hbWU6IHJlY29yZC5uYW1lCiAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgY29sb3I6ICdkYW5nZXInLAogICAgICAgICAgICAgIGljb25UeXBlOiAndHJhc2gnLAogICAgICAgICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMyLm9uRGVsZXRlU3BhY2VDbGljayhyZWNvcmQpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfV0KICAgICAgfV07CiAgICB9CiAgfV0pOwoKICByZXR1cm4gU3BhY2VzR3JpZFBhZ2VVSTsKfShfcmVhY3QuQ29tcG9uZW50KTsKCnZhciBTcGFjZXNHcmlkUGFnZSA9ICgwLCBfcmVhY3QyLmluamVjdEkxOG4pKFNwYWNlc0dyaWRQYWdlVUkpOwpleHBvcnRzLlNwYWNlc0dyaWRQYWdlID0gU3BhY2VzR3JpZFBhZ2U7"},null]}