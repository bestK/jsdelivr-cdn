{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/siem/public/pages/detection_engine/rules/edit/index.js","dependencies":[{"path":"x-pack/legacy/plugins/siem/public/pages/detection_engine/rules/edit/index.js","mtime":1585205047887},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkVkaXRSdWxlUGFnZSA9IHZvaWQgMDsKCnZhciBfZXVpID0gcmVxdWlyZSgiQGVsYXN0aWMvZXVpIik7Cgp2YXIgX3JlYWN0ID0gcmVxdWlyZSgiQGtibi9pMThuL3JlYWN0Iik7Cgp2YXIgX3JlYWN0MiA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoInJlYWN0IikpOwoKdmFyIF9yZWFjdFJvdXRlckRvbSA9IHJlcXVpcmUoInJlYWN0LXJvdXRlci1kb20iKTsKCnZhciBfcnVsZXMgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9jb250YWluZXJzL2RldGVjdGlvbl9lbmdpbmUvcnVsZXMiKTsKCnZhciBfd3JhcHBlcl9wYWdlID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vY29tcG9uZW50cy93cmFwcGVyX3BhZ2UiKTsKCnZhciBfcmVkaXJlY3RfdG9fZGV0ZWN0aW9uX2VuZ2luZSA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL2NvbXBvbmVudHMvbGlua190by9yZWRpcmVjdF90b19kZXRlY3Rpb25fZW5naW5lIik7Cgp2YXIgX3RvYXN0ZXJzID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vY29tcG9uZW50cy90b2FzdGVycyIpOwoKdmFyIF9zcHlfcm91dGVzID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vdXRpbHMvcm91dGUvc3B5X3JvdXRlcyIpOwoKdmFyIF91c2VyX2luZm8gPSByZXF1aXJlKCIuLi8uLi9jb21wb25lbnRzL3VzZXJfaW5mbyIpOwoKdmFyIF9kZXRlY3Rpb25fZW5naW5lX2hlYWRlcl9wYWdlID0gcmVxdWlyZSgiLi4vLi4vY29tcG9uZW50cy9kZXRlY3Rpb25fZW5naW5lX2hlYWRlcl9wYWdlIik7Cgp2YXIgX3N0ZXBfcGFuZWwgPSByZXF1aXJlKCIuLi9jb21wb25lbnRzL3N0ZXBfcGFuZWwiKTsKCnZhciBfc3RlcF9hYm91dF9ydWxlID0gcmVxdWlyZSgiLi4vY29tcG9uZW50cy9zdGVwX2Fib3V0X3J1bGUiKTsKCnZhciBfc3RlcF9kZWZpbmVfcnVsZSA9IHJlcXVpcmUoIi4uL2NvbXBvbmVudHMvc3RlcF9kZWZpbmVfcnVsZSIpOwoKdmFyIF9zdGVwX3NjaGVkdWxlX3J1bGUgPSByZXF1aXJlKCIuLi9jb21wb25lbnRzL3N0ZXBfc2NoZWR1bGVfcnVsZSIpOwoKdmFyIF9oZWxwZXJzID0gcmVxdWlyZSgiLi4vY3JlYXRlL2hlbHBlcnMiKTsKCnZhciBfaGVscGVyczIgPSByZXF1aXJlKCIuLi9oZWxwZXJzIik7Cgp2YXIgcnVsZUkxOG4gPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKCIuLi90cmFuc2xhdGlvbnMiKSk7Cgp2YXIgX3R5cGVzID0gcmVxdWlyZSgiLi4vdHlwZXMiKTsKCnZhciBpMThuID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgiLi90cmFuc2xhdGlvbnMiKSk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsKICBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7CiAgICByZXR1cm4gb2JqOwogIH0gZWxzZSB7CiAgICB2YXIgbmV3T2JqID0ge307CgogICAgaWYgKG9iaiAhPSBudWxsKSB7CiAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHsKICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgewogICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvciA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpIDoge307CgogICAgICAgICAgaWYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSB7CiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmosIGtleSwgZGVzYyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBuZXdPYmpba2V5XSA9IG9ialtrZXldOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIG5ld09iai5kZWZhdWx0ID0gb2JqOwogICAgcmV0dXJuIG5ld09iajsKICB9Cn0KCmZ1bmN0aW9uIF90b0NvbnN1bWFibGVBcnJheShhcnIpIHsKICByZXR1cm4gX2FycmF5V2l0aG91dEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheShhcnIpIHx8IF9ub25JdGVyYWJsZVNwcmVhZCgpOwp9CgpmdW5jdGlvbiBfbm9uSXRlcmFibGVTcHJlYWQoKSB7CiAgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIHNwcmVhZCBub24taXRlcmFibGUgaW5zdGFuY2UiKTsKfQoKZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheShpdGVyKSB7CiAgaWYgKFN5bWJvbC5pdGVyYXRvciBpbiBPYmplY3QoaXRlcikgfHwgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGl0ZXIpID09PSAiW29iamVjdCBBcmd1bWVudHNdIikgcmV0dXJuIEFycmF5LmZyb20oaXRlcik7Cn0KCmZ1bmN0aW9uIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHsKICBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSB7CiAgICBmb3IgKHZhciBpID0gMCwgYXJyMiA9IG5ldyBBcnJheShhcnIubGVuZ3RoKTsgaSA8IGFyci5sZW5ndGg7IGkrKykgewogICAgICBhcnIyW2ldID0gYXJyW2ldOwogICAgfQoKICAgIHJldHVybiBhcnIyOwogIH0KfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgewogIGlmIChrZXkgaW4gb2JqKSB7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsKICAgICAgdmFsdWU6IHZhbHVlLAogICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgIHdyaXRhYmxlOiB0cnVlCiAgICB9KTsKICB9IGVsc2UgewogICAgb2JqW2tleV0gPSB2YWx1ZTsKICB9CgogIHJldHVybiBvYmo7Cn0KCmZ1bmN0aW9uIF9zbGljZWRUb0FycmF5KGFyciwgaSkgewogIHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB8fCBfbm9uSXRlcmFibGVSZXN0KCk7Cn0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVJlc3QoKSB7CiAgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIGRlc3RydWN0dXJlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZSIpOwp9CgpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB7CiAgdmFyIF9hcnIgPSBbXTsKICB2YXIgX24gPSB0cnVlOwogIHZhciBfZCA9IGZhbHNlOwogIHZhciBfZSA9IHVuZGVmaW5lZDsKCiAgdHJ5IHsKICAgIGZvciAodmFyIF9pID0gYXJyW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3M7ICEoX24gPSAoX3MgPSBfaS5uZXh0KCkpLmRvbmUpOyBfbiA9IHRydWUpIHsKICAgICAgX2Fyci5wdXNoKF9zLnZhbHVlKTsKCiAgICAgIGlmIChpICYmIF9hcnIubGVuZ3RoID09PSBpKSBicmVhazsKICAgIH0KICB9IGNhdGNoIChlcnIpIHsKICAgIF9kID0gdHJ1ZTsKICAgIF9lID0gZXJyOwogIH0gZmluYWxseSB7CiAgICB0cnkgewogICAgICBpZiAoIV9uICYmIF9pWyJyZXR1cm4iXSAhPSBudWxsKSBfaVsicmV0dXJuIl0oKTsKICAgIH0gZmluYWxseSB7CiAgICAgIGlmIChfZCkgdGhyb3cgX2U7CiAgICB9CiAgfQoKICByZXR1cm4gX2FycjsKfQoKZnVuY3Rpb24gX2FycmF5V2l0aEhvbGVzKGFycikgewogIGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBhcnI7Cn0KCnZhciBFZGl0UnVsZVBhZ2VDb21wb25lbnQgPSBmdW5jdGlvbiBFZGl0UnVsZVBhZ2VDb21wb25lbnQoKSB7CiAgdmFyIF91c2VSZWYsIF9yZWYyOwoKICB2YXIgX3VzZVN0YXRlVG9hc3RlciA9ICgwLCBfdG9hc3RlcnMudXNlU3RhdGVUb2FzdGVyKSgpLAogICAgICBfdXNlU3RhdGVUb2FzdGVyMiA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZVRvYXN0ZXIsIDIpLAogICAgICBkaXNwYXRjaFRvYXN0ZXIgPSBfdXNlU3RhdGVUb2FzdGVyMlsxXTsKCiAgdmFyIF91c2VVc2VySW5mbyA9ICgwLCBfdXNlcl9pbmZvLnVzZVVzZXJJbmZvKSgpLAogICAgICBpbml0TG9hZGluZyA9IF91c2VVc2VySW5mby5sb2FkaW5nLAogICAgICBpc1NpZ25hbEluZGV4RXhpc3RzID0gX3VzZVVzZXJJbmZvLmlzU2lnbmFsSW5kZXhFeGlzdHMsCiAgICAgIGlzQXV0aGVudGljYXRlZCA9IF91c2VVc2VySW5mby5pc0F1dGhlbnRpY2F0ZWQsCiAgICAgIGhhc0VuY3J5cHRpb25LZXkgPSBfdXNlVXNlckluZm8uaGFzRW5jcnlwdGlvbktleSwKICAgICAgY2FuVXNlckNSVUQgPSBfdXNlVXNlckluZm8uY2FuVXNlckNSVUQsCiAgICAgIGhhc01hbmFnZUFwaUtleSA9IF91c2VVc2VySW5mby5oYXNNYW5hZ2VBcGlLZXk7CgogIHZhciBfdXNlUGFyYW1zID0gKDAsIF9yZWFjdFJvdXRlckRvbS51c2VQYXJhbXMpKCksCiAgICAgIHJ1bGVJZCA9IF91c2VQYXJhbXMuZGV0YWlsTmFtZTsKCiAgdmFyIF91c2VSdWxlID0gKDAsIF9ydWxlcy51c2VSdWxlKShydWxlSWQpLAogICAgICBfdXNlUnVsZTIgPSBfc2xpY2VkVG9BcnJheShfdXNlUnVsZSwgMiksCiAgICAgIGxvYWRpbmcgPSBfdXNlUnVsZTJbMF0sCiAgICAgIHJ1bGUgPSBfdXNlUnVsZTJbMV07CgogIHZhciB1c2VySGFzTm9QZXJtaXNzaW9ucyA9IGNhblVzZXJDUlVEICE9IG51bGwgJiYgaGFzTWFuYWdlQXBpS2V5ICE9IG51bGwgPyAhY2FuVXNlckNSVUQgfHwgIWhhc01hbmFnZUFwaUtleSA6IGZhbHNlOwoKICB2YXIgX3VzZVN0YXRlID0gKDAsIF9yZWFjdDIudXNlU3RhdGUpKGZhbHNlKSwKICAgICAgX3VzZVN0YXRlMiA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZSwgMiksCiAgICAgIGluaXRGb3JtID0gX3VzZVN0YXRlMlswXSwKICAgICAgc2V0SW5pdEZvcm0gPSBfdXNlU3RhdGUyWzFdOwoKICB2YXIgX3VzZVN0YXRlMyA9ICgwLCBfcmVhY3QyLnVzZVN0YXRlKSh7CiAgICBkYXRhOiBudWxsLAogICAgaXNWYWxpZDogZmFsc2UKICB9KSwKICAgICAgX3VzZVN0YXRlNCA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZTMsIDIpLAogICAgICBteUFib3V0UnVsZUZvcm0gPSBfdXNlU3RhdGU0WzBdLAogICAgICBzZXRNeUFib3V0UnVsZUZvcm0gPSBfdXNlU3RhdGU0WzFdOwoKICB2YXIgX3VzZVN0YXRlNSA9ICgwLCBfcmVhY3QyLnVzZVN0YXRlKSh7CiAgICBkYXRhOiBudWxsLAogICAgaXNWYWxpZDogZmFsc2UKICB9KSwKICAgICAgX3VzZVN0YXRlNiA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZTUsIDIpLAogICAgICBteURlZmluZVJ1bGVGb3JtID0gX3VzZVN0YXRlNlswXSwKICAgICAgc2V0TXlEZWZpbmVSdWxlRm9ybSA9IF91c2VTdGF0ZTZbMV07CgogIHZhciBfdXNlU3RhdGU3ID0gKDAsIF9yZWFjdDIudXNlU3RhdGUpKHsKICAgIGRhdGE6IG51bGwsCiAgICBpc1ZhbGlkOiBmYWxzZQogIH0pLAogICAgICBfdXNlU3RhdGU4ID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlNywgMiksCiAgICAgIG15U2NoZWR1bGVSdWxlRm9ybSA9IF91c2VTdGF0ZThbMF0sCiAgICAgIHNldE15U2NoZWR1bGVSdWxlRm9ybSA9IF91c2VTdGF0ZThbMV07CgogIHZhciBfdXNlU3RhdGU5ID0gKDAsIF9yZWFjdDIudXNlU3RhdGUpKCksCiAgICAgIF91c2VTdGF0ZTEwID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlOSwgMiksCiAgICAgIHNlbGVjdGVkVGFiID0gX3VzZVN0YXRlMTBbMF0sCiAgICAgIHNldFNlbGVjdGVkVGFiID0gX3VzZVN0YXRlMTBbMV07CgogIHZhciBzdGVwc0Zvcm0gPSAoMCwgX3JlYWN0Mi51c2VSZWYpKChfdXNlUmVmID0ge30sIF9kZWZpbmVQcm9wZXJ0eShfdXNlUmVmLCBfdHlwZXMuUnVsZVN0ZXAuZGVmaW5lUnVsZSwgbnVsbCksIF9kZWZpbmVQcm9wZXJ0eShfdXNlUmVmLCBfdHlwZXMuUnVsZVN0ZXAuYWJvdXRSdWxlLCBudWxsKSwgX2RlZmluZVByb3BlcnR5KF91c2VSZWYsIF90eXBlcy5SdWxlU3RlcC5zY2hlZHVsZVJ1bGUsIG51bGwpLCBfdXNlUmVmKSk7CgogIHZhciBfdXNlUGVyc2lzdFJ1bGUgPSAoMCwgX3J1bGVzLnVzZVBlcnNpc3RSdWxlKSgpLAogICAgICBfdXNlUGVyc2lzdFJ1bGUyID0gX3NsaWNlZFRvQXJyYXkoX3VzZVBlcnNpc3RSdWxlLCAyKSwKICAgICAgX3VzZVBlcnNpc3RSdWxlMiQgPSBfdXNlUGVyc2lzdFJ1bGUyWzBdLAogICAgICBpc0xvYWRpbmcgPSBfdXNlUGVyc2lzdFJ1bGUyJC5pc0xvYWRpbmcsCiAgICAgIGlzU2F2ZWQgPSBfdXNlUGVyc2lzdFJ1bGUyJC5pc1NhdmVkLAogICAgICBzZXRSdWxlID0gX3VzZVBlcnNpc3RSdWxlMlsxXTsKCiAgdmFyIF91c2VTdGF0ZTExID0gKDAsIF9yZWFjdDIudXNlU3RhdGUpKFtdKSwKICAgICAgX3VzZVN0YXRlMTIgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUxMSwgMiksCiAgICAgIHRhYkhhc0Vycm9yID0gX3VzZVN0YXRlMTJbMF0sCiAgICAgIHNldFRhYkhhc0Vycm9yID0gX3VzZVN0YXRlMTJbMV07CgogIHZhciBzZXRTdGVwc0Zvcm0gPSAoMCwgX3JlYWN0Mi51c2VDYWxsYmFjaykoZnVuY3Rpb24gKHN0ZXAsIGZvcm0pIHsKICAgIHN0ZXBzRm9ybS5jdXJyZW50W3N0ZXBdID0gZm9ybTsKCiAgICBpZiAoaW5pdEZvcm0gJiYgc3RlcCA9PT0gKHNlbGVjdGVkVGFiID09PSBudWxsIHx8IHNlbGVjdGVkVGFiID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzZWxlY3RlZFRhYi5pZCkgJiYgZm9ybS5pc1N1Ym1pdHRlZCA9PT0gZmFsc2UpIHsKICAgICAgc2V0SW5pdEZvcm0oZmFsc2UpOwogICAgICBmb3JtLnN1Ym1pdCgpOwogICAgfQogIH0sIFtpbml0Rm9ybSwgc2VsZWN0ZWRUYWJdKTsKICB2YXIgdGFicyA9ICgwLCBfcmVhY3QyLnVzZU1lbW8pKGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiBbewogICAgICBpZDogX3R5cGVzLlJ1bGVTdGVwLmRlZmluZVJ1bGUsCiAgICAgIG5hbWU6IHJ1bGVJMThuLkRFRklOSVRJT04sCiAgICAgIGNvbnRlbnQ6IF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuZGVmYXVsdC5GcmFnbWVudCwgbnVsbCwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTcGFjZXIsIG51bGwpLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfc3RlcF9wYW5lbC5TdGVwUGFuZWwsIHsKICAgICAgICBsb2FkaW5nOiBsb2FkaW5nIHx8IGluaXRMb2FkaW5nLAogICAgICAgIHRpdGxlOiBydWxlSTE4bi5ERUZJTklUSU9OCiAgICAgIH0sIG15RGVmaW5lUnVsZUZvcm0uZGF0YSAhPSBudWxsICYmIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9zdGVwX2RlZmluZV9ydWxlLlN0ZXBEZWZpbmVSdWxlLCB7CiAgICAgICAgaXNSZWFkT25seVZpZXc6IGZhbHNlLAogICAgICAgIGlzTG9hZGluZzogaXNMb2FkaW5nLAogICAgICAgIGlzVXBkYXRlVmlldzogdHJ1ZSwKICAgICAgICBkZWZhdWx0VmFsdWVzOiBteURlZmluZVJ1bGVGb3JtLmRhdGEsCiAgICAgICAgc2V0Rm9ybTogc2V0U3RlcHNGb3JtCiAgICAgIH0pLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgbnVsbCkpKQogICAgfSwgewogICAgICBpZDogX3R5cGVzLlJ1bGVTdGVwLmFib3V0UnVsZSwKICAgICAgbmFtZTogcnVsZUkxOG4uQUJPVVQsCiAgICAgIGNvbnRlbnQ6IF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuZGVmYXVsdC5GcmFnbWVudCwgbnVsbCwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTcGFjZXIsIG51bGwpLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfc3RlcF9wYW5lbC5TdGVwUGFuZWwsIHsKICAgICAgICBsb2FkaW5nOiBsb2FkaW5nIHx8IGluaXRMb2FkaW5nLAogICAgICAgIHRpdGxlOiBydWxlSTE4bi5BQk9VVAogICAgICB9LCBteUFib3V0UnVsZUZvcm0uZGF0YSAhPSBudWxsICYmIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9zdGVwX2Fib3V0X3J1bGUuU3RlcEFib3V0UnVsZSwgewogICAgICAgIGlzUmVhZE9ubHlWaWV3OiBmYWxzZSwKICAgICAgICBpc0xvYWRpbmc6IGlzTG9hZGluZywKICAgICAgICBpc1VwZGF0ZVZpZXc6IHRydWUsCiAgICAgICAgZGVmYXVsdFZhbHVlczogbXlBYm91dFJ1bGVGb3JtLmRhdGEsCiAgICAgICAgc2V0Rm9ybTogc2V0U3RlcHNGb3JtCiAgICAgIH0pLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgbnVsbCkpKQogICAgfSwgewogICAgICBpZDogX3R5cGVzLlJ1bGVTdGVwLnNjaGVkdWxlUnVsZSwKICAgICAgbmFtZTogcnVsZUkxOG4uU0NIRURVTEUsCiAgICAgIGNvbnRlbnQ6IF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuZGVmYXVsdC5GcmFnbWVudCwgbnVsbCwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTcGFjZXIsIG51bGwpLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfc3RlcF9wYW5lbC5TdGVwUGFuZWwsIHsKICAgICAgICBsb2FkaW5nOiBsb2FkaW5nIHx8IGluaXRMb2FkaW5nLAogICAgICAgIHRpdGxlOiBydWxlSTE4bi5TQ0hFRFVMRQogICAgICB9LCBteVNjaGVkdWxlUnVsZUZvcm0uZGF0YSAhPSBudWxsICYmIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9zdGVwX3NjaGVkdWxlX3J1bGUuU3RlcFNjaGVkdWxlUnVsZSwgewogICAgICAgIGlzUmVhZE9ubHlWaWV3OiBmYWxzZSwKICAgICAgICBpc0xvYWRpbmc6IGlzTG9hZGluZywKICAgICAgICBpc1VwZGF0ZVZpZXc6IHRydWUsCiAgICAgICAgZGVmYXVsdFZhbHVlczogbXlTY2hlZHVsZVJ1bGVGb3JtLmRhdGEsCiAgICAgICAgc2V0Rm9ybTogc2V0U3RlcHNGb3JtCiAgICAgIH0pLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgbnVsbCkpKQogICAgfV07CiAgfSwgW2xvYWRpbmcsIGluaXRMb2FkaW5nLCBpc0xvYWRpbmcsIG15QWJvdXRSdWxlRm9ybSwgbXlEZWZpbmVSdWxlRm9ybSwgbXlTY2hlZHVsZVJ1bGVGb3JtLCBzZXRTdGVwc0Zvcm0sIHN0ZXBzRm9ybV0pOwogIHZhciBvblN1Ym1pdCA9ICgwLCBfcmVhY3QyLnVzZUNhbGxiYWNrKShmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgdmFyIF9zdGVwc0Zvcm0kY3VycmVudCRhYzsKCiAgICB2YXIgYWN0aXZlRm9ybUlkLCBhY3RpdmVGb3JtLCBpbnZhbGlkRm9ybXM7CiAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmFzeW5jKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBhY3RpdmVGb3JtSWQgPSBzZWxlY3RlZFRhYiA9PT0gbnVsbCB8fCBzZWxlY3RlZFRhYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogc2VsZWN0ZWRUYWIuaWQ7CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzOwogICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKChfc3RlcHNGb3JtJGN1cnJlbnQkYWMgPSBzdGVwc0Zvcm0uY3VycmVudFthY3RpdmVGb3JtSWRdKSA9PT0gbnVsbCB8fCBfc3RlcHNGb3JtJGN1cnJlbnQkYWMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9zdGVwc0Zvcm0kY3VycmVudCRhYy5zdWJtaXQoKSk7CgogICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICBhY3RpdmVGb3JtID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgaW52YWxpZEZvcm1zID0gW190eXBlcy5SdWxlU3RlcC5hYm91dFJ1bGUsIF90eXBlcy5SdWxlU3RlcC5kZWZpbmVSdWxlLCBfdHlwZXMuUnVsZVN0ZXAuc2NoZWR1bGVSdWxlXS5yZWR1Y2UoZnVuY3Rpb24gKGFjYywgc3RlcCkgewogICAgICAgICAgICAgIGlmIChzdGVwID09PSBhY3RpdmVGb3JtSWQgJiYgYWN0aXZlRm9ybSAhPSBudWxsICYmICEoYWN0aXZlRm9ybSA9PT0gbnVsbCB8fCBhY3RpdmVGb3JtID09PSB2b2lkIDAgPyB2b2lkIDAgOiBhY3RpdmVGb3JtLmlzVmFsaWQpIHx8IHN0ZXAgPT09IF90eXBlcy5SdWxlU3RlcC5hYm91dFJ1bGUgJiYgIW15QWJvdXRSdWxlRm9ybS5pc1ZhbGlkIHx8IHN0ZXAgPT09IF90eXBlcy5SdWxlU3RlcC5kZWZpbmVSdWxlICYmICFteURlZmluZVJ1bGVGb3JtLmlzVmFsaWQgfHwgc3RlcCA9PT0gX3R5cGVzLlJ1bGVTdGVwLnNjaGVkdWxlUnVsZSAmJiAhbXlTY2hlZHVsZVJ1bGVGb3JtLmlzVmFsaWQpIHsKICAgICAgICAgICAgICAgIHJldHVybiBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KGFjYyksIFtzdGVwXSk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICByZXR1cm4gYWNjOwogICAgICAgICAgICB9LCBbXSk7CgogICAgICAgICAgICBpZiAoaW52YWxpZEZvcm1zLmxlbmd0aCA9PT0gMCAmJiBhY3RpdmVGb3JtICE9IG51bGwpIHsKICAgICAgICAgICAgICBzZXRUYWJIYXNFcnJvcihbXSk7CiAgICAgICAgICAgICAgc2V0UnVsZSgoMCwgX2hlbHBlcnMuZm9ybWF0UnVsZSkoYWN0aXZlRm9ybUlkID09PSBfdHlwZXMuUnVsZVN0ZXAuZGVmaW5lUnVsZSA/IGFjdGl2ZUZvcm0uZGF0YSA6IG15RGVmaW5lUnVsZUZvcm0uZGF0YSwgYWN0aXZlRm9ybUlkID09PSBfdHlwZXMuUnVsZVN0ZXAuYWJvdXRSdWxlID8gYWN0aXZlRm9ybS5kYXRhIDogbXlBYm91dFJ1bGVGb3JtLmRhdGEsIGFjdGl2ZUZvcm1JZCA9PT0gX3R5cGVzLlJ1bGVTdGVwLnNjaGVkdWxlUnVsZSA/IGFjdGl2ZUZvcm0uZGF0YSA6IG15U2NoZWR1bGVSdWxlRm9ybS5kYXRhLCBydWxlSWQpKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBzZXRUYWJIYXNFcnJvcihpbnZhbGlkRm9ybXMpOwogICAgICAgICAgICB9CgogICAgICAgICAgY2FzZSA2OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0pOwogIH0sIFtzdGVwc0Zvcm0sIG15QWJvdXRSdWxlRm9ybSwgbXlEZWZpbmVSdWxlRm9ybSwgbXlTY2hlZHVsZVJ1bGVGb3JtLCBzZWxlY3RlZFRhYiwgcnVsZUlkXSk7CiAgKDAsIF9yZWFjdDIudXNlRWZmZWN0KShmdW5jdGlvbiAoKSB7CiAgICBpZiAocnVsZSAhPSBudWxsKSB7CiAgICAgIHZhciBfZ2V0U3RlcHNEYXRhID0gKDAsIF9oZWxwZXJzMi5nZXRTdGVwc0RhdGEpKHsKICAgICAgICBydWxlOiBydWxlCiAgICAgIH0pLAogICAgICAgICAgYWJvdXRSdWxlRGF0YSA9IF9nZXRTdGVwc0RhdGEuYWJvdXRSdWxlRGF0YSwKICAgICAgICAgIGRlZmluZVJ1bGVEYXRhID0gX2dldFN0ZXBzRGF0YS5kZWZpbmVSdWxlRGF0YSwKICAgICAgICAgIHNjaGVkdWxlUnVsZURhdGEgPSBfZ2V0U3RlcHNEYXRhLnNjaGVkdWxlUnVsZURhdGE7CgogICAgICBzZXRNeUFib3V0UnVsZUZvcm0oewogICAgICAgIGRhdGE6IGFib3V0UnVsZURhdGEsCiAgICAgICAgaXNWYWxpZDogdHJ1ZQogICAgICB9KTsKICAgICAgc2V0TXlEZWZpbmVSdWxlRm9ybSh7CiAgICAgICAgZGF0YTogZGVmaW5lUnVsZURhdGEsCiAgICAgICAgaXNWYWxpZDogdHJ1ZQogICAgICB9KTsKICAgICAgc2V0TXlTY2hlZHVsZVJ1bGVGb3JtKHsKICAgICAgICBkYXRhOiBzY2hlZHVsZVJ1bGVEYXRhLAogICAgICAgIGlzVmFsaWQ6IHRydWUKICAgICAgfSk7CiAgICB9CiAgfSwgW3J1bGVdKTsKICB2YXIgb25UYWJDbGljayA9ICgwLCBfcmVhY3QyLnVzZUNhbGxiYWNrKShmdW5jdGlvbiBfY2FsbGVlMih0YWIpIHsKICAgIHZhciBfc3RlcHNGb3JtJGN1cnJlbnQkcnUsIHJ1bGVTdGVwLCByZXNwRm9ybTsKCiAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmFzeW5jKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgaWYgKCEoc2VsZWN0ZWRUYWIgIT0gbnVsbCkpIHsKICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDY7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJ1bGVTdGVwID0gc2VsZWN0ZWRUYWIuaWQ7CiAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNDsKICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hd3JhcCgoX3N0ZXBzRm9ybSRjdXJyZW50JHJ1ID0gc3RlcHNGb3JtLmN1cnJlbnRbcnVsZVN0ZXBdKSA9PT0gbnVsbCB8fCBfc3RlcHNGb3JtJGN1cnJlbnQkcnUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9zdGVwc0Zvcm0kY3VycmVudCRydS5zdWJtaXQoKSk7CgogICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICByZXNwRm9ybSA9IF9jb250ZXh0Mi5zZW50OwoKICAgICAgICAgICAgaWYgKHJlc3BGb3JtICE9IG51bGwpIHsKICAgICAgICAgICAgICBpZiAocnVsZVN0ZXAgPT09IF90eXBlcy5SdWxlU3RlcC5hYm91dFJ1bGUpIHsKICAgICAgICAgICAgICAgIHNldE15QWJvdXRSdWxlRm9ybSh7CiAgICAgICAgICAgICAgICAgIGRhdGE6IHJlc3BGb3JtLmRhdGEsCiAgICAgICAgICAgICAgICAgIGlzVmFsaWQ6IHJlc3BGb3JtLmlzVmFsaWQKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0gZWxzZSBpZiAocnVsZVN0ZXAgPT09IF90eXBlcy5SdWxlU3RlcC5kZWZpbmVSdWxlKSB7CiAgICAgICAgICAgICAgICBzZXRNeURlZmluZVJ1bGVGb3JtKHsKICAgICAgICAgICAgICAgICAgZGF0YTogcmVzcEZvcm0uZGF0YSwKICAgICAgICAgICAgICAgICAgaXNWYWxpZDogcmVzcEZvcm0uaXNWYWxpZAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfSBlbHNlIGlmIChydWxlU3RlcCA9PT0gX3R5cGVzLlJ1bGVTdGVwLnNjaGVkdWxlUnVsZSkgewogICAgICAgICAgICAgICAgc2V0TXlTY2hlZHVsZVJ1bGVGb3JtKHsKICAgICAgICAgICAgICAgICAgZGF0YTogcmVzcEZvcm0uZGF0YSwKICAgICAgICAgICAgICAgICAgaXNWYWxpZDogcmVzcEZvcm0uaXNWYWxpZAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICBzZXRJbml0Rm9ybSh0cnVlKTsKICAgICAgICAgICAgc2V0U2VsZWN0ZWRUYWIodGFiKTsKCiAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0pOwogIH0sIFtzZWxlY3RlZFRhYiwgc3RlcHNGb3JtLmN1cnJlbnRdKTsKICAoMCwgX3JlYWN0Mi51c2VFZmZlY3QpKGZ1bmN0aW9uICgpIHsKICAgIGlmIChydWxlICE9IG51bGwpIHsKICAgICAgdmFyIF9nZXRTdGVwc0RhdGEyID0gKDAsIF9oZWxwZXJzMi5nZXRTdGVwc0RhdGEpKHsKICAgICAgICBydWxlOiBydWxlCiAgICAgIH0pLAogICAgICAgICAgYWJvdXRSdWxlRGF0YSA9IF9nZXRTdGVwc0RhdGEyLmFib3V0UnVsZURhdGEsCiAgICAgICAgICBkZWZpbmVSdWxlRGF0YSA9IF9nZXRTdGVwc0RhdGEyLmRlZmluZVJ1bGVEYXRhLAogICAgICAgICAgc2NoZWR1bGVSdWxlRGF0YSA9IF9nZXRTdGVwc0RhdGEyLnNjaGVkdWxlUnVsZURhdGE7CgogICAgICBzZXRNeUFib3V0UnVsZUZvcm0oewogICAgICAgIGRhdGE6IGFib3V0UnVsZURhdGEsCiAgICAgICAgaXNWYWxpZDogdHJ1ZQogICAgICB9KTsKICAgICAgc2V0TXlEZWZpbmVSdWxlRm9ybSh7CiAgICAgICAgZGF0YTogZGVmaW5lUnVsZURhdGEsCiAgICAgICAgaXNWYWxpZDogdHJ1ZQogICAgICB9KTsKICAgICAgc2V0TXlTY2hlZHVsZVJ1bGVGb3JtKHsKICAgICAgICBkYXRhOiBzY2hlZHVsZVJ1bGVEYXRhLAogICAgICAgIGlzVmFsaWQ6IHRydWUKICAgICAgfSk7CiAgICB9CiAgfSwgW3J1bGVdKTsKICAoMCwgX3JlYWN0Mi51c2VFZmZlY3QpKGZ1bmN0aW9uICgpIHsKICAgIHNldFNlbGVjdGVkVGFiKHRhYnNbMF0pOwogIH0sIFtdKTsKCiAgaWYgKGlzU2F2ZWQgfHwgcnVsZSAhPSBudWxsICYmIHJ1bGUuaW1tdXRhYmxlKSB7CiAgICB2YXIgX3JlZjsKCiAgICAoMCwgX3RvYXN0ZXJzLmRpc3BsYXlTdWNjZXNzVG9hc3QpKGkxOG4uU1VDQ0VTU0ZVTExZX1NBVkVEX1JVTEUoKF9yZWYgPSBydWxlID09PSBudWxsIHx8IHJ1bGUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHJ1bGUubmFtZSkgIT09IG51bGwgJiYgX3JlZiAhPT0gdm9pZCAwID8gX3JlZiA6ICcnKSwgZGlzcGF0Y2hUb2FzdGVyKTsKICAgIHJldHVybiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3RSb3V0ZXJEb20uUmVkaXJlY3QsIHsKICAgICAgdG86ICIvIi5jb25jYXQoX3JlZGlyZWN0X3RvX2RldGVjdGlvbl9lbmdpbmUuREVURUNUSU9OX0VOR0lORV9QQUdFX05BTUUsICIvcnVsZXMvaWQvIikuY29uY2F0KHJ1bGVJZCkKICAgIH0pOwogIH0KCiAgaWYgKCgwLCBfaGVscGVyczIucmVkaXJlY3RUb0RldGVjdGlvbnMpKGlzU2lnbmFsSW5kZXhFeGlzdHMsIGlzQXV0aGVudGljYXRlZCwgaGFzRW5jcnlwdGlvbktleSkpIHsKICAgIHJldHVybiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3RSb3V0ZXJEb20uUmVkaXJlY3QsIHsKICAgICAgdG86ICIvIi5jb25jYXQoX3JlZGlyZWN0X3RvX2RldGVjdGlvbl9lbmdpbmUuREVURUNUSU9OX0VOR0lORV9QQUdFX05BTUUpCiAgICB9KTsKICB9IGVsc2UgaWYgKHVzZXJIYXNOb1Blcm1pc3Npb25zKSB7CiAgICByZXR1cm4gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Um91dGVyRG9tLlJlZGlyZWN0LCB7CiAgICAgIHRvOiAiLyIuY29uY2F0KF9yZWRpcmVjdF90b19kZXRlY3Rpb25fZW5naW5lLkRFVEVDVElPTl9FTkdJTkVfUEFHRV9OQU1FLCAiL3J1bGVzL2lkLyIpLmNvbmNhdChydWxlSWQpCiAgICB9KTsKICB9CgogIHJldHVybiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLmRlZmF1bHQuRnJhZ21lbnQsIG51bGwsIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF93cmFwcGVyX3BhZ2UuV3JhcHBlclBhZ2UsIHsKICAgIHJlc3RyaWN0V2lkdGg6IHRydWUKICB9LCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZGV0ZWN0aW9uX2VuZ2luZV9oZWFkZXJfcGFnZS5EZXRlY3Rpb25FbmdpbmVIZWFkZXJQYWdlLCB7CiAgICBiYWNrT3B0aW9uczogewogICAgICBocmVmOiAiIy8iLmNvbmNhdChfcmVkaXJlY3RfdG9fZGV0ZWN0aW9uX2VuZ2luZS5ERVRFQ1RJT05fRU5HSU5FX1BBR0VfTkFNRSwgIi9ydWxlcy9pZC8iKS5jb25jYXQocnVsZUlkKSwKICAgICAgdGV4dDogIiIuY29uY2F0KGkxOG4uQkFDS19UTywgIiAiKS5jb25jYXQoKF9yZWYyID0gcnVsZSA9PT0gbnVsbCB8fCBydWxlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBydWxlLm5hbWUpICE9PSBudWxsICYmIF9yZWYyICE9PSB2b2lkIDAgPyBfcmVmMiA6ICcnKQogICAgfSwKICAgIGlzTG9hZGluZzogaXNMb2FkaW5nLAogICAgdGl0bGU6IGkxOG4uUEFHRV9USVRMRQogIH0pLCB0YWJIYXNFcnJvci5sZW5ndGggPiAwICYmIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQ2FsbE91dCwgewogICAgdGl0bGU6IGkxOG4uU09SUllfRVJST1JTLAogICAgY29sb3I6ICJkYW5nZXIiLAogICAgaWNvblR5cGU6ICJhbGVydCIKICB9LCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgaWQ6ICJ4cGFjay5zaWVtLmRldGVjdGlvbkVuZ2luZS5ydWxlLmVkaXRSdWxlLmVycm9yTXNnRGVzY3JpcHRpb24iLAogICAgZGVmYXVsdE1lc3NhZ2U6ICJZb3UgaGF2ZSBhbiBpbnZhbGlkIGlucHV0IGluIHtjb3VudEVycm9yLCBwbHVyYWwsIG9uZSB7dGhpcyB0YWJ9IG90aGVyIHt0aGVzZSB0YWJzfX06IHt0YWJIYXNFcnJvcn0iLAogICAgdmFsdWVzOiB7CiAgICAgIGNvdW50RXJyb3I6IHRhYkhhc0Vycm9yLmxlbmd0aCwKICAgICAgdGFiSGFzRXJyb3I6IHRhYkhhc0Vycm9yLm1hcChmdW5jdGlvbiAodCkgewogICAgICAgIGlmICh0ID09PSBfdHlwZXMuUnVsZVN0ZXAuYWJvdXRSdWxlKSB7CiAgICAgICAgICByZXR1cm4gcnVsZUkxOG4uQUJPVVQ7CiAgICAgICAgfSBlbHNlIGlmICh0ID09PSBfdHlwZXMuUnVsZVN0ZXAuZGVmaW5lUnVsZSkgewogICAgICAgICAgcmV0dXJuIHJ1bGVJMThuLkRFRklOSVRJT047CiAgICAgICAgfSBlbHNlIGlmICh0ID09PSBfdHlwZXMuUnVsZVN0ZXAuc2NoZWR1bGVSdWxlKSB7CiAgICAgICAgICByZXR1cm4gcnVsZUkxOG4uU0NIRURVTEU7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdDsKICAgICAgfSkuam9pbignLCAnKQogICAgfQogIH0pKSwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUYWJiZWRDb250ZW50LCB7CiAgICBpbml0aWFsU2VsZWN0ZWRUYWI6IHRhYnNbMF0sCiAgICBzZWxlY3RlZFRhYjogdGFicy5maW5kKGZ1bmN0aW9uICh0KSB7CiAgICAgIHJldHVybiB0LmlkID09PSAoc2VsZWN0ZWRUYWIgPT09IG51bGwgfHwgc2VsZWN0ZWRUYWIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHNlbGVjdGVkVGFiLmlkKTsKICAgIH0pLAogICAgb25UYWJDbGljazogb25UYWJDbGljaywKICAgIHRhYnM6IHRhYnMKICB9KSwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTcGFjZXIsIG51bGwpLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhHcm91cCwgewogICAgYWxpZ25JdGVtczogImNlbnRlciIsCiAgICBndXR0ZXJTaXplOiAicyIsCiAgICBqdXN0aWZ5Q29udGVudDogImZsZXhFbmQiLAogICAgcmVzcG9uc2l2ZTogZmFsc2UKICB9LCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICBncm93OiBmYWxzZQogIH0sIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQnV0dG9uLCB7CiAgICBpY29uVHlwZTogImNyb3NzIiwKICAgIGhyZWY6ICIjLyIuY29uY2F0KF9yZWRpcmVjdF90b19kZXRlY3Rpb25fZW5naW5lLkRFVEVDVElPTl9FTkdJTkVfUEFHRV9OQU1FLCAiL3J1bGVzL2lkLyIpLmNvbmNhdChydWxlSWQpCiAgfSwgaTE4bi5DQU5DRUwpKSwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgZ3JvdzogZmFsc2UKICB9LCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUJ1dHRvbiwgewogICAgZmlsbDogdHJ1ZSwKICAgIG9uQ2xpY2s6IG9uU3VibWl0LAogICAgaWNvblR5cGU6ICJzYXZlIiwKICAgIGlzTG9hZGluZzogaXNMb2FkaW5nLAogICAgaXNEaXNhYmxlZDogaW5pdExvYWRpbmcKICB9LCBpMThuLlNBVkVfQ0hBTkdFUykpKSksIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9zcHlfcm91dGVzLlNweVJvdXRlLCB7CiAgICBzdGF0ZTogewogICAgICBydWxlTmFtZTogcnVsZSA9PT0gbnVsbCB8fCBydWxlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBydWxlLm5hbWUKICAgIH0KICB9KSk7Cn07Cgp2YXIgRWRpdFJ1bGVQYWdlID0gKDAsIF9yZWFjdDIubWVtbykoRWRpdFJ1bGVQYWdlQ29tcG9uZW50KTsKZXhwb3J0cy5FZGl0UnVsZVBhZ2UgPSBFZGl0UnVsZVBhZ2U7"},null]}