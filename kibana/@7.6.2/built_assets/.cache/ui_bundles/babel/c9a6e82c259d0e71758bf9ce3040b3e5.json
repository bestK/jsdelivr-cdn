{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/legacy/core_plugins/region_map/public/choropleth_layer.js","dependencies":[{"path":"src/legacy/core_plugins/region_map/public/choropleth_layer.js","mtime":1585205040003},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7Cgp2YXIgX2pxdWVyeSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgianF1ZXJ5IikpOwoKdmFyIF9sZWFmbGV0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJsZWFmbGV0IikpOwoKdmFyIF9sb2Rhc2ggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoImxvZGFzaCIpKTsKCnZhciBfZCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiZDMiKSk7Cgp2YXIgX2kxOG4gPSByZXF1aXJlKCJAa2JuL2kxOG4iKTsKCnZhciBfa2liYW5hX21hcF9sYXllciA9IHJlcXVpcmUoInVpL3Zpcy9tYXAva2liYW5hX21hcF9sYXllciIpOwoKdmFyIF90cnVuY2F0ZWRfY29sb3JtYXBzID0gcmVxdWlyZSgidWkvdmlzbGliL2NvbXBvbmVudHMvY29sb3IvdHJ1bmNhdGVkX2NvbG9ybWFwcyIpOwoKdmFyIHRvcG9qc29uID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgidG9wb2pzb24tY2xpZW50IikpOwoKdmFyIF9ub3RpZnkgPSByZXF1aXJlKCJ1aS9ub3RpZnkiKTsKCnZhciBjb2xvclV0aWwgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKCJ1aS92aXMvbWFwL2NvbG9yX3V0aWwiKSk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGVsc2UgeyB2YXIgbmV3T2JqID0ge307IGlmIChvYmogIT0gbnVsbCkgeyBmb3IgKHZhciBrZXkgaW4gb2JqKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7IHZhciBkZXNjID0gT2JqZWN0LmRlZmluZVByb3BlcnR5ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KSA6IHt9OyBpZiAoZGVzYy5nZXQgfHwgZGVzYy5zZXQpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5ld09iaiwga2V5LCBkZXNjKTsgfSBlbHNlIHsgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IH0gfSBuZXdPYmouZGVmYXVsdCA9IG9iajsgcmV0dXJuIG5ld09iajsgfSB9CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gInN5bWJvbCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKGNhbGwgJiYgKF90eXBlb2YoY2FsbCkgPT09ICJvYmplY3QiIHx8IHR5cGVvZiBjYWxsID09PSAiZnVuY3Rpb24iKSkgeyByZXR1cm4gY2FsbDsgfSByZXR1cm4gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKTsgfQoKZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7IGlmIChzZWxmID09PSB2b2lkIDApIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsgfSByZXR1cm4gc2VsZjsgfQoKZnVuY3Rpb24gX2dldCh0YXJnZXQsIHByb3BlcnR5LCByZWNlaXZlcikgeyBpZiAodHlwZW9mIFJlZmxlY3QgIT09ICJ1bmRlZmluZWQiICYmIFJlZmxlY3QuZ2V0KSB7IF9nZXQgPSBSZWZsZWN0LmdldDsgfSBlbHNlIHsgX2dldCA9IGZ1bmN0aW9uIF9nZXQodGFyZ2V0LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpIHsgdmFyIGJhc2UgPSBfc3VwZXJQcm9wQmFzZSh0YXJnZXQsIHByb3BlcnR5KTsgaWYgKCFiYXNlKSByZXR1cm47IHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihiYXNlLCBwcm9wZXJ0eSk7IGlmIChkZXNjLmdldCkgeyByZXR1cm4gZGVzYy5nZXQuY2FsbChyZWNlaXZlcik7IH0gcmV0dXJuIGRlc2MudmFsdWU7IH07IH0gcmV0dXJuIF9nZXQodGFyZ2V0LCBwcm9wZXJ0eSwgcmVjZWl2ZXIgfHwgdGFyZ2V0KTsgfQoKZnVuY3Rpb24gX3N1cGVyUHJvcEJhc2Uob2JqZWN0LCBwcm9wZXJ0eSkgeyB3aGlsZSAoIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KSkgeyBvYmplY3QgPSBfZ2V0UHJvdG90eXBlT2Yob2JqZWN0KTsgaWYgKG9iamVjdCA9PT0gbnVsbCkgYnJlYWs7IH0gcmV0dXJuIG9iamVjdDsgfQoKZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgX2dldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LmdldFByb3RvdHlwZU9mIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgcmV0dXJuIG8uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihvKTsgfTsgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsgfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0KCmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9CgpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAiZnVuY3Rpb24iICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24iKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBfc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpOyB9CgpmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgby5fX3Byb3RvX18gPSBwOyByZXR1cm4gbzsgfTsgcmV0dXJuIF9zZXRQcm90b3R5cGVPZihvLCBwKTsgfQoKdmFyIEVNUFRZX1NUWUxFID0gewogIHdlaWdodDogMSwKICBvcGFjaXR5OiAwLjYsCiAgY29sb3I6ICdyZ2IoMjAwLDIwMCwyMDApJywKICBmaWxsT3BhY2l0eTogMAp9OwoKdmFyIENob3JvcGxldGhMYXllciA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKF9LaWJhbmFNYXBMYXllcikgewogIF9pbmhlcml0cyhDaG9yb3BsZXRoTGF5ZXIsIF9LaWJhbmFNYXBMYXllcik7CgogIF9jcmVhdGVDbGFzcyhDaG9yb3BsZXRoTGF5ZXIsIG51bGwsIFt7CiAgICBrZXk6ICJfZG9Jbm5lckpvaW4iLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9kb0lubmVySm9pbihzb3J0ZWRNZXRyaWNzLCBzb3J0ZWRHZW9qc29uRmVhdHVyZXMsIGpvaW5GaWVsZCkgewogICAgICB2YXIgaiA9IDA7CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNvcnRlZEdlb2pzb25GZWF0dXJlcy5sZW5ndGg7IGkrKykgewogICAgICAgIHZhciBwcm9wZXJ0eSA9IHNvcnRlZEdlb2pzb25GZWF0dXJlc1tpXS5wcm9wZXJ0aWVzW2pvaW5GaWVsZF07CiAgICAgICAgc29ydGVkR2VvanNvbkZlYXR1cmVzW2ldLl9fa2JuSm9pbmVkTWV0cmljID0gbnVsbDsKICAgICAgICB2YXIgcG9zaXRpb24gPSBzb3J0ZWRNZXRyaWNzLmxlbmd0aCA/IGNvbXBhcmVMZXhpY29ncmFwaGljYWxseShwcm9wZXJ0eSwgc29ydGVkTWV0cmljc1tqXS50ZXJtKSA6IC0xOwoKICAgICAgICBpZiAocG9zaXRpb24gPT09IC0xKSB7Ly9qdXN0IG5lZWQgdG8gY3ljbGUgb24KICAgICAgICB9IGVsc2UgaWYgKHBvc2l0aW9uID09PSAwKSB7CiAgICAgICAgICBzb3J0ZWRHZW9qc29uRmVhdHVyZXNbaV0uX19rYm5Kb2luZWRNZXRyaWMgPSBzb3J0ZWRNZXRyaWNzW2pdOwogICAgICAgIH0gZWxzZSBpZiAocG9zaXRpb24gPT09IDEpIHsKICAgICAgICAgIC8vbmVlZHMgdG8gY2F0Y2ggdXAKICAgICAgICAgIHdoaWxlIChqIDwgc29ydGVkTWV0cmljcy5sZW5ndGgpIHsKICAgICAgICAgICAgdmFyIG5ld1Rlcm0gPSBzb3J0ZWRNZXRyaWNzW2pdLnRlcm07CiAgICAgICAgICAgIHZhciBuZXdQb3NpdGlvbiA9IGNvbXBhcmVMZXhpY29ncmFwaGljYWxseShuZXdUZXJtLCBwcm9wZXJ0eSk7CgogICAgICAgICAgICBpZiAobmV3UG9zaXRpb24gPT09IC0xKSB7Ly9ub3QgZmFyIGVub3VnaAogICAgICAgICAgICB9IGVsc2UgaWYgKG5ld1Bvc2l0aW9uID09PSAwKSB7CiAgICAgICAgICAgICAgc29ydGVkR2VvanNvbkZlYXR1cmVzW2ldLl9fa2JuSm9pbmVkTWV0cmljID0gc29ydGVkTWV0cmljc1tqXTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfSBlbHNlIGlmIChuZXdQb3NpdGlvbiA9PT0gMSkgewogICAgICAgICAgICAgIC8vdG9vIGZhciEKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGogPT09IHNvcnRlZE1ldHJpY3MubGVuZ3RoIC0gMSkgewogICAgICAgICAgICAgIC8vYWx3YXlzIGtlZXAgYSByZWZlcmVuY2UgdG8gdGhlIGxhc3QgbWV0cmljCiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgaisrOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfV0pOwoKICBmdW5jdGlvbiBDaG9yb3BsZXRoTGF5ZXIobmFtZSwgYXR0cmlidXRpb24sIGZvcm1hdCwgc2hvd0FsbFNoYXBlcywgbWV0YSwgbGF5ZXJDb25maWcsIHNlcnZpY2VTZXR0aW5ncykgewogICAgdmFyIF90aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBDaG9yb3BsZXRoTGF5ZXIpOwoKICAgIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgX2dldFByb3RvdHlwZU9mKENob3JvcGxldGhMYXllcikuY2FsbCh0aGlzKSk7CiAgICBfdGhpcy5fc2VydmljZVNldHRpbmdzID0gc2VydmljZVNldHRpbmdzOwogICAgX3RoaXMuX21ldHJpY3MgPSBudWxsOwogICAgX3RoaXMuX2pvaW5GaWVsZCA9IG51bGw7CiAgICBfdGhpcy5fY29sb3JSYW1wID0gX3RydW5jYXRlZF9jb2xvcm1hcHMudHJ1bmNhdGVkQ29sb3JNYXBzW09iamVjdC5rZXlzKF90cnVuY2F0ZWRfY29sb3JtYXBzLnRydW5jYXRlZENvbG9yTWFwcylbMF1dLnZhbHVlOwogICAgX3RoaXMuX2xpbmVXZWlnaHQgPSAxOwoKICAgIF90aGlzLl90b29sdGlwRm9ybWF0dGVyID0gZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gJyc7CiAgICB9OwoKICAgIF90aGlzLl9hdHRyaWJ1dGlvbiA9IGF0dHJpYnV0aW9uOwogICAgX3RoaXMuX2JvdW5kc09mRGF0YSA9IG51bGw7CiAgICBfdGhpcy5fc2hvd0FsbFNoYXBlcyA9IHNob3dBbGxTaGFwZXM7CiAgICBfdGhpcy5fbGF5ZXJOYW1lID0gbmFtZTsKICAgIF90aGlzLl9sYXllckNvbmZpZyA9IGxheWVyQ29uZmlnOwogICAgX3RoaXMuX2xlYWZsZXRMYXllciA9IF9sZWFmbGV0LmRlZmF1bHQuZ2VvSnNvbihudWxsLCB7CiAgICAgIG9uRWFjaEZlYXR1cmU6IGZ1bmN0aW9uIG9uRWFjaEZlYXR1cmUoZmVhdHVyZSwgbGF5ZXIpIHsKICAgICAgICBsYXllci5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpcy5lbWl0KCdzZWxlY3QnLCBmZWF0dXJlLnByb3BlcnRpZXNbX3RoaXMuX2pvaW5GaWVsZF0pOwogICAgICAgIH0pOwogICAgICAgIHZhciBsb2NhdGlvbiA9IG51bGw7CiAgICAgICAgbGF5ZXIub24oewogICAgICAgICAgbW91c2VvdmVyOiBmdW5jdGlvbiBtb3VzZW92ZXIoKSB7CiAgICAgICAgICAgIHZhciB0b29sdGlwQ29udGVudHMgPSBfdGhpcy5fdG9vbHRpcEZvcm1hdHRlcihmZWF0dXJlKTsKCiAgICAgICAgICAgIGlmICghbG9jYXRpb24pIHsKICAgICAgICAgICAgICB2YXIgbGVhZmxldEdlb2pzb24gPSBfbGVhZmxldC5kZWZhdWx0Lmdlb0pzb24oZmVhdHVyZSk7CgogICAgICAgICAgICAgIGxvY2F0aW9uID0gbGVhZmxldEdlb2pzb24uZ2V0Qm91bmRzKCkuZ2V0Q2VudGVyKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIF90aGlzLmVtaXQoJ3Nob3dUb29sdGlwJywgewogICAgICAgICAgICAgIGNvbnRlbnQ6IHRvb2x0aXBDb250ZW50cywKICAgICAgICAgICAgICBwb3NpdGlvbjogbG9jYXRpb24KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9LAogICAgICAgICAgbW91c2VvdXQ6IGZ1bmN0aW9uIG1vdXNlb3V0KCkgewogICAgICAgICAgICBfdGhpcy5lbWl0KCdoaWRlVG9vbHRpcCcpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9LAogICAgICBzdHlsZTogX3RoaXMuX21ha2VFbXB0eVN0eWxlRnVuY3Rpb24oKQogICAgfSk7CiAgICBfdGhpcy5fbG9hZGVkID0gZmFsc2U7CiAgICBfdGhpcy5fZXJyb3IgPSBmYWxzZTsKICAgIF90aGlzLl9pc0pvaW5WYWxpZCA9IGZhbHNlOwogICAgX3RoaXMuX3doZW5EYXRhTG9hZGVkID0gbmV3IFByb21pc2UoZnVuY3Rpb24gX2NhbGxlZShyZXNvbHZlKSB7CiAgICAgIHZhciBkYXRhLCBmZWF0dXJlQ29sbGVjdGlvbiwgZm9ybWF0VHlwZSwgZmVhdHVyZXMsIGVycm9yTWVzc2FnZTsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hc3luYyhmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMDsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMzsKICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKF90aGlzLl9tYWtlSnNvbkFqYXhDYWxsKCkpOwoKICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgIGRhdGEgPSBfY29udGV4dC5zZW50OwoKICAgICAgICAgICAgICBpZiAodHlwZW9mIGZvcm1hdCA9PT0gJ3N0cmluZycpIHsKICAgICAgICAgICAgICAgIGZvcm1hdFR5cGUgPSBmb3JtYXQ7CiAgICAgICAgICAgICAgfSBlbHNlIGlmIChmb3JtYXQgJiYgZm9ybWF0LnR5cGUpIHsKICAgICAgICAgICAgICAgIGZvcm1hdFR5cGUgPSBmb3JtYXQudHlwZTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgZm9ybWF0VHlwZSA9ICdnZW9qc29uJzsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGlmICghKGZvcm1hdFR5cGUgPT09ICdnZW9qc29uJykpIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA5OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBmZWF0dXJlQ29sbGVjdGlvbiA9IGRhdGE7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE1OwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgIGlmICghKGZvcm1hdFR5cGUgPT09ICd0b3BvanNvbicpKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTQ7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGZlYXR1cmVzID0gX2xvZGFzaC5kZWZhdWx0LmdldChkYXRhLCAnb2JqZWN0cy4nICsgbWV0YS5mZWF0dXJlX2NvbGxlY3Rpb25fcGF0aCk7CiAgICAgICAgICAgICAgZmVhdHVyZUNvbGxlY3Rpb24gPSB0b3BvanNvbi5mZWF0dXJlKGRhdGEsIGZlYXR1cmVzKTsgLy9jb252ZXJzaW9uIHRvIGdlb2pzb24KCiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE1OwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3JlZ2lvbk1hcC5jaG9yb3BsZXRoTGF5ZXIudW5yZWNvZ25pemVkRm9ybWF0RXJyb3JNZXNzYWdlJywgewogICAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdVbnJlY29nbml6ZWQgZm9ybWF0IHtmb3JtYXRUeXBlfScsCiAgICAgICAgICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgICAgICAgICAgZm9ybWF0VHlwZTogZm9ybWF0VHlwZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgIGNhc2UgMTU6CiAgICAgICAgICAgICAgX3RoaXMuX3NvcnRlZEZlYXR1cmVzID0gZmVhdHVyZUNvbGxlY3Rpb24uZmVhdHVyZXMuc2xpY2UoKTsKCiAgICAgICAgICAgICAgX3RoaXMuX3NvcnRGZWF0dXJlcygpOwoKICAgICAgICAgICAgICBpZiAoc2hvd0FsbFNoYXBlcykgewogICAgICAgICAgICAgICAgX3RoaXMuX2xlYWZsZXRMYXllci5hZGREYXRhKGZlYXR1cmVDb2xsZWN0aW9uKTsKICAgICAgICAgICAgICB9IGVsc2Ugey8vd2UgbmVlZCB0byBkZWxheSBhZGRpbmcgdGhlIGRhdGEgdW50aWwgd2UgaGF2ZSBwZXJmb3JtZWQgdGhlIGpvaW4gYW5kIGtub3cgd2hpY2ggZmVhdHVyZXMKICAgICAgICAgICAgICAgIC8vc2hvdWxkIGJlIGRpc3BsYXllZAogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgX3RoaXMuX2xvYWRlZCA9IHRydWU7CgogICAgICAgICAgICAgIF90aGlzLl9zZXRTdHlsZSgpOwoKICAgICAgICAgICAgICByZXNvbHZlKCk7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDMwOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAyMzoKICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMjM7CiAgICAgICAgICAgICAgX2NvbnRleHQudDAgPSBfY29udGV4dFsiY2F0Y2giXSgwKTsKICAgICAgICAgICAgICBfdGhpcy5fbG9hZGVkID0gdHJ1ZTsKICAgICAgICAgICAgICBfdGhpcy5fZXJyb3IgPSB0cnVlOwoKICAgICAgICAgICAgICBpZiAoX2NvbnRleHQudDAuc3RhdHVzID09PSA0MDQpIHsKICAgICAgICAgICAgICAgIGVycm9yTWVzc2FnZSA9IF9pMThuLmkxOG4udHJhbnNsYXRlKCdyZWdpb25NYXAuY2hvcm9wbGV0aExheWVyLmRvd25sb2FkaW5nVmVjdG9yRGF0YTQwNEVycm9yTWVzc2FnZScsIHsKICAgICAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJTZXJ2ZXIgcmVzcG9uZGluZyB3aXRoICc0MDQnIHdoZW4gYXR0ZW1wdGluZyB0byBmZXRjaCB7bmFtZX0uIFwKTWFrZSBzdXJlIHRoZSBmaWxlIGV4aXN0cyBhdCB0aGF0IGxvY2F0aW9uLiIsCiAgICAgICAgICAgICAgICAgIHZhbHVlczogewogICAgICAgICAgICAgICAgICAgIG5hbWU6IG5hbWUKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGVycm9yTWVzc2FnZSA9IF9pMThuLmkxOG4udHJhbnNsYXRlKCdyZWdpb25NYXAuY2hvcm9wbGV0aExheWVyLmRvd25sb2FkaW5nVmVjdG9yRGF0YUVycm9yTWVzc2FnZScsIHsKICAgICAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdDYW5ub3QgZG93bmxvYWQge25hbWV9IGZpbGUuIFBsZWFzZSBlbnN1cmUgdGhlIFwKQ09SUyBjb25maWd1cmF0aW9uIG9mIHRoZSBzZXJ2ZXIgcGVybWl0cyByZXF1ZXN0cyBmcm9tIHRoZSBLaWJhbmEgYXBwbGljYXRpb24gb24gdGhpcyBob3N0LicsCiAgICAgICAgICAgICAgICAgIHZhbHVlczogewogICAgICAgICAgICAgICAgICAgIG5hbWU6IG5hbWUKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBfbm90aWZ5LnRvYXN0Tm90aWZpY2F0aW9ucy5hZGREYW5nZXIoewogICAgICAgICAgICAgICAgdGl0bGU6IF9pMThuLmkxOG4udHJhbnNsYXRlKCdyZWdpb25NYXAuY2hvcm9wbGV0aExheWVyLmRvd25sb2FkaW5nVmVjdG9yRGF0YUVycm9yTWVzc2FnZVRpdGxlJywgewogICAgICAgICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0Vycm9yIGRvd25sb2FkaW5nIHZlY3RvciBkYXRhJwogICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgICB0ZXh0OiBlcnJvck1lc3NhZ2UKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgcmVzb2x2ZSgpOwoKICAgICAgICAgICAgY2FzZSAzMDoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgbnVsbCwgbnVsbCwgW1swLCAyM11dKTsKICAgIH0pOwogICAgcmV0dXJuIF90aGlzOwogIH0gLy9UaGlzIG1ldGhvZCBpcyBzdHViYmVkIGluIHRoZSB0ZXN0cyB0byBhdm9pZCBuZXR3b3JrIHJlcXVlc3QgZHVyaW5nIHVuaXQgdGVzdHMuCgoKICBfY3JlYXRlQ2xhc3MoQ2hvcm9wbGV0aExheWVyLCBbewogICAga2V5OiAiX21ha2VKc29uQWpheENhbGwiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9tYWtlSnNvbkFqYXhDYWxsKCkgewogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmFzeW5jKGZ1bmN0aW9uIF9tYWtlSnNvbkFqYXhDYWxsJChfY29udGV4dDIpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIiwgdGhpcy5fc2VydmljZVNldHRpbmdzLmdldEpzb25Gb3JSZWdpb25MYXllcih0aGlzLl9sYXllckNvbmZpZykpOwoKICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgbnVsbCwgdGhpcyk7CiAgICB9CiAgfSwgewogICAga2V5OiAiX2ludmFsaWRhdGVKb2luIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfaW52YWxpZGF0ZUpvaW4oKSB7CiAgICAgIHRoaXMuX2lzSm9pblZhbGlkID0gZmFsc2U7CiAgICB9CiAgfSwgewogICAga2V5OiAiX2RvSW5uZXJKb2luIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfZG9Jbm5lckpvaW4oKSB7CiAgICAgIENob3JvcGxldGhMYXllci5fZG9Jbm5lckpvaW4odGhpcy5fbWV0cmljcywgdGhpcy5fc29ydGVkRmVhdHVyZXMsIHRoaXMuX2pvaW5GaWVsZCk7CgogICAgICB0aGlzLl9pc0pvaW5WYWxpZCA9IHRydWU7CiAgICB9CiAgfSwgewogICAga2V5OiAiX3NldFN0eWxlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfc2V0U3R5bGUoKSB7CiAgICAgIGlmICh0aGlzLl9lcnJvciB8fCAhdGhpcy5fbG9hZGVkIHx8ICF0aGlzLl9tZXRyaWNzIHx8ICF0aGlzLl9qb2luRmllbGQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICghdGhpcy5faXNKb2luVmFsaWQpIHsKICAgICAgICB0aGlzLl9kb0lubmVySm9pbigpOwoKICAgICAgICBpZiAoIXRoaXMuX3Nob3dBbGxTaGFwZXMpIHsKICAgICAgICAgIHZhciBfZmVhdHVyZUNvbGxlY3Rpb24gPSB7CiAgICAgICAgICAgIHR5cGU6ICdGZWF0dXJlQ29sbGVjdGlvbicsCiAgICAgICAgICAgIGZlYXR1cmVzOiB0aGlzLl9zb3J0ZWRGZWF0dXJlcy5maWx0ZXIoZnVuY3Rpb24gKGZlYXR1cmUpIHsKICAgICAgICAgICAgICByZXR1cm4gZmVhdHVyZS5fX2tibkpvaW5lZE1ldHJpYzsKICAgICAgICAgICAgfSkKICAgICAgICAgIH07CgogICAgICAgICAgdGhpcy5fbGVhZmxldExheWVyLmFkZERhdGEoX2ZlYXR1cmVDb2xsZWN0aW9uKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHZhciBzdHlsZXIgPSB0aGlzLl9tYWtlQ2hvcm9wbGV0aFN0eWxlcigpOwoKICAgICAgdGhpcy5fbGVhZmxldExheWVyLnNldFN0eWxlKHN0eWxlci5sZWFmbGV0U3R5bGVGdW5jdGlvbik7CgogICAgICBpZiAodGhpcy5fbWV0cmljcyAmJiB0aGlzLl9tZXRyaWNzLmxlbmd0aCA+IDApIHsKICAgICAgICB2YXIgX2dldE1pbk1heCA9IGdldE1pbk1heCh0aGlzLl9tZXRyaWNzKSwKICAgICAgICAgICAgbWluID0gX2dldE1pbk1heC5taW4sCiAgICAgICAgICAgIG1heCA9IF9nZXRNaW5NYXgubWF4OwoKICAgICAgICB0aGlzLl9sZWdlbmRDb2xvcnMgPSBjb2xvclV0aWwuZ2V0TGVnZW5kQ29sb3JzKHRoaXMuX2NvbG9yUmFtcCk7CiAgICAgICAgdmFyIHF1YW50aXplRG9tYWluID0gbWluICE9PSBtYXggPyBbbWluLCBtYXhdIDogX2QuZGVmYXVsdC5zY2FsZS5xdWFudGl6ZSgpLmRvbWFpbigpOwogICAgICAgIHRoaXMuX2xlZ2VuZFF1YW50aXplciA9IF9kLmRlZmF1bHQuc2NhbGUucXVhbnRpemUoKS5kb21haW4ocXVhbnRpemVEb21haW4pLnJhbmdlKHRoaXMuX2xlZ2VuZENvbG9ycyk7CiAgICAgIH0KCiAgICAgIHRoaXMuX2JvdW5kc09mRGF0YSA9IHN0eWxlci5nZXRMZWFmbGV0Qm91bmRzKCk7CiAgICAgIHRoaXMuZW1pdCgnc3R5bGVDaGFuZ2VkJywgewogICAgICAgIG1pc21hdGNoZXM6IHN0eWxlci5nZXRNaXNtYXRjaGVzKCkKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0VXJsIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRVcmwoKSB7CiAgICAgIHJldHVybiB0aGlzLl9sYXllck5hbWU7CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0VG9vbHRpcEZvcm1hdHRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0VG9vbHRpcEZvcm1hdHRlcih0b29sdGlwRm9ybWF0dGVyLCBmaWVsZEZvcm1hdHRlciwgZmllbGROYW1lLCBtZXRyaWNMYWJlbCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHRoaXMuX3Rvb2x0aXBGb3JtYXR0ZXIgPSBmdW5jdGlvbiAoZ2VvanNvbkZlYXR1cmUpIHsKICAgICAgICBpZiAoIV90aGlzMi5fbWV0cmljcykgewogICAgICAgICAgcmV0dXJuICcnOwogICAgICAgIH0KCiAgICAgICAgdmFyIG1hdGNoID0gX3RoaXMyLl9tZXRyaWNzLmZpbmQoZnVuY3Rpb24gKGJ1Y2tldCkgewogICAgICAgICAgcmV0dXJuIGNvbXBhcmVMZXhpY29ncmFwaGljYWxseShidWNrZXQudGVybSwgZ2VvanNvbkZlYXR1cmUucHJvcGVydGllc1tfdGhpczIuX2pvaW5GaWVsZF0pID09PSAwOwogICAgICAgIH0pOwoKICAgICAgICByZXR1cm4gdG9vbHRpcEZvcm1hdHRlcihtYXRjaCwgZmllbGRGb3JtYXR0ZXIsIGZpZWxkTmFtZSwgbWV0cmljTGFiZWwpOwogICAgICB9OwogICAgfQogIH0sIHsKICAgIGtleTogInNldEpvaW5GaWVsZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0Sm9pbkZpZWxkKGpvaW5maWVsZCkgewogICAgICBpZiAoam9pbmZpZWxkID09PSB0aGlzLl9qb2luRmllbGQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoaXMuX2pvaW5GaWVsZCA9IGpvaW5maWVsZDsKCiAgICAgIHRoaXMuX3NvcnRGZWF0dXJlcygpOwoKICAgICAgdGhpcy5fc2V0U3R5bGUoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjbG9uZUNob3JvcGxldGhMYXllckZvck5ld0RhdGEiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNsb25lQ2hvcm9wbGV0aExheWVyRm9yTmV3RGF0YShuYW1lLCBhdHRyaWJ1dGlvbiwgZm9ybWF0LCBzaG93QWxsRGF0YSwgbWV0YSwgbGF5ZXJDb25maWcsIHNlcnZpY2VTZXR0aW5ncykgewogICAgICB2YXIgY2xvbmVkTGF5ZXIgPSBuZXcgQ2hvcm9wbGV0aExheWVyKG5hbWUsIGF0dHJpYnV0aW9uLCBmb3JtYXQsIHNob3dBbGxEYXRhLCBtZXRhLCBsYXllckNvbmZpZywgc2VydmljZVNldHRpbmdzKTsKICAgICAgY2xvbmVkTGF5ZXIuc2V0Sm9pbkZpZWxkKHRoaXMuX2pvaW5GaWVsZCk7CiAgICAgIGNsb25lZExheWVyLnNldENvbG9yUmFtcCh0aGlzLl9jb2xvclJhbXApOwogICAgICBjbG9uZWRMYXllci5zZXRMaW5lV2VpZ2h0KHRoaXMuX2xpbmVXZWlnaHQpOwogICAgICBjbG9uZWRMYXllci5zZXRUb29sdGlwRm9ybWF0dGVyKHRoaXMuX3Rvb2x0aXBGb3JtYXR0ZXIpOwoKICAgICAgaWYgKHRoaXMuX21ldHJpY3MpIHsKICAgICAgICBjbG9uZWRMYXllci5zZXRNZXRyaWNzKHRoaXMuX21ldHJpY3MsIHRoaXMuX3ZhbHVlRm9ybWF0dGVyLCB0aGlzLl9tZXRyaWNUaXRsZSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBjbG9uZWRMYXllcjsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfc29ydEZlYXR1cmVzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfc29ydEZlYXR1cmVzKCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIGlmICh0aGlzLl9zb3J0ZWRGZWF0dXJlcyAmJiB0aGlzLl9qb2luRmllbGQpIHsKICAgICAgICB0aGlzLl9zb3J0ZWRGZWF0dXJlcy5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgICAgICB2YXIgdGVybUEgPSBhLnByb3BlcnRpZXNbX3RoaXMzLl9qb2luRmllbGRdOwogICAgICAgICAgdmFyIHRlcm1CID0gYi5wcm9wZXJ0aWVzW190aGlzMy5fam9pbkZpZWxkXTsKICAgICAgICAgIHJldHVybiBjb21wYXJlTGV4aWNvZ3JhcGhpY2FsbHkodGVybUEsIHRlcm1CKTsKICAgICAgICB9KTsKCiAgICAgICAgdGhpcy5faW52YWxpZGF0ZUpvaW4oKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogIndoZW5EYXRhTG9hZGVkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB3aGVuRGF0YUxvYWRlZCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX3doZW5EYXRhTG9hZGVkOwogICAgfQogIH0sIHsKICAgIGtleTogInNldE1ldHJpY3MiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldE1ldHJpY3MobWV0cmljcywgZmllbGRGb3JtYXR0ZXIsIG1ldHJpY1RpdGxlKSB7CiAgICAgIHRoaXMuX21ldHJpY3MgPSBtZXRyaWNzLnNsaWNlKCk7CiAgICAgIHRoaXMuX3ZhbHVlRm9ybWF0dGVyID0gZmllbGRGb3JtYXR0ZXI7CiAgICAgIHRoaXMuX21ldHJpY1RpdGxlID0gbWV0cmljVGl0bGU7CgogICAgICB0aGlzLl9tZXRyaWNzLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgICByZXR1cm4gY29tcGFyZUxleGljb2dyYXBoaWNhbGx5KGEudGVybSwgYi50ZXJtKTsKICAgICAgfSk7CgogICAgICB0aGlzLl9pbnZhbGlkYXRlSm9pbigpOwoKICAgICAgdGhpcy5fc2V0U3R5bGUoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRDb2xvclJhbXAiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldENvbG9yUmFtcChjb2xvclJhbXApIHsKICAgICAgaWYgKF9sb2Rhc2guZGVmYXVsdC5pc0VxdWFsKGNvbG9yUmFtcCwgdGhpcy5fY29sb3JSYW1wKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy5fY29sb3JSYW1wID0gY29sb3JSYW1wOwoKICAgICAgdGhpcy5fc2V0U3R5bGUoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRMaW5lV2VpZ2h0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRMaW5lV2VpZ2h0KGxpbmVXZWlnaHQpIHsKICAgICAgaWYgKHRoaXMuX2xpbmVXZWlnaHQgPT09IGxpbmVXZWlnaHQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoaXMuX2xpbmVXZWlnaHQgPSBsaW5lV2VpZ2h0OwoKICAgICAgdGhpcy5fc2V0U3R5bGUoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjYW5SZXVzZUluc3RhbmNlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjYW5SZXVzZUluc3RhbmNlKG5hbWUsIHNob3dBbGxTaGFwZXMpIHsKICAgICAgcmV0dXJuIHRoaXMuX2xheWVyTmFtZSA9PT0gbmFtZSAmJiB0aGlzLl9zaG93QWxsU2hhcGVzID09PSBzaG93QWxsU2hhcGVzOwogICAgfQogIH0sIHsKICAgIGtleTogImNhblJldXNlSW5zdGFuY2VGb3JOZXdNZXRyaWNzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjYW5SZXVzZUluc3RhbmNlRm9yTmV3TWV0cmljcyhuYW1lLCBzaG93QWxsU2hhcGVzLCBuZXdNZXRyaWNzKSB7CiAgICAgIGlmICh0aGlzLl9sYXllck5hbWUgIT09IG5hbWUpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIGlmIChzaG93QWxsU2hhcGVzKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuX3Nob3dBbGxTaGFwZXMgPT09IHNob3dBbGxTaGFwZXM7CiAgICAgIH0KCiAgICAgIGlmICghdGhpcy5fbWV0cmljcykgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIGN1cnJlbnRLZXlzID0gT2JqZWN0LmtleXModGhpcy5fbWV0cmljcyk7CiAgICAgIHZhciBuZXdLZXlzID0gT2JqZWN0LmtleXMobmV3TWV0cmljcyk7CiAgICAgIHJldHVybiBfbG9kYXNoLmRlZmF1bHQuaXNFcXVhbChjdXJyZW50S2V5cywgbmV3S2V5cyk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0Qm91bmRzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRCb3VuZHMoKSB7CiAgICAgIHZhciBib3VuZHMgPSBfZ2V0KF9nZXRQcm90b3R5cGVPZihDaG9yb3BsZXRoTGF5ZXIucHJvdG90eXBlKSwgImdldEJvdW5kcyIsIHRoaXMpLmNhbGwodGhpcyk7CgogICAgICByZXR1cm4gdGhpcy5fYm91bmRzT2ZEYXRhID8gdGhpcy5fYm91bmRzT2ZEYXRhIDogYm91bmRzOwogICAgfQogIH0sIHsKICAgIGtleTogImFwcGVuZExlZ2VuZENvbnRlbnRzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBhcHBlbmRMZWdlbmRDb250ZW50cyhqcXVlcnlEaXYpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgICBpZiAoIXRoaXMuX2xlZ2VuZENvbG9ycyB8fCAhdGhpcy5fbGVnZW5kUXVhbnRpemVyKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgdGl0bGVUZXh0ID0gdGhpcy5fbWV0cmljVGl0bGU7CiAgICAgIHZhciAkdGl0bGUgPSAoMCwgX2pxdWVyeS5kZWZhdWx0KSgnPGRpdj4nKS5hZGRDbGFzcygndmlzTWFwTGVnZW5kX190aXRsZScpLnRleHQodGl0bGVUZXh0KTsKICAgICAganF1ZXJ5RGl2LmFwcGVuZCgkdGl0bGUpOwoKICAgICAgdGhpcy5fbGVnZW5kQ29sb3JzLmZvckVhY2goZnVuY3Rpb24gKGNvbG9yKSB7CiAgICAgICAgdmFyIGxhYmVsVGV4dCA9IF90aGlzNC5fbGVnZW5kUXVhbnRpemVyLmludmVydEV4dGVudChjb2xvcikubWFwKGZ1bmN0aW9uICh2YWwpIHsKICAgICAgICAgIHJldHVybiBfdGhpczQuX3ZhbHVlRm9ybWF0dGVyLmNvbnZlcnQodmFsKTsKICAgICAgICB9KS5qb2luKCcg4oCTwqAnKTsKCiAgICAgICAgdmFyIGxhYmVsID0gKDAsIF9qcXVlcnkuZGVmYXVsdCkoJzxkaXY+Jyk7CiAgICAgICAgdmFyIGljb24gPSAoMCwgX2pxdWVyeS5kZWZhdWx0KSgnPGk+JykuY3NzKHsKICAgICAgICAgIGJhY2tncm91bmQ6IGNvbG9yLAogICAgICAgICAgJ2JvcmRlci1jb2xvcic6IG1ha2VDb2xvckRhcmtlcihjb2xvcikKICAgICAgICB9KTsKICAgICAgICB2YXIgdGV4dCA9ICgwLCBfanF1ZXJ5LmRlZmF1bHQpKCc8c3Bhbj4nKS50ZXh0KGxhYmVsVGV4dCk7CiAgICAgICAgbGFiZWwuYXBwZW5kKGljb24pOwogICAgICAgIGxhYmVsLmFwcGVuZCh0ZXh0KTsKICAgICAgICBqcXVlcnlEaXYuYXBwZW5kKGxhYmVsKTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiX21ha2VFbXB0eVN0eWxlRnVuY3Rpb24iLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9tYWtlRW1wdHlTdHlsZUZ1bmN0aW9uKCkgewogICAgICB2YXIgZW1wdHlTdHlsZSA9IF9sb2Rhc2guZGVmYXVsdC5hc3NpZ24oe30sIEVNUFRZX1NUWUxFLCB7CiAgICAgICAgd2VpZ2h0OiB0aGlzLl9saW5lV2VpZ2h0CiAgICAgIH0pOwoKICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gZW1wdHlTdHlsZTsKICAgICAgfTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfbWFrZUNob3JvcGxldGhTdHlsZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9tYWtlQ2hvcm9wbGV0aFN0eWxlcigpIHsKICAgICAgdmFyIF90aGlzNSA9IHRoaXM7CgogICAgICB2YXIgZW1wdHlTdHlsZSA9IHRoaXMuX21ha2VFbXB0eVN0eWxlRnVuY3Rpb24oKTsKCiAgICAgIGlmICh0aGlzLl9tZXRyaWNzLmxlbmd0aCA9PT0gMCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICBsZWFmbGV0U3R5bGVGdW5jdGlvbjogZnVuY3Rpb24gbGVhZmxldFN0eWxlRnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHJldHVybiBlbXB0eVN0eWxlKCk7CiAgICAgICAgICB9LAogICAgICAgICAgZ2V0TWlzbWF0Y2hlczogZnVuY3Rpb24gZ2V0TWlzbWF0Y2hlcygpIHsKICAgICAgICAgICAgcmV0dXJuIFtdOwogICAgICAgICAgfSwKICAgICAgICAgIGdldExlYWZsZXRCb3VuZHM6IGZ1bmN0aW9uIGdldExlYWZsZXRCb3VuZHMoKSB7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgfQogICAgICAgIH07CiAgICAgIH0KCiAgICAgIHZhciBfZ2V0TWluTWF4MiA9IGdldE1pbk1heCh0aGlzLl9tZXRyaWNzKSwKICAgICAgICAgIG1pbiA9IF9nZXRNaW5NYXgyLm1pbiwKICAgICAgICAgIG1heCA9IF9nZXRNaW5NYXgyLm1heDsKCiAgICAgIHZhciBib3VuZHNPZkFsbEZlYXR1cmVzID0gbmV3IF9sZWFmbGV0LmRlZmF1bHQuTGF0TG5nQm91bmRzKCk7CiAgICAgIHJldHVybiB7CiAgICAgICAgbGVhZmxldFN0eWxlRnVuY3Rpb246IGZ1bmN0aW9uIGxlYWZsZXRTdHlsZUZ1bmN0aW9uKGdlb2pzb25GZWF0dXJlKSB7CiAgICAgICAgICB2YXIgbWF0Y2ggPSBnZW9qc29uRmVhdHVyZS5fX2tibkpvaW5lZE1ldHJpYzsKCiAgICAgICAgICBpZiAoIW1hdGNoKSB7CiAgICAgICAgICAgIHJldHVybiBlbXB0eVN0eWxlKCk7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIGJvdW5kc09mRmVhdHVyZSA9IF9sZWFmbGV0LmRlZmF1bHQuZ2VvSnNvbihnZW9qc29uRmVhdHVyZSkuZ2V0Qm91bmRzKCk7CgogICAgICAgICAgYm91bmRzT2ZBbGxGZWF0dXJlcy5leHRlbmQoYm91bmRzT2ZGZWF0dXJlKTsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGZpbGxDb2xvcjogZ2V0Q2hvcm9wbGV0aENvbG9yKG1hdGNoLnZhbHVlLCBtaW4sIG1heCwgX3RoaXM1Ll9jb2xvclJhbXApLAogICAgICAgICAgICB3ZWlnaHQ6IF90aGlzNS5fbGluZVdlaWdodCwKICAgICAgICAgICAgb3BhY2l0eTogMSwKICAgICAgICAgICAgY29sb3I6ICd3aGl0ZScsCiAgICAgICAgICAgIGZpbGxPcGFjaXR5OiAwLjcKICAgICAgICAgIH07CiAgICAgICAgfSwKCiAgICAgICAgLyoqCiAgICAgICAgICogc2hvdWxkIG5vdCBiZSBjYWxsZWQgdW50aWwgZ2V0TGVhZmxldFN0eWxlRnVuY3Rpb24gaGFzIGJlZW4gY2FsbGVkCiAgICAgICAgICogQHJldHVybiB7QXJyYXl9CiAgICAgICAgICovCiAgICAgICAgZ2V0TWlzbWF0Y2hlczogZnVuY3Rpb24gZ2V0TWlzbWF0Y2hlcygpIHsKICAgICAgICAgIHZhciBtaXNtYXRjaGVzID0gX3RoaXM1Ll9tZXRyaWNzLnNsaWNlKCk7CgogICAgICAgICAgX3RoaXM1Ll9zb3J0ZWRGZWF0dXJlcy5mb3JFYWNoKGZ1bmN0aW9uIChmZWF0dXJlKSB7CiAgICAgICAgICAgIHZhciBpbmRleCA9IG1pc21hdGNoZXMuaW5kZXhPZihmZWF0dXJlLl9fa2JuSm9pbmVkTWV0cmljKTsKCiAgICAgICAgICAgIGlmIChpbmRleCA+PSAwKSB7CiAgICAgICAgICAgICAgbWlzbWF0Y2hlcy5zcGxpY2UoaW5kZXgsIDEpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKCiAgICAgICAgICByZXR1cm4gbWlzbWF0Y2hlcy5tYXAoZnVuY3Rpb24gKGIpIHsKICAgICAgICAgICAgcmV0dXJuIGIudGVybTsKICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgZ2V0TGVhZmxldEJvdW5kczogZnVuY3Rpb24gZ2V0TGVhZmxldEJvdW5kcygpIHsKICAgICAgICAgIHJldHVybiBib3VuZHNPZkFsbEZlYXR1cmVzLmlzVmFsaWQoKSA/IGJvdW5kc09mQWxsRmVhdHVyZXMgOiBudWxsOwogICAgICAgIH0KICAgICAgfTsKICAgIH0KICB9XSk7CgogIHJldHVybiBDaG9yb3BsZXRoTGF5ZXI7Cn0oX2tpYmFuYV9tYXBfbGF5ZXIuS2liYW5hTWFwTGF5ZXIpOyAvL2xleGljb2dyYXBoaWMgY29tcGFyZQoKCmV4cG9ydHMuZGVmYXVsdCA9IENob3JvcGxldGhMYXllcjsKCmZ1bmN0aW9uIGNvbXBhcmVMZXhpY29ncmFwaGljYWxseSh0ZXJtQSwgdGVybUIpIHsKICB0ZXJtQSA9IHR5cGVvZiB0ZXJtQSA9PT0gJ3N0cmluZycgPyB0ZXJtQSA6IHRlcm1BLnRvU3RyaW5nKCk7CiAgdGVybUIgPSB0eXBlb2YgdGVybUIgPT09ICdzdHJpbmcnID8gdGVybUIgOiB0ZXJtQi50b1N0cmluZygpOwogIHJldHVybiB0ZXJtQS5sb2NhbGVDb21wYXJlKHRlcm1CKTsKfQoKZnVuY3Rpb24gbWFrZUNvbG9yRGFya2VyKGNvbG9yKSB7CiAgdmFyIGFtb3VudCA9IDEuMzsgLy9tYWdpYyBudW1iZXIsIGNhcnJ5IG92ZXIgZnJvbSBlYXJsaWVyCgogIHJldHVybiBfZC5kZWZhdWx0LmhjbChjb2xvcikuZGFya2VyKGFtb3VudCkudG9TdHJpbmcoKTsKfQoKZnVuY3Rpb24gZ2V0TWluTWF4KGRhdGEpIHsKICB2YXIgbWluID0gZGF0YVswXS52YWx1ZTsKICB2YXIgbWF4ID0gZGF0YVswXS52YWx1ZTsKCiAgZm9yICh2YXIgaSA9IDE7IGkgPCBkYXRhLmxlbmd0aDsgaSArPSAxKSB7CiAgICBtaW4gPSBNYXRoLm1pbihkYXRhW2ldLnZhbHVlLCBtaW4pOwogICAgbWF4ID0gTWF0aC5tYXgoZGF0YVtpXS52YWx1ZSwgbWF4KTsKICB9CgogIHJldHVybiB7CiAgICBtaW46IG1pbiwKICAgIG1heDogbWF4CiAgfTsKfQoKZnVuY3Rpb24gZ2V0Q2hvcm9wbGV0aENvbG9yKHZhbHVlLCBtaW4sIG1heCwgY29sb3JSYW1wKSB7CiAgaWYgKG1pbiA9PT0gbWF4KSB7CiAgICByZXR1cm4gY29sb3JVdGlsLmdldENvbG9yKGNvbG9yUmFtcCwgY29sb3JSYW1wLmxlbmd0aCAtIDEpOwogIH0KCiAgdmFyIGZyYWN0aW9uID0gKHZhbHVlIC0gbWluKSAvIChtYXggLSBtaW4pOwogIHZhciBpbmRleCA9IE1hdGgucm91bmQoY29sb3JSYW1wLmxlbmd0aCAqIGZyYWN0aW9uKSAtIDE7CiAgdmFyIGkgPSBNYXRoLm1heChNYXRoLm1pbihjb2xvclJhbXAubGVuZ3RoIC0gMSwgaW5kZXgpLCAwKTsKICByZXR1cm4gY29sb3JVdGlsLmdldENvbG9yKGNvbG9yUmFtcCwgaSk7Cn0KCm1vZHVsZS5leHBvcnRzID0gZXhwb3J0cy5kZWZhdWx0Ow=="},null]}