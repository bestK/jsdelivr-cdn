{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/siem/public/pages/detection_engine/rules/details/index.js","dependencies":[{"path":"x-pack/legacy/plugins/siem/public/pages/detection_engine/rules/details/index.js","mtime":1585205047887},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLlJ1bGVEZXRhaWxzUGFnZSA9IHZvaWQgMDsKCnZhciBfZXVpID0gcmVxdWlyZSgiQGVsYXN0aWMvZXVpIik7Cgp2YXIgX3JlYWN0ID0gcmVxdWlyZSgiQGtibi9pMThuL3JlYWN0Iik7Cgp2YXIgX3JlYWN0MiA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoInJlYWN0IikpOwoKdmFyIF9yZWFjdFJvdXRlckRvbSA9IHJlcXVpcmUoInJlYWN0LXJvdXRlci1kb20iKTsKCnZhciBfcmVhY3RTdGlja3kgPSByZXF1aXJlKCJyZWFjdC1zdGlja3kiKTsKCnZhciBfcmVhY3RSZWR1eCA9IHJlcXVpcmUoInJlYWN0LXJlZHV4Iik7Cgp2YXIgX2ZpbHRlcnNfZ2xvYmFsID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vY29tcG9uZW50cy9maWx0ZXJzX2dsb2JhbCIpOwoKdmFyIF9mb3JtYXR0ZWRfZGF0ZSA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL2NvbXBvbmVudHMvZm9ybWF0dGVkX2RhdGUiKTsKCnZhciBfcmVkaXJlY3RfdG9fZGV0ZWN0aW9uX2VuZ2luZSA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL2NvbXBvbmVudHMvbGlua190by9yZWRpcmVjdF90b19kZXRlY3Rpb25fZW5naW5lIik7Cgp2YXIgX3NlYXJjaF9iYXIgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9jb21wb25lbnRzL3NlYXJjaF9iYXIiKTsKCnZhciBfd3JhcHBlcl9wYWdlID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vY29tcG9uZW50cy93cmFwcGVyX3BhZ2UiKTsKCnZhciBfcnVsZXMgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9jb250YWluZXJzL2RldGVjdGlvbl9lbmdpbmUvcnVsZXMiKTsKCnZhciBfc291cmNlID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vY29udGFpbmVycy9zb3VyY2UiKTsKCnZhciBfc3B5X3JvdXRlcyA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL3V0aWxzL3JvdXRlL3NweV9yb3V0ZXMiKTsKCnZhciBfZGV0ZWN0aW9uX2VuZ2luZV9oZWFkZXJfcGFnZSA9IHJlcXVpcmUoIi4uLy4uL2NvbXBvbmVudHMvZGV0ZWN0aW9uX2VuZ2luZV9oZWFkZXJfcGFnZSIpOwoKdmFyIF9zaWduYWxzX2hpc3RvZ3JhbV9wYW5lbCA9IHJlcXVpcmUoIi4uLy4uL2NvbXBvbmVudHMvc2lnbmFsc19oaXN0b2dyYW1fcGFuZWwiKTsKCnZhciBfc2lnbmFscyA9IHJlcXVpcmUoIi4uLy4uL2NvbXBvbmVudHMvc2lnbmFscyIpOwoKdmFyIF91c2VyX2luZm8gPSByZXF1aXJlKCIuLi8uLi9jb21wb25lbnRzL3VzZXJfaW5mbyIpOwoKdmFyIF9kZXRlY3Rpb25fZW5naW5lX2VtcHR5X3BhZ2UgPSByZXF1aXJlKCIuLi8uLi9kZXRlY3Rpb25fZW5naW5lX2VtcHR5X3BhZ2UiKTsKCnZhciBfc2lnbmFsc19pbmZvID0gcmVxdWlyZSgiLi4vLi4vY29tcG9uZW50cy9zaWduYWxzX2luZm8iKTsKCnZhciBfc3RlcF9hYm91dF9ydWxlID0gcmVxdWlyZSgiLi4vY29tcG9uZW50cy9zdGVwX2Fib3V0X3J1bGUiKTsKCnZhciBfc3RlcF9kZWZpbmVfcnVsZSA9IHJlcXVpcmUoIi4uL2NvbXBvbmVudHMvc3RlcF9kZWZpbmVfcnVsZSIpOwoKdmFyIF9zdGVwX3NjaGVkdWxlX3J1bGUgPSByZXF1aXJlKCIuLi9jb21wb25lbnRzL3N0ZXBfc2NoZWR1bGVfcnVsZSIpOwoKdmFyIF9kZWZhdWx0X2NvbmZpZyA9IHJlcXVpcmUoIi4uLy4uL2NvbXBvbmVudHMvc2lnbmFscy9kZWZhdWx0X2NvbmZpZyIpOwoKdmFyIF9ub193cml0ZV9zaWduYWxzX2NhbGxvdXQgPSByZXF1aXJlKCIuLi8uLi9jb21wb25lbnRzL25vX3dyaXRlX3NpZ25hbHNfY2FsbG91dCIpOwoKdmFyIGRldGVjdGlvbkkxOG4gPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKCIuLi8uLi90cmFuc2xhdGlvbnMiKSk7Cgp2YXIgX3JlYWRfb25seV9jYWxsb3V0ID0gcmVxdWlyZSgiLi4vY29tcG9uZW50cy9yZWFkX29ubHlfY2FsbG91dCIpOwoKdmFyIF9ydWxlX3N3aXRjaCA9IHJlcXVpcmUoIi4uL2NvbXBvbmVudHMvcnVsZV9zd2l0Y2giKTsKCnZhciBfc3RlcF9wYW5lbCA9IHJlcXVpcmUoIi4uL2NvbXBvbmVudHMvc3RlcF9wYW5lbCIpOwoKdmFyIF9oZWxwZXJzID0gcmVxdWlyZSgiLi4vaGVscGVycyIpOwoKdmFyIHJ1bGVJMThuID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgiLi4vdHJhbnNsYXRpb25zIikpOwoKdmFyIGkxOG4gPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKCIuL3RyYW5zbGF0aW9ucyIpKTsKCnZhciBfZ2xvYmFsX3RpbWUgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9jb250YWluZXJzL2dsb2JhbF90aW1lIik7Cgp2YXIgX2NvbmZpZyA9IHJlcXVpcmUoIi4uLy4uL2NvbXBvbmVudHMvc2lnbmFsc19oaXN0b2dyYW1fcGFuZWwvY29uZmlnIik7Cgp2YXIgX2lucHV0cyA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL3N0b3JlL2lucHV0cyIpOwoKdmFyIF9hY3Rpb25zID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vc3RvcmUvaW5wdXRzL2FjdGlvbnMiKTsKCnZhciBfcnVsZV9hY3Rpb25zX292ZXJmbG93ID0gcmVxdWlyZSgiLi4vY29tcG9uZW50cy9ydWxlX2FjdGlvbnNfb3ZlcmZsb3ciKTsKCnZhciBfc3RhdHVzX2ZhaWxlZF9jYWxsb3V0ID0gcmVxdWlyZSgiLi9zdGF0dXNfZmFpbGVkX2NhbGxvdXQiKTsKCnZhciBfZmFpbHVyZV9oaXN0b3J5ID0gcmVxdWlyZSgiLi9mYWlsdXJlX2hpc3RvcnkiKTsKCnZhciBfcnVsZV9zdGF0dXMgPSByZXF1aXJlKCIuLi9jb21wb25lbnRzL3J1bGVfc3RhdHVzIik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsKICBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7CiAgICByZXR1cm4gb2JqOwogIH0gZWxzZSB7CiAgICB2YXIgbmV3T2JqID0ge307CgogICAgaWYgKG9iaiAhPSBudWxsKSB7CiAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHsKICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgewogICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvciA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpIDoge307CgogICAgICAgICAgaWYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSB7CiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmosIGtleSwgZGVzYyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBuZXdPYmpba2V5XSA9IG9ialtrZXldOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIG5ld09iai5kZWZhdWx0ID0gb2JqOwogICAgcmV0dXJuIG5ld09iajsKICB9Cn0KCmZ1bmN0aW9uIF90b0NvbnN1bWFibGVBcnJheShhcnIpIHsKICByZXR1cm4gX2FycmF5V2l0aG91dEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheShhcnIpIHx8IF9ub25JdGVyYWJsZVNwcmVhZCgpOwp9CgpmdW5jdGlvbiBfbm9uSXRlcmFibGVTcHJlYWQoKSB7CiAgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIHNwcmVhZCBub24taXRlcmFibGUgaW5zdGFuY2UiKTsKfQoKZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheShpdGVyKSB7CiAgaWYgKFN5bWJvbC5pdGVyYXRvciBpbiBPYmplY3QoaXRlcikgfHwgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGl0ZXIpID09PSAiW29iamVjdCBBcmd1bWVudHNdIikgcmV0dXJuIEFycmF5LmZyb20oaXRlcik7Cn0KCmZ1bmN0aW9uIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHsKICBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSB7CiAgICBmb3IgKHZhciBpID0gMCwgYXJyMiA9IG5ldyBBcnJheShhcnIubGVuZ3RoKTsgaSA8IGFyci5sZW5ndGg7IGkrKykgewogICAgICBhcnIyW2ldID0gYXJyW2ldOwogICAgfQoKICAgIHJldHVybiBhcnIyOwogIH0KfQoKZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7CiAgcmV0dXJuIF9hcnJheVdpdGhIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHx8IF9ub25JdGVyYWJsZVJlc3QoKTsKfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlUmVzdCgpIHsKICB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7Cn0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHsKICB2YXIgX2FyciA9IFtdOwogIHZhciBfbiA9IHRydWU7CiAgdmFyIF9kID0gZmFsc2U7CiAgdmFyIF9lID0gdW5kZWZpbmVkOwoKICB0cnkgewogICAgZm9yICh2YXIgX2kgPSBhcnJbU3ltYm9sLml0ZXJhdG9yXSgpLCBfczsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSkgewogICAgICBfYXJyLnB1c2goX3MudmFsdWUpOwoKICAgICAgaWYgKGkgJiYgX2Fyci5sZW5ndGggPT09IGkpIGJyZWFrOwogICAgfQogIH0gY2F0Y2ggKGVycikgewogICAgX2QgPSB0cnVlOwogICAgX2UgPSBlcnI7CiAgfSBmaW5hbGx5IHsKICAgIHRyeSB7CiAgICAgIGlmICghX24gJiYgX2lbInJldHVybiJdICE9IG51bGwpIF9pWyJyZXR1cm4iXSgpOwogICAgfSBmaW5hbGx5IHsKICAgICAgaWYgKF9kKSB0aHJvdyBfZTsKICAgIH0KICB9CgogIHJldHVybiBfYXJyOwp9CgpmdW5jdGlvbiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsKfQoKdmFyIFJ1bGVEZXRhaWxUYWJzOwoKKGZ1bmN0aW9uIChSdWxlRGV0YWlsVGFicykgewogIFJ1bGVEZXRhaWxUYWJzWyJzaWduYWxzIl0gPSAic2lnbmFscyI7CiAgUnVsZURldGFpbFRhYnNbImZhaWx1cmVzIl0gPSAiZmFpbHVyZXMiOwp9KShSdWxlRGV0YWlsVGFicyB8fCAoUnVsZURldGFpbFRhYnMgPSB7fSkpOwoKdmFyIHJ1bGVEZXRhaWxUYWJzID0gW3sKICBpZDogUnVsZURldGFpbFRhYnMuc2lnbmFscywKICBuYW1lOiBkZXRlY3Rpb25JMThuLlNJR05BTCwKICBkaXNhYmxlZDogZmFsc2UKfSwgewogIGlkOiBSdWxlRGV0YWlsVGFicy5mYWlsdXJlcywKICBuYW1lOiBpMThuLkZBSUxVUkVfSElTVE9SWV9UQUIsCiAgZGlzYWJsZWQ6IGZhbHNlCn1dOwoKdmFyIFJ1bGVEZXRhaWxzUGFnZUNvbXBvbmVudCA9IGZ1bmN0aW9uIFJ1bGVEZXRhaWxzUGFnZUNvbXBvbmVudChfcmVmKSB7CiAgdmFyIGZpbHRlcnMgPSBfcmVmLmZpbHRlcnMsCiAgICAgIHF1ZXJ5ID0gX3JlZi5xdWVyeSwKICAgICAgc2V0QWJzb2x1dGVSYW5nZURhdGVQaWNrZXIgPSBfcmVmLnNldEFic29sdXRlUmFuZ2VEYXRlUGlja2VyOwoKICB2YXIgX3VzZVVzZXJJbmZvID0gKDAsIF91c2VyX2luZm8udXNlVXNlckluZm8pKCksCiAgICAgIGxvYWRpbmcgPSBfdXNlVXNlckluZm8ubG9hZGluZywKICAgICAgaXNTaWduYWxJbmRleEV4aXN0cyA9IF91c2VVc2VySW5mby5pc1NpZ25hbEluZGV4RXhpc3RzLAogICAgICBpc0F1dGhlbnRpY2F0ZWQgPSBfdXNlVXNlckluZm8uaXNBdXRoZW50aWNhdGVkLAogICAgICBoYXNFbmNyeXB0aW9uS2V5ID0gX3VzZVVzZXJJbmZvLmhhc0VuY3J5cHRpb25LZXksCiAgICAgIGNhblVzZXJDUlVEID0gX3VzZVVzZXJJbmZvLmNhblVzZXJDUlVELAogICAgICBoYXNNYW5hZ2VBcGlLZXkgPSBfdXNlVXNlckluZm8uaGFzTWFuYWdlQXBpS2V5LAogICAgICBoYXNJbmRleFdyaXRlID0gX3VzZVVzZXJJbmZvLmhhc0luZGV4V3JpdGUsCiAgICAgIHNpZ25hbEluZGV4TmFtZSA9IF91c2VVc2VySW5mby5zaWduYWxJbmRleE5hbWU7CgogIHZhciBfdXNlUGFyYW1zID0gKDAsIF9yZWFjdFJvdXRlckRvbS51c2VQYXJhbXMpKCksCiAgICAgIHJ1bGVJZCA9IF91c2VQYXJhbXMuZGV0YWlsTmFtZTsKCiAgdmFyIF91c2VSdWxlID0gKDAsIF9ydWxlcy51c2VSdWxlKShydWxlSWQpLAogICAgICBfdXNlUnVsZTIgPSBfc2xpY2VkVG9BcnJheShfdXNlUnVsZSwgMiksCiAgICAgIGlzTG9hZGluZyA9IF91c2VSdWxlMlswXSwKICAgICAgcnVsZSA9IF91c2VSdWxlMlsxXTsgLy8gVGhpcyBpcyB1c2VkIHRvIHJlLXRyaWdnZXIgYXBpIHJ1bGUgc3RhdHVzIHdoZW4gdXNlciBkZS9hY3RpdmF0ZSBydWxlCgoKICB2YXIgX3VzZVN0YXRlID0gKDAsIF9yZWFjdDIudXNlU3RhdGUpKG51bGwpLAogICAgICBfdXNlU3RhdGUyID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlLCAyKSwKICAgICAgcnVsZUVuYWJsZWQgPSBfdXNlU3RhdGUyWzBdLAogICAgICBzZXRSdWxlRW5hYmxlZCA9IF91c2VTdGF0ZTJbMV07CgogIHZhciBfdXNlU3RhdGUzID0gKDAsIF9yZWFjdDIudXNlU3RhdGUpKFJ1bGVEZXRhaWxUYWJzLnNpZ25hbHMpLAogICAgICBfdXNlU3RhdGU0ID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlMywgMiksCiAgICAgIHJ1bGVEZXRhaWxUYWIgPSBfdXNlU3RhdGU0WzBdLAogICAgICBzZXRSdWxlRGV0YWlsVGFiID0gX3VzZVN0YXRlNFsxXTsKCiAgdmFyIF9yZWYyID0gcnVsZSAhPSBudWxsID8gKDAsIF9oZWxwZXJzLmdldFN0ZXBzRGF0YSkoewogICAgcnVsZTogcnVsZSwKICAgIGRldGFpbHNWaWV3OiB0cnVlCiAgfSkgOiB7CiAgICBhYm91dFJ1bGVEYXRhOiBudWxsLAogICAgZGVmaW5lUnVsZURhdGE6IG51bGwsCiAgICBzY2hlZHVsZVJ1bGVEYXRhOiBudWxsCiAgfSwKICAgICAgYWJvdXRSdWxlRGF0YSA9IF9yZWYyLmFib3V0UnVsZURhdGEsCiAgICAgIGRlZmluZVJ1bGVEYXRhID0gX3JlZjIuZGVmaW5lUnVsZURhdGEsCiAgICAgIHNjaGVkdWxlUnVsZURhdGEgPSBfcmVmMi5zY2hlZHVsZVJ1bGVEYXRhOwoKICB2YXIgX3VzZVNpZ25hbEluZm8gPSAoMCwgX3NpZ25hbHNfaW5mby51c2VTaWduYWxJbmZvKSh7CiAgICBydWxlSWQ6IHJ1bGVJZAogIH0pLAogICAgICBfdXNlU2lnbmFsSW5mbzIgPSBfc2xpY2VkVG9BcnJheShfdXNlU2lnbmFsSW5mbywgMSksCiAgICAgIGxhc3RTaWduYWxzID0gX3VzZVNpZ25hbEluZm8yWzBdOwoKICB2YXIgdXNlckhhc05vUGVybWlzc2lvbnMgPSBjYW5Vc2VyQ1JVRCAhPSBudWxsICYmIGhhc01hbmFnZUFwaUtleSAhPSBudWxsID8gIWNhblVzZXJDUlVEIHx8ICFoYXNNYW5hZ2VBcGlLZXkgOiBmYWxzZTsKICB2YXIgdGl0bGUgPSBpc0xvYWRpbmcgPT09IHRydWUgfHwgcnVsZSA9PT0gbnVsbCA/IF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpTG9hZGluZ1NwaW5uZXIsIHsKICAgIHNpemU6ICJtIgogIH0pIDogcnVsZS5uYW1lOwogIHZhciBzdWJUaXRsZSA9ICgwLCBfcmVhY3QyLnVzZU1lbW8pKGZ1bmN0aW9uICgpIHsKICAgIHZhciBfcmVmMywgX3JlZjQsIF9yZWY1LCBfcmVmNjsKCiAgICByZXR1cm4gaXNMb2FkaW5nID09PSB0cnVlIHx8IHJ1bGUgPT09IG51bGwgPyBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUxvYWRpbmdTcGlubmVyLCB7CiAgICAgIHNpemU6ICJtIgogICAgfSkgOiBbX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgaWQ6ICJ4cGFjay5zaWVtLmRldGVjdGlvbkVuZ2luZS5ydWxlRGV0YWlscy5ydWxlQ3JlYXRpb25EZXNjcmlwdGlvbiIsCiAgICAgIGRlZmF1bHRNZXNzYWdlOiAiQ3JlYXRlZCBieToge2J5fSBvbiB7ZGF0ZX0iLAogICAgICB2YWx1ZXM6IHsKICAgICAgICBieTogKF9yZWYzID0gcnVsZSA9PT0gbnVsbCB8fCBydWxlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBydWxlLmNyZWF0ZWRfYnkpICE9PSBudWxsICYmIF9yZWYzICE9PSB2b2lkIDAgPyBfcmVmMyA6IGkxOG4uVU5LTk9XTiwKICAgICAgICBkYXRlOiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZm9ybWF0dGVkX2RhdGUuRm9ybWF0dGVkRGF0ZSwgewogICAgICAgICAgdmFsdWU6IChfcmVmNCA9IHJ1bGUgPT09IG51bGwgfHwgcnVsZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogcnVsZS5jcmVhdGVkX2F0KSAhPT0gbnVsbCAmJiBfcmVmNCAhPT0gdm9pZCAwID8gX3JlZjQgOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksCiAgICAgICAgICBmaWVsZE5hbWU6ICJjcmVhdGVkQXQiCiAgICAgICAgfSkKICAgICAgfQogICAgfSksIChydWxlID09PSBudWxsIHx8IHJ1bGUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHJ1bGUudXBkYXRlZF9ieSkgIT0gbnVsbCA/IF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgIGlkOiAieHBhY2suc2llbS5kZXRlY3Rpb25FbmdpbmUucnVsZURldGFpbHMucnVsZVVwZGF0ZURlc2NyaXB0aW9uIiwKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJVcGRhdGVkIGJ5OiB7Ynl9IG9uIHtkYXRlfSIsCiAgICAgIHZhbHVlczogewogICAgICAgIGJ5OiAoX3JlZjUgPSBydWxlID09PSBudWxsIHx8IHJ1bGUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHJ1bGUudXBkYXRlZF9ieSkgIT09IG51bGwgJiYgX3JlZjUgIT09IHZvaWQgMCA/IF9yZWY1IDogaTE4bi5VTktOT1dOLAogICAgICAgIGRhdGU6IF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9mb3JtYXR0ZWRfZGF0ZS5Gb3JtYXR0ZWREYXRlLCB7CiAgICAgICAgICB2YWx1ZTogKF9yZWY2ID0gcnVsZSA9PT0gbnVsbCB8fCBydWxlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBydWxlLnVwZGF0ZWRfYXQpICE9PSBudWxsICYmIF9yZWY2ICE9PSB2b2lkIDAgPyBfcmVmNiA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSwKICAgICAgICAgIGZpZWxkTmFtZTogInVwZGF0ZWRBdCIKICAgICAgICB9KQogICAgICB9CiAgICB9KSA6ICcnXTsKICB9LCBbaXNMb2FkaW5nLCBydWxlXSk7CiAgdmFyIHNpZ25hbERlZmF1bHRGaWx0ZXJzID0gKDAsIF9yZWFjdDIudXNlTWVtbykoZnVuY3Rpb24gKCkgewogICAgcmV0dXJuIHJ1bGVJZCAhPSBudWxsID8gKDAsIF9kZWZhdWx0X2NvbmZpZy5idWlsZFNpZ25hbHNSdWxlSWRGaWx0ZXIpKHJ1bGVJZCkgOiBbXTsKICB9LCBbcnVsZUlkXSk7CiAgdmFyIHNpZ25hbE1lcmdlZEZpbHRlcnMgPSAoMCwgX3JlYWN0Mi51c2VNZW1vKShmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gW10uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShzaWduYWxEZWZhdWx0RmlsdGVycyksIF90b0NvbnN1bWFibGVBcnJheShmaWx0ZXJzKSk7CiAgfSwgW3NpZ25hbERlZmF1bHRGaWx0ZXJzLCBmaWx0ZXJzXSk7CiAgdmFyIHRhYnMgPSAoMCwgX3JlYWN0Mi51c2VNZW1vKShmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUYWJzLCBudWxsLCBydWxlRGV0YWlsVGFicy5tYXAoZnVuY3Rpb24gKHRhYikgewogICAgICByZXR1cm4gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUYWIsIHsKICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgcmV0dXJuIHNldFJ1bGVEZXRhaWxUYWIodGFiLmlkKTsKICAgICAgICB9LAogICAgICAgIGlzU2VsZWN0ZWQ6IHRhYi5pZCA9PT0gcnVsZURldGFpbFRhYiwKICAgICAgICBkaXNhYmxlZDogdGFiLmRpc2FibGVkLAogICAgICAgIGtleTogdGFiLmlkCiAgICAgIH0sIHRhYi5uYW1lKTsKICAgIH0pKTsKICB9LCBbcnVsZURldGFpbFRhYnMsIHJ1bGVEZXRhaWxUYWIsIHNldFJ1bGVEZXRhaWxUYWJdKTsKICB2YXIgcnVsZUVycm9yID0gKDAsIF9yZWFjdDIudXNlTWVtbykoZnVuY3Rpb24gKCkgewogICAgdmFyIF9yZWY3OwoKICAgIHJldHVybiAocnVsZSA9PT0gbnVsbCB8fCBydWxlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBydWxlLnN0YXR1cykgPT09ICdmYWlsZWQnICYmIHJ1bGVEZXRhaWxUYWIgPT09IFJ1bGVEZXRhaWxUYWJzLnNpZ25hbHMgJiYgKHJ1bGUgPT09IG51bGwgfHwgcnVsZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogcnVsZS5sYXN0X2ZhaWx1cmVfYXQpICE9IG51bGwgPyBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfc3RhdHVzX2ZhaWxlZF9jYWxsb3V0LlJ1bGVTdGF0dXNGYWlsZWRDYWxsT3V0LCB7CiAgICAgIG1lc3NhZ2U6IChfcmVmNyA9IHJ1bGUgPT09IG51bGwgfHwgcnVsZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogcnVsZS5sYXN0X2ZhaWx1cmVfbWVzc2FnZSkgIT09IG51bGwgJiYgX3JlZjcgIT09IHZvaWQgMCA/IF9yZWY3IDogJycsCiAgICAgIGRhdGU6IHJ1bGUgPT09IG51bGwgfHwgcnVsZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogcnVsZS5sYXN0X2ZhaWx1cmVfYXQKICAgIH0pIDogbnVsbDsKICB9LCBbcnVsZSwgcnVsZURldGFpbFRhYl0pOwogIHZhciBpbmRleFRvQWRkID0gKDAsIF9yZWFjdDIudXNlTWVtbykoZnVuY3Rpb24gKCkgewogICAgcmV0dXJuIHNpZ25hbEluZGV4TmFtZSA9PSBudWxsID8gW10gOiBbc2lnbmFsSW5kZXhOYW1lXTsKICB9LCBbc2lnbmFsSW5kZXhOYW1lXSk7CiAgdmFyIHVwZGF0ZURhdGVSYW5nZUNhbGxiYWNrID0gKDAsIF9yZWFjdDIudXNlQ2FsbGJhY2spKGZ1bmN0aW9uIChtaW4sIG1heCkgewogICAgc2V0QWJzb2x1dGVSYW5nZURhdGVQaWNrZXIoewogICAgICBpZDogJ2dsb2JhbCcsCiAgICAgIGZyb206IG1pbiwKICAgICAgdG86IG1heAogICAgfSk7CiAgfSwgW3NldEFic29sdXRlUmFuZ2VEYXRlUGlja2VyXSk7CiAgdmFyIGhhbmRsZU9uQ2hhbmdlRW5hYmxlZFJ1bGUgPSAoMCwgX3JlYWN0Mi51c2VDYWxsYmFjaykoZnVuY3Rpb24gKGVuYWJsZWQpIHsKICAgIGlmIChydWxlRW5hYmxlZCA9PSBudWxsIHx8IGVuYWJsZWQgIT09IHJ1bGVFbmFibGVkKSB7CiAgICAgIHNldFJ1bGVFbmFibGVkKGVuYWJsZWQpOwogICAgfQogIH0sIFtydWxlRW5hYmxlZCwgc2V0UnVsZUVuYWJsZWRdKTsKCiAgaWYgKCgwLCBfaGVscGVycy5yZWRpcmVjdFRvRGV0ZWN0aW9ucykoaXNTaWduYWxJbmRleEV4aXN0cywgaXNBdXRoZW50aWNhdGVkLCBoYXNFbmNyeXB0aW9uS2V5KSkgewogICAgcmV0dXJuIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdFJvdXRlckRvbS5SZWRpcmVjdCwgewogICAgICB0bzogIi8iLmNvbmNhdChfcmVkaXJlY3RfdG9fZGV0ZWN0aW9uX2VuZ2luZS5ERVRFQ1RJT05fRU5HSU5FX1BBR0VfTkFNRSkKICAgIH0pOwogIH0KCiAgcmV0dXJuIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuZGVmYXVsdC5GcmFnbWVudCwgbnVsbCwgaGFzSW5kZXhXcml0ZSAhPSBudWxsICYmICFoYXNJbmRleFdyaXRlICYmIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ub193cml0ZV9zaWduYWxzX2NhbGxvdXQuTm9Xcml0ZVNpZ25hbHNDYWxsT3V0LCBudWxsKSwgdXNlckhhc05vUGVybWlzc2lvbnMgJiYgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWRfb25seV9jYWxsb3V0LlJlYWRPbmx5Q2FsbE91dCwgbnVsbCksIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9zb3VyY2UuV2l0aFNvdXJjZSwgewogICAgc291cmNlSWQ6ICJkZWZhdWx0IiwKICAgIGluZGV4VG9BZGQ6IGluZGV4VG9BZGQKICB9LCBmdW5jdGlvbiAoX3JlZjgpIHsKICAgIHZhciBpbmRpY2VzRXhpc3QgPSBfcmVmOC5pbmRpY2VzRXhpc3QsCiAgICAgICAgaW5kZXhQYXR0ZXJuID0gX3JlZjguaW5kZXhQYXR0ZXJuOwogICAgcmV0dXJuICgwLCBfc291cmNlLmluZGljZXNFeGlzdE9yRGF0YVRlbXBvcmFyaWx5VW5hdmFpbGFibGUpKGluZGljZXNFeGlzdCkgPyBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZ2xvYmFsX3RpbWUuR2xvYmFsVGltZSwgbnVsbCwgZnVuY3Rpb24gKF9yZWY5KSB7CiAgICAgIHZhciBfcmVmMTAsIF9yZWYxMSwgX3JlZjEyOwoKICAgICAgdmFyIHRvID0gX3JlZjkudG8sCiAgICAgICAgICBmcm9tID0gX3JlZjkuZnJvbSwKICAgICAgICAgIGRlbGV0ZVF1ZXJ5ID0gX3JlZjkuZGVsZXRlUXVlcnksCiAgICAgICAgICBzZXRRdWVyeSA9IF9yZWY5LnNldFF1ZXJ5OwogICAgICByZXR1cm4gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0U3RpY2t5LlN0aWNreUNvbnRhaW5lciwgbnVsbCwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2ZpbHRlcnNfZ2xvYmFsLkZpbHRlcnNHbG9iYWwsIG51bGwsIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9zZWFyY2hfYmFyLlNpZW1TZWFyY2hCYXIsIHsKICAgICAgICBpZDogImdsb2JhbCIsCiAgICAgICAgaW5kZXhQYXR0ZXJuOiBpbmRleFBhdHRlcm4KICAgICAgfSkpLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfd3JhcHBlcl9wYWdlLldyYXBwZXJQYWdlLCBudWxsLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZGV0ZWN0aW9uX2VuZ2luZV9oZWFkZXJfcGFnZS5EZXRlY3Rpb25FbmdpbmVIZWFkZXJQYWdlLCB7CiAgICAgICAgYmFja09wdGlvbnM6IHsKICAgICAgICAgIGhyZWY6ICgwLCBfcmVkaXJlY3RfdG9fZGV0ZWN0aW9uX2VuZ2luZS5nZXRSdWxlc1VybCkoKSwKICAgICAgICAgIHRleHQ6IGkxOG4uQkFDS19UT19SVUxFUwogICAgICAgIH0sCiAgICAgICAgYm9yZGVyOiB0cnVlLAogICAgICAgIHN1YnRpdGxlOiBzdWJUaXRsZSwKICAgICAgICBzdWJ0aXRsZTI6IFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkobGFzdFNpZ25hbHMgIT0gbnVsbCA/IFtfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLmRlZmF1bHQuRnJhZ21lbnQsIG51bGwsIGRldGVjdGlvbkkxOG4uTEFTVF9TSUdOQUwsICc6ICcsIGxhc3RTaWduYWxzKV0gOiBbXSksIFtfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcnVsZV9zdGF0dXMuUnVsZVN0YXR1cywgewogICAgICAgICAgcnVsZUlkOiBydWxlSWQgIT09IG51bGwgJiYgcnVsZUlkICE9PSB2b2lkIDAgPyBydWxlSWQgOiBudWxsLAogICAgICAgICAgcnVsZUVuYWJsZWQ6IHJ1bGVFbmFibGVkCiAgICAgICAgfSldKSwKICAgICAgICB0aXRsZTogdGl0bGUKICAgICAgfSwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4R3JvdXAsIHsKICAgICAgICBhbGlnbkl0ZW1zOiAiY2VudGVyIgogICAgICB9LCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICAgICAgZ3JvdzogZmFsc2UKICAgICAgfSwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3J1bGVfc3dpdGNoLlJ1bGVTd2l0Y2gsIHsKICAgICAgICBpZDogKF9yZWYxMCA9IHJ1bGUgPT09IG51bGwgfHwgcnVsZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogcnVsZS5pZCkgIT09IG51bGwgJiYgX3JlZjEwICE9PSB2b2lkIDAgPyBfcmVmMTAgOiAnLTEnLAogICAgICAgIGlzRGlzYWJsZWQ6IHVzZXJIYXNOb1Blcm1pc3Npb25zLAogICAgICAgIGVuYWJsZWQ6IChfcmVmMTEgPSBydWxlID09PSBudWxsIHx8IHJ1bGUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHJ1bGUuZW5hYmxlZCkgIT09IG51bGwgJiYgX3JlZjExICE9PSB2b2lkIDAgPyBfcmVmMTEgOiBmYWxzZSwKICAgICAgICBvcHRpb25MYWJlbDogaTE4bi5BQ1RJVkFURV9SVUxFLAogICAgICAgIG9uQ2hhbmdlOiBoYW5kbGVPbkNoYW5nZUVuYWJsZWRSdWxlCiAgICAgIH0pKSwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgICAgIGdyb3c6IGZhbHNlCiAgICAgIH0sIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEdyb3VwLCB7CiAgICAgICAgYWxpZ25JdGVtczogImNlbnRlciIsCiAgICAgICAgZ3V0dGVyU2l6ZTogInMiLAogICAgICAgIHJlc3BvbnNpdmU6IGZhbHNlCiAgICAgIH0sIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgICAgICBncm93OiBmYWxzZQogICAgICB9LCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUJ1dHRvbiwgewogICAgICAgIGhyZWY6ICgwLCBfcmVkaXJlY3RfdG9fZGV0ZWN0aW9uX2VuZ2luZS5nZXRFZGl0UnVsZVVybCkocnVsZUlkICE9PSBudWxsICYmIHJ1bGVJZCAhPT0gdm9pZCAwID8gcnVsZUlkIDogJycpLAogICAgICAgIGljb25UeXBlOiAidmlzQ29udHJvbHMiLAogICAgICAgIGlzRGlzYWJsZWQ6IChfcmVmMTIgPSB1c2VySGFzTm9QZXJtaXNzaW9ucyB8fCAocnVsZSA9PT0gbnVsbCB8fCBydWxlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBydWxlLmltbXV0YWJsZSkpICE9PSBudWxsICYmIF9yZWYxMiAhPT0gdm9pZCAwID8gX3JlZjEyIDogdHJ1ZQogICAgICB9LCBydWxlSTE4bi5FRElUX1JVTEVfU0VUVElOR1MpKSwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgICAgIGdyb3c6IGZhbHNlCiAgICAgIH0sIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ydWxlX2FjdGlvbnNfb3ZlcmZsb3cuUnVsZUFjdGlvbnNPdmVyZmxvdywgewogICAgICAgIHJ1bGU6IHJ1bGUsCiAgICAgICAgdXNlckhhc05vUGVybWlzc2lvbnM6IHVzZXJIYXNOb1Blcm1pc3Npb25zCiAgICAgIH0pKSkpKSksIHJ1bGVFcnJvciwgdGFicywgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTcGFjZXIsIG51bGwpLCBydWxlRGV0YWlsVGFiID09PSBSdWxlRGV0YWlsVGFicy5zaWduYWxzICYmIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuZGVmYXVsdC5GcmFnbWVudCwgbnVsbCwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4R3JvdXAsIG51bGwsIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgICAgICBjb21wb25lbnQ6ICJzZWN0aW9uIiwKICAgICAgICBncm93OiAxCiAgICAgIH0sIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9zdGVwX3BhbmVsLlN0ZXBQYW5lbCwgewogICAgICAgIGxvYWRpbmc6IGlzTG9hZGluZywKICAgICAgICB0aXRsZTogcnVsZUkxOG4uREVGSU5JVElPTgogICAgICB9LCBkZWZpbmVSdWxlRGF0YSAhPSBudWxsICYmIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9zdGVwX2RlZmluZV9ydWxlLlN0ZXBEZWZpbmVSdWxlLCB7CiAgICAgICAgZGVzY3JpcHRpb25EaXJlY3Rpb246ICJjb2x1bW4iLAogICAgICAgIGlzUmVhZE9ubHlWaWV3OiB0cnVlLAogICAgICAgIGlzTG9hZGluZzogZmFsc2UsCiAgICAgICAgZGVmYXVsdFZhbHVlczogZGVmaW5lUnVsZURhdGEKICAgICAgfSkpKSwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgICAgIGNvbXBvbmVudDogInNlY3Rpb24iLAogICAgICAgIGdyb3c6IDIKICAgICAgfSwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3N0ZXBfcGFuZWwuU3RlcFBhbmVsLCB7CiAgICAgICAgbG9hZGluZzogaXNMb2FkaW5nLAogICAgICAgIHRpdGxlOiBydWxlSTE4bi5BQk9VVAogICAgICB9LCBhYm91dFJ1bGVEYXRhICE9IG51bGwgJiYgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3N0ZXBfYWJvdXRfcnVsZS5TdGVwQWJvdXRSdWxlLCB7CiAgICAgICAgZGVzY3JpcHRpb25EaXJlY3Rpb246ICJyb3ciLAogICAgICAgIGlzUmVhZE9ubHlWaWV3OiB0cnVlLAogICAgICAgIGlzTG9hZGluZzogZmFsc2UsCiAgICAgICAgZGVmYXVsdFZhbHVlczogYWJvdXRSdWxlRGF0YQogICAgICB9KSkpLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICAgICAgY29tcG9uZW50OiAic2VjdGlvbiIsCiAgICAgICAgZ3JvdzogMQogICAgICB9LCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfc3RlcF9wYW5lbC5TdGVwUGFuZWwsIHsKICAgICAgICBsb2FkaW5nOiBpc0xvYWRpbmcsCiAgICAgICAgdGl0bGU6IHJ1bGVJMThuLlNDSEVEVUxFCiAgICAgIH0sIHNjaGVkdWxlUnVsZURhdGEgIT0gbnVsbCAmJiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfc3RlcF9zY2hlZHVsZV9ydWxlLlN0ZXBTY2hlZHVsZVJ1bGUsIHsKICAgICAgICBkZXNjcmlwdGlvbkRpcmVjdGlvbjogImNvbHVtbiIsCiAgICAgICAgaXNSZWFkT25seVZpZXc6IHRydWUsCiAgICAgICAgaXNMb2FkaW5nOiBmYWxzZSwKICAgICAgICBkZWZhdWx0VmFsdWVzOiBzY2hlZHVsZVJ1bGVEYXRhCiAgICAgIH0pKSkpLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgbnVsbCksIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9zaWduYWxzX2hpc3RvZ3JhbV9wYW5lbC5TaWduYWxzSGlzdG9ncmFtUGFuZWwsIHsKICAgICAgICBkZWxldGVRdWVyeTogZGVsZXRlUXVlcnksCiAgICAgICAgZmlsdGVyczogc2lnbmFsTWVyZ2VkRmlsdGVycywKICAgICAgICBxdWVyeTogcXVlcnksCiAgICAgICAgZnJvbTogZnJvbSwKICAgICAgICBzaWduYWxJbmRleE5hbWU6IHNpZ25hbEluZGV4TmFtZSwKICAgICAgICBzZXRRdWVyeTogc2V0UXVlcnksCiAgICAgICAgc3RhY2tCeU9wdGlvbnM6IF9jb25maWcuc2lnbmFsc0hpc3RvZ3JhbU9wdGlvbnMsCiAgICAgICAgdG86IHRvLAogICAgICAgIHVwZGF0ZURhdGVSYW5nZTogdXBkYXRlRGF0ZVJhbmdlQ2FsbGJhY2sKICAgICAgfSksIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3BhY2VyLCBudWxsKSwgcnVsZUlkICE9IG51bGwgJiYgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3NpZ25hbHMuU2lnbmFsc1RhYmxlLCB7CiAgICAgICAgY2FuVXNlckNSVUQ6IGNhblVzZXJDUlVEICE9PSBudWxsICYmIGNhblVzZXJDUlVEICE9PSB2b2lkIDAgPyBjYW5Vc2VyQ1JVRCA6IGZhbHNlLAogICAgICAgIGRlZmF1bHRGaWx0ZXJzOiBzaWduYWxEZWZhdWx0RmlsdGVycywKICAgICAgICBoYXNJbmRleFdyaXRlOiBoYXNJbmRleFdyaXRlICE9PSBudWxsICYmIGhhc0luZGV4V3JpdGUgIT09IHZvaWQgMCA/IGhhc0luZGV4V3JpdGUgOiBmYWxzZSwKICAgICAgICBmcm9tOiBmcm9tLAogICAgICAgIGxvYWRpbmc6IGxvYWRpbmcsCiAgICAgICAgc2lnbmFsc0luZGV4OiBzaWduYWxJbmRleE5hbWUgIT09IG51bGwgJiYgc2lnbmFsSW5kZXhOYW1lICE9PSB2b2lkIDAgPyBzaWduYWxJbmRleE5hbWUgOiAnJywKICAgICAgICB0bzogdG8KICAgICAgfSkpLCBydWxlRGV0YWlsVGFiID09PSBSdWxlRGV0YWlsVGFicy5mYWlsdXJlcyAmJiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZmFpbHVyZV9oaXN0b3J5LkZhaWx1cmVIaXN0b3J5LCB7CiAgICAgICAgaWQ6IHJ1bGUgPT09IG51bGwgfHwgcnVsZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogcnVsZS5pZAogICAgICB9KSkpOwogICAgfSkgOiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfd3JhcHBlcl9wYWdlLldyYXBwZXJQYWdlLCBudWxsLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZGV0ZWN0aW9uX2VuZ2luZV9oZWFkZXJfcGFnZS5EZXRlY3Rpb25FbmdpbmVIZWFkZXJQYWdlLCB7CiAgICAgIGJvcmRlcjogdHJ1ZSwKICAgICAgdGl0bGU6IGkxOG4uUEFHRV9USVRMRQogICAgfSksIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9kZXRlY3Rpb25fZW5naW5lX2VtcHR5X3BhZ2UuRGV0ZWN0aW9uRW5naW5lRW1wdHlQYWdlLCBudWxsKSk7CiAgfSksIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9zcHlfcm91dGVzLlNweVJvdXRlLCB7CiAgICBzdGF0ZTogewogICAgICBydWxlTmFtZTogcnVsZSA9PT0gbnVsbCB8fCBydWxlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBydWxlLm5hbWUKICAgIH0KICB9KSk7Cn07Cgp2YXIgbWFrZU1hcFN0YXRlVG9Qcm9wcyA9IGZ1bmN0aW9uIG1ha2VNYXBTdGF0ZVRvUHJvcHMoKSB7CiAgdmFyIGdldEdsb2JhbElucHV0cyA9IF9pbnB1dHMuaW5wdXRzU2VsZWN0b3JzLmdsb2JhbFNlbGVjdG9yKCk7CgogIHJldHVybiBmdW5jdGlvbiAoc3RhdGUpIHsKICAgIHZhciBnbG9iYWxJbnB1dHMgPSBnZXRHbG9iYWxJbnB1dHMoc3RhdGUpOwogICAgdmFyIHF1ZXJ5ID0gZ2xvYmFsSW5wdXRzLnF1ZXJ5LAogICAgICAgIGZpbHRlcnMgPSBnbG9iYWxJbnB1dHMuZmlsdGVyczsKICAgIHJldHVybiB7CiAgICAgIHF1ZXJ5OiBxdWVyeSwKICAgICAgZmlsdGVyczogZmlsdGVycwogICAgfTsKICB9Owp9OwoKdmFyIG1hcERpc3BhdGNoVG9Qcm9wcyA9IHsKICBzZXRBYnNvbHV0ZVJhbmdlRGF0ZVBpY2tlcjogX2FjdGlvbnMuc2V0QWJzb2x1dGVSYW5nZURhdGVQaWNrZXIKfTsKdmFyIFJ1bGVEZXRhaWxzUGFnZSA9ICgwLCBfcmVhY3RSZWR1eC5jb25uZWN0KShtYWtlTWFwU3RhdGVUb1Byb3BzLCBtYXBEaXNwYXRjaFRvUHJvcHMpKCgwLCBfcmVhY3QyLm1lbW8pKFJ1bGVEZXRhaWxzUGFnZUNvbXBvbmVudCkpOwpleHBvcnRzLlJ1bGVEZXRhaWxzUGFnZSA9IFJ1bGVEZXRhaWxzUGFnZTs="},null]}