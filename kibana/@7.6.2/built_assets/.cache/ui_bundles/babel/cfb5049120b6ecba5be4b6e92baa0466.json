{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/legacy/core_plugins/kibana/public/visualize_embeddable/visualize_embeddable_factory.js","dependencies":[{"path":"src/legacy/core_plugins/kibana/public/visualize_embeddable/visualize_embeddable_factory.js","mtime":1585205039939},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiKSB7IF90eXBlb2YyID0gZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mMiA9IGZ1bmN0aW9uIF90eXBlb2YyKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mMihvYmopOyB9CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuVmlzdWFsaXplRW1iZWRkYWJsZUZhY3RvcnkgPSB2b2lkIDA7CgpyZXF1aXJlKCJ1aUV4cG9ydHMvY29udGV4dE1lbnVBY3Rpb25zIik7CgpyZXF1aXJlKCJ1aUV4cG9ydHMvZGV2VG9vbHMiKTsKCnJlcXVpcmUoInVpRXhwb3J0cy9kb2NWaWV3cyIpOwoKcmVxdWlyZSgidWlFeHBvcnRzL2VtYmVkZGFibGVBY3Rpb25zIik7CgpyZXF1aXJlKCJ1aUV4cG9ydHMvZmllbGRGb3JtYXRFZGl0b3JzIik7CgpyZXF1aXJlKCJ1aUV4cG9ydHMvZmllbGRGb3JtYXRzIik7CgpyZXF1aXJlKCJ1aUV4cG9ydHMvaW5kZXhNYW5hZ2VtZW50Iik7CgpyZXF1aXJlKCJ1aUV4cG9ydHMvaW5zcGVjdG9yVmlld3MiKTsKCnJlcXVpcmUoInVpRXhwb3J0cy9zYXZlZE9iamVjdFR5cGVzIik7CgpyZXF1aXJlKCJ1aUV4cG9ydHMvc2VhcmNoIik7CgpyZXF1aXJlKCJ1aUV4cG9ydHMvc2hhcmVDb250ZXh0TWVudUV4dGVuc2lvbnMiKTsKCnJlcXVpcmUoInVpRXhwb3J0cy92aXNUeXBlcyIpOwoKcmVxdWlyZSgidWlFeHBvcnRzL3Zpc3VhbGl6ZSIpOwoKdmFyIF9pMThuID0gcmVxdWlyZSgiQGtibi9pMThuIik7Cgp2YXIgX2Nocm9tZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgidWkvY2hyb21lIikpOwoKdmFyIF9uZXdfcGxhdGZvcm0gPSByZXF1aXJlKCJ1aS9uZXdfcGxhdGZvcm0iKTsKCnZhciBfcHVibGljID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vLi4vcGx1Z2lucy9lbWJlZGRhYmxlL3B1YmxpYyIpOwoKdmFyIF9sZWdhY3kgPSByZXF1aXJlKCIuLi8uLi8uLi92aXN1YWxpemF0aW9ucy9wdWJsaWMvbnBfcmVhZHkvcHVibGljL2xlZ2FjeSIpOwoKdmFyIF92aXN1YWxpemUyID0gcmVxdWlyZSgiLi4vdmlzdWFsaXplIik7Cgp2YXIgX2Rpc2FibGVkX2xhYl9lbWJlZGRhYmxlID0gcmVxdWlyZSgiLi9kaXNhYmxlZF9sYWJfZW1iZWRkYWJsZSIpOwoKdmFyIF9nZXRfaW5kZXhfcGF0dGVybiA9IHJlcXVpcmUoIi4vZ2V0X2luZGV4X3BhdHRlcm4iKTsKCnZhciBfdmlzdWFsaXplX2VtYmVkZGFibGUgPSByZXF1aXJlKCIuL3Zpc3VhbGl6ZV9lbWJlZGRhYmxlIik7Cgp2YXIgX2NvbnN0YW50cyA9IHJlcXVpcmUoIi4vY29uc3RhbnRzIik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgewogIHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7CiAgICBkZWZhdWx0OiBvYmoKICB9Owp9CgpmdW5jdGlvbiBfdHlwZW9mKG9iaikgewogIGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIF90eXBlb2YyKFN5bWJvbC5pdGVyYXRvcikgPT09ICJzeW1ib2wiKSB7CiAgICBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsKICAgICAgcmV0dXJuIF90eXBlb2YyKG9iaik7CiAgICB9OwogIH0gZWxzZSB7CiAgICBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsKICAgICAgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogX3R5cGVvZjIob2JqKTsKICAgIH07CiAgfQoKICByZXR1cm4gX3R5cGVvZihvYmopOwp9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7CiAgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOwogIH0KfQoKZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgewogIGlmIChjYWxsICYmIChfdHlwZW9mKGNhbGwpID09PSAib2JqZWN0IiB8fCB0eXBlb2YgY2FsbCA9PT0gImZ1bmN0aW9uIikpIHsKICAgIHJldHVybiBjYWxsOwogIH0KCiAgcmV0dXJuIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZik7Cn0KCmZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7CiAgX2dldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LmdldFByb3RvdHlwZU9mIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsKICAgIHJldHVybiBvLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2Yobyk7CiAgfTsKICByZXR1cm4gX2dldFByb3RvdHlwZU9mKG8pOwp9CgpmdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsKICBpZiAoc2VsZiA9PT0gdm9pZCAwKSB7CiAgICB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOwogIH0KCiAgcmV0dXJuIHNlbGY7Cn0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsKICBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOwogICAgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOwogICAgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOwogICAgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7CiAgfQp9CgpmdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7CiAgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7CiAgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOwogIHJldHVybiBDb25zdHJ1Y3RvcjsKfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7CiAgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAiZnVuY3Rpb24iICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uIik7CiAgfQoKICBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsKICAgIGNvbnN0cnVjdG9yOiB7CiAgICAgIHZhbHVlOiBzdWJDbGFzcywKICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZQogICAgfQogIH0pOwogIGlmIChzdXBlckNsYXNzKSBfc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpOwp9CgpmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgewogIF9zZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgewogICAgby5fX3Byb3RvX18gPSBwOwogICAgcmV0dXJuIG87CiAgfTsKCiAgcmV0dXJuIF9zZXRQcm90b3R5cGVPZihvLCBwKTsKfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgewogIGlmIChrZXkgaW4gb2JqKSB7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsKICAgICAgdmFsdWU6IHZhbHVlLAogICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgIHdyaXRhYmxlOiB0cnVlCiAgICB9KTsKICB9IGVsc2UgewogICAgb2JqW2tleV0gPSB2YWx1ZTsKICB9CgogIHJldHVybiBvYmo7Cn0KCnZhciBWaXN1YWxpemVFbWJlZGRhYmxlRmFjdG9yeSA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKF9FbWJlZGRhYmxlRmFjdG9yeSkgewogIF9pbmhlcml0cyhWaXN1YWxpemVFbWJlZGRhYmxlRmFjdG9yeSwgX0VtYmVkZGFibGVGYWN0b3J5KTsKCiAgX2NyZWF0ZUNsYXNzKFZpc3VhbGl6ZUVtYmVkZGFibGVGYWN0b3J5LCBudWxsLCBbewogICAga2V5OiAiY3JlYXRlVmlzdWFsaXplRW1iZWRkYWJsZUZhY3RvcnkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZVZpc3VhbGl6ZUVtYmVkZGFibGVGYWN0b3J5KCkgewogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmFzeW5jKGZ1bmN0aW9uIGNyZWF0ZVZpc3VhbGl6ZUVtYmVkZGFibGVGYWN0b3J5JChfY29udGV4dCkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBuZXcgVmlzdWFsaXplRW1iZWRkYWJsZUZhY3RvcnkoX2xlZ2FjeS5zdGFydC50eXBlcykpOwoKICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9XSk7CgogIGZ1bmN0aW9uIFZpc3VhbGl6ZUVtYmVkZGFibGVGYWN0b3J5KHZpc1R5cGVzKSB7CiAgICB2YXIgX3RoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFZpc3VhbGl6ZUVtYmVkZGFibGVGYWN0b3J5KTsKCiAgICBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIF9nZXRQcm90b3R5cGVPZihWaXN1YWxpemVFbWJlZGRhYmxlRmFjdG9yeSkuY2FsbCh0aGlzLCB7CiAgICAgIHNhdmVkT2JqZWN0TWV0YURhdGE6IHsKICAgICAgICBuYW1lOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgna2JuLnZpc3VhbGl6ZS5zYXZlZE9iamVjdE5hbWUnLCB7CiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1Zpc3VhbGl6YXRpb24nCiAgICAgICAgfSksCiAgICAgICAgaW5jbHVkZUZpZWxkczogWyd2aXNTdGF0ZSddLAogICAgICAgIHR5cGU6ICd2aXN1YWxpemF0aW9uJywKICAgICAgICBnZXRJY29uRm9yU2F2ZWRPYmplY3Q6IGZ1bmN0aW9uIGdldEljb25Gb3JTYXZlZE9iamVjdChzYXZlZE9iamVjdCkgewogICAgICAgICAgaWYgKCF2aXNUeXBlcykgewogICAgICAgICAgICByZXR1cm4gJ3Zpc3VhbGl6ZUFwcCc7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIHZpc1R5cGVzLmdldChKU09OLnBhcnNlKHNhdmVkT2JqZWN0LmF0dHJpYnV0ZXMudmlzU3RhdGUpLnR5cGUpLmljb24gfHwgJ3Zpc3VhbGl6ZUFwcCc7CiAgICAgICAgfSwKICAgICAgICBnZXRUb29sdGlwRm9yU2F2ZWRPYmplY3Q6IGZ1bmN0aW9uIGdldFRvb2x0aXBGb3JTYXZlZE9iamVjdChzYXZlZE9iamVjdCkgewogICAgICAgICAgaWYgKCF2aXNUeXBlcykgewogICAgICAgICAgICByZXR1cm4gJyc7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuICIiLmNvbmNhdChzYXZlZE9iamVjdC5hdHRyaWJ1dGVzLnRpdGxlLCAiICgiKS5jb25jYXQodmlzVHlwZXMuZ2V0KEpTT04ucGFyc2Uoc2F2ZWRPYmplY3QuYXR0cmlidXRlcy52aXNTdGF0ZSkudHlwZSkudGl0bGUsICIpIik7CiAgICAgICAgfSwKICAgICAgICBzaG93U2F2ZWRPYmplY3Q6IGZ1bmN0aW9uIHNob3dTYXZlZE9iamVjdChzYXZlZE9iamVjdCkgewogICAgICAgICAgaWYgKCF2aXNUeXBlcykgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIHR5cGVOYW1lID0gSlNPTi5wYXJzZShzYXZlZE9iamVjdC5hdHRyaWJ1dGVzLnZpc1N0YXRlKS50eXBlOwogICAgICAgICAgdmFyIHZpc1R5cGUgPSB2aXNUeXBlcy5nZXQodHlwZU5hbWUpOwoKICAgICAgICAgIGlmICghdmlzVHlwZSkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKF9uZXdfcGxhdGZvcm0ubnBTdGFydC5jb3JlLnVpU2V0dGluZ3MuZ2V0KCd2aXN1YWxpemU6ZW5hYmxlTGFicycpKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiB2aXNUeXBlLnN0YWdlICE9PSAnZXhwZXJpbWVudGFsJzsKICAgICAgICB9CiAgICAgIH0KICAgIH0pKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJ0eXBlIiwgX2NvbnN0YW50cy5WSVNVQUxJWkVfRU1CRUREQUJMRV9UWVBFKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJ2aXNUeXBlcyIsIHZvaWQgMCk7CgogICAgX3RoaXMudmlzVHlwZXMgPSB2aXNUeXBlczsKICAgIHJldHVybiBfdGhpczsKICB9CgogIF9jcmVhdGVDbGFzcyhWaXN1YWxpemVFbWJlZGRhYmxlRmFjdG9yeSwgW3sKICAgIGtleTogImlzRWRpdGFibGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGlzRWRpdGFibGUoKSB7CiAgICAgIHJldHVybiBfbmV3X3BsYXRmb3JtLm5wU3RhcnQuY29yZS5hcHBsaWNhdGlvbi5jYXBhYmlsaXRpZXMudmlzdWFsaXplLnNhdmU7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0RGlzcGxheU5hbWUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldERpc3BsYXlOYW1lKCkgewogICAgICByZXR1cm4gX2kxOG4uaTE4bi50cmFuc2xhdGUoJ2tibi5lbWJlZGRhYmxlLnZpc3VhbGl6YXRpb25zLmRpc3BsYXlOYW1lJywgewogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAndmlzdWFsaXphdGlvbicKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiY3JlYXRlRnJvbU9iamVjdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlRnJvbU9iamVjdChzYXZlZE9iamVjdCwgaW5wdXQsIHBhcmVudCkgewogICAgICB2YXIgJGluamVjdG9yLCBjb25maWcsIHNhdmVkVmlzdWFsaXphdGlvbnMsIHZpc0lkLCBlZGl0VXJsLCBpc0xhYnNFbmFibGVkLCBpbmRleFBhdHRlcm4sIGluZGV4UGF0dGVybnM7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXN5bmMoZnVuY3Rpb24gY3JlYXRlRnJvbU9iamVjdCQoX2NvbnRleHQyKSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAyOwogICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAoX2Nocm9tZS5kZWZhdWx0LmRhbmdlcm91c2x5R2V0QWN0aXZlSW5qZWN0b3IoKSk7CgogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgJGluamVjdG9yID0gX2NvbnRleHQyLnNlbnQ7CiAgICAgICAgICAgICAgY29uZmlnID0gJGluamVjdG9yLmdldCgnY29uZmlnJyk7CiAgICAgICAgICAgICAgc2F2ZWRWaXN1YWxpemF0aW9ucyA9ICRpbmplY3Rvci5nZXQoJ3NhdmVkVmlzdWFsaXphdGlvbnMnKTsKICAgICAgICAgICAgICBfY29udGV4dDIucHJldiA9IDU7CiAgICAgICAgICAgICAgdmlzSWQgPSBzYXZlZE9iamVjdC5pZDsKICAgICAgICAgICAgICBlZGl0VXJsID0gdmlzSWQgPyBfbmV3X3BsYXRmb3JtLm5wU3RhcnQuY29yZS5odHRwLmJhc2VQYXRoLnByZXBlbmQoIi9hcHAva2liYW5hIi5jb25jYXQoc2F2ZWRWaXN1YWxpemF0aW9ucy51cmxGb3IodmlzSWQpKSkgOiAnJzsKICAgICAgICAgICAgICBpc0xhYnNFbmFibGVkID0gY29uZmlnLmdldCgndmlzdWFsaXplOmVuYWJsZUxhYnMnKTsKCiAgICAgICAgICAgICAgaWYgKCEoIWlzTGFic0VuYWJsZWQgJiYgc2F2ZWRPYmplY3QudmlzLnR5cGUuc3RhZ2UgPT09ICdleHBlcmltZW50YWwnKSkgewogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxMTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIsIG5ldyBfZGlzYWJsZWRfbGFiX2VtYmVkZGFibGUuRGlzYWJsZWRMYWJFbWJlZGRhYmxlKHNhdmVkT2JqZWN0LnRpdGxlLCBpbnB1dCkpOwoKICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDEzOwogICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAoKDAsIF9nZXRfaW5kZXhfcGF0dGVybi5nZXRJbmRleFBhdHRlcm4pKHNhdmVkT2JqZWN0KSk7CgogICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgIGluZGV4UGF0dGVybiA9IF9jb250ZXh0Mi5zZW50OwogICAgICAgICAgICAgIGluZGV4UGF0dGVybnMgPSBpbmRleFBhdHRlcm4gPyBbaW5kZXhQYXR0ZXJuXSA6IFtdOwogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iLCBuZXcgX3Zpc3VhbGl6ZV9lbWJlZGRhYmxlLlZpc3VhbGl6ZUVtYmVkZGFibGUoX25ld19wbGF0Zm9ybS5ucFN0YXJ0LnBsdWdpbnMuZGF0YS5xdWVyeS50aW1lZmlsdGVyLnRpbWVmaWx0ZXIsIHsKICAgICAgICAgICAgICAgIHNhdmVkVmlzdWFsaXphdGlvbjogc2F2ZWRPYmplY3QsCiAgICAgICAgICAgICAgICBpbmRleFBhdHRlcm5zOiBpbmRleFBhdHRlcm5zLAogICAgICAgICAgICAgICAgZWRpdFVybDogZWRpdFVybCwKICAgICAgICAgICAgICAgIGVkaXRhYmxlOiB0aGlzLmlzRWRpdGFibGUoKSwKICAgICAgICAgICAgICAgIGFwcFN0YXRlOiBpbnB1dC5hcHBTdGF0ZSwKICAgICAgICAgICAgICAgIHVpU3RhdGU6IGlucHV0LnVpU3RhdGUKICAgICAgICAgICAgICB9LCBpbnB1dCwgcGFyZW50KSk7CgogICAgICAgICAgICBjYXNlIDE4OgogICAgICAgICAgICAgIF9jb250ZXh0Mi5wcmV2ID0gMTg7CiAgICAgICAgICAgICAgX2NvbnRleHQyLnQwID0gX2NvbnRleHQyWyJjYXRjaCJdKDUpOwogICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoX2NvbnRleHQyLnQwKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb25zb2xlCgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iLCBuZXcgX3B1YmxpYy5FcnJvckVtYmVkZGFibGUoX2NvbnRleHQyLnQwLCBpbnB1dCwgcGFyZW50KSk7CgogICAgICAgICAgICBjYXNlIDIyOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgbnVsbCwgdGhpcywgW1s1LCAxOF1dKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjcmVhdGVGcm9tU2F2ZWRPYmplY3QiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZUZyb21TYXZlZE9iamVjdChzYXZlZE9iamVjdElkLCBpbnB1dCwgcGFyZW50KSB7CiAgICAgIHZhciAkaW5qZWN0b3IsIHNhdmVkVmlzdWFsaXphdGlvbnMsIF92aXNJZCwgc2F2ZWRPYmplY3Q7CgogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmFzeW5jKGZ1bmN0aW9uIGNyZWF0ZUZyb21TYXZlZE9iamVjdCQoX2NvbnRleHQzKSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAyOwogICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAoX2Nocm9tZS5kZWZhdWx0LmRhbmdlcm91c2x5R2V0QWN0aXZlSW5qZWN0b3IoKSk7CgogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgJGluamVjdG9yID0gX2NvbnRleHQzLnNlbnQ7CiAgICAgICAgICAgICAgc2F2ZWRWaXN1YWxpemF0aW9ucyA9ICRpbmplY3Rvci5nZXQoJ3NhdmVkVmlzdWFsaXphdGlvbnMnKTsKICAgICAgICAgICAgICBfY29udGV4dDMucHJldiA9IDQ7CiAgICAgICAgICAgICAgX3Zpc0lkID0gc2F2ZWRPYmplY3RJZDsKICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDg7CiAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hd3JhcChzYXZlZFZpc3VhbGl6YXRpb25zLmdldChfdmlzSWQpKTsKCiAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICBzYXZlZE9iamVjdCA9IF9jb250ZXh0My5zZW50OwogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuYWJydXB0KCJyZXR1cm4iLCB0aGlzLmNyZWF0ZUZyb21PYmplY3Qoc2F2ZWRPYmplY3QsIGlucHV0LCBwYXJlbnQpKTsKCiAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgX2NvbnRleHQzLnByZXYgPSAxMjsKICAgICAgICAgICAgICBfY29udGV4dDMudDAgPSBfY29udGV4dDNbImNhdGNoIl0oNCk7CiAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihfY29udGV4dDMudDApOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWNvbnNvbGUKCiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoInJldHVybiIsIG5ldyBfcHVibGljLkVycm9yRW1iZWRkYWJsZShfY29udGV4dDMudDAsIGlucHV0LCBwYXJlbnQpKTsKCiAgICAgICAgICAgIGNhc2UgMTY6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBudWxsLCB0aGlzLCBbWzQsIDEyXV0pOwogICAgfQogIH0sIHsKICAgIGtleTogImNyZWF0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlKCkgewogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmFzeW5jKGZ1bmN0aW9uIGNyZWF0ZSQoX2NvbnRleHQ0KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ0LnByZXYgPSBfY29udGV4dDQubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgLy8gVE9ETzogVGhpcyBpcyBhIGJpdCBvZiBhIGhhY2sgdG8gcHJlc2VydmUgdGhlIG9yaWdpbmFsIGZ1bmN0aW9uYWxpdHkuIElkZWFsbHkgd2Ugd2lsbCBjbGVhbiB0aGlzIHVwCiAgICAgICAgICAgICAgLy8gdG8gYWxsb3cgZm9yIGluIHBsYWNlIGNyZWF0aW9uIG9mIHZpc3VhbGl6YXRpb25zIHdpdGhvdXQgaGF2aW5nIHRvIG5hdmlnYXRlIGF3YXkgdG8gYSBuZXcgVVJMLgogICAgICAgICAgICAgIGlmICh0aGlzLnZpc1R5cGVzKSB7CiAgICAgICAgICAgICAgICAoMCwgX3Zpc3VhbGl6ZTIuc2hvd05ld1Zpc01vZGFsKSh0aGlzLnZpc1R5cGVzLCB7CiAgICAgICAgICAgICAgICAgIGVkaXRvclBhcmFtczogWydhZGRUb0Rhc2hib2FyZCddCiAgICAgICAgICAgICAgICB9LCBfbmV3X3BsYXRmb3JtLm5wU3RhcnQuY29yZS5odHRwLmJhc2VQYXRoLnByZXBlbmQsIF9uZXdfcGxhdGZvcm0ubnBTdGFydC5jb3JlLnVpU2V0dGluZ3MsIF9uZXdfcGxhdGZvcm0ubnBTdGFydC5jb3JlLnNhdmVkT2JqZWN0cywgX25ld19wbGF0Zm9ybS5ucFNldHVwLnBsdWdpbnMudXNhZ2VDb2xsZWN0aW9uKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KCJyZXR1cm4iLCB1bmRlZmluZWQpOwoKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgbnVsbCwgdGhpcyk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gVmlzdWFsaXplRW1iZWRkYWJsZUZhY3Rvcnk7Cn0oX3B1YmxpYy5FbWJlZGRhYmxlRmFjdG9yeSk7CgpleHBvcnRzLlZpc3VhbGl6ZUVtYmVkZGFibGVGYWN0b3J5ID0gVmlzdWFsaXplRW1iZWRkYWJsZUZhY3Rvcnk7"},null]}