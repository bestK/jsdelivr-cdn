{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/security/public/views/management/edit_role/components/privileges/kibana/space_aware_privilege_section/privilege_matrix.js","dependencies":[{"path":"x-pack/legacy/plugins/security/public/views/management/edit_role/components/privileges/kibana/space_aware_privilege_section/privilege_matrix.js","mtime":1585205047204},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiKSB7IF90eXBlb2YyID0gZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mMiA9IGZ1bmN0aW9uIF90eXBlb2YyKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mMihvYmopOyB9CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuUHJpdmlsZWdlTWF0cml4ID0gdm9pZCAwOwoKdmFyIF9ldWkgPSByZXF1aXJlKCJAZWxhc3RpYy9ldWkiKTsKCnZhciBfcmVhY3QgPSByZXF1aXJlKCJAa2JuL2kxOG4vcmVhY3QiKTsKCnZhciBfcmVhY3QyID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgicmVhY3QiKSk7Cgp2YXIgX3NwYWNlX2F2YXRhciA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uL3NwYWNlcy9wdWJsaWMvc3BhY2VfYXZhdGFyIik7Cgp2YXIgX3ByaXZpbGVnZV91dGlscyA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uLy4uLy4uLy4uL2xpYi9wcml2aWxlZ2VfdXRpbHMiKTsKCnZhciBfc3BhY2VzX3BvcG92ZXJfbGlzdCA9IHJlcXVpcmUoIi4uLy4uLy4uL3NwYWNlc19wb3BvdmVyX2xpc3QiKTsKCnZhciBfcHJpdmlsZWdlX2Rpc3BsYXkgPSByZXF1aXJlKCIuL3ByaXZpbGVnZV9kaXNwbGF5Iik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsKICBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7CiAgICByZXR1cm4gb2JqOwogIH0gZWxzZSB7CiAgICB2YXIgbmV3T2JqID0ge307CgogICAgaWYgKG9iaiAhPSBudWxsKSB7CiAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHsKICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgewogICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvciA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpIDoge307CgogICAgICAgICAgaWYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSB7CiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmosIGtleSwgZGVzYyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBuZXdPYmpba2V5XSA9IG9ialtrZXldOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIG5ld09iai5kZWZhdWx0ID0gb2JqOwogICAgcmV0dXJuIG5ld09iajsKICB9Cn0KCmZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7CiAgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgX3R5cGVvZjIoU3ltYm9sLml0ZXJhdG9yKSA9PT0gInN5bWJvbCIpIHsKICAgIF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgewogICAgICByZXR1cm4gX3R5cGVvZjIob2JqKTsKICAgIH07CiAgfSBlbHNlIHsKICAgIF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgewogICAgICByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiBfdHlwZW9mMihvYmopOwogICAgfTsKICB9CgogIHJldHVybiBfdHlwZW9mKG9iaik7Cn0KCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgewogIHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsKCiAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsKICAgIHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOwogICAgaWYgKGVudW1lcmFibGVPbmx5KSBzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgewogICAgICByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsKICAgIH0pOwogICAga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOwogIH0KCiAgcmV0dXJuIGtleXM7Cn0KCmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7CiAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsKICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OwoKICAgIGlmIChpICUgMikgewogICAgICBvd25LZXlzKHNvdXJjZSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7CiAgICAgIH0pOwogICAgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgewogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpOwogICAgfSBlbHNlIHsKICAgICAgb3duS2V5cyhzb3VyY2UpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOwogICAgICB9KTsKICAgIH0KICB9CgogIHJldHVybiB0YXJnZXQ7Cn0KCmZ1bmN0aW9uIF90b0NvbnN1bWFibGVBcnJheShhcnIpIHsKICByZXR1cm4gX2FycmF5V2l0aG91dEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheShhcnIpIHx8IF9ub25JdGVyYWJsZVNwcmVhZCgpOwp9CgpmdW5jdGlvbiBfbm9uSXRlcmFibGVTcHJlYWQoKSB7CiAgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIHNwcmVhZCBub24taXRlcmFibGUgaW5zdGFuY2UiKTsKfQoKZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheShpdGVyKSB7CiAgaWYgKFN5bWJvbC5pdGVyYXRvciBpbiBPYmplY3QoaXRlcikgfHwgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGl0ZXIpID09PSAiW29iamVjdCBBcmd1bWVudHNdIikgcmV0dXJuIEFycmF5LmZyb20oaXRlcik7Cn0KCmZ1bmN0aW9uIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHsKICBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSB7CiAgICBmb3IgKHZhciBpID0gMCwgYXJyMiA9IG5ldyBBcnJheShhcnIubGVuZ3RoKTsgaSA8IGFyci5sZW5ndGg7IGkrKykgewogICAgICBhcnIyW2ldID0gYXJyW2ldOwogICAgfQoKICAgIHJldHVybiBhcnIyOwogIH0KfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgewogIGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsKICB9Cn0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsKICBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOwogICAgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOwogICAgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOwogICAgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7CiAgfQp9CgpmdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7CiAgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7CiAgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOwogIHJldHVybiBDb25zdHJ1Y3RvcjsKfQoKZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgewogIGlmIChjYWxsICYmIChfdHlwZW9mKGNhbGwpID09PSAib2JqZWN0IiB8fCB0eXBlb2YgY2FsbCA9PT0gImZ1bmN0aW9uIikpIHsKICAgIHJldHVybiBjYWxsOwogIH0KCiAgcmV0dXJuIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZik7Cn0KCmZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7CiAgX2dldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LmdldFByb3RvdHlwZU9mIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsKICAgIHJldHVybiBvLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2Yobyk7CiAgfTsKICByZXR1cm4gX2dldFByb3RvdHlwZU9mKG8pOwp9CgpmdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsKICBpZiAoc2VsZiA9PT0gdm9pZCAwKSB7CiAgICB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOwogIH0KCiAgcmV0dXJuIHNlbGY7Cn0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgewogIGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiIpOwogIH0KCiAgc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7CiAgICBjb25zdHJ1Y3RvcjogewogICAgICB2YWx1ZTogc3ViQ2xhc3MsCiAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICBjb25maWd1cmFibGU6IHRydWUKICAgIH0KICB9KTsKICBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTsKfQoKZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsKICBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsKICAgIG8uX19wcm90b19fID0gcDsKICAgIHJldHVybiBvOwogIH07CgogIHJldHVybiBfc2V0UHJvdG90eXBlT2YobywgcCk7Cn0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsKICBpZiAoa2V5IGluIG9iaikgewogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7CiAgICAgIHZhbHVlOiB2YWx1ZSwKICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICB3cml0YWJsZTogdHJ1ZQogICAgfSk7CiAgfSBlbHNlIHsKICAgIG9ialtrZXldID0gdmFsdWU7CiAgfQoKICByZXR1cm4gb2JqOwp9Cgp2YXIgU1BBQ0VTX0RJU1BMQVlfQ09VTlQgPSA0OwoKdmFyIFByaXZpbGVnZU1hdHJpeCA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKF9Db21wb25lbnQpIHsKICBfaW5oZXJpdHMoUHJpdmlsZWdlTWF0cml4LCBfQ29tcG9uZW50KTsKCiAgZnVuY3Rpb24gUHJpdmlsZWdlTWF0cml4KCkgewogICAgdmFyIF9nZXRQcm90b3R5cGVPZjI7CgogICAgdmFyIF90aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBQcml2aWxlZ2VNYXRyaXgpOwoKICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykgewogICAgICBhcmdzW19rZXldID0gYXJndW1lbnRzW19rZXldOwogICAgfQoKICAgIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKF9nZXRQcm90b3R5cGVPZjIgPSBfZ2V0UHJvdG90eXBlT2YoUHJpdmlsZWdlTWF0cml4KSkuY2FsbC5hcHBseShfZ2V0UHJvdG90eXBlT2YyLCBbdGhpc10uY29uY2F0KGFyZ3MpKSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAic3RhdGUiLCB7CiAgICAgIHNob3dNb2RhbDogZmFsc2UKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInJlbmRlclRhYmxlIiwgZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3RoaXMkcHJvcHMgPSBfdGhpcy5wcm9wcywKICAgICAgICAgIHJvbGUgPSBfdGhpcyRwcm9wcy5yb2xlLAogICAgICAgICAgZmVhdHVyZXMgPSBfdGhpcyRwcm9wcy5mZWF0dXJlcywKICAgICAgICAgIGludGwgPSBfdGhpcyRwcm9wcy5pbnRsOwogICAgICB2YXIgc3BhY2VQcml2aWxlZ2VzID0gcm9sZS5raWJhbmE7CgogICAgICB2YXIgZ2xvYmFsUHJpdmlsZWdlID0gX3RoaXMubG9jYXRlR2xvYmFsUHJpdmlsZWdlKCk7CgogICAgICB2YXIgc3BhY2VzQ29sdW1ucyA9IFtdOwogICAgICBzcGFjZVByaXZpbGVnZXMuZm9yRWFjaChmdW5jdGlvbiAoc3BhY2VQcml2cywgc3BhY2VzSW5kZXgpIHsKICAgICAgICBzcGFjZXNDb2x1bW5zLnB1c2goewogICAgICAgICAgaXNHbG9iYWw6ICgwLCBfcHJpdmlsZWdlX3V0aWxzLmlzR2xvYmFsUHJpdmlsZWdlRGVmaW5pdGlvbikoc3BhY2VQcml2cyksCiAgICAgICAgICBzcGFjZXNJbmRleDogc3BhY2VzSW5kZXgsCiAgICAgICAgICBzcGFjZXM6IHNwYWNlUHJpdnMuc3BhY2VzLm1hcChmdW5jdGlvbiAoc3BhY2VJZCkgewogICAgICAgICAgICByZXR1cm4gX3RoaXMucHJvcHMuc3BhY2VzLmZpbmQoZnVuY3Rpb24gKHNwYWNlKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHNwYWNlLmlkID09PSBzcGFjZUlkOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pLmZpbHRlcihCb29sZWFuKSwKICAgICAgICAgIHByaXZpbGVnZXM6IHsKICAgICAgICAgICAgYmFzZTogc3BhY2VQcml2cy5iYXNlLAogICAgICAgICAgICBmZWF0dXJlOiBzcGFjZVByaXZzLmZlYXR1cmUKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CiAgICAgIHZhciByb3dzID0gW3sKICAgICAgICBmZWF0dXJlOiB7CiAgICAgICAgICBpZDogJypiYXNlKicsCiAgICAgICAgICBpc0Jhc2U6IHRydWUsCiAgICAgICAgICBuYW1lOiBpbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgICBpZDogJ3hwYWNrLnNlY3VyaXR5Lm1hbmFnZW1lbnQuZWRpdFJvbGUuc3BhY2VQcml2aWxlZ2VNYXRyaXguYmFzZVByaXZpbGVnZVRleHQnLAogICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0Jhc2UgcHJpdmlsZWdlJwogICAgICAgICAgfSksCiAgICAgICAgICBhcHA6IFtdLAogICAgICAgICAgcHJpdmlsZWdlczoge30KICAgICAgICB9LAogICAgICAgIHJvbGU6IHJvbGUKICAgICAgfV0uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShmZWF0dXJlcy5tYXAoZnVuY3Rpb24gKGZlYXR1cmUpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgZmVhdHVyZTogX29iamVjdFNwcmVhZCh7fSwgZmVhdHVyZSwgewogICAgICAgICAgICBpc0Jhc2U6IGZhbHNlCiAgICAgICAgICB9KSwKICAgICAgICAgIHJvbGU6IHJvbGUKICAgICAgICB9OwogICAgICB9KSkpOwogICAgICB2YXIgY29sdW1ucyA9IFt7CiAgICAgICAgZmllbGQ6ICdmZWF0dXJlJywKICAgICAgICBuYW1lOiBpbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgaWQ6ICd4cGFjay5zZWN1cml0eS5tYW5hZ2VtZW50LmVkaXRSb2xlLnNwYWNlUHJpdmlsZWdlTWF0cml4LmZlYXR1cmVDb2x1bW5UaXRsZScsCiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0ZlYXR1cmUnCiAgICAgICAgfSksCiAgICAgICAgd2lkdGg6ICcyMzBweCcsCiAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoZmVhdHVyZSkgewogICAgICAgICAgcmV0dXJuIGZlYXR1cmUuaXNCYXNlID8gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5GcmFnbWVudCwgbnVsbCwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoInN0cm9uZyIsIG51bGwsIGZlYXR1cmUubmFtZSksIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpSWNvblRpcCwgewogICAgICAgICAgICBpY29uUHJvcHM6IHsKICAgICAgICAgICAgICBjbGFzc05hbWU6ICdldWktYWxpZ25Ub3AnCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHR5cGU6ICJxdWVzdGlvbkluQ2lyY2xlIiwKICAgICAgICAgICAgY29udGVudDogaW50bC5mb3JtYXRNZXNzYWdlKHsKICAgICAgICAgICAgICBpZDogJ3hwYWNrLnNlY3VyaXR5Lm1hbmFnZW1lbnQuZWRpdFJvbGUuc3BhY2VQcml2aWxlZ2VNYXRyaXguYmFzZVByaXZpbGVnZVRvb2x0aXAnLAogICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnVGhlIGJhc2UgcHJpdmlsZWdlIGlzIGF1dG9tYXRpY2FsbHkgZ3JhbnRlZCB0byBhbGwgZmVhdHVyZXMuJwogICAgICAgICAgICB9KSwKICAgICAgICAgICAgY29sb3I6ICJzdWJkdWVkIgogICAgICAgICAgfSkpIDogX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5GcmFnbWVudCwgbnVsbCwgZmVhdHVyZS5pY29uICYmIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpSWNvbiwgewogICAgICAgICAgICBjbGFzc05hbWU6ICJzZWNQcml2aWxlZ2VGZWF0dXJlSWNvbiIsCiAgICAgICAgICAgIHNpemU6ICJtIiwKICAgICAgICAgICAgdHlwZTogZmVhdHVyZS5pY29uCiAgICAgICAgICB9KSwgZmVhdHVyZS5uYW1lKTsKICAgICAgICB9CiAgICAgIH1dLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkoc3BhY2VzQ29sdW1ucy5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICB2YXIgY29sdW1uV2lkdGg7CgogICAgICAgIGlmIChpdGVtLmlzR2xvYmFsKSB7CiAgICAgICAgICBjb2x1bW5XaWR0aCA9ICcxMDBweCc7CiAgICAgICAgfSBlbHNlIGlmIChpdGVtLnNwYWNlcy5sZW5ndGggLSBTUEFDRVNfRElTUExBWV9DT1VOVCkgewogICAgICAgICAgY29sdW1uV2lkdGggPSAnOTBweCc7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbHVtbldpZHRoID0gJzgwcHgnOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIC8vIFRPRE86IHRoaXMgaXMgYSBoYWNreSB3YXkgdG8gZGV0ZXJtaW5lIGlmIHdlIGFyZSBsb29raW5nIGF0IHRoZSBnbG9iYWwgZmVhdHVyZQogICAgICAgICAgLy8gdXNlZCBmb3IgY2VsbFByb3BzIGJlbG93Li4uCiAgICAgICAgICBmaWVsZDogaXRlbS5pc0dsb2JhbCA/ICdnbG9iYWwnIDogJ2ZlYXR1cmUnLAogICAgICAgICAgd2lkdGg6IGNvbHVtbldpZHRoLAogICAgICAgICAgbmFtZTogX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIG51bGwsIGl0ZW0uc3BhY2VzLnNsaWNlKDAsIFNQQUNFU19ESVNQTEFZX0NPVU5UKS5tYXAoZnVuY3Rpb24gKHNwYWNlKSB7CiAgICAgICAgICAgIHJldHVybiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudCgic3BhbiIsIHsKICAgICAgICAgICAgICBrZXk6IHNwYWNlLmlkCiAgICAgICAgICAgIH0sIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9zcGFjZV9hdmF0YXIuU3BhY2VBdmF0YXIsIHsKICAgICAgICAgICAgICBzaXplOiAicyIsCiAgICAgICAgICAgICAgc3BhY2U6IHNwYWNlCiAgICAgICAgICAgIH0pLCAnICcsIGl0ZW0uaXNHbG9iYWwgJiYgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCBudWxsLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgICAgICAgIGlkOiAieHBhY2suc2VjdXJpdHkubWFuYWdlbWVudC5lZGl0Um9sZS5zcGFjZVByaXZpbGVnZU1hdHJpeC5nbG9iYWxTcGFjZU5hbWUiLAogICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiR2xvYmFsIgogICAgICAgICAgICB9KSwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImJyIiwgbnVsbCksIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9zcGFjZXNfcG9wb3Zlcl9saXN0LlNwYWNlc1BvcG92ZXJMaXN0LCB7CiAgICAgICAgICAgICAgc3BhY2VzOiBfdGhpcy5wcm9wcy5zcGFjZXMuZmlsdGVyKGZ1bmN0aW9uIChzKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gcy5pZCAhPT0gJyonOwogICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgIGludGw6IF90aGlzLnByb3BzLmludGwsCiAgICAgICAgICAgICAgYnV0dG9uVGV4dDogX3RoaXMucHJvcHMuaW50bC5mb3JtYXRNZXNzYWdlKHsKICAgICAgICAgICAgICAgIGlkOiAneHBhY2suc2VjdXJpdHkubWFuYWdlbWVudC5lZGl0Um9sZS5zcGFjZVByaXZpbGVnZU1hdHJpeC5zaG93QWxsU3BhY2VzTGluaycsCiAgICAgICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJyhhbGwgc3BhY2VzKScKICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9KSkpOwogICAgICAgICAgfSksIGl0ZW0uc3BhY2VzLmxlbmd0aCA+IFNQQUNFU19ESVNQTEFZX0NPVU5UICYmIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRnJhZ21lbnQsIG51bGwsIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJiciIsIG51bGwpLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfc3BhY2VzX3BvcG92ZXJfbGlzdC5TcGFjZXNQb3BvdmVyTGlzdCwgewogICAgICAgICAgICBzcGFjZXM6IGl0ZW0uc3BhY2VzLAogICAgICAgICAgICBpbnRsOiBfdGhpcy5wcm9wcy5pbnRsLAogICAgICAgICAgICBidXR0b25UZXh0OiBfdGhpcy5wcm9wcy5pbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgICAgIGlkOiAneHBhY2suc2VjdXJpdHkubWFuYWdlbWVudC5lZGl0Um9sZS5zcGFjZVByaXZpbGVnZU1hdHJpeC5zaG93Tk1vcmVTcGFjZXNMaW5rJywKICAgICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJyt7Y291bnR9IG1vcmUnCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICBjb3VudDogaXRlbS5zcGFjZXMubGVuZ3RoIC0gU1BBQ0VTX0RJU1BMQVlfQ09VTlQKICAgICAgICAgICAgfSkKICAgICAgICAgIH0pKSksCiAgICAgICAgICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcihmZWF0dXJlLCByZWNvcmQpIHsKICAgICAgICAgICAgcmV0dXJuIF90aGlzLnJlbmRlclByaXZpbGVnZURpc3BsYXkoaXRlbSwgcmVjb3JkLCBnbG9iYWxQcml2aWxlZ2UuYmFzZSk7CiAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgfSkpKTsKICAgICAgcmV0dXJuICgvLyBAdHMtaWdub3JlIG1pc3Npbmcgcm93UHJvcHMgZnJvbSB0eXBlZGVmCiAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlJbk1lbW9yeVRhYmxlLCB7CiAgICAgICAgICBjb2x1bW5zOiBjb2x1bW5zLAogICAgICAgICAgaXRlbXM6IHJvd3MgLy8gQHRzLWlnbm9yZSBtaXNzaW5nIHJvd1Byb3BzIGZyb20gdHlwZWRlZgogICAgICAgICAgLAogICAgICAgICAgcm93UHJvcHM6IGZ1bmN0aW9uIHJvd1Byb3BzKGl0ZW0pIHsKICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICBjbGFzc05hbWU6IGl0ZW0uZmVhdHVyZS5pc0Jhc2UgPyAnc2VjUHJpdmlsZWdlTWF0cml4X19yb3ctLWlzQmFzZVByaXZpbGVnZScgOiAnJwogICAgICAgICAgICB9OwogICAgICAgICAgfSwKICAgICAgICAgIGNlbGxQcm9wczogZnVuY3Rpb24gY2VsbFByb3BzKGl0ZW0sIGNvbHVtbikgewogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgIGNsYXNzTmFtZTogY29sdW1uLmZpZWxkID09PSAnZ2xvYmFsJyA/ICdzZWNQcml2aWxlZ2VNYXRyaXhfX2NlbGwtLWlzR2xvYmFsUHJpdmlsZWdlJyA6ICcnCiAgICAgICAgICAgIH07CiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgKTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInJlbmRlclByaXZpbGVnZURpc3BsYXkiLCBmdW5jdGlvbiAoY29sdW1uLCBfcmVmLCBnbG9iYWxCYXNlUHJpdmlsZWdlKSB7CiAgICAgIHZhciBmZWF0dXJlID0gX3JlZi5mZWF0dXJlOwoKICAgICAgaWYgKGNvbHVtbi5pc0dsb2JhbCkgewogICAgICAgIGlmIChmZWF0dXJlLmlzQmFzZSkgewogICAgICAgICAgcmV0dXJuIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9wcml2aWxlZ2VfZGlzcGxheS5Qcml2aWxlZ2VEaXNwbGF5LCB7CiAgICAgICAgICAgIHByaXZpbGVnZTogZ2xvYmFsQmFzZVByaXZpbGVnZQogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICB2YXIgZmVhdHVyZUNhbGN1bGF0ZWRQcml2aWxlZ2UgPSBfdGhpcy5wcm9wcy5jYWxjdWxhdGVkUHJpdmlsZWdlc1tjb2x1bW4uc3BhY2VzSW5kZXhdLmZlYXR1cmVbZmVhdHVyZS5pZF07CiAgICAgICAgcmV0dXJuIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9wcml2aWxlZ2VfZGlzcGxheS5Qcml2aWxlZ2VEaXNwbGF5LCB7CiAgICAgICAgICBwcml2aWxlZ2U6IGZlYXR1cmVDYWxjdWxhdGVkUHJpdmlsZWdlICYmIGZlYXR1cmVDYWxjdWxhdGVkUHJpdmlsZWdlLmFjdHVhbFByaXZpbGVnZQogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIG5vdCBnbG9iYWwKICAgICAgICB2YXIgY2FsY3VsYXRlZFByaXZpbGVnZSA9IF90aGlzLnByb3BzLmNhbGN1bGF0ZWRQcml2aWxlZ2VzW2NvbHVtbi5zcGFjZXNJbmRleF07CgogICAgICAgIGlmIChmZWF0dXJlLmlzQmFzZSkgewogICAgICAgICAgLy8gU3BhY2UgYmFzZSBwcml2aWxlZ2UKICAgICAgICAgIHZhciBhY3R1YWxCYXNlUHJpdmlsZWdlcyA9IGNhbGN1bGF0ZWRQcml2aWxlZ2UuYmFzZS5hY3R1YWxQcml2aWxlZ2U7CiAgICAgICAgICByZXR1cm4gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3ByaXZpbGVnZV9kaXNwbGF5LlByaXZpbGVnZURpc3BsYXksIHsKICAgICAgICAgICAgZXhwbGFuYXRpb246IGNhbGN1bGF0ZWRQcml2aWxlZ2UuYmFzZSwKICAgICAgICAgICAgcHJpdmlsZWdlOiBhY3R1YWxCYXNlUHJpdmlsZWdlcwogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICB2YXIgZmVhdHVyZVByaXZpbGVnZUV4cGxhbmF0aW9uID0gY2FsY3VsYXRlZFByaXZpbGVnZS5mZWF0dXJlW2ZlYXR1cmUuaWRdOwogICAgICAgIHJldHVybiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcHJpdmlsZWdlX2Rpc3BsYXkuUHJpdmlsZWdlRGlzcGxheSwgewogICAgICAgICAgZXhwbGFuYXRpb246IGZlYXR1cmVQcml2aWxlZ2VFeHBsYW5hdGlvbiwKICAgICAgICAgIHByaXZpbGVnZTogZmVhdHVyZVByaXZpbGVnZUV4cGxhbmF0aW9uICYmIGZlYXR1cmVQcml2aWxlZ2VFeHBsYW5hdGlvbi5hY3R1YWxQcml2aWxlZ2UKICAgICAgICB9KTsKICAgICAgfQogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAibG9jYXRlR2xvYmFsUHJpdmlsZWdlIiwgZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gX3RoaXMucHJvcHMucm9sZS5raWJhbmEuZmluZChmdW5jdGlvbiAoc3BhY2VQcml2KSB7CiAgICAgICAgcmV0dXJuICgwLCBfcHJpdmlsZWdlX3V0aWxzLmlzR2xvYmFsUHJpdmlsZWdlRGVmaW5pdGlvbikoc3BhY2VQcml2KTsKICAgICAgfSkgfHwgewogICAgICAgIHNwYWNlczogWycqJ10sCiAgICAgICAgYmFzZTogW10sCiAgICAgICAgZmVhdHVyZTogW10KICAgICAgfTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImhpZGVNb2RhbCIsIGZ1bmN0aW9uICgpIHsKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIHNob3dNb2RhbDogZmFsc2UKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJzaG93TW9kYWwiLCBmdW5jdGlvbiAoKSB7CiAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICBzaG93TW9kYWw6IHRydWUKICAgICAgfSk7CiAgICB9KTsKCiAgICByZXR1cm4gX3RoaXM7CiAgfQoKICBfY3JlYXRlQ2xhc3MoUHJpdmlsZWdlTWF0cml4LCBbewogICAga2V5OiAicmVuZGVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7CiAgICAgIHZhciBtb2RhbCA9IG51bGw7CgogICAgICBpZiAodGhpcy5zdGF0ZS5zaG93TW9kYWwpIHsKICAgICAgICBtb2RhbCA9IF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpT3ZlcmxheU1hc2ssIG51bGwsIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpTW9kYWwsIHsKICAgICAgICAgIGNsYXNzTmFtZTogInNlY1ByaXZpbGVnZU1hdHJpeF9fbW9kYWwiLAogICAgICAgICAgb25DbG9zZTogdGhpcy5oaWRlTW9kYWwKICAgICAgICB9LCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aU1vZGFsSGVhZGVyLCBudWxsLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aU1vZGFsSGVhZGVyVGl0bGUsIG51bGwsIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICBpZDogInhwYWNrLnNlY3VyaXR5Lm1hbmFnZW1lbnQuZWRpdFJvbGUuc3BhY2VQcml2aWxlZ2VNYXRyaXgubW9kYWxUaXRsZSIsCiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIlByaXZpbGVnZSBzdW1tYXJ5IgogICAgICAgIH0pKSksIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpTW9kYWxCb2R5LCBudWxsLCB0aGlzLnJlbmRlclRhYmxlKCkpLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aU1vZGFsRm9vdGVyLCBudWxsLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUJ1dHRvbiwgewogICAgICAgICAgb25DbGljazogdGhpcy5oaWRlTW9kYWwsCiAgICAgICAgICBmaWxsOiB0cnVlCiAgICAgICAgfSwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICAgIGlkOiAieHBhY2suc2VjdXJpdHkubWFuYWdlbWVudC5lZGl0Um9sZS5zcGFjZVByaXZpbGVnZU1hdHJpeC5jbG9zZUJ1dHRvbiIsCiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkNsb3NlIgogICAgICAgIH0pKSkpKTsKICAgICAgfQoKICAgICAgcmV0dXJuIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRnJhZ21lbnQsIG51bGwsIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQnV0dG9uRW1wdHksIHsKICAgICAgICBvbkNsaWNrOiB0aGlzLnNob3dNb2RhbAogICAgICB9LCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAieHBhY2suc2VjdXJpdHkubWFuYWdlbWVudC5lZGl0Um9sZS5zcGFjZVByaXZpbGVnZU1hdHJpeC5zaG93U3VtbWFyeVRleHQiLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiVmlldyBwcml2aWxlZ2Ugc3VtbWFyeSIKICAgICAgfSkpLCBtb2RhbCk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gUHJpdmlsZWdlTWF0cml4Owp9KF9yZWFjdDIuQ29tcG9uZW50KTsKCmV4cG9ydHMuUHJpdmlsZWdlTWF0cml4ID0gUHJpdmlsZWdlTWF0cml4Ow=="},null]}