{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/plugins/reporting/public/lib/stream_handler.js","dependencies":[{"path":"x-pack/plugins/reporting/public/lib/stream_handler.js","mtime":1585205049071},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLlJlcG9ydGluZ05vdGlmaWVyU3RyZWFtSGFuZGxlciA9IHZvaWQgMDsKCnZhciBSeCA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoInJ4anMiKSk7Cgp2YXIgX29wZXJhdG9ycyA9IHJlcXVpcmUoInJ4anMvb3BlcmF0b3JzIik7Cgp2YXIgX2kxOG4gPSByZXF1aXJlKCJAa2JuL2kxOG4iKTsKCnZhciBfY29uc3RhbnRzID0gcmVxdWlyZSgiLi4vLi4vY29uc3RhbnRzIik7Cgp2YXIgX2NvbXBvbmVudHMgPSByZXF1aXJlKCIuLi9jb21wb25lbnRzIik7Cgp2YXIgX2pvYl9xdWV1ZSA9IHJlcXVpcmUoIi4vam9iX3F1ZXVlIik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsKICBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7CiAgICByZXR1cm4gb2JqOwogIH0gZWxzZSB7CiAgICB2YXIgbmV3T2JqID0ge307CgogICAgaWYgKG9iaiAhPSBudWxsKSB7CiAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHsKICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgewogICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvciA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpIDoge307CgogICAgICAgICAgaWYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSB7CiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmosIGtleSwgZGVzYyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBuZXdPYmpba2V5XSA9IG9ialtrZXldOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIG5ld09iai5kZWZhdWx0ID0gb2JqOwogICAgcmV0dXJuIG5ld09iajsKICB9Cn0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsKICBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7CiAgfQp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgewogICAgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsKICAgIGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsKICAgIGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsKICAgIGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOwogIH0KfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgewogIGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOwogIGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsKICByZXR1cm4gQ29uc3RydWN0b3I7Cn0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsKICBpZiAoa2V5IGluIG9iaikgewogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7CiAgICAgIHZhbHVlOiB2YWx1ZSwKICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICB3cml0YWJsZTogdHJ1ZQogICAgfSk7CiAgfSBlbHNlIHsKICAgIG9ialtrZXldID0gdmFsdWU7CiAgfQoKICByZXR1cm4gb2JqOwp9CgpmdW5jdGlvbiB1cGRhdGVTdG9yZWQoam9iSWRzKSB7CiAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbShfY29uc3RhbnRzLkpPQl9DT01QTEVUSU9OX05PVElGSUNBVElPTlNfU0VTU0lPTl9LRVksIEpTT04uc3RyaW5naWZ5KGpvYklkcykpOwp9CgpmdW5jdGlvbiBzdW1tYXJpemVKb2Ioc3JjKSB7CiAgcmV0dXJuIHsKICAgIGlkOiBzcmMuX2lkLAogICAgc3RhdHVzOiBzcmMuX3NvdXJjZS5zdGF0dXMsCiAgICB0aXRsZTogc3JjLl9zb3VyY2UucGF5bG9hZC50aXRsZSwKICAgIHR5cGU6IHNyYy5fc291cmNlLnBheWxvYWQudHlwZSwKICAgIG1heFNpemVSZWFjaGVkOiBzcmMuX3NvdXJjZS5vdXRwdXQubWF4X3NpemVfcmVhY2hlZCwKICAgIGNzdkNvbnRhaW5zRm9ybXVsYXM6IHNyYy5fc291cmNlLm91dHB1dC5jc3ZfY29udGFpbnNfZm9ybXVsYXMKICB9Owp9Cgp2YXIgUmVwb3J0aW5nTm90aWZpZXJTdHJlYW1IYW5kbGVyID0KLyojX19QVVJFX18qLwpmdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gUmVwb3J0aW5nTm90aWZpZXJTdHJlYW1IYW5kbGVyKGh0dHAsIG5vdGlmaWNhdGlvbnMpIHsKICAgIHZhciBqb2JRdWV1ZUNsaWVudCA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogX2pvYl9xdWV1ZS5qb2JRdWV1ZUNsaWVudDsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUmVwb3J0aW5nTm90aWZpZXJTdHJlYW1IYW5kbGVyKTsKCiAgICB0aGlzLmh0dHAgPSBodHRwOwogICAgdGhpcy5ub3RpZmljYXRpb25zID0gbm90aWZpY2F0aW9uczsKICAgIHRoaXMuam9iUXVldWVDbGllbnQgPSBqb2JRdWV1ZUNsaWVudDsKCiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgImdldE1hbmFnZW1lbnRMaW5rIiwgdm9pZCAwKTsKCiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgImdldERvd25sb2FkTGluayIsIHZvaWQgMCk7CgogICAgdGhpcy5nZXRNYW5hZ2VtZW50TGluayA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIGh0dHAuYmFzZVBhdGgucHJlcGVuZChfY29uc3RhbnRzLlJFUE9SVElOR19NQU5BR0VNRU5UX0hPTUUpOwogICAgfTsKCiAgICB0aGlzLmdldERvd25sb2FkTGluayA9IGZ1bmN0aW9uIChqb2JJZCkgewogICAgICByZXR1cm4gaHR0cC5iYXNlUGF0aC5wcmVwZW5kKCIiLmNvbmNhdChfY29uc3RhbnRzLkFQSV9CQVNFX1VSTCwgIi9kb3dubG9hZC8iKS5jb25jYXQoam9iSWQpKTsKICAgIH07CiAgfQogIC8qCiAgICogVXNlIEtpYmFuYSBUb2FzdCBBUEkgdG8gc2hvdyBvdXIgbWVzc2FnZXMKICAgKi8KCgogIF9jcmVhdGVDbGFzcyhSZXBvcnRpbmdOb3RpZmllclN0cmVhbUhhbmRsZXIsIFt7CiAgICBrZXk6ICJzaG93Tm90aWZpY2F0aW9ucyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2hvd05vdGlmaWNhdGlvbnMoX3JlZikgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIGNvbXBsZXRlZEpvYnMgPSBfcmVmLmNvbXBsZXRlZCwKICAgICAgICAgIGZhaWxlZEpvYnMgPSBfcmVmLmZhaWxlZDsKCiAgICAgIHZhciBzaG93Tm90aWZpY2F0aW9uc0FzeW5jID0gZnVuY3Rpb24gc2hvd05vdGlmaWNhdGlvbnNBc3luYygpIHsKICAgICAgICB2YXIgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiwgX2RpZEl0ZXJhdG9yRXJyb3IsIF9pdGVyYXRvckVycm9yLCBfaXRlcmF0b3IsIF9zdGVwLCBqb2IsIF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24yLCBfZGlkSXRlcmF0b3JFcnJvcjIsIF9pdGVyYXRvckVycm9yMiwgX2l0ZXJhdG9yMiwgX3N0ZXAyLCBfam9iLCBjb250ZW50OwoKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmFzeW5jKGZ1bmN0aW9uIHNob3dOb3RpZmljYXRpb25zQXN5bmMkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgLy8gbm90aWZpY2F0aW9ucyB3aXRoIGRvd25sb2FkIGxpbmsKICAgICAgICAgICAgICAgIF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSB0cnVlOwogICAgICAgICAgICAgICAgX2RpZEl0ZXJhdG9yRXJyb3IgPSBmYWxzZTsKICAgICAgICAgICAgICAgIF9pdGVyYXRvckVycm9yID0gdW5kZWZpbmVkOwogICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDM7CgogICAgICAgICAgICAgICAgZm9yIChfaXRlcmF0b3IgPSBjb21wbGV0ZWRKb2JzW1N5bWJvbC5pdGVyYXRvcl0oKTsgIShfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gKF9zdGVwID0gX2l0ZXJhdG9yLm5leHQoKSkuZG9uZSk7IF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSB0cnVlKSB7CiAgICAgICAgICAgICAgICAgIGpvYiA9IF9zdGVwLnZhbHVlOwoKICAgICAgICAgICAgICAgICAgaWYgKGpvYi5jc3ZDb250YWluc0Zvcm11bGFzKSB7CiAgICAgICAgICAgICAgICAgICAgX3RoaXMubm90aWZpY2F0aW9ucy50b2FzdHMuYWRkV2FybmluZygoMCwgX2NvbXBvbmVudHMuZ2V0V2FybmluZ0Zvcm11bGFzVG9hc3QpKGpvYiwgX3RoaXMuZ2V0TWFuYWdlbWVudExpbmssIF90aGlzLmdldERvd25sb2FkTGluaykpOwogICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGpvYi5tYXhTaXplUmVhY2hlZCkgewogICAgICAgICAgICAgICAgICAgIF90aGlzLm5vdGlmaWNhdGlvbnMudG9hc3RzLmFkZFdhcm5pbmcoKDAsIF9jb21wb25lbnRzLmdldFdhcm5pbmdNYXhTaXplVG9hc3QpKGpvYiwgX3RoaXMuZ2V0TWFuYWdlbWVudExpbmssIF90aGlzLmdldERvd25sb2FkTGluaykpOwogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIF90aGlzLm5vdGlmaWNhdGlvbnMudG9hc3RzLmFkZFN1Y2Nlc3MoKDAsIF9jb21wb25lbnRzLmdldFN1Y2Nlc3NUb2FzdCkoam9iLCBfdGhpcy5nZXRNYW5hZ2VtZW50TGluaywgX3RoaXMuZ2V0RG93bmxvYWRMaW5rKSk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gLy8gbm8gZG93bmxvYWQgbGluayBhdmFpbGFibGUKCgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDExOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSA3OwogICAgICAgICAgICAgICAgX2NvbnRleHQudDAgPSBfY29udGV4dFsiY2F0Y2giXSgzKTsKICAgICAgICAgICAgICAgIF9kaWRJdGVyYXRvckVycm9yID0gdHJ1ZTsKICAgICAgICAgICAgICAgIF9pdGVyYXRvckVycm9yID0gX2NvbnRleHQudDA7CgogICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMTE7CiAgICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMTI7CgogICAgICAgICAgICAgICAgaWYgKCFfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uICYmIF9pdGVyYXRvci5yZXR1cm4gIT0gbnVsbCkgewogICAgICAgICAgICAgICAgICBfaXRlcmF0b3IucmV0dXJuKCk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMTQ7CgogICAgICAgICAgICAgICAgaWYgKCFfZGlkSXRlcmF0b3JFcnJvcikgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTc7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHRocm93IF9pdGVyYXRvckVycm9yOwoKICAgICAgICAgICAgICBjYXNlIDE3OgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmZpbmlzaCgxNCk7CgogICAgICAgICAgICAgIGNhc2UgMTg6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuZmluaXNoKDExKTsKCiAgICAgICAgICAgICAgY2FzZSAxOToKICAgICAgICAgICAgICAgIF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24yID0gdHJ1ZTsKICAgICAgICAgICAgICAgIF9kaWRJdGVyYXRvckVycm9yMiA9IGZhbHNlOwogICAgICAgICAgICAgICAgX2l0ZXJhdG9yRXJyb3IyID0gdW5kZWZpbmVkOwogICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDIyOwogICAgICAgICAgICAgICAgX2l0ZXJhdG9yMiA9IGZhaWxlZEpvYnNbU3ltYm9sLml0ZXJhdG9yXSgpOwoKICAgICAgICAgICAgICBjYXNlIDI0OgogICAgICAgICAgICAgICAgaWYgKF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24yID0gKF9zdGVwMiA9IF9pdGVyYXRvcjIubmV4dCgpKS5kb25lKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzMzsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2pvYiA9IF9zdGVwMi52YWx1ZTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyODsKICAgICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAoX3RoaXMuam9iUXVldWVDbGllbnQuZ2V0Q29udGVudChfdGhpcy5odHRwLCBfam9iLmlkKSk7CgogICAgICAgICAgICAgIGNhc2UgMjg6CiAgICAgICAgICAgICAgICBjb250ZW50ID0gX2NvbnRleHQuc2VudDsKCiAgICAgICAgICAgICAgICBfdGhpcy5ub3RpZmljYXRpb25zLnRvYXN0cy5hZGREYW5nZXIoKDAsIF9jb21wb25lbnRzLmdldEZhaWx1cmVUb2FzdCkoY29udGVudCwgX2pvYiwgX3RoaXMuZ2V0TWFuYWdlbWVudExpbmspKTsKCiAgICAgICAgICAgICAgY2FzZSAzMDoKICAgICAgICAgICAgICAgIF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24yID0gdHJ1ZTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyNDsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDMzOgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDM5OwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMzU6CiAgICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMzU7CiAgICAgICAgICAgICAgICBfY29udGV4dC50MSA9IF9jb250ZXh0WyJjYXRjaCJdKDIyKTsKICAgICAgICAgICAgICAgIF9kaWRJdGVyYXRvckVycm9yMiA9IHRydWU7CiAgICAgICAgICAgICAgICBfaXRlcmF0b3JFcnJvcjIgPSBfY29udGV4dC50MTsKCiAgICAgICAgICAgICAgY2FzZSAzOToKICAgICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAzOTsKICAgICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSA0MDsKCiAgICAgICAgICAgICAgICBpZiAoIV9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24yICYmIF9pdGVyYXRvcjIucmV0dXJuICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgX2l0ZXJhdG9yMi5yZXR1cm4oKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2FzZSA0MjoKICAgICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSA0MjsKCiAgICAgICAgICAgICAgICBpZiAoIV9kaWRJdGVyYXRvckVycm9yMikgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNDU7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHRocm93IF9pdGVyYXRvckVycm9yMjsKCiAgICAgICAgICAgICAgY2FzZSA0NToKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5maW5pc2goNDIpOwoKICAgICAgICAgICAgICBjYXNlIDQ2OgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmZpbmlzaCgzOSk7CgogICAgICAgICAgICAgIGNhc2UgNDc6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCB7CiAgICAgICAgICAgICAgICAgIGNvbXBsZXRlZDogY29tcGxldGVkSm9icywKICAgICAgICAgICAgICAgICAgZmFpbGVkOiBmYWlsZWRKb2JzCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSA0ODoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIG51bGwsIG51bGwsIFtbMywgNywgMTEsIDE5XSwgWzEyLCwgMTQsIDE4XSwgWzIyLCAzNSwgMzksIDQ3XSwgWzQwLCwgNDIsIDQ2XV0pOwogICAgICB9OwoKICAgICAgcmV0dXJuIFJ4LmZyb20oc2hvd05vdGlmaWNhdGlvbnNBc3luYygpKTsgLy8gY29udmVydCBQcm9taXNlIHRvIE9ic2VydmFibGUsIGZvciB0aGUgY29udmVuaWVuY2Ugb2YgdGhlIG1haW4gc3RyZWFtCiAgICB9CiAgICAvKgogICAgICogQW4gb2JzZXJ2YWJsZSB0aGF0IGZpbmRzIGpvYnMgdGhhdCBhcmUga25vd24gdG8gYmUgInByb2Nlc3NpbmciIChzdG9yZWQgaW4KICAgICAqIHNlc3Npb24gc3RvcmFnZSkgYnV0IGhhdmUgbm9uLXByb2Nlc3Npbmcgam9iIHN0YXR1cyBvbiB0aGUgc2VydmVyCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZmluZENoYW5nZWRTdGF0dXNKb2JzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBmaW5kQ2hhbmdlZFN0YXR1c0pvYnMoc3RvcmVkSm9icykgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHJldHVybiBSeC5mcm9tKHRoaXMuam9iUXVldWVDbGllbnQuZmluZEZvckpvYklkcyh0aGlzLmh0dHAsIHN0b3JlZEpvYnMpKS5waXBlKCgwLCBfb3BlcmF0b3JzLm1hcCkoZnVuY3Rpb24gKGpvYnMpIHsKICAgICAgICB2YXIgY29tcGxldGVkSm9icyA9IFtdOwogICAgICAgIHZhciBmYWlsZWRKb2JzID0gW107CiAgICAgICAgdmFyIHBlbmRpbmcgPSBbXTsgLy8gYWRkIHNpZGUgZWZmZWN0cyB0byBzdG9yYWdlCgogICAgICAgIHZhciBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMyA9IHRydWU7CiAgICAgICAgdmFyIF9kaWRJdGVyYXRvckVycm9yMyA9IGZhbHNlOwogICAgICAgIHZhciBfaXRlcmF0b3JFcnJvcjMgPSB1bmRlZmluZWQ7CgogICAgICAgIHRyeSB7CiAgICAgICAgICBmb3IgKHZhciBfaXRlcmF0b3IzID0gam9ic1tTeW1ib2wuaXRlcmF0b3JdKCksIF9zdGVwMzsgIShfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMyA9IChfc3RlcDMgPSBfaXRlcmF0b3IzLm5leHQoKSkuZG9uZSk7IF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24zID0gdHJ1ZSkgewogICAgICAgICAgICB2YXIgX2pvYjIgPSBfc3RlcDMudmFsdWU7CiAgICAgICAgICAgIHZhciBqb2JJZCA9IF9qb2IyLl9pZCwKICAgICAgICAgICAgICAgIGpvYlN0YXR1cyA9IF9qb2IyLl9zb3VyY2Uuc3RhdHVzOwoKICAgICAgICAgICAgaWYgKHN0b3JlZEpvYnMuaW5jbHVkZXMoam9iSWQpKSB7CiAgICAgICAgICAgICAgaWYgKGpvYlN0YXR1cyA9PT0gX2NvbnN0YW50cy5KT0JfU1RBVFVTX0NPTVBMRVRFRCkgewogICAgICAgICAgICAgICAgY29tcGxldGVkSm9icy5wdXNoKHN1bW1hcml6ZUpvYihfam9iMikpOwogICAgICAgICAgICAgIH0gZWxzZSBpZiAoam9iU3RhdHVzID09PSBfY29uc3RhbnRzLkpPQl9TVEFUVVNfRkFJTEVEKSB7CiAgICAgICAgICAgICAgICBmYWlsZWRKb2JzLnB1c2goc3VtbWFyaXplSm9iKF9qb2IyKSk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHBlbmRpbmcucHVzaChqb2JJZCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICBfZGlkSXRlcmF0b3JFcnJvcjMgPSB0cnVlOwogICAgICAgICAgX2l0ZXJhdG9yRXJyb3IzID0gZXJyOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICB0cnkgewogICAgICAgICAgICBpZiAoIV9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24zICYmIF9pdGVyYXRvcjMucmV0dXJuICE9IG51bGwpIHsKICAgICAgICAgICAgICBfaXRlcmF0b3IzLnJldHVybigpOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBpZiAoX2RpZEl0ZXJhdG9yRXJyb3IzKSB7CiAgICAgICAgICAgICAgdGhyb3cgX2l0ZXJhdG9yRXJyb3IzOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICB1cGRhdGVTdG9yZWQocGVuZGluZyk7IC8vIHJlZnJlc2ggdGhlIHN0b3JhZ2Ugb2YgcGVuZGluZyBqb2IgSURzLCBtaW51cyBjb21wbGV0ZWQgYW5kIGZhaWxlZCBqb2IgSURzCgogICAgICAgIHJldHVybiB7CiAgICAgICAgICBjb21wbGV0ZWQ6IGNvbXBsZXRlZEpvYnMsCiAgICAgICAgICBmYWlsZWQ6IGZhaWxlZEpvYnMKICAgICAgICB9OwogICAgICB9KSwgKDAsIF9vcGVyYXRvcnMuY2F0Y2hFcnJvcikoZnVuY3Rpb24gKGVycikgewogICAgICAgIC8vIHNob3cgY29ubmVjdGlvbiByZWZ1c2VkIHRvYXN0CiAgICAgICAgX3RoaXMyLm5vdGlmaWNhdGlvbnMudG9hc3RzLmFkZERhbmdlcigoMCwgX2NvbXBvbmVudHMuZ2V0R2VuZXJhbEVycm9yVG9hc3QpKF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5yZXBvcnRpbmcucHVibGljTm90aWZpZXIuaHR0cEVycm9yTWVzc2FnZScsIHsKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnQ291bGQgbm90IGNoZWNrIFJlcG9ydGluZyBqb2Igc3RhdHVzIScKICAgICAgICB9KSwgZXJyKSk7IC8vIHByZXR0aWVyLWlnbm9yZQoKCiAgICAgICAgd2luZG93LmNvbnNvbGUuZXJyb3IoZXJyKTsKICAgICAgICByZXR1cm4gUngub2YoewogICAgICAgICAgY29tcGxldGVkOiBbXSwKICAgICAgICAgIGZhaWxlZDogW10KICAgICAgICB9KTsgLy8gbG9nIHRoZSBlcnJvciBhbmQgcmVzdW1lCiAgICAgIH0pKTsKICAgIH0KICB9XSk7CgogIHJldHVybiBSZXBvcnRpbmdOb3RpZmllclN0cmVhbUhhbmRsZXI7Cn0oKTsKCmV4cG9ydHMuUmVwb3J0aW5nTm90aWZpZXJTdHJlYW1IYW5kbGVyID0gUmVwb3J0aW5nTm90aWZpZXJTdHJlYW1IYW5kbGVyOw=="},null]}