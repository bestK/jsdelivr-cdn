{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/snapshot_restore/common/lib/snapshot_serialization.js","dependencies":[{"path":"x-pack/legacy/plugins/snapshot_restore/common/lib/snapshot_serialization.js","mtime":1585205048191},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7IHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB8fCBfbm9uSXRlcmFibGVSZXN0KCk7IH0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVJlc3QoKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2UiKTsgfQoKZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgeyB2YXIgX2FyciA9IFtdOyB2YXIgX24gPSB0cnVlOyB2YXIgX2QgPSBmYWxzZTsgdmFyIF9lID0gdW5kZWZpbmVkOyB0cnkgeyBmb3IgKHZhciBfaSA9IGFycltTeW1ib2wuaXRlcmF0b3JdKCksIF9zOyAhKF9uID0gKF9zID0gX2kubmV4dCgpKS5kb25lKTsgX24gPSB0cnVlKSB7IF9hcnIucHVzaChfcy52YWx1ZSk7IGlmIChpICYmIF9hcnIubGVuZ3RoID09PSBpKSBicmVhazsgfSB9IGNhdGNoIChlcnIpIHsgX2QgPSB0cnVlOyBfZSA9IGVycjsgfSBmaW5hbGx5IHsgdHJ5IHsgaWYgKCFfbiAmJiBfaVsicmV0dXJuIl0gIT0gbnVsbCkgX2lbInJldHVybiJdKCk7IH0gZmluYWxseSB7IGlmIChfZCkgdGhyb3cgX2U7IH0gfSByZXR1cm4gX2FycjsgfQoKZnVuY3Rpb24gX2FycmF5V2l0aEhvbGVzKGFycikgeyBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSByZXR1cm4gYXJyOyB9CgpmdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7IHJldHVybiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5KGFycikgfHwgX25vbkl0ZXJhYmxlU3ByZWFkKCk7IH0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVNwcmVhZCgpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIHNwcmVhZCBub24taXRlcmFibGUgaW5zdGFuY2UiKTsgfQoKZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheShpdGVyKSB7IGlmIChTeW1ib2wuaXRlcmF0b3IgaW4gT2JqZWN0KGl0ZXIpIHx8IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChpdGVyKSA9PT0gIltvYmplY3QgQXJndW1lbnRzXSIpIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpOyB9CgpmdW5jdGlvbiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB7IGlmIChBcnJheS5pc0FycmF5KGFycikpIHsgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkoYXJyLmxlbmd0aCk7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHsgYXJyMltpXSA9IGFycltpXTsgfSByZXR1cm4gYXJyMjsgfSB9CgpmdW5jdGlvbiBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXMoc291cmNlLCBleGNsdWRlZCkgeyBpZiAoc291cmNlID09IG51bGwpIHJldHVybiB7fTsgdmFyIHRhcmdldCA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlKHNvdXJjZSwgZXhjbHVkZWQpOyB2YXIga2V5LCBpOyBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgeyB2YXIgc291cmNlU3ltYm9sS2V5cyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoc291cmNlKTsgZm9yIChpID0gMDsgaSA8IHNvdXJjZVN5bWJvbEtleXMubGVuZ3RoOyBpKyspIHsga2V5ID0gc291cmNlU3ltYm9sS2V5c1tpXTsgaWYgKGV4Y2x1ZGVkLmluZGV4T2Yoa2V5KSA+PSAwKSBjb250aW51ZTsgaWYgKCFPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoc291cmNlLCBrZXkpKSBjb250aW51ZTsgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTsgfSB9IHJldHVybiB0YXJnZXQ7IH0KCmZ1bmN0aW9uIF9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlKHNvdXJjZSwgZXhjbHVkZWQpIHsgaWYgKHNvdXJjZSA9PSBudWxsKSByZXR1cm4ge307IHZhciB0YXJnZXQgPSB7fTsgdmFyIHNvdXJjZUtleXMgPSBPYmplY3Qua2V5cyhzb3VyY2UpOyB2YXIga2V5LCBpOyBmb3IgKGkgPSAwOyBpIDwgc291cmNlS2V5cy5sZW5ndGg7IGkrKykgeyBrZXkgPSBzb3VyY2VLZXlzW2ldOyBpZiAoZXhjbHVkZWQuaW5kZXhPZihrZXkpID49IDApIGNvbnRpbnVlOyB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldOyB9IHJldHVybiB0YXJnZXQ7IH0KCmZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiKSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfTsgfSBlbHNlIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyAic3ltYm9sIiA6IHR5cGVvZiBvYmo7IH07IH0gcmV0dXJuIF90eXBlb2Yob2JqKTsgfQoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmRlc2VyaWFsaXplU25hcHNob3REZXRhaWxzID0gZGVzZXJpYWxpemVTbmFwc2hvdERldGFpbHM7CmV4cG9ydHMuZGVzZXJpYWxpemVTbmFwc2hvdENvbmZpZyA9IGRlc2VyaWFsaXplU25hcHNob3RDb25maWc7CmV4cG9ydHMuc2VyaWFsaXplU25hcHNob3RDb25maWcgPSBzZXJpYWxpemVTbmFwc2hvdENvbmZpZzsKZXhwb3J0cy5kZXNlcmlhbGl6ZVNuYXBzaG90UmV0ZW50aW9uID0gZGVzZXJpYWxpemVTbmFwc2hvdFJldGVudGlvbjsKZXhwb3J0cy5zZXJpYWxpemVTbmFwc2hvdFJldGVudGlvbiA9IHNlcmlhbGl6ZVNuYXBzaG90UmV0ZW50aW9uOwoKdmFyIF9sb2Rhc2ggPSByZXF1aXJlKCJsb2Rhc2giKTsKCnZhciBfdGltZV9zZXJpYWxpemF0aW9uID0gcmVxdWlyZSgiLi90aW1lX3NlcmlhbGl6YXRpb24iKTsKLyoKICogQ29weXJpZ2h0IEVsYXN0aWNzZWFyY2ggQi5WLiBhbmQvb3IgbGljZW5zZWQgdG8gRWxhc3RpY3NlYXJjaCBCLlYuIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vuc2UgYWdyZWVtZW50cy4gTGljZW5zZWQgdW5kZXIgdGhlIEVsYXN0aWMgTGljZW5zZTsKICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBFbGFzdGljIExpY2Vuc2UuCiAqLwoKCmZ1bmN0aW9uIGRlc2VyaWFsaXplU25hcHNob3REZXRhaWxzKHJlcG9zaXRvcnksIHNuYXBzaG90RGV0YWlsc0VzLCBtYW5hZ2VkUmVwb3NpdG9yeSwgc3VjY2Vzc2Z1bFNuYXBzaG90cykgewogIGlmICghc25hcHNob3REZXRhaWxzRXMgfHwgX3R5cGVvZihzbmFwc2hvdERldGFpbHNFcykgIT09ICdvYmplY3QnKSB7CiAgICB0aHJvdyBuZXcgRXJyb3IoJ1VuYWJsZSB0byBkZXNlcmlhbGl6ZSBzbmFwc2hvdCBkZXRhaWxzJyk7CiAgfQoKICB2YXIgc25hcHNob3QgPSBzbmFwc2hvdERldGFpbHNFcy5zbmFwc2hvdCwKICAgICAgdXVpZCA9IHNuYXBzaG90RGV0YWlsc0VzLnV1aWQsCiAgICAgIHZlcnNpb25JZCA9IHNuYXBzaG90RGV0YWlsc0VzLnZlcnNpb25faWQsCiAgICAgIHZlcnNpb24gPSBzbmFwc2hvdERldGFpbHNFcy52ZXJzaW9uLAogICAgICBfc25hcHNob3REZXRhaWxzRXMkaW4gPSBzbmFwc2hvdERldGFpbHNFcy5pbmRpY2VzLAogICAgICBpbmRpY2VzID0gX3NuYXBzaG90RGV0YWlsc0VzJGluID09PSB2b2lkIDAgPyBbXSA6IF9zbmFwc2hvdERldGFpbHNFcyRpbiwKICAgICAgaW5jbHVkZUdsb2JhbFN0YXRlID0gc25hcHNob3REZXRhaWxzRXMuaW5jbHVkZV9nbG9iYWxfc3RhdGUsCiAgICAgIHN0YXRlID0gc25hcHNob3REZXRhaWxzRXMuc3RhdGUsCiAgICAgIHN0YXJ0VGltZSA9IHNuYXBzaG90RGV0YWlsc0VzLnN0YXJ0X3RpbWUsCiAgICAgIHN0YXJ0VGltZUluTWlsbGlzID0gc25hcHNob3REZXRhaWxzRXMuc3RhcnRfdGltZV9pbl9taWxsaXMsCiAgICAgIGVuZFRpbWUgPSBzbmFwc2hvdERldGFpbHNFcy5lbmRfdGltZSwKICAgICAgZW5kVGltZUluTWlsbGlzID0gc25hcHNob3REZXRhaWxzRXMuZW5kX3RpbWVfaW5fbWlsbGlzLAogICAgICBkdXJhdGlvbkluTWlsbGlzID0gc25hcHNob3REZXRhaWxzRXMuZHVyYXRpb25faW5fbWlsbGlzLAogICAgICBfc25hcHNob3REZXRhaWxzRXMkZmEgPSBzbmFwc2hvdERldGFpbHNFcy5mYWlsdXJlcywKICAgICAgZmFpbHVyZXMgPSBfc25hcHNob3REZXRhaWxzRXMkZmEgPT09IHZvaWQgMCA/IFtdIDogX3NuYXBzaG90RGV0YWlsc0VzJGZhLAogICAgICBzaGFyZHMgPSBzbmFwc2hvdERldGFpbHNFcy5zaGFyZHMsCiAgICAgIF9zbmFwc2hvdERldGFpbHNFcyRtZSA9IHNuYXBzaG90RGV0YWlsc0VzLm1ldGFkYXRhOwogIF9zbmFwc2hvdERldGFpbHNFcyRtZSA9IF9zbmFwc2hvdERldGFpbHNFcyRtZSA9PT0gdm9pZCAwID8gewogICAgcG9saWN5OiB1bmRlZmluZWQKICB9IDogX3NuYXBzaG90RGV0YWlsc0VzJG1lOwogIHZhciBwb2xpY3lOYW1lID0gX3NuYXBzaG90RGV0YWlsc0VzJG1lLnBvbGljeTsgLy8gSWYgYW4gaW5kZXggaGFzIG11bHRpcGxlIGZhaWx1cmVzLCB3ZSdsbCB3YW50IHRvIHNlZSB0aGVtIGdyb3VwZWQgdG9nZXRoZXIuCgogIHZhciBpbmRleFRvRmFpbHVyZXNNYXAgPSBmYWlsdXJlcy5yZWR1Y2UoZnVuY3Rpb24gKG1hcCwgZmFpbHVyZSkgewogICAgdmFyIGluZGV4ID0gZmFpbHVyZS5pbmRleCwKICAgICAgICByZXN0ID0gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzKGZhaWx1cmUsIFsiaW5kZXgiXSk7CgogICAgaWYgKCFtYXBbaW5kZXhdKSB7CiAgICAgIG1hcFtpbmRleF0gPSB7CiAgICAgICAgaW5kZXg6IGluZGV4LAogICAgICAgIGZhaWx1cmVzOiBbXQogICAgICB9OwogICAgfQoKICAgIG1hcFtpbmRleF0uZmFpbHVyZXMucHVzaChyZXN0KTsKICAgIHJldHVybiBtYXA7CiAgfSwge30pOyAvLyBTb3J0IGFsbCBmYWlsdXJlcyBieSB0aGVpciBzaGFyZC4KCiAgT2JqZWN0LmtleXMoaW5kZXhUb0ZhaWx1cmVzTWFwKS5mb3JFYWNoKGZ1bmN0aW9uIChpbmRleCkgewogICAgaW5kZXhUb0ZhaWx1cmVzTWFwW2luZGV4XS5mYWlsdXJlcyA9ICgwLCBfbG9kYXNoLnNvcnRCeSkoaW5kZXhUb0ZhaWx1cmVzTWFwW2luZGV4XS5mYWlsdXJlcywgZnVuY3Rpb24gKF9yZWYpIHsKICAgICAgdmFyIHNoYXJkID0gX3JlZi5zaGFyZDsKICAgICAgcmV0dXJuIHNoYXJkOwogICAgfSk7CiAgfSk7IC8vIFNvcnQgYnkgaW5kZXggbmFtZS4KCiAgdmFyIGluZGV4RmFpbHVyZXMgPSAoMCwgX2xvZGFzaC5zb3J0QnkpKE9iamVjdC52YWx1ZXMoaW5kZXhUb0ZhaWx1cmVzTWFwKSwgZnVuY3Rpb24gKF9yZWYyKSB7CiAgICB2YXIgaW5kZXggPSBfcmVmMi5pbmRleDsKICAgIHJldHVybiBpbmRleDsKICB9KTsKICB2YXIgc25hcHNob3REZXRhaWxzID0gewogICAgcmVwb3NpdG9yeTogcmVwb3NpdG9yeSwKICAgIHNuYXBzaG90OiBzbmFwc2hvdCwKICAgIHV1aWQ6IHV1aWQsCiAgICB2ZXJzaW9uSWQ6IHZlcnNpb25JZCwKICAgIHZlcnNpb246IHZlcnNpb24sCiAgICBpbmRpY2VzOiBfdG9Db25zdW1hYmxlQXJyYXkoaW5kaWNlcykuc29ydCgpLAogICAgaW5jbHVkZUdsb2JhbFN0YXRlOiBpbmNsdWRlR2xvYmFsU3RhdGUsCiAgICBzdGF0ZTogc3RhdGUsCiAgICBzdGFydFRpbWU6IHN0YXJ0VGltZSwKICAgIHN0YXJ0VGltZUluTWlsbGlzOiBzdGFydFRpbWVJbk1pbGxpcywKICAgIGVuZFRpbWU6IGVuZFRpbWUsCiAgICBlbmRUaW1lSW5NaWxsaXM6IGVuZFRpbWVJbk1pbGxpcywKICAgIGR1cmF0aW9uSW5NaWxsaXM6IGR1cmF0aW9uSW5NaWxsaXMsCiAgICBpbmRleEZhaWx1cmVzOiBpbmRleEZhaWx1cmVzLAogICAgc2hhcmRzOiBzaGFyZHMsCiAgICBtYW5hZ2VkUmVwb3NpdG9yeTogbWFuYWdlZFJlcG9zaXRvcnkKICB9OwoKICBpZiAoc3VjY2Vzc2Z1bFNuYXBzaG90cyAmJiBzdWNjZXNzZnVsU25hcHNob3RzLmxlbmd0aCkgewogICAgc25hcHNob3REZXRhaWxzLmlzTGFzdFN1Y2Nlc3NmdWxTbmFwc2hvdCA9IHN1Y2Nlc3NmdWxTbmFwc2hvdHNbMF0uc25hcHNob3QgPT09IHNuYXBzaG90OwogIH0KCiAgaWYgKHBvbGljeU5hbWUpIHsKICAgIHNuYXBzaG90RGV0YWlscy5wb2xpY3lOYW1lID0gcG9saWN5TmFtZTsKICB9CgogIHJldHVybiBzbmFwc2hvdERldGFpbHM7Cn0KCmZ1bmN0aW9uIGRlc2VyaWFsaXplU25hcHNob3RDb25maWcoc25hcHNob3RDb25maWdFcykgewogIHZhciBpbmRpY2VzID0gc25hcHNob3RDb25maWdFcy5pbmRpY2VzLAogICAgICBpZ25vcmVVbmF2YWlsYWJsZSA9IHNuYXBzaG90Q29uZmlnRXMuaWdub3JlX3VuYXZhaWxhYmxlLAogICAgICBpbmNsdWRlR2xvYmFsU3RhdGUgPSBzbmFwc2hvdENvbmZpZ0VzLmluY2x1ZGVfZ2xvYmFsX3N0YXRlLAogICAgICBwYXJ0aWFsID0gc25hcHNob3RDb25maWdFcy5wYXJ0aWFsLAogICAgICBtZXRhZGF0YSA9IHNuYXBzaG90Q29uZmlnRXMubWV0YWRhdGE7CiAgdmFyIHNuYXBzaG90Q29uZmlnID0gewogICAgaW5kaWNlczogaW5kaWNlcywKICAgIGlnbm9yZVVuYXZhaWxhYmxlOiBpZ25vcmVVbmF2YWlsYWJsZSwKICAgIGluY2x1ZGVHbG9iYWxTdGF0ZTogaW5jbHVkZUdsb2JhbFN0YXRlLAogICAgcGFydGlhbDogcGFydGlhbCwKICAgIG1ldGFkYXRhOiBtZXRhZGF0YQogIH07CiAgcmV0dXJuIE9iamVjdC5lbnRyaWVzKHNuYXBzaG90Q29uZmlnKS5yZWR1Y2UoZnVuY3Rpb24gKGNvbmZpZywgX3JlZjMpIHsKICAgIHZhciBfcmVmNCA9IF9zbGljZWRUb0FycmF5KF9yZWYzLCAyKSwKICAgICAgICBrZXkgPSBfcmVmNFswXSwKICAgICAgICB2YWx1ZSA9IF9yZWY0WzFdOwoKICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIGNvbmZpZ1trZXldID0gdmFsdWU7CiAgICB9CgogICAgcmV0dXJuIGNvbmZpZzsKICB9LCB7fSk7Cn0KCmZ1bmN0aW9uIHNlcmlhbGl6ZVNuYXBzaG90Q29uZmlnKHNuYXBzaG90Q29uZmlnKSB7CiAgdmFyIGluZGljZXMgPSBzbmFwc2hvdENvbmZpZy5pbmRpY2VzLAogICAgICBpZ25vcmVVbmF2YWlsYWJsZSA9IHNuYXBzaG90Q29uZmlnLmlnbm9yZVVuYXZhaWxhYmxlLAogICAgICBpbmNsdWRlR2xvYmFsU3RhdGUgPSBzbmFwc2hvdENvbmZpZy5pbmNsdWRlR2xvYmFsU3RhdGUsCiAgICAgIHBhcnRpYWwgPSBzbmFwc2hvdENvbmZpZy5wYXJ0aWFsLAogICAgICBtZXRhZGF0YSA9IHNuYXBzaG90Q29uZmlnLm1ldGFkYXRhOwogIHZhciBzbmFwc2hvdENvbmZpZ0VzID0gewogICAgaW5kaWNlczogaW5kaWNlcywKICAgIGlnbm9yZV91bmF2YWlsYWJsZTogaWdub3JlVW5hdmFpbGFibGUsCiAgICBpbmNsdWRlX2dsb2JhbF9zdGF0ZTogaW5jbHVkZUdsb2JhbFN0YXRlLAogICAgcGFydGlhbDogcGFydGlhbCwKICAgIG1ldGFkYXRhOiBtZXRhZGF0YQogIH07CiAgcmV0dXJuIE9iamVjdC5lbnRyaWVzKHNuYXBzaG90Q29uZmlnRXMpLnJlZHVjZShmdW5jdGlvbiAoY29uZmlnLCBfcmVmNSkgewogICAgdmFyIF9yZWY2ID0gX3NsaWNlZFRvQXJyYXkoX3JlZjUsIDIpLAogICAgICAgIGtleSA9IF9yZWY2WzBdLAogICAgICAgIHZhbHVlID0gX3JlZjZbMV07CgogICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpIHsKICAgICAgY29uZmlnW2tleV0gPSB2YWx1ZTsKICAgIH0KCiAgICByZXR1cm4gY29uZmlnOwogIH0sIHt9KTsKfQoKZnVuY3Rpb24gZGVzZXJpYWxpemVTbmFwc2hvdFJldGVudGlvbihzbmFwc2hvdFJldGVudGlvbkVzKSB7CiAgdmFyIGV4cGlyZUFmdGVyID0gc25hcHNob3RSZXRlbnRpb25Fcy5leHBpcmVfYWZ0ZXIsCiAgICAgIG1heENvdW50ID0gc25hcHNob3RSZXRlbnRpb25Fcy5tYXhfY291bnQsCiAgICAgIG1pbkNvdW50ID0gc25hcHNob3RSZXRlbnRpb25Fcy5taW5fY291bnQ7CiAgdmFyIGV4cGlyZUFmdGVyVmFsdWU7CiAgdmFyIGV4cGlyZUFmdGVyVW5pdDsKCiAgaWYgKGV4cGlyZUFmdGVyKSB7CiAgICB2YXIgX3JlZjcgPSAoMCwgX3RpbWVfc2VyaWFsaXphdGlvbi5kZXNlcmlhbGl6ZVRpbWUpKGV4cGlyZUFmdGVyKSwKICAgICAgICB0aW1lVmFsdWUgPSBfcmVmNy50aW1lVmFsdWUsCiAgICAgICAgdGltZVVuaXQgPSBfcmVmNy50aW1lVW5pdDsKCiAgICBpZiAodGltZVZhbHVlICYmIHRpbWVVbml0KSB7CiAgICAgIGV4cGlyZUFmdGVyVmFsdWUgPSB0aW1lVmFsdWU7CiAgICAgIGV4cGlyZUFmdGVyVW5pdCA9IHRpbWVVbml0OwogICAgfQogIH0KCiAgdmFyIHNuYXBzaG90UmV0ZW50aW9uID0gewogICAgZXhwaXJlQWZ0ZXJWYWx1ZTogZXhwaXJlQWZ0ZXJWYWx1ZSwKICAgIGV4cGlyZUFmdGVyVW5pdDogZXhwaXJlQWZ0ZXJVbml0LAogICAgbWF4Q291bnQ6IG1heENvdW50LAogICAgbWluQ291bnQ6IG1pbkNvdW50CiAgfTsKICByZXR1cm4gT2JqZWN0LmVudHJpZXMoc25hcHNob3RSZXRlbnRpb24pLnJlZHVjZShmdW5jdGlvbiAocmV0ZW50aW9uLCBfcmVmOCkgewogICAgdmFyIF9yZWY5ID0gX3NsaWNlZFRvQXJyYXkoX3JlZjgsIDIpLAogICAgICAgIGtleSA9IF9yZWY5WzBdLAogICAgICAgIHZhbHVlID0gX3JlZjlbMV07CgogICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpIHsKICAgICAgcmV0ZW50aW9uW2tleV0gPSB2YWx1ZTsKICAgIH0KCiAgICByZXR1cm4gcmV0ZW50aW9uOwogIH0sIHt9KTsKfQoKZnVuY3Rpb24gc2VyaWFsaXplU25hcHNob3RSZXRlbnRpb24oc25hcHNob3RSZXRlbnRpb24pIHsKICB2YXIgZXhwaXJlQWZ0ZXJWYWx1ZSA9IHNuYXBzaG90UmV0ZW50aW9uLmV4cGlyZUFmdGVyVmFsdWUsCiAgICAgIGV4cGlyZUFmdGVyVW5pdCA9IHNuYXBzaG90UmV0ZW50aW9uLmV4cGlyZUFmdGVyVW5pdCwKICAgICAgbWluQ291bnQgPSBzbmFwc2hvdFJldGVudGlvbi5taW5Db3VudCwKICAgICAgbWF4Q291bnQgPSBzbmFwc2hvdFJldGVudGlvbi5tYXhDb3VudDsKICB2YXIgc25hcHNob3RSZXRlbnRpb25FcyA9IHsKICAgIGV4cGlyZV9hZnRlcjogZXhwaXJlQWZ0ZXJWYWx1ZSAmJiBleHBpcmVBZnRlclVuaXQgPyAoMCwgX3RpbWVfc2VyaWFsaXphdGlvbi5zZXJpYWxpemVUaW1lKShleHBpcmVBZnRlclZhbHVlLCBleHBpcmVBZnRlclVuaXQpIDogdW5kZWZpbmVkLAogICAgbWluX2NvdW50OiAhbWluQ291bnQgPyB1bmRlZmluZWQgOiBtaW5Db3VudCwKICAgIG1heF9jb3VudDogIW1heENvdW50ID8gdW5kZWZpbmVkIDogbWF4Q291bnQKICB9OwogIHZhciBmbGF0dGVuZWRTbmFwc2hvdFJldGVudGlvbkVzID0gT2JqZWN0LmVudHJpZXMoc25hcHNob3RSZXRlbnRpb25FcykucmVkdWNlKGZ1bmN0aW9uIChyZXRlbnRpb24sIF9yZWYxMCkgewogICAgdmFyIF9yZWYxMSA9IF9zbGljZWRUb0FycmF5KF9yZWYxMCwgMiksCiAgICAgICAga2V5ID0gX3JlZjExWzBdLAogICAgICAgIHZhbHVlID0gX3JlZjExWzFdOwoKICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIHJldGVudGlvbltrZXldID0gdmFsdWU7CiAgICB9CgogICAgcmV0dXJuIHJldGVudGlvbjsKICB9LCB7fSk7CiAgcmV0dXJuIE9iamVjdC5lbnRyaWVzKGZsYXR0ZW5lZFNuYXBzaG90UmV0ZW50aW9uRXMpLmxlbmd0aCA/IGZsYXR0ZW5lZFNuYXBzaG90UmV0ZW50aW9uRXMgOiB1bmRlZmluZWQ7Cn0="},null]}