{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/infra/public/components/logging/log_text_stream/scrollable_log_text_stream_view.js","dependencies":[{"path":"x-pack/legacy/plugins/infra/public/components/logging/log_text_stream/scrollable_log_text_stream_view.js","mtime":1585205044625},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiKSB7IF90eXBlb2YyID0gZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mMiA9IGZ1bmN0aW9uIF90eXBlb2YyKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mMihvYmopOyB9CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuU2Nyb2xsYWJsZUxvZ1RleHRTdHJlYW1WaWV3ID0gdm9pZCAwOwoKdmFyIF9pMThuID0gcmVxdWlyZSgiQGtibi9pMThuIik7Cgp2YXIgX3JlYWN0ID0gcmVxdWlyZSgiQGtibi9pMThuL3JlYWN0Iik7Cgp2YXIgX3JlYWN0MiA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoInJlYWN0IikpOwoKdmFyIF9tb21lbnQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIm1vbWVudCIpKTsKCnZhciBfZXVpX3N0eWxlZF9jb21wb25lbnRzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCIuLi8uLi8uLi8uLi8uLi8uLi9jb21tb24vZXVpX3N0eWxlZF9jb21wb25lbnRzIikpOwoKdmFyIF9oYW5kbGVycyA9IHJlcXVpcmUoIi4uLy4uLy4uL3V0aWxzL2hhbmRsZXJzIik7Cgp2YXIgX2F1dG9fc2l6ZXIgPSByZXF1aXJlKCIuLi8uLi9hdXRvX3NpemVyIik7Cgp2YXIgX2VtcHR5X3N0YXRlcyA9IHJlcXVpcmUoIi4uLy4uL2VtcHR5X3N0YXRlcyIpOwoKdmFyIF9mb3JtYXR0ZWRfdGltZSA9IHJlcXVpcmUoIi4uLy4uL2Zvcm1hdHRlZF90aW1lIik7Cgp2YXIgX2xvYWRpbmcgPSByZXF1aXJlKCIuLi8uLi9sb2FkaW5nIik7Cgp2YXIgX2l0ZW0gPSByZXF1aXJlKCIuL2l0ZW0iKTsKCnZhciBfY29sdW1uX2hlYWRlcnMgPSByZXF1aXJlKCIuL2NvbHVtbl9oZWFkZXJzIik7Cgp2YXIgX2xvYWRpbmdfaXRlbV92aWV3ID0gcmVxdWlyZSgiLi9sb2FkaW5nX2l0ZW1fdmlldyIpOwoKdmFyIF9qdW1wX3RvX3RhaWwgPSByZXF1aXJlKCIuL2p1bXBfdG9fdGFpbCIpOwoKdmFyIF9sb2dfZW50cnlfcm93ID0gcmVxdWlyZSgiLi9sb2dfZW50cnlfcm93Iik7Cgp2YXIgX21lYXN1cmFibGVfaXRlbV92aWV3ID0gcmVxdWlyZSgiLi9tZWFzdXJhYmxlX2l0ZW1fdmlldyIpOwoKdmFyIF92ZXJ0aWNhbF9zY3JvbGxfcGFuZWwgPSByZXF1aXJlKCIuL3ZlcnRpY2FsX3Njcm9sbF9wYW5lbCIpOwoKdmFyIF9sb2dfZW50cnlfY29sdW1uID0gcmVxdWlyZSgiLi9sb2dfZW50cnlfY29sdW1uIik7Cgp2YXIgX3RleHRfc3R5bGVzID0gcmVxdWlyZSgiLi90ZXh0X3N0eWxlcyIpOwoKdmFyIF9sb2dfZGF0ZV9yb3cgPSByZXF1aXJlKCIuL2xvZ19kYXRlX3JvdyIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsKICByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogewogICAgZGVmYXVsdDogb2JqCiAgfTsKfQoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7CiAgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgewogICAgcmV0dXJuIG9iajsKICB9IGVsc2UgewogICAgdmFyIG5ld09iaiA9IHt9OwoKICAgIGlmIChvYmogIT0gbnVsbCkgewogICAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7CiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHsKICAgICAgICAgIHZhciBkZXNjID0gT2JqZWN0LmRlZmluZVByb3BlcnR5ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KSA6IHt9OwoKICAgICAgICAgIGlmIChkZXNjLmdldCB8fCBkZXNjLnNldCkgewogICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobmV3T2JqLCBrZXksIGRlc2MpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBuZXdPYmouZGVmYXVsdCA9IG9iajsKICAgIHJldHVybiBuZXdPYmo7CiAgfQp9CgpmdW5jdGlvbiBfdHlwZW9mKG9iaikgewogIGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIF90eXBlb2YyKFN5bWJvbC5pdGVyYXRvcikgPT09ICJzeW1ib2wiKSB7CiAgICBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsKICAgICAgcmV0dXJuIF90eXBlb2YyKG9iaik7CiAgICB9OwogIH0gZWxzZSB7CiAgICBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsKICAgICAgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogX3R5cGVvZjIob2JqKTsKICAgIH07CiAgfQoKICByZXR1cm4gX3R5cGVvZihvYmopOwp9CgpmdW5jdGlvbiBfdGVtcGxhdGVPYmplY3QyKCkgewogIHZhciBkYXRhID0gX3RhZ2dlZFRlbXBsYXRlTGl0ZXJhbChbIlxuICBvdmVyZmxvdzogaGlkZGVuO1xuICBmbGV4OiAxIDEgMCU7XG4iXSk7CgogIF90ZW1wbGF0ZU9iamVjdDIgPSBmdW5jdGlvbiBfdGVtcGxhdGVPYmplY3QyKCkgewogICAgcmV0dXJuIGRhdGE7CiAgfTsKCiAgcmV0dXJuIGRhdGE7Cn0KCmZ1bmN0aW9uIF90ZW1wbGF0ZU9iamVjdCgpIHsKICB2YXIgZGF0YSA9IF90YWdnZWRUZW1wbGF0ZUxpdGVyYWwoWyJcbiAgb3ZlcmZsb3c6IGhpZGRlbjtcbiAgZGlzcGxheTogZmxleDtcbiAgZmxleDogMSAxIDAlO1xuICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICBhbGlnbi1pdGVtczogc3RyZXRjaDtcbiJdKTsKCiAgX3RlbXBsYXRlT2JqZWN0ID0gZnVuY3Rpb24gX3RlbXBsYXRlT2JqZWN0KCkgewogICAgcmV0dXJuIGRhdGE7CiAgfTsKCiAgcmV0dXJuIGRhdGE7Cn0KCmZ1bmN0aW9uIF90YWdnZWRUZW1wbGF0ZUxpdGVyYWwoc3RyaW5ncywgcmF3KSB7CiAgaWYgKCFyYXcpIHsKICAgIHJhdyA9IHN0cmluZ3Muc2xpY2UoMCk7CiAgfQoKICByZXR1cm4gT2JqZWN0LmZyZWV6ZShPYmplY3QuZGVmaW5lUHJvcGVydGllcyhzdHJpbmdzLCB7CiAgICByYXc6IHsKICAgICAgdmFsdWU6IE9iamVjdC5mcmVlemUocmF3KQogICAgfQogIH0pKTsKfQoKZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7CiAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOwoKICBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgewogICAgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7CiAgICBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7CiAgICAgIHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOwogICAgfSk7CiAgICBrZXlzLnB1c2guYXBwbHkoa2V5cywgc3ltYm9scyk7CiAgfQoKICByZXR1cm4ga2V5czsKfQoKZnVuY3Rpb24gX29iamVjdFNwcmVhZCh0YXJnZXQpIHsKICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgewogICAgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXSAhPSBudWxsID8gYXJndW1lbnRzW2ldIDoge307CgogICAgaWYgKGkgJSAyKSB7CiAgICAgIG93bktleXMoc291cmNlLCB0cnVlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsKICAgICAgfSk7CiAgICB9IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKSB7CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoc291cmNlKSk7CiAgICB9IGVsc2UgewogICAgICBvd25LZXlzKHNvdXJjZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwga2V5KSk7CiAgICAgIH0pOwogICAgfQogIH0KCiAgcmV0dXJuIHRhcmdldDsKfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgewogIGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsKICB9Cn0KCmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsKICBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpKSB7CiAgICByZXR1cm4gY2FsbDsKICB9CgogIHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOwp9CgpmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgewogIF9nZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7CiAgICByZXR1cm4gby5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKG8pOwogIH07CiAgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsKfQoKZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7CiAgaWYgKHNlbGYgPT09IHZvaWQgMCkgewogICAgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsKICB9CgogIHJldHVybiBzZWxmOwp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgewogICAgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsKICAgIGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsKICAgIGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsKICAgIGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOwogIH0KfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgewogIGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOwogIGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsKICByZXR1cm4gQ29uc3RydWN0b3I7Cn0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgewogIGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiIpOwogIH0KCiAgc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7CiAgICBjb25zdHJ1Y3RvcjogewogICAgICB2YWx1ZTogc3ViQ2xhc3MsCiAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICBjb25maWd1cmFibGU6IHRydWUKICAgIH0KICB9KTsKICBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTsKfQoKZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsKICBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsKICAgIG8uX19wcm90b19fID0gcDsKICAgIHJldHVybiBvOwogIH07CgogIHJldHVybiBfc2V0UHJvdG90eXBlT2YobywgcCk7Cn0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsKICBpZiAoa2V5IGluIG9iaikgewogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7CiAgICAgIHZhbHVlOiB2YWx1ZSwKICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICB3cml0YWJsZTogdHJ1ZQogICAgfSk7CiAgfSBlbHNlIHsKICAgIG9ialtrZXldID0gdmFsdWU7CiAgfQoKICByZXR1cm4gb2JqOwp9Cgp2YXIgU2Nyb2xsYWJsZUxvZ1RleHRTdHJlYW1WaWV3ID0KLyojX19QVVJFX18qLwpmdW5jdGlvbiAoX1JlYWN0JFB1cmVDb21wb25lbnQpIHsKICBfaW5oZXJpdHMoU2Nyb2xsYWJsZUxvZ1RleHRTdHJlYW1WaWV3LCBfUmVhY3QkUHVyZUNvbXBvbmVudCk7CgogIF9jcmVhdGVDbGFzcyhTY3JvbGxhYmxlTG9nVGV4dFN0cmVhbVZpZXcsIG51bGwsIFt7CiAgICBrZXk6ICJnZXREZXJpdmVkU3RhdGVGcm9tUHJvcHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldERlcml2ZWRTdGF0ZUZyb21Qcm9wcyhuZXh0UHJvcHMsIHByZXZTdGF0ZSkgewogICAgICB2YXIgaGFzTmV3VGFyZ2V0ID0gbmV4dFByb3BzLnRhcmdldCAmJiBuZXh0UHJvcHMudGFyZ2V0ICE9PSBwcmV2U3RhdGUudGFyZ2V0OwogICAgICB2YXIgaGFzSXRlbXMgPSBuZXh0UHJvcHMuaXRlbXMubGVuZ3RoID4gMDsgLy8gUHJldmVudCBuZXcgZW50cmllcyBmcm9tIGJlaW5nIGFwcGVuZGVkIGFuZCBtb3ZpbmcgdGhlIHN0cmVhbSBmb3J3YXJkIHdoZW4KICAgICAgLy8gdGhlIHVzZXIgaGFzIHNjcm9sbGVkIHVwIGR1cmluZyBsaXZlIHN0cmVhbWluZwoKICAgICAgdmFyIG5leHRJdGVtcyA9IGhhc0l0ZW1zICYmIHByZXZTdGF0ZS5pc1Njcm9sbExvY2tlZCA/IHByZXZTdGF0ZS5pdGVtcyA6IG5leHRQcm9wcy5pdGVtczsKCiAgICAgIGlmIChuZXh0UHJvcHMuaXNTdHJlYW1pbmcgJiYgaGFzSXRlbXMpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgdGFyZ2V0OiBuZXh0UHJvcHMudGFyZ2V0LAogICAgICAgICAgdGFyZ2V0SWQ6ICgwLCBfaXRlbS5nZXRTdHJlYW1JdGVtSWQpKG5leHRQcm9wcy5pdGVtc1tuZXh0UHJvcHMuaXRlbXMubGVuZ3RoIC0gMV0pLAogICAgICAgICAgaXRlbXM6IG5leHRJdGVtcwogICAgICAgIH07CiAgICAgIH0gZWxzZSBpZiAoaGFzTmV3VGFyZ2V0ICYmIGhhc0l0ZW1zKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIHRhcmdldDogbmV4dFByb3BzLnRhcmdldCwKICAgICAgICAgIHRhcmdldElkOiAoMCwgX2l0ZW0uZ2V0U3RyZWFtSXRlbUlkKSgoMCwgX2l0ZW0uZ2V0U3RyZWFtSXRlbUJlZm9yZVRpbWVLZXkpKG5leHRQcm9wcy5pdGVtcywgbmV4dFByb3BzLnRhcmdldCkpLAogICAgICAgICAgaXRlbXM6IG5leHRJdGVtcwogICAgICAgIH07CiAgICAgIH0gZWxzZSBpZiAoIW5leHRQcm9wcy50YXJnZXQgfHwgIWhhc0l0ZW1zKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIHRhcmdldDogbnVsbCwKICAgICAgICAgIHRhcmdldElkOiBudWxsLAogICAgICAgICAgaXRlbXM6IFtdCiAgICAgICAgfTsKICAgICAgfSBlbHNlIGlmIChoYXNJdGVtcyAmJiAobmV4dEl0ZW1zLmxlbmd0aCAhPT0gcHJldlN0YXRlLml0ZW1zLmxlbmd0aCB8fCBuZXh0SXRlbXNbMF0gIT09IHByZXZTdGF0ZS5pdGVtc1swXSkpIHsKICAgICAgICByZXR1cm4gX29iamVjdFNwcmVhZCh7fSwgcHJldlN0YXRlLCB7CiAgICAgICAgICBpdGVtczogbmV4dEl0ZW1zCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBudWxsOwogICAgfQogIH1dKTsKCiAgZnVuY3Rpb24gU2Nyb2xsYWJsZUxvZ1RleHRTdHJlYW1WaWV3KHByb3BzKSB7CiAgICB2YXIgX3RoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFNjcm9sbGFibGVMb2dUZXh0U3RyZWFtVmlldyk7CgogICAgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfZ2V0UHJvdG90eXBlT2YoU2Nyb2xsYWJsZUxvZ1RleHRTdHJlYW1WaWV3KS5jYWxsKHRoaXMsIHByb3BzKSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiaGFuZGxlT3BlbkZseW91dCIsIGZ1bmN0aW9uIChpZCkgewogICAgICBfdGhpcy5wcm9wcy5zZXRGbHlvdXRJdGVtKGlkKTsKCiAgICAgIF90aGlzLnByb3BzLnNldEZseW91dFZpc2liaWxpdHkodHJ1ZSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJoYW5kbGVSZWxvYWQiLCBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciByZWxvYWRJdGVtcyA9IF90aGlzLnByb3BzLnJlbG9hZEl0ZW1zOwoKICAgICAgaWYgKHJlbG9hZEl0ZW1zKSB7CiAgICAgICAgcmVsb2FkSXRlbXMoKTsKICAgICAgfQogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiaGFuZGxlTG9hZE5ld2VySXRlbXMiLCBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBsb2FkTmV3ZXJJdGVtcyA9IF90aGlzLnByb3BzLmxvYWROZXdlckl0ZW1zOwoKICAgICAgaWYgKGxvYWROZXdlckl0ZW1zKSB7CiAgICAgICAgbG9hZE5ld2VySXRlbXMoKTsKICAgICAgfQogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiaGFuZGxlVmlzaWJsZUNoaWxkcmVuQ2hhbmdlIiwgKDAsIF9oYW5kbGVycy5jYWxsV2l0aG91dFJlcGVhdHMpKGZ1bmN0aW9uIChfcmVmKSB7CiAgICAgIHZhciB0b3BDaGlsZCA9IF9yZWYudG9wQ2hpbGQsCiAgICAgICAgICBtaWRkbGVDaGlsZCA9IF9yZWYubWlkZGxlQ2hpbGQsCiAgICAgICAgICBib3R0b21DaGlsZCA9IF9yZWYuYm90dG9tQ2hpbGQsCiAgICAgICAgICBwYWdlc0Fib3ZlID0gX3JlZi5wYWdlc0Fib3ZlLAogICAgICAgICAgcGFnZXNCZWxvdyA9IF9yZWYucGFnZXNCZWxvdywKICAgICAgICAgIGZyb21TY3JvbGwgPSBfcmVmLmZyb21TY3JvbGw7CgogICAgICBpZiAoZnJvbVNjcm9sbCAmJiBfdGhpcy5wcm9wcy5pc1N0cmVhbWluZykgewogICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgIGlzU2Nyb2xsTG9ja2VkOiBwYWdlc0JlbG93ICE9PSAwCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIF90aGlzLnByb3BzLnJlcG9ydFZpc2libGVJbnRlcnZhbCh7CiAgICAgICAgZW5kS2V5OiAoMCwgX2l0ZW0ucGFyc2VTdHJlYW1JdGVtSWQpKGJvdHRvbUNoaWxkKSwKICAgICAgICBtaWRkbGVLZXk6ICgwLCBfaXRlbS5wYXJzZVN0cmVhbUl0ZW1JZCkobWlkZGxlQ2hpbGQpLAogICAgICAgIHBhZ2VzQWZ0ZXJFbmQ6IHBhZ2VzQmVsb3csCiAgICAgICAgcGFnZXNCZWZvcmVTdGFydDogcGFnZXNBYm92ZSwKICAgICAgICBzdGFydEtleTogKDAsIF9pdGVtLnBhcnNlU3RyZWFtSXRlbUlkKSh0b3BDaGlsZCksCiAgICAgICAgZnJvbVNjcm9sbDogZnJvbVNjcm9sbAogICAgICB9KTsKICAgIH0pKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJoYW5kbGVKdW1wVG9UYWlsIiwgZnVuY3Rpb24gKCkgewogICAgICB2YXIgaXRlbXMgPSBfdGhpcy5wcm9wcy5pdGVtczsKICAgICAgdmFyIGxhc3RJdGVtVGFyZ2V0ID0gKDAsIF9pdGVtLmdldFN0cmVhbUl0ZW1JZCkoaXRlbXNbaXRlbXMubGVuZ3RoIC0gMV0pOwoKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIHRhcmdldElkOiBsYXN0SXRlbVRhcmdldCwKICAgICAgICBpc1Njcm9sbExvY2tlZDogZmFsc2UKICAgICAgfSk7CiAgICB9KTsKCiAgICBfdGhpcy5zdGF0ZSA9IHsKICAgICAgdGFyZ2V0OiBudWxsLAogICAgICB0YXJnZXRJZDogbnVsbCwKICAgICAgaXRlbXM6IHByb3BzLml0ZW1zLAogICAgICBpc1Njcm9sbExvY2tlZDogZmFsc2UKICAgIH07CiAgICByZXR1cm4gX3RoaXM7CiAgfQoKICBfY3JlYXRlQ2xhc3MoU2Nyb2xsYWJsZUxvZ1RleHRTdHJlYW1WaWV3LCBbewogICAga2V5OiAicmVuZGVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdmFyIF90aGlzJHByb3BzID0gdGhpcy5wcm9wcywKICAgICAgICAgIGNvbHVtbkNvbmZpZ3VyYXRpb25zID0gX3RoaXMkcHJvcHMuY29sdW1uQ29uZmlndXJhdGlvbnMsCiAgICAgICAgICBjdXJyZW50SGlnaGxpZ2h0S2V5ID0gX3RoaXMkcHJvcHMuY3VycmVudEhpZ2hsaWdodEtleSwKICAgICAgICAgIGhhc01vcmVBZnRlckVuZCA9IF90aGlzJHByb3BzLmhhc01vcmVBZnRlckVuZCwKICAgICAgICAgIGhhc01vcmVCZWZvcmVTdGFydCA9IF90aGlzJHByb3BzLmhhc01vcmVCZWZvcmVTdGFydCwKICAgICAgICAgIGhpZ2hsaWdodGVkSXRlbSA9IF90aGlzJHByb3BzLmhpZ2hsaWdodGVkSXRlbSwKICAgICAgICAgIGlzTG9hZGluZ01vcmUgPSBfdGhpcyRwcm9wcy5pc0xvYWRpbmdNb3JlLAogICAgICAgICAgaXNSZWxvYWRpbmcgPSBfdGhpcyRwcm9wcy5pc1JlbG9hZGluZywKICAgICAgICAgIGlzU3RyZWFtaW5nID0gX3RoaXMkcHJvcHMuaXNTdHJlYW1pbmcsCiAgICAgICAgICBsYXN0TG9hZGVkVGltZSA9IF90aGlzJHByb3BzLmxhc3RMb2FkZWRUaW1lLAogICAgICAgICAgc2NhbGUgPSBfdGhpcyRwcm9wcy5zY2FsZSwKICAgICAgICAgIHdyYXAgPSBfdGhpcyRwcm9wcy53cmFwOwogICAgICB2YXIgX3RoaXMkc3RhdGUgPSB0aGlzLnN0YXRlLAogICAgICAgICAgdGFyZ2V0SWQgPSBfdGhpcyRzdGF0ZS50YXJnZXRJZCwKICAgICAgICAgIGl0ZW1zID0gX3RoaXMkc3RhdGUuaXRlbXMsCiAgICAgICAgICBpc1Njcm9sbExvY2tlZCA9IF90aGlzJHN0YXRlLmlzU2Nyb2xsTG9ja2VkOwogICAgICB2YXIgaGFzSXRlbXMgPSBpdGVtcy5sZW5ndGggPiAwOwogICAgICByZXR1cm4gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoU2Nyb2xsYWJsZUxvZ1RleHRTdHJlYW1WaWV3V3JhcHBlciwgbnVsbCwgaXNSZWxvYWRpbmcgJiYgKCFpc1N0cmVhbWluZyB8fCAhaGFzSXRlbXMpID8gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2xvYWRpbmcuSW5mcmFMb2FkaW5nUGFuZWwsIHsKICAgICAgICB3aWR0aDogIjEwMCUiLAogICAgICAgIGhlaWdodDogIjEwMCUiLAogICAgICAgIHRleHQ6IF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICBpZDogInhwYWNrLmluZnJhLmxvZ3Muc2Nyb2xsYWJsZUxvZ1RleHRTdHJlYW1WaWV3LmxvYWRpbmdFbnRyaWVzTGFiZWwiLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJMb2FkaW5nIGVudHJpZXMiCiAgICAgICAgfSkKICAgICAgfSkgOiAhaGFzSXRlbXMgPyBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZW1wdHlfc3RhdGVzLk5vRGF0YSwgewogICAgICAgIHRpdGxlVGV4dDogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLmluZnJhLmxvZ3MuZW1wdHlWaWV3Lm5vTG9nTWVzc2FnZVRpdGxlJywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdUaGVyZSBhcmUgbm8gbG9nIG1lc3NhZ2VzIHRvIGRpc3BsYXkuJwogICAgICAgIH0pLAogICAgICAgIGJvZHlUZXh0OiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaW5mcmEubG9ncy5lbXB0eVZpZXcubm9Mb2dNZXNzYWdlRGVzY3JpcHRpb24nLCB7CiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1RyeSBhZGp1c3RpbmcgeW91ciBmaWx0ZXIuJwogICAgICAgIH0pLAogICAgICAgIHJlZmV0Y2hUZXh0OiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaW5mcmEubG9ncy5lbXB0eVZpZXcuY2hlY2tGb3JOZXdEYXRhQnV0dG9uTGFiZWwnLCB7CiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0NoZWNrIGZvciBuZXcgZGF0YScKICAgICAgICB9KSwKICAgICAgICBvblJlZmV0Y2g6IHRoaXMuaGFuZGxlUmVsb2FkLAogICAgICAgIHRlc3RTdHJpbmc6ICJsb2dzTm9EYXRhUHJvbXB0IgogICAgICB9KSA6IF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFdpdGhDb2x1bW5XaWR0aHMsIHsKICAgICAgICBjb2x1bW5Db25maWd1cmF0aW9uczogY29sdW1uQ29uZmlndXJhdGlvbnMsCiAgICAgICAgc2NhbGU6IHNjYWxlCiAgICAgIH0sIGZ1bmN0aW9uIChfcmVmMikgewogICAgICAgIHZhciBjb2x1bW5XaWR0aHMgPSBfcmVmMi5jb2x1bW5XaWR0aHMsCiAgICAgICAgICAgIENoYXJhY3RlckRpbWVuc2lvbnNQcm9iZSA9IF9yZWYyLkNoYXJhY3RlckRpbWVuc2lvbnNQcm9iZTsKICAgICAgICByZXR1cm4gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5kZWZhdWx0LkZyYWdtZW50LCBudWxsLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChDaGFyYWN0ZXJEaW1lbnNpb25zUHJvYmUsIG51bGwpLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfY29sdW1uX2hlYWRlcnMuTG9nQ29sdW1uSGVhZGVycywgewogICAgICAgICAgY29sdW1uQ29uZmlndXJhdGlvbnM6IGNvbHVtbkNvbmZpZ3VyYXRpb25zLAogICAgICAgICAgY29sdW1uV2lkdGhzOiBjb2x1bW5XaWR0aHMKICAgICAgICB9KSwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2F1dG9fc2l6ZXIuQXV0b1NpemVyLCB7CiAgICAgICAgICBib3VuZHM6IHRydWUsCiAgICAgICAgICBjb250ZW50OiB0cnVlLAogICAgICAgICAgZGV0ZWN0QW55V2luZG93UmVzaXplOiAiaGVpZ2h0IgogICAgICAgIH0sIGZ1bmN0aW9uIChfcmVmMykgewogICAgICAgICAgdmFyIG1lYXN1cmVSZWYgPSBfcmVmMy5tZWFzdXJlUmVmLAogICAgICAgICAgICAgIF9yZWYzJGJvdW5kcyRoZWlnaHQgPSBfcmVmMy5ib3VuZHMuaGVpZ2h0LAogICAgICAgICAgICAgIGhlaWdodCA9IF9yZWYzJGJvdW5kcyRoZWlnaHQgPT09IHZvaWQgMCA/IDAgOiBfcmVmMyRib3VuZHMkaGVpZ2h0LAogICAgICAgICAgICAgIF9yZWYzJGNvbnRlbnQkd2lkdGggPSBfcmVmMy5jb250ZW50LndpZHRoLAogICAgICAgICAgICAgIHdpZHRoID0gX3JlZjMkY29udGVudCR3aWR0aCA9PT0gdm9pZCAwID8gMCA6IF9yZWYzJGNvbnRlbnQkd2lkdGg7CiAgICAgICAgICByZXR1cm4gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoU2Nyb2xsUGFuZWxTaXplUHJvYmUsIHsKICAgICAgICAgICAgcmVmOiBtZWFzdXJlUmVmCiAgICAgICAgICB9LCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfdmVydGljYWxfc2Nyb2xsX3BhbmVsLlZlcnRpY2FsU2Nyb2xsUGFuZWwsIHsKICAgICAgICAgICAgaGVpZ2h0OiBoZWlnaHQsCiAgICAgICAgICAgIHdpZHRoOiB3aWR0aCwKICAgICAgICAgICAgb25WaXNpYmxlQ2hpbGRyZW5DaGFuZ2U6IF90aGlzMi5oYW5kbGVWaXNpYmxlQ2hpbGRyZW5DaGFuZ2UsCiAgICAgICAgICAgIHRhcmdldDogdGFyZ2V0SWQsCiAgICAgICAgICAgIGhpZGVTY3JvbGxiYXI6IHRydWUsCiAgICAgICAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICdsb2dTdHJlYW0nLAogICAgICAgICAgICBpc0xvY2tlZDogaXNTY3JvbGxMb2NrZWQsCiAgICAgICAgICAgIGVudHJpZXNDb3VudDogaXRlbXMubGVuZ3RoCiAgICAgICAgICB9LCBmdW5jdGlvbiAocmVnaXN0ZXJDaGlsZCkgewogICAgICAgICAgICByZXR1cm4gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5kZWZhdWx0LkZyYWdtZW50LCBudWxsLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfbG9hZGluZ19pdGVtX3ZpZXcuTG9nVGV4dFN0cmVhbUxvYWRpbmdJdGVtVmlldywgewogICAgICAgICAgICAgIGFsaWdubWVudDogImJvdHRvbSIsCiAgICAgICAgICAgICAgaXNMb2FkaW5nOiBpc0xvYWRpbmdNb3JlLAogICAgICAgICAgICAgIGhhc01vcmU6IGhhc01vcmVCZWZvcmVTdGFydCwKICAgICAgICAgICAgICBpc1N0cmVhbWluZzogZmFsc2UsCiAgICAgICAgICAgICAgbGFzdFN0cmVhbWluZ1VwZGF0ZTogbnVsbAogICAgICAgICAgICB9KSwgaXRlbXMubWFwKGZ1bmN0aW9uIChpdGVtLCBpZHgpIHsKICAgICAgICAgICAgICB2YXIgY3VycmVudFRpbWVzdGFtcCA9IGl0ZW0ubG9nRW50cnkua2V5LnRpbWU7CiAgICAgICAgICAgICAgdmFyIHNob3dEYXRlID0gZmFsc2U7CgogICAgICAgICAgICAgIGlmIChpZHggPiAwKSB7CiAgICAgICAgICAgICAgICB2YXIgcHJldlRpbWVzdGFtcCA9IGl0ZW1zW2lkeCAtIDFdLmxvZ0VudHJ5LmtleS50aW1lOwogICAgICAgICAgICAgICAgc2hvd0RhdGUgPSAhKDAsIF9tb21lbnQuZGVmYXVsdCkoY3VycmVudFRpbWVzdGFtcCkuaXNTYW1lKHByZXZUaW1lc3RhbXAsICdkYXknKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHJldHVybiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZyYWdtZW50LCB7CiAgICAgICAgICAgICAgICBrZXk6ICgwLCBfaXRlbS5nZXRTdHJlYW1JdGVtSWQpKGl0ZW0pCiAgICAgICAgICAgICAgfSwgc2hvd0RhdGUgJiYgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2xvZ19kYXRlX3Jvdy5Mb2dEYXRlUm93LCB7CiAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IGN1cnJlbnRUaW1lc3RhbXAKICAgICAgICAgICAgICB9KSwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX21lYXN1cmFibGVfaXRlbV92aWV3Lk1lYXN1cmFibGVJdGVtVmlldywgewogICAgICAgICAgICAgICAgcmVnaXN0ZXI6IHJlZ2lzdGVyQ2hpbGQsCiAgICAgICAgICAgICAgICByZWdpc3RyYXRpb25LZXk6ICgwLCBfaXRlbS5nZXRTdHJlYW1JdGVtSWQpKGl0ZW0pCiAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGl0ZW1NZWFzdXJlUmVmKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2xvZ19lbnRyeV9yb3cuTG9nRW50cnlSb3csIHsKICAgICAgICAgICAgICAgICAgY29sdW1uQ29uZmlndXJhdGlvbnM6IGNvbHVtbkNvbmZpZ3VyYXRpb25zLAogICAgICAgICAgICAgICAgICBjb2x1bW5XaWR0aHM6IGNvbHVtbldpZHRocywKICAgICAgICAgICAgICAgICAgb3BlbkZseW91dFdpdGhJdGVtOiBfdGhpczIuaGFuZGxlT3BlbkZseW91dCwKICAgICAgICAgICAgICAgICAgYm91bmRpbmdCb3hSZWY6IGl0ZW1NZWFzdXJlUmVmLAogICAgICAgICAgICAgICAgICBsb2dFbnRyeTogaXRlbS5sb2dFbnRyeSwKICAgICAgICAgICAgICAgICAgaGlnaGxpZ2h0czogaXRlbS5oaWdobGlnaHRzLAogICAgICAgICAgICAgICAgICBpc0FjdGl2ZUhpZ2hsaWdodDogISFjdXJyZW50SGlnaGxpZ2h0S2V5ICYmIGN1cnJlbnRIaWdobGlnaHRLZXkuZ2lkID09PSBpdGVtLmxvZ0VudHJ5LmdpZCwKICAgICAgICAgICAgICAgICAgc2NhbGU6IHNjYWxlLAogICAgICAgICAgICAgICAgICB3cmFwOiB3cmFwLAogICAgICAgICAgICAgICAgICBpc0hpZ2hsaWdodGVkOiBoaWdobGlnaHRlZEl0ZW0gPyBpdGVtLmxvZ0VudHJ5LmdpZCA9PT0gaGlnaGxpZ2h0ZWRJdGVtIDogZmFsc2UKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0pKTsKICAgICAgICAgICAgfSksIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9sb2FkaW5nX2l0ZW1fdmlldy5Mb2dUZXh0U3RyZWFtTG9hZGluZ0l0ZW1WaWV3LCB7CiAgICAgICAgICAgICAgYWxpZ25tZW50OiAidG9wIiwKICAgICAgICAgICAgICBpc0xvYWRpbmc6IGlzU3RyZWFtaW5nIHx8IGlzTG9hZGluZ01vcmUsCiAgICAgICAgICAgICAgaGFzTW9yZTogaGFzTW9yZUFmdGVyRW5kLAogICAgICAgICAgICAgIGlzU3RyZWFtaW5nOiBpc1N0cmVhbWluZywKICAgICAgICAgICAgICBsYXN0U3RyZWFtaW5nVXBkYXRlOiBpc1N0cmVhbWluZyA/IGxhc3RMb2FkZWRUaW1lIDogbnVsbCwKICAgICAgICAgICAgICBvbkxvYWRNb3JlOiBfdGhpczIuaGFuZGxlTG9hZE5ld2VySXRlbXMKICAgICAgICAgICAgfSksIGlzU2Nyb2xsTG9ja2VkICYmIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9qdW1wX3RvX3RhaWwuTG9nVGV4dFN0cmVhbUp1bXBUb1RhaWwsIHsKICAgICAgICAgICAgICB3aWR0aDogd2lkdGgsCiAgICAgICAgICAgICAgb25DbGlja0p1bXA6IF90aGlzMi5oYW5kbGVKdW1wVG9UYWlsCiAgICAgICAgICAgIH0pKTsKICAgICAgICAgIH0pKTsKICAgICAgICB9KSk7CiAgICAgIH0pKTsKICAgIH0KICB9XSk7CgogIHJldHVybiBTY3JvbGxhYmxlTG9nVGV4dFN0cmVhbVZpZXc7Cn0oX3JlYWN0Mi5kZWZhdWx0LlB1cmVDb21wb25lbnQpOwovKioKICogVGhpcyBmdW5jdGlvbi1hcy1jaGlsZCBjb21wb25lbnQgY2FsY3VsYXRlcyB0aGUgY29sdW1uIHdpZHRocyBiYXNlZCBvbiB0aGUKICogZ2l2ZW4gY29uZmlndXJhdGlvbi4gSXQgZGVwZW5kcyBvbiB0aGUgYENoYXJhY3RlckRpbWVuc2lvbnNQcm9iZWAgaXQgcmV0dXJucwogKiBiZWluZyByZW5kZXJlZCBzbyBpdCBjYW4gbWVhc3VyZSB0aGUgbW9ub3NwYWNlIGNoYXJhY3RlciBzaXplLgogKgogKiBJZiB0aGUgYWJvdmUgY29tcG9uZW50IHdhc24ndCBhIGNsYXNzIGNvbXBvbmVudCwgdGhpcyB3b3VsZCBoYXZlIGJlZW4KICogd3JpdHRlbiBhcyBhIGhvb2suCiAqLwoKCmV4cG9ydHMuU2Nyb2xsYWJsZUxvZ1RleHRTdHJlYW1WaWV3ID0gU2Nyb2xsYWJsZUxvZ1RleHRTdHJlYW1WaWV3OwoKdmFyIFdpdGhDb2x1bW5XaWR0aHMgPSBmdW5jdGlvbiBXaXRoQ29sdW1uV2lkdGhzKF9yZWY0KSB7CiAgdmFyIGNoaWxkcmVuID0gX3JlZjQuY2hpbGRyZW4sCiAgICAgIGNvbHVtbkNvbmZpZ3VyYXRpb25zID0gX3JlZjQuY29sdW1uQ29uZmlndXJhdGlvbnMsCiAgICAgIHNjYWxlID0gX3JlZjQuc2NhbGU7CgogIHZhciBfdXNlTWVhc3VyZWRDaGFyYWN0ZXIgPSAoMCwgX3RleHRfc3R5bGVzLnVzZU1lYXN1cmVkQ2hhcmFjdGVyRGltZW5zaW9ucykoc2NhbGUpLAogICAgICBDaGFyYWN0ZXJEaW1lbnNpb25zUHJvYmUgPSBfdXNlTWVhc3VyZWRDaGFyYWN0ZXIuQ2hhcmFjdGVyRGltZW5zaW9uc1Byb2JlLAogICAgICBkaW1lbnNpb25zID0gX3VzZU1lYXN1cmVkQ2hhcmFjdGVyLmRpbWVuc2lvbnM7CgogIHZhciByZWZlcmVuY2VUaW1lID0gKDAsIF9yZWFjdDIudXNlTWVtbykoZnVuY3Rpb24gKCkgewogICAgcmV0dXJuIERhdGUubm93KCk7CiAgfSwgW10pOwogIHZhciBmb3JtYXR0ZWRDdXJyZW50RGF0ZSA9ICgwLCBfZm9ybWF0dGVkX3RpbWUudXNlRm9ybWF0dGVkVGltZSkocmVmZXJlbmNlVGltZSwgewogICAgZm9ybWF0OiAndGltZScKICB9KTsKICB2YXIgY29sdW1uV2lkdGhzID0gKDAsIF9yZWFjdDIudXNlTWVtbykoZnVuY3Rpb24gKCkgewogICAgcmV0dXJuICgwLCBfbG9nX2VudHJ5X2NvbHVtbi5nZXRDb2x1bW5XaWR0aHMpKGNvbHVtbkNvbmZpZ3VyYXRpb25zLCBkaW1lbnNpb25zLndpZHRoLCBmb3JtYXR0ZWRDdXJyZW50RGF0ZS5sZW5ndGgpOwogIH0sIFtjb2x1bW5Db25maWd1cmF0aW9ucywgZGltZW5zaW9ucy53aWR0aCwgZm9ybWF0dGVkQ3VycmVudERhdGVdKTsKICB2YXIgY2hpbGRQYXJhbXMgPSAoMCwgX3JlYWN0Mi51c2VNZW1vKShmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gewogICAgICBjb2x1bW5XaWR0aHM6IGNvbHVtbldpZHRocywKICAgICAgQ2hhcmFjdGVyRGltZW5zaW9uc1Byb2JlOiBDaGFyYWN0ZXJEaW1lbnNpb25zUHJvYmUKICAgIH07CiAgfSwgW2NvbHVtbldpZHRocywgQ2hhcmFjdGVyRGltZW5zaW9uc1Byb2JlXSk7CiAgcmV0dXJuIGNoaWxkcmVuKGNoaWxkUGFyYW1zKTsKfTsKCnZhciBTY3JvbGxhYmxlTG9nVGV4dFN0cmVhbVZpZXdXcmFwcGVyID0gX2V1aV9zdHlsZWRfY29tcG9uZW50cy5kZWZhdWx0LmRpdihfdGVtcGxhdGVPYmplY3QoKSk7Cgp2YXIgU2Nyb2xsUGFuZWxTaXplUHJvYmUgPSBfZXVpX3N0eWxlZF9jb21wb25lbnRzLmRlZmF1bHQuZGl2KF90ZW1wbGF0ZU9iamVjdDIoKSk7"},null]}