{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/transform/public/app/sections/create_transform/components/step_define/step_define_form.js","dependencies":[{"path":"x-pack/legacy/plugins/transform/public/app/sections/create_transform/components/step_define/step_define_form.js","mtime":1585205048551},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmdldERlZmF1bHRTdGVwRGVmaW5lU3RhdGUgPSBnZXREZWZhdWx0U3RlcERlZmluZVN0YXRlOwpleHBvcnRzLmlzQWdnTmFtZUNvbmZsaWN0ID0gaXNBZ2dOYW1lQ29uZmxpY3Q7CmV4cG9ydHMuU3RlcERlZmluZUZvcm0gPSB2b2lkIDA7Cgp2YXIgX3JlYWN0ID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgicmVhY3QiKSk7Cgp2YXIgX2kxOG4gPSByZXF1aXJlKCJAa2JuL2kxOG4iKTsKCnZhciBfbWV0YWRhdGEgPSByZXF1aXJlKCJ1aS9tZXRhZGF0YSIpOwoKdmFyIF9ub3RpZnkgPSByZXF1aXJlKCJ1aS9ub3RpZnkiKTsKCnZhciBfZXVpID0gcmVxdWlyZSgiQGVsYXN0aWMvZXVpIik7Cgp2YXIgX2NvbW1vbiA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uLy4uLy4uL2NvbW1vbi90eXBlcy9jb21tb24iKTsKCnZhciBfYWdncmVnYXRpb25fZHJvcGRvd24gPSByZXF1aXJlKCIuLi9hZ2dyZWdhdGlvbl9kcm9wZG93biIpOwoKdmFyIF9hZ2dyZWdhdGlvbl9saXN0ID0gcmVxdWlyZSgiLi4vYWdncmVnYXRpb25fbGlzdCIpOwoKdmFyIF9ncm91cF9ieV9saXN0ID0gcmVxdWlyZSgiLi4vZ3JvdXBfYnlfbGlzdCIpOwoKdmFyIF9zb3VyY2VfaW5kZXhfcHJldmlldyA9IHJlcXVpcmUoIi4uL3NvdXJjZV9pbmRleF9wcmV2aWV3Iik7Cgp2YXIgX3Bpdm90X3ByZXZpZXcgPSByZXF1aXJlKCIuL3Bpdm90X3ByZXZpZXciKTsKCnZhciBfc2hhcmVkX2ltcG9ydHMgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi8uLi9zaGFyZWRfaW1wb3J0cyIpOwoKdmFyIF9zd2l0Y2hfbW9kYWwgPSByZXF1aXJlKCIuL3N3aXRjaF9tb2RhbCIpOwoKdmFyIF9raWJhbmEgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9saWIva2liYW5hIik7Cgp2YXIgX2NvbW1vbjIgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9jb21tb24iKTsKCnZhciBfY29tbW9uMyA9IHJlcXVpcmUoIi4vY29tbW9uIik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsKICBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7CiAgICByZXR1cm4gb2JqOwogIH0gZWxzZSB7CiAgICB2YXIgbmV3T2JqID0ge307CgogICAgaWYgKG9iaiAhPSBudWxsKSB7CiAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHsKICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgewogICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvciA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpIDoge307CgogICAgICAgICAgaWYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSB7CiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmosIGtleSwgZGVzYyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBuZXdPYmpba2V5XSA9IG9ialtrZXldOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIG5ld09iai5kZWZhdWx0ID0gb2JqOwogICAgcmV0dXJuIG5ld09iajsKICB9Cn0KCmZ1bmN0aW9uIF9zbGljZWRUb0FycmF5KGFyciwgaSkgewogIHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB8fCBfbm9uSXRlcmFibGVSZXN0KCk7Cn0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVJlc3QoKSB7CiAgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIGRlc3RydWN0dXJlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZSIpOwp9CgpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB7CiAgdmFyIF9hcnIgPSBbXTsKICB2YXIgX24gPSB0cnVlOwogIHZhciBfZCA9IGZhbHNlOwogIHZhciBfZSA9IHVuZGVmaW5lZDsKCiAgdHJ5IHsKICAgIGZvciAodmFyIF9pID0gYXJyW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3M7ICEoX24gPSAoX3MgPSBfaS5uZXh0KCkpLmRvbmUpOyBfbiA9IHRydWUpIHsKICAgICAgX2Fyci5wdXNoKF9zLnZhbHVlKTsKCiAgICAgIGlmIChpICYmIF9hcnIubGVuZ3RoID09PSBpKSBicmVhazsKICAgIH0KICB9IGNhdGNoIChlcnIpIHsKICAgIF9kID0gdHJ1ZTsKICAgIF9lID0gZXJyOwogIH0gZmluYWxseSB7CiAgICB0cnkgewogICAgICBpZiAoIV9uICYmIF9pWyJyZXR1cm4iXSAhPSBudWxsKSBfaVsicmV0dXJuIl0oKTsKICAgIH0gZmluYWxseSB7CiAgICAgIGlmIChfZCkgdGhyb3cgX2U7CiAgICB9CiAgfQoKICByZXR1cm4gX2FycjsKfQoKZnVuY3Rpb24gX2FycmF5V2l0aEhvbGVzKGFycikgewogIGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBhcnI7Cn0KCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgewogIHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsKCiAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsKICAgIHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOwogICAgaWYgKGVudW1lcmFibGVPbmx5KSBzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgewogICAgICByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsKICAgIH0pOwogICAga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOwogIH0KCiAgcmV0dXJuIGtleXM7Cn0KCmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7CiAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsKICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OwoKICAgIGlmIChpICUgMikgewogICAgICBvd25LZXlzKHNvdXJjZSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7CiAgICAgIH0pOwogICAgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgewogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpOwogICAgfSBlbHNlIHsKICAgICAgb3duS2V5cyhzb3VyY2UpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOwogICAgICB9KTsKICAgIH0KICB9CgogIHJldHVybiB0YXJnZXQ7Cn0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsKICBpZiAoa2V5IGluIG9iaikgewogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7CiAgICAgIHZhbHVlOiB2YWx1ZSwKICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICB3cml0YWJsZTogdHJ1ZQogICAgfSk7CiAgfSBlbHNlIHsKICAgIG9ialtrZXldID0gdmFsdWU7CiAgfQoKICByZXR1cm4gb2JqOwp9Cgp2YXIgZGVmYXVsdFNlYXJjaCA9ICcqJzsKdmFyIGVtcHR5U2VhcmNoID0gJyc7CgpmdW5jdGlvbiBnZXREZWZhdWx0U3RlcERlZmluZVN0YXRlKGtpYmFuYUNvbnRleHQpIHsKICByZXR1cm4gewogICAgYWdnTGlzdDoge30sCiAgICBncm91cEJ5TGlzdDoge30sCiAgICBpc0FkdmFuY2VkUGl2b3RFZGl0b3JFbmFibGVkOiBmYWxzZSwKICAgIGlzQWR2YW5jZWRTb3VyY2VFZGl0b3JFbmFibGVkOiBmYWxzZSwKICAgIHNlYXJjaFN0cmluZzoga2liYW5hQ29udGV4dC5jdXJyZW50U2F2ZWRTZWFyY2ggIT09IHVuZGVmaW5lZCA/IGtpYmFuYUNvbnRleHQuY29tYmluZWRRdWVyeSA6IGRlZmF1bHRTZWFyY2gsCiAgICBzZWFyY2hRdWVyeToga2liYW5hQ29udGV4dC5jdXJyZW50U2F2ZWRTZWFyY2ggIT09IHVuZGVmaW5lZCA/IGtpYmFuYUNvbnRleHQuY29tYmluZWRRdWVyeSA6IGRlZmF1bHRTZWFyY2gsCiAgICBzb3VyY2VDb25maWdVcGRhdGVkOiBmYWxzZSwKICAgIHZhbGlkOiBmYWxzZQogIH07Cn0KCmZ1bmN0aW9uIGlzQWdnTmFtZUNvbmZsaWN0KGFnZ05hbWUsIGFnZ0xpc3QsIGdyb3VwQnlMaXN0KSB7CiAgaWYgKGFnZ0xpc3RbYWdnTmFtZV0gIT09IHVuZGVmaW5lZCkgewogICAgX25vdGlmeS50b2FzdE5vdGlmaWNhdGlvbnMuYWRkRGFuZ2VyKF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay50cmFuc2Zvcm0uc3RlcERlZmluZUZvcm0uYWdnRXhpc3RzRXJyb3JNZXNzYWdlJywgewogICAgICBkZWZhdWx0TWVzc2FnZTogIkFuIGFnZ3JlZ2F0aW9uIGNvbmZpZ3VyYXRpb24gd2l0aCB0aGUgbmFtZSAne2FnZ05hbWV9JyBhbHJlYWR5IGV4aXN0cy4iLAogICAgICB2YWx1ZXM6IHsKICAgICAgICBhZ2dOYW1lOiBhZ2dOYW1lCiAgICAgIH0KICAgIH0pKTsKCiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGlmIChncm91cEJ5TGlzdFthZ2dOYW1lXSAhPT0gdW5kZWZpbmVkKSB7CiAgICBfbm90aWZ5LnRvYXN0Tm90aWZpY2F0aW9ucy5hZGREYW5nZXIoX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLnRyYW5zZm9ybS5zdGVwRGVmaW5lRm9ybS5ncm91cEJ5RXhpc3RzRXJyb3JNZXNzYWdlJywgewogICAgICBkZWZhdWx0TWVzc2FnZTogIkEgZ3JvdXAgYnkgY29uZmlndXJhdGlvbiB3aXRoIHRoZSBuYW1lICd7YWdnTmFtZX0nIGFscmVhZHkgZXhpc3RzLiIsCiAgICAgIHZhbHVlczogewogICAgICAgIGFnZ05hbWU6IGFnZ05hbWUKICAgICAgfQogICAgfSkpOwoKICAgIHJldHVybiB0cnVlOwogIH0KCiAgdmFyIGNvbmZsaWN0ID0gZmFsc2U7IC8vIGNoZWNrIHRoZSBuZXcgYWdnTmFtZSBhZ2FpbnN0IGV4aXN0aW5nIGFnZ3MgYW5kIGdyb3VwYnlzCgogIHZhciBhZ2dOYW1lU3BsaXQgPSBhZ2dOYW1lLnNwbGl0KCcuJyk7CiAgdmFyIGFnZ05hbWVDaGVjazsKICBhZ2dOYW1lU3BsaXQuZm9yRWFjaChmdW5jdGlvbiAoYWdnTmFtZVBhcnQpIHsKICAgIGFnZ05hbWVDaGVjayA9IGFnZ05hbWVDaGVjayA9PT0gdW5kZWZpbmVkID8gYWdnTmFtZVBhcnQgOiAiIi5jb25jYXQoYWdnTmFtZUNoZWNrLCAiLiIpLmNvbmNhdChhZ2dOYW1lUGFydCk7CgogICAgaWYgKGFnZ0xpc3RbYWdnTmFtZUNoZWNrXSAhPT0gdW5kZWZpbmVkIHx8IGdyb3VwQnlMaXN0W2FnZ05hbWVDaGVja10gIT09IHVuZGVmaW5lZCkgewogICAgICBfbm90aWZ5LnRvYXN0Tm90aWZpY2F0aW9ucy5hZGREYW5nZXIoX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLnRyYW5zZm9ybS5zdGVwRGVmaW5lRm9ybS5uZXN0ZWRDb25mbGljdEVycm9yTWVzc2FnZScsIHsKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkNvdWxkbid0IGFkZCBjb25maWd1cmF0aW9uICd7YWdnTmFtZX0nIGJlY2F1c2Ugb2YgYSBuZXN0aW5nIGNvbmZsaWN0IHdpdGggJ3thZ2dOYW1lQ2hlY2t9Jy4iLAogICAgICAgIHZhbHVlczogewogICAgICAgICAgYWdnTmFtZTogYWdnTmFtZSwKICAgICAgICAgIGFnZ05hbWVDaGVjazogYWdnTmFtZUNoZWNrCiAgICAgICAgfQogICAgICB9KSk7CgogICAgICBjb25mbGljdCA9IHRydWU7CiAgICB9CiAgfSk7CgogIGlmIChjb25mbGljdCkgewogICAgcmV0dXJuIHRydWU7CiAgfSAvLyBjaGVjayBhbGwgYWdncyBhZ2FpbnN0IG5ldyBhZ2dOYW1lCgoKICBjb25mbGljdCA9IE9iamVjdC5rZXlzKGFnZ0xpc3QpLnNvbWUoZnVuY3Rpb24gKGFnZ0xpc3ROYW1lKSB7CiAgICB2YXIgYWdnTGlzdE5hbWVTcGxpdCA9IGFnZ0xpc3ROYW1lLnNwbGl0KCcuJyk7CiAgICB2YXIgYWdnTGlzdE5hbWVDaGVjazsKICAgIHJldHVybiBhZ2dMaXN0TmFtZVNwbGl0LnNvbWUoZnVuY3Rpb24gKGFnZ0xpc3ROYW1lUGFydCkgewogICAgICBhZ2dMaXN0TmFtZUNoZWNrID0gYWdnTGlzdE5hbWVDaGVjayA9PT0gdW5kZWZpbmVkID8gYWdnTGlzdE5hbWVQYXJ0IDogIiIuY29uY2F0KGFnZ0xpc3ROYW1lQ2hlY2ssICIuIikuY29uY2F0KGFnZ0xpc3ROYW1lUGFydCk7CgogICAgICBpZiAoYWdnTGlzdE5hbWVDaGVjayA9PT0gYWdnTmFtZSkgewogICAgICAgIF9ub3RpZnkudG9hc3ROb3RpZmljYXRpb25zLmFkZERhbmdlcihfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2sudHJhbnNmb3JtLnN0ZXBEZWZpbmVGb3JtLm5lc3RlZEFnZ0xpc3RDb25mbGljdEVycm9yTWVzc2FnZScsIHsKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiQ291bGRuJ3QgYWRkIGNvbmZpZ3VyYXRpb24gJ3thZ2dOYW1lfScgYmVjYXVzZSBvZiBhIG5lc3RpbmcgY29uZmxpY3Qgd2l0aCAne2FnZ0xpc3ROYW1lfScuIiwKICAgICAgICAgIHZhbHVlczogewogICAgICAgICAgICBhZ2dOYW1lOiBhZ2dOYW1lLAogICAgICAgICAgICBhZ2dMaXN0TmFtZTogYWdnTGlzdE5hbWUKICAgICAgICAgIH0KICAgICAgICB9KSk7CgogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICByZXR1cm4gZmFsc2U7CiAgICB9KTsKICB9KTsKCiAgaWYgKGNvbmZsaWN0KSB7CiAgICByZXR1cm4gdHJ1ZTsKICB9IC8vIGNoZWNrIGFsbCBncm91cC1ieXMgYWdhaW5zdCBuZXcgYWdnTmFtZQoKCiAgY29uZmxpY3QgPSBPYmplY3Qua2V5cyhncm91cEJ5TGlzdCkuc29tZShmdW5jdGlvbiAoZ3JvdXBCeUxpc3ROYW1lKSB7CiAgICB2YXIgZ3JvdXBCeUxpc3ROYW1lU3BsaXQgPSBncm91cEJ5TGlzdE5hbWUuc3BsaXQoJy4nKTsKICAgIHZhciBncm91cEJ5TGlzdE5hbWVDaGVjazsKICAgIHJldHVybiBncm91cEJ5TGlzdE5hbWVTcGxpdC5zb21lKGZ1bmN0aW9uIChncm91cEJ5TGlzdE5hbWVQYXJ0KSB7CiAgICAgIGdyb3VwQnlMaXN0TmFtZUNoZWNrID0gZ3JvdXBCeUxpc3ROYW1lQ2hlY2sgPT09IHVuZGVmaW5lZCA/IGdyb3VwQnlMaXN0TmFtZVBhcnQgOiAiIi5jb25jYXQoZ3JvdXBCeUxpc3ROYW1lQ2hlY2ssICIuIikuY29uY2F0KGdyb3VwQnlMaXN0TmFtZVBhcnQpOwoKICAgICAgaWYgKGdyb3VwQnlMaXN0TmFtZUNoZWNrID09PSBhZ2dOYW1lKSB7CiAgICAgICAgX25vdGlmeS50b2FzdE5vdGlmaWNhdGlvbnMuYWRkRGFuZ2VyKF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay50cmFuc2Zvcm0uc3RlcERlZmluZUZvcm0ubmVzdGVkR3JvdXBCeUxpc3RDb25mbGljdEVycm9yTWVzc2FnZScsIHsKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiQ291bGRuJ3QgYWRkIGNvbmZpZ3VyYXRpb24gJ3thZ2dOYW1lfScgYmVjYXVzZSBvZiBhIG5lc3RpbmcgY29uZmxpY3Qgd2l0aCAne2dyb3VwQnlMaXN0TmFtZX0nLiIsCiAgICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgICAgYWdnTmFtZTogYWdnTmFtZSwKICAgICAgICAgICAgZ3JvdXBCeUxpc3ROYW1lOiBncm91cEJ5TGlzdE5hbWUKICAgICAgICAgIH0KICAgICAgICB9KSk7CgogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICByZXR1cm4gZmFsc2U7CiAgICB9KTsKICB9KTsKICByZXR1cm4gY29uZmxpY3Q7Cn0KCnZhciBTdGVwRGVmaW5lRm9ybSA9IF9yZWFjdC5kZWZhdWx0Lm1lbW8oZnVuY3Rpb24gKF9yZWYpIHsKICB2YXIgX3JlZiRvdmVycmlkZXMgPSBfcmVmLm92ZXJyaWRlcywKICAgICAgb3ZlcnJpZGVzID0gX3JlZiRvdmVycmlkZXMgPT09IHZvaWQgMCA/IHt9IDogX3JlZiRvdmVycmlkZXMsCiAgICAgIG9uQ2hhbmdlID0gX3JlZi5vbkNoYW5nZTsKICB2YXIga2liYW5hQ29udGV4dCA9ICgwLCBfa2liYW5hLnVzZUtpYmFuYUNvbnRleHQpKCk7CgogIHZhciBkZWZhdWx0cyA9IF9vYmplY3RTcHJlYWQoe30sIGdldERlZmF1bHRTdGVwRGVmaW5lU3RhdGUoa2liYW5hQ29udGV4dCksIHt9LCBvdmVycmlkZXMpOyAvLyBUaGUgc2VhcmNoIGZpbHRlcgoKCiAgdmFyIF91c2VTdGF0ZSA9ICgwLCBfcmVhY3QudXNlU3RhdGUpKGRlZmF1bHRzLnNlYXJjaFN0cmluZyksCiAgICAgIF91c2VTdGF0ZTIgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUsIDIpLAogICAgICBzZWFyY2hTdHJpbmcgPSBfdXNlU3RhdGUyWzBdLAogICAgICBzZXRTZWFyY2hTdHJpbmcgPSBfdXNlU3RhdGUyWzFdOwoKICB2YXIgX3VzZVN0YXRlMyA9ICgwLCBfcmVhY3QudXNlU3RhdGUpKGRlZmF1bHRzLnNlYXJjaFF1ZXJ5KSwKICAgICAgX3VzZVN0YXRlNCA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZTMsIDIpLAogICAgICBzZWFyY2hRdWVyeSA9IF91c2VTdGF0ZTRbMF0sCiAgICAgIHNldFNlYXJjaFF1ZXJ5ID0gX3VzZVN0YXRlNFsxXTsKCiAgdmFyIF91c2VTdGF0ZTUgPSAoMCwgX3JlYWN0LnVzZVN0YXRlKSh0cnVlKSwKICAgICAgX3VzZVN0YXRlNiA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZTUsIDEpLAogICAgICB1c2VLUUwgPSBfdXNlU3RhdGU2WzBdOwoKICB2YXIgYWRkVG9TZWFyY2ggPSBmdW5jdGlvbiBhZGRUb1NlYXJjaChuZXdTZWFyY2gpIHsKICAgIHZhciBjdXJyZW50RGlzcGxheVNlYXJjaCA9IHNlYXJjaFN0cmluZyA9PT0gZGVmYXVsdFNlYXJjaCA/IGVtcHR5U2VhcmNoIDogc2VhcmNoU3RyaW5nOwogICAgc2V0U2VhcmNoU3RyaW5nKCIiLmNvbmNhdChjdXJyZW50RGlzcGxheVNlYXJjaCwgIiAiKS5jb25jYXQobmV3U2VhcmNoKS50cmltKCkpOwogIH07CgogIHZhciBzZWFyY2hIYW5kbGVyID0gZnVuY3Rpb24gc2VhcmNoSGFuZGxlcihkKSB7CiAgICB2YXIgZmlsdGVyUXVlcnkgPSBkLmZpbHRlclF1ZXJ5LAogICAgICAgIHF1ZXJ5U3RyaW5nID0gZC5xdWVyeVN0cmluZzsKICAgIHZhciBuZXdTZWFyY2ggPSBxdWVyeVN0cmluZyA9PT0gZW1wdHlTZWFyY2ggPyBkZWZhdWx0U2VhcmNoIDogcXVlcnlTdHJpbmc7CiAgICB2YXIgbmV3U2VhcmNoUXVlcnkgPSBmaWx0ZXJRdWVyeS5tYXRjaF9hbGwgJiYgT2JqZWN0LmtleXMoZmlsdGVyUXVlcnkubWF0Y2hfYWxsKS5sZW5ndGggPT09IDAgPyBkZWZhdWx0U2VhcmNoIDogZmlsdGVyUXVlcnk7CiAgICBzZXRTZWFyY2hTdHJpbmcobmV3U2VhcmNoKTsKICAgIHNldFNlYXJjaFF1ZXJ5KG5ld1NlYXJjaFF1ZXJ5KTsKICB9OyAvLyBUaGUgbGlzdCBvZiBzZWxlY3RlZCBncm91cCBieSBmaWVsZHMKCgogIHZhciBfdXNlU3RhdGU3ID0gKDAsIF9yZWFjdC51c2VTdGF0ZSkoZGVmYXVsdHMuZ3JvdXBCeUxpc3QpLAogICAgICBfdXNlU3RhdGU4ID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlNywgMiksCiAgICAgIGdyb3VwQnlMaXN0ID0gX3VzZVN0YXRlOFswXSwKICAgICAgc2V0R3JvdXBCeUxpc3QgPSBfdXNlU3RhdGU4WzFdOwoKICB2YXIgaW5kZXhQYXR0ZXJuID0ga2liYW5hQ29udGV4dC5jdXJyZW50SW5kZXhQYXR0ZXJuOwoKICB2YXIgX2dldFBpdm90RHJvcGRvd25PcHRpID0gKDAsIF9jb21tb24zLmdldFBpdm90RHJvcGRvd25PcHRpb25zKShpbmRleFBhdHRlcm4pLAogICAgICBncm91cEJ5T3B0aW9ucyA9IF9nZXRQaXZvdERyb3Bkb3duT3B0aS5ncm91cEJ5T3B0aW9ucywKICAgICAgZ3JvdXBCeU9wdGlvbnNEYXRhID0gX2dldFBpdm90RHJvcGRvd25PcHRpLmdyb3VwQnlPcHRpb25zRGF0YSwKICAgICAgYWdnT3B0aW9ucyA9IF9nZXRQaXZvdERyb3Bkb3duT3B0aS5hZ2dPcHRpb25zLAogICAgICBhZ2dPcHRpb25zRGF0YSA9IF9nZXRQaXZvdERyb3Bkb3duT3B0aS5hZ2dPcHRpb25zRGF0YTsKCiAgdmFyIGFkZEdyb3VwQnkgPSBmdW5jdGlvbiBhZGRHcm91cEJ5KGQpIHsKICAgIHZhciBsYWJlbCA9IGRbMF0ubGFiZWw7CiAgICB2YXIgY29uZmlnID0gZ3JvdXBCeU9wdGlvbnNEYXRhW2xhYmVsXTsKICAgIHZhciBhZ2dOYW1lID0gY29uZmlnLmFnZ05hbWU7CgogICAgaWYgKGlzQWdnTmFtZUNvbmZsaWN0KGFnZ05hbWUsIGFnZ0xpc3QsIGdyb3VwQnlMaXN0KSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgZ3JvdXBCeUxpc3RbYWdnTmFtZV0gPSBjb25maWc7CiAgICBzZXRHcm91cEJ5TGlzdChfb2JqZWN0U3ByZWFkKHt9LCBncm91cEJ5TGlzdCkpOwogIH07CgogIHZhciB1cGRhdGVHcm91cEJ5ID0gZnVuY3Rpb24gdXBkYXRlR3JvdXBCeShwcmV2aW91c0FnZ05hbWUsIGl0ZW0pIHsKICAgIHZhciBncm91cEJ5TGlzdFdpdGhvdXRQcmV2aW91cyA9IF9vYmplY3RTcHJlYWQoe30sIGdyb3VwQnlMaXN0KTsKCiAgICBkZWxldGUgZ3JvdXBCeUxpc3RXaXRob3V0UHJldmlvdXNbcHJldmlvdXNBZ2dOYW1lXTsKCiAgICBpZiAoaXNBZ2dOYW1lQ29uZmxpY3QoaXRlbS5hZ2dOYW1lLCBhZ2dMaXN0LCBncm91cEJ5TGlzdFdpdGhvdXRQcmV2aW91cykpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGdyb3VwQnlMaXN0V2l0aG91dFByZXZpb3VzW2l0ZW0uYWdnTmFtZV0gPSBpdGVtOwogICAgc2V0R3JvdXBCeUxpc3QoX29iamVjdFNwcmVhZCh7fSwgZ3JvdXBCeUxpc3RXaXRob3V0UHJldmlvdXMpKTsKICB9OwoKICB2YXIgZGVsZXRlR3JvdXBCeSA9IGZ1bmN0aW9uIGRlbGV0ZUdyb3VwQnkoYWdnTmFtZSkgewogICAgZGVsZXRlIGdyb3VwQnlMaXN0W2FnZ05hbWVdOwogICAgc2V0R3JvdXBCeUxpc3QoX29iamVjdFNwcmVhZCh7fSwgZ3JvdXBCeUxpc3QpKTsKICB9OyAvLyBUaGUgbGlzdCBvZiBzZWxlY3RlZCBhZ2dyZWdhdGlvbnMKCgogIHZhciBfdXNlU3RhdGU5ID0gKDAsIF9yZWFjdC51c2VTdGF0ZSkoZGVmYXVsdHMuYWdnTGlzdCksCiAgICAgIF91c2VTdGF0ZTEwID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlOSwgMiksCiAgICAgIGFnZ0xpc3QgPSBfdXNlU3RhdGUxMFswXSwKICAgICAgc2V0QWdnTGlzdCA9IF91c2VTdGF0ZTEwWzFdOwoKICB2YXIgYWRkQWdncmVnYXRpb24gPSBmdW5jdGlvbiBhZGRBZ2dyZWdhdGlvbihkKSB7CiAgICB2YXIgbGFiZWwgPSBkWzBdLmxhYmVsOwogICAgdmFyIGNvbmZpZyA9IGFnZ09wdGlvbnNEYXRhW2xhYmVsXTsKICAgIHZhciBhZ2dOYW1lID0gY29uZmlnLmFnZ05hbWU7CgogICAgaWYgKGlzQWdnTmFtZUNvbmZsaWN0KGFnZ05hbWUsIGFnZ0xpc3QsIGdyb3VwQnlMaXN0KSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgYWdnTGlzdFthZ2dOYW1lXSA9IGNvbmZpZzsKICAgIHNldEFnZ0xpc3QoX29iamVjdFNwcmVhZCh7fSwgYWdnTGlzdCkpOwogIH07CgogIHZhciB1cGRhdGVBZ2dyZWdhdGlvbiA9IGZ1bmN0aW9uIHVwZGF0ZUFnZ3JlZ2F0aW9uKHByZXZpb3VzQWdnTmFtZSwgaXRlbSkgewogICAgdmFyIGFnZ0xpc3RXaXRob3V0UHJldmlvdXMgPSBfb2JqZWN0U3ByZWFkKHt9LCBhZ2dMaXN0KTsKCiAgICBkZWxldGUgYWdnTGlzdFdpdGhvdXRQcmV2aW91c1twcmV2aW91c0FnZ05hbWVdOwoKICAgIGlmIChpc0FnZ05hbWVDb25mbGljdChpdGVtLmFnZ05hbWUsIGFnZ0xpc3RXaXRob3V0UHJldmlvdXMsIGdyb3VwQnlMaXN0KSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgYWdnTGlzdFdpdGhvdXRQcmV2aW91c1tpdGVtLmFnZ05hbWVdID0gaXRlbTsKICAgIHNldEFnZ0xpc3QoX29iamVjdFNwcmVhZCh7fSwgYWdnTGlzdFdpdGhvdXRQcmV2aW91cykpOwogIH07CgogIHZhciBkZWxldGVBZ2dyZWdhdGlvbiA9IGZ1bmN0aW9uIGRlbGV0ZUFnZ3JlZ2F0aW9uKGFnZ05hbWUpIHsKICAgIGRlbGV0ZSBhZ2dMaXN0W2FnZ05hbWVdOwogICAgc2V0QWdnTGlzdChfb2JqZWN0U3ByZWFkKHt9LCBhZ2dMaXN0KSk7CiAgfTsKCiAgdmFyIHBpdm90QWdnc0FyciA9ICgwLCBfY29tbW9uLmRpY3Rpb25hcnlUb0FycmF5KShhZ2dMaXN0KTsKICB2YXIgcGl2b3RHcm91cEJ5QXJyID0gKDAsIF9jb21tb24uZGljdGlvbmFyeVRvQXJyYXkpKGdyb3VwQnlMaXN0KTsKICB2YXIgcGl2b3RRdWVyeSA9IHVzZUtRTCA/ICgwLCBfY29tbW9uMi5nZXRQaXZvdFF1ZXJ5KShzZWFyY2hRdWVyeSkgOiAoMCwgX2NvbW1vbjIuZ2V0UGl2b3RRdWVyeSkoc2VhcmNoU3RyaW5nKTsgLy8gQWR2YW5jZWQgZWRpdG9yIGZvciBwaXZvdCBjb25maWcgc3RhdGUKCiAgdmFyIF91c2VTdGF0ZTExID0gKDAsIF9yZWFjdC51c2VTdGF0ZSkoZmFsc2UpLAogICAgICBfdXNlU3RhdGUxMiA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZTExLCAyKSwKICAgICAgaXNBZHZhbmNlZEVkaXRvclN3aXRjaE1vZGFsVmlzaWJsZSA9IF91c2VTdGF0ZTEyWzBdLAogICAgICBzZXRBZHZhbmNlZEVkaXRvclN3aXRjaE1vZGFsVmlzaWJsZSA9IF91c2VTdGF0ZTEyWzFdOwoKICB2YXIgX3VzZVN0YXRlMTMgPSAoMCwgX3JlYWN0LnVzZVN0YXRlKShmYWxzZSksCiAgICAgIF91c2VTdGF0ZTE0ID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlMTMsIDIpLAogICAgICBpc0FkdmFuY2VkUGl2b3RFZGl0b3JBcHBseUJ1dHRvbkVuYWJsZWQgPSBfdXNlU3RhdGUxNFswXSwKICAgICAgc2V0QWR2YW5jZWRQaXZvdEVkaXRvckFwcGx5QnV0dG9uRW5hYmxlZCA9IF91c2VTdGF0ZTE0WzFdOwoKICB2YXIgX3VzZVN0YXRlMTUgPSAoMCwgX3JlYWN0LnVzZVN0YXRlKShkZWZhdWx0cy5pc0FkdmFuY2VkUGl2b3RFZGl0b3JFbmFibGVkKSwKICAgICAgX3VzZVN0YXRlMTYgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUxNSwgMiksCiAgICAgIGlzQWR2YW5jZWRQaXZvdEVkaXRvckVuYWJsZWQgPSBfdXNlU3RhdGUxNlswXSwKICAgICAgc2V0QWR2YW5jZWRQaXZvdEVkaXRvckVuYWJsZWQgPSBfdXNlU3RhdGUxNlsxXTsgLy8gQWR2YW5jZWQgZWRpdG9yIGZvciBzb3VyY2UgY29uZmlnIHN0YXRlCgoKICB2YXIgX3VzZVN0YXRlMTcgPSAoMCwgX3JlYWN0LnVzZVN0YXRlKShkZWZhdWx0cy5zb3VyY2VDb25maWdVcGRhdGVkKSwKICAgICAgX3VzZVN0YXRlMTggPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUxNywgMiksCiAgICAgIHNvdXJjZUNvbmZpZ1VwZGF0ZWQgPSBfdXNlU3RhdGUxOFswXSwKICAgICAgc2V0U291cmNlQ29uZmlnVXBkYXRlZCA9IF91c2VTdGF0ZTE4WzFdOwoKICB2YXIgX3VzZVN0YXRlMTkgPSAoMCwgX3JlYWN0LnVzZVN0YXRlKShmYWxzZSksCiAgICAgIF91c2VTdGF0ZTIwID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlMTksIDIpLAogICAgICBpc0FkdmFuY2VkU291cmNlRWRpdG9yU3dpdGNoTW9kYWxWaXNpYmxlID0gX3VzZVN0YXRlMjBbMF0sCiAgICAgIHNldEFkdmFuY2VkU291cmNlRWRpdG9yU3dpdGNoTW9kYWxWaXNpYmxlID0gX3VzZVN0YXRlMjBbMV07CgogIHZhciBfdXNlU3RhdGUyMSA9ICgwLCBfcmVhY3QudXNlU3RhdGUpKGRlZmF1bHRzLmlzQWR2YW5jZWRTb3VyY2VFZGl0b3JFbmFibGVkKSwKICAgICAgX3VzZVN0YXRlMjIgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUyMSwgMiksCiAgICAgIGlzQWR2YW5jZWRTb3VyY2VFZGl0b3JFbmFibGVkID0gX3VzZVN0YXRlMjJbMF0sCiAgICAgIHNldEFkdmFuY2VkU291cmNlRWRpdG9yRW5hYmxlZCA9IF91c2VTdGF0ZTIyWzFdOwoKICB2YXIgX3VzZVN0YXRlMjMgPSAoMCwgX3JlYWN0LnVzZVN0YXRlKShmYWxzZSksCiAgICAgIF91c2VTdGF0ZTI0ID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlMjMsIDIpLAogICAgICBpc0FkdmFuY2VkU291cmNlRWRpdG9yQXBwbHlCdXR0b25FbmFibGVkID0gX3VzZVN0YXRlMjRbMF0sCiAgICAgIHNldEFkdmFuY2VkU291cmNlRWRpdG9yQXBwbHlCdXR0b25FbmFibGVkID0gX3VzZVN0YXRlMjRbMV07CgogIHZhciBwcmV2aWV3UmVxdWVzdCA9ICgwLCBfY29tbW9uMi5nZXRQcmV2aWV3UmVxdWVzdEJvZHkpKGluZGV4UGF0dGVybi50aXRsZSwgcGl2b3RRdWVyeSwgcGl2b3RHcm91cEJ5QXJyLCBwaXZvdEFnZ3NBcnIpOyAvLyBwaXZvdCBjb25maWcKCiAgdmFyIHN0cmluZ2lmaWVkUGl2b3RDb25maWcgPSBKU09OLnN0cmluZ2lmeShwcmV2aWV3UmVxdWVzdC5waXZvdCwgbnVsbCwgMik7CgogIHZhciBfdXNlU3RhdGUyNSA9ICgwLCBfcmVhY3QudXNlU3RhdGUpKHN0cmluZ2lmaWVkUGl2b3RDb25maWcpLAogICAgICBfdXNlU3RhdGUyNiA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZTI1LCAyKSwKICAgICAgYWR2YW5jZWRFZGl0b3JDb25maWdMYXN0QXBwbGllZCA9IF91c2VTdGF0ZTI2WzBdLAogICAgICBzZXRBZHZhbmNlZEVkaXRvckNvbmZpZ0xhc3RBcHBsaWVkID0gX3VzZVN0YXRlMjZbMV07CgogIHZhciBfdXNlU3RhdGUyNyA9ICgwLCBfcmVhY3QudXNlU3RhdGUpKHN0cmluZ2lmaWVkUGl2b3RDb25maWcpLAogICAgICBfdXNlU3RhdGUyOCA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZTI3LCAyKSwKICAgICAgYWR2YW5jZWRFZGl0b3JDb25maWcgPSBfdXNlU3RhdGUyOFswXSwKICAgICAgc2V0QWR2YW5jZWRFZGl0b3JDb25maWcgPSBfdXNlU3RhdGUyOFsxXTsgLy8gc291cmNlIGNvbmZpZwoKCiAgdmFyIHN0cmluZ2lmaWVkU291cmNlQ29uZmlnID0gSlNPTi5zdHJpbmdpZnkocHJldmlld1JlcXVlc3Quc291cmNlLnF1ZXJ5LCBudWxsLCAyKTsKCiAgdmFyIF91c2VTdGF0ZTI5ID0gKDAsIF9yZWFjdC51c2VTdGF0ZSkoc3RyaW5naWZpZWRTb3VyY2VDb25maWcpLAogICAgICBfdXNlU3RhdGUzMCA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZTI5LCAyKSwKICAgICAgYWR2YW5jZWRFZGl0b3JTb3VyY2VDb25maWdMYXN0QXBwbGllZCA9IF91c2VTdGF0ZTMwWzBdLAogICAgICBzZXRBZHZhbmNlZEVkaXRvclNvdXJjZUNvbmZpZ0xhc3RBcHBsaWVkID0gX3VzZVN0YXRlMzBbMV07CgogIHZhciBfdXNlU3RhdGUzMSA9ICgwLCBfcmVhY3QudXNlU3RhdGUpKHN0cmluZ2lmaWVkU291cmNlQ29uZmlnKSwKICAgICAgX3VzZVN0YXRlMzIgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUzMSwgMiksCiAgICAgIGFkdmFuY2VkRWRpdG9yU291cmNlQ29uZmlnID0gX3VzZVN0YXRlMzJbMF0sCiAgICAgIHNldEFkdmFuY2VkRWRpdG9yU291cmNlQ29uZmlnID0gX3VzZVN0YXRlMzJbMV07CgogIHZhciBhcHBseUFkdmFuY2VkU291cmNlRWRpdG9yQ2hhbmdlcyA9IGZ1bmN0aW9uIGFwcGx5QWR2YW5jZWRTb3VyY2VFZGl0b3JDaGFuZ2VzKCkgewogICAgdmFyIHNvdXJjZUNvbmZpZyA9IEpTT04ucGFyc2UoYWR2YW5jZWRFZGl0b3JTb3VyY2VDb25maWcpOwogICAgdmFyIHByZXR0eVNvdXJjZUNvbmZpZyA9IEpTT04uc3RyaW5naWZ5KHNvdXJjZUNvbmZpZywgbnVsbCwgMik7IC8vIFN3aXRjaGVkIHRvIGVkaXRvciBzbyB3ZSBjbGVhciBvdXQgdGhlIHNlYXJjaCBzdHJpbmcgYXMgdGhlIGJhciB3b24ndCBiZSB2aXNpYmxlCgogICAgc2V0U2VhcmNoU3RyaW5nKGVtcHR5U2VhcmNoKTsKICAgIHNldFNlYXJjaFF1ZXJ5KHNvdXJjZUNvbmZpZyk7CiAgICBzZXRTb3VyY2VDb25maWdVcGRhdGVkKHRydWUpOwogICAgc2V0QWR2YW5jZWRFZGl0b3JTb3VyY2VDb25maWcocHJldHR5U291cmNlQ29uZmlnKTsKICAgIHNldEFkdmFuY2VkRWRpdG9yU291cmNlQ29uZmlnTGFzdEFwcGxpZWQocHJldHR5U291cmNlQ29uZmlnKTsKICAgIHNldEFkdmFuY2VkU291cmNlRWRpdG9yQXBwbHlCdXR0b25FbmFibGVkKGZhbHNlKTsKICB9OwoKICB2YXIgYXBwbHlBZHZhbmNlZFBpdm90RWRpdG9yQ2hhbmdlcyA9IGZ1bmN0aW9uIGFwcGx5QWR2YW5jZWRQaXZvdEVkaXRvckNoYW5nZXMoKSB7CiAgICB2YXIgcGl2b3RDb25maWcgPSBKU09OLnBhcnNlKGFkdmFuY2VkRWRpdG9yQ29uZmlnKTsKICAgIHZhciBuZXdHcm91cEJ5TGlzdCA9IHt9OwoKICAgIGlmIChwaXZvdENvbmZpZyAhPT0gdW5kZWZpbmVkICYmIHBpdm90Q29uZmlnLmdyb3VwX2J5ICE9PSB1bmRlZmluZWQpIHsKICAgICAgT2JqZWN0LmVudHJpZXMocGl2b3RDb25maWcuZ3JvdXBfYnkpLmZvckVhY2goZnVuY3Rpb24gKGQpIHsKICAgICAgICB2YXIgYWdnTmFtZSA9IGRbMF07CiAgICAgICAgdmFyIGFnZ0NvbmZpZyA9IGRbMV07CiAgICAgICAgdmFyIGFnZ0NvbmZpZ0tleXMgPSBPYmplY3Qua2V5cyhhZ2dDb25maWcpOwogICAgICAgIHZhciBhZ2cgPSBhZ2dDb25maWdLZXlzWzBdOwogICAgICAgIG5ld0dyb3VwQnlMaXN0W2FnZ05hbWVdID0gX29iamVjdFNwcmVhZCh7CiAgICAgICAgICBhZ2c6IGFnZywKICAgICAgICAgIGFnZ05hbWU6IGFnZ05hbWUsCiAgICAgICAgICBkcm9wRG93bk5hbWU6ICcnCiAgICAgICAgfSwgYWdnQ29uZmlnW2FnZ10pOwogICAgICB9KTsKICAgIH0KCiAgICBzZXRHcm91cEJ5TGlzdChuZXdHcm91cEJ5TGlzdCk7CiAgICB2YXIgbmV3QWdnTGlzdCA9IHt9OwoKICAgIGlmIChwaXZvdENvbmZpZyAhPT0gdW5kZWZpbmVkICYmIHBpdm90Q29uZmlnLmFnZ3JlZ2F0aW9ucyAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIE9iamVjdC5lbnRyaWVzKHBpdm90Q29uZmlnLmFnZ3JlZ2F0aW9ucykuZm9yRWFjaChmdW5jdGlvbiAoZCkgewogICAgICAgIHZhciBhZ2dOYW1lID0gZFswXTsKICAgICAgICB2YXIgYWdnQ29uZmlnID0gZFsxXTsKICAgICAgICB2YXIgYWdnQ29uZmlnS2V5cyA9IE9iamVjdC5rZXlzKGFnZ0NvbmZpZyk7CiAgICAgICAgdmFyIGFnZyA9IGFnZ0NvbmZpZ0tleXNbMF07CiAgICAgICAgbmV3QWdnTGlzdFthZ2dOYW1lXSA9IF9vYmplY3RTcHJlYWQoewogICAgICAgICAgYWdnOiBhZ2csCiAgICAgICAgICBhZ2dOYW1lOiBhZ2dOYW1lLAogICAgICAgICAgZHJvcERvd25OYW1lOiAnJwogICAgICAgIH0sIGFnZ0NvbmZpZ1thZ2ddKTsKICAgICAgfSk7CiAgICB9CgogICAgc2V0QWdnTGlzdChuZXdBZ2dMaXN0KTsKICAgIHZhciBwcmV0dHlQaXZvdENvbmZpZyA9IEpTT04uc3RyaW5naWZ5KHBpdm90Q29uZmlnLCBudWxsLCAyKTsKICAgIHNldEFkdmFuY2VkRWRpdG9yQ29uZmlnKHByZXR0eVBpdm90Q29uZmlnKTsKICAgIHNldEFkdmFuY2VkRWRpdG9yQ29uZmlnTGFzdEFwcGxpZWQocHJldHR5UGl2b3RDb25maWcpOwogICAgc2V0QWR2YW5jZWRQaXZvdEVkaXRvckFwcGx5QnV0dG9uRW5hYmxlZChmYWxzZSk7CiAgfTsKCiAgdmFyIHRvZ2dsZUFkdmFuY2VkRWRpdG9yID0gZnVuY3Rpb24gdG9nZ2xlQWR2YW5jZWRFZGl0b3IoKSB7CiAgICBzZXRBZHZhbmNlZEVkaXRvckNvbmZpZyhhZHZhbmNlZEVkaXRvckNvbmZpZyk7CiAgICBzZXRBZHZhbmNlZFBpdm90RWRpdG9yRW5hYmxlZCghaXNBZHZhbmNlZFBpdm90RWRpdG9yRW5hYmxlZCk7CiAgICBzZXRBZHZhbmNlZFBpdm90RWRpdG9yQXBwbHlCdXR0b25FbmFibGVkKGZhbHNlKTsKCiAgICBpZiAoaXNBZHZhbmNlZFBpdm90RWRpdG9yRW5hYmxlZCA9PT0gZmFsc2UpIHsKICAgICAgc2V0QWR2YW5jZWRFZGl0b3JDb25maWdMYXN0QXBwbGllZChhZHZhbmNlZEVkaXRvckNvbmZpZyk7CiAgICB9CiAgfTsgLy8gSWYgc3dpdGNoaW5nIHRvIEtRTCBhZnRlciB1cGRhdGluZyB2aWEgZWRpdG9yIC0gcmVzZXQgc2VhcmNoCgoKICB2YXIgdG9nZ2xlQWR2YW5jZWRTb3VyY2VFZGl0b3IgPSBmdW5jdGlvbiB0b2dnbGVBZHZhbmNlZFNvdXJjZUVkaXRvcigpIHsKICAgIHZhciByZXNldCA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogZmFsc2U7CgogICAgaWYgKHJlc2V0ID09PSB0cnVlKSB7CiAgICAgIHNldFNlYXJjaFF1ZXJ5KGRlZmF1bHRTZWFyY2gpOwogICAgICBzZXRTZWFyY2hTdHJpbmcoZGVmYXVsdFNlYXJjaCk7CiAgICAgIHNldFNvdXJjZUNvbmZpZ1VwZGF0ZWQoZmFsc2UpOwogICAgfQoKICAgIGlmIChpc0FkdmFuY2VkU291cmNlRWRpdG9yRW5hYmxlZCA9PT0gZmFsc2UpIHsKICAgICAgc2V0QWR2YW5jZWRFZGl0b3JTb3VyY2VDb25maWdMYXN0QXBwbGllZChhZHZhbmNlZEVkaXRvclNvdXJjZUNvbmZpZyk7CiAgICB9CgogICAgc2V0QWR2YW5jZWRTb3VyY2VFZGl0b3JFbmFibGVkKCFpc0FkdmFuY2VkU291cmNlRWRpdG9yRW5hYmxlZCk7CiAgICBzZXRBZHZhbmNlZFNvdXJjZUVkaXRvckFwcGx5QnV0dG9uRW5hYmxlZChmYWxzZSk7CiAgfTsgLy8gbWV0YWRhdGEuYnJhbmNoIGNvcnJlc3BvbmRzIHRvIHRoZSB2ZXJzaW9uIHVzZWQgaW4gZG9jdW1lbnRhdGlvbiBsaW5rcy4KCgogIHZhciBkb2NzVXJsID0gImh0dHBzOi8vd3d3LmVsYXN0aWMuY28vZ3VpZGUvZW4vZWxhc3RpY3NlYXJjaC9yZWZlcmVuY2UvIi5jb25jYXQoX21ldGFkYXRhLm1ldGFkYXRhLmJyYW5jaCwgIi90cmFuc2Zvcm0tcmVzb3VyY2UuaHRtbCN0cmFuc2Zvcm0tcGl2b3QiKTsKCiAgdmFyIGFkdmFuY2VkRWRpdG9ySGVscFRleHQgPSBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5GcmFnbWVudCwgbnVsbCwgX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLnRyYW5zZm9ybS5zdGVwRGVmaW5lRm9ybS5hZHZhbmNlZEVkaXRvckhlbHBUZXh0JywgewogICAgZGVmYXVsdE1lc3NhZ2U6ICdUaGUgYWR2YW5jZWQgZWRpdG9yIGFsbG93cyB5b3UgdG8gZWRpdCB0aGUgcGl2b3QgY29uZmlndXJhdGlvbiBvZiB0aGUgdHJhbnNmb3JtLicKICB9KSwgJyAnLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpTGluaywgewogICAgaHJlZjogZG9jc1VybCwKICAgIHRhcmdldDogIl9ibGFuayIKICB9LCBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2sudHJhbnNmb3JtLnN0ZXBEZWZpbmVGb3JtLmFkdmFuY2VkRWRpdG9ySGVscFRleHRMaW5rJywgewogICAgZGVmYXVsdE1lc3NhZ2U6ICdMZWFybiBtb3JlIGFib3V0IGF2YWlsYWJsZSBvcHRpb25zLicKICB9KSkpOwoKICB2YXIgc291cmNlRG9jc1VybCA9ICJodHRwczovL3d3dy5lbGFzdGljLmNvL2d1aWRlL2VuL2VsYXN0aWNzZWFyY2gvcmVmZXJlbmNlLyIuY29uY2F0KF9tZXRhZGF0YS5tZXRhZGF0YS5icmFuY2gsICIvcXVlcnktZHNsLmh0bWwiKTsKCiAgdmFyIGFkdmFuY2VkU291cmNlRWRpdG9ySGVscFRleHQgPSBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5GcmFnbWVudCwgbnVsbCwgX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLnRyYW5zZm9ybS5zdGVwRGVmaW5lRm9ybS5hZHZhbmNlZFNvdXJjZUVkaXRvckhlbHBUZXh0JywgewogICAgZGVmYXVsdE1lc3NhZ2U6ICdUaGUgYWR2YW5jZWQgZWRpdG9yIGFsbG93cyB5b3UgdG8gZWRpdCB0aGUgc291cmNlIHF1ZXJ5IGNsYXVzZSBvZiB0aGUgdHJhbnNmb3JtLicKICB9KSwgJyAnLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpTGluaywgewogICAgaHJlZjogc291cmNlRG9jc1VybCwKICAgIHRhcmdldDogIl9ibGFuayIKICB9LCBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2sudHJhbnNmb3JtLnN0ZXBEZWZpbmVGb3JtLmFkdmFuY2VkRWRpdG9ySGVscFRleHRMaW5rJywgewogICAgZGVmYXVsdE1lc3NhZ2U6ICdMZWFybiBtb3JlIGFib3V0IGF2YWlsYWJsZSBvcHRpb25zLicKICB9KSkpOwoKICB2YXIgdmFsaWQgPSBwaXZvdEdyb3VwQnlBcnIubGVuZ3RoID4gMCAmJiBwaXZvdEFnZ3NBcnIubGVuZ3RoID4gMDsKICAoMCwgX3JlYWN0LnVzZUVmZmVjdCkoZnVuY3Rpb24gKCkgewogICAgdmFyIHByZXZpZXdSZXF1ZXN0VXBkYXRlID0gKDAsIF9jb21tb24yLmdldFByZXZpZXdSZXF1ZXN0Qm9keSkoaW5kZXhQYXR0ZXJuLnRpdGxlLCBwaXZvdFF1ZXJ5LCBwaXZvdEdyb3VwQnlBcnIsIHBpdm90QWdnc0Fycik7CiAgICB2YXIgc3RyaW5naWZpZWRQaXZvdENvbmZpZ1VwZGF0ZSA9IEpTT04uc3RyaW5naWZ5KHByZXZpZXdSZXF1ZXN0VXBkYXRlLnBpdm90LCBudWxsLCAyKTsKICAgIHZhciBzdHJpbmdpZmllZFNvdXJjZUNvbmZpZ1VwZGF0ZSA9IEpTT04uc3RyaW5naWZ5KHByZXZpZXdSZXF1ZXN0VXBkYXRlLnNvdXJjZS5xdWVyeSwgbnVsbCwgMik7CiAgICBzZXRBZHZhbmNlZEVkaXRvckNvbmZpZyhzdHJpbmdpZmllZFBpdm90Q29uZmlnVXBkYXRlKTsKICAgIHNldEFkdmFuY2VkRWRpdG9yU291cmNlQ29uZmlnKHN0cmluZ2lmaWVkU291cmNlQ29uZmlnVXBkYXRlKTsKICAgIG9uQ2hhbmdlKHsKICAgICAgYWdnTGlzdDogYWdnTGlzdCwKICAgICAgZ3JvdXBCeUxpc3Q6IGdyb3VwQnlMaXN0LAogICAgICBpc0FkdmFuY2VkUGl2b3RFZGl0b3JFbmFibGVkOiBpc0FkdmFuY2VkUGl2b3RFZGl0b3JFbmFibGVkLAogICAgICBpc0FkdmFuY2VkU291cmNlRWRpdG9yRW5hYmxlZDogaXNBZHZhbmNlZFNvdXJjZUVkaXRvckVuYWJsZWQsCiAgICAgIHNlYXJjaFN0cmluZzogc2VhcmNoU3RyaW5nLAogICAgICBzZWFyY2hRdWVyeTogc2VhcmNoUXVlcnksCiAgICAgIHNvdXJjZUNvbmZpZ1VwZGF0ZWQ6IHNvdXJjZUNvbmZpZ1VwZGF0ZWQsCiAgICAgIHZhbGlkOiB2YWxpZAogICAgfSk7IC8vIGN1c3RvbSBjb21wYXJpc29uCgogICAgLyogZXNsaW50LWRpc2FibGUgcmVhY3QtaG9va3MvZXhoYXVzdGl2ZS1kZXBzICovCiAgfSwgW0pTT04uc3RyaW5naWZ5KHBpdm90QWdnc0FyciksIEpTT04uc3RyaW5naWZ5KHBpdm90R3JvdXBCeUFyciksIGlzQWR2YW5jZWRQaXZvdEVkaXRvckVuYWJsZWQsIGlzQWR2YW5jZWRTb3VyY2VFZGl0b3JFbmFibGVkLCBzZWFyY2hTdHJpbmcsIHNlYXJjaFF1ZXJ5LCB2YWxpZF0pOyAvLyBUT0RPIFRoaXMgc2hvdWxkIHVzZSB0aGUgYWN0dWFsIHZhbHVlIG9mIGBpbmRpY2VzLnF1ZXJ5LmJvb2wubWF4X2NsYXVzZV9jb3VudGAKCiAgdmFyIG1heEluZGV4RmllbGRzID0gMTAyNDsKICB2YXIgbnVtSW5kZXhGaWVsZHMgPSBpbmRleFBhdHRlcm4uZmllbGRzLmxlbmd0aDsKICB2YXIgZGlzYWJsZWRRdWVyeSA9IG51bUluZGV4RmllbGRzID4gbWF4SW5kZXhGaWVsZHM7CiAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4R3JvdXAsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgZ3JvdzogZmFsc2UsCiAgICBzdHlsZTogewogICAgICBtaW5XaWR0aDogJzQyMHB4JwogICAgfQogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJ0cmFuc2Zvcm1TdGVwRGVmaW5lRm9ybSIKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRm9ybSwgbnVsbCwga2liYW5hQ29udGV4dC5jdXJyZW50U2F2ZWRTZWFyY2ggPT09IHVuZGVmaW5lZCAmJiB0eXBlb2Ygc2VhcmNoU3RyaW5nID09PSAnc3RyaW5nJyAmJiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5GcmFnbWVudCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZvcm1Sb3csIHsKICAgIGxhYmVsOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2sudHJhbnNmb3JtLnN0ZXBEZWZpbmVGb3JtLmluZGV4UGF0dGVybkxhYmVsJywgewogICAgICBkZWZhdWx0TWVzc2FnZTogJ0luZGV4IHBhdHRlcm4nCiAgICB9KSwKICAgIGhlbHBUZXh0OiBkaXNhYmxlZFF1ZXJ5ID8gX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLnRyYW5zZm9ybS5zdGVwRGVmaW5lRm9ybS5pbmRleFBhdHRlcm5IZWxwVGV4dCcsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdBbiBvcHRpb25hbCBxdWVyeSBmb3IgdGhpcyBpbmRleCBwYXR0ZXJuIGlzIG5vdCBzdXBwb3J0ZWQuIFRoZSBudW1iZXIgb2Ygc3VwcG9ydGVkIGluZGV4IGZpZWxkcyBpcyB7bWF4SW5kZXhGaWVsZHN9IHdoZXJlYXMgdGhpcyBpbmRleCBoYXMge251bUluZGV4RmllbGRzfSBmaWVsZHMuJywKICAgICAgdmFsdWVzOiB7CiAgICAgICAgbWF4SW5kZXhGaWVsZHM6IG1heEluZGV4RmllbGRzLAogICAgICAgIG51bUluZGV4RmllbGRzOiBudW1JbmRleEZpZWxkcwogICAgICB9CiAgICB9KSA6ICcnCiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgic3BhbiIsIG51bGwsIGluZGV4UGF0dGVybi50aXRsZSkpLCAhZGlzYWJsZWRRdWVyeSAmJiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5GcmFnbWVudCwgbnVsbCwgIWlzQWR2YW5jZWRTb3VyY2VFZGl0b3JFbmFibGVkICYmIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGb3JtUm93LCB7CiAgICBsYWJlbDogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLnRyYW5zZm9ybS5zdGVwRGVmaW5lRm9ybS5xdWVyeUxhYmVsJywgewogICAgICBkZWZhdWx0TWVzc2FnZTogJ1F1ZXJ5JwogICAgfSksCiAgICBoZWxwVGV4dDogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLnRyYW5zZm9ybS5zdGVwRGVmaW5lRm9ybS5xdWVyeUhlbHBUZXh0JywgewogICAgICBkZWZhdWx0TWVzc2FnZTogJ1VzZSBhIHF1ZXJ5IHRvIGZpbHRlciB0aGUgc291cmNlIGRhdGEgKG9wdGlvbmFsKS4nCiAgICB9KQogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3NoYXJlZF9pbXBvcnRzLktxbEZpbHRlckJhciwgewogICAgaW5kZXhQYXR0ZXJuOiBpbmRleFBhdHRlcm4sCiAgICBvblN1Ym1pdDogc2VhcmNoSGFuZGxlciwKICAgIGluaXRpYWxWYWx1ZTogc2VhcmNoU3RyaW5nID09PSBkZWZhdWx0U2VhcmNoID8gZW1wdHlTZWFyY2ggOiBzZWFyY2hTdHJpbmcsCiAgICBwbGFjZWhvbGRlcjogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLnRyYW5zZm9ybS5zdGVwRGVmaW5lRm9ybS5xdWVyeVBsYWNlaG9sZGVyJywgewogICAgICBkZWZhdWx0TWVzc2FnZTogJ2UuZy4ge2V4YW1wbGV9JywKICAgICAgdmFsdWVzOiB7CiAgICAgICAgZXhhbXBsZTogJ21ldGhvZCA6ICJHRVQiIG9yIHN0YXR1cyA6ICI0MDQiJwogICAgICB9CiAgICB9KSwKICAgIHRlc3RTdWJqOiAidGFybnNmb3JtUXVlcnlJbnB1dCIKICB9KSkpKSwgaXNBZHZhbmNlZFNvdXJjZUVkaXRvckVuYWJsZWQgJiYgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRnJhZ21lbnQsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGb3JtUm93LCB7CiAgICBsYWJlbDogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLnRyYW5zZm9ybS5zdGVwRGVmaW5lRm9ybS5hZHZhbmNlZFNvdXJjZUVkaXRvckxhYmVsJywgewogICAgICBkZWZhdWx0TWVzc2FnZTogJ1NvdXJjZSBxdWVyeSBjbGF1c2UnCiAgICB9KSwKICAgIGhlbHBUZXh0OiBhZHZhbmNlZFNvdXJjZUVkaXRvckhlbHBUZXh0CiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVBhbmVsLCB7CiAgICBncm93OiBmYWxzZSwKICAgIHBhZGRpbmdTaXplOiAibm9uZSIKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQ29kZUVkaXRvciwgewogICAgbW9kZTogImpzb24iLAogICAgd2lkdGg6ICIxMDAlIiwKICAgIHZhbHVlOiBhZHZhbmNlZEVkaXRvclNvdXJjZUNvbmZpZywKICAgIG9uQ2hhbmdlOiBmdW5jdGlvbiBvbkNoYW5nZShkKSB7CiAgICAgIHNldEFkdmFuY2VkRWRpdG9yU291cmNlQ29uZmlnKGQpOyAvLyBEaXNhYmxlIHRoZSAiQXBwbHkiLUJ1dHRvbiBpZiB0aGUgY29uZmlnIGhhc24ndCBjaGFuZ2VkLgoKICAgICAgaWYgKGFkdmFuY2VkRWRpdG9yU291cmNlQ29uZmlnTGFzdEFwcGxpZWQgPT09IGQpIHsKICAgICAgICBzZXRBZHZhbmNlZFNvdXJjZUVkaXRvckFwcGx5QnV0dG9uRW5hYmxlZChmYWxzZSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9IC8vIFRyeSB0byBwYXJzZSB0aGUgc3RyaW5nIHBhc3NlZCBvbiBmcm9tIHRoZSBlZGl0b3IuCiAgICAgIC8vIElmIHBhcnNpbmcgZmFpbHMsIHRoZSAiQXBwbHkiLUJ1dHRvbiB3aWxsIGJlIGRpc2FibGVkCgoKICAgICAgdHJ5IHsKICAgICAgICBKU09OLnBhcnNlKGQpOwogICAgICAgIHNldEFkdmFuY2VkU291cmNlRWRpdG9yQXBwbHlCdXR0b25FbmFibGVkKHRydWUpOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgc2V0QWR2YW5jZWRTb3VyY2VFZGl0b3JBcHBseUJ1dHRvbkVuYWJsZWQoZmFsc2UpOwogICAgICB9CiAgICB9LAogICAgc2V0T3B0aW9uczogewogICAgICBmb250U2l6ZTogJzEycHgnCiAgICB9LAogICAgdGhlbWU6ICJ0ZXh0bWF0ZSIsCiAgICAiYXJpYS1sYWJlbCI6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay50cmFuc2Zvcm0uc3RlcERlZmluZUZvcm0uYWR2YW5jZWRTb3VyY2VFZGl0b3JBcmlhTGFiZWwnLCB7CiAgICAgIGRlZmF1bHRNZXNzYWdlOiAnQWR2YW5jZWQgcXVlcnkgZWRpdG9yJwogICAgfSkKICB9KSkpKSwga2liYW5hQ29udGV4dC5jdXJyZW50U2F2ZWRTZWFyY2ggPT09IHVuZGVmaW5lZCAmJiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRm9ybVJvdywgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhHcm91cCwgewogICAgZ3V0dGVyU2l6ZTogIm5vbmUiCiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3dpdGNoLCB7CiAgICBsYWJlbDogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLnRyYW5zZm9ybS5zdGVwRGVmaW5lRm9ybS5hZHZhbmNlZEVkaXRvclNvdXJjZUNvbmZpZ1N3aXRjaExhYmVsJywgewogICAgICBkZWZhdWx0TWVzc2FnZTogJ0FkdmFuY2VkIHF1ZXJ5IGVkaXRvcicKICAgIH0pLAogICAgY2hlY2tlZDogaXNBZHZhbmNlZFNvdXJjZUVkaXRvckVuYWJsZWQsCiAgICBvbkNoYW5nZTogZnVuY3Rpb24gb25DaGFuZ2UoKSB7CiAgICAgIGlmIChpc0FkdmFuY2VkU291cmNlRWRpdG9yRW5hYmxlZCAmJiBzb3VyY2VDb25maWdVcGRhdGVkKSB7CiAgICAgICAgc2V0QWR2YW5jZWRTb3VyY2VFZGl0b3JTd2l0Y2hNb2RhbFZpc2libGUodHJ1ZSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0b2dnbGVBZHZhbmNlZFNvdXJjZUVkaXRvcigpOwogICAgfSwKICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJ0cmFuc2Zvcm1BZHZhbmNlZFF1ZXJ5RWRpdG9yU3dpdGNoIgogIH0pLCBpc0FkdmFuY2VkU291cmNlRWRpdG9yU3dpdGNoTW9kYWxWaXNpYmxlICYmIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3N3aXRjaF9tb2RhbC5Td2l0Y2hNb2RhbCwgewogICAgb25DYW5jZWw6IGZ1bmN0aW9uIG9uQ2FuY2VsKCkgewogICAgICByZXR1cm4gc2V0QWR2YW5jZWRTb3VyY2VFZGl0b3JTd2l0Y2hNb2RhbFZpc2libGUoZmFsc2UpOwogICAgfSwKICAgIG9uQ29uZmlybTogZnVuY3Rpb24gb25Db25maXJtKCkgewogICAgICBzZXRBZHZhbmNlZFNvdXJjZUVkaXRvclN3aXRjaE1vZGFsVmlzaWJsZShmYWxzZSk7CiAgICAgIHRvZ2dsZUFkdmFuY2VkU291cmNlRWRpdG9yKHRydWUpOwogICAgfSwKICAgIHR5cGU6ICdzb3VyY2UnCiAgfSkpLCBpc0FkdmFuY2VkU291cmNlRWRpdG9yRW5hYmxlZCAmJiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQnV0dG9uLCB7CiAgICBzaXplOiAicyIsCiAgICBmaWxsOiB0cnVlLAogICAgb25DbGljazogYXBwbHlBZHZhbmNlZFNvdXJjZUVkaXRvckNoYW5nZXMsCiAgICBkaXNhYmxlZDogIWlzQWR2YW5jZWRTb3VyY2VFZGl0b3JBcHBseUJ1dHRvbkVuYWJsZWQKICB9LCBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2sudHJhbnNmb3JtLnN0ZXBEZWZpbmVGb3JtLmFkdmFuY2VkU291cmNlRWRpdG9yQXBwbHlCdXR0b25UZXh0JywgewogICAgZGVmYXVsdE1lc3NhZ2U6ICdBcHBseSBjaGFuZ2VzJwogIH0pKSkpLCBraWJhbmFDb250ZXh0LmN1cnJlbnRTYXZlZFNlYXJjaCAhPT0gdW5kZWZpbmVkICYmIGtpYmFuYUNvbnRleHQuY3VycmVudFNhdmVkU2VhcmNoLmlkICE9PSB1bmRlZmluZWQgJiYgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZvcm1Sb3csIHsKICAgIGxhYmVsOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2sudHJhbnNmb3JtLnN0ZXBEZWZpbmVGb3JtLnNhdmVkU2VhcmNoTGFiZWwnLCB7CiAgICAgIGRlZmF1bHRNZXNzYWdlOiAnU2F2ZWQgc2VhcmNoJwogICAgfSkKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgbnVsbCwga2liYW5hQ29udGV4dC5jdXJyZW50U2F2ZWRTZWFyY2gudGl0bGUpKSwgIWlzQWR2YW5jZWRQaXZvdEVkaXRvckVuYWJsZWQgJiYgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRnJhZ21lbnQsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGb3JtUm93LCB7CiAgICBsYWJlbDogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLnRyYW5zZm9ybS5zdGVwRGVmaW5lRm9ybS5ncm91cEJ5TGFiZWwnLCB7CiAgICAgIGRlZmF1bHRNZXNzYWdlOiAnR3JvdXAgYnknCiAgICB9KQogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LkZyYWdtZW50LCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ncm91cF9ieV9saXN0Lkdyb3VwQnlMaXN0Rm9ybSwgewogICAgbGlzdDogZ3JvdXBCeUxpc3QsCiAgICBvcHRpb25zOiBncm91cEJ5T3B0aW9uc0RhdGEsCiAgICBvbkNoYW5nZTogdXBkYXRlR3JvdXBCeSwKICAgIGRlbGV0ZUhhbmRsZXI6IGRlbGV0ZUdyb3VwQnkKICB9KSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfYWdncmVnYXRpb25fZHJvcGRvd24uRHJvcERvd24sIHsKICAgIGNoYW5nZUhhbmRsZXI6IGFkZEdyb3VwQnksCiAgICBvcHRpb25zOiBncm91cEJ5T3B0aW9ucywKICAgIHBsYWNlaG9sZGVyOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2sudHJhbnNmb3JtLnN0ZXBEZWZpbmVGb3JtLmdyb3VwQnlQbGFjZWhvbGRlcicsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdBZGQgYSBncm91cCBieSBmaWVsZCAuLi4nCiAgICB9KSwKICAgIHRlc3RTdWJqOiAidHJhbnNmb3JtR3JvdXBCeVNlbGVjdGlvbiIKICB9KSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRm9ybVJvdywgewogICAgbGFiZWw6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay50cmFuc2Zvcm0uc3RlcERlZmluZUZvcm0uYWdncmVnYXRpb25zTGFiZWwnLCB7CiAgICAgIGRlZmF1bHRNZXNzYWdlOiAnQWdncmVnYXRpb25zJwogICAgfSkKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5GcmFnbWVudCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfYWdncmVnYXRpb25fbGlzdC5BZ2dMaXN0Rm9ybSwgewogICAgbGlzdDogYWdnTGlzdCwKICAgIG9wdGlvbnM6IGFnZ09wdGlvbnNEYXRhLAogICAgb25DaGFuZ2U6IHVwZGF0ZUFnZ3JlZ2F0aW9uLAogICAgZGVsZXRlSGFuZGxlcjogZGVsZXRlQWdncmVnYXRpb24KICB9KSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfYWdncmVnYXRpb25fZHJvcGRvd24uRHJvcERvd24sIHsKICAgIGNoYW5nZUhhbmRsZXI6IGFkZEFnZ3JlZ2F0aW9uLAogICAgb3B0aW9uczogYWdnT3B0aW9ucywKICAgIHBsYWNlaG9sZGVyOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2sudHJhbnNmb3JtLnN0ZXBEZWZpbmVGb3JtLmFnZ3JlZ2F0aW9uc1BsYWNlaG9sZGVyJywgewogICAgICBkZWZhdWx0TWVzc2FnZTogJ0FkZCBhbiBhZ2dyZWdhdGlvbiAuLi4nCiAgICB9KSwKICAgIHRlc3RTdWJqOiAidHJhbnNmb3JtQWdncmVnYXRpb25TZWxlY3Rpb24iCiAgfSkpKSksIGlzQWR2YW5jZWRQaXZvdEVkaXRvckVuYWJsZWQgJiYgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRnJhZ21lbnQsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGb3JtUm93LCB7CiAgICBsYWJlbDogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLnRyYW5zZm9ybS5zdGVwRGVmaW5lRm9ybS5hZHZhbmNlZEVkaXRvckxhYmVsJywgewogICAgICBkZWZhdWx0TWVzc2FnZTogJ1Bpdm90IGNvbmZpZ3VyYXRpb24gb2JqZWN0JwogICAgfSksCiAgICBoZWxwVGV4dDogYWR2YW5jZWRFZGl0b3JIZWxwVGV4dAogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlQYW5lbCwgewogICAgZ3JvdzogZmFsc2UsCiAgICBwYWRkaW5nU2l6ZTogIm5vbmUiCiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUNvZGVFZGl0b3IsIHsKICAgIG1vZGU6ICJqc29uIiwKICAgIHdpZHRoOiAiMTAwJSIsCiAgICB2YWx1ZTogYWR2YW5jZWRFZGl0b3JDb25maWcsCiAgICBvbkNoYW5nZTogZnVuY3Rpb24gb25DaGFuZ2UoZCkgewogICAgICBzZXRBZHZhbmNlZEVkaXRvckNvbmZpZyhkKTsgLy8gRGlzYWJsZSB0aGUgIkFwcGx5Ii1CdXR0b24gaWYgdGhlIGNvbmZpZyBoYXNuJ3QgY2hhbmdlZC4KCiAgICAgIGlmIChhZHZhbmNlZEVkaXRvckNvbmZpZ0xhc3RBcHBsaWVkID09PSBkKSB7CiAgICAgICAgc2V0QWR2YW5jZWRQaXZvdEVkaXRvckFwcGx5QnV0dG9uRW5hYmxlZChmYWxzZSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9IC8vIFRyeSB0byBwYXJzZSB0aGUgc3RyaW5nIHBhc3NlZCBvbiBmcm9tIHRoZSBlZGl0b3IuCiAgICAgIC8vIElmIHBhcnNpbmcgZmFpbHMsIHRoZSAiQXBwbHkiLUJ1dHRvbiB3aWxsIGJlIGRpc2FibGVkCgoKICAgICAgdHJ5IHsKICAgICAgICBKU09OLnBhcnNlKGQpOwogICAgICAgIHNldEFkdmFuY2VkUGl2b3RFZGl0b3JBcHBseUJ1dHRvbkVuYWJsZWQodHJ1ZSk7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICBzZXRBZHZhbmNlZFBpdm90RWRpdG9yQXBwbHlCdXR0b25FbmFibGVkKGZhbHNlKTsKICAgICAgfQogICAgfSwKICAgIHNldE9wdGlvbnM6IHsKICAgICAgZm9udFNpemU6ICcxMnB4JwogICAgfSwKICAgIHRoZW1lOiAidGV4dG1hdGUiLAogICAgImFyaWEtbGFiZWwiOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2sudHJhbnNmb3JtLnN0ZXBEZWZpbmVGb3JtLmFkdmFuY2VkRWRpdG9yQXJpYUxhYmVsJywgewogICAgICBkZWZhdWx0TWVzc2FnZTogJ0FkdmFuY2VkIHBpdm90IGVkaXRvcicKICAgIH0pCiAgfSkpKSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGb3JtUm93LCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEdyb3VwLCB7CiAgICBndXR0ZXJTaXplOiAibm9uZSIKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTd2l0Y2gsIHsKICAgIGxhYmVsOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2sudHJhbnNmb3JtLnN0ZXBEZWZpbmVGb3JtLmFkdmFuY2VkRWRpdG9yU3dpdGNoTGFiZWwnLCB7CiAgICAgIGRlZmF1bHRNZXNzYWdlOiAnQWR2YW5jZWQgcGl2b3QgZWRpdG9yJwogICAgfSksCiAgICBjaGVja2VkOiBpc0FkdmFuY2VkUGl2b3RFZGl0b3JFbmFibGVkLAogICAgb25DaGFuZ2U6IGZ1bmN0aW9uIG9uQ2hhbmdlKCkgewogICAgICBpZiAoaXNBZHZhbmNlZFBpdm90RWRpdG9yRW5hYmxlZCAmJiAoaXNBZHZhbmNlZFBpdm90RWRpdG9yQXBwbHlCdXR0b25FbmFibGVkIHx8IGFkdmFuY2VkRWRpdG9yQ29uZmlnICE9PSBhZHZhbmNlZEVkaXRvckNvbmZpZ0xhc3RBcHBsaWVkKSkgewogICAgICAgIHNldEFkdmFuY2VkRWRpdG9yU3dpdGNoTW9kYWxWaXNpYmxlKHRydWUpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdG9nZ2xlQWR2YW5jZWRFZGl0b3IoKTsKICAgIH0sCiAgICAiZGF0YS10ZXN0LXN1YmoiOiAidHJhbnNmb3JtQWR2YW5jZWRQaXZvdEVkaXRvclN3aXRjaCIKICB9KSwgaXNBZHZhbmNlZEVkaXRvclN3aXRjaE1vZGFsVmlzaWJsZSAmJiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9zd2l0Y2hfbW9kYWwuU3dpdGNoTW9kYWwsIHsKICAgIG9uQ2FuY2VsOiBmdW5jdGlvbiBvbkNhbmNlbCgpIHsKICAgICAgcmV0dXJuIHNldEFkdmFuY2VkRWRpdG9yU3dpdGNoTW9kYWxWaXNpYmxlKGZhbHNlKTsKICAgIH0sCiAgICBvbkNvbmZpcm06IGZ1bmN0aW9uIG9uQ29uZmlybSgpIHsKICAgICAgc2V0QWR2YW5jZWRFZGl0b3JTd2l0Y2hNb2RhbFZpc2libGUoZmFsc2UpOwogICAgICB0b2dnbGVBZHZhbmNlZEVkaXRvcigpOwogICAgfSwKICAgIHR5cGU6ICdwaXZvdCcKICB9KSksIGlzQWR2YW5jZWRQaXZvdEVkaXRvckVuYWJsZWQgJiYgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUJ1dHRvbiwgewogICAgc2l6ZTogInMiLAogICAgZmlsbDogdHJ1ZSwKICAgIG9uQ2xpY2s6IGFwcGx5QWR2YW5jZWRQaXZvdEVkaXRvckNoYW5nZXMsCiAgICBkaXNhYmxlZDogIWlzQWR2YW5jZWRQaXZvdEVkaXRvckFwcGx5QnV0dG9uRW5hYmxlZAogIH0sIF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay50cmFuc2Zvcm0uc3RlcERlZmluZUZvcm0uYWR2YW5jZWRFZGl0b3JBcHBseUJ1dHRvblRleHQnLCB7CiAgICBkZWZhdWx0TWVzc2FnZTogJ0FwcGx5IGNoYW5nZXMnCiAgfSkpKSksICF2YWxpZCAmJiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5GcmFnbWVudCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgewogICAgc2l6ZTogIm0iCiAgfSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGb3JtSGVscFRleHQsIHsKICAgIHN0eWxlOiB7CiAgICAgIG1heFdpZHRoOiAnMzIwcHgnCiAgICB9CiAgfSwgX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLnRyYW5zZm9ybS5zdGVwRGVmaW5lRm9ybS5mb3JtSGVscCcsIHsKICAgIGRlZmF1bHRNZXNzYWdlOiAnVHJhbnNmb3JtcyBhcmUgc2NhbGFibGUgYW5kIGF1dG9tYXRlZCBwcm9jZXNzZXMgZm9yIHBpdm90aW5nLiBDaG9vc2UgYXQgbGVhc3Qgb25lIGdyb3VwLWJ5IGFuZCBhZ2dyZWdhdGlvbiB0byBnZXQgc3RhcnRlZC4nCiAgfSkpKSkpKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9zb3VyY2VfaW5kZXhfcHJldmlldy5Tb3VyY2VJbmRleFByZXZpZXcsIHsKICAgIGNlbGxDbGljazogYWRkVG9TZWFyY2gsCiAgICBxdWVyeTogcGl2b3RRdWVyeQogIH0pLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3BhY2VyLCB7CiAgICBzaXplOiAibSIKICB9KSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcGl2b3RfcHJldmlldy5QaXZvdFByZXZpZXcsIHsKICAgIGFnZ3M6IGFnZ0xpc3QsCiAgICBncm91cEJ5OiBncm91cEJ5TGlzdCwKICAgIHF1ZXJ5OiBwaXZvdFF1ZXJ5CiAgfSkpKTsKfSk7CgpleHBvcnRzLlN0ZXBEZWZpbmVGb3JtID0gU3RlcERlZmluZUZvcm07"},null]}