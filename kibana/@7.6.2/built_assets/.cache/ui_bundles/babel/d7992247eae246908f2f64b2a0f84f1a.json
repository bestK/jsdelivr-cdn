{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/siem/public/components/open_timeline/helpers.js","dependencies":[{"path":"x-pack/legacy/plugins/siem/public/components/open_timeline/helpers.js","mtime":1585205047548},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmRpc3BhdGNoVXBkYXRlVGltZWxpbmUgPSBleHBvcnRzLnF1ZXJ5VGltZWxpbmVCeUlkID0gZXhwb3J0cy5mb3JtYXRUaW1lbGluZVJlc3VsdFRvTW9kZWwgPSBleHBvcnRzLmRlZmF1bHRUaW1lbGluZVRvVGltZWxpbmVNb2RlbCA9IGV4cG9ydHMub21pdFR5cGVuYW1lSW5UaW1lbGluZSA9IGV4cG9ydHMuaXNVbnRpdGxlZCA9IGV4cG9ydHMuZ2V0Tm90ZXNDb3VudCA9IGV4cG9ydHMuZ2V0UGlubmVkRXZlbnRDb3VudCA9IGV4cG9ydHMuT1BFTl9USU1FTElORV9DTEFTU19OQU1FID0gdm9pZCAwOwoKdmFyIF9mcCA9IHJlcXVpcmUoImxvZGFzaC9mcCIpOwoKdmFyIF9pbmRleCA9IHJlcXVpcmUoIi4uLy4uL2NvbnRhaW5lcnMvdGltZWxpbmUvb25lL2luZGV4LmdxbF9xdWVyeSIpOwoKdmFyIF9hY3Rpb25zID0gcmVxdWlyZSgiLi4vLi4vc3RvcmUvYXBwL2FjdGlvbnMiKTsKCnZhciBfYWN0aW9uczIgPSByZXF1aXJlKCIuLi8uLi9zdG9yZS9pbnB1dHMvYWN0aW9ucyIpOwoKdmFyIF9hY3Rpb25zMyA9IHJlcXVpcmUoIi4uLy4uL3N0b3JlL3RpbWVsaW5lL2FjdGlvbnMiKTsKCnZhciBfZGVmYXVsdHMgPSByZXF1aXJlKCIuLi8uLi9zdG9yZS90aW1lbGluZS9kZWZhdWx0cyIpOwoKdmFyIF9kZWZhdWx0X2hlYWRlcnMgPSByZXF1aXJlKCIuLi90aW1lbGluZS9ib2R5L2NvbHVtbl9oZWFkZXJzL2RlZmF1bHRfaGVhZGVycyIpOwoKdmFyIF9jb25zdGFudHMgPSByZXF1aXJlKCIuLi90aW1lbGluZS9ib2R5L2NvbnN0YW50cyIpOwoKdmFyIF9kZWZhdWx0X2RhdGVfc2V0dGluZ3MgPSByZXF1aXJlKCIuLi8uLi91dGlscy9kZWZhdWx0X2RhdGVfc2V0dGluZ3MiKTsKCmZ1bmN0aW9uIF9vYmplY3RXaXRob3V0UHJvcGVydGllcyhzb3VyY2UsIGV4Y2x1ZGVkKSB7CiAgaWYgKHNvdXJjZSA9PSBudWxsKSByZXR1cm4ge307CgogIHZhciB0YXJnZXQgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShzb3VyY2UsIGV4Y2x1ZGVkKTsKCiAgdmFyIGtleSwgaTsKCiAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsKICAgIHZhciBzb3VyY2VTeW1ib2xLZXlzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzb3VyY2UpOwoKICAgIGZvciAoaSA9IDA7IGkgPCBzb3VyY2VTeW1ib2xLZXlzLmxlbmd0aDsgaSsrKSB7CiAgICAgIGtleSA9IHNvdXJjZVN5bWJvbEtleXNbaV07CiAgICAgIGlmIChleGNsdWRlZC5pbmRleE9mKGtleSkgPj0gMCkgY29udGludWU7CiAgICAgIGlmICghT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKHNvdXJjZSwga2V5KSkgY29udGludWU7CiAgICAgIHRhcmdldFtrZXldID0gc291cmNlW2tleV07CiAgICB9CiAgfQoKICByZXR1cm4gdGFyZ2V0Owp9CgpmdW5jdGlvbiBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShzb3VyY2UsIGV4Y2x1ZGVkKSB7CiAgaWYgKHNvdXJjZSA9PSBudWxsKSByZXR1cm4ge307CiAgdmFyIHRhcmdldCA9IHt9OwogIHZhciBzb3VyY2VLZXlzID0gT2JqZWN0LmtleXMoc291cmNlKTsKICB2YXIga2V5LCBpOwoKICBmb3IgKGkgPSAwOyBpIDwgc291cmNlS2V5cy5sZW5ndGg7IGkrKykgewogICAga2V5ID0gc291cmNlS2V5c1tpXTsKICAgIGlmIChleGNsdWRlZC5pbmRleE9mKGtleSkgPj0gMCkgY29udGludWU7CiAgICB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldOwogIH0KCiAgcmV0dXJuIHRhcmdldDsKfQoKZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7CiAgcmV0dXJuIF9hcnJheVdpdGhIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHx8IF9ub25JdGVyYWJsZVJlc3QoKTsKfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlUmVzdCgpIHsKICB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7Cn0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHsKICB2YXIgX2FyciA9IFtdOwogIHZhciBfbiA9IHRydWU7CiAgdmFyIF9kID0gZmFsc2U7CiAgdmFyIF9lID0gdW5kZWZpbmVkOwoKICB0cnkgewogICAgZm9yICh2YXIgX2kgPSBhcnJbU3ltYm9sLml0ZXJhdG9yXSgpLCBfczsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSkgewogICAgICBfYXJyLnB1c2goX3MudmFsdWUpOwoKICAgICAgaWYgKGkgJiYgX2Fyci5sZW5ndGggPT09IGkpIGJyZWFrOwogICAgfQogIH0gY2F0Y2ggKGVycikgewogICAgX2QgPSB0cnVlOwogICAgX2UgPSBlcnI7CiAgfSBmaW5hbGx5IHsKICAgIHRyeSB7CiAgICAgIGlmICghX24gJiYgX2lbInJldHVybiJdICE9IG51bGwpIF9pWyJyZXR1cm4iXSgpOwogICAgfSBmaW5hbGx5IHsKICAgICAgaWYgKF9kKSB0aHJvdyBfZTsKICAgIH0KICB9CgogIHJldHVybiBfYXJyOwp9CgpmdW5jdGlvbiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsKfQoKZnVuY3Rpb24gX3RvQ29uc3VtYWJsZUFycmF5KGFycikgewogIHJldHVybiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5KGFycikgfHwgX25vbkl0ZXJhYmxlU3ByZWFkKCk7Cn0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVNwcmVhZCgpIHsKICB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gc3ByZWFkIG5vbi1pdGVyYWJsZSBpbnN0YW5jZSIpOwp9CgpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5KGl0ZXIpIHsKICBpZiAoU3ltYm9sLml0ZXJhdG9yIGluIE9iamVjdChpdGVyKSB8fCBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoaXRlcikgPT09ICJbb2JqZWN0IEFyZ3VtZW50c10iKSByZXR1cm4gQXJyYXkuZnJvbShpdGVyKTsKfQoKZnVuY3Rpb24gX2FycmF5V2l0aG91dEhvbGVzKGFycikgewogIGlmIChBcnJheS5pc0FycmF5KGFycikpIHsKICAgIGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGFyci5sZW5ndGgpOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7CiAgICAgIGFycjJbaV0gPSBhcnJbaV07CiAgICB9CgogICAgcmV0dXJuIGFycjI7CiAgfQp9CgpmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsKICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7CgogIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7CiAgICB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsKICAgIGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsKICAgICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7CiAgICB9KTsKICAgIGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsKICB9CgogIHJldHVybiBrZXlzOwp9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgewogIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsKCiAgICBpZiAoaSAlIDIpIHsKICAgICAgb3duS2V5cyhzb3VyY2UsIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOwogICAgICB9KTsKICAgIH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsKICAgIH0gZWxzZSB7CiAgICAgIG93bktleXMoc291cmNlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsKICAgICAgfSk7CiAgICB9CiAgfQoKICByZXR1cm4gdGFyZ2V0Owp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7CiAgaWYgKGtleSBpbiBvYmopIHsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgICB2YWx1ZTogdmFsdWUsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgd3JpdGFibGU6IHRydWUKICAgIH0pOwogIH0gZWxzZSB7CiAgICBvYmpba2V5XSA9IHZhbHVlOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKdmFyIE9QRU5fVElNRUxJTkVfQ0xBU1NfTkFNRSA9ICdvcGVuLXRpbWVsaW5lJzsKLyoqIFJldHVybnMgYSBjb3VudCBvZiB0aGUgcGlubmVkIGV2ZW50cyBpbiBhIHRpbWVsaW5lICovCgpleHBvcnRzLk9QRU5fVElNRUxJTkVfQ0xBU1NfTkFNRSA9IE9QRU5fVElNRUxJTkVfQ0xBU1NfTkFNRTsKCnZhciBnZXRQaW5uZWRFdmVudENvdW50ID0gZnVuY3Rpb24gZ2V0UGlubmVkRXZlbnRDb3VudChfcmVmKSB7CiAgdmFyIHBpbm5lZEV2ZW50SWRzID0gX3JlZi5waW5uZWRFdmVudElkczsKICByZXR1cm4gcGlubmVkRXZlbnRJZHMgIT0gbnVsbCA/IE9iamVjdC5rZXlzKHBpbm5lZEV2ZW50SWRzKS5sZW5ndGggOiAwOwp9OwovKiogUmV0dXJucyB0aGUgc3VtIG9mIGFsbCBub3RlcyBhZGRlZCB0byBwaW5uZWQgZXZlbnRzIGFuZCBub3RlcyBhcHBsaWNhYmxlIHRvIHRoZSB0aW1lbGluZSAqLwoKCmV4cG9ydHMuZ2V0UGlubmVkRXZlbnRDb3VudCA9IGdldFBpbm5lZEV2ZW50Q291bnQ7Cgp2YXIgZ2V0Tm90ZXNDb3VudCA9IGZ1bmN0aW9uIGdldE5vdGVzQ291bnQoX3JlZjIpIHsKICB2YXIgZXZlbnRJZFRvTm90ZUlkcyA9IF9yZWYyLmV2ZW50SWRUb05vdGVJZHMsCiAgICAgIG5vdGVJZHMgPSBfcmVmMi5ub3RlSWRzOwogIHZhciBldmVudE5vdGVDb3VudCA9IGV2ZW50SWRUb05vdGVJZHMgIT0gbnVsbCA/IE9iamVjdC5rZXlzKGV2ZW50SWRUb05vdGVJZHMpLnJlZHVjZShmdW5jdGlvbiAoY291bnQsIGV2ZW50SWQpIHsKICAgIHJldHVybiBjb3VudCArIGV2ZW50SWRUb05vdGVJZHNbZXZlbnRJZF0ubGVuZ3RoOwogIH0sIDApIDogMDsKICB2YXIgZ2xvYmFsTm90ZUNvdW50ID0gbm90ZUlkcyAhPSBudWxsID8gbm90ZUlkcy5sZW5ndGggOiAwOwogIHJldHVybiBldmVudE5vdGVDb3VudCArIGdsb2JhbE5vdGVDb3VudDsKfTsKLyoqIFJldHVybnMgdHJ1ZSBpZiB0aGUgdGltZWxpbmUgaXMgdW50aXRsaWVkICovCgoKZXhwb3J0cy5nZXROb3Rlc0NvdW50ID0gZ2V0Tm90ZXNDb3VudDsKCnZhciBpc1VudGl0bGVkID0gZnVuY3Rpb24gaXNVbnRpdGxlZChfcmVmMykgewogIHZhciB0aXRsZSA9IF9yZWYzLnRpdGxlOwogIHJldHVybiB0aXRsZSA9PSBudWxsIHx8IHRpdGxlLnRyaW0oKS5sZW5ndGggPT09IDA7Cn07CgpleHBvcnRzLmlzVW50aXRsZWQgPSBpc1VudGl0bGVkOwoKdmFyIG9taXRUeXBlbmFtZSA9IGZ1bmN0aW9uIG9taXRUeXBlbmFtZShrZXksIHZhbHVlKSB7CiAgcmV0dXJuIGtleSA9PT0gJ19fdHlwZW5hbWUnID8gdW5kZWZpbmVkIDogdmFsdWU7Cn07Cgp2YXIgb21pdFR5cGVuYW1lSW5UaW1lbGluZSA9IGZ1bmN0aW9uIG9taXRUeXBlbmFtZUluVGltZWxpbmUodGltZWxpbmUpIHsKICByZXR1cm4gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aW1lbGluZSksIG9taXRUeXBlbmFtZSk7Cn07CgpleHBvcnRzLm9taXRUeXBlbmFtZUluVGltZWxpbmUgPSBvbWl0VHlwZW5hbWVJblRpbWVsaW5lOwoKdmFyIHBhcnNlU3RyaW5nID0gZnVuY3Rpb24gcGFyc2VTdHJpbmcocGFyYW1zKSB7CiAgdHJ5IHsKICAgIHJldHVybiBKU09OLnBhcnNlKHBhcmFtcyk7CiAgfSBjYXRjaCAoX3VudXNlZCkgewogICAgcmV0dXJuIHBhcmFtczsKICB9Cn07Cgp2YXIgZGVmYXVsdFRpbWVsaW5lVG9UaW1lbGluZU1vZGVsID0gZnVuY3Rpb24gZGVmYXVsdFRpbWVsaW5lVG9UaW1lbGluZU1vZGVsKHRpbWVsaW5lLCBkdXBsaWNhdGUpIHsKICByZXR1cm4gT2JqZWN0LmVudHJpZXMoX29iamVjdFNwcmVhZCh7fSwgdGltZWxpbmUsIHsKICAgIGNvbHVtbnM6IHRpbWVsaW5lLmNvbHVtbnMgIT0gbnVsbCA/IHRpbWVsaW5lLmNvbHVtbnMubWFwKGZ1bmN0aW9uIChjb2wpIHsKICAgICAgdmFyIHRpbWVsaW5lQ29scyA9IF9vYmplY3RTcHJlYWQoe30sIGNvbCwgewogICAgICAgIGNvbHVtbkhlYWRlclR5cGU6IF9kZWZhdWx0X2hlYWRlcnMuZGVmYXVsdENvbHVtbkhlYWRlclR5cGUsCiAgICAgICAgaWQ6IGNvbC5pZCAhPSBudWxsID8gY29sLmlkIDogJ3Vua25vd24nLAogICAgICAgIHBsYWNlaG9sZGVyOiBjb2wucGxhY2Vob2xkZXIgIT0gbnVsbCA/IGNvbC5wbGFjZWhvbGRlciA6IHVuZGVmaW5lZCwKICAgICAgICBjYXRlZ29yeTogY29sLmNhdGVnb3J5ICE9IG51bGwgPyBjb2wuY2F0ZWdvcnkgOiB1bmRlZmluZWQsCiAgICAgICAgZGVzY3JpcHRpb246IGNvbC5kZXNjcmlwdGlvbiAhPSBudWxsID8gY29sLmRlc2NyaXB0aW9uIDogdW5kZWZpbmVkLAogICAgICAgIGV4YW1wbGU6IGNvbC5leGFtcGxlICE9IG51bGwgPyBjb2wuZXhhbXBsZSA6IHVuZGVmaW5lZCwKICAgICAgICB0eXBlOiBjb2wudHlwZSAhPSBudWxsID8gY29sLnR5cGUgOiB1bmRlZmluZWQsCiAgICAgICAgYWdncmVnYXRhYmxlOiBjb2wuYWdncmVnYXRhYmxlICE9IG51bGwgPyBjb2wuYWdncmVnYXRhYmxlIDogdW5kZWZpbmVkLAogICAgICAgIHdpZHRoOiBjb2wuaWQgPT09ICdAdGltZXN0YW1wJyA/IF9jb25zdGFudHMuREVGQVVMVF9EQVRFX0NPTFVNTl9NSU5fV0lEVEggOiBfY29uc3RhbnRzLkRFRkFVTFRfQ09MVU1OX01JTl9XSURUSAogICAgICB9KTsKCiAgICAgIHJldHVybiB0aW1lbGluZUNvbHM7CiAgICB9KSA6IF9kZWZhdWx0X2hlYWRlcnMuZGVmYXVsdEhlYWRlcnMsCiAgICBldmVudElkVG9Ob3RlSWRzOiBkdXBsaWNhdGUgPyB7fSA6IHRpbWVsaW5lLmV2ZW50SWRUb05vdGVJZHMgIT0gbnVsbCA/IHRpbWVsaW5lLmV2ZW50SWRUb05vdGVJZHMucmVkdWNlKGZ1bmN0aW9uIChhY2MsIG5vdGUpIHsKICAgICAgaWYgKG5vdGUuZXZlbnRJZCAhPSBudWxsKSB7CiAgICAgICAgdmFyIGV2ZW50Tm90ZXMgPSAoMCwgX2ZwLmdldE9yKShbXSwgbm90ZS5ldmVudElkLCBhY2MpOwogICAgICAgIHJldHVybiBfb2JqZWN0U3ByZWFkKHt9LCBhY2MsIF9kZWZpbmVQcm9wZXJ0eSh7fSwgbm90ZS5ldmVudElkLCBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KGV2ZW50Tm90ZXMpLCBbbm90ZS5ub3RlSWRdKSkpOwogICAgICB9CgogICAgICByZXR1cm4gYWNjOwogICAgfSwge30pIDoge30sCiAgICBmaWx0ZXJzOiB0aW1lbGluZS5maWx0ZXJzICE9IG51bGwgPyB0aW1lbGluZS5maWx0ZXJzLm1hcChmdW5jdGlvbiAoZmlsdGVyKSB7CiAgICAgIHJldHVybiBfb2JqZWN0U3ByZWFkKHsKICAgICAgICAkc3RhdGU6IHsKICAgICAgICAgIHN0b3JlOiAnYXBwU3RhdGUnCiAgICAgICAgfSwKICAgICAgICBtZXRhOiBfb2JqZWN0U3ByZWFkKHt9LCBmaWx0ZXIubWV0YSwge30sIGZpbHRlci5tZXRhICYmIGZpbHRlci5tZXRhLmZpZWxkICE9IG51bGwgPyB7CiAgICAgICAgICBwYXJhbXM6IHBhcnNlU3RyaW5nKGZpbHRlci5tZXRhLmZpZWxkKQogICAgICAgIH0gOiB7fSwge30sIGZpbHRlci5tZXRhICYmIGZpbHRlci5tZXRhLnBhcmFtcyAhPSBudWxsID8gewogICAgICAgICAgcGFyYW1zOiBwYXJzZVN0cmluZyhmaWx0ZXIubWV0YS5wYXJhbXMpCiAgICAgICAgfSA6IHt9LCB7fSwgZmlsdGVyLm1ldGEgJiYgZmlsdGVyLm1ldGEudmFsdWUgIT0gbnVsbCA/IHsKICAgICAgICAgIHZhbHVlOiBwYXJzZVN0cmluZyhmaWx0ZXIubWV0YS52YWx1ZSkKICAgICAgICB9IDoge30pCiAgICAgIH0sIGZpbHRlci5leGlzdHMgIT0gbnVsbCA/IHsKICAgICAgICBleGlzdHM6IHBhcnNlU3RyaW5nKGZpbHRlci5leGlzdHMpCiAgICAgIH0gOiB7fSwge30sIGZpbHRlci5tYXRjaF9hbGwgIT0gbnVsbCA/IHsKICAgICAgICBleGlzdHM6IHBhcnNlU3RyaW5nKGZpbHRlci5tYXRjaF9hbGwpCiAgICAgIH0gOiB7fSwge30sIGZpbHRlci5taXNzaW5nICE9IG51bGwgPyB7CiAgICAgICAgZXhpc3RzOiBwYXJzZVN0cmluZyhmaWx0ZXIubWlzc2luZykKICAgICAgfSA6IHt9LCB7fSwgZmlsdGVyLnF1ZXJ5ICE9IG51bGwgPyB7CiAgICAgICAgcXVlcnk6IHBhcnNlU3RyaW5nKGZpbHRlci5xdWVyeSkKICAgICAgfSA6IHt9LCB7fSwgZmlsdGVyLnJhbmdlICE9IG51bGwgPyB7CiAgICAgICAgcmFuZ2U6IHBhcnNlU3RyaW5nKGZpbHRlci5yYW5nZSkKICAgICAgfSA6IHt9LCB7fSwgZmlsdGVyLnNjcmlwdCAhPSBudWxsID8gewogICAgICAgIGV4aXN0czogcGFyc2VTdHJpbmcoZmlsdGVyLnNjcmlwdCkKICAgICAgfSA6IHt9KTsKICAgIH0pIDogW10sCiAgICBpc0Zhdm9yaXRlOiBkdXBsaWNhdGUgPyBmYWxzZSA6IHRpbWVsaW5lLmZhdm9yaXRlICE9IG51bGwgPyB0aW1lbGluZS5mYXZvcml0ZS5sZW5ndGggPiAwIDogZmFsc2UsCiAgICBub3RlSWRzOiBkdXBsaWNhdGUgPyBbXSA6IHRpbWVsaW5lLm5vdGVJZHMgIT0gbnVsbCA/IHRpbWVsaW5lLm5vdGVJZHMgOiBbXSwKICAgIHBpbm5lZEV2ZW50SWRzOiBkdXBsaWNhdGUgPyB7fSA6IHRpbWVsaW5lLnBpbm5lZEV2ZW50SWRzICE9IG51bGwgPyB0aW1lbGluZS5waW5uZWRFdmVudElkcy5yZWR1Y2UoZnVuY3Rpb24gKGFjYywgcGlubmVkRXZlbnRJZCkgewogICAgICByZXR1cm4gX29iamVjdFNwcmVhZCh7fSwgYWNjLCBfZGVmaW5lUHJvcGVydHkoe30sIHBpbm5lZEV2ZW50SWQsIHRydWUpKTsKICAgIH0sIHt9KSA6IHt9LAogICAgcGlubmVkRXZlbnRzU2F2ZU9iamVjdDogZHVwbGljYXRlID8ge30gOiB0aW1lbGluZS5waW5uZWRFdmVudHNTYXZlT2JqZWN0ICE9IG51bGwgPyB0aW1lbGluZS5waW5uZWRFdmVudHNTYXZlT2JqZWN0LnJlZHVjZShmdW5jdGlvbiAoYWNjLCBwaW5uZWRFdmVudCkgewogICAgICByZXR1cm4gX29iamVjdFNwcmVhZCh7fSwgYWNjLCB7fSwgcGlubmVkRXZlbnQuZXZlbnRJZCAhPSBudWxsID8gX2RlZmluZVByb3BlcnR5KHt9LCBwaW5uZWRFdmVudC5ldmVudElkLCBwaW5uZWRFdmVudCkgOiB7fSk7CiAgICB9LCB7fSkgOiB7fSwKICAgIGlkOiBkdXBsaWNhdGUgPyAnJyA6IHRpbWVsaW5lLnNhdmVkT2JqZWN0SWQsCiAgICBzYXZlZE9iamVjdElkOiBkdXBsaWNhdGUgPyBudWxsIDogdGltZWxpbmUuc2F2ZWRPYmplY3RJZCwKICAgIHZlcnNpb246IGR1cGxpY2F0ZSA/IG51bGwgOiB0aW1lbGluZS52ZXJzaW9uLAogICAgdGl0bGU6IGR1cGxpY2F0ZSA/ICcnIDogdGltZWxpbmUudGl0bGUgfHwgJycKICB9KSkucmVkdWNlKGZ1bmN0aW9uIChhY2MsIF9yZWY1KSB7CiAgICB2YXIgX3JlZjYgPSBfc2xpY2VkVG9BcnJheShfcmVmNSwgMiksCiAgICAgICAga2V5ID0gX3JlZjZbMF0sCiAgICAgICAgdmFsdWUgPSBfcmVmNlsxXTsKCiAgICByZXR1cm4gdmFsdWUgIT0gbnVsbCA/ICgwLCBfZnAuc2V0KShrZXksIHZhbHVlLCBhY2MpIDogYWNjOwogIH0sIF9vYmplY3RTcHJlYWQoe30sIF9kZWZhdWx0cy50aW1lbGluZURlZmF1bHRzLCB7CiAgICBpZDogJycKICB9KSk7Cn07CgpleHBvcnRzLmRlZmF1bHRUaW1lbGluZVRvVGltZWxpbmVNb2RlbCA9IGRlZmF1bHRUaW1lbGluZVRvVGltZWxpbmVNb2RlbDsKCnZhciBmb3JtYXRUaW1lbGluZVJlc3VsdFRvTW9kZWwgPSBmdW5jdGlvbiBmb3JtYXRUaW1lbGluZVJlc3VsdFRvTW9kZWwodGltZWxpbmVUb09wZW4pIHsKICB2YXIgZHVwbGljYXRlID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBmYWxzZTsKCiAgdmFyIG5vdGVzID0gdGltZWxpbmVUb09wZW4ubm90ZXMsCiAgICAgIHRpbWVsaW5lTW9kZWwgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXModGltZWxpbmVUb09wZW4sIFsibm90ZXMiXSk7CgogIHJldHVybiB7CiAgICBub3Rlczogbm90ZXMsCiAgICB0aW1lbGluZTogZGVmYXVsdFRpbWVsaW5lVG9UaW1lbGluZU1vZGVsKHRpbWVsaW5lTW9kZWwsIGR1cGxpY2F0ZSkKICB9Owp9OwoKZXhwb3J0cy5mb3JtYXRUaW1lbGluZVJlc3VsdFRvTW9kZWwgPSBmb3JtYXRUaW1lbGluZVJlc3VsdFRvTW9kZWw7Cgp2YXIgcXVlcnlUaW1lbGluZUJ5SWQgPSBmdW5jdGlvbiBxdWVyeVRpbWVsaW5lQnlJZChfcmVmNykgewogIHZhciBhcG9sbG9DbGllbnQgPSBfcmVmNy5hcG9sbG9DbGllbnQsCiAgICAgIF9yZWY3JGR1cGxpY2F0ZSA9IF9yZWY3LmR1cGxpY2F0ZSwKICAgICAgZHVwbGljYXRlID0gX3JlZjckZHVwbGljYXRlID09PSB2b2lkIDAgPyBmYWxzZSA6IF9yZWY3JGR1cGxpY2F0ZSwKICAgICAgdGltZWxpbmVJZCA9IF9yZWY3LnRpbWVsaW5lSWQsCiAgICAgIG9uT3BlblRpbWVsaW5lID0gX3JlZjcub25PcGVuVGltZWxpbmUsCiAgICAgIF9yZWY3JG9wZW5UaW1lbGluZSA9IF9yZWY3Lm9wZW5UaW1lbGluZSwKICAgICAgb3BlblRpbWVsaW5lID0gX3JlZjckb3BlblRpbWVsaW5lID09PSB2b2lkIDAgPyB0cnVlIDogX3JlZjckb3BlblRpbWVsaW5lLAogICAgICB1cGRhdGVJc0xvYWRpbmcgPSBfcmVmNy51cGRhdGVJc0xvYWRpbmcsCiAgICAgIHVwZGF0ZVRpbWVsaW5lID0gX3JlZjcudXBkYXRlVGltZWxpbmU7CiAgdXBkYXRlSXNMb2FkaW5nKHsKICAgIGlkOiAndGltZWxpbmUtMScsCiAgICBpc0xvYWRpbmc6IHRydWUKICB9KTsKCiAgaWYgKGFwb2xsb0NsaWVudCkgewogICAgYXBvbGxvQ2xpZW50LnF1ZXJ5KHsKICAgICAgcXVlcnk6IF9pbmRleC5vbmVUaW1lbGluZVF1ZXJ5LAogICAgICBmZXRjaFBvbGljeTogJ25vLWNhY2hlJywKICAgICAgdmFyaWFibGVzOiB7CiAgICAgICAgaWQ6IHRpbWVsaW5lSWQKICAgICAgfQogICAgfSkgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lCiAgICAudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgIHZhciB0aW1lbGluZVRvT3BlbiA9IG9taXRUeXBlbmFtZUluVGltZWxpbmUoKDAsIF9mcC5nZXRPcikoe30sICdkYXRhLmdldE9uZVRpbWVsaW5lJywgcmVzdWx0KSk7CgogICAgICB2YXIgX2Zvcm1hdFRpbWVsaW5lUmVzdWx0ID0gZm9ybWF0VGltZWxpbmVSZXN1bHRUb01vZGVsKHRpbWVsaW5lVG9PcGVuLCBkdXBsaWNhdGUpLAogICAgICAgICAgdGltZWxpbmUgPSBfZm9ybWF0VGltZWxpbmVSZXN1bHQudGltZWxpbmUsCiAgICAgICAgICBub3RlcyA9IF9mb3JtYXRUaW1lbGluZVJlc3VsdC5ub3RlczsKCiAgICAgIGlmIChvbk9wZW5UaW1lbGluZSAhPSBudWxsKSB7CiAgICAgICAgb25PcGVuVGltZWxpbmUodGltZWxpbmUpOwogICAgICB9IGVsc2UgaWYgKHVwZGF0ZVRpbWVsaW5lKSB7CiAgICAgICAgdXBkYXRlVGltZWxpbmUoewogICAgICAgICAgZHVwbGljYXRlOiBkdXBsaWNhdGUsCiAgICAgICAgICBmcm9tOiAoMCwgX2ZwLmdldE9yKSgoMCwgX2RlZmF1bHRfZGF0ZV9zZXR0aW5ncy5nZXREZWZhdWx0RnJvbVZhbHVlKSgpLCAnZGF0ZVJhbmdlLnN0YXJ0JywgdGltZWxpbmUpLAogICAgICAgICAgaWQ6ICd0aW1lbGluZS0xJywKICAgICAgICAgIG5vdGVzOiBub3RlcywKICAgICAgICAgIHRpbWVsaW5lOiBfb2JqZWN0U3ByZWFkKHt9LCB0aW1lbGluZSwgewogICAgICAgICAgICBzaG93OiBvcGVuVGltZWxpbmUKICAgICAgICAgIH0pLAogICAgICAgICAgdG86ICgwLCBfZnAuZ2V0T3IpKCgwLCBfZGVmYXVsdF9kYXRlX3NldHRpbmdzLmdldERlZmF1bHRUb1ZhbHVlKSgpLCAnZGF0ZVJhbmdlLmVuZCcsIHRpbWVsaW5lKQogICAgICAgIH0pKCk7CiAgICAgIH0KICAgIH0pLmZpbmFsbHkoZnVuY3Rpb24gKCkgewogICAgICB1cGRhdGVJc0xvYWRpbmcoewogICAgICAgIGlkOiAndGltZWxpbmUtMScsCiAgICAgICAgaXNMb2FkaW5nOiBmYWxzZQogICAgICB9KTsKICAgIH0pOwogIH0KfTsKCmV4cG9ydHMucXVlcnlUaW1lbGluZUJ5SWQgPSBxdWVyeVRpbWVsaW5lQnlJZDsKCnZhciBkaXNwYXRjaFVwZGF0ZVRpbWVsaW5lID0gZnVuY3Rpb24gZGlzcGF0Y2hVcGRhdGVUaW1lbGluZShkaXNwYXRjaCkgewogIHJldHVybiBmdW5jdGlvbiAoX3JlZjgpIHsKICAgIHZhciBkdXBsaWNhdGUgPSBfcmVmOC5kdXBsaWNhdGUsCiAgICAgICAgaWQgPSBfcmVmOC5pZCwKICAgICAgICBmcm9tID0gX3JlZjguZnJvbSwKICAgICAgICBub3RlcyA9IF9yZWY4Lm5vdGVzLAogICAgICAgIHRpbWVsaW5lID0gX3JlZjgudGltZWxpbmUsCiAgICAgICAgdG8gPSBfcmVmOC50bzsKICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgIGRpc3BhdGNoKCgwLCBfYWN0aW9uczIuc2V0VGltZWxpbmVSYW5nZURhdGVQaWNrZXIpKHsKICAgICAgICBmcm9tOiBmcm9tLAogICAgICAgIHRvOiB0bwogICAgICB9KSk7CiAgICAgIGRpc3BhdGNoKCgwLCBfYWN0aW9uczMuYWRkVGltZWxpbmUpKHsKICAgICAgICBpZDogaWQsCiAgICAgICAgdGltZWxpbmU6IHRpbWVsaW5lCiAgICAgIH0pKTsKCiAgICAgIGlmICh0aW1lbGluZS5rcWxRdWVyeSAhPSBudWxsICYmIHRpbWVsaW5lLmtxbFF1ZXJ5LmZpbHRlclF1ZXJ5ICE9IG51bGwgJiYgdGltZWxpbmUua3FsUXVlcnkuZmlsdGVyUXVlcnkua3VlcnkgIT0gbnVsbCAmJiB0aW1lbGluZS5rcWxRdWVyeS5maWx0ZXJRdWVyeS5rdWVyeS5leHByZXNzaW9uICE9PSAnJykgewogICAgICAgIGRpc3BhdGNoKCgwLCBfYWN0aW9uczMuc2V0S3FsRmlsdGVyUXVlcnlEcmFmdCkoewogICAgICAgICAgaWQ6IGlkLAogICAgICAgICAgZmlsdGVyUXVlcnlEcmFmdDogewogICAgICAgICAgICBraW5kOiAna3VlcnknLAogICAgICAgICAgICBleHByZXNzaW9uOiB0aW1lbGluZS5rcWxRdWVyeS5maWx0ZXJRdWVyeS5rdWVyeS5leHByZXNzaW9uIHx8ICcnCiAgICAgICAgICB9CiAgICAgICAgfSkpOwogICAgICAgIGRpc3BhdGNoKCgwLCBfYWN0aW9uczMuYXBwbHlLcWxGaWx0ZXJRdWVyeSkoewogICAgICAgICAgaWQ6IGlkLAogICAgICAgICAgZmlsdGVyUXVlcnk6IHsKICAgICAgICAgICAga3Vlcnk6IHsKICAgICAgICAgICAgICBraW5kOiAna3VlcnknLAogICAgICAgICAgICAgIGV4cHJlc3Npb246IHRpbWVsaW5lLmtxbFF1ZXJ5LmZpbHRlclF1ZXJ5Lmt1ZXJ5LmV4cHJlc3Npb24gfHwgJycKICAgICAgICAgICAgfSwKICAgICAgICAgICAgc2VyaWFsaXplZFF1ZXJ5OiB0aW1lbGluZS5rcWxRdWVyeS5maWx0ZXJRdWVyeS5zZXJpYWxpemVkUXVlcnkgfHwgJycKICAgICAgICAgIH0KICAgICAgICB9KSk7CiAgICAgIH0KCiAgICAgIGlmICghZHVwbGljYXRlKSB7CiAgICAgICAgZGlzcGF0Y2goKDAsIF9hY3Rpb25zLmFkZE5vdGVzKSh7CiAgICAgICAgICBub3Rlczogbm90ZXMgIT0gbnVsbCA/IG5vdGVzLm1hcChmdW5jdGlvbiAobm90ZSkgewogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgIGNyZWF0ZWQ6IG5vdGUuY3JlYXRlZCAhPSBudWxsID8gbmV3IERhdGUobm90ZS5jcmVhdGVkKSA6IG5ldyBEYXRlKCksCiAgICAgICAgICAgICAgaWQ6IG5vdGUubm90ZUlkLAogICAgICAgICAgICAgIGxhc3RFZGl0OiBub3RlLnVwZGF0ZWQgIT0gbnVsbCA/IG5ldyBEYXRlKG5vdGUudXBkYXRlZCkgOiBuZXcgRGF0ZSgpLAogICAgICAgICAgICAgIG5vdGU6IG5vdGUubm90ZSB8fCAnJywKICAgICAgICAgICAgICB1c2VyOiBub3RlLnVwZGF0ZWRCeSB8fCAndW5rbm93bicsCiAgICAgICAgICAgICAgc2F2ZU9iamVjdElkOiBub3RlLm5vdGVJZCwKICAgICAgICAgICAgICB2ZXJzaW9uOiBub3RlLnZlcnNpb24KICAgICAgICAgICAgfTsKICAgICAgICAgIH0pIDogW10KICAgICAgICB9KSk7CiAgICAgIH0KICAgIH07CiAgfTsKfTsKCmV4cG9ydHMuZGlzcGF0Y2hVcGRhdGVUaW1lbGluZSA9IGRpc3BhdGNoVXBkYXRlVGltZWxpbmU7"},null]}