{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/ml/public/application/timeseriesexplorer/components/forecasting_modal/forecasting_modal.js","dependencies":[{"path":"x-pack/legacy/plugins/ml/public/application/timeseriesexplorer/components/forecasting_modal/forecasting_modal.js","mtime":1585205045996},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkZvcmVjYXN0aW5nTW9kYWwgPSBleHBvcnRzLkZPUkVDQVNUX0RVUkFUSU9OX01BWF9EQVlTID0gdm9pZCAwOwoKdmFyIF9wcm9wVHlwZXMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoInByb3AtdHlwZXMiKSk7Cgp2YXIgX2xvZGFzaCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgibG9kYXNoIikpOwoKdmFyIF9yZWFjdCA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoInJlYWN0IikpOwoKdmFyIF9ldWkgPSByZXF1aXJlKCJAZWxhc3RpYy9ldWkiKTsKCnZhciBfdGltZWZpbHRlciA9IHJlcXVpcmUoInVpL3RpbWVmaWx0ZXIiKTsKCnZhciBfc3RhdGVzID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vLi4vY29tbW9uL2NvbnN0YW50cy9zdGF0ZXMiKTsKCnZhciBfbWVzc2FnZV9sZXZlbHMgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi8uLi9jb21tb24vY29uc3RhbnRzL21lc3NhZ2VfbGV2ZWxzIik7Cgp2YXIgX2pvYl91dGlscyA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uLy4uL2NvbW1vbi91dGlsL2pvYl91dGlscyIpOwoKdmFyIF9wYXJzZV9pbnRlcnZhbCA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uLy4uL2NvbW1vbi91dGlsL3BhcnNlX2ludGVydmFsIik7Cgp2YXIgX21vZGFsID0gcmVxdWlyZSgiLi9tb2RhbCIpOwoKdmFyIF9wcm9ncmVzc19zdGF0ZXMgPSByZXF1aXJlKCIuL3Byb2dyZXNzX3N0YXRlcyIpOwoKdmFyIF9tbF9hcGlfc2VydmljZSA9IHJlcXVpcmUoIi4uLy4uLy4uL3NlcnZpY2VzL21sX2FwaV9zZXJ2aWNlIik7Cgp2YXIgX2pvYl9zZXJ2aWNlID0gcmVxdWlyZSgiLi4vLi4vLi4vc2VydmljZXMvam9iX3NlcnZpY2UiKTsKCnZhciBfZm9yZWNhc3Rfc2VydmljZSA9IHJlcXVpcmUoIi4uLy4uLy4uL3NlcnZpY2VzL2ZvcmVjYXN0X3NlcnZpY2UiKTsKCnZhciBfcmVhY3QyID0gcmVxdWlyZSgiQGtibi9pMThuL3JlYWN0Iik7Cgp2YXIgX2NsYXNzLCBfdGVtcDsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgeyBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7IHJldHVybiBvYmo7IH0gZWxzZSB7IHZhciBuZXdPYmogPSB7fTsgaWYgKG9iaiAhPSBudWxsKSB7IGZvciAodmFyIGtleSBpbiBvYmopIHsgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHsgdmFyIGRlc2MgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvciA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpIDoge307IGlmIChkZXNjLmdldCB8fCBkZXNjLnNldCkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkobmV3T2JqLCBrZXksIGRlc2MpOyB9IGVsc2UgeyBuZXdPYmpba2V5XSA9IG9ialtrZXldOyB9IH0gfSB9IG5ld09iai5kZWZhdWx0ID0gb2JqOyByZXR1cm4gbmV3T2JqOyB9IH0KCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgpmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyBpZiAodHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSAic3ltYm9sIikgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH07IH0gZWxzZSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mKG9iaik7IH0KCmZ1bmN0aW9uIF90b0NvbnN1bWFibGVBcnJheShhcnIpIHsgcmV0dXJuIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfbm9uSXRlcmFibGVTcHJlYWQoKTsgfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlU3ByZWFkKCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gc3ByZWFkIG5vbi1pdGVyYWJsZSBpbnN0YW5jZSIpOyB9CgpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5KGl0ZXIpIHsgaWYgKFN5bWJvbC5pdGVyYXRvciBpbiBPYmplY3QoaXRlcikgfHwgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGl0ZXIpID09PSAiW29iamVjdCBBcmd1bWVudHNdIikgcmV0dXJuIEFycmF5LmZyb20oaXRlcik7IH0KCmZ1bmN0aW9uIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHsgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgeyBmb3IgKHZhciBpID0gMCwgYXJyMiA9IG5ldyBBcnJheShhcnIubGVuZ3RoKTsgaSA8IGFyci5sZW5ndGg7IGkrKykgeyBhcnIyW2ldID0gYXJyW2ldOyB9IHJldHVybiBhcnIyOyB9IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0KCmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9CgpmdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmIChjYWxsICYmIChfdHlwZW9mKGNhbGwpID09PSAib2JqZWN0IiB8fCB0eXBlb2YgY2FsbCA9PT0gImZ1bmN0aW9uIikpIHsgcmV0dXJuIGNhbGw7IH0gcmV0dXJuIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZik7IH0KCmZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IF9nZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IHJldHVybiBvLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2Yobyk7IH07IHJldHVybiBfZ2V0UHJvdG90eXBlT2Yobyk7IH0KCmZ1bmN0aW9uIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZikgeyBpZiAoc2VsZiA9PT0gdm9pZCAwKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcigidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkIik7IH0gcmV0dXJuIHNlbGY7IH0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICJmdW5jdGlvbiIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiIpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcyk7IH0KCmZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IF9zZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBvLl9fcHJvdG9fXyA9IHA7IHJldHVybiBvOyB9OyByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApOyB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7IGlmIChrZXkgaW4gb2JqKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgeyB2YWx1ZTogdmFsdWUsIGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUgfSk7IH0gZWxzZSB7IG9ialtrZXldID0gdmFsdWU7IH0gcmV0dXJuIG9iajsgfQoKdmFyIEZPUkVDQVNUX0RVUkFUSU9OX01BWF9EQVlTID0gMzY1MDsgLy8gTWF4IGZvcmVjYXN0IGR1cmF0aW9uIGFsbG93ZWQgYnkgYW5hbHl0aWNzLgoKZXhwb3J0cy5GT1JFQ0FTVF9EVVJBVElPTl9NQVhfREFZUyA9IEZPUkVDQVNUX0RVUkFUSU9OX01BWF9EQVlTOwp2YXIgRk9SRUNBU1RfSk9CX01JTl9WRVJTSU9OID0gJzYuMS4wJzsgLy8gRm9yZWNhc3Rpbmcgb25seSBhbGxvd2VkIGZvciBqb2JzIGNyZWF0ZWQgPj0gNi4xLjAuCgp2YXIgRk9SRUNBU1RTX1ZJRVdfTUFYID0gNTsgLy8gRGlzcGxheSBsaW5rcyB0byBhIG1heGltdW0gb2YgNSBmb3JlY2FzdHMuCgp2YXIgRk9SRUNBU1RfRFVSQVRJT05fTUFYX01TID0gRk9SRUNBU1RfRFVSQVRJT05fTUFYX0RBWVMgKiA4NjQwMDAwMDsKdmFyIFdBUk5fTlVNX1BBUlRJVElPTlMgPSAxMDA7IC8vIFdhcm4gYWJvdXQgcnVubmluZyBhIGZvcmVjYXN0IHdpdGggdGhpcyBudW1iZXIgb2YgZmllbGQgdmFsdWVzLgoKdmFyIEZPUkVDQVNUX1NUQVRTX1BPTExfRlJFUVVFTkNZID0gMjUwOyAvLyBGcmVxdWVuY3kgaW4gbXMgYXQgd2hpY2ggdG8gcG9sbCBmb3IgZm9yZWNhc3QgcmVxdWVzdCBzdGF0cy4KCnZhciBXQVJOX05PX1BST0dSRVNTX01TID0gMTIwMDAwOyAvLyBJZiBubyBwcm9ncmVzcyBpbiBmb3JlY2FzdCByZXF1ZXN0LCBhYm9ydCBjaGVjayBhbmQgd2Fybi4KCmZ1bmN0aW9uIGdldERlZmF1bHRTdGF0ZSgpIHsKICByZXR1cm4gewogICAgaXNNb2RhbFZpc2libGU6IGZhbHNlLAogICAgcHJldmlvdXNGb3JlY2FzdHM6IFtdLAogICAgaXNGb3JlY2FzdFJlcXVlc3RlZDogZmFsc2UsCiAgICBmb3JlY2FzdFByb2dyZXNzOiBfcHJvZ3Jlc3Nfc3RhdGVzLlBST0dSRVNTX1NUQVRFUy5VTlNFVCwKICAgIGpvYk9wZW5pbmdTdGF0ZTogX3Byb2dyZXNzX3N0YXRlcy5QUk9HUkVTU19TVEFURVMuVU5TRVQsCiAgICBqb2JDbG9zaW5nU3RhdGU6IF9wcm9ncmVzc19zdGF0ZXMuUFJPR1JFU1NfU1RBVEVTLlVOU0VULAogICAgbmV3Rm9yZWNhc3REdXJhdGlvbjogJzFkJywKICAgIGlzTmV3Rm9yZWNhc3REdXJhdGlvblZhbGlkOiB0cnVlLAogICAgbmV3Rm9yZWNhc3REdXJhdGlvbkVycm9yczogW10sCiAgICBtZXNzYWdlczogW10KICB9Owp9Cgp2YXIgRm9yZWNhc3RpbmdNb2RhbCA9ICgwLCBfcmVhY3QyLmluamVjdEkxOG4pKChfdGVtcCA9IF9jbGFzcyA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKF9Db21wb25lbnQpIHsKICBfaW5oZXJpdHMoRm9yZWNhc3RpbmdNb2RhbCwgX0NvbXBvbmVudCk7CgogIGZ1bmN0aW9uIEZvcmVjYXN0aW5nTW9kYWwocHJvcHMpIHsKICAgIHZhciBfdGhpczsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRm9yZWNhc3RpbmdNb2RhbCk7CgogICAgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfZ2V0UHJvdG90eXBlT2YoRm9yZWNhc3RpbmdNb2RhbCkuY2FsbCh0aGlzLCBwcm9wcykpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImFkZE1lc3NhZ2UiLCBmdW5jdGlvbiAobWVzc2FnZSwgc3RhdHVzKSB7CiAgICAgIHZhciBjbGVhckZpcnN0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiBmYWxzZTsKICAgICAgdmFyIG1zZyA9IHsKICAgICAgICBtZXNzYWdlOiBtZXNzYWdlLAogICAgICAgIHN0YXR1czogc3RhdHVzCiAgICAgIH07CgogICAgICBfdGhpcy5zZXRTdGF0ZShmdW5jdGlvbiAocHJldlN0YXRlKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIG1lc3NhZ2VzOiBjbGVhckZpcnN0ID8gW21zZ10gOiBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KHByZXZTdGF0ZS5tZXNzYWdlcyksIFttc2ddKQogICAgICAgIH07CiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAidmlld0ZvcmVjYXN0IiwgZnVuY3Rpb24gKGZvcmVjYXN0SWQpIHsKICAgICAgX3RoaXMucHJvcHMuc2V0Rm9yZWNhc3RJZChmb3JlY2FzdElkKTsKCiAgICAgIF90aGlzLmNsb3NlTW9kYWwoKTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIm9uTmV3Rm9yZWNhc3REdXJhdGlvbkNoYW5nZSIsIGZ1bmN0aW9uIChldmVudCkgewogICAgICB2YXIgaW50bCA9IF90aGlzLnByb3BzLmludGw7CiAgICAgIHZhciBuZXdGb3JlY2FzdER1cmF0aW9uRXJyb3JzID0gW107CiAgICAgIHZhciBpc05ld0ZvcmVjYXN0RHVyYXRpb25WYWxpZCA9IHRydWU7CiAgICAgIHZhciBkdXJhdGlvbiA9ICgwLCBfcGFyc2VfaW50ZXJ2YWwucGFyc2VJbnRlcnZhbCkoZXZlbnQudGFyZ2V0LnZhbHVlKTsKCiAgICAgIGlmIChkdXJhdGlvbiA9PT0gbnVsbCkgewogICAgICAgIGlzTmV3Rm9yZWNhc3REdXJhdGlvblZhbGlkID0gZmFsc2U7CiAgICAgICAgbmV3Rm9yZWNhc3REdXJhdGlvbkVycm9ycy5wdXNoKGludGwuZm9ybWF0TWVzc2FnZSh7CiAgICAgICAgICBpZDogJ3hwYWNrLm1sLnRpbWVTZXJpZXNFeHBsb3Jlci5mb3JlY2FzdGluZ01vZGFsLmludmFsaWREdXJhdGlvbkZvcm1hdEVycm9yTWVzc2FnZScsCiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0ludmFsaWQgZHVyYXRpb24gZm9ybWF0JwogICAgICAgIH0pKTsKICAgICAgfSBlbHNlIGlmIChkdXJhdGlvbi5hc01pbGxpc2Vjb25kcygpID4gRk9SRUNBU1RfRFVSQVRJT05fTUFYX01TKSB7CiAgICAgICAgaXNOZXdGb3JlY2FzdER1cmF0aW9uVmFsaWQgPSBmYWxzZTsKICAgICAgICBuZXdGb3JlY2FzdER1cmF0aW9uRXJyb3JzLnB1c2goaW50bC5mb3JtYXRNZXNzYWdlKHsKICAgICAgICAgIGlkOiAneHBhY2subWwudGltZVNlcmllc0V4cGxvcmVyLmZvcmVjYXN0aW5nTW9kYWwuZm9yZWNhc3REdXJhdGlvbk11c3ROb3RCZUdyZWF0ZXJUaGFuTWF4aW11bUVycm9yTWVzc2FnZScsCiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0ZvcmVjYXN0IGR1cmF0aW9uIG11c3Qgbm90IGJlIGdyZWF0ZXIgdGhhbiB7bWF4aW11bUZvcmVjYXN0RHVyYXRpb25EYXlzfSBkYXlzJwogICAgICAgIH0sIHsKICAgICAgICAgIG1heGltdW1Gb3JlY2FzdER1cmF0aW9uRGF5czogRk9SRUNBU1RfRFVSQVRJT05fTUFYX0RBWVMKICAgICAgICB9KSk7CiAgICAgIH0gZWxzZSBpZiAoZHVyYXRpb24uYXNNaWxsaXNlY29uZHMoKSA9PT0gMCkgewogICAgICAgIGlzTmV3Rm9yZWNhc3REdXJhdGlvblZhbGlkID0gZmFsc2U7CiAgICAgICAgbmV3Rm9yZWNhc3REdXJhdGlvbkVycm9ycy5wdXNoKGludGwuZm9ybWF0TWVzc2FnZSh7CiAgICAgICAgICBpZDogJ3hwYWNrLm1sLnRpbWVTZXJpZXNFeHBsb3Jlci5mb3JlY2FzdGluZ01vZGFsLmZvcmVjYXN0RHVyYXRpb25NdXN0Tm90QmVaZXJvRXJyb3JNZXNzYWdlJywKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnRm9yZWNhc3QgZHVyYXRpb24gbXVzdCBub3QgYmUgemVybycKICAgICAgICB9KSk7CiAgICAgIH0KCiAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICBuZXdGb3JlY2FzdER1cmF0aW9uOiBldmVudC50YXJnZXQudmFsdWUsCiAgICAgICAgaXNOZXdGb3JlY2FzdER1cmF0aW9uVmFsaWQ6IGlzTmV3Rm9yZWNhc3REdXJhdGlvblZhbGlkLAogICAgICAgIG5ld0ZvcmVjYXN0RHVyYXRpb25FcnJvcnM6IG5ld0ZvcmVjYXN0RHVyYXRpb25FcnJvcnMKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJjaGVja0pvYlN0YXRlQW5kUnVuRm9yZWNhc3QiLCBmdW5jdGlvbiAoKSB7CiAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICBpc0ZvcmVjYXN0UmVxdWVzdGVkOiB0cnVlLAogICAgICAgIG1lc3NhZ2VzOiBbXQogICAgICB9KTsgLy8gQSBmb3JlY2FzdCBjYW4gb25seSBiZSBydW4gb24gYW4gb3BlbmVkIGpvYiwKICAgICAgLy8gc28gb3BlbiBqb2IgaWYgaXQgaXMgY2xvc2VkLgoKCiAgICAgIGlmIChfdGhpcy5wcm9wcy5qb2Iuc3RhdGUgPT09IF9zdGF0ZXMuSk9CX1NUQVRFLkNMT1NFRCkgewogICAgICAgIF90aGlzLm9wZW5Kb2JBbmRSdW5Gb3JlY2FzdCgpOwogICAgICB9IGVsc2UgewogICAgICAgIF90aGlzLnJ1bkZvcmVjYXN0KGZhbHNlKTsKICAgICAgfQogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAib3BlbkpvYkFuZFJ1bkZvcmVjYXN0IiwgZnVuY3Rpb24gKCkgewogICAgICAvLyBPcGVucyBhIGpvYiBpbiBhICdjbG9zZWQnIHN0YXRlIHByaW9yIHRvIHJ1bm5pbmcgYSBmb3JlY2FzdC4KICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIGpvYk9wZW5pbmdTdGF0ZTogX3Byb2dyZXNzX3N0YXRlcy5QUk9HUkVTU19TVEFURVMuV0FJVElORwogICAgICB9KTsKCiAgICAgIF9qb2Jfc2VydmljZS5tbEpvYlNlcnZpY2Uub3BlbkpvYihfdGhpcy5wcm9wcy5qb2Iuam9iX2lkKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAvLyBJZiBvcGVuIHdhcyBzdWNjZXNzZnVsIHJ1biB0aGUgZm9yZWNhc3QsIHRoZW4gY2xvc2UgdGhlIGpvYiBhZ2Fpbi4KICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICBqb2JPcGVuaW5nU3RhdGU6IF9wcm9ncmVzc19zdGF0ZXMuUFJPR1JFU1NfU1RBVEVTLkRPTkUKICAgICAgICB9KTsKCiAgICAgICAgX3RoaXMucnVuRm9yZWNhc3QodHJ1ZSk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChyZXNwKSB7CiAgICAgICAgY29uc29sZS5sb2coJ1RpbWUgc2VyaWVzIGZvcmVjYXN0IG1vZGFsIC0gY291bGQgbm90IG9wZW4gam9iOicsIHJlc3ApOwoKICAgICAgICBfdGhpcy5hZGRNZXNzYWdlKF90aGlzLnByb3BzLmludGwuZm9ybWF0TWVzc2FnZSh7CiAgICAgICAgICBpZDogJ3hwYWNrLm1sLnRpbWVTZXJpZXNFeHBsb3Jlci5mb3JlY2FzdGluZ01vZGFsLmVycm9yV2l0aE9wZW5pbmdKb2JCZWZvcmVSdW5uaW5nRm9yZWNhc3RFcnJvck1lc3NhZ2UnLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdFcnJvciBvcGVuaW5nIGpvYiBiZWZvcmUgcnVubmluZyBmb3JlY2FzdCcKICAgICAgICB9KSwgX21lc3NhZ2VfbGV2ZWxzLk1FU1NBR0VfTEVWRUwuRVJST1IpOwoKICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICBqb2JPcGVuaW5nU3RhdGU6IF9wcm9ncmVzc19zdGF0ZXMuUFJPR1JFU1NfU1RBVEVTLkVSUk9SCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAicnVuRm9yZWNhc3RFcnJvckhhbmRsZXIiLCBmdW5jdGlvbiAocmVzcCwgY2xvc2VKb2IpIHsKICAgICAgdmFyIGludGwgPSBfdGhpcy5wcm9wcy5pbnRsOwoKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIGZvcmVjYXN0UHJvZ3Jlc3M6IF9wcm9ncmVzc19zdGF0ZXMuUFJPR1JFU1NfU1RBVEVTLkVSUk9SCiAgICAgIH0pOwoKICAgICAgY29uc29sZS5sb2coJ1RpbWUgc2VyaWVzIGZvcmVjYXN0IG1vZGFsIC0gZXJyb3IgcnVubmluZyBmb3JlY2FzdDonLCByZXNwKTsKCiAgICAgIGlmIChyZXNwICYmIHJlc3AubWVzc2FnZSkgewogICAgICAgIF90aGlzLmFkZE1lc3NhZ2UocmVzcC5tZXNzYWdlLCBfbWVzc2FnZV9sZXZlbHMuTUVTU0FHRV9MRVZFTC5FUlJPUiwgdHJ1ZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgX3RoaXMuYWRkTWVzc2FnZShpbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgaWQ6ICd4cGFjay5tbC50aW1lU2VyaWVzRXhwbG9yZXIuZm9yZWNhc3RpbmdNb2RhbC51bmV4cGVjdGVkUmVzcG9uc2VGcm9tUnVubmluZ0ZvcmVjYXN0RXJyb3JNZXNzYWdlJywKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnVW5leHBlY3RlZCByZXNwb25zZSBmcm9tIHJ1bm5pbmcgZm9yZWNhc3QuIFRoZSByZXF1ZXN0IG1heSBoYXZlIGZhaWxlZC4nCiAgICAgICAgfSksIF9tZXNzYWdlX2xldmVscy5NRVNTQUdFX0xFVkVMLkVSUk9SLCB0cnVlKTsKICAgICAgfQoKICAgICAgaWYgKGNsb3NlSm9iID09PSB0cnVlKSB7CiAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgam9iQ2xvc2luZ1N0YXRlOiBfcHJvZ3Jlc3Nfc3RhdGVzLlBST0dSRVNTX1NUQVRFUy5XQUlUSU5HCiAgICAgICAgfSk7CgogICAgICAgIF9qb2Jfc2VydmljZS5tbEpvYlNlcnZpY2UuY2xvc2VKb2IoX3RoaXMucHJvcHMuam9iLmpvYl9pZCkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgIGpvYkNsb3NpbmdTdGF0ZTogX3Byb2dyZXNzX3N0YXRlcy5QUk9HUkVTU19TVEFURVMuRE9ORQogICAgICAgICAgfSk7CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygnVGltZSBzZXJpZXMgZm9yZWNhc3QgbW9kYWwgLSBjb3VsZCBub3QgY2xvc2Ugam9iOicsIHJlc3BvbnNlKTsKCiAgICAgICAgICBfdGhpcy5hZGRNZXNzYWdlKGludGwuZm9ybWF0TWVzc2FnZSh7CiAgICAgICAgICAgIGlkOiAneHBhY2subWwudGltZVNlcmllc0V4cGxvcmVyLmZvcmVjYXN0aW5nTW9kYWwuZXJyb3JXaXRoQ2xvc2luZ0pvYkVycm9yTWVzc2FnZScsCiAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnRXJyb3IgY2xvc2luZyBqb2InCiAgICAgICAgICB9KSwgX21lc3NhZ2VfbGV2ZWxzLk1FU1NBR0VfTEVWRUwuRVJST1IpOwoKICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgam9iQ2xvc2luZ1N0YXRlOiBfcHJvZ3Jlc3Nfc3RhdGVzLlBST0dSRVNTX1NUQVRFUy5FUlJPUgogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInJ1bkZvcmVjYXN0IiwgZnVuY3Rpb24gKGNsb3NlSm9iQWZ0ZXJSdW5uaW5nKSB7CiAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICBmb3JlY2FzdFByb2dyZXNzOiAwCiAgICAgIH0pOyAvLyBBbHdheXMgc3VwcGx5IHRoZSBkdXJhdGlvbiB0byB0aGUgZW5kcG9pbnQgaW4gc2Vjb25kcyBhcyBzb21lIG9mIHRoZSBtb21lbnQgZHVyYXRpb24KICAgICAgLy8gZm9ybWF0cyBhY2NlcHRlZCBieSBLaWJhbmEgKHcsIE0sIHkpIGFyZSBub3QgdmFsaWQgZm9ybWF0cyBpbiBFbGFzdGljc2VhcmNoLgoKCiAgICAgIHZhciBkdXJhdGlvbkluU2Vjb25kcyA9ICgwLCBfcGFyc2VfaW50ZXJ2YWwucGFyc2VJbnRlcnZhbCkoX3RoaXMuc3RhdGUubmV3Rm9yZWNhc3REdXJhdGlvbikuYXNTZWNvbmRzKCk7CgogICAgICBfZm9yZWNhc3Rfc2VydmljZS5tbEZvcmVjYXN0U2VydmljZS5ydW5Gb3JlY2FzdChfdGhpcy5wcm9wcy5qb2Iuam9iX2lkLCAiIi5jb25jYXQoZHVyYXRpb25JblNlY29uZHMsICJzIikpLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHsKICAgICAgICAvLyBFbmRwb2ludCB3aWxsIHJldHVybiB7IGFja25vd2xlZGdlZDp0cnVlLCBpZDogPG5vdyB0aW1lc3RhbXA+IH0gYmVmb3JlIGZvcmVjYXN0IGlzIGNvbXBsZXRlLgogICAgICAgIC8vIFNvIHdhaXQgZm9yIHJlc3VsdHMgYW5kIHRoZW4gcmVmcmVzaCB0aGUgZGFzaGJvYXJkIHRvIHRoZSBlbmQgb2YgdGhlIGZvcmVjYXN0LgogICAgICAgIGlmIChyZXNwLmZvcmVjYXN0X2lkICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIF90aGlzLndhaXRGb3JGb3JlY2FzdFJlc3VsdHMocmVzcC5mb3JlY2FzdF9pZCwgY2xvc2VKb2JBZnRlclJ1bm5pbmcpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBfdGhpcy5ydW5Gb3JlY2FzdEVycm9ySGFuZGxlcihyZXNwLCBjbG9zZUpvYkFmdGVyUnVubmluZyk7CiAgICAgICAgfQogICAgICB9KS5jYXRjaChmdW5jdGlvbiAocmVzcCkgewogICAgICAgIHJldHVybiBfdGhpcy5ydW5Gb3JlY2FzdEVycm9ySGFuZGxlcihyZXNwLCBjbG9zZUpvYkFmdGVyUnVubmluZyk7CiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAid2FpdEZvckZvcmVjYXN0UmVzdWx0cyIsIGZ1bmN0aW9uIChmb3JlY2FzdElkLCBjbG9zZUpvYkFmdGVyUnVubmluZykgewogICAgICAvLyBPYnRhaW4gdGhlIHN0YXRzIGZvciB0aGUgZm9yZWNhc3QgcmVxdWVzdCBhbmQgY2hlY2sgZm9yZWNhc3QgaXMgcHJvZ3Jlc3NpbmcuCiAgICAgIC8vIFdoZW4gdGhlIHN0YXRzIHNob3cgdGhlIGZvcmVjYXN0IGlzIGZpbmlzaGVkLCBsb2FkIHRoZQogICAgICAvLyBmb3JlY2FzdCByZXN1bHRzIGludG8gdGhlIHZpZXcuCiAgICAgIHZhciBpbnRsID0gX3RoaXMucHJvcHMuaW50bDsKICAgICAgdmFyIHByZXZpb3VzUHJvZ3Jlc3MgPSAwOwogICAgICB2YXIgbm9Qcm9ncmVzc01zID0gMDsKICAgICAgX3RoaXMuZm9yZWNhc3RDaGVja2VyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkgewogICAgICAgIF9mb3JlY2FzdF9zZXJ2aWNlLm1sRm9yZWNhc3RTZXJ2aWNlLmdldEZvcmVjYXN0UmVxdWVzdFN0YXRzKF90aGlzLnByb3BzLmpvYiwgZm9yZWNhc3RJZCkudGhlbihmdW5jdGlvbiAocmVzcCkgewogICAgICAgICAgLy8gR2V0IHRoZSBwcm9ncmVzcyAoc3RhdHMgdmFsdWUgaXMgYmV0d2VlbiAwIGFuZCAxKS4KICAgICAgICAgIHZhciBwcm9ncmVzcyA9IF9sb2Rhc2guZGVmYXVsdC5nZXQocmVzcCwgWydzdGF0cycsICdmb3JlY2FzdF9wcm9ncmVzcyddLCBwcmV2aW91c1Byb2dyZXNzKTsKCiAgICAgICAgICB2YXIgc3RhdHVzID0gX2xvZGFzaC5kZWZhdWx0LmdldChyZXNwLCBbJ3N0YXRzJywgJ2ZvcmVjYXN0X3N0YXR1cyddKTsgLy8gVGhlIHJlcXVlc3RzIGZvciBmb3JlY2FzdCBzdGF0cyBjYW4gZ2V0IHJvdXRlZCB0byBkaWZmZXJlbnQgc2hhcmRzLAogICAgICAgICAgLy8gYW5kIGlmIHRoZXNlIG9wZXJhdGUgYXQgZGlmZmVyZW50IHNwZWVkcyB0aGVyZSBpcyBhIGNoYW5jZSB0aGF0IGEKICAgICAgICAgIC8vIHByZXZpb3VzIHJlcXVlc3QgY291bGQgYXJyaXZlIGxhdGVyLgogICAgICAgICAgLy8gVGhlIHByb2dyZXNzIHJlcG9ydGVkIGJ5IHRoZSBiYWNrLWVuZCBzaG91bGQgbmV2ZXIgZ28gZG93biwgc28KICAgICAgICAgIC8vIHRvIGJlIG9uIHRoZSBzYWZlIHNpZGUsIG9ubHkgdXBkYXRlIHN0YXRlIGlmIHByb2dyZXNzIGhhcyBpbmNyZWFzZWQuCgoKICAgICAgICAgIGlmIChwcm9ncmVzcyA+IHByZXZpb3VzUHJvZ3Jlc3MpIHsKICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgIGZvcmVjYXN0UHJvZ3Jlc3M6IE1hdGgucm91bmQoMTAwICogcHJvZ3Jlc3MpCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSAvLyBEaXNwbGF5IGFueSBtZXNzYWdlcyByZXR1cm5lZCBpbiB0aGUgcmVxdWVzdCBzdGF0cy4KCgogICAgICAgICAgdmFyIG1lc3NhZ2VzID0gX2xvZGFzaC5kZWZhdWx0LmdldChyZXNwLCBbJ3N0YXRzJywgJ2ZvcmVjYXN0X21lc3NhZ2VzJ10sIFtdKTsKCiAgICAgICAgICBtZXNzYWdlcyA9IG1lc3NhZ2VzLm1hcChmdW5jdGlvbiAobWVzc2FnZSkgewogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsCiAgICAgICAgICAgICAgc3RhdHVzOiBfbWVzc2FnZV9sZXZlbHMuTUVTU0FHRV9MRVZFTC5XQVJOSU5HCiAgICAgICAgICAgIH07CiAgICAgICAgICB9KTsKCiAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgIG1lc3NhZ2VzOiBtZXNzYWdlcwogICAgICAgICAgfSk7CgogICAgICAgICAgaWYgKHN0YXR1cyA9PT0gX3N0YXRlcy5GT1JFQ0FTVF9SRVFVRVNUX1NUQVRFLkZJTklTSEVEKSB7CiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoX3RoaXMuZm9yZWNhc3RDaGVja2VyKTsKCiAgICAgICAgICAgIGlmIChjbG9zZUpvYkFmdGVyUnVubmluZyA9PT0gdHJ1ZSkgewogICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgIGpvYkNsb3NpbmdTdGF0ZTogX3Byb2dyZXNzX3N0YXRlcy5QUk9HUkVTU19TVEFURVMuV0FJVElORwogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBfam9iX3NlcnZpY2UubWxKb2JTZXJ2aWNlLmNsb3NlSm9iKF90aGlzLnByb3BzLmpvYi5qb2JfaWQpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgICBqb2JDbG9zaW5nU3RhdGU6IF9wcm9ncmVzc19zdGF0ZXMuUFJPR1JFU1NfU1RBVEVTLkRPTkUKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIF90aGlzLnByb3BzLnNldEZvcmVjYXN0SWQoZm9yZWNhc3RJZCk7CgogICAgICAgICAgICAgICAgX3RoaXMuY2xvc2VBZnRlclJ1bm5pbmdGb3JlY2FzdCgpOwogICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICAgICAgLy8gTG9hZCB0aGUgZm9yZWNhc3QgZGF0YSBpbiB0aGUgbWFpbiBwYWdlLAogICAgICAgICAgICAgICAgLy8gYnV0IGxlYXZlIHRoaXMgZGlhbG9nIG9wZW4gc28gdGhlIGVycm9yIGNhbiBiZSB2aWV3ZWQuCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVGltZSBzZXJpZXMgZm9yZWNhc3QgbW9kYWwgLSBjb3VsZCBub3QgY2xvc2Ugam9iOicsIHJlc3BvbnNlKTsKCiAgICAgICAgICAgICAgICBfdGhpcy5hZGRNZXNzYWdlKGludGwuZm9ybWF0TWVzc2FnZSh7CiAgICAgICAgICAgICAgICAgIGlkOiAneHBhY2subWwudGltZVNlcmllc0V4cGxvcmVyLmZvcmVjYXN0aW5nTW9kYWwuZXJyb3JXaXRoQ2xvc2luZ0pvYkFmdGVyUnVubmluZ0ZvcmVjYXN0RXJyb3JNZXNzYWdlJywKICAgICAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdFcnJvciBjbG9zaW5nIGpvYiBhZnRlciBydW5uaW5nIGZvcmVjYXN0JwogICAgICAgICAgICAgICAgfSksIF9tZXNzYWdlX2xldmVscy5NRVNTQUdFX0xFVkVMLkVSUk9SKTsKCiAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICAgIGpvYkNsb3NpbmdTdGF0ZTogX3Byb2dyZXNzX3N0YXRlcy5QUk9HUkVTU19TVEFURVMuRVJST1IKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIF90aGlzLnByb3BzLnNldEZvcmVjYXN0SWQoZm9yZWNhc3RJZCk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgX3RoaXMucHJvcHMuc2V0Rm9yZWNhc3RJZChmb3JlY2FzdElkKTsKCiAgICAgICAgICAgICAgX3RoaXMuY2xvc2VBZnRlclJ1bm5pbmdGb3JlY2FzdCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyBEaXNwbGF5IGEgd2FybmluZyBhbmQgYWJvcnQgY2hlY2sgaWYgdGhlIGZvcmVjYXN0IGhhc24ndAogICAgICAgICAgICAvLyBwcm9ncmVzc2VkIGZvciBXQVJOX05PX1BST0dSRVNTX01TLgogICAgICAgICAgICBpZiAocHJvZ3Jlc3MgPT09IHByZXZpb3VzUHJvZ3Jlc3MpIHsKICAgICAgICAgICAgICBub1Byb2dyZXNzTXMgKz0gRk9SRUNBU1RfU1RBVFNfUE9MTF9GUkVRVUVOQ1k7CgogICAgICAgICAgICAgIGlmIChub1Byb2dyZXNzTXMgPiBXQVJOX05PX1BST0dSRVNTX01TKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiRm9yZWNhc3QgcmVxdWVzdCBoYXMgbm90IHByb2dyZXNzZWQgZm9yICIuY29uY2F0KFdBUk5fTk9fUFJPR1JFU1NfTVMsICJtcy4gQ2FuY2VsbGluZyBjaGVjay4iKSk7CgogICAgICAgICAgICAgICAgX3RoaXMuYWRkTWVzc2FnZShpbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgICAgICAgICBpZDogJ3hwYWNrLm1sLnRpbWVTZXJpZXNFeHBsb3Jlci5mb3JlY2FzdGluZ01vZGFsLm5vUHJvZ3Jlc3NSZXBvcnRlZEZvck5ld0ZvcmVjYXN0RXJyb3JNZXNzYWdlJywKICAgICAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdObyBwcm9ncmVzcyByZXBvcnRlZCBmb3IgdGhlIG5ldyBmb3JlY2FzdCBmb3Ige1dhcm5Ob1Byb2dyZXNzTXN9bXMuJyArICdBbiBlcnJvciBtYXkgaGF2ZSBvY2N1cnJlZCB3aGlsc3QgcnVubmluZyB0aGUgZm9yZWNhc3QuJwogICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgICBXYXJuTm9Qcm9ncmVzc01zOiBXQVJOX05PX1BST0dSRVNTX01TCiAgICAgICAgICAgICAgICB9KSwgX21lc3NhZ2VfbGV2ZWxzLk1FU1NBR0VfTEVWRUwuRVJST1IpOyAvLyBUcnkgYW5kIGxvYWQgYW55IHJlc3VsdHMgd2hpY2ggbWF5IGhhdmUgYmVlbiBjcmVhdGVkLgoKCiAgICAgICAgICAgICAgICBfdGhpcy5wcm9wcy5zZXRGb3JlY2FzdElkKGZvcmVjYXN0SWQpOwoKICAgICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgICAgZm9yZWNhc3RQcm9ncmVzczogX3Byb2dyZXNzX3N0YXRlcy5QUk9HUkVTU19TVEFURVMuRVJST1IKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoX3RoaXMuZm9yZWNhc3RDaGVja2VyKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgaWYgKHByb2dyZXNzID4gcHJldmlvdXNQcm9ncmVzcykgewogICAgICAgICAgICAgICAgcHJldmlvdXNQcm9ncmVzcyA9IHByb2dyZXNzOwogICAgICAgICAgICAgIH0gLy8gUmVzZXQgdGhlICdubyBwcm9ncmVzcycgY2hlY2sgdmFsdWUuCgoKICAgICAgICAgICAgICBub1Byb2dyZXNzTXMgPSAwOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlc3ApIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdUaW1lIHNlcmllcyBmb3JlY2FzdCBtb2RhbCAtIGVycm9yIGxvYWRpbmcgc3RhdHMgb2YgZm9yZWNhc3QgZnJvbSBlbGFzdGljc2VhcmNoOicsIHJlc3ApOwoKICAgICAgICAgIF90aGlzLmFkZE1lc3NhZ2UoaW50bC5mb3JtYXRNZXNzYWdlKHsKICAgICAgICAgICAgaWQ6ICd4cGFjay5tbC50aW1lU2VyaWVzRXhwbG9yZXIuZm9yZWNhc3RpbmdNb2RhbC5lcnJvcldpdGhMb2FkaW5nU3RhdHNPZlJ1bm5pbmdGb3JlY2FzdEVycm9yTWVzc2FnZScsCiAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnRXJyb3IgbG9hZGluZyBzdGF0cyBvZiBydW5uaW5nIGZvcmVjYXN0LicKICAgICAgICAgIH0pLCBfbWVzc2FnZV9sZXZlbHMuTUVTU0FHRV9MRVZFTC5FUlJPUik7CgogICAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICBmb3JlY2FzdFByb2dyZXNzOiBfcHJvZ3Jlc3Nfc3RhdGVzLlBST0dSRVNTX1NUQVRFUy5FUlJPUgogICAgICAgICAgfSk7CgogICAgICAgICAgY2xlYXJJbnRlcnZhbChfdGhpcy5mb3JlY2FzdENoZWNrZXIpOwogICAgICAgIH0pOwogICAgICB9LCBGT1JFQ0FTVF9TVEFUU19QT0xMX0ZSRVFVRU5DWSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJvcGVuTW9kYWwiLCBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBpbnRsID0gX3RoaXMucHJvcHMuaW50bDsKICAgICAgdmFyIGpvYiA9IF90aGlzLnByb3BzLmpvYjsKCiAgICAgIGlmIChfdHlwZW9mKGpvYikgPT09ICdvYmplY3QnKSB7CiAgICAgICAgLy8gR2V0IHRoZSBsaXN0IG9mIGFsbCB0aGUgZmluaXNoZWQgZm9yZWNhc3RzIGZvciB0aGlzIGpvYiB3aXRoIHJlc3VsdHMgYXQgb3IgbGF0ZXIgdGhhbiB0aGUgZGFzaGJvYXJkICdmcm9tJyB0aW1lLgogICAgICAgIHZhciBib3VuZHMgPSBfdGltZWZpbHRlci50aW1lZmlsdGVyLmdldEFjdGl2ZUJvdW5kcygpOwoKICAgICAgICB2YXIgc3RhdHVzRmluaXNoZWRRdWVyeSA9IHsKICAgICAgICAgIHRlcm06IHsKICAgICAgICAgICAgZm9yZWNhc3Rfc3RhdHVzOiBfc3RhdGVzLkZPUkVDQVNUX1JFUVVFU1RfU1RBVEUuRklOSVNIRUQKICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICBfZm9yZWNhc3Rfc2VydmljZS5tbEZvcmVjYXN0U2VydmljZS5nZXRGb3JlY2FzdHNTdW1tYXJ5KGpvYiwgc3RhdHVzRmluaXNoZWRRdWVyeSwgYm91bmRzLm1pbi52YWx1ZU9mKCksIEZPUkVDQVNUU19WSUVXX01BWCkudGhlbihmdW5jdGlvbiAocmVzcCkgewogICAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICBwcmV2aW91c0ZvcmVjYXN0czogcmVzcC5mb3JlY2FzdHMKICAgICAgICAgIH0pOwogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChyZXNwKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygnVGltZSBzZXJpZXMgZm9yZWNhc3QgbW9kYWwgLSBlcnJvciBvYnRhaW5pbmcgZm9yZWNhc3RzIHN1bW1hcnk6JywgcmVzcCk7CgogICAgICAgICAgX3RoaXMuYWRkTWVzc2FnZShpbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgICBpZDogJ3hwYWNrLm1sLnRpbWVTZXJpZXNFeHBsb3Jlci5mb3JlY2FzdGluZ01vZGFsLmVycm9yV2l0aE9idGFpbmluZ0xpc3RPZlByZXZpb3VzRm9yZWNhc3RzRXJyb3JNZXNzYWdlJywKICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdFcnJvciBvYnRhaW5pbmcgbGlzdCBvZiBwcmV2aW91cyBmb3JlY2FzdHMnCiAgICAgICAgICB9KSwgX21lc3NhZ2VfbGV2ZWxzLk1FU1NBR0VfTEVWRUwuRVJST1IpOwogICAgICAgIH0pOyAvLyBEaXNwbGF5IGEgd2FybmluZyBhYm91dCBydW5uaW5nIGEgZm9yZWNhc3QgaWYgdGhlcmUgaXMgaGlnaCBudW1iZXIKICAgICAgICAvLyBvZiBwYXJ0aXRpb25pbmcgZmllbGRzLgoKCiAgICAgICAgdmFyIGVudGl0eUZpZWxkTmFtZXMgPSBfdGhpcy5wcm9wcy5lbnRpdGllcy5tYXAoZnVuY3Rpb24gKGVudGl0eSkgewogICAgICAgICAgcmV0dXJuIGVudGl0eS5maWVsZE5hbWU7CiAgICAgICAgfSk7CgogICAgICAgIGlmIChlbnRpdHlGaWVsZE5hbWVzLmxlbmd0aCA+IDApIHsKICAgICAgICAgIF9tbF9hcGlfc2VydmljZS5tbC5nZXRDYXJkaW5hbGl0eU9mRmllbGRzKHsKICAgICAgICAgICAgaW5kZXg6IGpvYi5kYXRhZmVlZF9jb25maWcuaW5kaWNlcywKICAgICAgICAgICAgZmllbGROYW1lczogZW50aXR5RmllbGROYW1lcywKICAgICAgICAgICAgcXVlcnk6IGpvYi5kYXRhZmVlZF9jb25maWcucXVlcnksCiAgICAgICAgICAgIHRpbWVGaWVsZE5hbWU6IGpvYi5kYXRhX2Rlc2NyaXB0aW9uLnRpbWVfZmllbGQsCiAgICAgICAgICAgIGVhcmxpZXN0TXM6IGpvYi5kYXRhX2NvdW50cy5lYXJsaWVzdF9yZWNvcmRfdGltZXN0YW1wLAogICAgICAgICAgICBsYXRlc3RNczogam9iLmRhdGFfY291bnRzLmxhdGVzdF9yZWNvcmRfdGltZXN0YW1wCiAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXN1bHRzKSB7CiAgICAgICAgICAgIHZhciBudW1QYXJ0aXRpb25zID0gMTsKICAgICAgICAgICAgT2JqZWN0LnZhbHVlcyhyZXN1bHRzKS5mb3JFYWNoKGZ1bmN0aW9uIChjYXJkaW5hbGl0eSkgewogICAgICAgICAgICAgIG51bVBhcnRpdGlvbnMgPSBudW1QYXJ0aXRpb25zICogY2FyZGluYWxpdHk7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgaWYgKG51bVBhcnRpdGlvbnMgPiBXQVJOX05VTV9QQVJUSVRJT05TKSB7CiAgICAgICAgICAgICAgX3RoaXMuYWRkTWVzc2FnZShpbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgICAgICAgaWQ6ICd4cGFjay5tbC50aW1lU2VyaWVzRXhwbG9yZXIuZm9yZWNhc3RpbmdNb2RhbC5kYXRhQ29udGFpbnNNb3JlUGFydGl0aW9uc01lc3NhZ2UnLAogICAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdOb3RlIHRoYXQgdGhpcyBkYXRhIGNvbnRhaW5zIG1vcmUgdGhhbiB7d2Fybk51bVBhcnRpdGlvbnN9ICcgKyAncGFydGl0aW9ucyBzbyBydW5uaW5nIGEgZm9yZWNhc3QgbWF5IHRha2UgYSBsb25nIHRpbWUgYW5kIGNvbnN1bWUgYSBoaWdoIGFtb3VudCBvZiByZXNvdXJjZScKICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICB3YXJuTnVtUGFydGl0aW9uczogV0FSTl9OVU1fUEFSVElUSU9OUwogICAgICAgICAgICAgIH0pLCBfbWVzc2FnZV9sZXZlbHMuTUVTU0FHRV9MRVZFTC5XQVJOSU5HKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlc3ApIHsKICAgICAgICAgICAgY29uc29sZS5sb2coJ1RpbWUgc2VyaWVzIGZvcmVjYXN0IG1vZGFsIC0gZXJyb3Igb2J0YWluaW5nIGNhcmRpbmFsaXR5IG9mIGZpZWxkczonLCByZXNwKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgaXNNb2RhbFZpc2libGU6IHRydWUKICAgICAgICB9KTsKICAgICAgfQogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiY2xvc2VBZnRlclJ1bm5pbmdGb3JlY2FzdCIsIGZ1bmN0aW9uICgpIHsKICAgICAgLy8gT25seSBjbG9zZSB0aGUgZGlhbG9nIGF1dG9tYXRpY2FsbHkgYWZ0ZXIgYSBmb3JlY2FzdCBoYXMgcnVuCiAgICAgIC8vIGlmIHRoZSBtZXNzYWdlIGJhciBpcyBjbGVhci4gT3RoZXJ3aXNlIHRoZSB1c2VyIG1heSBub3QgY2F0Y2gKICAgICAgLy8gYW55IG1lc3NhZ2VzIHJldHVybmVkIGluIHRoZSBmb3JlY2FzdCByZXF1ZXN0IHN0YXRzLgogICAgICBpZiAoX3RoaXMuc3RhdGUubWVzc2FnZXMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgLy8gV3JhcCB0aGUgY2xvc2UgaW4gYSB0aW1lb3V0IHRvIGdpdmUgdGhlIHVzZXIgYSBjaGFuY2UgdG8gc2VlIHByb2dyZXNzIHVwZGF0ZS4KICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgIF90aGlzLmNsb3NlTW9kYWwoKTsKICAgICAgICB9LCAxMDAwKTsKICAgICAgfQogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiY2xvc2VNb2RhbCIsIGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKF90aGlzLmZvcmVjYXN0Q2hlY2tlciAhPT0gbnVsbCkgewogICAgICAgIGNsZWFySW50ZXJ2YWwoX3RoaXMuZm9yZWNhc3RDaGVja2VyKTsKICAgICAgfQoKICAgICAgX3RoaXMuc2V0U3RhdGUoZ2V0RGVmYXVsdFN0YXRlKCkpOwogICAgfSk7CgogICAgX3RoaXMuc3RhdGUgPSBnZXREZWZhdWx0U3RhdGUoKTsgLy8gVXNlZCB0byBwb2xsIGZvciB1cGRhdGVzIG9uIGEgcnVubmluZyBmb3JlY2FzdC4KCiAgICBfdGhpcy5mb3JlY2FzdENoZWNrZXIgPSBudWxsOwogICAgcmV0dXJuIF90aGlzOwogIH0KCiAgX2NyZWF0ZUNsYXNzKEZvcmVjYXN0aW5nTW9kYWwsIFt7CiAgICBrZXk6ICJyZW5kZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHsKICAgICAgLy8gRm9yZWNhc3RpbmcgZGlzYWJsZWQgaWYgZGV0ZWN0b3IgaGFzIGFuIG92ZXIgZmllbGQgb3Igam9iIGNyZWF0ZWQgPCA2LjEuMC4KICAgICAgdmFyIGlzRm9yZWNhc3RpbmdEaXNhYmxlZCA9IGZhbHNlOwogICAgICB2YXIgZm9yZWNhc3RpbmdEaXNhYmxlZE1lc3NhZ2UgPSBudWxsOwogICAgICB2YXIgX3RoaXMkcHJvcHMgPSB0aGlzLnByb3BzLAogICAgICAgICAgaW50bCA9IF90aGlzJHByb3BzLmludGwsCiAgICAgICAgICBqb2IgPSBfdGhpcyRwcm9wcy5qb2I7CgogICAgICBpZiAoam9iICE9PSB1bmRlZmluZWQpIHsKICAgICAgICB2YXIgZGV0ZWN0b3IgPSBqb2IuYW5hbHlzaXNfY29uZmlnLmRldGVjdG9yc1t0aGlzLnByb3BzLmRldGVjdG9ySW5kZXhdOwogICAgICAgIHZhciBvdmVyRmllbGROYW1lID0gZGV0ZWN0b3Iub3Zlcl9maWVsZF9uYW1lOwoKICAgICAgICBpZiAob3ZlckZpZWxkTmFtZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICBpc0ZvcmVjYXN0aW5nRGlzYWJsZWQgPSB0cnVlOwogICAgICAgICAgZm9yZWNhc3RpbmdEaXNhYmxlZE1lc3NhZ2UgPSBpbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgICBpZDogJ3hwYWNrLm1sLnRpbWVTZXJpZXNFeHBsb3Jlci5mb3JlY2FzdGluZ01vZGFsLmZvcmVjYXN0aW5nTm90QXZhaWxhYmxlRm9yUG9wdWxhdGlvbkRldGVjdG9yc01lc3NhZ2UnLAogICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0ZvcmVjYXN0aW5nIGlzIG5vdCBhdmFpbGFibGUgZm9yIHBvcHVsYXRpb24gZGV0ZWN0b3JzIHdpdGggYW4gb3ZlciBmaWVsZCcKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSBpZiAoKDAsIF9qb2JfdXRpbHMuaXNKb2JWZXJzaW9uR3RlKShqb2IsIEZPUkVDQVNUX0pPQl9NSU5fVkVSU0lPTikgPT09IGZhbHNlKSB7CiAgICAgICAgICBpc0ZvcmVjYXN0aW5nRGlzYWJsZWQgPSB0cnVlOwogICAgICAgICAgZm9yZWNhc3RpbmdEaXNhYmxlZE1lc3NhZ2UgPSBpbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgICBpZDogJ3hwYWNrLm1sLnRpbWVTZXJpZXNFeHBsb3Jlci5mb3JlY2FzdGluZ01vZGFsLmZvcmVjYXN0aW5nT25seUF2YWlsYWJsZUZvckpvYnNDcmVhdGVkSW5TcGVjaWZpZWRWZXJzaW9uTWVzc2FnZScsCiAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnRm9yZWNhc3RpbmcgaXMgb25seSBhdmFpbGFibGUgZm9yIGpvYnMgY3JlYXRlZCBpbiB2ZXJzaW9uIHttaW5WZXJzaW9ufSBvciBsYXRlcicKICAgICAgICAgIH0sIHsKICAgICAgICAgICAgbWluVmVyc2lvbjogRk9SRUNBU1RfSk9CX01JTl9WRVJTSU9OCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHZhciBmb3JlY2FzdEJ1dHRvbiA9IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlCdXR0b24sIHsKICAgICAgICBvbkNsaWNrOiB0aGlzLm9wZW5Nb2RhbCwKICAgICAgICBpc0Rpc2FibGVkOiBpc0ZvcmVjYXN0aW5nRGlzYWJsZWQsCiAgICAgICAgZmlsbDogdHJ1ZSwKICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiAibWxTaW5nbGVNZXRyaWNWaWV3ZXJCdXR0b25Gb3JlY2FzdCIKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogInhwYWNrLm1sLnRpbWVTZXJpZXNFeHBsb3Jlci5mb3JlY2FzdGluZ01vZGFsLmZvcmVjYXN0QnV0dG9uTGFiZWwiLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiRm9yZWNhc3QiCiAgICAgIH0pKTsKCiAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJkaXYiLCBudWxsLCBpc0ZvcmVjYXN0aW5nRGlzYWJsZWQgPyBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVG9vbFRpcCwgewogICAgICAgIHBvc2l0aW9uOiAibGVmdCIsCiAgICAgICAgY29udGVudDogZm9yZWNhc3RpbmdEaXNhYmxlZE1lc3NhZ2UKICAgICAgfSwgZm9yZWNhc3RCdXR0b24pIDogZm9yZWNhc3RCdXR0b24sIHRoaXMuc3RhdGUuaXNNb2RhbFZpc2libGUgJiYgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfbW9kYWwuTW9kYWwsIHsKICAgICAgICBqb2I6IHRoaXMucHJvcHMuam9iLAogICAgICAgIGZvcmVjYXN0czogdGhpcy5zdGF0ZS5wcmV2aW91c0ZvcmVjYXN0cywKICAgICAgICBjbG9zZTogdGhpcy5jbG9zZU1vZGFsLAogICAgICAgIHZpZXdGb3JlY2FzdDogdGhpcy52aWV3Rm9yZWNhc3QsCiAgICAgICAgcnVuRm9yZWNhc3Q6IHRoaXMuY2hlY2tKb2JTdGF0ZUFuZFJ1bkZvcmVjYXN0LAogICAgICAgIG5ld0ZvcmVjYXN0RHVyYXRpb246IHRoaXMuc3RhdGUubmV3Rm9yZWNhc3REdXJhdGlvbiwKICAgICAgICBvbk5ld0ZvcmVjYXN0RHVyYXRpb25DaGFuZ2U6IHRoaXMub25OZXdGb3JlY2FzdER1cmF0aW9uQ2hhbmdlLAogICAgICAgIGlzTmV3Rm9yZWNhc3REdXJhdGlvblZhbGlkOiB0aGlzLnN0YXRlLmlzTmV3Rm9yZWNhc3REdXJhdGlvblZhbGlkLAogICAgICAgIG5ld0ZvcmVjYXN0RHVyYXRpb25FcnJvcnM6IHRoaXMuc3RhdGUubmV3Rm9yZWNhc3REdXJhdGlvbkVycm9ycywKICAgICAgICBpc0ZvcmVjYXN0UmVxdWVzdGVkOiB0aGlzLnN0YXRlLmlzRm9yZWNhc3RSZXF1ZXN0ZWQsCiAgICAgICAgZm9yZWNhc3RQcm9ncmVzczogdGhpcy5zdGF0ZS5mb3JlY2FzdFByb2dyZXNzLAogICAgICAgIGpvYk9wZW5pbmdTdGF0ZTogdGhpcy5zdGF0ZS5qb2JPcGVuaW5nU3RhdGUsCiAgICAgICAgam9iQ2xvc2luZ1N0YXRlOiB0aGlzLnN0YXRlLmpvYkNsb3NpbmdTdGF0ZSwKICAgICAgICBtZXNzYWdlczogdGhpcy5zdGF0ZS5tZXNzYWdlcwogICAgICB9KSk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gRm9yZWNhc3RpbmdNb2RhbDsKfShfcmVhY3QuQ29tcG9uZW50KSwgX2RlZmluZVByb3BlcnR5KF9jbGFzcywgInByb3BUeXBlcyIsIHsKICBpc0Rpc2FibGVkOiBfcHJvcFR5cGVzLmRlZmF1bHQuYm9vbCwKICBqb2I6IF9wcm9wVHlwZXMuZGVmYXVsdC5vYmplY3QsCiAgZGV0ZWN0b3JJbmRleDogX3Byb3BUeXBlcy5kZWZhdWx0Lm51bWJlciwKICBlbnRpdGllczogX3Byb3BUeXBlcy5kZWZhdWx0LmFycmF5LAogIHNldEZvcmVjYXN0SWQ6IF9wcm9wVHlwZXMuZGVmYXVsdC5mdW5jCn0pLCBfdGVtcCkpOwpleHBvcnRzLkZvcmVjYXN0aW5nTW9kYWwgPSBGb3JlY2FzdGluZ01vZGFsOw=="},null]}