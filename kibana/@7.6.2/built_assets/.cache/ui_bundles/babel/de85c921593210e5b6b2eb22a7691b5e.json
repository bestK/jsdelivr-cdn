{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/ml/public/application/jobs/new_job/common/job_runner/job_runner.js","dependencies":[{"path":"x-pack/legacy/plugins/ml/public/application/jobs/new_job/common/job_runner/job_runner.js","mtime":1585205045856},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkpvYlJ1bm5lciA9IHZvaWQgMDsKCnZhciBfcnhqcyA9IHJlcXVpcmUoInJ4anMiKTsKCnZhciBfbWxfYXBpX3NlcnZpY2UgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9zZXJ2aWNlcy9tbF9hcGlfc2VydmljZSIpOwoKdmFyIF9qb2Jfc2VydmljZSA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL3NlcnZpY2VzL2pvYl9zZXJ2aWNlIik7Cgp2YXIgX3N0YXRlcyA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uLy4uLy4uL2NvbW1vbi9jb25zdGFudHMvc3RhdGVzIik7CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7CiAgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOwogIH0KfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgewogIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsKICAgIHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07CiAgICBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7CiAgICBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7CiAgICBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsKICB9Cn0KCmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsKICBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsKICBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7CiAgcmV0dXJuIENvbnN0cnVjdG9yOwp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7CiAgaWYgKGtleSBpbiBvYmopIHsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgICB2YWx1ZTogdmFsdWUsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgd3JpdGFibGU6IHRydWUKICAgIH0pOwogIH0gZWxzZSB7CiAgICBvYmpba2V5XSA9IHZhbHVlOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKdmFyIFJFRlJFU0hfSU5URVJWQUxfTVMgPSAxMDA7CnZhciBUQVJHRVRfUFJPR1JFU1NfREVMVEEgPSAyOwp2YXIgUkVGUkVTSF9SQVRFX0FESlVTVE1FTlRfREVMQVlfTVMgPSAyMDAwOwoKdmFyIEpvYlJ1bm5lciA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIEpvYlJ1bm5lcihqb2JDcmVhdG9yKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgSm9iUnVubmVyKTsKCiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgIl9qb2JJZCIsIHZvaWQgMCk7CgogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICJfZGF0YWZlZWRJZCIsIHZvaWQgMCk7CgogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICJfc3RhcnQiLCAwKTsKCiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgIl9lbmQiLCAwKTsKCiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgIl9kYXRhZmVlZFN0YXRlIiwgX3N0YXRlcy5EQVRBRkVFRF9TVEFURS5TVE9QUEVEKTsKCiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgIl9yZWZyZXNoSW50ZXJ2YWwiLCBSRUZSRVNIX0lOVEVSVkFMX01TKTsKCiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgIl9wcm9ncmVzcyQiLCB2b2lkIDApOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiX3BlcmNlbnRhZ2VDb21wbGV0ZSIsIDApOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiX3N0b3BSZWZyZXNoUG9sbCIsIHZvaWQgMCk7CgogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICJfc3Vic2NyaWJlcnMiLCB2b2lkIDApOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiX2RhdGFmZWVkU3RhcnRUaW1lIiwgMCk7CgogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICJfcGVyZm9ybVJlZnJlc2hSYXRlQWRqdXN0bWVudCIsIGZhbHNlKTsKCiAgICB0aGlzLl9qb2JJZCA9IGpvYkNyZWF0b3Iuam9iSWQ7CiAgICB0aGlzLl9kYXRhZmVlZElkID0gam9iQ3JlYXRvci5kYXRhZmVlZElkOwogICAgdGhpcy5fc3RhcnQgPSBqb2JDcmVhdG9yLnN0YXJ0OwogICAgdGhpcy5fZW5kID0gam9iQ3JlYXRvci5lbmQ7CiAgICB0aGlzLl9wZXJjZW50YWdlQ29tcGxldGUgPSAwOwogICAgdGhpcy5fc3RvcFJlZnJlc2hQb2xsID0gam9iQ3JlYXRvci5zdG9wQWxsUmVmcmVzaFBvbGxzOwogICAgdGhpcy5fcHJvZ3Jlc3MkID0gbmV3IF9yeGpzLkJlaGF2aW9yU3ViamVjdCh0aGlzLl9wZXJjZW50YWdlQ29tcGxldGUpOwogICAgdGhpcy5fc3Vic2NyaWJlcnMgPSBqb2JDcmVhdG9yLnN1YnNjcmliZXJzOwogIH0KCiAgX2NyZWF0ZUNsYXNzKEpvYlJ1bm5lciwgW3sKICAgIGtleTogInJlc2V0SW50ZXJ2YWwiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlc2V0SW50ZXJ2YWwoKSB7CiAgICAgIHRoaXMuX3JlZnJlc2hJbnRlcnZhbCA9IFJFRlJFU0hfSU5URVJWQUxfTVM7CiAgICB9CiAgfSwgewogICAga2V5OiAib3BlbkpvYiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb3BlbkpvYigpIHsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hc3luYyhmdW5jdGlvbiBvcGVuSm9iJChfY29udGV4dCkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMDsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMzsKICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKF9qb2Jfc2VydmljZS5tbEpvYlNlcnZpY2Uub3BlbkpvYih0aGlzLl9qb2JJZCkpOwoKICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA4OwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSA1OwogICAgICAgICAgICAgIF9jb250ZXh0LnQwID0gX2NvbnRleHRbImNhdGNoIl0oMCk7CiAgICAgICAgICAgICAgdGhyb3cgX2NvbnRleHQudDA7CgogICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIG51bGwsIHRoaXMsIFtbMCwgNV1dKTsKICAgIH0gLy8gc3RhcnQgdGhlIGRhdGFmZWVkIGFuZCB0aGVuIHN0YXJ0IHBvbGxpbmcgZm9yIHByb2dyZXNzCiAgICAvLyB0aGUgY29tcGxldGUgcGVyY2VudGFnZSBpcyBhZGRlZCB0byBhbiBvYnNlcnZhYmxlCiAgICAvLyBzbyBhbGwgcHJlLXN1YnNjcmliZWQgbGlzdGVuZXJzIGNhbiBmb2xsb3cgYWxvbmcuCgogIH0sIHsKICAgIGtleTogIl9zdGFydERhdGFmZWVkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfc3RhcnREYXRhZmVlZChzdGFydCwgZW5kLCBwb2xsUHJvZ3Jlc3MpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciBzdWJzY3JpcHRpb25zLCBfcmVmLCBzdGFydGVkLCBjaGVjazsKCiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXN5bmMoZnVuY3Rpb24gX3N0YXJ0RGF0YWZlZWQkKF9jb250ZXh0NCkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIF9jb250ZXh0NC5wcmV2ID0gMDsKICAgICAgICAgICAgICB0aGlzLl9kYXRhZmVlZFN0YXJ0VGltZSA9IERhdGUubm93KCk7IC8vIGxpbmsgdGhlIF9zdWJzY3JpYmVycyBsaXN0IGZyb20gdGhlIEpvYkNyZWF0b3IKICAgICAgICAgICAgICAvLyB0byB0aGUgcHJvZ3Jlc3MgQmVoYXZpb3JTdWJqZWN0LgoKICAgICAgICAgICAgICBzdWJzY3JpcHRpb25zID0gcG9sbFByb2dyZXNzID09PSB0cnVlID8gdGhpcy5fc3Vic2NyaWJlcnMubWFwKGZ1bmN0aW9uIChzKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuX3Byb2dyZXNzJC5zdWJzY3JpYmUocyk7CiAgICAgICAgICAgICAgfSkgOiBbXTsKICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDU7CiAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hd3JhcCh0aGlzLm9wZW5Kb2IoKSk7CgogICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSA3OwogICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAoX2pvYl9zZXJ2aWNlLm1sSm9iU2VydmljZS5zdGFydERhdGFmZWVkKHRoaXMuX2RhdGFmZWVkSWQsIHRoaXMuX2pvYklkLCBzdGFydCwgZW5kKSk7CgogICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgX3JlZiA9IF9jb250ZXh0NC5zZW50OwogICAgICAgICAgICAgIHN0YXJ0ZWQgPSBfcmVmLnN0YXJ0ZWQ7CiAgICAgICAgICAgICAgdGhpcy5fZGF0YWZlZWRTdGF0ZSA9IF9zdGF0ZXMuREFUQUZFRURfU1RBVEUuU1RBUlRFRDsKICAgICAgICAgICAgICB0aGlzLl9wZXJjZW50YWdlQ29tcGxldGUgPSAwOwoKICAgICAgICAgICAgICBjaGVjayA9IGZ1bmN0aW9uIGNoZWNrKCkgewogICAgICAgICAgICAgICAgdmFyIF9yZWYyLCBpc1J1bm5pbmcsIHByb2csIGlzSm9iQ2xvc2VkLCBwcm9ncmVzczsKCiAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmFzeW5jKGZ1bmN0aW9uIGNoZWNrJChfY29udGV4dDMpIHsKICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAyOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKF90aGlzLmdldFByb2dyZXNzKCkpOwoKICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgICAgICAgX3JlZjIgPSBfY29udGV4dDMuc2VudDsKICAgICAgICAgICAgICAgICAgICAgICAgaXNSdW5uaW5nID0gX3JlZjIuaXNSdW5uaW5nOwogICAgICAgICAgICAgICAgICAgICAgICBwcm9nID0gX3JlZjIucHJvZ3Jlc3M7CiAgICAgICAgICAgICAgICAgICAgICAgIGlzSm9iQ2xvc2VkID0gX3JlZjIuaXNKb2JDbG9zZWQ7IC8vIGlmIHRoZSBwcm9ncmVzcyBoYXMgcmVhY2hlZCAxMDAlIGJ1dCB0aGUgam9iIGlzIHN0aWxsIHJ1bm5pbmcsCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRpYWwgdGhlIHByb2dyZXNzIGJhY2sgdG8gOTkgdG8gYXZvaWQgYW55IHBvc3QgY3JlYXRpb24gYnV0dG9ucyBmcm9tCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFwcGVhcmluZyBhcyB0aGV5IG9ubHkgcmVseSBvbiB0aGUgcHJvZ3Jlc3MuCgogICAgICAgICAgICAgICAgICAgICAgICBwcm9ncmVzcyA9IHByb2cgPT09IDEwMCAmJiAoaXNSdW5uaW5nID09PSB0cnVlIHx8IGlzSm9iQ2xvc2VkID09PSBmYWxzZSkgPyBwcm9nIC0gMSA6IHByb2c7CgogICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5fYWRqdXN0UmVmcmVzaEludGVydmFsKHByb2dyZXNzKTsKCiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLl9wZXJjZW50YWdlQ29tcGxldGUgPSBwcm9ncmVzczsKCiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLl9wcm9ncmVzcyQubmV4dChfdGhpcy5fcGVyY2VudGFnZUNvbXBsZXRlKTsKCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoaXNSdW5uaW5nID09PSB0cnVlIHx8IGlzSm9iQ2xvc2VkID09PSBmYWxzZSkgJiYgX3RoaXMuX3N0b3BSZWZyZXNoUG9sbC5zdG9wID09PSBmYWxzZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXN5bmMoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hd3JhcChjaGVjaygpKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgIH0sIF90aGlzLl9yZWZyZXNoSW50ZXJ2YWwpOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGpvYiBoYXMgZmluaXNoZWQgcnVubmluZywgc2V0IHByb2dyZXNzIHRvIDEwMCUKICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpdCBtYXkgYmUgbG93ZXIgdGhhbiAxMDAgb24gY29tcGxldGlvbiBhcyB0aGUgcHJvZ3Jlc3MKICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpcyBjYWxjdWxhdGVkIGJhc2VkIG9uIGxhdGVzdF9yZWNvcmRfdGltZXN0YW1wIHdoaWNoIG1heSBiZSBlYXJsaWVyCiAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhhbiB0aGUgZW5kIGRhdGUgc3VwcGxpZWQgdG8gdGhlIGRhdGFmZWVkCiAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuX3Byb2dyZXNzJC5uZXh0KDEwMCk7IC8vIHVuc3Vic2NyaWJlIGV2ZXJ5b25lCgoKICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb25zLmZvckVhY2goZnVuY3Rpb24gKHMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzLnVuc3Vic2NyaWJlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9OyAvLyB3YWl0IGZvciB0aGUgZmlyc3QgY2hlY2sgdG8gcnVuIGFuZCB0aGVuIHJldHVybiBzdWNjZXNzLgogICAgICAgICAgICAgIC8vIGFsbCBzdWJzZXF1ZW50IGNoZWNrcyB3aWxsIHVwZGF0ZSB0aGUgb2JzZXJ2YWJsZQoKCiAgICAgICAgICAgICAgaWYgKCEocG9sbFByb2dyZXNzID09PSB0cnVlKSkgewogICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAxNTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAxNTsKICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKGNoZWNrKCkpOwoKICAgICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LmFicnVwdCgicmV0dXJuIiwgc3RhcnRlZCk7CgogICAgICAgICAgICBjYXNlIDE4OgogICAgICAgICAgICAgIF9jb250ZXh0NC5wcmV2ID0gMTg7CiAgICAgICAgICAgICAgX2NvbnRleHQ0LnQwID0gX2NvbnRleHQ0WyJjYXRjaCJdKDApOwogICAgICAgICAgICAgIHRocm93IF9jb250ZXh0NC50MDsKCiAgICAgICAgICAgIGNhc2UgMjE6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBudWxsLCB0aGlzLCBbWzAsIDE4XV0pOwogICAgfQogIH0sIHsKICAgIGtleTogIl9hZGp1c3RSZWZyZXNoSW50ZXJ2YWwiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9hZGp1c3RSZWZyZXNoSW50ZXJ2YWwocHJvZ3Jlc3MpIHsKICAgICAgaWYgKHRoaXMuX3BlcmZvcm1SZWZyZXNoUmF0ZUFkanVzdG1lbnQgPT09IGZhbHNlKSB7CiAgICAgICAgLy8gZm9yIHRoZSBmaXJzdCBjb3VwbGUgb2Ygc2Vjb25kcyBvZiB0aGUgam9iIHJ1bm5pbmcsIGRvbid0CiAgICAgICAgLy8gYWRqdXN0IHRoZSByZWZyZXNoIGludGVydmFsCiAgICAgICAgdmFyIHRpbWVEZWx0YU1zID0gRGF0ZS5ub3coKSAtIHRoaXMuX2RhdGFmZWVkU3RhcnRUaW1lOwoKICAgICAgICBpZiAodGltZURlbHRhTXMgPiBSRUZSRVNIX1JBVEVfQURKVVNUTUVOVF9ERUxBWV9NUykgewogICAgICAgICAgdGhpcy5fcGVyZm9ybVJlZnJlc2hSYXRlQWRqdXN0bWVudCA9IHRydWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHZhciBwcm9ncmVzc0RlbHRhID0gcHJvZ3Jlc3MgLSB0aGlzLl9wZXJjZW50YWdlQ29tcGxldGU7CgogICAgICBpZiAocHJvZ3Jlc3NEZWx0YSAhPT0gMCkgewogICAgICAgIC8vIGFkanVzdCB0aGUgcmVmcmVzaCBpbnRlcnZhbCBzbyB0aGF0IGl0IHByb2R1Y2VzIGEgY2hhbmdlIGluIHBlcmNlbnRhZ2UKICAgICAgICAvLyB0aGF0IGlzIGNsb3NlIHRvIHRoZSB0YXJnZXQKICAgICAgICB0aGlzLl9yZWZyZXNoSW50ZXJ2YWwgPSBNYXRoLmZsb29yKHRoaXMuX3JlZnJlc2hJbnRlcnZhbCAqIChUQVJHRVRfUFJPR1JFU1NfREVMVEEgLyBwcm9ncmVzc0RlbHRhKSk7IC8vIGRvbid0IGxldCB0aGUgaW50ZXJ2YWwgZmFsbCBiZWxvdyB0aGUgaW5pdGlhbCBkZWZhdWx0LgoKICAgICAgICBpZiAodGhpcy5fcmVmcmVzaEludGVydmFsIDwgUkVGUkVTSF9JTlRFUlZBTF9NUykgewogICAgICAgICAgdGhpcy5fcmVmcmVzaEludGVydmFsID0gUkVGUkVTSF9JTlRFUlZBTF9NUzsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJzdGFydERhdGFmZWVkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzdGFydERhdGFmZWVkKCkgewogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmFzeW5jKGZ1bmN0aW9uIHN0YXJ0RGF0YWZlZWQkKF9jb250ZXh0NSkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NS5wcmV2ID0gX2NvbnRleHQ1Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gMjsKICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKHRoaXMuX3N0YXJ0RGF0YWZlZWQodGhpcy5fc3RhcnQsIHRoaXMuX2VuZCwgdHJ1ZSkpOwoKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuYWJydXB0KCJyZXR1cm4iLCBfY29udGV4dDUuc2VudCk7CgogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBudWxsLCB0aGlzKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzdGFydERhdGFmZWVkSW5SZWFsVGltZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc3RhcnREYXRhZmVlZEluUmVhbFRpbWUoY29udGludWVKb2IpIHsKICAgICAgdmFyIHN0YXJ0OwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmFzeW5jKGZ1bmN0aW9uIHN0YXJ0RGF0YWZlZWRJblJlYWxUaW1lJChfY29udGV4dDYpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDYucHJldiA9IF9jb250ZXh0Ni5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAvLyBpZiBjb250aW51aW5nIGEgam9iLCBzZXQgdGhlIHN0YXJ0IHRvIGJlIHRoZSBlbmQgZGF0ZQogICAgICAgICAgICAgIHN0YXJ0ID0gY29udGludWVKb2IgPyB0aGlzLl9lbmQgOiB0aGlzLl9zdGFydDsKICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDM7CiAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hd3JhcCh0aGlzLl9zdGFydERhdGFmZWVkKHN0YXJ0LCB1bmRlZmluZWQsIGZhbHNlKSk7CgogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5hYnJ1cHQoInJldHVybiIsIF9jb250ZXh0Ni5zZW50KTsKCiAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIG51bGwsIHRoaXMpOwogICAgfQogIH0sIHsKICAgIGtleTogImdldFByb2dyZXNzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRQcm9ncmVzcygpIHsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hc3luYyhmdW5jdGlvbiBnZXRQcm9ncmVzcyQoX2NvbnRleHQ3KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ3LnByZXYgPSBfY29udGV4dDcubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSAyOwogICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAoX21sX2FwaV9zZXJ2aWNlLm1sLmpvYnMuZ2V0TG9va0JhY2tQcm9ncmVzcyh0aGlzLl9qb2JJZCwgdGhpcy5fc3RhcnQsIHRoaXMuX2VuZCkpOwoKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuYWJydXB0KCJyZXR1cm4iLCBfY29udGV4dDcuc2VudCk7CgogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBudWxsLCB0aGlzKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzdWJzY3JpYmVUb1Byb2dyZXNzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzdWJzY3JpYmVUb1Byb2dyZXNzKGZ1bmMpIHsKICAgICAgdGhpcy5fcHJvZ3Jlc3MkLnN1YnNjcmliZShmdW5jKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJpc1J1bm5pbmciLAogICAgdmFsdWU6IGZ1bmN0aW9uIGlzUnVubmluZygpIHsKICAgICAgdmFyIF9yZWYzLCBpc1J1bm5pbmc7CgogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmFzeW5jKGZ1bmN0aW9uIGlzUnVubmluZyQoX2NvbnRleHQ4KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ4LnByZXYgPSBfY29udGV4dDgubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgX2NvbnRleHQ4Lm5leHQgPSAyOwogICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAodGhpcy5nZXRQcm9ncmVzcygpKTsKCiAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICBfcmVmMyA9IF9jb250ZXh0OC5zZW50OwogICAgICAgICAgICAgIGlzUnVubmluZyA9IF9yZWYzLmlzUnVubmluZzsKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LmFicnVwdCgicmV0dXJuIiwgaXNSdW5uaW5nKTsKCiAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIG51bGwsIHRoaXMpOwogICAgfQogIH0sIHsKICAgIGtleTogImRhdGFmZWVkU3RhdGUiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9kYXRhZmVlZFN0YXRlOwogICAgfQogIH0sIHsKICAgIGtleTogInJlZnJlc2hJbnRlcnZhbCIsCiAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2KSB7CiAgICAgIHRoaXMuX3JlZnJlc2hJbnRlcnZhbCA9IHY7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gSm9iUnVubmVyOwp9KCk7CgpleHBvcnRzLkpvYlJ1bm5lciA9IEpvYlJ1bm5lcjs="},null]}