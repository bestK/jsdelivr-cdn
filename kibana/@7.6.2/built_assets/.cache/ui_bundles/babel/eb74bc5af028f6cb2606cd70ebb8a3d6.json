{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/security/public/views/management/users_grid/components/users_list_page.js","dependencies":[{"path":"x-pack/legacy/plugins/security/public/views/management/users_grid/components/users_list_page.js","mtime":1585205047276},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiKSB7IF90eXBlb2YyID0gZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mMiA9IGZ1bmN0aW9uIF90eXBlb2YyKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mMihvYmopOyB9CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuVXNlcnNMaXN0UGFnZSA9IHZvaWQgMDsKCnZhciBfcmVhY3QgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKCJyZWFjdCIpKTsKCnZhciBfZXVpID0gcmVxdWlyZSgiQGVsYXN0aWMvZXVpIik7Cgp2YXIgX25vdGlmeSA9IHJlcXVpcmUoInVpL25vdGlmeSIpOwoKdmFyIF9yZWFjdDIgPSByZXF1aXJlKCJAa2JuL2kxOG4vcmVhY3QiKTsKCnZhciBfdXNlcnMgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9jb21wb25lbnRzL21hbmFnZW1lbnQvdXNlcnMiKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgewogIGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsKICAgIHJldHVybiBvYmo7CiAgfSBlbHNlIHsKICAgIHZhciBuZXdPYmogPSB7fTsKCiAgICBpZiAob2JqICE9IG51bGwpIHsKICAgICAgZm9yICh2YXIga2V5IGluIG9iaikgewogICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7CiAgICAgICAgICB2YXIgZGVzYyA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSAmJiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID8gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIGtleSkgOiB7fTsKCiAgICAgICAgICBpZiAoZGVzYy5nZXQgfHwgZGVzYy5zZXQpIHsKICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5ld09iaiwga2V5LCBkZXNjKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG5ld09ialtrZXldID0gb2JqW2tleV07CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgbmV3T2JqLmRlZmF1bHQgPSBvYmo7CiAgICByZXR1cm4gbmV3T2JqOwogIH0KfQoKZnVuY3Rpb24gX3R5cGVvZihvYmopIHsKICBpZiAodHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBfdHlwZW9mMihTeW1ib2wuaXRlcmF0b3IpID09PSAic3ltYm9sIikgewogICAgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7CiAgICAgIHJldHVybiBfdHlwZW9mMihvYmopOwogICAgfTsKICB9IGVsc2UgewogICAgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7CiAgICAgIHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyAic3ltYm9sIiA6IF90eXBlb2YyKG9iaik7CiAgICB9OwogIH0KCiAgcmV0dXJuIF90eXBlb2Yob2JqKTsKfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgewogIGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsKICB9Cn0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsKICBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOwogICAgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOwogICAgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOwogICAgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7CiAgfQp9CgpmdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7CiAgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7CiAgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOwogIHJldHVybiBDb25zdHJ1Y3RvcjsKfQoKZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgewogIGlmIChjYWxsICYmIChfdHlwZW9mKGNhbGwpID09PSAib2JqZWN0IiB8fCB0eXBlb2YgY2FsbCA9PT0gImZ1bmN0aW9uIikpIHsKICAgIHJldHVybiBjYWxsOwogIH0KCiAgcmV0dXJuIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZik7Cn0KCmZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7CiAgX2dldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LmdldFByb3RvdHlwZU9mIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsKICAgIHJldHVybiBvLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2Yobyk7CiAgfTsKICByZXR1cm4gX2dldFByb3RvdHlwZU9mKG8pOwp9CgpmdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsKICBpZiAoc2VsZiA9PT0gdm9pZCAwKSB7CiAgICB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOwogIH0KCiAgcmV0dXJuIHNlbGY7Cn0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgewogIGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiIpOwogIH0KCiAgc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7CiAgICBjb25zdHJ1Y3RvcjogewogICAgICB2YWx1ZTogc3ViQ2xhc3MsCiAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICBjb25maWd1cmFibGU6IHRydWUKICAgIH0KICB9KTsKICBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTsKfQoKZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsKICBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsKICAgIG8uX19wcm90b19fID0gcDsKICAgIHJldHVybiBvOwogIH07CgogIHJldHVybiBfc2V0UHJvdG90eXBlT2YobywgcCk7Cn0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsKICBpZiAoa2V5IGluIG9iaikgewogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7CiAgICAgIHZhbHVlOiB2YWx1ZSwKICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICB3cml0YWJsZTogdHJ1ZQogICAgfSk7CiAgfSBlbHNlIHsKICAgIG9ialtrZXldID0gdmFsdWU7CiAgfQoKICByZXR1cm4gb2JqOwp9Cgp2YXIgVXNlcnNMaXN0UGFnZVVJID0KLyojX19QVVJFX18qLwpmdW5jdGlvbiAoX0NvbXBvbmVudCkgewogIF9pbmhlcml0cyhVc2Vyc0xpc3RQYWdlVUksIF9Db21wb25lbnQpOwoKICBmdW5jdGlvbiBVc2Vyc0xpc3RQYWdlVUkocHJvcHMpIHsKICAgIHZhciBfdGhpczsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVXNlcnNMaXN0UGFnZVVJKTsKCiAgICBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIF9nZXRQcm90b3R5cGVPZihVc2Vyc0xpc3RQYWdlVUkpLmNhbGwodGhpcywgcHJvcHMpKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJoYW5kbGVEZWxldGUiLCBmdW5jdGlvbiAodXNlcm5hbWVzLCBlcnJvcnMpIHsKICAgICAgdmFyIHVzZXJzID0gX3RoaXMuc3RhdGUudXNlcnM7CgogICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgc2VsZWN0aW9uOiBbXSwKICAgICAgICBzaG93RGVsZXRlQ29uZmlybWF0aW9uOiBmYWxzZSwKICAgICAgICB1c2VyczogdXNlcnMuZmlsdGVyKGZ1bmN0aW9uIChfcmVmKSB7CiAgICAgICAgICB2YXIgdXNlcm5hbWUgPSBfcmVmLnVzZXJuYW1lOwogICAgICAgICAgcmV0dXJuICF1c2VybmFtZXMuaW5jbHVkZXModXNlcm5hbWUpIHx8IGVycm9ycy5pbmNsdWRlcyh1c2VybmFtZSk7CiAgICAgICAgfSkKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJvbkNhbmNlbERlbGV0ZSIsIGZ1bmN0aW9uICgpIHsKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIHNob3dEZWxldGVDb25maXJtYXRpb246IGZhbHNlCiAgICAgIH0pOwogICAgfSk7CgogICAgX3RoaXMuc3RhdGUgPSB7CiAgICAgIHVzZXJzOiBbXSwKICAgICAgc2VsZWN0aW9uOiBbXSwKICAgICAgc2hvd0RlbGV0ZUNvbmZpcm1hdGlvbjogZmFsc2UsCiAgICAgIHBlcm1pc3Npb25EZW5pZWQ6IGZhbHNlLAogICAgICBmaWx0ZXI6ICcnCiAgICB9OwogICAgcmV0dXJuIF90aGlzOwogIH0KCiAgX2NyZWF0ZUNsYXNzKFVzZXJzTGlzdFBhZ2VVSSwgW3sKICAgIGtleTogImNvbXBvbmVudERpZE1vdW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnREaWRNb3VudCgpIHsKICAgICAgdGhpcy5sb2FkVXNlcnMoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB2YXIgX3RoaXMkc3RhdGUgPSB0aGlzLnN0YXRlLAogICAgICAgICAgdXNlcnMgPSBfdGhpcyRzdGF0ZS51c2VycywKICAgICAgICAgIGZpbHRlciA9IF90aGlzJHN0YXRlLmZpbHRlciwKICAgICAgICAgIHBlcm1pc3Npb25EZW5pZWQgPSBfdGhpcyRzdGF0ZS5wZXJtaXNzaW9uRGVuaWVkLAogICAgICAgICAgc2hvd0RlbGV0ZUNvbmZpcm1hdGlvbiA9IF90aGlzJHN0YXRlLnNob3dEZWxldGVDb25maXJtYXRpb24sCiAgICAgICAgICBzZWxlY3Rpb24gPSBfdGhpcyRzdGF0ZS5zZWxlY3Rpb247CiAgICAgIHZhciBpbnRsID0gdGhpcy5wcm9wcy5pbnRsOwoKICAgICAgaWYgKHBlcm1pc3Npb25EZW5pZWQpIHsKICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhHcm91cCwgewogICAgICAgICAgZ3V0dGVyU2l6ZTogIm5vbmUiCiAgICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVBhZ2VDb250ZW50LCB7CiAgICAgICAgICBob3Jpem9udGFsUG9zaXRpb246ICJjZW50ZXIiCiAgICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUVtcHR5UHJvbXB0LCB7CiAgICAgICAgICBpY29uVHlwZTogInNlY3VyaXR5QXBwIiwKICAgICAgICAgIHRpdGxlOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJoMSIsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICAgIGlkOiAieHBhY2suc2VjdXJpdHkubWFuYWdlbWVudC51c2Vycy5kZW5pZWRQZXJtaXNzaW9uVGl0bGUiLAogICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIllvdSBuZWVkIHBlcm1pc3Npb24gdG8gbWFuYWdlIHVzZXJzIgogICAgICAgICAgfSkpLAogICAgICAgICAgYm9keTogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgicCIsIHsKICAgICAgICAgICAgImRhdGEtdGVzdC1zdWJqIjogInBlcm1pc3Npb25EZW5pZWRNZXNzYWdlIgogICAgICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICAgICAgaWQ6ICJ4cGFjay5zZWN1cml0eS5tYW5hZ2VtZW50LnVzZXJzLnBlcm1pc3Npb25EZW5pZWRUb01hbmFnZVVzZXJzRGVzY3JpcHRpb24iLAogICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkNvbnRhY3QgeW91ciBzeXN0ZW0gYWRtaW5pc3RyYXRvci4iCiAgICAgICAgICB9KSkKICAgICAgICB9KSkpOwogICAgICB9CgogICAgICB2YXIgcGF0aCA9ICcjL21hbmFnZW1lbnQvc2VjdXJpdHkvJzsKICAgICAgdmFyIGNvbHVtbnMgPSBbewogICAgICAgIGZpZWxkOiAnZnVsbF9uYW1lJywKICAgICAgICBuYW1lOiBpbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgaWQ6ICd4cGFjay5zZWN1cml0eS5tYW5hZ2VtZW50LnVzZXJzLmZ1bGxOYW1lQ29sdW1uTmFtZScsCiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0Z1bGwgTmFtZScKICAgICAgICB9KSwKICAgICAgICBzb3J0YWJsZTogdHJ1ZSwKICAgICAgICB0cnVuY2F0ZVRleHQ6IHRydWUsCiAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoZnVsbE5hbWUpIHsKICAgICAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJ1c2VyUm93RnVsbE5hbWUiCiAgICAgICAgICB9LCBmdWxsTmFtZSk7CiAgICAgICAgfQogICAgICB9LCB7CiAgICAgICAgZmllbGQ6ICd1c2VybmFtZScsCiAgICAgICAgbmFtZTogaW50bC5mb3JtYXRNZXNzYWdlKHsKICAgICAgICAgIGlkOiAneHBhY2suc2VjdXJpdHkubWFuYWdlbWVudC51c2Vycy51c2VyTmFtZUNvbHVtbk5hbWUnLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdVc2VyIE5hbWUnCiAgICAgICAgfSksCiAgICAgICAgc29ydGFibGU6IHRydWUsCiAgICAgICAgdHJ1bmNhdGVUZXh0OiB0cnVlLAogICAgICAgIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKHVzZXJuYW1lKSB7CiAgICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUxpbmssIHsKICAgICAgICAgICAgImRhdGEtdGVzdC1zdWJqIjogInVzZXJSb3dVc2VyTmFtZSIsCiAgICAgICAgICAgIGhyZWY6ICIiLmNvbmNhdChwYXRoLCAidXNlcnMvZWRpdC8iKS5jb25jYXQodXNlcm5hbWUpCiAgICAgICAgICB9LCB1c2VybmFtZSk7CiAgICAgICAgfQogICAgICB9LCB7CiAgICAgICAgZmllbGQ6ICdlbWFpbCcsCiAgICAgICAgbmFtZTogaW50bC5mb3JtYXRNZXNzYWdlKHsKICAgICAgICAgIGlkOiAneHBhY2suc2VjdXJpdHkubWFuYWdlbWVudC51c2Vycy5lbWFpbEFkZHJlc3NDb2x1bW5OYW1lJywKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnRW1haWwgQWRkcmVzcycKICAgICAgICB9KSwKICAgICAgICBzb3J0YWJsZTogdHJ1ZSwKICAgICAgICB0cnVuY2F0ZVRleHQ6IHRydWUsCiAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoZW1haWwpIHsKICAgICAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJ1c2VyUm93RW1haWwiCiAgICAgICAgICB9LCBlbWFpbCk7CiAgICAgICAgfQogICAgICB9LCB7CiAgICAgICAgZmllbGQ6ICdyb2xlcycsCiAgICAgICAgbmFtZTogaW50bC5mb3JtYXRNZXNzYWdlKHsKICAgICAgICAgIGlkOiAneHBhY2suc2VjdXJpdHkubWFuYWdlbWVudC51c2Vycy5yb2xlc0NvbHVtbk5hbWUnLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdSb2xlcycKICAgICAgICB9KSwKICAgICAgICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcihyb2xlbmFtZXMpIHsKICAgICAgICAgIHZhciByb2xlTGlua3MgPSByb2xlbmFtZXMubWFwKGZ1bmN0aW9uIChyb2xlbmFtZSwgaW5kZXgpIHsKICAgICAgICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LkZyYWdtZW50LCB7CiAgICAgICAgICAgICAga2V5OiByb2xlbmFtZQogICAgICAgICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpTGluaywgewogICAgICAgICAgICAgIGhyZWY6ICIiLmNvbmNhdChwYXRoLCAicm9sZXMvZWRpdC8iKS5jb25jYXQocm9sZW5hbWUpCiAgICAgICAgICAgIH0sIHJvbGVuYW1lKSwgaW5kZXggPT09IHJvbGVuYW1lcy5sZW5ndGggLSAxID8gbnVsbCA6ICcsICcpOwogICAgICAgICAgfSk7CiAgICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiAidXNlclJvd1JvbGVzIgogICAgICAgICAgfSwgcm9sZUxpbmtzKTsKICAgICAgICB9CiAgICAgIH0sIHsKICAgICAgICBmaWVsZDogJ21ldGFkYXRhJywKICAgICAgICBuYW1lOiBpbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgaWQ6ICd4cGFjay5zZWN1cml0eS5tYW5hZ2VtZW50LnVzZXJzLnJlc2VydmVkQ29sdW1uTmFtZScsCiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1Jlc2VydmVkJwogICAgICAgIH0pLAogICAgICAgIHNvcnRhYmxlOiBmdW5jdGlvbiBzb3J0YWJsZShfcmVmMikgewogICAgICAgICAgdmFyIG1ldGFkYXRhID0gX3JlZjIubWV0YWRhdGE7CiAgICAgICAgICByZXR1cm4gQm9vbGVhbihtZXRhZGF0YSAmJiBtZXRhZGF0YS5fcmVzZXJ2ZWQpOwogICAgICAgIH0sCiAgICAgICAgd2lkdGg6ICcxMDBweCcsCiAgICAgICAgYWxpZ246ICdyaWdodCcsCiAgICAgICAgZGVzY3JpcHRpb246IGludGwuZm9ybWF0TWVzc2FnZSh7CiAgICAgICAgICBpZDogJ3hwYWNrLnNlY3VyaXR5Lm1hbmFnZW1lbnQudXNlcnMucmVzZXJ2ZWRDb2x1bW5EZXNjcmlwdGlvbicsCiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1Jlc2VydmVkIHVzZXJzIGFyZSBidWlsdC1pbiBhbmQgY2Fubm90IGJlIHJlbW92ZWQuIE9ubHkgdGhlIHBhc3N3b3JkIGNhbiBiZSBjaGFuZ2VkLicKICAgICAgICB9KSwKICAgICAgICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcihtZXRhZGF0YSkgewogICAgICAgICAgcmV0dXJuIG1ldGFkYXRhICYmIG1ldGFkYXRhLl9yZXNlcnZlZCA/IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlJY29uLCB7CiAgICAgICAgICAgICJhcmlhLWxhYmVsIjogIlJlc2VydmVkIHVzZXIiLAogICAgICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiAicmVzZXJ2ZWRVc2VyIiwKICAgICAgICAgICAgdHlwZTogImNoZWNrIgogICAgICAgICAgfSkgOiBudWxsOwogICAgICAgIH0KICAgICAgfV07CiAgICAgIHZhciBwYWdpbmF0aW9uID0gewogICAgICAgIGluaXRpYWxQYWdlU2l6ZTogMjAsCiAgICAgICAgcGFnZVNpemVPcHRpb25zOiBbMTAsIDIwLCA1MCwgMTAwXQogICAgICB9OwogICAgICB2YXIgc2VsZWN0aW9uQ29uZmlnID0gewogICAgICAgIGl0ZW1JZDogJ3VzZXJuYW1lJywKICAgICAgICBzZWxlY3RhYmxlOiBmdW5jdGlvbiBzZWxlY3RhYmxlKHVzZXIpIHsKICAgICAgICAgIHJldHVybiAhKHVzZXIubWV0YWRhdGEgJiYgdXNlci5tZXRhZGF0YS5fcmVzZXJ2ZWQpOwogICAgICAgIH0sCiAgICAgICAgc2VsZWN0YWJsZU1lc3NhZ2U6IGZ1bmN0aW9uIHNlbGVjdGFibGVNZXNzYWdlKHNlbGVjdGFibGUpIHsKICAgICAgICAgIHJldHVybiAhc2VsZWN0YWJsZSA/ICdVc2VyIGlzIGEgc3lzdGVtIHVzZXInIDogJyc7CiAgICAgICAgfSwKICAgICAgICBvblNlbGVjdGlvbkNoYW5nZTogZnVuY3Rpb24gb25TZWxlY3Rpb25DaGFuZ2UodXBkYXRlZFNlbGVjdGlvbikgewogICAgICAgICAgcmV0dXJuIF90aGlzMi5zZXRTdGF0ZSh7CiAgICAgICAgICAgIHNlbGVjdGlvbjogdXBkYXRlZFNlbGVjdGlvbgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICB2YXIgc2VhcmNoID0gewogICAgICAgIHRvb2xzTGVmdDogdGhpcy5yZW5kZXJUb29sc0xlZnQoKSwKICAgICAgICBib3g6IHsKICAgICAgICAgIGluY3JlbWVudGFsOiB0cnVlCiAgICAgICAgfSwKICAgICAgICBvbkNoYW5nZTogZnVuY3Rpb24gb25DaGFuZ2UocXVlcnkpIHsKICAgICAgICAgIF90aGlzMi5zZXRTdGF0ZSh7CiAgICAgICAgICAgIGZpbHRlcjogcXVlcnkucXVlcnlUZXh0CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIHZhciBzb3J0aW5nID0gewogICAgICAgIHNvcnQ6IHsKICAgICAgICAgIGZpZWxkOiAnZnVsbF9uYW1lJywKICAgICAgICAgIGRpcmVjdGlvbjogJ2FzYycKICAgICAgICB9CiAgICAgIH07CgogICAgICB2YXIgcm93UHJvcHMgPSBmdW5jdGlvbiByb3dQcm9wcygpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgJ2RhdGEtdGVzdC1zdWJqJzogJ3VzZXJSb3cnCiAgICAgICAgfTsKICAgICAgfTsKCiAgICAgIHZhciB1c2Vyc1RvU2hvdyA9IGZpbHRlciA/IHVzZXJzLmZpbHRlcihmdW5jdGlvbiAoX3JlZjMpIHsKICAgICAgICB2YXIgdXNlcm5hbWUgPSBfcmVmMy51c2VybmFtZSwKICAgICAgICAgICAgcm9sZXMgPSBfcmVmMy5yb2xlcywKICAgICAgICAgICAgX3JlZjMkZnVsbF9uYW1lID0gX3JlZjMuZnVsbF9uYW1lLAogICAgICAgICAgICBmdWxsTmFtZSA9IF9yZWYzJGZ1bGxfbmFtZSA9PT0gdm9pZCAwID8gJycgOiBfcmVmMyRmdWxsX25hbWUsCiAgICAgICAgICAgIF9yZWYzJGVtYWlsID0gX3JlZjMuZW1haWwsCiAgICAgICAgICAgIGVtYWlsID0gX3JlZjMkZW1haWwgPT09IHZvaWQgMCA/ICcnIDogX3JlZjMkZW1haWw7CiAgICAgICAgdmFyIG5vcm1hbGl6ZWQgPSAiIi5jb25jYXQodXNlcm5hbWUsICIgIikuY29uY2F0KHJvbGVzLmpvaW4oJyAnKSwgIiAiKS5jb25jYXQoZnVsbE5hbWUsICIgIikuY29uY2F0KGVtYWlsKS50b0xvd2VyQ2FzZSgpOwogICAgICAgIHZhciBub3JtYWxpemVkUXVlcnkgPSBmaWx0ZXIudG9Mb3dlckNhc2UoKTsKICAgICAgICByZXR1cm4gbm9ybWFsaXplZC5pbmRleE9mKG5vcm1hbGl6ZWRRdWVyeSkgIT09IC0xOwogICAgICB9KSA6IHVzZXJzOwogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgIGNsYXNzTmFtZTogInNlY1VzZXJzTGlzdGluZ1BhZ2UiCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlQYWdlQ29udGVudCwgewogICAgICAgIGNsYXNzTmFtZTogInNlY1VzZXJzTGlzdGluZ1BhZ2VfX2NvbnRlbnQiCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlQYWdlQ29udGVudEhlYWRlciwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVBhZ2VDb250ZW50SGVhZGVyU2VjdGlvbiwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRpdGxlLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJoMSIsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJ4cGFjay5zZWN1cml0eS5tYW5hZ2VtZW50LnVzZXJzLnVzZXJzVGl0bGUiLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiVXNlcnMiCiAgICAgIH0pKSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpUGFnZUNvbnRlbnRIZWFkZXJTZWN0aW9uLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQnV0dG9uLCB7CiAgICAgICAgImRhdGEtdGVzdC1zdWJqIjogImNyZWF0ZVVzZXJCdXR0b24iLAogICAgICAgIGhyZWY6ICIjL21hbmFnZW1lbnQvc2VjdXJpdHkvdXNlcnMvZWRpdCIKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogInhwYWNrLnNlY3VyaXR5Lm1hbmFnZW1lbnQudXNlcnMuY3JlYXRlTmV3VXNlckJ1dHRvbkxhYmVsIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkNyZWF0ZSB1c2VyIgogICAgICB9KSkpKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVBhZ2VDb250ZW50Qm9keSwgbnVsbCwgc2hvd0RlbGV0ZUNvbmZpcm1hdGlvbiA/IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3VzZXJzLkNvbmZpcm1EZWxldGVVc2VycywgewogICAgICAgIG9uQ2FuY2VsOiB0aGlzLm9uQ2FuY2VsRGVsZXRlLAogICAgICAgIHVzZXJzVG9EZWxldGU6IHNlbGVjdGlvbi5tYXAoZnVuY3Rpb24gKHVzZXIpIHsKICAgICAgICAgIHJldHVybiB1c2VyLnVzZXJuYW1lOwogICAgICAgIH0pLAogICAgICAgIGNhbGxiYWNrOiB0aGlzLmhhbmRsZURlbGV0ZSwKICAgICAgICBhcGlDbGllbnQ6IHRoaXMucHJvcHMuYXBpQ2xpZW50CiAgICAgIH0pIDogbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUluTWVtb3J5VGFibGUsIHsKICAgICAgICBpdGVtSWQ6ICJ1c2VybmFtZSIsCiAgICAgICAgY29sdW1uczogY29sdW1ucywKICAgICAgICBzZWxlY3Rpb246IHNlbGVjdGlvbkNvbmZpZywKICAgICAgICBwYWdpbmF0aW9uOiBwYWdpbmF0aW9uLAogICAgICAgIGl0ZW1zOiB1c2Vyc1RvU2hvdywKICAgICAgICBsb2FkaW5nOiB1c2Vycy5sZW5ndGggPT09IDAsCiAgICAgICAgc2VhcmNoOiBzZWFyY2gsCiAgICAgICAgc29ydGluZzogc29ydGluZywKICAgICAgICByb3dQcm9wczogcm93UHJvcHMsCiAgICAgICAgaXNTZWxlY3RhYmxlOiB0cnVlCiAgICAgIH0pKSkpOwogICAgfQogIH0sIHsKICAgIGtleTogImxvYWRVc2VycyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbG9hZFVzZXJzKCkgewogICAgICB2YXIgdXNlcnM7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXN5bmMoZnVuY3Rpb24gbG9hZFVzZXJzJChfY29udGV4dCkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMDsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMzsKICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKHRoaXMucHJvcHMuYXBpQ2xpZW50LmdldFVzZXJzKCkpOwoKICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgIHVzZXJzID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgIHVzZXJzOiB1c2VycwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMDsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gNzsKICAgICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDApOwoKICAgICAgICAgICAgICBpZiAoX2NvbnRleHQudDAuYm9keS5zdGF0dXNDb2RlID09PSA0MDMpIHsKICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgICBwZXJtaXNzaW9uRGVuaWVkOiB0cnVlCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgX25vdGlmeS50b2FzdE5vdGlmaWNhdGlvbnMuYWRkRGFuZ2VyKHRoaXMucHJvcHMuaW50bC5mb3JtYXRNZXNzYWdlKHsKICAgICAgICAgICAgICAgICAgaWQ6ICd4cGFjay5zZWN1cml0eS5tYW5hZ2VtZW50LnVzZXJzLmZldGNoaW5nVXNlcnNFcnJvck1lc3NhZ2UnLAogICAgICAgICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0Vycm9yIGZldGNoaW5nIHVzZXJzOiB7bWVzc2FnZX0nCiAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IF9jb250ZXh0LnQwLmJvZHkubWVzc2FnZQogICAgICAgICAgICAgICAgfSkpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIG51bGwsIHRoaXMsIFtbMCwgN11dKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXJUb29sc0xlZnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlclRvb2xzTGVmdCgpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICB2YXIgc2VsZWN0aW9uID0gdGhpcy5zdGF0ZS5zZWxlY3Rpb247CgogICAgICBpZiAoc2VsZWN0aW9uLmxlbmd0aCA9PT0gMCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIG51bVNlbGVjdGVkID0gc2VsZWN0aW9uLmxlbmd0aDsKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlCdXR0b24sIHsKICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiAiZGVsZXRlVXNlckJ1dHRvbiIsCiAgICAgICAgY29sb3I6ICJkYW5nZXIiLAogICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXMzLnNldFN0YXRlKHsKICAgICAgICAgICAgc2hvd0RlbGV0ZUNvbmZpcm1hdGlvbjogdHJ1ZQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAieHBhY2suc2VjdXJpdHkubWFuYWdlbWVudC51c2Vycy5kZWxldGVVc2Vyc0J1dHRvbkxhYmVsIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkRlbGV0ZSB7bnVtU2VsZWN0ZWR9IHVzZXJ7bnVtU2VsZWN0ZWQsIHBsdXJhbCwgb25lIHsgfSBvdGhlciB7c319IiwKICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgIG51bVNlbGVjdGVkOiBudW1TZWxlY3RlZAogICAgICAgIH0KICAgICAgfSkpOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIFVzZXJzTGlzdFBhZ2VVSTsKfShfcmVhY3QuQ29tcG9uZW50KTsKCnZhciBVc2Vyc0xpc3RQYWdlID0gKDAsIF9yZWFjdDIuaW5qZWN0STE4bikoVXNlcnNMaXN0UGFnZVVJKTsKZXhwb3J0cy5Vc2Vyc0xpc3RQYWdlID0gVXNlcnNMaXN0UGFnZTs="},null]}