{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/ml/public/application/explorer/explorer.js","dependencies":[{"path":"x-pack/legacy/plugins/ml/public/application/explorer/explorer.js","mtime":1585205045692},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkV4cGxvcmVyID0gdm9pZCAwOwoKdmFyIF9wcm9wVHlwZXMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoInByb3AtdHlwZXMiKSk7Cgp2YXIgX3JlYWN0ID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgicmVhY3QiKSk7Cgp2YXIgX2kxOG4gPSByZXF1aXJlKCJAa2JuL2kxOG4iKTsKCnZhciBfcmVhY3QyID0gcmVxdWlyZSgiQGtibi9pMThuL3JlYWN0Iik7Cgp2YXIgX2RzTWluID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJkcmFnc2VsZWN0L2Rpc3QvZHMubWluLmpzIikpOwoKdmFyIF9yeGpzID0gcmVxdWlyZSgicnhqcyIpOwoKdmFyIF9vcGVyYXRvcnMgPSByZXF1aXJlKCJyeGpzL29wZXJhdG9ycyIpOwoKdmFyIF9ldWkgPSByZXF1aXJlKCJAZWxhc3RpYy9ldWkiKTsKCnZhciBfYW5ub3RhdGlvbl9mbHlvdXQgPSByZXF1aXJlKCIuLi9jb21wb25lbnRzL2Fubm90YXRpb25zL2Fubm90YXRpb25fZmx5b3V0Iik7Cgp2YXIgX2Fubm90YXRpb25zX3RhYmxlID0gcmVxdWlyZSgiLi4vY29tcG9uZW50cy9hbm5vdGF0aW9ucy9hbm5vdGF0aW9uc190YWJsZSIpOwoKdmFyIF9jb21wb25lbnRzID0gcmVxdWlyZSgiLi9jb21wb25lbnRzIik7Cgp2YXIgX2NoYXJ0X3Rvb2x0aXAgPSByZXF1aXJlKCIuLi9jb21wb25lbnRzL2NoYXJ0X3Rvb2x0aXAiKTsKCnZhciBfZXhwbG9yZXJfc3dpbWxhbmUgPSByZXF1aXJlKCIuL2V4cGxvcmVyX3N3aW1sYW5lIik7Cgp2YXIgX2txbF9maWx0ZXJfYmFyID0gcmVxdWlyZSgiLi4vY29tcG9uZW50cy9rcWxfZmlsdGVyX2JhciIpOwoKdmFyIF90aW1lX2J1Y2tldHMgPSByZXF1aXJlKCIuLi91dGlsL3RpbWVfYnVja2V0cyIpOwoKdmFyIF9pbmZsdWVuY2Vyc19saXN0ID0gcmVxdWlyZSgiLi4vY29tcG9uZW50cy9pbmZsdWVuY2Vyc19saXN0Iik7Cgp2YXIgX2V4cGxvcmVyX2Rhc2hib2FyZF9zZXJ2aWNlID0gcmVxdWlyZSgiLi9leHBsb3Jlcl9kYXNoYm9hcmRfc2VydmljZSIpOwoKdmFyIF9sb2FkaW5nX2luZGljYXRvciA9IHJlcXVpcmUoIi4uL2NvbXBvbmVudHMvbG9hZGluZ19pbmRpY2F0b3IvbG9hZGluZ19pbmRpY2F0b3IiKTsKCnZhciBfbmF2aWdhdGlvbl9tZW51ID0gcmVxdWlyZSgiLi4vY29tcG9uZW50cy9uYXZpZ2F0aW9uX21lbnUiKTsKCnZhciBfY2hlY2tib3hfc2hvd2NoYXJ0cyA9IHJlcXVpcmUoIi4uL2NvbXBvbmVudHMvY29udHJvbHMvY2hlY2tib3hfc2hvd2NoYXJ0cyIpOwoKdmFyIF9qb2Jfc2VsZWN0b3IgPSByZXF1aXJlKCIuLi9jb21wb25lbnRzL2pvYl9zZWxlY3RvciIpOwoKdmFyIF9zZWxlY3RfaW50ZXJ2YWwgPSByZXF1aXJlKCIuLi9jb21wb25lbnRzL2NvbnRyb2xzL3NlbGVjdF9pbnRlcnZhbC9zZWxlY3RfaW50ZXJ2YWwiKTsKCnZhciBfc2VsZWN0X2xpbWl0ID0gcmVxdWlyZSgiLi9zZWxlY3RfbGltaXQvc2VsZWN0X2xpbWl0Iik7Cgp2YXIgX3NlbGVjdF9zZXZlcml0eSA9IHJlcXVpcmUoIi4uL2NvbXBvbmVudHMvY29udHJvbHMvc2VsZWN0X3NldmVyaXR5L3NlbGVjdF9zZXZlcml0eSIpOwoKdmFyIF91dGlscyA9IHJlcXVpcmUoIi4uL2NvbXBvbmVudHMva3FsX2ZpbHRlcl9iYXIvdXRpbHMiKTsKCnZhciBfZXhwbG9yZXJfdXRpbHMgPSByZXF1aXJlKCIuL2V4cGxvcmVyX3V0aWxzIik7Cgp2YXIgX2xlZ2FjeV91dGlscyA9IHJlcXVpcmUoIi4vbGVnYWN5X3V0aWxzIik7Cgp2YXIgX2V4cGxvcmVyX2NvbnN0YW50cyA9IHJlcXVpcmUoIi4vZXhwbG9yZXJfY29uc3RhbnRzIik7Cgp2YXIgX2V4cGxvcmVyX2NoYXJ0c19jb250YWluZXIgPSByZXF1aXJlKCIuL2V4cGxvcmVyX2NoYXJ0cy9leHBsb3Jlcl9jaGFydHNfY29udGFpbmVyIik7Cgp2YXIgX2Fub21hbGllc190YWJsZSA9IHJlcXVpcmUoIi4uL2NvbXBvbmVudHMvYW5vbWFsaWVzX3RhYmxlL2Fub21hbGllc190YWJsZSIpOwoKdmFyIF9wdWJsaWMgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi8uLi8uLi8uLi9zcmMvcGx1Z2lucy9raWJhbmFfdXRpbHMvcHVibGljIik7Cgp2YXIgX3RpbWVmaWx0ZXIgPSByZXF1aXJlKCJ1aS90aW1lZmlsdGVyIik7Cgp2YXIgX25vdGlmeSA9IHJlcXVpcmUoInVpL25vdGlmeSIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7IGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsgcmV0dXJuIG9iajsgfSBlbHNlIHsgdmFyIG5ld09iaiA9IHt9OyBpZiAob2JqICE9IG51bGwpIHsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgeyB2YXIgZGVzYyA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSAmJiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID8gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIGtleSkgOiB7fTsgaWYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmosIGtleSwgZGVzYyk7IH0gZWxzZSB7IG5ld09ialtrZXldID0gb2JqW2tleV07IH0gfSB9IH0gbmV3T2JqLmRlZmF1bHQgPSBvYmo7IHJldHVybiBuZXdPYmo7IH0gfQoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiKSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfTsgfSBlbHNlIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyAic3ltYm9sIiA6IHR5cGVvZiBvYmo7IH07IH0gcmV0dXJuIF90eXBlb2Yob2JqKTsgfQoKZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7IHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7IGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7IH0pOyBrZXlzLnB1c2guYXBwbHkoa2V5cywgc3ltYm9scyk7IH0gcmV0dXJuIGtleXM7IH0KCmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7IGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OyBpZiAoaSAlIDIpIHsgb3duS2V5cyhzb3VyY2UsIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsgfSk7IH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsgfSBlbHNlIHsgb3duS2V5cyhzb3VyY2UpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsgfSk7IH0gfSByZXR1cm4gdGFyZ2V0OyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9CgpmdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfQoKZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpKSB7IHJldHVybiBjYWxsOyB9IHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOyB9CgpmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyBfZ2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3QuZ2V0UHJvdG90eXBlT2YgOiBmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyByZXR1cm4gby5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKG8pOyB9OyByZXR1cm4gX2dldFByb3RvdHlwZU9mKG8pOyB9CgpmdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsgaWYgKHNlbGYgPT09IHZvaWQgMCkgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOyB9IHJldHVybiBzZWxmOyB9CgpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAiZnVuY3Rpb24iICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24iKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBfc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpOyB9CgpmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgby5fX3Byb3RvX18gPSBwOyByZXR1cm4gbzsgfTsgcmV0dXJuIF9zZXRQcm90b3R5cGVPZihvLCBwKTsgfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgeyBpZiAoa2V5IGluIG9iaikgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsgdmFsdWU6IHZhbHVlLCBlbnVtZXJhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlIH0pOyB9IGVsc2UgeyBvYmpba2V5XSA9IHZhbHVlOyB9IHJldHVybiBvYmo7IH0KCmZ1bmN0aW9uIG1hcFN3aW1sYW5lT3B0aW9uc1RvRXVpT3B0aW9ucyhvcHRpb25zKSB7CiAgcmV0dXJuIG9wdGlvbnMubWFwKGZ1bmN0aW9uIChvcHRpb24pIHsKICAgIHJldHVybiB7CiAgICAgIHZhbHVlOiBvcHRpb24sCiAgICAgIHRleHQ6IG9wdGlvbgogICAgfTsKICB9KTsKfQoKdmFyIEV4cGxvcmVyUGFnZSA9IGZ1bmN0aW9uIEV4cGxvcmVyUGFnZShfcmVmKSB7CiAgdmFyIGNoaWxkcmVuID0gX3JlZi5jaGlsZHJlbiwKICAgICAgam9iU2VsZWN0b3JQcm9wcyA9IF9yZWYuam9iU2VsZWN0b3JQcm9wcywKICAgICAgcmVzaXplUmVmID0gX3JlZi5yZXNpemVSZWY7CiAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgIHJlZjogcmVzaXplUmVmLAogICAgImRhdGEtdGVzdC1zdWJqIjogIm1sUGFnZUFub21hbHlFeHBsb3JlciIKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9uYXZpZ2F0aW9uX21lbnUuTmF2aWdhdGlvbk1lbnUsIHsKICAgIHRhYklkOiAiZXhwbG9yZXIiCiAgfSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2pvYl9zZWxlY3Rvci5Kb2JTZWxlY3Rvciwgam9iU2VsZWN0b3JQcm9wcyksIGNoaWxkcmVuKTsKfTsKCnZhciBFeHBsb3JlciA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKF9SZWFjdCRDb21wb25lbnQpIHsKICBfaW5oZXJpdHMoRXhwbG9yZXIsIF9SZWFjdCRDb21wb25lbnQpOwoKICBmdW5jdGlvbiBFeHBsb3JlcigpIHsKICAgIHZhciBfZ2V0UHJvdG90eXBlT2YyOwoKICAgIHZhciBfdGhpczsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRXhwbG9yZXIpOwoKICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykgewogICAgICBhcmdzW19rZXldID0gYXJndW1lbnRzW19rZXldOwogICAgfQoKICAgIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKF9nZXRQcm90b3R5cGVPZjIgPSBfZ2V0UHJvdG90eXBlT2YoRXhwbG9yZXIpKS5jYWxsLmFwcGx5KF9nZXRQcm90b3R5cGVPZjIsIFt0aGlzXS5jb25jYXQoYXJncykpKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJfdW5zdWJzY3JpYmVBbGwiLCBuZXcgX3J4anMuU3ViamVjdCgpKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJkaXNhYmxlRHJhZ1NlbGVjdE9uTW91c2VMZWF2ZSIsIHRydWUpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImRyYWdTZWxlY3QiLCBuZXcgX2RzTWluLmRlZmF1bHQoewogICAgICBzZWxlY3RhYmxlczogZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnc2wtY2VsbCcpLAogICAgICBjYWxsYmFjazogZnVuY3Rpb24gY2FsbGJhY2soZWxlbWVudHMpIHsKICAgICAgICBpZiAoZWxlbWVudHMubGVuZ3RoID4gMSAmJiAhX2V4cGxvcmVyX2Rhc2hib2FyZF9zZXJ2aWNlLkFMTE9XX0NFTExfUkFOR0VfU0VMRUNUSU9OKSB7CiAgICAgICAgICBlbGVtZW50cyA9IFtlbGVtZW50c1swXV07CiAgICAgICAgfQoKICAgICAgICBpZiAoZWxlbWVudHMubGVuZ3RoID4gMCkgewogICAgICAgICAgX2V4cGxvcmVyX2Rhc2hib2FyZF9zZXJ2aWNlLmRyYWdTZWxlY3QkLm5leHQoewogICAgICAgICAgICBhY3Rpb246IF9leHBsb3Jlcl9jb25zdGFudHMuRFJBR19TRUxFQ1RfQUNUSU9OLk5FV19TRUxFQ1RJT04sCiAgICAgICAgICAgIGVsZW1lbnRzOiBlbGVtZW50cwogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICB0aGlzLmRpc2FibGVEcmFnU2VsZWN0T25Nb3VzZUxlYXZlID0gdHJ1ZTsKICAgICAgfSwKICAgICAgb25EcmFnU3RhcnQ6IGZ1bmN0aW9uIG9uRHJhZ1N0YXJ0KGUpIHsKICAgICAgICB2YXIgdGFyZ2V0ID0gZS50YXJnZXQ7CgogICAgICAgIHdoaWxlICh0YXJnZXQgJiYgdGFyZ2V0ICE9PSBkb2N1bWVudC5ib2R5ICYmICF0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdzbC1jZWxsJykpIHsKICAgICAgICAgIHRhcmdldCA9IHRhcmdldC5wYXJlbnROb2RlOwogICAgICAgIH0KCiAgICAgICAgaWYgKF9leHBsb3Jlcl9kYXNoYm9hcmRfc2VydmljZS5BTExPV19DRUxMX1JBTkdFX1NFTEVDVElPTiAmJiB0YXJnZXQgIT09IGRvY3VtZW50LmJvZHkpIHsKICAgICAgICAgIF9leHBsb3Jlcl9kYXNoYm9hcmRfc2VydmljZS5kcmFnU2VsZWN0JC5uZXh0KHsKICAgICAgICAgICAgYWN0aW9uOiBfZXhwbG9yZXJfY29uc3RhbnRzLkRSQUdfU0VMRUNUX0FDVElPTi5EUkFHX1NUQVJUCiAgICAgICAgICB9KTsKCiAgICAgICAgICB0aGlzLmRpc2FibGVEcmFnU2VsZWN0T25Nb3VzZUxlYXZlID0gZmFsc2U7CiAgICAgICAgfQogICAgICB9LAogICAgICBvbkVsZW1lbnRTZWxlY3Q6IGZ1bmN0aW9uIG9uRWxlbWVudFNlbGVjdCgpIHsKICAgICAgICBpZiAoX2V4cGxvcmVyX2Rhc2hib2FyZF9zZXJ2aWNlLkFMTE9XX0NFTExfUkFOR0VfU0VMRUNUSU9OKSB7CiAgICAgICAgICBfZXhwbG9yZXJfZGFzaGJvYXJkX3NlcnZpY2UuZHJhZ1NlbGVjdCQubmV4dCh7CiAgICAgICAgICAgIGFjdGlvbjogX2V4cGxvcmVyX2NvbnN0YW50cy5EUkFHX1NFTEVDVF9BQ1RJT04uRUxFTUVOVF9TRUxFQ1QKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQogICAgfSkpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInN3aW1sYW5lUmVuZGVyRG9uZUxpc3RlbmVyIiwgZnVuY3Rpb24gKCkgewogICAgICBfdGhpcy5kcmFnU2VsZWN0LmNsZWFyU2VsZWN0aW9uKCk7CgogICAgICBfdGhpcy5kcmFnU2VsZWN0LnNldFNlbGVjdGFibGVzKGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3NsLWNlbGwnKSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJyZXNpemVSZWYiLCAoMCwgX3JlYWN0LmNyZWF0ZVJlZikoKSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAicmVzaXplQ2hlY2tlciIsIHVuZGVmaW5lZCk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAicmVzaXplSGFuZGxlciIsIGZ1bmN0aW9uICgpIHsKICAgICAgX2V4cGxvcmVyX2Rhc2hib2FyZF9zZXJ2aWNlLmV4cGxvcmVyU2VydmljZS5zZXRTd2ltbGFuZUNvbnRhaW5lcldpZHRoKCgwLCBfbGVnYWN5X3V0aWxzLmdldFN3aW1sYW5lQ29udGFpbmVyV2lkdGgpKCkpOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAidmlld0J5Q2hhbmdlSGFuZGxlciIsIGZ1bmN0aW9uIChlKSB7CiAgICAgIHJldHVybiBfZXhwbG9yZXJfZGFzaGJvYXJkX3NlcnZpY2UuZXhwbG9yZXJTZXJ2aWNlLnNldFZpZXdCeVN3aW1sYW5lRmllbGROYW1lKGUudGFyZ2V0LnZhbHVlKTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImlzU3dpbWxhbmVTZWxlY3RBY3RpdmUiLCBmYWxzZSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAib25Td2ltbGFuZUVudGVySGFuZGxlciIsIGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIF90aGlzLnNldFN3aW1sYW5lU2VsZWN0QWN0aXZlKHRydWUpOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAib25Td2ltbGFuZUxlYXZlSGFuZGxlciIsIGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIF90aGlzLnNldFN3aW1sYW5lU2VsZWN0QWN0aXZlKGZhbHNlKTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInNldFN3aW1sYW5lU2VsZWN0QWN0aXZlIiwgZnVuY3Rpb24gKGFjdGl2ZSkgewogICAgICBpZiAoX3RoaXMuaXNTd2ltbGFuZVNlbGVjdEFjdGl2ZSAmJiAhYWN0aXZlICYmIF90aGlzLmRpc2FibGVEcmFnU2VsZWN0T25Nb3VzZUxlYXZlKSB7CiAgICAgICAgX3RoaXMuZHJhZ1NlbGVjdC5zdG9wKCk7CgogICAgICAgIF90aGlzLmlzU3dpbWxhbmVTZWxlY3RBY3RpdmUgPSBhY3RpdmU7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoIV90aGlzLmlzU3dpbWxhbmVTZWxlY3RBY3RpdmUgJiYgYWN0aXZlKSB7CiAgICAgICAgX3RoaXMuZHJhZ1NlbGVjdC5zdGFydCgpOwoKICAgICAgICBfdGhpcy5kcmFnU2VsZWN0LmNsZWFyU2VsZWN0aW9uKCk7CgogICAgICAgIF90aGlzLmRyYWdTZWxlY3Quc2V0U2VsZWN0YWJsZXMoZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnc2wtY2VsbCcpKTsKCiAgICAgICAgX3RoaXMuaXNTd2ltbGFuZVNlbGVjdEFjdGl2ZSA9IGFjdGl2ZTsKICAgICAgfQogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAic3dpbWxhbmVDZWxsQ2xpY2siLCBmdW5jdGlvbiAoc2VsZWN0ZWRDZWxscykgewogICAgICAvLyBJZiBzZWxlY3RlZENlbGxzIGlzIGFuIGVtcHR5IG9iamVjdCB3ZSBjbGVhciBhbnkgZXhpc3Rpbmcgc2VsZWN0aW9uLAogICAgICAvLyBvdGhlcndpc2Ugd2Ugc2F2ZSB0aGUgbmV3IHNlbGVjdGlvbiBpbiBBcHBTdGF0ZSBhbmQgdXBkYXRlIHRoZSBFeHBsb3Jlci4KICAgICAgaWYgKE9iamVjdC5rZXlzKHNlbGVjdGVkQ2VsbHMpLmxlbmd0aCA9PT0gMCkgewogICAgICAgIF90aGlzLnByb3BzLnNldFNlbGVjdGVkQ2VsbHMoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBfdGhpcy5wcm9wcy5zZXRTZWxlY3RlZENlbGxzKHNlbGVjdGVkQ2VsbHMpOwogICAgICB9CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJhcHBseUZpbHRlciIsIGZ1bmN0aW9uIChmaWVsZE5hbWUsIGZpZWxkVmFsdWUsIGFjdGlvbikgewogICAgICB2YXIgX3RoaXMkcHJvcHMkZXhwbG9yZXJTID0gX3RoaXMucHJvcHMuZXhwbG9yZXJTdGF0ZSwKICAgICAgICAgIGZpbHRlckFjdGl2ZSA9IF90aGlzJHByb3BzJGV4cGxvcmVyUy5maWx0ZXJBY3RpdmUsCiAgICAgICAgICBpbmRleFBhdHRlcm4gPSBfdGhpcyRwcm9wcyRleHBsb3JlclMuaW5kZXhQYXR0ZXJuLAogICAgICAgICAgcXVlcnlTdHJpbmcgPSBfdGhpcyRwcm9wcyRleHBsb3JlclMucXVlcnlTdHJpbmc7CiAgICAgIHZhciBuZXdRdWVyeVN0cmluZyA9ICcnOwogICAgICB2YXIgb3BlcmF0b3IgPSAnYW5kICc7CiAgICAgIHZhciBzYW5pdGl6ZWRGaWVsZE5hbWUgPSAoMCwgX3V0aWxzLmVzY2FwZVBhcmVucykoZmllbGROYW1lKTsKICAgICAgdmFyIHNhbml0aXplZEZpZWxkVmFsdWUgPSAoMCwgX3V0aWxzLmVzY2FwZURvdWJsZVF1b3RlcykoZmllbGRWYWx1ZSk7CgogICAgICBpZiAoYWN0aW9uID09PSBfZXhwbG9yZXJfY29uc3RhbnRzLkZJTFRFUl9BQ1RJT04uQUREKSB7CiAgICAgICAgLy8gRG9uJ3QgcmUtYWRkIGlmIGFscmVhZHkgZXhpc3RzIGluIHRoZSBxdWVyeQogICAgICAgIHZhciBxdWVyeVBhdHRlcm4gPSAoMCwgX3V0aWxzLmdldFF1ZXJ5UGF0dGVybikoZmllbGROYW1lLCBmaWVsZFZhbHVlKTsKCiAgICAgICAgaWYgKHF1ZXJ5U3RyaW5nLm1hdGNoKHF1ZXJ5UGF0dGVybikgIT09IG51bGwpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIG5ld1F1ZXJ5U3RyaW5nID0gIiIuY29uY2F0KHF1ZXJ5U3RyaW5nID8gIiIuY29uY2F0KHF1ZXJ5U3RyaW5nLCAiICIpLmNvbmNhdChvcGVyYXRvcikgOiAnJykuY29uY2F0KHNhbml0aXplZEZpZWxkTmFtZSwgIjpcIiIpLmNvbmNhdChzYW5pdGl6ZWRGaWVsZFZhbHVlLCAiXCIiKTsKICAgICAgfSBlbHNlIGlmIChhY3Rpb24gPT09IF9leHBsb3Jlcl9jb25zdGFudHMuRklMVEVSX0FDVElPTi5SRU1PVkUpIHsKICAgICAgICBpZiAoZmlsdGVyQWN0aXZlID09PSBmYWxzZSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBuZXdRdWVyeVN0cmluZyA9ICgwLCBfdXRpbHMucmVtb3ZlRmlsdGVyRnJvbVF1ZXJ5U3RyaW5nKShxdWVyeVN0cmluZywgc2FuaXRpemVkRmllbGROYW1lLCBzYW5pdGl6ZWRGaWVsZFZhbHVlKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRyeSB7CiAgICAgICAgdmFyIHF1ZXJ5VmFsdWVzID0gKDAsIF91dGlscy5nZXRLcWxRdWVyeVZhbHVlcykoIiIuY29uY2F0KG5ld1F1ZXJ5U3RyaW5nKSwgaW5kZXhQYXR0ZXJuKTsKCiAgICAgICAgX3RoaXMuYXBwbHlJbmZsdWVuY2Vyc0ZpbHRlclF1ZXJ5KHF1ZXJ5VmFsdWVzKTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIGNvbnNvbGUubG9nKCdJbnZhbGlkIGt1ZXJ5IHN5bnRheCcsIGUpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWNvbnNvbGUKCiAgICAgICAgX25vdGlmeS50b2FzdE5vdGlmaWNhdGlvbnMuYWRkRGFuZ2VyKF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tbC5leHBsb3Jlci5pbnZhbGlkS3VlcnlTeW50YXhFcnJvck1lc3NhZ2VGcm9tVGFibGUnLCB7CiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0ludmFsaWQgc3ludGF4IGluIHF1ZXJ5IGJhci4gVGhlIGlucHV0IG11c3QgYmUgdmFsaWQgS2liYW5hIFF1ZXJ5IExhbmd1YWdlIChLUUwpJwogICAgICAgIH0pKTsKICAgICAgfQogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiYXBwbHlJbmZsdWVuY2Vyc0ZpbHRlclF1ZXJ5IiwgZnVuY3Rpb24gKHBheWxvYWQpIHsKICAgICAgdmFyIGluZmx1ZW5jZXJzRmlsdGVyUXVlcnkgPSBwYXlsb2FkLmZpbHRlclF1ZXJ5OwoKICAgICAgaWYgKGluZmx1ZW5jZXJzRmlsdGVyUXVlcnkubWF0Y2hfYWxsICYmIE9iamVjdC5rZXlzKGluZmx1ZW5jZXJzRmlsdGVyUXVlcnkubWF0Y2hfYWxsKS5sZW5ndGggPT09IDApIHsKICAgICAgICBfZXhwbG9yZXJfZGFzaGJvYXJkX3NlcnZpY2UuZXhwbG9yZXJTZXJ2aWNlLmNsZWFySW5mbHVlbmNlckZpbHRlclNldHRpbmdzKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgX2V4cGxvcmVyX2Rhc2hib2FyZF9zZXJ2aWNlLmV4cGxvcmVyU2VydmljZS5zZXRJbmZsdWVuY2VyRmlsdGVyU2V0dGluZ3MocGF5bG9hZCk7CiAgICAgIH0KICAgIH0pOwoKICAgIHJldHVybiBfdGhpczsKICB9CgogIF9jcmVhdGVDbGFzcyhFeHBsb3JlciwgW3sKICAgIGtleTogImNvbXBvbmVudERpZE1vdW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnREaWRNb3VudCgpIHsKICAgICAgX3NlbGVjdF9saW1pdC5saW1pdCQucGlwZSgoMCwgX29wZXJhdG9ycy50YWtlVW50aWwpKHRoaXMuX3Vuc3Vic2NyaWJlQWxsKSwgKDAsIF9vcGVyYXRvcnMubWFwKShmdW5jdGlvbiAoZCkgewogICAgICAgIHJldHVybiBkLnZhbDsKICAgICAgfSkpLnN1YnNjcmliZShfZXhwbG9yZXJfZGFzaGJvYXJkX3NlcnZpY2UuZXhwbG9yZXJTZXJ2aWNlLnNldFN3aW1sYW5lTGltaXQpOyAvLyBSZXF1aXJlZCB0byByZWRyYXcgdGhlIHRpbWUgc2VyaWVzIGNoYXJ0IHdoZW4gdGhlIGNvbnRhaW5lciBpcyByZXNpemVkLgoKCiAgICAgIHRoaXMucmVzaXplQ2hlY2tlciA9IG5ldyBfcHVibGljLlJlc2l6ZUNoZWNrZXIodGhpcy5yZXNpemVSZWYuY3VycmVudCk7CiAgICAgIHRoaXMucmVzaXplQ2hlY2tlci5vbigncmVzaXplJywgdGhpcy5yZXNpemVIYW5kbGVyKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjb21wb25lbnRXaWxsVW5tb3VudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50V2lsbFVubW91bnQoKSB7CiAgICAgIHRoaXMuX3Vuc3Vic2NyaWJlQWxsLm5leHQoKTsKCiAgICAgIHRoaXMuX3Vuc3Vic2NyaWJlQWxsLmNvbXBsZXRlKCk7CgogICAgICB0aGlzLnJlc2l6ZUNoZWNrZXIuZGVzdHJveSgpOwogICAgfQogIH0sIHsKICAgIGtleTogInJlc2V0Q2FjaGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlc2V0Q2FjaGUoKSB7CiAgICAgIHRoaXMuYW5vbWFsaWVzVGFibGVQcmV2aW91c0FyZ3MgPSBudWxsOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkgewogICAgICB2YXIgX3RoaXMkcHJvcHMgPSB0aGlzLnByb3BzLAogICAgICAgICAgc2hvd0NoYXJ0cyA9IF90aGlzJHByb3BzLnNob3dDaGFydHMsCiAgICAgICAgICBzZXZlcml0eSA9IF90aGlzJHByb3BzLnNldmVyaXR5OwogICAgICB2YXIgX3RoaXMkcHJvcHMkZXhwbG9yZXJTMiA9IHRoaXMucHJvcHMuZXhwbG9yZXJTdGF0ZSwKICAgICAgICAgIGFubm90YXRpb25zRGF0YSA9IF90aGlzJHByb3BzJGV4cGxvcmVyUzIuYW5ub3RhdGlvbnNEYXRhLAogICAgICAgICAgY2hhcnRzRGF0YSA9IF90aGlzJHByb3BzJGV4cGxvcmVyUzIuY2hhcnRzRGF0YSwKICAgICAgICAgIGZpbHRlckFjdGl2ZSA9IF90aGlzJHByb3BzJGV4cGxvcmVyUzIuZmlsdGVyQWN0aXZlLAogICAgICAgICAgZmlsdGVyUGxhY2VIb2xkZXIgPSBfdGhpcyRwcm9wcyRleHBsb3JlclMyLmZpbHRlclBsYWNlSG9sZGVyLAogICAgICAgICAgaW5kZXhQYXR0ZXJuID0gX3RoaXMkcHJvcHMkZXhwbG9yZXJTMi5pbmRleFBhdHRlcm4sCiAgICAgICAgICBpbmZsdWVuY2VycyA9IF90aGlzJHByb3BzJGV4cGxvcmVyUzIuaW5mbHVlbmNlcnMsCiAgICAgICAgICBsb2FkaW5nID0gX3RoaXMkcHJvcHMkZXhwbG9yZXJTMi5sb2FkaW5nLAogICAgICAgICAgbWFza0FsbCA9IF90aGlzJHByb3BzJGV4cGxvcmVyUzIubWFza0FsbCwKICAgICAgICAgIG5vSW5mbHVlbmNlcnNDb25maWd1cmVkID0gX3RoaXMkcHJvcHMkZXhwbG9yZXJTMi5ub0luZmx1ZW5jZXJzQ29uZmlndXJlZCwKICAgICAgICAgIG92ZXJhbGxTd2ltbGFuZURhdGEgPSBfdGhpcyRwcm9wcyRleHBsb3JlclMyLm92ZXJhbGxTd2ltbGFuZURhdGEsCiAgICAgICAgICBxdWVyeVN0cmluZyA9IF90aGlzJHByb3BzJGV4cGxvcmVyUzIucXVlcnlTdHJpbmcsCiAgICAgICAgICBzZWxlY3RlZENlbGxzID0gX3RoaXMkcHJvcHMkZXhwbG9yZXJTMi5zZWxlY3RlZENlbGxzLAogICAgICAgICAgc2VsZWN0ZWRKb2JzID0gX3RoaXMkcHJvcHMkZXhwbG9yZXJTMi5zZWxlY3RlZEpvYnMsCiAgICAgICAgICBzd2ltbGFuZUNvbnRhaW5lcldpZHRoID0gX3RoaXMkcHJvcHMkZXhwbG9yZXJTMi5zd2ltbGFuZUNvbnRhaW5lcldpZHRoLAogICAgICAgICAgdGFibGVEYXRhID0gX3RoaXMkcHJvcHMkZXhwbG9yZXJTMi50YWJsZURhdGEsCiAgICAgICAgICB0YWJsZVF1ZXJ5U3RyaW5nID0gX3RoaXMkcHJvcHMkZXhwbG9yZXJTMi50YWJsZVF1ZXJ5U3RyaW5nLAogICAgICAgICAgdmlld0J5TG9hZGVkRm9yVGltZUZvcm1hdHRlZCA9IF90aGlzJHByb3BzJGV4cGxvcmVyUzIudmlld0J5TG9hZGVkRm9yVGltZUZvcm1hdHRlZCwKICAgICAgICAgIHZpZXdCeVN3aW1sYW5lRGF0YSA9IF90aGlzJHByb3BzJGV4cGxvcmVyUzIudmlld0J5U3dpbWxhbmVEYXRhLAogICAgICAgICAgdmlld0J5U3dpbWxhbmVEYXRhTG9hZGluZyA9IF90aGlzJHByb3BzJGV4cGxvcmVyUzIudmlld0J5U3dpbWxhbmVEYXRhTG9hZGluZywKICAgICAgICAgIHZpZXdCeVN3aW1sYW5lRmllbGROYW1lID0gX3RoaXMkcHJvcHMkZXhwbG9yZXJTMi52aWV3QnlTd2ltbGFuZUZpZWxkTmFtZSwKICAgICAgICAgIHZpZXdCeVN3aW1sYW5lT3B0aW9ucyA9IF90aGlzJHByb3BzJGV4cGxvcmVyUzIudmlld0J5U3dpbWxhbmVPcHRpb25zOwogICAgICB2YXIgam9iU2VsZWN0b3JQcm9wcyA9IHsKICAgICAgICBkYXRlRm9ybWF0VHo6ICgwLCBfZXhwbG9yZXJfdXRpbHMuZ2V0RGF0ZUZvcm1hdFR6KSgpCiAgICAgIH07CiAgICAgIHZhciBub0pvYnNGb3VuZCA9IHNlbGVjdGVkSm9icyA9PT0gbnVsbCB8fCBzZWxlY3RlZEpvYnMubGVuZ3RoID09PSAwOwogICAgICB2YXIgaGFzUmVzdWx0cyA9IG92ZXJhbGxTd2ltbGFuZURhdGEucG9pbnRzICYmIG92ZXJhbGxTd2ltbGFuZURhdGEucG9pbnRzLmxlbmd0aCA+IDA7CgogICAgICBpZiAobG9hZGluZyA9PT0gdHJ1ZSkgewogICAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KEV4cGxvcmVyUGFnZSwgewogICAgICAgICAgam9iU2VsZWN0b3JQcm9wczogam9iU2VsZWN0b3JQcm9wcywKICAgICAgICAgIHJlc2l6ZVJlZjogdGhpcy5yZXNpemVSZWYKICAgICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9sb2FkaW5nX2luZGljYXRvci5Mb2FkaW5nSW5kaWNhdG9yLCB7CiAgICAgICAgICBsYWJlbDogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1sLmV4cGxvcmVyLmxvYWRpbmdMYWJlbCcsIHsKICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdMb2FkaW5nJwogICAgICAgICAgfSkKICAgICAgICB9KSk7CiAgICAgIH0KCiAgICAgIGlmIChub0pvYnNGb3VuZCkgewogICAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KEV4cGxvcmVyUGFnZSwgewogICAgICAgICAgam9iU2VsZWN0b3JQcm9wczogam9iU2VsZWN0b3JQcm9wcywKICAgICAgICAgIHJlc2l6ZVJlZjogdGhpcy5yZXNpemVSZWYKICAgICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9jb21wb25lbnRzLkV4cGxvcmVyTm9Kb2JzRm91bmQsIG51bGwpKTsKICAgICAgfQoKICAgICAgaWYgKG5vSm9ic0ZvdW5kICYmIGhhc1Jlc3VsdHMgPT09IGZhbHNlKSB7CiAgICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoRXhwbG9yZXJQYWdlLCB7CiAgICAgICAgICBqb2JTZWxlY3RvclByb3BzOiBqb2JTZWxlY3RvclByb3BzLAogICAgICAgICAgcmVzaXplUmVmOiB0aGlzLnJlc2l6ZVJlZgogICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2NvbXBvbmVudHMuRXhwbG9yZXJOb1Jlc3VsdHNGb3VuZCwgbnVsbCkpOwogICAgICB9CgogICAgICB2YXIgbWFpbkNvbHVtbldpZHRoQ2xhc3NOYW1lID0gbm9JbmZsdWVuY2Vyc0NvbmZpZ3VyZWQgPT09IHRydWUgPyAnY29sLXhzLTEyJyA6ICdjb2wteHMtMTAnOwogICAgICB2YXIgbWFpbkNvbHVtbkNsYXNzZXMgPSAiY29sdW1uICIuY29uY2F0KG1haW5Db2x1bW5XaWR0aENsYXNzTmFtZSk7CiAgICAgIHZhciBzaG93T3ZlcmFsbFN3aW1sYW5lID0gb3ZlcmFsbFN3aW1sYW5lRGF0YSAhPT0gbnVsbCAmJiBvdmVyYWxsU3dpbWxhbmVEYXRhLmxhbmVMYWJlbHMgJiYgb3ZlcmFsbFN3aW1sYW5lRGF0YS5sYW5lTGFiZWxzLmxlbmd0aCA+IDA7CiAgICAgIHZhciBzaG93Vmlld0J5U3dpbWxhbmUgPSB2aWV3QnlTd2ltbGFuZURhdGEgIT09IG51bGwgJiYgdmlld0J5U3dpbWxhbmVEYXRhLmxhbmVMYWJlbHMgJiYgdmlld0J5U3dpbWxhbmVEYXRhLmxhbmVMYWJlbHMubGVuZ3RoID4gMDsKCiAgICAgIHZhciBib3VuZHMgPSBfdGltZWZpbHRlci50aW1lZmlsdGVyLmdldEFjdGl2ZUJvdW5kcygpOwoKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoRXhwbG9yZXJQYWdlLCB7CiAgICAgICAgam9iU2VsZWN0b3JQcm9wczogam9iU2VsZWN0b3JQcm9wcywKICAgICAgICByZXNpemVSZWY6IHRoaXMucmVzaXplUmVmCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICBjbGFzc05hbWU6ICJyZXN1bHRzLWNvbnRhaW5lciIKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfY2hhcnRfdG9vbHRpcC5DaGFydFRvb2x0aXAsIG51bGwpLCBub0luZmx1ZW5jZXJzQ29uZmlndXJlZCA9PT0gZmFsc2UgJiYgaW5mbHVlbmNlcnMgIT09IHVuZGVmaW5lZCAmJiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgY2xhc3NOYW1lOiAibWxBbm9tYWx5RXhwbG9yZXJfX2ZpbHRlckJhciIKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfa3FsX2ZpbHRlcl9iYXIuS3FsRmlsdGVyQmFyLCB7CiAgICAgICAgaW5kZXhQYXR0ZXJuOiBpbmRleFBhdHRlcm4sCiAgICAgICAgb25TdWJtaXQ6IHRoaXMuYXBwbHlJbmZsdWVuY2Vyc0ZpbHRlclF1ZXJ5LAogICAgICAgIGluaXRpYWxWYWx1ZTogcXVlcnlTdHJpbmcsCiAgICAgICAgcGxhY2Vob2xkZXI6IGZpbHRlclBsYWNlSG9sZGVyLAogICAgICAgIHZhbHVlRXh0ZXJuYWw6IHRhYmxlUXVlcnlTdHJpbmcKICAgICAgfSkpLCBub0luZmx1ZW5jZXJzQ29uZmlndXJlZCAmJiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgY2xhc3NOYW1lOiAibm8taW5mbHVlbmNlcnMtd2FybmluZyIKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUljb25UaXAsIHsKICAgICAgICBjb250ZW50OiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWwuZXhwbG9yZXIubm9Db25maWd1cmVkSW5mbHVlbmNlcnNUb29sdGlwJywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdUaGUgVG9wIEluZmx1ZW5jZXJzIGxpc3QgaXMgaGlkZGVuIGJlY2F1c2Ugbm8gaW5mbHVlbmNlcnMgaGF2ZSBiZWVuIGNvbmZpZ3VyZWQgZm9yIHRoZSBzZWxlY3RlZCBqb2JzLicKICAgICAgICB9KSwKICAgICAgICBwb3NpdGlvbjogInJpZ2h0IiwKICAgICAgICB0eXBlOiAiaUluQ2lyY2xlIgogICAgICB9KSksIG5vSW5mbHVlbmNlcnNDb25maWd1cmVkID09PSBmYWxzZSAmJiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgY2xhc3NOYW1lOiAiY29sdW1uIGNvbC14cy0yIGV1aVRleHQiLAogICAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJtbEFub21hbHlFeHBsb3JlckluZmx1ZW5jZXJMaXN0IgogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgewogICAgICAgIGNsYXNzTmFtZTogInBhbmVsLXRpdGxlIgogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAieHBhY2subWwuZXhwbG9yZXIudG9wSW5mdWVuY2Vyc1RpdGxlIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIlRvcCBJbmZsdWVuY2VycyIKICAgICAgfSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9pbmZsdWVuY2Vyc19saXN0LkluZmx1ZW5jZXJzTGlzdCwgewogICAgICAgIGluZmx1ZW5jZXJzOiBpbmZsdWVuY2VycywKICAgICAgICBpbmZsdWVuY2VyRmlsdGVyOiB0aGlzLmFwcGx5RmlsdGVyCiAgICAgIH0pKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgIGNsYXNzTmFtZTogbWFpbkNvbHVtbkNsYXNzZXMKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgic3BhbiIsIHsKICAgICAgICBjbGFzc05hbWU6ICJwYW5lbC10aXRsZSBldWlUZXh0IgogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAieHBhY2subWwuZXhwbG9yZXIuYW5vbWFseVRpbWVsaW5lVGl0bGUiLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiQW5vbWFseSB0aW1lbGluZSIKICAgICAgfSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgY2xhc3NOYW1lOiAibWwtZXhwbG9yZXItc3dpbWxhbmUgZXVpVGV4dCIsCiAgICAgICAgb25Nb3VzZUVudGVyOiB0aGlzLm9uU3dpbWxhbmVFbnRlckhhbmRsZXIsCiAgICAgICAgb25Nb3VzZUxlYXZlOiB0aGlzLm9uU3dpbWxhbmVMZWF2ZUhhbmRsZXIsCiAgICAgICAgImRhdGEtdGVzdC1zdWJqIjogIm1sQW5vbWFseUV4cGxvcmVyU3dpbWxhbmVPdmVyYWxsIgogICAgICB9LCBzaG93T3ZlcmFsbFN3aW1sYW5lICYmIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V4cGxvcmVyX3N3aW1sYW5lLkV4cGxvcmVyU3dpbWxhbmUsIHsKICAgICAgICBjaGFydFdpZHRoOiBzd2ltbGFuZUNvbnRhaW5lcldpZHRoLAogICAgICAgIGZpbHRlckFjdGl2ZTogZmlsdGVyQWN0aXZlLAogICAgICAgIG1hc2tBbGw6IG1hc2tBbGwsCiAgICAgICAgVGltZUJ1Y2tldHM6IF90aW1lX2J1Y2tldHMuVGltZUJ1Y2tldHMsCiAgICAgICAgc3dpbWxhbmVDZWxsQ2xpY2s6IHRoaXMuc3dpbWxhbmVDZWxsQ2xpY2ssCiAgICAgICAgc3dpbWxhbmVEYXRhOiBvdmVyYWxsU3dpbWxhbmVEYXRhLAogICAgICAgIHN3aW1sYW5lVHlwZTogX2V4cGxvcmVyX2NvbnN0YW50cy5TV0lNTEFORV9UWVBFLk9WRVJBTEwsCiAgICAgICAgc2VsZWN0aW9uOiBzZWxlY3RlZENlbGxzLAogICAgICAgIHN3aW1sYW5lUmVuZGVyRG9uZUxpc3RlbmVyOiB0aGlzLnN3aW1sYW5lUmVuZGVyRG9uZUxpc3RlbmVyCiAgICAgIH0pKSwgdmlld0J5U3dpbWxhbmVPcHRpb25zLmxlbmd0aCA+IDAgJiYgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuZGVmYXVsdC5GcmFnbWVudCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhHcm91cCwgewogICAgICAgIGRpcmVjdGlvbjogInJvdyIsCiAgICAgICAgZ3V0dGVyU2l6ZTogImwiLAogICAgICAgIHJlc3BvbnNpdmU6IHRydWUKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICAgICAgZ3JvdzogZmFsc2UKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZvcm1Sb3csIHsKICAgICAgICBsYWJlbDogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1sLmV4cGxvcmVyLnZpZXdCeUxhYmVsJywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdWaWV3IGJ5JwogICAgICAgIH0pCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTZWxlY3QsIHsKICAgICAgICBpZDogInNlbGVjdFZpZXdCeSIsCiAgICAgICAgb3B0aW9uczogbWFwU3dpbWxhbmVPcHRpb25zVG9FdWlPcHRpb25zKHZpZXdCeVN3aW1sYW5lT3B0aW9ucyksCiAgICAgICAgdmFsdWU6IHZpZXdCeVN3aW1sYW5lRmllbGROYW1lLAogICAgICAgIG9uQ2hhbmdlOiB0aGlzLnZpZXdCeUNoYW5nZUhhbmRsZXIKICAgICAgfSkpKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICAgICAgZ3JvdzogZmFsc2UKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZvcm1Sb3csIHsKICAgICAgICBsYWJlbDogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1sLmV4cGxvcmVyLmxpbWl0TGFiZWwnLCB7CiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0xpbWl0JwogICAgICAgIH0pCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3NlbGVjdF9saW1pdC5TZWxlY3RMaW1pdCwgbnVsbCkpKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICAgICAgZ3JvdzogZmFsc2UsCiAgICAgICAgc3R5bGU6IHsKICAgICAgICAgIGFsaWduU2VsZjogJ2NlbnRlcicKICAgICAgICB9CiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGb3JtUm93LCB7CiAgICAgICAgbGFiZWw6ICJcdTIwMEIiCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICBjbGFzc05hbWU6ICJwYW5lbC1zdWItdGl0bGUiCiAgICAgIH0sIHZpZXdCeUxvYWRlZEZvclRpbWVGb3JtYXR0ZWQgJiYgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogInhwYWNrLm1sLmV4cGxvcmVyLnNvcnRlZEJ5TWF4QW5vbWFseVNjb3JlRm9yVGltZUZvcm1hdHRlZExhYmVsIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIihTb3J0ZWQgYnkgbWF4IGFub21hbHkgc2NvcmUgZm9yIHt2aWV3QnlMb2FkZWRGb3JUaW1lRm9ybWF0dGVkfSkiLAogICAgICAgIHZhbHVlczogewogICAgICAgICAgdmlld0J5TG9hZGVkRm9yVGltZUZvcm1hdHRlZDogdmlld0J5TG9hZGVkRm9yVGltZUZvcm1hdHRlZAogICAgICAgIH0KICAgICAgfSksIHZpZXdCeUxvYWRlZEZvclRpbWVGb3JtYXR0ZWQgPT09IHVuZGVmaW5lZCAmJiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAieHBhY2subWwuZXhwbG9yZXIuc29ydGVkQnlNYXhBbm9tYWx5U2NvcmVMYWJlbCIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICIoU29ydGVkIGJ5IG1heCBhbm9tYWx5IHNjb3JlKSIKICAgICAgfSksIGZpbHRlckFjdGl2ZSA9PT0gdHJ1ZSAmJiB2aWV3QnlTd2ltbGFuZUZpZWxkTmFtZSA9PT0gX2V4cGxvcmVyX2NvbnN0YW50cy5WSUVXX0JZX0pPQl9MQUJFTCAmJiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAieHBhY2subWwuZXhwbG9yZXIuam9iU2NvcmVBY3Jvc3NBbGxJbmZsdWVuY2Vyc0xhYmVsIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIihKb2Igc2NvcmUgYWNyb3NzIGFsbCBpbmZsdWVuY2VycykiCiAgICAgIH0pKSkpKSwgc2hvd1ZpZXdCeVN3aW1sYW5lICYmIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LmRlZmF1bHQuRnJhZ21lbnQsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTcGFjZXIsIHsKICAgICAgICBzaXplOiAibSIKICAgICAgfSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICBjbGFzc05hbWU6ICJtbC1leHBsb3Jlci1zd2ltbGFuZSBldWlUZXh0IiwKICAgICAgICBvbk1vdXNlRW50ZXI6IHRoaXMub25Td2ltbGFuZUVudGVySGFuZGxlciwKICAgICAgICBvbk1vdXNlTGVhdmU6IHRoaXMub25Td2ltbGFuZUxlYXZlSGFuZGxlciwKICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiAibWxBbm9tYWx5RXhwbG9yZXJTd2ltbGFuZVZpZXdCeSIKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXhwbG9yZXJfc3dpbWxhbmUuRXhwbG9yZXJTd2ltbGFuZSwgewogICAgICAgIGNoYXJ0V2lkdGg6IHN3aW1sYW5lQ29udGFpbmVyV2lkdGgsCiAgICAgICAgZmlsdGVyQWN0aXZlOiBmaWx0ZXJBY3RpdmUsCiAgICAgICAgbWFza0FsbDogbWFza0FsbCwKICAgICAgICBUaW1lQnVja2V0czogX3RpbWVfYnVja2V0cy5UaW1lQnVja2V0cywKICAgICAgICBzd2ltbGFuZUNlbGxDbGljazogdGhpcy5zd2ltbGFuZUNlbGxDbGljaywKICAgICAgICBzd2ltbGFuZURhdGE6IHZpZXdCeVN3aW1sYW5lRGF0YSwKICAgICAgICBzd2ltbGFuZVR5cGU6IF9leHBsb3Jlcl9jb25zdGFudHMuU1dJTUxBTkVfVFlQRS5WSUVXX0JZLAogICAgICAgIHNlbGVjdGlvbjogc2VsZWN0ZWRDZWxscywKICAgICAgICBzd2ltbGFuZVJlbmRlckRvbmVMaXN0ZW5lcjogdGhpcy5zd2ltbGFuZVJlbmRlckRvbmVMaXN0ZW5lcgogICAgICB9KSkpLCB2aWV3QnlTd2ltbGFuZURhdGFMb2FkaW5nICYmIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2xvYWRpbmdfaW5kaWNhdG9yLkxvYWRpbmdJbmRpY2F0b3IsIG51bGwpLCAhc2hvd1ZpZXdCeVN3aW1sYW5lICYmICF2aWV3QnlTd2ltbGFuZURhdGFMb2FkaW5nICYmIHZpZXdCeVN3aW1sYW5lRmllbGROYW1lICE9PSBudWxsICYmIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2NvbXBvbmVudHMuRXhwbG9yZXJOb0luZmx1ZW5jZXJzRm91bmQsIHsKICAgICAgICB2aWV3QnlTd2ltbGFuZUZpZWxkTmFtZTogdmlld0J5U3dpbWxhbmVGaWVsZE5hbWUsCiAgICAgICAgc2hvd0ZpbHRlck1lc3NhZ2U6IGZpbHRlckFjdGl2ZSA9PT0gdHJ1ZQogICAgICB9KSksIGFubm90YXRpb25zRGF0YS5sZW5ndGggPiAwICYmIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LmRlZmF1bHQuRnJhZ21lbnQsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCB7CiAgICAgICAgY2xhc3NOYW1lOiAicGFuZWwtdGl0bGUgZXVpVGV4dCIKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogInhwYWNrLm1sLmV4cGxvcmVyLmFubm90YXRpb25zVGl0bGUiLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiQW5ub3RhdGlvbnMiCiAgICAgIH0pKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfYW5ub3RhdGlvbnNfdGFibGUuQW5ub3RhdGlvbnNUYWJsZSwgewogICAgICAgIGFubm90YXRpb25zOiBhbm5vdGF0aW9uc0RhdGEsCiAgICAgICAgZHJpbGxEb3duOiB0cnVlLAogICAgICAgIG51bWJlckJhZGdlOiBmYWxzZQogICAgICB9KSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfYW5ub3RhdGlvbl9mbHlvdXQuQW5ub3RhdGlvbkZseW91dCwgbnVsbCksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTcGFjZXIsIHsKICAgICAgICBzaXplOiAibCIKICAgICAgfSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgewogICAgICAgIGNsYXNzTmFtZTogInBhbmVsLXRpdGxlIGV1aVRleHQiCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJ4cGFjay5tbC5leHBsb3Jlci5hbm9tYWxpZXNUaXRsZSIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJBbm9tYWxpZXMiCiAgICAgIH0pKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhHcm91cCwgewogICAgICAgIGRpcmVjdGlvbjogInJvdyIsCiAgICAgICAgZ3V0dGVyU2l6ZTogImwiLAogICAgICAgIHJlc3BvbnNpdmU6IHRydWUsCiAgICAgICAgY2xhc3NOYW1lOiAibWwtYW5vbWFsaWVzLWNvbnRyb2xzIgogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgICAgICBncm93OiBmYWxzZSwKICAgICAgICBzdHlsZTogewogICAgICAgICAgd2lkdGg6ICcxNzBweCcKICAgICAgICB9CiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGb3JtUm93LCB7CiAgICAgICAgbGFiZWw6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tbC5leHBsb3Jlci5zZXZlcml0eVRocmVzaG9sZExhYmVsJywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdTZXZlcml0eSB0aHJlc2hvbGQnCiAgICAgICAgfSkKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfc2VsZWN0X3NldmVyaXR5LlNlbGVjdFNldmVyaXR5LCBudWxsKSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgICAgICBncm93OiBmYWxzZSwKICAgICAgICBzdHlsZTogewogICAgICAgICAgd2lkdGg6ICcxNzBweCcKICAgICAgICB9CiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGb3JtUm93LCB7CiAgICAgICAgbGFiZWw6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tbC5leHBsb3Jlci5pbnRlcnZhbExhYmVsJywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdJbnRlcnZhbCcKICAgICAgICB9KQogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9zZWxlY3RfaW50ZXJ2YWwuU2VsZWN0SW50ZXJ2YWwsIG51bGwpKSksIGNoYXJ0c0RhdGEuc2VyaWVzVG9QbG90Lmxlbmd0aCA+IDAgJiYgc2VsZWN0ZWRDZWxscyAhPT0gdW5kZWZpbmVkICYmIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgICAgIGdyb3c6IGZhbHNlLAogICAgICAgIHN0eWxlOiB7CiAgICAgICAgICBhbGlnblNlbGY6ICdjZW50ZXInCiAgICAgICAgfQogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRm9ybVJvdywgewogICAgICAgIGxhYmVsOiAiXHUyMDBCIgogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9jaGVja2JveF9zaG93Y2hhcnRzLkNoZWNrYm94U2hvd0NoYXJ0cywgbnVsbCkpKSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTcGFjZXIsIHsKICAgICAgICBzaXplOiAibSIKICAgICAgfSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICBjbGFzc05hbWU6ICJldWlUZXh0IGV4cGxvcmVyLWNoYXJ0cyIKICAgICAgfSwgc2hvd0NoYXJ0cyAmJiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9leHBsb3Jlcl9jaGFydHNfY29udGFpbmVyLkV4cGxvcmVyQ2hhcnRzQ29udGFpbmVyLCBfb2JqZWN0U3ByZWFkKHt9LCBjaGFydHNEYXRhLCB7CiAgICAgICAgc2V2ZXJpdHk6IHNldmVyaXR5CiAgICAgIH0pKSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2Fub21hbGllc190YWJsZS5Bbm9tYWxpZXNUYWJsZSwgewogICAgICAgIGJvdW5kczogYm91bmRzLAogICAgICAgIHRhYmxlRGF0YTogdGFibGVEYXRhLAogICAgICAgIGluZmx1ZW5jZXJGaWx0ZXI6IHRoaXMuYXBwbHlGaWx0ZXIKICAgICAgfSkpKSk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gRXhwbG9yZXI7Cn0oX3JlYWN0LmRlZmF1bHQuQ29tcG9uZW50KTsKCmV4cG9ydHMuRXhwbG9yZXIgPSBFeHBsb3JlcjsKCl9kZWZpbmVQcm9wZXJ0eShFeHBsb3JlciwgInByb3BUeXBlcyIsIHsKICBleHBsb3JlclN0YXRlOiBfcHJvcFR5cGVzLmRlZmF1bHQub2JqZWN0LmlzUmVxdWlyZWQsCiAgc2V0U2VsZWN0ZWRDZWxsczogX3Byb3BUeXBlcy5kZWZhdWx0LmZ1bmMuaXNSZXF1aXJlZCwKICBzZXZlcml0eTogX3Byb3BUeXBlcy5kZWZhdWx0Lm51bWJlci5pc1JlcXVpcmVkLAogIHNob3dDaGFydHM6IF9wcm9wVHlwZXMuZGVmYXVsdC5ib29sLmlzUmVxdWlyZWQKfSk7"},null]}