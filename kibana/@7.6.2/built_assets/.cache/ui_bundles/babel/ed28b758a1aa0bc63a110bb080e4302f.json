{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/rollup/public/crud_app/sections/job_create/job_create.js","dependencies":[{"path":"x-pack/legacy/plugins/rollup/public/crud_app/sections/job_create/job_create.js","mtime":1585205046996},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkpvYkNyZWF0ZSA9IGV4cG9ydHMuSm9iQ3JlYXRlVWkgPSB2b2lkIDA7Cgp2YXIgX3JlYWN0ID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgicmVhY3QiKSk7Cgp2YXIgX3Byb3BUeXBlcyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgicHJvcC10eXBlcyIpKTsKCnZhciBfbWFwVmFsdWVzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJsb2Rhc2gvb2JqZWN0L21hcFZhbHVlcyIpKTsKCnZhciBfY2xvbmVEZWVwID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJsb2Rhc2gvbGFuZy9jbG9uZURlZXAiKSk7Cgp2YXIgX2RlYm91bmNlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJsb2Rhc2gvZnVuY3Rpb24vZGVib3VuY2UiKSk7Cgp2YXIgX2ZpcnN0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJsb2Rhc2gvYXJyYXkvZmlyc3QiKSk7Cgp2YXIgX2kxOG4gPSByZXF1aXJlKCJAa2JuL2kxOG4iKTsKCnZhciBfcmVhY3QyID0gcmVxdWlyZSgiQGtibi9pMThuL3JlYWN0Iik7Cgp2YXIgX2Nocm9tZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgidWkvY2hyb21lIikpOwoKdmFyIF9tYW5hZ2VtZW50ID0gcmVxdWlyZSgidWkvbWFuYWdlbWVudCIpOwoKdmFyIF9ldWkgPSByZXF1aXJlKCJAZWxhc3RpYy9ldWkiKTsKCnZhciBfbm90aWZ5ID0gcmVxdWlyZSgidWkvbm90aWZ5Iik7Cgp2YXIgX3NlcnZpY2VzID0gcmVxdWlyZSgiLi4vLi4vc2VydmljZXMiKTsKCnZhciBfbmF2aWdhdGlvbiA9IHJlcXVpcmUoIi4vbmF2aWdhdGlvbiIpOwoKdmFyIF9zdGVwcyA9IHJlcXVpcmUoIi4vc3RlcHMiKTsKCnZhciBfc3RlcHNfY29uZmlnID0gcmVxdWlyZSgiLi9zdGVwc19jb25maWciKTsKCnZhciBfc3RlcElkVG9UaXRsZU1hcDsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGVsc2UgeyB2YXIgbmV3T2JqID0ge307IGlmIChvYmogIT0gbnVsbCkgeyBmb3IgKHZhciBrZXkgaW4gb2JqKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7IHZhciBkZXNjID0gT2JqZWN0LmRlZmluZVByb3BlcnR5ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KSA6IHt9OyBpZiAoZGVzYy5nZXQgfHwgZGVzYy5zZXQpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5ld09iaiwga2V5LCBkZXNjKTsgfSBlbHNlIHsgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IH0gfSBuZXdPYmouZGVmYXVsdCA9IG9iajsgcmV0dXJuIG5ld09iajsgfSB9CgpmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyBpZiAodHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSAic3ltYm9sIikgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH07IH0gZWxzZSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mKG9iaik7IH0KCmZ1bmN0aW9uIF9vYmplY3REZXN0cnVjdHVyaW5nRW1wdHkob2JqKSB7IGlmIChvYmogPT0gbnVsbCkgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGRlc3RydWN0dXJlIHVuZGVmaW5lZCIpOyB9CgpmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOyBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgeyB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsgaWYgKGVudW1lcmFibGVPbmx5KSBzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgeyByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsgfSk7IGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsgfSByZXR1cm4ga2V5czsgfQoKZnVuY3Rpb24gX29iamVjdFNwcmVhZCh0YXJnZXQpIHsgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXSAhPSBudWxsID8gYXJndW1lbnRzW2ldIDoge307IGlmIChpICUgMikgeyBvd25LZXlzKHNvdXJjZSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOyB9KTsgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgeyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpOyB9IGVsc2UgeyBvd25LZXlzKHNvdXJjZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOyB9KTsgfSB9IHJldHVybiB0YXJnZXQ7IH0KCmZ1bmN0aW9uIF90b0NvbnN1bWFibGVBcnJheShhcnIpIHsgcmV0dXJuIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfbm9uSXRlcmFibGVTcHJlYWQoKTsgfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlU3ByZWFkKCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gc3ByZWFkIG5vbi1pdGVyYWJsZSBpbnN0YW5jZSIpOyB9CgpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5KGl0ZXIpIHsgaWYgKFN5bWJvbC5pdGVyYXRvciBpbiBPYmplY3QoaXRlcikgfHwgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGl0ZXIpID09PSAiW29iamVjdCBBcmd1bWVudHNdIikgcmV0dXJuIEFycmF5LmZyb20oaXRlcik7IH0KCmZ1bmN0aW9uIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHsgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgeyBmb3IgKHZhciBpID0gMCwgYXJyMiA9IG5ldyBBcnJheShhcnIubGVuZ3RoKTsgaSA8IGFyci5sZW5ndGg7IGkrKykgeyBhcnIyW2ldID0gYXJyW2ldOyB9IHJldHVybiBhcnIyOyB9IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0KCmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9CgpmdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmIChjYWxsICYmIChfdHlwZW9mKGNhbGwpID09PSAib2JqZWN0IiB8fCB0eXBlb2YgY2FsbCA9PT0gImZ1bmN0aW9uIikpIHsgcmV0dXJuIGNhbGw7IH0gcmV0dXJuIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZik7IH0KCmZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IF9nZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IHJldHVybiBvLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2Yobyk7IH07IHJldHVybiBfZ2V0UHJvdG90eXBlT2Yobyk7IH0KCmZ1bmN0aW9uIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZikgeyBpZiAoc2VsZiA9PT0gdm9pZCAwKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcigidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkIik7IH0gcmV0dXJuIHNlbGY7IH0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICJmdW5jdGlvbiIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiIpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcyk7IH0KCmZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IF9zZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBvLl9fcHJvdG9fXyA9IHA7IHJldHVybiBvOyB9OyByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApOyB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7IGlmIChrZXkgaW4gb2JqKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgeyB2YWx1ZTogdmFsdWUsIGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUgfSk7IH0gZWxzZSB7IG9ialtrZXldID0gdmFsdWU7IH0gcmV0dXJuIG9iajsgfQoKdmFyIHN0ZXBJZFRvVGl0bGVNYXAgPSAoX3N0ZXBJZFRvVGl0bGVNYXAgPSB7fSwgX2RlZmluZVByb3BlcnR5KF9zdGVwSWRUb1RpdGxlTWFwLCBfc3RlcHNfY29uZmlnLlNURVBfTE9HSVNUSUNTLCBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2sucm9sbHVwSm9icy5jcmVhdGUuc3RlcHMuc3RlcExvZ2lzdGljc1RpdGxlJywgewogIGRlZmF1bHRNZXNzYWdlOiAnTG9naXN0aWNzJwp9KSksIF9kZWZpbmVQcm9wZXJ0eShfc3RlcElkVG9UaXRsZU1hcCwgX3N0ZXBzX2NvbmZpZy5TVEVQX0RBVEVfSElTVE9HUkFNLCBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2sucm9sbHVwSm9icy5jcmVhdGUuc3RlcHMuc3RlcERhdGVIaXN0b2dyYW1UaXRsZScsIHsKICBkZWZhdWx0TWVzc2FnZTogJ0RhdGUgaGlzdG9ncmFtJwp9KSksIF9kZWZpbmVQcm9wZXJ0eShfc3RlcElkVG9UaXRsZU1hcCwgX3N0ZXBzX2NvbmZpZy5TVEVQX1RFUk1TLCBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2sucm9sbHVwSm9icy5jcmVhdGUuc3RlcHMuc3RlcFRlcm1zVGl0bGUnLCB7CiAgZGVmYXVsdE1lc3NhZ2U6ICdUZXJtcycKfSkpLCBfZGVmaW5lUHJvcGVydHkoX3N0ZXBJZFRvVGl0bGVNYXAsIF9zdGVwc19jb25maWcuU1RFUF9ISVNUT0dSQU0sIF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5yb2xsdXBKb2JzLmNyZWF0ZS5zdGVwcy5zdGVwSGlzdG9ncmFtVGl0bGUnLCB7CiAgZGVmYXVsdE1lc3NhZ2U6ICdIaXN0b2dyYW0nCn0pKSwgX2RlZmluZVByb3BlcnR5KF9zdGVwSWRUb1RpdGxlTWFwLCBfc3RlcHNfY29uZmlnLlNURVBfTUVUUklDUywgX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLnJvbGx1cEpvYnMuY3JlYXRlLnN0ZXBzLnN0ZXBNZXRyaWNzVGl0bGUnLCB7CiAgZGVmYXVsdE1lc3NhZ2U6ICdNZXRyaWNzJwp9KSksIF9kZWZpbmVQcm9wZXJ0eShfc3RlcElkVG9UaXRsZU1hcCwgX3N0ZXBzX2NvbmZpZy5TVEVQX1JFVklFVywgX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLnJvbGx1cEpvYnMuY3JlYXRlLnN0ZXBzLnN0ZXBSZXZpZXdUaXRsZScsIHsKICBkZWZhdWx0TWVzc2FnZTogJ1JldmlldyBhbmQgc2F2ZScKfSkpLCBfc3RlcElkVG9UaXRsZU1hcCk7Cgp2YXIgSm9iQ3JlYXRlVWkgPQovKiNfX1BVUkVfXyovCmZ1bmN0aW9uIChfQ29tcG9uZW50KSB7CiAgX2luaGVyaXRzKEpvYkNyZWF0ZVVpLCBfQ29tcG9uZW50KTsKCiAgZnVuY3Rpb24gSm9iQ3JlYXRlVWkocHJvcHMpIHsKICAgIHZhciBfdGhpczsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgSm9iQ3JlYXRlVWkpOwoKICAgIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgX2dldFByb3RvdHlwZU9mKEpvYkNyZWF0ZVVpKS5jYWxsKHRoaXMsIHByb3BzKSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAicmVxdWVzdEluZGV4UGF0dGVyblZhbGlkYXRpb24iLCAoMCwgX2RlYm91bmNlLmRlZmF1bHQpKGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHJlc2V0RGVmYXVsdHMgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHRydWU7CgogICAgICB2YXIgaW5kZXhQYXR0ZXJuID0gX3RoaXMuZ2V0SW5kZXhQYXR0ZXJuKCk7CgogICAgICB2YXIgbGFzdEluZGV4UGF0dGVyblZhbGlkYXRpb25UaW1lID0gX3RoaXMubGFzdEluZGV4UGF0dGVyblZhbGlkYXRpb25UaW1lID0gRGF0ZS5ub3coKTsKICAgICAgKDAsIF9zZXJ2aWNlcy52YWxpZGF0ZUluZGV4UGF0dGVybikoaW5kZXhQYXR0ZXJuKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIC8vIFdlIGRvbid0IG5lZWQgdG8gZG8gYW55dGhpbmcgaWYgdGhpcyBjb21wb25lbnQgaGFzIGJlZW4gdW5tb3VudGVkLgogICAgICAgIGlmICghX3RoaXMuX2lzTW91bnRlZCkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0gLy8gT25seSByZS1yZXF1ZXN0IGlmIHRoZSBpbmRleCBwYXR0ZXJuIGNoYW5nZWQuCgoKICAgICAgICBpZiAobGFzdEluZGV4UGF0dGVyblZhbGlkYXRpb25UaW1lICE9PSBfdGhpcy5sYXN0SW5kZXhQYXR0ZXJuVmFsaWRhdGlvblRpbWUpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHZhciBfcmVzcG9uc2UkZGF0YSA9IHJlc3BvbnNlLmRhdGEsCiAgICAgICAgICAgIGRvZXNJbmRleFBhdHRlcm5NYXRjaEluZGljZXMgPSBfcmVzcG9uc2UkZGF0YS5kb2VzTWF0Y2hJbmRpY2VzLAogICAgICAgICAgICBkb2VzSW5kZXhQYXR0ZXJuTWF0Y2hSb2xsdXBJbmRpY2VzID0gX3Jlc3BvbnNlJGRhdGEuZG9lc01hdGNoUm9sbHVwSW5kaWNlcywKICAgICAgICAgICAgaW5kZXhQYXR0ZXJuRGF0ZUZpZWxkcyA9IF9yZXNwb25zZSRkYXRhLmRhdGVGaWVsZHMsCiAgICAgICAgICAgIG51bWVyaWNGaWVsZHMgPSBfcmVzcG9uc2UkZGF0YS5udW1lcmljRmllbGRzLAogICAgICAgICAgICBrZXl3b3JkRmllbGRzID0gX3Jlc3BvbnNlJGRhdGEua2V5d29yZEZpZWxkczsKICAgICAgICB2YXIgaW5kZXhQYXR0ZXJuQXN5bmNFcnJvcnM7CgogICAgICAgIGlmIChkb2VzSW5kZXhQYXR0ZXJuTWF0Y2hSb2xsdXBJbmRpY2VzKSB7CiAgICAgICAgICBpbmRleFBhdHRlcm5Bc3luY0Vycm9ycyA9IFtfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgICAgICBpZDogInhwYWNrLnJvbGx1cEpvYnMuY3JlYXRlLmVycm9ycy5pbmRleFBhdHRlcm5NYXRjaGVzUm9sbHVwSW5kaWNlcyIsCiAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiSW5kZXggcGF0dGVybiBtdXN0IG5vdCBtYXRjaCByb2xsdXAgaW5kaWNlcy4iCiAgICAgICAgICB9KV07CiAgICAgICAgfSBlbHNlIGlmICghZG9lc0luZGV4UGF0dGVybk1hdGNoSW5kaWNlcykgewogICAgICAgICAgaW5kZXhQYXR0ZXJuQXN5bmNFcnJvcnMgPSBbX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICAgICAgaWQ6ICJ4cGFjay5yb2xsdXBKb2JzLmNyZWF0ZS5lcnJvcnMuaW5kZXhQYXR0ZXJuTm9NYXRjaGluZ0luZGljZXMiLAogICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkluZGV4IHBhdHRlcm4gZG9lc24ndCBtYXRjaCBhbnkgaW5kaWNlcy4iCiAgICAgICAgICB9KV07CiAgICAgICAgfSBlbHNlIGlmICghaW5kZXhQYXR0ZXJuRGF0ZUZpZWxkcy5sZW5ndGgpIHsKICAgICAgICAgIGluZGV4UGF0dGVybkFzeW5jRXJyb3JzID0gW19yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICAgIGlkOiAieHBhY2sucm9sbHVwSm9icy5jcmVhdGUuZXJyb3JzLmluZGV4UGF0dGVybk5vVGltZUZpZWxkcyIsCiAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiSW5kZXggcGF0dGVybiBtdXN0IG1hdGNoIGluZGljZXMgdGhhdCBjb250YWluIHRpbWUgZmllbGRzLiIKICAgICAgICAgIH0pXTsKICAgICAgICB9CgogICAgICAgIHZhciBudW1lcmljVHlwZSA9IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5yb2xsdXBKb2JzLmNyZWF0ZS5udW1lcmljVHlwZUZpZWxkJywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdudW1lcmljJwogICAgICAgIH0pOwoKICAgICAgICB2YXIga2V5d29yZFR5cGUgPSBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2sucm9sbHVwSm9icy5jcmVhdGUua2V5d29yZFR5cGVGaWVsZCcsIHsKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAna2V5d29yZCcKICAgICAgICB9KTsKCiAgICAgICAgdmFyIGRhdGVUeXBlID0gX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLnJvbGx1cEpvYnMuY3JlYXRlLmRhdGVUeXBlRmllbGQnLCB7CiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ2RhdGUnCiAgICAgICAgfSk7CgogICAgICAgIHZhciBmb3JtYXR0ZWROdW1lcmljRmllbGRzID0gKDAsIF9zZXJ2aWNlcy5mb3JtYXRGaWVsZHMpKG51bWVyaWNGaWVsZHMsIG51bWVyaWNUeXBlKTsKICAgICAgICB2YXIgZm9ybWF0dGVkS2V5d29yZEZpZWxkcyA9ICgwLCBfc2VydmljZXMuZm9ybWF0RmllbGRzKShrZXl3b3JkRmllbGRzLCBrZXl3b3JkVHlwZSk7CiAgICAgICAgdmFyIGZvcm1hdHRlZERhdGVGaWVsZHMgPSAoMCwgX3NlcnZpY2VzLmZvcm1hdEZpZWxkcykoaW5kZXhQYXR0ZXJuRGF0ZUZpZWxkcywgZGF0ZVR5cGUpOwogICAgICAgIHZhciBfdGhpcyRzdGF0ZSA9IF90aGlzLnN0YXRlLAogICAgICAgICAgICBqb2JUb0Nsb25lID0gX3RoaXMkc3RhdGUuam9iVG9DbG9uZSwKICAgICAgICAgICAgc3RlcHNGaWVsZHMgPSBfdGhpcyRzdGF0ZS5zdGVwc0ZpZWxkczsKICAgICAgICB2YXIgbWV0cmljcyA9IHN0ZXBzRmllbGRzW19zdGVwc19jb25maWcuU1RFUF9NRVRSSUNTXS5tZXRyaWNzOyAvLyBPbmx5IHJlLXR5cGUgbWV0cmljcyBpZiB0aGV5IGhhdmVuJ3QgYmVlbiB0eXBlZCBhbHJlYWR5CgogICAgICAgIGlmIChqb2JUb0Nsb25lICYmIG1ldHJpY3MgJiYgbWV0cmljcy5sZW5ndGggJiYgISgwLCBfZmlyc3QuZGVmYXVsdCkobWV0cmljcykudHlwZSkgewogICAgICAgICAgLy8gUmUtdHlwZSBhbnkgcHJlLWV4aXN0aW5nIG1ldHJpY3MgZW50cmllcyBmb3IgdGhlIGpvYiB3ZSBhcmUgY2xvbmluZy4KICAgICAgICAgIHZhciB0eXBlTWFwcyA9IFt7CiAgICAgICAgICAgIGZpZWxkczogZm9ybWF0dGVkTnVtZXJpY0ZpZWxkcywKICAgICAgICAgICAgdHlwZTogbnVtZXJpY1R5cGUKICAgICAgICAgIH0sIHsKICAgICAgICAgICAgZmllbGRzOiBmb3JtYXR0ZWRLZXl3b3JkRmllbGRzLAogICAgICAgICAgICB0eXBlOiBrZXl3b3JkVHlwZQogICAgICAgICAgfSwgewogICAgICAgICAgICBmaWVsZHM6IGZvcm1hdHRlZERhdGVGaWVsZHMsCiAgICAgICAgICAgIHR5cGU6IGRhdGVUeXBlCiAgICAgICAgICB9XTsKICAgICAgICAgIHZhciByZXR5cGVkTWV0cmljcyA9ICgwLCBfc2VydmljZXMucmV0eXBlTWV0cmljcykoewogICAgICAgICAgICBtZXRyaWNzOiBtZXRyaWNzLAogICAgICAgICAgICB0eXBlTWFwczogdHlwZU1hcHMKICAgICAgICAgIH0pOwoKICAgICAgICAgIF90aGlzLm9uRmllbGRzQ2hhbmdlKHsKICAgICAgICAgICAgbWV0cmljczogcmV0eXBlZE1ldHJpY3MKICAgICAgICAgIH0sIF9zdGVwc19jb25maWcuU1RFUF9NRVRSSUNTKTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIHNvcnRGaWVsZHMoYSwgYikgewogICAgICAgICAgdmFyIG5hbWVBID0gYS5uYW1lLnRvVXBwZXJDYXNlKCk7CiAgICAgICAgICB2YXIgbmFtZUIgPSBiLm5hbWUudG9VcHBlckNhc2UoKTsKCiAgICAgICAgICBpZiAobmFtZUEgPCBuYW1lQikgewogICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKG5hbWVBID4gbmFtZUIpIHsKICAgICAgICAgICAgcmV0dXJuIDE7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQoKICAgICAgICB2YXIgaW5kZXhQYXR0ZXJuVGVybXNGaWVsZHMgPSBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KGZvcm1hdHRlZE51bWVyaWNGaWVsZHMpLCBfdG9Db25zdW1hYmxlQXJyYXkoZm9ybWF0dGVkS2V5d29yZEZpZWxkcykpLnNvcnQoc29ydEZpZWxkcyk7CgogICAgICAgIHZhciBpbmRleFBhdHRlcm5IaXN0b2dyYW1GaWVsZHMgPSBfdG9Db25zdW1hYmxlQXJyYXkoZm9ybWF0dGVkTnVtZXJpY0ZpZWxkcykuc29ydChzb3J0RmllbGRzKTsKCiAgICAgICAgdmFyIGluZGV4UGF0dGVybk1ldHJpY3NGaWVsZHMgPSBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KGZvcm1hdHRlZE51bWVyaWNGaWVsZHMpLCBfdG9Db25zdW1hYmxlQXJyYXkoZm9ybWF0dGVkRGF0ZUZpZWxkcykpLnNvcnQoc29ydEZpZWxkcyk7CiAgICAgICAgaW5kZXhQYXR0ZXJuRGF0ZUZpZWxkcy5zb3J0KCk7CgogICAgICAgIGlmIChyZXNldERlZmF1bHRzKSB7CiAgICAgICAgICAvLyBXaGVuZXZlciB0aGUgaW5kZXggcGF0dGVybiBjaGFuZ2VzIHdlIGRlZmF1bHQgdG8gdGhlIGZpcnN0IGRhdGUgZmllbGQgaWYgdGhlcmUgaXMgb25lLgogICAgICAgICAgX3RoaXMub25GaWVsZHNDaGFuZ2UoewogICAgICAgICAgICBkYXRlSGlzdG9ncmFtRmllbGQ6IGluZGV4UGF0dGVybkRhdGVGaWVsZHMubGVuZ3RoID8gaW5kZXhQYXR0ZXJuRGF0ZUZpZWxkc1swXSA6IHVuZGVmaW5lZAogICAgICAgICAgfSwgX3N0ZXBzX2NvbmZpZy5TVEVQX0RBVEVfSElTVE9HUkFNKTsKICAgICAgICB9CgogICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgIGluZGV4UGF0dGVybkFzeW5jRXJyb3JzOiBpbmRleFBhdHRlcm5Bc3luY0Vycm9ycywKICAgICAgICAgIGluZGV4UGF0dGVybkRhdGVGaWVsZHM6IGluZGV4UGF0dGVybkRhdGVGaWVsZHMsCiAgICAgICAgICBpbmRleFBhdHRlcm5UZXJtc0ZpZWxkczogaW5kZXhQYXR0ZXJuVGVybXNGaWVsZHMsCiAgICAgICAgICBpbmRleFBhdHRlcm5IaXN0b2dyYW1GaWVsZHM6IGluZGV4UGF0dGVybkhpc3RvZ3JhbUZpZWxkcywKICAgICAgICAgIGluZGV4UGF0dGVybk1ldHJpY3NGaWVsZHM6IGluZGV4UGF0dGVybk1ldHJpY3NGaWVsZHMsCiAgICAgICAgICBpc1ZhbGlkYXRpbmdJbmRleFBhdHRlcm46IGZhbHNlCiAgICAgICAgfSk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgIC8vIFdlIGRvbid0IG5lZWQgdG8gZG8gYW55dGhpbmcgaWYgdGhpcyBjb21wb25lbnQgaGFzIGJlZW4gdW5tb3VudGVkLgogICAgICAgIGlmICghX3RoaXMuX2lzTW91bnRlZCkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0gLy8gSWdub3JlIGFsbCByZXNwb25zZXMgZXhjZXB0IHRoYXQgdG8gdGhlIG1vc3QgcmVjZW50IHJlcXVlc3QuCgoKICAgICAgICBpZiAobGFzdEluZGV4UGF0dGVyblZhbGlkYXRpb25UaW1lICE9PSBfdGhpcy5sYXN0SW5kZXhQYXR0ZXJuVmFsaWRhdGlvblRpbWUpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9IC8vIEV4cGVjdCBhbiBlcnJvciBpbiB0aGUgc2hhcGUgcHJvdmlkZWQgYnkgQW5ndWxhcidzICRodHRwIHNlcnZpY2UuCgoKICAgICAgICBpZiAoZXJyb3IgJiYgZXJyb3IuZGF0YSkgewogICAgICAgICAgdmFyIF9lcnJvciRkYXRhID0gZXJyb3IuZGF0YSwKICAgICAgICAgICAgICBlcnJvclN0cmluZyA9IF9lcnJvciRkYXRhLmVycm9yLAogICAgICAgICAgICAgIHN0YXR1c0NvZGUgPSBfZXJyb3IkZGF0YS5zdGF0dXNDb2RlOwogICAgICAgICAgdmFyIGluZGV4UGF0dGVybkFzeW5jRXJyb3JzID0gW19yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICAgIGlkOiAieHBhY2sucm9sbHVwSm9icy5jcmVhdGUuZXJyb3JzLmluZGV4UGF0dGVyblZhbGlkYXRpb25FcnJvciIsCiAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiVGhlcmUgd2FzIGEgcHJvYmxlbSB2YWxpZGF0aW5nIHRoaXMgaW5kZXggcGF0dGVybjoge3N0YXR1c0NvZGV9IHtlcnJvcn0iLAogICAgICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgICAgICBlcnJvcjogZXJyb3JTdHJpbmcsCiAgICAgICAgICAgICAgc3RhdHVzQ29kZTogc3RhdHVzQ29kZQogICAgICAgICAgICB9CiAgICAgICAgICB9KV07CgogICAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICBpbmRleFBhdHRlcm5Bc3luY0Vycm9yczogaW5kZXhQYXR0ZXJuQXN5bmNFcnJvcnMsCiAgICAgICAgICAgIGluZGV4UGF0dGVybkRhdGVGaWVsZHM6IFtdLAogICAgICAgICAgICBpbmRleFBhdHRlcm5UZXJtc0ZpZWxkczogW10sCiAgICAgICAgICAgIGluZGV4UGF0dGVybkhpc3RvZ3JhbUZpZWxkczogW10sCiAgICAgICAgICAgIGluZGV4UGF0dGVybk1ldHJpY3NGaWVsZHM6IFtdLAogICAgICAgICAgICBpc1ZhbGlkYXRpbmdJbmRleFBhdHRlcm46IGZhbHNlCiAgICAgICAgICB9KTsKCiAgICAgICAgICByZXR1cm47CiAgICAgICAgfSAvLyBUaGlzIGVycm9yIGlzbid0IGFuIEhUVFAgZXJyb3IsIHNvIGxldCB0aGUgZmF0YWwgZXJyb3Igc2NyZWVuIHRlbGwgdGhlIHVzZXIgc29tZXRoaW5nCiAgICAgICAgLy8gdW5leHBlY3RlZCBoYXBwZW5lZC4KCgogICAgICAgICgwLCBfbm90aWZ5LmZhdGFsRXJyb3IpKGVycm9yLCBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2sucm9sbHVwSm9icy5jcmVhdGUuZXJyb3JzLmluZGV4UGF0dGVyblZhbGlkYXRpb25GYXRhbEVycm9yVGl0bGUnLCB7CiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1JvbGx1cCBKb2IgV2l6YXJkIGluZGV4IHBhdHRlcm4gdmFsaWRhdGlvbicKICAgICAgICB9KSk7CiAgICAgIH0pOwogICAgfSwgMzAwKSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiZ29Ub05leHRTdGVwIiwgZnVuY3Rpb24gKCkgewogICAgICBfdGhpcy5nb1RvU3RlcChfdGhpcy5zdGF0ZS5uZXh0U3RlcElkKTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImdvVG9QcmV2aW91c1N0ZXAiLCBmdW5jdGlvbiAoKSB7CiAgICAgIF90aGlzLmdvVG9TdGVwKF90aGlzLnN0YXRlLnByZXZpb3VzU3RlcElkKTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIm9uRmllbGRzQ2hhbmdlIiwgZnVuY3Rpb24gKGZpZWxkcykgewogICAgICB2YXIgY3VycmVudFN0ZXBJZCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogX3RoaXMuc3RhdGUuY3VycmVudFN0ZXBJZDsKICAgICAgdmFyIHN0ZXBzRmllbGRzID0gX3RoaXMuc3RhdGUuc3RlcHNGaWVsZHM7CiAgICAgIHZhciBwcmV2RmllbGRzID0gc3RlcHNGaWVsZHNbY3VycmVudFN0ZXBJZF07CiAgICAgIHZhciBhZmZlY3RlZFN0ZXBzRmllbGRzID0gKDAsIF9zdGVwc19jb25maWcuZ2V0QWZmZWN0ZWRTdGVwc0ZpZWxkcykoZmllbGRzLCBzdGVwc0ZpZWxkcyk7CgogICAgICB2YXIgbmV3RmllbGRzID0gX29iamVjdFNwcmVhZCh7fSwgcHJldkZpZWxkcywge30sIGZpZWxkcyk7CgogICAgICB2YXIgbmV3U3RlcHNGaWVsZHMgPSBfb2JqZWN0U3ByZWFkKHt9LCBhZmZlY3RlZFN0ZXBzRmllbGRzLCBfZGVmaW5lUHJvcGVydHkoe30sIGN1cnJlbnRTdGVwSWQsIG5ld0ZpZWxkcykpOwoKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIHN0ZXBzRmllbGRzOiBuZXdTdGVwc0ZpZWxkcywKICAgICAgICBzdGVwc0ZpZWxkRXJyb3JzOiBfdGhpcy5nZXRTdGVwc0ZpZWxkc0Vycm9ycyhuZXdTdGVwc0ZpZWxkcykKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJzYXZlIiwgZnVuY3Rpb24gKCkgewogICAgICB2YXIgY3JlYXRlSm9iID0gX3RoaXMucHJvcHMuY3JlYXRlSm9iOwoKICAgICAgdmFyIGpvYkNvbmZpZyA9IF90aGlzLmdldEFsbEZpZWxkcygpOwoKICAgICAgY3JlYXRlSm9iKGpvYkNvbmZpZyk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJvblRvZ2dsZVN0YXJ0QWZ0ZXJDcmVhdGUiLCBmdW5jdGlvbiAoZXZlKSB7CiAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICBzdGFydEpvYkFmdGVyQ3JlYXRpb246IGV2ZS50YXJnZXQuY2hlY2tlZAogICAgICB9KTsKICAgIH0pOwoKICAgIF9jaHJvbWUuZGVmYXVsdC5icmVhZGNydW1icy5zZXQoW19tYW5hZ2VtZW50Lk1BTkFHRU1FTlRfQlJFQURDUlVNQiwgX3NlcnZpY2VzLmxpc3RCcmVhZGNydW1iLCBfc2VydmljZXMuY3JlYXRlQnJlYWRjcnVtYl0pOwoKICAgIHZhciBzdGVwRGVmYXVsdE92ZXJyaWRlcyA9IHByb3BzLmpvYlRvQ2xvbmU7CgogICAgdmFyIF9zdGVwc0ZpZWxkcyA9ICgwLCBfbWFwVmFsdWVzLmRlZmF1bHQpKF9zdGVwc19jb25maWcuc3RlcElkVG9TdGVwQ29uZmlnTWFwLCBmdW5jdGlvbiAoc3RlcCkgewogICAgICByZXR1cm4gKDAsIF9jbG9uZURlZXAuZGVmYXVsdCkoc3RlcC5nZXREZWZhdWx0RmllbGRzKHN0ZXBEZWZhdWx0T3ZlcnJpZGVzKSk7CiAgICB9KTsKCiAgICBfdGhpcy5zdGF0ZSA9IHsKICAgICAgam9iVG9DbG9uZTogc3RlcERlZmF1bHRPdmVycmlkZXMgfHwgbnVsbCwKICAgICAgY2hlY2twb2ludFN0ZXBJZDogX3N0ZXBzX2NvbmZpZy5zdGVwSWRzWzBdLAogICAgICBjdXJyZW50U3RlcElkOiBfc3RlcHNfY29uZmlnLnN0ZXBJZHNbMF0sCiAgICAgIG5leHRTdGVwSWQ6IF9zdGVwc19jb25maWcuc3RlcElkc1sxXSwKICAgICAgcHJldmlvdXNTdGVwSWQ6IHVuZGVmaW5lZCwKICAgICAgc3RlcHNGaWVsZEVycm9yczogX3RoaXMuZ2V0U3RlcHNGaWVsZHNFcnJvcnMoX3N0ZXBzRmllbGRzKSwKICAgICAgLy8gU2hvdyBzdGVwIGVycm9ycyBpbW1lZGlhdGVseSBpZiB3ZSBhcmUgY2xvbmluZyBhIGpvYi4KICAgICAgYXJlU3RlcEVycm9yc1Zpc2libGU6ICEhc3RlcERlZmF1bHRPdmVycmlkZXMsCiAgICAgIHN0ZXBzRmllbGRzOiBfc3RlcHNGaWVsZHMsCiAgICAgIGlzVmFsaWRhdGluZ0luZGV4UGF0dGVybjogZmFsc2UsCiAgICAgIGluZGV4UGF0dGVybkFzeW5jRXJyb3JzOiB1bmRlZmluZWQsCiAgICAgIGluZGV4UGF0dGVybkRhdGVGaWVsZHM6IFtdLAogICAgICBpbmRleFBhdHRlcm5UZXJtc0ZpZWxkczogW10sCiAgICAgIGluZGV4UGF0dGVybkhpc3RvZ3JhbUZpZWxkczogW10sCiAgICAgIGluZGV4UGF0dGVybk1ldHJpY3NGaWVsZHM6IFtdLAogICAgICBzdGFydEpvYkFmdGVyQ3JlYXRpb246IGZhbHNlCiAgICB9OwogICAgX3RoaXMubGFzdEluZGV4UGF0dGVyblZhbGlkYXRpb25UaW1lID0gMDsKICAgIHJldHVybiBfdGhpczsKICB9CgogIF9jcmVhdGVDbGFzcyhKb2JDcmVhdGVVaSwgW3sKICAgIGtleTogImNvbXBvbmVudERpZE1vdW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnREaWRNb3VudCgpIHsKICAgICAgdGhpcy5faXNNb3VudGVkID0gdHJ1ZTsKICAgICAgdmFyIF90aGlzJHByb3BzID0gdGhpcy5wcm9wcywKICAgICAgICAgIGNsZWFyQ2xvbmVKb2IgPSBfdGhpcyRwcm9wcy5jbGVhckNsb25lSm9iLAogICAgICAgICAgam9iVG9DbG9uZSA9IF90aGlzJHByb3BzLmpvYlRvQ2xvbmU7CgogICAgICBpZiAoam9iVG9DbG9uZSkgewogICAgICAgIGNsZWFyQ2xvbmVKb2IoKTsKICAgICAgICB0aGlzLnJlcXVlc3RJbmRleFBhdHRlcm5WYWxpZGF0aW9uKGZhbHNlKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogImNvbXBvbmVudERpZFVwZGF0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50RGlkVXBkYXRlKHByZXZQcm9wcywgcHJldlN0YXRlKSB7CiAgICAgIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnMKICAgICAgdmFyIGluZGV4UGF0dGVybiA9IHRoaXMuZ2V0SW5kZXhQYXR0ZXJuKCk7CgogICAgICBpZiAoaW5kZXhQYXR0ZXJuICE9PSB0aGlzLmdldEluZGV4UGF0dGVybihwcmV2U3RhdGUpKSB7CiAgICAgICAgLy8gSWYgdGhlIHVzZXIgaGFzbid0IGVudGVyZWQgYW55dGhpbmcsIHRoZW4gc2tpcCB2YWxpZGF0aW9uLgogICAgICAgIGlmICghaW5kZXhQYXR0ZXJuIHx8ICFpbmRleFBhdHRlcm4udHJpbSgpKSB7CiAgICAgICAgICB0aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgaW5kZXhQYXR0ZXJuQXN5bmNFcnJvcnM6IHVuZGVmaW5lZCwKICAgICAgICAgICAgaW5kZXhQYXR0ZXJuRGF0ZUZpZWxkczogW10sCiAgICAgICAgICAgIGlzVmFsaWRhdGluZ0luZGV4UGF0dGVybjogZmFsc2UKICAgICAgICAgIH0pOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0gLy8gU2V0IHRoZSBzdGF0ZSBvdXRzaWRlIG9mIGByZXF1ZXN0SW5kZXhQYXR0ZXJuVmFsaWRhdGlvbmAsIGJlY2F1c2UgdGhhdCBmdW5jdGlvbiBpcwogICAgICAgIC8vIGRlYm91bmNlZC4KCgogICAgICAgIHRoaXMuc2V0U3RhdGUoewogICAgICAgICAgaXNWYWxpZGF0aW5nSW5kZXhQYXR0ZXJuOiB0cnVlCiAgICAgICAgfSk7CiAgICAgICAgdGhpcy5yZXF1ZXN0SW5kZXhQYXR0ZXJuVmFsaWRhdGlvbigpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAiY29tcG9uZW50V2lsbFVubW91bnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxVbm1vdW50KCkgewogICAgICB0aGlzLl9pc01vdW50ZWQgPSBmYWxzZTsgLy8gQ2xlYW4gdXAgYWZ0ZXIgb3Vyc2VsdmVzLgoKICAgICAgdGhpcy5wcm9wcy5jbGVhckNyZWF0ZUpvYkVycm9ycygpOwogICAgfQogIH0sIHsKICAgIGtleTogImdldFN0ZXBzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRTdGVwcygpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB2YXIgX3RoaXMkc3RhdGUyID0gdGhpcy5zdGF0ZSwKICAgICAgICAgIGN1cnJlbnRTdGVwSWQgPSBfdGhpcyRzdGF0ZTIuY3VycmVudFN0ZXBJZCwKICAgICAgICAgIGNoZWNrcG9pbnRTdGVwSWQgPSBfdGhpcyRzdGF0ZTIuY2hlY2twb2ludFN0ZXBJZDsKCiAgICAgIHZhciBpbmRleE9mQ3VycmVudFN0ZXAgPSBfc3RlcHNfY29uZmlnLnN0ZXBJZHMuaW5kZXhPZihjdXJyZW50U3RlcElkKTsKCiAgICAgIHJldHVybiBfc3RlcHNfY29uZmlnLnN0ZXBJZHMubWFwKGZ1bmN0aW9uIChzdGVwSWQsIGluZGV4KSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIHRpdGxlOiBzdGVwSWRUb1RpdGxlTWFwW3N0ZXBJZF0sCiAgICAgICAgICBpc0NvbXBsZXRlOiBpbmRleCA8IGluZGV4T2ZDdXJyZW50U3RlcCwKICAgICAgICAgIGlzU2VsZWN0ZWQ6IGluZGV4ID09PSBpbmRleE9mQ3VycmVudFN0ZXAsCiAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgICByZXR1cm4gX3RoaXMyLmdvVG9TdGVwKHN0ZXBJZCk7CiAgICAgICAgICB9LAogICAgICAgICAgZGlzYWJsZWQ6ICFfdGhpczIuY2FuR29Ub1N0ZXAoc3RlcElkKSB8fCBfc3RlcHNfY29uZmlnLnN0ZXBJZHMuaW5kZXhPZihzdGVwSWQpID4gX3N0ZXBzX2NvbmZpZy5zdGVwSWRzLmluZGV4T2YoY2hlY2twb2ludFN0ZXBJZCksCiAgICAgICAgICAnZGF0YS10ZXN0LXN1YmonOiBpbmRleCA9PT0gaW5kZXhPZkN1cnJlbnRTdGVwID8gImNyZWF0ZVJvbGx1cFN0ZXAiLmNvbmNhdChpbmRleCArIDEsICItLWFjdGl2ZSIpIDogImNyZWF0ZVJvbGx1cFN0ZXAiLmNvbmNhdChpbmRleCArIDEpCiAgICAgICAgfTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ29Ub1N0ZXAiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdvVG9TdGVwKHN0ZXBJZCkgewogICAgICAvLyBJbnN0ZWFkIG9mIGRpc2FibGluZyB0aGUgTmV4dCBidXR0b24gd2hpbGUgdGhlIHN0ZXAgaXMgaW52YWxpZCwgd2UKICAgICAgLy8gaW5zdGVhZCBhbGxvdyB0aGUgdXNlciB0byBjbGljayB0aGUgTmV4dCBidXR0b24sIHByZXZlbnQgdGhlbSBsZWF2aW5nCiAgICAgIC8vIHRoaXMgc3RlcCwgYW5kIHJlbmRlciBhIGdsb2JhbCBlcnJvciBtZXNzYWdlIHRvIGNsZWFybHkgY29udmV5IHRoZQogICAgICAvLyBlcnJvci4KICAgICAgaWYgKCF0aGlzLmNhbkdvVG9TdGVwKHN0ZXBJZCkpIHsKICAgICAgICB0aGlzLnNldFN0YXRlKHsKICAgICAgICAgIGFyZVN0ZXBFcnJvcnNWaXNpYmxlOiB0cnVlCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgY3VycmVudFN0ZXBJbmRleCA9IF9zdGVwc19jb25maWcuc3RlcElkcy5pbmRleE9mKHN0ZXBJZCk7CgogICAgICB0aGlzLnNldFN0YXRlKHsKICAgICAgICBjdXJyZW50U3RlcElkOiBzdGVwSWQsCiAgICAgICAgbmV4dFN0ZXBJZDogX3N0ZXBzX2NvbmZpZy5zdGVwSWRzW2N1cnJlbnRTdGVwSW5kZXggKyAxXSwKICAgICAgICBwcmV2aW91c1N0ZXBJZDogX3N0ZXBzX2NvbmZpZy5zdGVwSWRzW2N1cnJlbnRTdGVwSW5kZXggLSAxXSwKICAgICAgICBhcmVTdGVwRXJyb3JzVmlzaWJsZTogZmFsc2UsCiAgICAgICAgaXNTYXZpbmc6IGZhbHNlCiAgICAgIH0pOwoKICAgICAgaWYgKF9zdGVwc19jb25maWcuc3RlcElkcy5pbmRleE9mKHN0ZXBJZCkgPiBfc3RlcHNfY29uZmlnLnN0ZXBJZHMuaW5kZXhPZih0aGlzLnN0YXRlLmNoZWNrcG9pbnRTdGVwSWQpKSB7CiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICBjaGVja3BvaW50U3RlcElkOiBzdGVwSWQKICAgICAgICB9KTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogImNhbkdvVG9TdGVwIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjYW5Hb1RvU3RlcChzdGVwSWQpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICB2YXIgaW5kZXhPZlN0ZXAgPSBfc3RlcHNfY29uZmlnLnN0ZXBJZHMuaW5kZXhPZihzdGVwSWQpOyAvLyBDaGVjayBldmVyeSBzdGVwIGJlZm9yZSB0aGlzIG9uZSBhbmQgc2VlIGlmIGl0J3MgYmVlbiBjb21wbGV0ZWQuCgoKICAgICAgdmFyIHByZXJlcXVpc2l0ZVN0ZXBzID0gX3N0ZXBzX2NvbmZpZy5zdGVwSWRzLnNsaWNlKDAsIGluZGV4T2ZTdGVwKTsKCiAgICAgIHJldHVybiBwcmVyZXF1aXNpdGVTdGVwcy5ldmVyeShmdW5jdGlvbiAocHJlcmVxdWlzaXRlU3RlcElkKSB7CiAgICAgICAgcmV0dXJuICFfdGhpczMuaGFzU3RlcEVycm9ycyhwcmVyZXF1aXNpdGVTdGVwSWQpOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJoYXNTdGVwRXJyb3JzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBoYXNTdGVwRXJyb3JzKHN0ZXBJZCkgewogICAgICB2YXIgX3RoaXMkc3RhdGUzID0gdGhpcy5zdGF0ZSwKICAgICAgICAgIGluZGV4UGF0dGVybkFzeW5jRXJyb3JzID0gX3RoaXMkc3RhdGUzLmluZGV4UGF0dGVybkFzeW5jRXJyb3JzLAogICAgICAgICAgc3RlcHNGaWVsZEVycm9ycyA9IF90aGlzJHN0YXRlMy5zdGVwc0ZpZWxkRXJyb3JzOwoKICAgICAgaWYgKHN0ZXBJZCA9PT0gX3N0ZXBzX2NvbmZpZy5TVEVQX0xPR0lTVElDUykgewogICAgICAgIGlmIChCb29sZWFuKGluZGV4UGF0dGVybkFzeW5jRXJyb3JzKSkgewogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgc3RlcEZpZWxkRXJyb3JzID0gc3RlcHNGaWVsZEVycm9yc1tzdGVwSWRdOwogICAgICByZXR1cm4gT2JqZWN0LnZhbHVlcyhzdGVwRmllbGRFcnJvcnMpLnNvbWUoZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgcmV0dXJuIGVycm9yICE9IG51bGw7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogImdldFN0ZXBzRmllbGRzRXJyb3JzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRTdGVwc0ZpZWxkc0Vycm9ycyhuZXdTdGVwc0ZpZWxkcykgewogICAgICByZXR1cm4gT2JqZWN0LmtleXMobmV3U3RlcHNGaWVsZHMpLnJlZHVjZShmdW5jdGlvbiAoc3RlcHNGaWVsZEVycm9ycywgc3RlcElkKSB7CiAgICAgICAgdmFyIHN0ZXBGaWVsZHMgPSBuZXdTdGVwc0ZpZWxkc1tzdGVwSWRdOwogICAgICAgIHZhciBmaWVsZHNWYWxpZGF0b3IgPSBfc3RlcHNfY29uZmlnLnN0ZXBJZFRvU3RlcENvbmZpZ01hcFtzdGVwSWRdLmZpZWxkc1ZhbGlkYXRvcjsKICAgICAgICBzdGVwc0ZpZWxkRXJyb3JzW3N0ZXBJZF0gPSB0eXBlb2YgZmllbGRzVmFsaWRhdG9yID09PSAiZnVuY3Rpb24iID8gZmllbGRzVmFsaWRhdG9yKHN0ZXBGaWVsZHMpIDoge307CiAgICAgICAgcmV0dXJuIHN0ZXBzRmllbGRFcnJvcnM7CiAgICAgIH0sIHt9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRBbGxGaWVsZHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEFsbEZpZWxkcygpIHsKICAgICAgdmFyIF90aGlzJHN0YXRlNCA9IHRoaXMuc3RhdGUsCiAgICAgICAgICBfdGhpcyRzdGF0ZTQkc3RlcHNGaWUgPSBfdGhpcyRzdGF0ZTQuc3RlcHNGaWVsZHMsCiAgICAgICAgICBfdGhpcyRzdGF0ZTQkc3RlcHNGaWUyID0gX3RoaXMkc3RhdGU0JHN0ZXBzRmllW19zdGVwc19jb25maWcuU1RFUF9MT0dJU1RJQ1NdLAogICAgICAgICAgaWQgPSBfdGhpcyRzdGF0ZTQkc3RlcHNGaWUyLmlkLAogICAgICAgICAgaW5kZXhQYXR0ZXJuID0gX3RoaXMkc3RhdGU0JHN0ZXBzRmllMi5pbmRleFBhdHRlcm4sCiAgICAgICAgICByb2xsdXBJbmRleCA9IF90aGlzJHN0YXRlNCRzdGVwc0ZpZTIucm9sbHVwSW5kZXgsCiAgICAgICAgICByb2xsdXBDcm9uID0gX3RoaXMkc3RhdGU0JHN0ZXBzRmllMi5yb2xsdXBDcm9uLAogICAgICAgICAgcm9sbHVwRGVsYXkgPSBfdGhpcyRzdGF0ZTQkc3RlcHNGaWUyLnJvbGx1cERlbGF5LAogICAgICAgICAgcm9sbHVwUGFnZVNpemUgPSBfdGhpcyRzdGF0ZTQkc3RlcHNGaWUyLnJvbGx1cFBhZ2VTaXplLAogICAgICAgICAgX3RoaXMkc3RhdGU0JHN0ZXBzRmllMyA9IF90aGlzJHN0YXRlNCRzdGVwc0ZpZVtfc3RlcHNfY29uZmlnLlNURVBfREFURV9ISVNUT0dSQU1dLAogICAgICAgICAgZGF0ZUhpc3RvZ3JhbUludGVydmFsID0gX3RoaXMkc3RhdGU0JHN0ZXBzRmllMy5kYXRlSGlzdG9ncmFtSW50ZXJ2YWwsCiAgICAgICAgICBkYXRlSGlzdG9ncmFtVGltZVpvbmUgPSBfdGhpcyRzdGF0ZTQkc3RlcHNGaWUzLmRhdGVIaXN0b2dyYW1UaW1lWm9uZSwKICAgICAgICAgIGRhdGVIaXN0b2dyYW1GaWVsZCA9IF90aGlzJHN0YXRlNCRzdGVwc0ZpZTMuZGF0ZUhpc3RvZ3JhbUZpZWxkLAogICAgICAgICAgdGVybXMgPSBfdGhpcyRzdGF0ZTQkc3RlcHNGaWVbX3N0ZXBzX2NvbmZpZy5TVEVQX1RFUk1TXS50ZXJtcywKICAgICAgICAgIF90aGlzJHN0YXRlNCRzdGVwc0ZpZTQgPSBfdGhpcyRzdGF0ZTQkc3RlcHNGaWVbX3N0ZXBzX2NvbmZpZy5TVEVQX0hJU1RPR1JBTV0sCiAgICAgICAgICBoaXN0b2dyYW0gPSBfdGhpcyRzdGF0ZTQkc3RlcHNGaWU0Lmhpc3RvZ3JhbSwKICAgICAgICAgIGhpc3RvZ3JhbUludGVydmFsID0gX3RoaXMkc3RhdGU0JHN0ZXBzRmllNC5oaXN0b2dyYW1JbnRlcnZhbCwKICAgICAgICAgIG1ldHJpY3MgPSBfdGhpcyRzdGF0ZTQkc3RlcHNGaWVbX3N0ZXBzX2NvbmZpZy5TVEVQX01FVFJJQ1NdLm1ldHJpY3M7CgogICAgICBfb2JqZWN0RGVzdHJ1Y3R1cmluZ0VtcHR5KF90aGlzJHN0YXRlNCRzdGVwc0ZpZVtfc3RlcHNfY29uZmlnLlNURVBfUkVWSUVXXSk7CgogICAgICB2YXIgc3RhcnRKb2JBZnRlckNyZWF0aW9uID0gX3RoaXMkc3RhdGU0LnN0YXJ0Sm9iQWZ0ZXJDcmVhdGlvbjsKICAgICAgcmV0dXJuIHsKICAgICAgICBpZDogaWQsCiAgICAgICAgaW5kZXhQYXR0ZXJuOiBpbmRleFBhdHRlcm4sCiAgICAgICAgcm9sbHVwSW5kZXg6IHJvbGx1cEluZGV4LAogICAgICAgIHJvbGx1cENyb246IHJvbGx1cENyb24sCiAgICAgICAgcm9sbHVwUGFnZVNpemU6IHJvbGx1cFBhZ2VTaXplLAogICAgICAgIHJvbGx1cERlbGF5OiByb2xsdXBEZWxheSwKICAgICAgICBkYXRlSGlzdG9ncmFtSW50ZXJ2YWw6IGRhdGVIaXN0b2dyYW1JbnRlcnZhbCwKICAgICAgICBkYXRlSGlzdG9ncmFtVGltZVpvbmU6IGRhdGVIaXN0b2dyYW1UaW1lWm9uZSwKICAgICAgICBkYXRlSGlzdG9ncmFtRmllbGQ6IGRhdGVIaXN0b2dyYW1GaWVsZCwKICAgICAgICB0ZXJtczogdGVybXMsCiAgICAgICAgaGlzdG9ncmFtOiBoaXN0b2dyYW0sCiAgICAgICAgaGlzdG9ncmFtSW50ZXJ2YWw6IGhpc3RvZ3JhbUludGVydmFsLAogICAgICAgIG1ldHJpY3M6IG1ldHJpY3MsCiAgICAgICAgc3RhcnRKb2JBZnRlckNyZWF0aW9uOiBzdGFydEpvYkFmdGVyQ3JlYXRpb24KICAgICAgfTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRJbmRleFBhdHRlcm4iLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEluZGV4UGF0dGVybigpIHsKICAgICAgdmFyIHN0YXRlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB0aGlzLnN0YXRlOwogICAgICByZXR1cm4gc3RhdGUuc3RlcHNGaWVsZHNbX3N0ZXBzX2NvbmZpZy5TVEVQX0xPR0lTVElDU10uaW5kZXhQYXR0ZXJuOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkgewogICAgICB2YXIgX3RoaXMkcHJvcHMyID0gdGhpcy5wcm9wcywKICAgICAgICAgIGlzU2F2aW5nID0gX3RoaXMkcHJvcHMyLmlzU2F2aW5nLAogICAgICAgICAgc2F2ZUVycm9yID0gX3RoaXMkcHJvcHMyLnNhdmVFcnJvcjsKICAgICAgdmFyIHNhdmluZ0ZlZWRiYWNrOwoKICAgICAgaWYgKGlzU2F2aW5nKSB7CiAgICAgICAgc2F2aW5nRmVlZGJhY2sgPSBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpT3ZlcmxheU1hc2ssIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlMb2FkaW5nS2liYW5hLCB7CiAgICAgICAgICBzaXplOiAieGwiCiAgICAgICAgfSkpOwogICAgICB9CgogICAgICB2YXIgc2F2ZUVycm9yRmVlZGJhY2s7CgogICAgICBpZiAoc2F2ZUVycm9yKSB7CiAgICAgICAgdmFyIG1lc3NhZ2UgPSBzYXZlRXJyb3IubWVzc2FnZSwKICAgICAgICAgICAgY2F1c2UgPSBzYXZlRXJyb3IuY2F1c2U7CiAgICAgICAgdmFyIGVycm9yQm9keTsKCiAgICAgICAgaWYgKGNhdXNlKSB7CiAgICAgICAgICBpZiAoY2F1c2UubGVuZ3RoID09PSAxKSB7CiAgICAgICAgICAgIGVycm9yQm9keSA9IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoInAiLCBudWxsLCBjYXVzZVswXSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBlcnJvckJvZHkgPSBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJ1bCIsIG51bGwsIGNhdXNlLm1hcChmdW5jdGlvbiAoY2F1c2VWYWx1ZSkgewogICAgICAgICAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJsaSIsIHsKICAgICAgICAgICAgICAgIGtleTogY2F1c2VWYWx1ZQogICAgICAgICAgICAgIH0sIGNhdXNlVmFsdWUpOwogICAgICAgICAgICB9KSk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBzYXZlRXJyb3JGZWVkYmFjayA9IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LkZyYWdtZW50LCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQ2FsbE91dCwgewogICAgICAgICAgdGl0bGU6IG1lc3NhZ2UsCiAgICAgICAgICBpY29uOiAiY3Jvc3MiLAogICAgICAgICAgY29sb3I6ICJkYW5nZXIiCiAgICAgICAgfSwgZXJyb3JCb2R5KSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgbnVsbCkpOwogICAgICB9CgogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRnJhZ21lbnQsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlQYWdlQ29udGVudCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVBhZ2VDb250ZW50SGVhZGVyLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVGl0bGUsIHsKICAgICAgICBzaXplOiAibCIKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgiaDEiLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAieHBhY2sucm9sbHVwSm9icy5jcmVhdGVUaXRsZSIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJDcmVhdGUgcm9sbHVwIGpvYiIKICAgICAgfSkpKSksIHNhdmVFcnJvckZlZWRiYWNrLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3RlcHNIb3Jpem9udGFsLCB7CiAgICAgICAgc3RlcHM6IHRoaXMuZ2V0U3RlcHMoKQogICAgICB9KSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgbnVsbCksIHRoaXMucmVuZGVyQ3VycmVudFN0ZXAoKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgewogICAgICAgIHNpemU6ICJsIgogICAgICB9KSwgdGhpcy5yZW5kZXJOYXZpZ2F0aW9uKCkpLCBzYXZpbmdGZWVkYmFjayk7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVuZGVyQ3VycmVudFN0ZXAiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlckN1cnJlbnRTdGVwKCkgewogICAgICB2YXIgX3RoaXMkc3RhdGU1ID0gdGhpcy5zdGF0ZSwKICAgICAgICAgIGN1cnJlbnRTdGVwSWQgPSBfdGhpcyRzdGF0ZTUuY3VycmVudFN0ZXBJZCwKICAgICAgICAgIHN0ZXBzRmllbGRzID0gX3RoaXMkc3RhdGU1LnN0ZXBzRmllbGRzLAogICAgICAgICAgc3RlcHNGaWVsZEVycm9ycyA9IF90aGlzJHN0YXRlNS5zdGVwc0ZpZWxkRXJyb3JzLAogICAgICAgICAgYXJlU3RlcEVycm9yc1Zpc2libGUgPSBfdGhpcyRzdGF0ZTUuYXJlU3RlcEVycm9yc1Zpc2libGUsCiAgICAgICAgICBpc1ZhbGlkYXRpbmdJbmRleFBhdHRlcm4gPSBfdGhpcyRzdGF0ZTUuaXNWYWxpZGF0aW5nSW5kZXhQYXR0ZXJuLAogICAgICAgICAgaW5kZXhQYXR0ZXJuRGF0ZUZpZWxkcyA9IF90aGlzJHN0YXRlNS5pbmRleFBhdHRlcm5EYXRlRmllbGRzLAogICAgICAgICAgaW5kZXhQYXR0ZXJuQXN5bmNFcnJvcnMgPSBfdGhpcyRzdGF0ZTUuaW5kZXhQYXR0ZXJuQXN5bmNFcnJvcnMsCiAgICAgICAgICBpbmRleFBhdHRlcm5UZXJtc0ZpZWxkcyA9IF90aGlzJHN0YXRlNS5pbmRleFBhdHRlcm5UZXJtc0ZpZWxkcywKICAgICAgICAgIGluZGV4UGF0dGVybkhpc3RvZ3JhbUZpZWxkcyA9IF90aGlzJHN0YXRlNS5pbmRleFBhdHRlcm5IaXN0b2dyYW1GaWVsZHMsCiAgICAgICAgICBpbmRleFBhdHRlcm5NZXRyaWNzRmllbGRzID0gX3RoaXMkc3RhdGU1LmluZGV4UGF0dGVybk1ldHJpY3NGaWVsZHM7CiAgICAgIHZhciBjdXJyZW50U3RlcEZpZWxkcyA9IHN0ZXBzRmllbGRzW2N1cnJlbnRTdGVwSWRdOwogICAgICB2YXIgY3VycmVudFN0ZXBGaWVsZEVycm9ycyA9IHN0ZXBzRmllbGRFcnJvcnNbY3VycmVudFN0ZXBJZF07CgogICAgICBzd2l0Y2ggKGN1cnJlbnRTdGVwSWQpIHsKICAgICAgICBjYXNlIF9zdGVwc19jb25maWcuU1RFUF9MT0dJU1RJQ1M6CiAgICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfc3RlcHMuU3RlcExvZ2lzdGljcywgewogICAgICAgICAgICBmaWVsZHM6IGN1cnJlbnRTdGVwRmllbGRzLAogICAgICAgICAgICBvbkZpZWxkc0NoYW5nZTogdGhpcy5vbkZpZWxkc0NoYW5nZSwKICAgICAgICAgICAgZmllbGRFcnJvcnM6IGN1cnJlbnRTdGVwRmllbGRFcnJvcnMsCiAgICAgICAgICAgIGhhc0Vycm9yczogKDAsIF9zdGVwc19jb25maWcuaGFzRXJyb3JzKShjdXJyZW50U3RlcEZpZWxkRXJyb3JzKSwKICAgICAgICAgICAgYXJlU3RlcEVycm9yc1Zpc2libGU6IGFyZVN0ZXBFcnJvcnNWaXNpYmxlLAogICAgICAgICAgICBpc1ZhbGlkYXRpbmdJbmRleFBhdHRlcm46IGlzVmFsaWRhdGluZ0luZGV4UGF0dGVybiwKICAgICAgICAgICAgaW5kZXhQYXR0ZXJuQXN5bmNFcnJvcnM6IGluZGV4UGF0dGVybkFzeW5jRXJyb3JzLAogICAgICAgICAgICBoYXNNYXRjaGluZ0luZGljZXM6IEJvb2xlYW4oaW5kZXhQYXR0ZXJuRGF0ZUZpZWxkcy5sZW5ndGgpCiAgICAgICAgICB9KTsKCiAgICAgICAgY2FzZSBfc3RlcHNfY29uZmlnLlNURVBfREFURV9ISVNUT0dSQU06CiAgICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfc3RlcHMuU3RlcERhdGVIaXN0b2dyYW0sIHsKICAgICAgICAgICAgaW5kZXhQYXR0ZXJuOiB0aGlzLmdldEluZGV4UGF0dGVybigpLAogICAgICAgICAgICBmaWVsZHM6IGN1cnJlbnRTdGVwRmllbGRzLAogICAgICAgICAgICBvbkZpZWxkc0NoYW5nZTogdGhpcy5vbkZpZWxkc0NoYW5nZSwKICAgICAgICAgICAgZmllbGRFcnJvcnM6IGN1cnJlbnRTdGVwRmllbGRFcnJvcnMsCiAgICAgICAgICAgIGhhc0Vycm9yczogKDAsIF9zdGVwc19jb25maWcuaGFzRXJyb3JzKShjdXJyZW50U3RlcEZpZWxkRXJyb3JzKSwKICAgICAgICAgICAgYXJlU3RlcEVycm9yc1Zpc2libGU6IGFyZVN0ZXBFcnJvcnNWaXNpYmxlLAogICAgICAgICAgICBkYXRlRmllbGRzOiBpbmRleFBhdHRlcm5EYXRlRmllbGRzCiAgICAgICAgICB9KTsKCiAgICAgICAgY2FzZSBfc3RlcHNfY29uZmlnLlNURVBfVEVSTVM6CiAgICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfc3RlcHMuU3RlcFRlcm1zLCB7CiAgICAgICAgICAgIGZpZWxkczogY3VycmVudFN0ZXBGaWVsZHMsCiAgICAgICAgICAgIG9uRmllbGRzQ2hhbmdlOiB0aGlzLm9uRmllbGRzQ2hhbmdlLAogICAgICAgICAgICB0ZXJtc0ZpZWxkczogaW5kZXhQYXR0ZXJuVGVybXNGaWVsZHMKICAgICAgICAgIH0pOwoKICAgICAgICBjYXNlIF9zdGVwc19jb25maWcuU1RFUF9ISVNUT0dSQU06CiAgICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfc3RlcHMuU3RlcEhpc3RvZ3JhbSwgewogICAgICAgICAgICBmaWVsZHM6IGN1cnJlbnRTdGVwRmllbGRzLAogICAgICAgICAgICBvbkZpZWxkc0NoYW5nZTogdGhpcy5vbkZpZWxkc0NoYW5nZSwKICAgICAgICAgICAgZmllbGRFcnJvcnM6IGN1cnJlbnRTdGVwRmllbGRFcnJvcnMsCiAgICAgICAgICAgIGhhc0Vycm9yczogKDAsIF9zdGVwc19jb25maWcuaGFzRXJyb3JzKShjdXJyZW50U3RlcEZpZWxkRXJyb3JzKSwKICAgICAgICAgICAgYXJlU3RlcEVycm9yc1Zpc2libGU6IGFyZVN0ZXBFcnJvcnNWaXNpYmxlLAogICAgICAgICAgICBoaXN0b2dyYW1GaWVsZHM6IGluZGV4UGF0dGVybkhpc3RvZ3JhbUZpZWxkcwogICAgICAgICAgfSk7CgogICAgICAgIGNhc2UgX3N0ZXBzX2NvbmZpZy5TVEVQX01FVFJJQ1M6CiAgICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfc3RlcHMuU3RlcE1ldHJpY3MsIHsKICAgICAgICAgICAgZmllbGRzOiBjdXJyZW50U3RlcEZpZWxkcywKICAgICAgICAgICAgb25GaWVsZHNDaGFuZ2U6IHRoaXMub25GaWVsZHNDaGFuZ2UsCiAgICAgICAgICAgIGZpZWxkRXJyb3JzOiBjdXJyZW50U3RlcEZpZWxkRXJyb3JzLAogICAgICAgICAgICBhcmVTdGVwRXJyb3JzVmlzaWJsZTogYXJlU3RlcEVycm9yc1Zpc2libGUsCiAgICAgICAgICAgIG1ldHJpY3NGaWVsZHM6IGluZGV4UGF0dGVybk1ldHJpY3NGaWVsZHMKICAgICAgICAgIH0pOwoKICAgICAgICBjYXNlIF9zdGVwc19jb25maWcuU1RFUF9SRVZJRVc6CiAgICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfc3RlcHMuU3RlcFJldmlldywgewogICAgICAgICAgICBqb2I6IHRoaXMuZ2V0QWxsRmllbGRzKCkKICAgICAgICAgIH0pOwoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXJOYXZpZ2F0aW9uIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJOYXZpZ2F0aW9uKCkgewogICAgICB2YXIgX3RoaXMkc3RhdGU2ID0gdGhpcy5zdGF0ZSwKICAgICAgICAgIGlzVmFsaWRhdGluZ0luZGV4UGF0dGVybiA9IF90aGlzJHN0YXRlNi5pc1ZhbGlkYXRpbmdJbmRleFBhdHRlcm4sCiAgICAgICAgICBuZXh0U3RlcElkID0gX3RoaXMkc3RhdGU2Lm5leHRTdGVwSWQsCiAgICAgICAgICBwcmV2aW91c1N0ZXBJZCA9IF90aGlzJHN0YXRlNi5wcmV2aW91c1N0ZXBJZCwKICAgICAgICAgIGFyZVN0ZXBFcnJvcnNWaXNpYmxlID0gX3RoaXMkc3RhdGU2LmFyZVN0ZXBFcnJvcnNWaXNpYmxlLAogICAgICAgICAgc3RhcnRKb2JBZnRlckNyZWF0aW9uID0gX3RoaXMkc3RhdGU2LnN0YXJ0Sm9iQWZ0ZXJDcmVhdGlvbjsKICAgICAgdmFyIGlzU2F2aW5nID0gdGhpcy5wcm9wcy5pc1NhdmluZzsKICAgICAgdmFyIGhhc05leHRTdGVwID0gbmV4dFN0ZXBJZCAhPSBudWxsOyAvLyBVc2VycyBjYW4gY2xpY2sgdGhlIG5leHQgc3RlcCBidXR0b24gYXMgbG9uZyBhcyB2YWxpZGF0aW9uIGhhc24ndCBleGVjdXRlZCwgYW5kIGFzIGxvbmcKICAgICAgLy8gYXMgd2UncmUgbm90IHdhaXRpbmcgb24gYXN5bmMgdmFsaWRhdGlvbiB0byBjb21wbGV0ZS4KCiAgICAgIHZhciBjYW5Hb1RvTmV4dFN0ZXAgPSAhaXNWYWxpZGF0aW5nSW5kZXhQYXR0ZXJuICYmIGhhc05leHRTdGVwICYmICghYXJlU3RlcEVycm9yc1Zpc2libGUgfHwgdGhpcy5jYW5Hb1RvU3RlcChuZXh0U3RlcElkKSk7CiAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9uYXZpZ2F0aW9uLk5hdmlnYXRpb24sIHsKICAgICAgICBpc1NhdmluZzogaXNTYXZpbmcsCiAgICAgICAgaGFzTmV4dFN0ZXA6IGhhc05leHRTdGVwLAogICAgICAgIGhhc1ByZXZpb3VzU3RlcDogcHJldmlvdXNTdGVwSWQgIT0gbnVsbCwKICAgICAgICBnb1RvTmV4dFN0ZXA6IHRoaXMuZ29Ub05leHRTdGVwLAogICAgICAgIGdvVG9QcmV2aW91c1N0ZXA6IHRoaXMuZ29Ub1ByZXZpb3VzU3RlcCwKICAgICAgICBjYW5Hb1RvTmV4dFN0ZXA6IGNhbkdvVG9OZXh0U3RlcCwKICAgICAgICBzYXZlOiB0aGlzLnNhdmUsCiAgICAgICAgb25DbGlja1RvZ2dsZVN0YXJ0OiB0aGlzLm9uVG9nZ2xlU3RhcnRBZnRlckNyZWF0ZSwKICAgICAgICBzdGFydEpvYkFmdGVyQ3JlYXRpb246IHN0YXJ0Sm9iQWZ0ZXJDcmVhdGlvbgogICAgICB9KTsKICAgIH0KICB9XSk7CgogIHJldHVybiBKb2JDcmVhdGVVaTsKfShfcmVhY3QuQ29tcG9uZW50KTsKCmV4cG9ydHMuSm9iQ3JlYXRlVWkgPSBKb2JDcmVhdGVVaTsKCl9kZWZpbmVQcm9wZXJ0eShKb2JDcmVhdGVVaSwgInByb3BUeXBlcyIsIHsKICBjcmVhdGVKb2I6IF9wcm9wVHlwZXMuZGVmYXVsdC5mdW5jLAogIGNsZWFyQ2xvbmVKb2I6IF9wcm9wVHlwZXMuZGVmYXVsdC5mdW5jLAogIGlzU2F2aW5nOiBfcHJvcFR5cGVzLmRlZmF1bHQuYm9vbCwKICBjcmVhdGVKb2JFcnJvcjogX3Byb3BUeXBlcy5kZWZhdWx0Lm5vZGUsCiAgam9iVG9DbG9uZTogX3Byb3BUeXBlcy5kZWZhdWx0Lm9iamVjdAp9KTsKCnZhciBKb2JDcmVhdGUgPSAoMCwgX3JlYWN0Mi5pbmplY3RJMThuKShKb2JDcmVhdGVVaSk7CmV4cG9ydHMuSm9iQ3JlYXRlID0gSm9iQ3JlYXRlOw=="},null]}