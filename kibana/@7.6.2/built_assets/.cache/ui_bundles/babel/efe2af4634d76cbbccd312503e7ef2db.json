{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/ml/public/application/components/rule_editor/select_rule_action/rule_action_panel.js","dependencies":[{"path":"x-pack/legacy/plugins/ml/public/application/components/rule_editor/select_rule_action/rule_action_panel.js","mtime":1585205045529},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLlJ1bGVBY3Rpb25QYW5lbCA9IHZvaWQgMDsKCnZhciBfcHJvcFR5cGVzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJwcm9wLXR5cGVzIikpOwoKdmFyIF9yZWFjdCA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoInJlYWN0IikpOwoKdmFyIF9ldWkgPSByZXF1aXJlKCJAZWxhc3RpYy9ldWkiKTsKCnZhciBfbG9kYXNoID0gcmVxdWlyZSgibG9kYXNoIik7Cgp2YXIgX2FkZF90b19maWx0ZXJfbGlzdF9saW5rID0gcmVxdWlyZSgiLi9hZGRfdG9fZmlsdGVyX2xpc3RfbGluayIpOwoKdmFyIF9kZWxldGVfcnVsZV9tb2RhbCA9IHJlcXVpcmUoIi4vZGVsZXRlX3J1bGVfbW9kYWwiKTsKCnZhciBfZWRpdF9jb25kaXRpb25fbGluayA9IHJlcXVpcmUoIi4vZWRpdF9jb25kaXRpb25fbGluayIpOwoKdmFyIF91dGlscyA9IHJlcXVpcmUoIi4uL3V0aWxzIik7Cgp2YXIgX21sX2FwaV9zZXJ2aWNlID0gcmVxdWlyZSgiLi4vLi4vLi4vc2VydmljZXMvbWxfYXBpX3NlcnZpY2UiKTsKCnZhciBfcmVhY3QyID0gcmVxdWlyZSgiQGtibi9pMThuL3JlYWN0Iik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGVsc2UgeyB2YXIgbmV3T2JqID0ge307IGlmIChvYmogIT0gbnVsbCkgeyBmb3IgKHZhciBrZXkgaW4gb2JqKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7IHZhciBkZXNjID0gT2JqZWN0LmRlZmluZVByb3BlcnR5ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KSA6IHt9OyBpZiAoZGVzYy5nZXQgfHwgZGVzYy5zZXQpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5ld09iaiwga2V5LCBkZXNjKTsgfSBlbHNlIHsgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IH0gfSBuZXdPYmouZGVmYXVsdCA9IG9iajsgcmV0dXJuIG5ld09iajsgfSB9CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gInN5bWJvbCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9CgpmdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfQoKZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpKSB7IHJldHVybiBjYWxsOyB9IHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOyB9CgpmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyBfZ2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3QuZ2V0UHJvdG90eXBlT2YgOiBmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyByZXR1cm4gby5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKG8pOyB9OyByZXR1cm4gX2dldFByb3RvdHlwZU9mKG8pOyB9CgpmdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsgaWYgKHNlbGYgPT09IHZvaWQgMCkgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOyB9IHJldHVybiBzZWxmOyB9CgpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAiZnVuY3Rpb24iICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24iKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBfc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpOyB9CgpmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgby5fX3Byb3RvX18gPSBwOyByZXR1cm4gbzsgfTsgcmV0dXJuIF9zZXRQcm90b3R5cGVPZihvLCBwKTsgfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgeyBpZiAoa2V5IGluIG9iaikgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsgdmFsdWU6IHZhbHVlLCBlbnVtZXJhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlIH0pOyB9IGVsc2UgeyBvYmpba2V5XSA9IHZhbHVlOyB9IHJldHVybiBvYmo7IH0KCnZhciBSdWxlQWN0aW9uUGFuZWwgPQovKiNfX1BVUkVfXyovCmZ1bmN0aW9uIChfQ29tcG9uZW50KSB7CiAgX2luaGVyaXRzKFJ1bGVBY3Rpb25QYW5lbCwgX0NvbXBvbmVudCk7CgogIGZ1bmN0aW9uIFJ1bGVBY3Rpb25QYW5lbChwcm9wcykgewogICAgdmFyIF90aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBSdWxlQWN0aW9uUGFuZWwpOwoKICAgIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgX2dldFByb3RvdHlwZU9mKFJ1bGVBY3Rpb25QYW5lbCkuY2FsbCh0aGlzLCBwcm9wcykpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImdldEVkaXRSdWxlTGluayIsIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF90aGlzJHByb3BzID0gX3RoaXMucHJvcHMsCiAgICAgICAgICBydWxlSW5kZXggPSBfdGhpcyRwcm9wcy5ydWxlSW5kZXgsCiAgICAgICAgICBzZXRFZGl0UnVsZUluZGV4ID0gX3RoaXMkcHJvcHMuc2V0RWRpdFJ1bGVJbmRleDsKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlMaW5rLCB7CiAgICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHsKICAgICAgICAgIHJldHVybiBzZXRFZGl0UnVsZUluZGV4KHJ1bGVJbmRleCk7CiAgICAgICAgfQogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAieHBhY2subWwucnVsZUVkaXRvci5ydWxlQWN0aW9uUGFuZWwuZWRpdFJ1bGVMaW5rVGV4dCIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJFZGl0IHJ1bGUiCiAgICAgIH0pKTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImdldERlbGV0ZVJ1bGVMaW5rIiwgZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3RoaXMkcHJvcHMyID0gX3RoaXMucHJvcHMsCiAgICAgICAgICBydWxlSW5kZXggPSBfdGhpcyRwcm9wczIucnVsZUluZGV4LAogICAgICAgICAgZGVsZXRlUnVsZUF0SW5kZXggPSBfdGhpcyRwcm9wczIuZGVsZXRlUnVsZUF0SW5kZXg7CiAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9kZWxldGVfcnVsZV9tb2RhbC5EZWxldGVSdWxlTW9kYWwsIHsKICAgICAgICBydWxlSW5kZXg6IHJ1bGVJbmRleCwKICAgICAgICBkZWxldGVSdWxlQXRJbmRleDogZGVsZXRlUnVsZUF0SW5kZXgKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJnZXRRdWlja0VkaXRDb25kaXRpb25MaW5rIiwgZnVuY3Rpb24gKCkgewogICAgICAvLyBSZXR1cm5zIHRoZSBsaW5rIHRvIGFkanVzdCB0aGUgbnVtZXJpYyB2YWx1ZSBvZiBhIGNvbmRpdGlvbgogICAgICAvLyBpZiB0aGUgcnVsZSBoYXMgYSBzaW5nbGUgbnVtZXJpYyBjb25kaXRpb24uCiAgICAgIHZhciBjb25kaXRpb25zID0gX3RoaXMucnVsZS5jb25kaXRpb25zOwogICAgICB2YXIgbGluayA9IG51bGw7CgogICAgICBpZiAoX3RoaXMucnVsZS5jb25kaXRpb25zICE9PSB1bmRlZmluZWQgJiYgY29uZGl0aW9ucy5sZW5ndGggPT09IDEpIHsKICAgICAgICBsaW5rID0gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZWRpdF9jb25kaXRpb25fbGluay5FZGl0Q29uZGl0aW9uTGluaywgewogICAgICAgICAgY29uZGl0aW9uSW5kZXg6IDAsCiAgICAgICAgICBjb25kaXRpb25WYWx1ZTogY29uZGl0aW9uc1swXS52YWx1ZSwKICAgICAgICAgIGFwcGxpZXNUbzogY29uZGl0aW9uc1swXS5hcHBsaWVzX3RvLAogICAgICAgICAgYW5vbWFseTogX3RoaXMucHJvcHMuYW5vbWFseSwKICAgICAgICAgIHVwZGF0ZUNvbmRpdGlvblZhbHVlOiBfdGhpcy51cGRhdGVDb25kaXRpb25WYWx1ZQogICAgICAgIH0pOwogICAgICB9CgogICAgICByZXR1cm4gbGluazsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImdldFF1aWNrQWRkVG9GaWx0ZXJMaXN0TGluayIsIGZ1bmN0aW9uICgpIHsKICAgICAgLy8gUmV0dXJucyB0aGUgbGluayB0byBhZGQgdGhlIHBhcnRpdGlvbmluZyBmaWVsZCB2YWx1ZSBvZiB0aGUgYW5vbWFseSB0byB0aGUgZmlsdGVyCiAgICAgIC8vIGxpc3QgdXNlZCBpbiB0aGUgc2NvcGUgcGFydCBvZiB0aGUgcnVsZS4KICAgICAgLy8gTm90ZSBjb21wb25lbnREaWRNb3VudCBwZXJmb3JtcyB0aGUgY2hlY2tzIGZvciB0aGUgZXhpc3RlbmNlIG9mIHNjb3BlIGFuZCBwYXJ0aXRpb25pbmcgZmllbGRzLgogICAgICB2YXIgX3RoaXMkcHJvcHMzID0gX3RoaXMucHJvcHMsCiAgICAgICAgICBhbm9tYWx5ID0gX3RoaXMkcHJvcHMzLmFub21hbHksCiAgICAgICAgICBhZGRJdGVtVG9GaWx0ZXJMaXN0ID0gX3RoaXMkcHJvcHMzLmFkZEl0ZW1Ub0ZpbHRlckxpc3Q7CiAgICAgIHZhciBzY29wZSA9IF90aGlzLnJ1bGUuc2NvcGU7CiAgICAgIHZhciBwYXJ0aXRpb25GaWVsZE5hbWUgPSBPYmplY3Qua2V5cyhzY29wZSlbMF07CiAgICAgIHZhciBwYXJ0aXRpb25GaWVsZFZhbHVlID0gYW5vbWFseS5zb3VyY2VbcGFydGl0aW9uRmllbGROYW1lXTsKICAgICAgdmFyIGZpbHRlcklkID0gc2NvcGVbcGFydGl0aW9uRmllbGROYW1lXS5maWx0ZXJfaWQ7IC8vIFBhcnRpdGlvbmluZyBmaWVsZCB2YWx1ZXMgc3RvcmVkIHVuZGVyIG5hbWVkIGZpZWxkIGluIGFub21hbHkgcmVjb3JkIHdpbGwgYmUgYW4gYXJyYXkuCgogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfYWRkX3RvX2ZpbHRlcl9saXN0X2xpbmsuQWRkVG9GaWx0ZXJMaXN0TGluaywgewogICAgICAgIGZpZWxkVmFsdWU6IHBhcnRpdGlvbkZpZWxkVmFsdWVbMF0sCiAgICAgICAgZmlsdGVySWQ6IGZpbHRlcklkLAogICAgICAgIGFkZEl0ZW1Ub0ZpbHRlckxpc3Q6IGFkZEl0ZW1Ub0ZpbHRlckxpc3QKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJ1cGRhdGVDb25kaXRpb25WYWx1ZSIsIGZ1bmN0aW9uIChjb25kaXRpb25JbmRleCwgdmFsdWUpIHsKICAgICAgdmFyIF90aGlzJHByb3BzNCA9IF90aGlzLnByb3BzLAogICAgICAgICAgam9iID0gX3RoaXMkcHJvcHM0LmpvYiwKICAgICAgICAgIGFub21hbHkgPSBfdGhpcyRwcm9wczQuYW5vbWFseSwKICAgICAgICAgIHJ1bGVJbmRleCA9IF90aGlzJHByb3BzNC5ydWxlSW5kZXgsCiAgICAgICAgICB1cGRhdGVSdWxlQXRJbmRleCA9IF90aGlzJHByb3BzNC51cGRhdGVSdWxlQXRJbmRleDsKICAgICAgdmFyIGRldGVjdG9yID0gam9iLmFuYWx5c2lzX2NvbmZpZy5kZXRlY3RvcnNbYW5vbWFseS5kZXRlY3RvckluZGV4XTsKICAgICAgdmFyIGVkaXRlZFJ1bGUgPSAoMCwgX2xvZGFzaC5jbG9uZURlZXApKGRldGVjdG9yLmN1c3RvbV9ydWxlc1tydWxlSW5kZXhdKTsKICAgICAgdmFyIGNvbmRpdGlvbnMgPSBlZGl0ZWRSdWxlLmNvbmRpdGlvbnM7CgogICAgICBpZiAoY29uZGl0aW9uSW5kZXggPCBjb25kaXRpb25zLmxlbmd0aCkgewogICAgICAgIGNvbmRpdGlvbnNbY29uZGl0aW9uSW5kZXhdLnZhbHVlID0gdmFsdWU7CiAgICAgIH0KCiAgICAgIHVwZGF0ZVJ1bGVBdEluZGV4KHJ1bGVJbmRleCwgZWRpdGVkUnVsZSk7CiAgICB9KTsKCiAgICB2YXIgX3RoaXMkcHJvcHM1ID0gX3RoaXMucHJvcHMsCiAgICAgICAgX2pvYiA9IF90aGlzJHByb3BzNS5qb2IsCiAgICAgICAgX2Fub21hbHkgPSBfdGhpcyRwcm9wczUuYW5vbWFseSwKICAgICAgICBfcnVsZUluZGV4ID0gX3RoaXMkcHJvcHM1LnJ1bGVJbmRleDsKICAgIHZhciBfZGV0ZWN0b3IgPSBfam9iLmFuYWx5c2lzX2NvbmZpZy5kZXRlY3RvcnNbX2Fub21hbHkuZGV0ZWN0b3JJbmRleF07CiAgICB2YXIgcnVsZXMgPSBfZGV0ZWN0b3IuY3VzdG9tX3J1bGVzOwoKICAgIGlmIChydWxlcyAhPT0gdW5kZWZpbmVkICYmIF9ydWxlSW5kZXggPCBydWxlcy5sZW5ndGgpIHsKICAgICAgX3RoaXMucnVsZSA9IHJ1bGVzW19ydWxlSW5kZXhdOwogICAgfQoKICAgIF90aGlzLnN0YXRlID0gewogICAgICBzaG93QWRkVG9GaWx0ZXJMaXN0TGluazogZmFsc2UKICAgIH07CiAgICByZXR1cm4gX3RoaXM7CiAgfQoKICBfY3JlYXRlQ2xhc3MoUnVsZUFjdGlvblBhbmVsLCBbewogICAga2V5OiAiY29tcG9uZW50RGlkTW91bnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudERpZE1vdW50KCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIC8vIElmIHRoZSBydWxlIGhhcyBhIHNjb3BlIHNlY3Rpb24gd2l0aCBhIHNpbmdsZSBwYXJ0aXRpb25pbmcgZmllbGQga2V5LAogICAgICAvLyBsb2FkIHRoZSBmaWx0ZXIgbGlzdCB0byBjaGVjayB3aGV0aGVyIHRvIGFkZCBhIGxpbmsgdG8gYWRkIHRoZQogICAgICAvLyBhbm9tYWx5IHBhcnRpdGlvbmluZyBmaWVsZCB2YWx1ZSB0byB0aGUgZmlsdGVyIGxpc3QuCiAgICAgIHZhciBzY29wZSA9IHRoaXMucnVsZS5zY29wZTsKCiAgICAgIGlmIChzY29wZSAhPT0gdW5kZWZpbmVkICYmIE9iamVjdC5rZXlzKHNjb3BlKS5sZW5ndGggPT09IDEpIHsKICAgICAgICB2YXIgcGFydGl0aW9uRmllbGROYW1lID0gT2JqZWN0LmtleXMoc2NvcGUpWzBdOwogICAgICAgIHZhciBwYXJ0aXRpb25GaWVsZFZhbHVlID0gdGhpcy5wcm9wcy5hbm9tYWx5LnNvdXJjZVtwYXJ0aXRpb25GaWVsZE5hbWVdOwoKICAgICAgICBpZiAoc2NvcGVbcGFydGl0aW9uRmllbGROYW1lXSAhPT0gdW5kZWZpbmVkICYmIHBhcnRpdGlvbkZpZWxkVmFsdWUgIT09IHVuZGVmaW5lZCAmJiBwYXJ0aXRpb25GaWVsZFZhbHVlLmxlbmd0aCA9PT0gMSAmJiBwYXJ0aXRpb25GaWVsZFZhbHVlWzBdLmxlbmd0aCA+IDApIHsKICAgICAgICAgIHZhciBmaWx0ZXJJZCA9IHNjb3BlW3BhcnRpdGlvbkZpZWxkTmFtZV0uZmlsdGVyX2lkOwoKICAgICAgICAgIF9tbF9hcGlfc2VydmljZS5tbC5maWx0ZXJzLmZpbHRlcnMoewogICAgICAgICAgICBmaWx0ZXJJZDogZmlsdGVySWQKICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKGZpbHRlcikgewogICAgICAgICAgICB2YXIgZmlsdGVySXRlbXMgPSBmaWx0ZXIuaXRlbXM7CgogICAgICAgICAgICBpZiAoZmlsdGVySXRlbXMuaW5kZXhPZihwYXJ0aXRpb25GaWVsZFZhbHVlWzBdKSA9PT0gLTEpIHsKICAgICAgICAgICAgICBfdGhpczIuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgc2hvd0FkZFRvRmlsdGVyTGlzdExpbms6IHRydWUKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlc3ApIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIkVycm9yIGxvYWRpbmcgZmlsdGVyICIuY29uY2F0KGZpbHRlcklkLCAiOiIpLCByZXNwKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkgewogICAgICBpZiAodGhpcy5ydWxlID09PSB1bmRlZmluZWQpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfSAvLyBBZGQgaXRlbXMgZm9yIHRoZSBzdGFuZGFyZCBFZGl0IGFuZCBEZWxldGUgbGlua3MuCgoKICAgICAgdmFyIGRlc2NyaXB0aW9uTGlzdEl0ZW1zID0gW3sKICAgICAgICB0aXRsZTogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICAgIGlkOiAieHBhY2subWwucnVsZUVkaXRvci5ydWxlQWN0aW9uUGFuZWwucnVsZVRpdGxlIiwKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiUnVsZSIKICAgICAgICB9KSwKICAgICAgICBkZXNjcmlwdGlvbjogKDAsIF91dGlscy5idWlsZFJ1bGVEZXNjcmlwdGlvbikodGhpcy5ydWxlLCB0aGlzLnByb3BzLmFub21hbHkpCiAgICAgIH0sIHsKICAgICAgICB0aXRsZTogJycsCiAgICAgICAgZGVzY3JpcHRpb246IHRoaXMuZ2V0RWRpdFJ1bGVMaW5rKCkKICAgICAgfSwgewogICAgICAgIHRpdGxlOiAnJywKICAgICAgICBkZXNjcmlwdGlvbjogdGhpcy5nZXREZWxldGVSdWxlTGluaygpCiAgICAgIH1dOyAvLyBJbnNlcnQgbGlua3MgaWYgYXBwbGljYWJsZSBmb3IgcXVpY2sgZWRpdHMgdG8gYSBudW1lcmljIGNvbmRpdGlvbgogICAgICAvLyBvciB0byB0aGUgc2FmZSBsaXN0IHVzZWQgYnkgdGhlIHNjb3BlLgoKICAgICAgdmFyIHF1aWNrQ29uZGl0aW9uTGluayA9IHRoaXMuZ2V0UXVpY2tFZGl0Q29uZGl0aW9uTGluaygpOwoKICAgICAgaWYgKHF1aWNrQ29uZGl0aW9uTGluayAhPT0gbnVsbCkgewogICAgICAgIGRlc2NyaXB0aW9uTGlzdEl0ZW1zLnNwbGljZSgxLCAwLCB7CiAgICAgICAgICB0aXRsZTogJycsCiAgICAgICAgICBkZXNjcmlwdGlvbjogcXVpY2tDb25kaXRpb25MaW5rCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnN0YXRlLnNob3dBZGRUb0ZpbHRlckxpc3RMaW5rID09PSB0cnVlKSB7CiAgICAgICAgdmFyIHF1aWNrQWRkVG9GaWx0ZXJMaXN0TGluayA9IHRoaXMuZ2V0UXVpY2tBZGRUb0ZpbHRlckxpc3RMaW5rKCk7CiAgICAgICAgZGVzY3JpcHRpb25MaXN0SXRlbXMuc3BsaWNlKGRlc2NyaXB0aW9uTGlzdEl0ZW1zLmxlbmd0aCAtIDIsIDAsIHsKICAgICAgICAgIHRpdGxlOiAnJywKICAgICAgICAgIGRlc2NyaXB0aW9uOiBxdWlja0FkZFRvRmlsdGVyTGlzdExpbmsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgZGVzY3JpcHRpb25MaXN0SXRlbXNbMV0udGl0bGUgPSBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAieHBhY2subWwucnVsZUVkaXRvci5ydWxlQWN0aW9uUGFuZWwuYWN0aW9uc1RpdGxlIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkFjdGlvbnMiCiAgICAgIH0pOwogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVBhbmVsLCB7CiAgICAgICAgcGFkZGluZ1NpemU6ICJtIiwKICAgICAgICBjbGFzc05hbWU6ICJzZWxlY3QtcnVsZS1hY3Rpb24tcGFuZWwiCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlEZXNjcmlwdGlvbkxpc3QsIHsKICAgICAgICB0eXBlOiAiY29sdW1uIiwKICAgICAgICBsaXN0SXRlbXM6IGRlc2NyaXB0aW9uTGlzdEl0ZW1zCiAgICAgIH0pKTsKICAgIH0KICB9XSk7CgogIHJldHVybiBSdWxlQWN0aW9uUGFuZWw7Cn0oX3JlYWN0LkNvbXBvbmVudCk7CgpleHBvcnRzLlJ1bGVBY3Rpb25QYW5lbCA9IFJ1bGVBY3Rpb25QYW5lbDsKUnVsZUFjdGlvblBhbmVsLnByb3BUeXBlcyA9IHsKICBqb2I6IF9wcm9wVHlwZXMuZGVmYXVsdC5vYmplY3QuaXNSZXF1aXJlZCwKICBhbm9tYWx5OiBfcHJvcFR5cGVzLmRlZmF1bHQub2JqZWN0LmlzUmVxdWlyZWQsCiAgcnVsZUluZGV4OiBfcHJvcFR5cGVzLmRlZmF1bHQubnVtYmVyLmlzUmVxdWlyZWQsCiAgc2V0RWRpdFJ1bGVJbmRleDogX3Byb3BUeXBlcy5kZWZhdWx0LmZ1bmMuaXNSZXF1aXJlZCwKICB1cGRhdGVSdWxlQXRJbmRleDogX3Byb3BUeXBlcy5kZWZhdWx0LmZ1bmMuaXNSZXF1aXJlZCwKICBkZWxldGVSdWxlQXRJbmRleDogX3Byb3BUeXBlcy5kZWZhdWx0LmZ1bmMuaXNSZXF1aXJlZCwKICBhZGRJdGVtVG9GaWx0ZXJMaXN0OiBfcHJvcFR5cGVzLmRlZmF1bHQuZnVuYy5pc1JlcXVpcmVkCn07"},null]}