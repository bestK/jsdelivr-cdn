{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/index_lifecycle_management/public/sections/policy_table/components/policy_table/policy_table.js","dependencies":[{"path":"x-pack/legacy/plugins/index_lifecycle_management/public/sections/policy_table/components/policy_table/policy_table.js","mtime":1585205044337},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1585205104179},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1585205115915},{"path":"node_modules/babel-loader/lib/index.js","mtime":1585205080825}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLlBvbGljeVRhYmxlID0gdm9pZCAwOwoKdmFyIF9yZWFjdCA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoInJlYWN0IikpOwoKdmFyIF9tb21lbnRUaW1lem9uZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgibW9tZW50LXRpbWV6b25lIikpOwoKdmFyIF9pMThuID0gcmVxdWlyZSgiQGtibi9pMThuIik7Cgp2YXIgX3JlYWN0MiA9IHJlcXVpcmUoIkBrYm4vaTE4bi9yZWFjdCIpOwoKdmFyIF9ldWkgPSByZXF1aXJlKCJAZWxhc3RpYy9ldWkiKTsKCnZhciBfc2VydmljZXMgPSByZXF1aXJlKCJAZWxhc3RpYy9ldWkvbGliL3NlcnZpY2VzIik7Cgp2YXIgX25hdmlnYXRpb24gPSByZXF1aXJlKCIuLi8uLi8uLi8uLi8uLi8uLi9pbmRleF9tYW5hZ2VtZW50L3B1YmxpYy9hcHAvc2VydmljZXMvbmF2aWdhdGlvbiIpOwoKdmFyIF9jb25zdGFudHMgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi8uLi9jb21tb24vY29uc3RhbnRzIik7Cgp2YXIgX25hdmlnYXRpb24yID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vc2VydmljZXMvbmF2aWdhdGlvbiIpOwoKdmFyIF9mbGF0dGVuX3BhbmVsX3RyZWUgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9zZXJ2aWNlcy9mbGF0dGVuX3BhbmVsX3RyZWUiKTsKCnZhciBfc2VydmljZXMyID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vc2VydmljZXMiKTsKCnZhciBfbm9fbWF0Y2ggPSByZXF1aXJlKCIuLi9ub19tYXRjaCIpOwoKdmFyIF9jb25maXJtX2RlbGV0ZSA9IHJlcXVpcmUoIi4vY29uZmlybV9kZWxldGUiKTsKCnZhciBfYWRkX3BvbGljeV90b190ZW1wbGF0ZV9jb25maXJtX21vZGFsID0gcmVxdWlyZSgiLi9hZGRfcG9saWN5X3RvX3RlbXBsYXRlX2NvbmZpcm1fbW9kYWwiKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGVsc2UgeyB2YXIgbmV3T2JqID0ge307IGlmIChvYmogIT0gbnVsbCkgeyBmb3IgKHZhciBrZXkgaW4gb2JqKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7IHZhciBkZXNjID0gT2JqZWN0LmRlZmluZVByb3BlcnR5ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KSA6IHt9OyBpZiAoZGVzYy5nZXQgfHwgZGVzYy5zZXQpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5ld09iaiwga2V5LCBkZXNjKTsgfSBlbHNlIHsgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IH0gfSBuZXdPYmouZGVmYXVsdCA9IG9iajsgcmV0dXJuIG5ld09iajsgfSB9CgpmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyBpZiAodHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSAic3ltYm9sIikgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH07IH0gZWxzZSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mKG9iaik7IH0KCmZ1bmN0aW9uIF9zbGljZWRUb0FycmF5KGFyciwgaSkgeyByZXR1cm4gX2FycmF5V2l0aEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgfHwgX25vbkl0ZXJhYmxlUmVzdCgpOyB9CgpmdW5jdGlvbiBfbm9uSXRlcmFibGVSZXN0KCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7IH0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHsgdmFyIF9hcnIgPSBbXTsgdmFyIF9uID0gdHJ1ZTsgdmFyIF9kID0gZmFsc2U7IHZhciBfZSA9IHVuZGVmaW5lZDsgdHJ5IHsgZm9yICh2YXIgX2kgPSBhcnJbU3ltYm9sLml0ZXJhdG9yXSgpLCBfczsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSkgeyBfYXJyLnB1c2goX3MudmFsdWUpOyBpZiAoaSAmJiBfYXJyLmxlbmd0aCA9PT0gaSkgYnJlYWs7IH0gfSBjYXRjaCAoZXJyKSB7IF9kID0gdHJ1ZTsgX2UgPSBlcnI7IH0gZmluYWxseSB7IHRyeSB7IGlmICghX24gJiYgX2lbInJldHVybiJdICE9IG51bGwpIF9pWyJyZXR1cm4iXSgpOyB9IGZpbmFsbHkgeyBpZiAoX2QpIHRocm93IF9lOyB9IH0gcmV0dXJuIF9hcnI7IH0KCmZ1bmN0aW9uIF9hcnJheVdpdGhIb2xlcyhhcnIpIHsgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH0KCmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKGNhbGwgJiYgKF90eXBlb2YoY2FsbCkgPT09ICJvYmplY3QiIHx8IHR5cGVvZiBjYWxsID09PSAiZnVuY3Rpb24iKSkgeyByZXR1cm4gY2FsbDsgfSByZXR1cm4gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKTsgfQoKZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgX2dldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LmdldFByb3RvdHlwZU9mIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgcmV0dXJuIG8uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihvKTsgfTsgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsgfQoKZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7IGlmIChzZWxmID09PSB2b2lkIDApIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsgfSByZXR1cm4gc2VsZjsgfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uIik7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTsgfQoKZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgX3NldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IGZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IG8uX19wcm90b19fID0gcDsgcmV0dXJuIG87IH07IHJldHVybiBfc2V0UHJvdG90eXBlT2YobywgcCk7IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsgaWYgKGtleSBpbiBvYmopIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7IHZhbHVlOiB2YWx1ZSwgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTsgfSBlbHNlIHsgb2JqW2tleV0gPSB2YWx1ZTsgfSByZXR1cm4gb2JqOyB9Cgp2YXIgQ09MVU1OUyA9IHsKICBuYW1lOiB7CiAgICBsYWJlbDogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLmluZGV4TGlmZWN5Y2xlTWdtdC5wb2xpY3lUYWJsZS5oZWFkZXJzLm5hbWVIZWFkZXInLCB7CiAgICAgIGRlZmF1bHRNZXNzYWdlOiAnTmFtZScKICAgIH0pCiAgfSwKICBsaW5rZWRJbmRpY2VzOiB7CiAgICBsYWJlbDogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLmluZGV4TGlmZWN5Y2xlTWdtdC5wb2xpY3lUYWJsZS5oZWFkZXJzLmxpbmtlZEluZGljZXNIZWFkZXInLCB7CiAgICAgIGRlZmF1bHRNZXNzYWdlOiAnTGlua2VkIGluZGljZXMnCiAgICB9KSwKICAgIHdpZHRoOiAxMjAKICB9LAogIHZlcnNpb246IHsKICAgIGxhYmVsOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaW5kZXhMaWZlY3ljbGVNZ210LnBvbGljeVRhYmxlLmhlYWRlcnMudmVyc2lvbkhlYWRlcicsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdWZXJzaW9uJwogICAgfSksCiAgICB3aWR0aDogMTIwCiAgfSwKICBtb2RpZmllZF9kYXRlOiB7CiAgICBsYWJlbDogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLmluZGV4TGlmZWN5Y2xlTWdtdC5wb2xpY3lUYWJsZS5oZWFkZXJzLm1vZGlmaWVkRGF0ZUhlYWRlcicsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdNb2RpZmllZCBkYXRlJwogICAgfSksCiAgICB3aWR0aDogMjAwCiAgfQp9OwoKdmFyIFBvbGljeVRhYmxlID0KLyojX19QVVJFX18qLwpmdW5jdGlvbiAoX0NvbXBvbmVudCkgewogIF9pbmhlcml0cyhQb2xpY3lUYWJsZSwgX0NvbXBvbmVudCk7CgogIGZ1bmN0aW9uIFBvbGljeVRhYmxlKHByb3BzKSB7CiAgICB2YXIgX3RoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFBvbGljeVRhYmxlKTsKCiAgICBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIF9nZXRQcm90b3R5cGVPZihQb2xpY3lUYWJsZSkuY2FsbCh0aGlzLCBwcm9wcykpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInJlbmRlckRlbGV0ZUNvbmZpcm1Nb2RhbCIsIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHBvbGljeVRvRGVsZXRlID0gX3RoaXMuc3RhdGUucG9saWN5VG9EZWxldGU7CgogICAgICBpZiAoIXBvbGljeVRvRGVsZXRlKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9jb25maXJtX2RlbGV0ZS5Db25maXJtRGVsZXRlLCB7CiAgICAgICAgcG9saWN5VG9EZWxldGU6IHBvbGljeVRvRGVsZXRlLAogICAgICAgIGNhbGxiYWNrOiBfdGhpcy5oYW5kbGVEZWxldGUsCiAgICAgICAgb25DYW5jZWw6IGZ1bmN0aW9uIG9uQ2FuY2VsKCkgewogICAgICAgICAgcmV0dXJuIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgcmVuZGVyQ29uZmlybU1vZGFsOiBudWxsLAogICAgICAgICAgICBwb2xpY3lUb0RlbGV0ZTogbnVsbAogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInJlbmRlckFkZFBvbGljeVRvVGVtcGxhdGVDb25maXJtTW9kYWwiLCBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBwb2xpY3lUb0FkZFRvVGVtcGxhdGUgPSBfdGhpcy5zdGF0ZS5wb2xpY3lUb0FkZFRvVGVtcGxhdGU7CgogICAgICBpZiAoIXBvbGljeVRvQWRkVG9UZW1wbGF0ZSkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfYWRkX3BvbGljeV90b190ZW1wbGF0ZV9jb25maXJtX21vZGFsLkFkZFBvbGljeVRvVGVtcGxhdGVDb25maXJtTW9kYWwsIHsKICAgICAgICBwb2xpY3k6IHBvbGljeVRvQWRkVG9UZW1wbGF0ZSwKICAgICAgICBvbkNhbmNlbDogZnVuY3Rpb24gb25DYW5jZWwoKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICByZW5kZXJDb25maXJtTW9kYWw6IG51bGwsCiAgICAgICAgICAgIHBvbGljeVRvQWRkVG9UZW1wbGF0ZTogbnVsbAogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImhhbmRsZURlbGV0ZSIsIGZ1bmN0aW9uICgpIHsKICAgICAgX3RoaXMucHJvcHMuZmV0Y2hQb2xpY2llcyh0cnVlKTsKCiAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICByZW5kZXJEZWxldGVDb25maXJtTW9kYWw6IG51bGwsCiAgICAgICAgcG9saWN5VG9EZWxldGU6IG51bGwKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJvblNvcnQiLCBmdW5jdGlvbiAoY29sdW1uKSB7CiAgICAgIHZhciBfdGhpcyRwcm9wcyA9IF90aGlzLnByb3BzLAogICAgICAgICAgc29ydEZpZWxkID0gX3RoaXMkcHJvcHMuc29ydEZpZWxkLAogICAgICAgICAgaXNTb3J0QXNjZW5kaW5nID0gX3RoaXMkcHJvcHMuaXNTb3J0QXNjZW5kaW5nLAogICAgICAgICAgcG9saWN5U29ydENoYW5nZWQgPSBfdGhpcyRwcm9wcy5wb2xpY3lTb3J0Q2hhbmdlZDsKICAgICAgdmFyIG5ld0lzU29ydEFzY2VuZGluZyA9IHNvcnRGaWVsZCA9PT0gY29sdW1uID8gIWlzU29ydEFzY2VuZGluZyA6IHRydWU7CiAgICAgIHBvbGljeVNvcnRDaGFuZ2VkKGNvbHVtbiwgbmV3SXNTb3J0QXNjZW5kaW5nKTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInRvZ2dsZVBvbGljeVBvcG92ZXIiLCBmdW5jdGlvbiAocG9saWN5KSB7CiAgICAgIGlmIChfdGhpcy5pc1BvbGljeVBvcG92ZXJPcGVuKHBvbGljeSkpIHsKICAgICAgICBfdGhpcy5jbG9zZVBvbGljeVBvcG92ZXIocG9saWN5KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBfdGhpcy5vcGVuUG9saWN5UG9wb3Zlcihwb2xpY3kpOwogICAgICB9CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJpc1BvbGljeVBvcG92ZXJPcGVuIiwgZnVuY3Rpb24gKHBvbGljeSkgewogICAgICByZXR1cm4gX3RoaXMuc3RhdGUucG9saWN5UG9wb3ZlciA9PT0gcG9saWN5Lm5hbWU7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJjbG9zZVBvbGljeVBvcG92ZXIiLCBmdW5jdGlvbiAocG9saWN5KSB7CiAgICAgIGlmIChfdGhpcy5pc1BvbGljeVBvcG92ZXJPcGVuKHBvbGljeSkpIHsKICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICBwb2xpY3lQb3BvdmVyOiBudWxsCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIm9wZW5Qb2xpY3lQb3BvdmVyIiwgZnVuY3Rpb24gKHBvbGljeSkgewogICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgcG9saWN5UG9wb3ZlcjogcG9saWN5Lm5hbWUKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJvbkl0ZW1TZWxlY3Rpb25DaGFuZ2VkIiwgZnVuY3Rpb24gKHNlbGVjdGVkUG9saWNpZXMpIHsKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIHNlbGVjdGVkUG9saWNpZXM6IHNlbGVjdGVkUG9saWNpZXMKICAgICAgfSk7CiAgICB9KTsKCiAgICBfdGhpcy5zdGF0ZSA9IHsKICAgICAgc2VsZWN0ZWRQb2xpY2llc01hcDoge30sCiAgICAgIHJlbmRlckNvbmZpcm1Nb2RhbDogbnVsbAogICAgfTsKICAgIHJldHVybiBfdGhpczsKICB9CgogIF9jcmVhdGVDbGFzcyhQb2xpY3lUYWJsZSwgW3sKICAgIGtleTogImNvbXBvbmVudERpZE1vdW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnREaWRNb3VudCgpIHsKICAgICAgdGhpcy5wcm9wcy5mZXRjaFBvbGljaWVzKHRydWUpOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlckVtcHR5IiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJFbXB0eSgpIHsKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlFbXB0eVByb21wdCwgewogICAgICAgIGljb25UeXBlOiAibWFuYWdlbWVudEFwcCIsCiAgICAgICAgdGl0bGU6IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImgxIiwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICAgIGlkOiAieHBhY2suaW5kZXhMaWZlY3ljbGVNZ210LnBvbGljeVRhYmxlLmVtcHR5UHJvbXB0VGl0bGUiLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJDcmVhdGUgeW91ciBmaXJzdCBpbmRleCBsaWZlY3ljbGUgcG9saWN5IgogICAgICAgIH0pKSwKICAgICAgICBib2R5OiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5GcmFnbWVudCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgicCIsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICBpZDogInhwYWNrLmluZGV4TGlmZWN5Y2xlTWdtdC5wb2xpY3lUYWJsZS5lbXB0eVByb21wdERlc2NyaXB0aW9uIiwKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiIEFuIGluZGV4IGxpZmVjeWNsZSBwb2xpY3kgaGVscHMgeW91IG1hbmFnZSB5b3VyIGluZGljZXMgYXMgdGhleSBhZ2UuIgogICAgICAgIH0pKSksCiAgICAgICAgYWN0aW9uczogdGhpcy5yZW5kZXJDcmVhdGVQb2xpY3lCdXR0b24oKQogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJidWlsZEhlYWRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYnVpbGRIZWFkZXIoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdmFyIF90aGlzJHByb3BzMiA9IHRoaXMucHJvcHMsCiAgICAgICAgICBzb3J0RmllbGQgPSBfdGhpcyRwcm9wczIuc29ydEZpZWxkLAogICAgICAgICAgaXNTb3J0QXNjZW5kaW5nID0gX3RoaXMkcHJvcHMyLmlzU29ydEFzY2VuZGluZzsKICAgICAgdmFyIGhlYWRlcnMgPSBPYmplY3QuZW50cmllcyhDT0xVTU5TKS5tYXAoZnVuY3Rpb24gKF9yZWYpIHsKICAgICAgICB2YXIgX3JlZjIgPSBfc2xpY2VkVG9BcnJheShfcmVmLCAyKSwKICAgICAgICAgICAgZmllbGROYW1lID0gX3JlZjJbMF0sCiAgICAgICAgICAgIF9yZWYyJCA9IF9yZWYyWzFdLAogICAgICAgICAgICBsYWJlbCA9IF9yZWYyJC5sYWJlbCwKICAgICAgICAgICAgd2lkdGggPSBfcmVmMiQud2lkdGg7CgogICAgICAgIHZhciBpc1NvcnRlZCA9IHNvcnRGaWVsZCA9PT0gZmllbGROYW1lOwogICAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVGFibGVIZWFkZXJDZWxsLCB7CiAgICAgICAgICBrZXk6IGZpZWxkTmFtZSwKICAgICAgICAgIG9uU29ydDogZnVuY3Rpb24gb25Tb3J0KCkgewogICAgICAgICAgICByZXR1cm4gX3RoaXMyLm9uU29ydChmaWVsZE5hbWUpOwogICAgICAgICAgfSwKICAgICAgICAgIGlzU29ydGVkOiBpc1NvcnRlZCwKICAgICAgICAgIGlzU29ydEFzY2VuZGluZzogaXNTb3J0QXNjZW5kaW5nLAogICAgICAgICAgImRhdGEtdGVzdC1zdWJqIjogInBvbGljeVRhYmxlSGVhZGVyQ2VsbC0iLmNvbmNhdChmaWVsZE5hbWUpLAogICAgICAgICAgY2xhc3NOYW1lOiAncG9saWN5VGFibGVfX2hlYWRlci0tJyArIGZpZWxkTmFtZSwKICAgICAgICAgIHdpZHRoOiB3aWR0aAogICAgICAgIH0sIGxhYmVsKTsKICAgICAgfSk7CiAgICAgIGhlYWRlcnMucHVzaChfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVGFibGVIZWFkZXJDZWxsLCB7CiAgICAgICAga2V5OiAiZGVsZXRlSGVhZGVyIiwKICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiAicG9saWN5VGFibGVIZWFkZXJDZWxsLWRlbGV0ZSIsCiAgICAgICAgd2lkdGg6IDE1MAogICAgICB9KSk7CiAgICAgIHJldHVybiBoZWFkZXJzOwogICAgfQogIH0sIHsKICAgIGtleTogImJ1aWxkUm93Q2VsbCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYnVpbGRSb3dDZWxsKGZpZWxkTmFtZSwgdmFsdWUpIHsKICAgICAgaWYgKGZpZWxkTmFtZSA9PT0gJ25hbWUnKSB7CiAgICAgICAgcmV0dXJuICgKICAgICAgICAgIC8qIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAZWxhc3RpYy9ldWkvaHJlZi1vci1vbi1jbGljayAqLwogICAgICAgICAgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUxpbmssIHsKICAgICAgICAgICAgY2xhc3NOYW1lOiAicG9saWN5VGFibGVfX2xpbmsiLAogICAgICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiAicG9saWN5VGFibGVQb2xpY3lOYW1lTGluayIsCiAgICAgICAgICAgIGhyZWY6ICgwLCBfbmF2aWdhdGlvbjIuZ2V0UG9saWN5UGF0aCkodmFsdWUpLAogICAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgICAgIHJldHVybiAoMCwgX3NlcnZpY2VzMi50cmFja1VpTWV0cmljKSgnY2xpY2snLCBfY29uc3RhbnRzLlVJTV9FRElUX0NMSUNLKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSwgdmFsdWUpCiAgICAgICAgKTsKICAgICAgfSBlbHNlIGlmIChmaWVsZE5hbWUgPT09ICdsaW5rZWRJbmRpY2VzJykgewogICAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVGV4dCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgiYiIsIG51bGwsIHZhbHVlID8gdmFsdWUubGVuZ3RoIDogJzAnKSk7CiAgICAgIH0gZWxzZSBpZiAoZmllbGROYW1lID09PSAnbW9kaWZpZWRfZGF0ZScgJiYgdmFsdWUpIHsKICAgICAgICByZXR1cm4gKDAsIF9tb21lbnRUaW1lem9uZS5kZWZhdWx0KSh2YWx1ZSkuZm9ybWF0KCdZWVlZLU1NLUREIEhIOm1tOnNzJyk7CiAgICAgIH0KCiAgICAgIHJldHVybiB2YWx1ZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXJDcmVhdGVQb2xpY3lCdXR0b24iLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlckNyZWF0ZVBvbGljeUJ1dHRvbigpIHsKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlCdXR0b24sIHsKICAgICAgICBocmVmOiAiIyIuY29uY2F0KF9jb25zdGFudHMuQkFTRV9QQVRILCAicG9saWNpZXMvZWRpdCIpLAogICAgICAgIGZpbGw6IHRydWUsCiAgICAgICAgaWNvblR5cGU6ICJwbHVzSW5DaXJjbGUiLAogICAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJjcmVhdGVQb2xpY3lCdXR0b24iCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJ4cGFjay5pbmRleExpZmVjeWNsZU1nbXQucG9saWN5VGFibGUuZW1wdHlQcm9tcHQuY3JlYXRlQnV0dG9uTGFiZWwiLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiQ3JlYXRlIHBvbGljeSIKICAgICAgfSkpOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlckNvbmZpcm1Nb2RhbCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyQ29uZmlybU1vZGFsKCkgewogICAgICB2YXIgcmVuZGVyQ29uZmlybU1vZGFsID0gdGhpcy5zdGF0ZS5yZW5kZXJDb25maXJtTW9kYWw7CgogICAgICBpZiAocmVuZGVyQ29uZmlybU1vZGFsKSB7CiAgICAgICAgcmV0dXJuIHJlbmRlckNvbmZpcm1Nb2RhbCgpOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAiYnVpbGRBY3Rpb25QYW5lbFRyZWUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGJ1aWxkQWN0aW9uUGFuZWxUcmVlKHBvbGljeSkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHZhciBoYXNMaW5rZWRJbmRpY2VzID0gQm9vbGVhbihwb2xpY3kubGlua2VkSW5kaWNlcyAmJiBwb2xpY3kubGlua2VkSW5kaWNlcy5sZW5ndGgpOwoKICAgICAgdmFyIHZpZXdJbmRpY2VzTGFiZWwgPSBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaW5kZXhMaWZlY3ljbGVNZ210LnBvbGljeVRhYmxlLnZpZXdJbmRpY2VzQnV0dG9uVGV4dCcsIHsKICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1ZpZXcgaW5kaWNlcyBsaW5rZWQgdG8gcG9saWN5JwogICAgICB9KTsKCiAgICAgIHZhciBhZGRQb2xpY3lUb1RlbXBsYXRlTGFiZWwgPSBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaW5kZXhMaWZlY3ljbGVNZ210LnBvbGljeVRhYmxlLmFkZFBvbGljeVRvVGVtcGxhdGVCdXR0b25UZXh0JywgewogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnQWRkIHBvbGljeSB0byBpbmRleCB0ZW1wbGF0ZScKICAgICAgfSk7CgogICAgICB2YXIgZGVsZXRlUG9saWN5TGFiZWwgPSBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaW5kZXhMaWZlY3ljbGVNZ210LnBvbGljeVRhYmxlLmRlbGV0ZVBvbGljeUJ1dHRvblRleHQnLCB7CiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdEZWxldGUgcG9saWN5JwogICAgICB9KTsKCiAgICAgIHZhciBkZWxldGVQb2xpY3lUb29sdGlwID0gaGFzTGlua2VkSW5kaWNlcyA/IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5pbmRleExpZmVjeWNsZU1nbXQucG9saWN5VGFibGUuZGVsZXRlUG9saWN5QnV0dG9uRGlzYWJsZWRUb29sdGlwJywgewogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnWW91IGNhbm5vdCBkZWxldGUgYSBwb2xpY3kgdGhhdCBpcyBiZWluZyB1c2VkIGJ5IGFuIGluZGV4JwogICAgICB9KSA6IG51bGw7CiAgICAgIHZhciBpdGVtcyA9IFtdOwoKICAgICAgaWYgKGhhc0xpbmtlZEluZGljZXMpIHsKICAgICAgICBpdGVtcy5wdXNoKHsKICAgICAgICAgIG5hbWU6IHZpZXdJbmRpY2VzTGFiZWwsCiAgICAgICAgICBpY29uOiAnbGlzdCcsCiAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaGFzaCA9ICgwLCBfbmF2aWdhdGlvbi5nZXRJbmRleExpc3RVcmkpKCJpbG0ucG9saWN5OiIuY29uY2F0KHBvbGljeS5uYW1lKSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGl0ZW1zLnB1c2goewogICAgICAgIG5hbWU6IGFkZFBvbGljeVRvVGVtcGxhdGVMYWJlbCwKICAgICAgICBpY29uOiAncGx1c0luQ2lyY2xlJywKICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgcmV0dXJuIF90aGlzMy5zZXRTdGF0ZSh7CiAgICAgICAgICAgIHJlbmRlckNvbmZpcm1Nb2RhbDogX3RoaXMzLnJlbmRlckFkZFBvbGljeVRvVGVtcGxhdGVDb25maXJtTW9kYWwsCiAgICAgICAgICAgIHBvbGljeVRvQWRkVG9UZW1wbGF0ZTogcG9saWN5CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICBpdGVtcy5wdXNoKHsKICAgICAgICBuYW1lOiBkZWxldGVQb2xpY3lMYWJlbCwKICAgICAgICBkaXNhYmxlZDogaGFzTGlua2VkSW5kaWNlcywKICAgICAgICBpY29uOiAndHJhc2gnLAogICAgICAgIHRvb2xUaXBDb250ZW50OiBkZWxldGVQb2xpY3lUb29sdGlwLAogICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXMzLnNldFN0YXRlKHsKICAgICAgICAgICAgcmVuZGVyQ29uZmlybU1vZGFsOiBfdGhpczMucmVuZGVyRGVsZXRlQ29uZmlybU1vZGFsLAogICAgICAgICAgICBwb2xpY3lUb0RlbGV0ZTogcG9saWN5CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICB2YXIgcGFuZWxUcmVlID0gewogICAgICAgIGlkOiAwLAogICAgICAgIHRpdGxlOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaW5kZXhMaWZlY3ljbGVNZ210LnBvbGljeVRhYmxlLnBvbGljeUFjdGlvbnNNZW51LnBhbmVsVGl0bGUnLCB7CiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1BvbGljeSBvcHRpb25zJwogICAgICAgIH0pLAogICAgICAgIGl0ZW1zOiBpdGVtcwogICAgICB9OwogICAgICByZXR1cm4gKDAsIF9mbGF0dGVuX3BhbmVsX3RyZWUuZmxhdHRlblBhbmVsVHJlZSkocGFuZWxUcmVlKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJidWlsZFJvd0NlbGxzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBidWlsZFJvd0NlbGxzKHBvbGljeSkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgIHZhciBuYW1lID0gcG9saWN5Lm5hbWU7CiAgICAgIHZhciBjZWxscyA9IE9iamVjdC5lbnRyaWVzKENPTFVNTlMpLm1hcChmdW5jdGlvbiAoX3JlZjMpIHsKICAgICAgICB2YXIgX3JlZjQgPSBfc2xpY2VkVG9BcnJheShfcmVmMywgMiksCiAgICAgICAgICAgIGZpZWxkTmFtZSA9IF9yZWY0WzBdLAogICAgICAgICAgICB3aWR0aCA9IF9yZWY0WzFdLndpZHRoOwoKICAgICAgICB2YXIgdmFsdWUgPSBwb2xpY3lbZmllbGROYW1lXTsKCiAgICAgICAgaWYgKGZpZWxkTmFtZSA9PT0gJ25hbWUnKSB7CiAgICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgidGgiLCB7CiAgICAgICAgICAgIGtleTogIiIuY29uY2F0KGZpZWxkTmFtZSwgIi0iKS5jb25jYXQobmFtZSksCiAgICAgICAgICAgIGNsYXNzTmFtZTogImV1aVRhYmxlUm93Q2VsbCIsCiAgICAgICAgICAgIHNjb3BlOiAicm93IiwKICAgICAgICAgICAgImRhdGEtdGVzdC1zdWJqIjogInBvbGljeVRhYmxlQ2VsbC0iLmNvbmNhdChmaWVsZE5hbWUpCiAgICAgICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgICAgIGNsYXNzTmFtZTogImV1aVRhYmxlQ2VsbENvbnRlbnQgcG9saWN5VGFibGVfX2NvbnRlbnQtLSIuY29uY2F0KGZpZWxkTmFtZSkKICAgICAgICAgIH0sIF90aGlzNC5idWlsZFJvd0NlbGwoZmllbGROYW1lLCB2YWx1ZSkpKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVGFibGVSb3dDZWxsLCB7CiAgICAgICAgICBrZXk6ICIiLmNvbmNhdChmaWVsZE5hbWUsICItIikuY29uY2F0KG5hbWUpLAogICAgICAgICAgdHJ1bmNhdGVUZXh0OiBmYWxzZSwKICAgICAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJwb2xpY3lUYWJsZUNlbGwtIi5jb25jYXQoZmllbGROYW1lKSwKICAgICAgICAgIGNsYXNzTmFtZTogJ3BvbGljeVRhYmxlX19jb250ZW50LS0nICsgZmllbGROYW1lLAogICAgICAgICAgd2lkdGg6IHdpZHRoCiAgICAgICAgfSwgX3RoaXM0LmJ1aWxkUm93Q2VsbChmaWVsZE5hbWUsIHZhbHVlKSk7CiAgICAgIH0pOwoKICAgICAgdmFyIGJ1dHRvbiA9IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlCdXR0b25FbXB0eSwgewogICAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJwb2xpY3lBY3Rpb25zQ29udGV4dE1lbnVCdXR0b24iLAogICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXM0LnRvZ2dsZVBvbGljeVBvcG92ZXIocG9saWN5KTsKICAgICAgICB9LAogICAgICAgIGNvbG9yOiAicHJpbWFyeSIKICAgICAgfSwgX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLmluZGV4TGlmZWN5Y2xlTWdtdC5wb2xpY3lUYWJsZS5hY3Rpb25zQnV0dG9uVGV4dCcsIHsKICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0FjdGlvbnMnCiAgICAgIH0pKTsKCiAgICAgIGNlbGxzLnB1c2goX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRhYmxlUm93Q2VsbCwgewogICAgICAgIGFsaWduOiBfc2VydmljZXMuUklHSFRfQUxJR05NRU5ULAogICAgICAgIGtleTogImRlbGV0ZS0iLmNvbmNhdChuYW1lKSwKICAgICAgICB0cnVuY2F0ZVRleHQ6IGZhbHNlLAogICAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJwb2xpY3lUYWJsZUNlbGwtYWN0aW9ucy0iLmNvbmNhdChuYW1lKSwKICAgICAgICBzdHlsZTogewogICAgICAgICAgd2lkdGg6IDE1MAogICAgICAgIH0KICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVBvcG92ZXIsIHsKICAgICAgICBpZDogImNvbnRleHRNZW51UG9saWN5IiwKICAgICAgICBidXR0b246IGJ1dHRvbiwKICAgICAgICBpc09wZW46IHRoaXMuaXNQb2xpY3lQb3BvdmVyT3Blbihwb2xpY3kpLAogICAgICAgIGNsb3NlUG9wb3ZlcjogZnVuY3Rpb24gY2xvc2VQb3BvdmVyKCkgewogICAgICAgICAgcmV0dXJuIF90aGlzNC5jbG9zZVBvbGljeVBvcG92ZXIocG9saWN5KTsKICAgICAgICB9LAogICAgICAgIHBhbmVsUGFkZGluZ1NpemU6ICJub25lIiwKICAgICAgICB3aXRoVGl0bGU6IHRydWUsCiAgICAgICAgYW5jaG9yUG9zaXRpb246ICJyaWdodFVwIiwKICAgICAgICByZXBvc2l0aW9uT25TY3JvbGw6IHRydWUKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUNvbnRleHRNZW51LCB7CiAgICAgICAgaW5pdGlhbFBhbmVsSWQ6IDAsCiAgICAgICAgcGFuZWxzOiB0aGlzLmJ1aWxkQWN0aW9uUGFuZWxUcmVlKHBvbGljeSkKICAgICAgfSkpKSk7CiAgICAgIHJldHVybiBjZWxsczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJidWlsZFJvd3MiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGJ1aWxkUm93cygpIHsKICAgICAgdmFyIF90aGlzNSA9IHRoaXM7CgogICAgICB2YXIgX3RoaXMkcHJvcHMkcG9saWNpZXMgPSB0aGlzLnByb3BzLnBvbGljaWVzLAogICAgICAgICAgcG9saWNpZXMgPSBfdGhpcyRwcm9wcyRwb2xpY2llcyA9PT0gdm9pZCAwID8gW10gOiBfdGhpcyRwcm9wcyRwb2xpY2llczsKICAgICAgcmV0dXJuIHBvbGljaWVzLm1hcChmdW5jdGlvbiAocG9saWN5KSB7CiAgICAgICAgdmFyIG5hbWUgPSBwb2xpY3kubmFtZTsKICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRhYmxlUm93LCB7CiAgICAgICAgICBrZXk6ICIiLmNvbmNhdChuYW1lLCAiLXJvdyIpCiAgICAgICAgfSwgX3RoaXM1LmJ1aWxkUm93Q2VsbHMocG9saWN5KSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlclBhZ2VyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJQYWdlcigpIHsKICAgICAgdmFyIF90aGlzJHByb3BzMyA9IHRoaXMucHJvcHMsCiAgICAgICAgICBwYWdlciA9IF90aGlzJHByb3BzMy5wYWdlciwKICAgICAgICAgIHBvbGljeVBhZ2VDaGFuZ2VkID0gX3RoaXMkcHJvcHMzLnBvbGljeVBhZ2VDaGFuZ2VkLAogICAgICAgICAgcG9saWN5UGFnZVNpemVDaGFuZ2VkID0gX3RoaXMkcHJvcHMzLnBvbGljeVBhZ2VTaXplQ2hhbmdlZDsKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUYWJsZVBhZ2luYXRpb24sIHsKICAgICAgICBhY3RpdmVQYWdlOiBwYWdlci5nZXRDdXJyZW50UGFnZUluZGV4KCksCiAgICAgICAgaXRlbXNQZXJQYWdlOiBwYWdlci5pdGVtc1BlclBhZ2UsCiAgICAgICAgaXRlbXNQZXJQYWdlT3B0aW9uczogWzEwLCA1MCwgMTAwXSwKICAgICAgICBwYWdlQ291bnQ6IHBhZ2VyLmdldFRvdGFsUGFnZXMoKSwKICAgICAgICBvbkNoYW5nZUl0ZW1zUGVyUGFnZTogcG9saWN5UGFnZVNpemVDaGFuZ2VkLAogICAgICAgIG9uQ2hhbmdlUGFnZTogcG9saWN5UGFnZUNoYW5nZWQKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVuZGVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7CiAgICAgIHZhciBfdGhpczYgPSB0aGlzOwoKICAgICAgdmFyIF90aGlzJHByb3BzNCA9IHRoaXMucHJvcHMsCiAgICAgICAgICB0b3RhbE51bWJlck9mUG9saWNpZXMgPSBfdGhpcyRwcm9wczQudG90YWxOdW1iZXJPZlBvbGljaWVzLAogICAgICAgICAgcG9saWN5RmlsdGVyQ2hhbmdlZCA9IF90aGlzJHByb3BzNC5wb2xpY3lGaWx0ZXJDaGFuZ2VkLAogICAgICAgICAgZmlsdGVyID0gX3RoaXMkcHJvcHM0LmZpbHRlciwKICAgICAgICAgIHBvbGljeUxpc3RMb2FkZWQgPSBfdGhpcyRwcm9wczQucG9saWN5TGlzdExvYWRlZCwKICAgICAgICAgIHBvbGljaWVzID0gX3RoaXMkcHJvcHM0LnBvbGljaWVzOwogICAgICB2YXIgc2VsZWN0ZWRQb2xpY2llc01hcCA9IHRoaXMuc3RhdGUuc2VsZWN0ZWRQb2xpY2llc01hcDsKICAgICAgdmFyIG51bVNlbGVjdGVkID0gT2JqZWN0LmtleXMoc2VsZWN0ZWRQb2xpY2llc01hcCkubGVuZ3RoOwogICAgICB2YXIgY29udGVudDsKICAgICAgdmFyIHRhYmxlQ29udGVudDsKCiAgICAgIGlmICh0b3RhbE51bWJlck9mUG9saWNpZXMgfHwgIXBvbGljeUxpc3RMb2FkZWQpIHsKICAgICAgICBpZiAoIXBvbGljeUxpc3RMb2FkZWQpIHsKICAgICAgICAgIHRhYmxlQ29udGVudCA9IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlMb2FkaW5nU3Bpbm5lciwgewogICAgICAgICAgICBzaXplOiAibSIKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSBpZiAodG90YWxOdW1iZXJPZlBvbGljaWVzID4gMCkgewogICAgICAgICAgdGFibGVDb250ZW50ID0gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRhYmxlLCB7CiAgICAgICAgICAgIGNsYXNzTmFtZTogInBvbGljeVRhYmxlX19ob3Jpem9udGFsU2Nyb2xsIgogICAgICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNjcmVlblJlYWRlck9ubHksIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImNhcHRpb24iLCB7CiAgICAgICAgICAgIHJvbGU6ICJzdGF0dXMiLAogICAgICAgICAgICAiYXJpYS1yZWxldmFudCI6ICJ0ZXh0IiwKICAgICAgICAgICAgImFyaWEtbGl2ZSI6ICJwb2xpdGUiCiAgICAgICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgICAgICBpZDogInhwYWNrLmluZGV4TGlmZWN5Y2xlTWdtdC5wb2xpY3lUYWJsZS5jYXB0aW9uVGV4dCIsCiAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiQmVsb3cgaXMgdGhlIGluZGV4IGxpZmVjeWNsZSBwb2xpY3kgdGFibGUgY29udGFpbmluZyB7Y291bnQsIHBsdXJhbCwgb25lIHsjIHJvd30gb3RoZXIgeyMgcm93c319IG91dCBvZiB7dG90YWx9LiIsCiAgICAgICAgICAgIHZhbHVlczogewogICAgICAgICAgICAgIGNvdW50OiBwb2xpY2llcy5sZW5ndGgsCiAgICAgICAgICAgICAgdG90YWw6IHRvdGFsTnVtYmVyT2ZQb2xpY2llcwogICAgICAgICAgICB9CiAgICAgICAgICB9KSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVGFibGVIZWFkZXIsIG51bGwsIHRoaXMuYnVpbGRIZWFkZXIoKSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUYWJsZUJvZHksIG51bGwsIHRoaXMuYnVpbGRSb3dzKCkpKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGFibGVDb250ZW50ID0gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfbm9fbWF0Y2guTm9NYXRjaCwgbnVsbCk7CiAgICAgICAgfQoKICAgICAgICBjb250ZW50ID0gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRnJhZ21lbnQsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4R3JvdXAsIHsKICAgICAgICAgIGd1dHRlclNpemU6ICJsIiwKICAgICAgICAgIGFsaWduSXRlbXM6ICJjZW50ZXIiCiAgICAgICAgfSwgbnVtU2VsZWN0ZWQgPiAwID8gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICAgICAgICBncm93OiBmYWxzZQogICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlCdXR0b24sIHsKICAgICAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJkZWxldGVQb2xpY3lCdXR0b24iLAogICAgICAgICAgY29sb3I6ICJkYW5nZXIiLAogICAgICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHsKICAgICAgICAgICAgcmV0dXJuIF90aGlzNi5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgc2hvd0RlbGV0ZUNvbmZpcm1hdGlvbjogdHJ1ZQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgICAgaWQ6ICJ4cGFjay5pbmRleExpZmVjeWNsZU1nbXQucG9saWN5VGFibGUuZGVsZXRlZFBvbGljaWVzVGV4dCIsCiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkRlbGV0ZWQge251bVNlbGVjdGVkfSB7bnVtU2VsZWN0ZWQsIHBsdXJhbCwgb25lIHtwb2xpY3l9IG90aGVyIHtwb2xpY2llc319IiwKICAgICAgICAgIHZhbHVlczogewogICAgICAgICAgICBudW1TZWxlY3RlZDogbnVtU2VsZWN0ZWQKICAgICAgICAgIH0KICAgICAgICB9KSkpIDogbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmllbGRTZWFyY2gsIHsKICAgICAgICAgIGZ1bGxXaWR0aDogdHJ1ZSwKICAgICAgICAgIHZhbHVlOiBmaWx0ZXIsCiAgICAgICAgICBvbkNoYW5nZTogZnVuY3Rpb24gb25DaGFuZ2UoZXZlbnQpIHsKICAgICAgICAgICAgcG9saWN5RmlsdGVyQ2hhbmdlZChldmVudC50YXJnZXQudmFsdWUpOwogICAgICAgICAgfSwKICAgICAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJwb2xpY3lUYWJsZUZpbHRlcklucHV0IiwKICAgICAgICAgIHBsYWNlaG9sZGVyOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaW5kZXhMaWZlY3ljbGVNZ210LnBvbGljeVRhYmxlLnN5c3RlbXBvbGljaWVzU2VhcmNoSW5wdXRQbGFjZWhvbGRlcicsIHsKICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdTZWFyY2gnCiAgICAgICAgICB9KSwKICAgICAgICAgICJhcmlhLWxhYmVsIjogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLmluZGV4TGlmZWN5Y2xlTWdtdC5wb2xpY3lUYWJsZS5zeXN0ZW1wb2xpY2llc1NlYXJjaElucHV0QXJpYUxhYmVsJywgewogICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1NlYXJjaCBwb2xpY2llcycKICAgICAgICAgIH0pCiAgICAgICAgfSkpKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgewogICAgICAgICAgc2l6ZTogIm0iCiAgICAgICAgfSksIHRhYmxlQ29udGVudCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29udGVudCA9IHRoaXMucmVuZGVyRW1wdHkoKTsKICAgICAgfQoKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlQYWdlQm9keSwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVBhZ2VDb250ZW50LCB7CiAgICAgICAgdmVydGljYWxQb3NpdGlvbjogImNlbnRlciIsCiAgICAgICAgaG9yaXpvbnRhbFBvc2l0aW9uOiAiY2VudGVyIgogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJkaXYiLCBudWxsLCB0aGlzLnJlbmRlckNvbmZpcm1Nb2RhbCgpLCB0b3RhbE51bWJlck9mUG9saWNpZXMgfHwgIXBvbGljeUxpc3RMb2FkZWQgPyBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5GcmFnbWVudCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhHcm91cCwgewogICAgICAgIGp1c3RpZnlDb250ZW50OiAic3BhY2VCZXR3ZWVuIiwKICAgICAgICBhbGlnbkl0ZW1zOiAiY2VudGVyIgogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgICAgICBncm93OiBmYWxzZQogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVGl0bGUsIHsKICAgICAgICBzaXplOiAibCIKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgiaDEiLCB7CiAgICAgICAgImRhdGEtdGVzdC1zdWJqIjogInNlY3Rpb25IZWFkaW5nIgogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAieHBhY2suaW5kZXhMaWZlY3ljbGVNZ210LnBvbGljeVRhYmxlLnNlY3Rpb25IZWFkaW5nIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkluZGV4IExpZmVjeWNsZSBQb2xpY2llcyIKICAgICAgfSkpKSksIHRvdGFsTnVtYmVyT2ZQb2xpY2llcyA/IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgICAgIGdyb3c6IGZhbHNlCiAgICAgIH0sIHRoaXMucmVuZGVyQ3JlYXRlUG9saWN5QnV0dG9uKCkpIDogbnVsbCksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTcGFjZXIsIHsKICAgICAgICBzaXplOiAicyIKICAgICAgfSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUZXh0LCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJwIiwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogInhwYWNrLmluZGV4TGlmZWN5Y2xlTWdtdC5wb2xpY3lUYWJsZS5zZWN0aW9uRGVzY3JpcHRpb24iLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiTWFuYWdlIHlvdXIgaW5kaWNlcyBhcyB0aGV5IGFnZS4gIEF0dGFjaCBhIHBvbGljeSB0byBhdXRvbWF0ZSB3aGVuIGFuZCBob3cgdG8gdHJhbnNpdGlvbiBhbiBpbmRleCB0aHJvdWdoIGl0cyBsaWZlY3ljbGUuIgogICAgICB9KSkpKSA6IG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTcGFjZXIsIG51bGwpLCBjb250ZW50LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3BhY2VyLCB7CiAgICAgICAgc2l6ZTogIm0iCiAgICAgIH0pLCB0b3RhbE51bWJlck9mUG9saWNpZXMgJiYgdG90YWxOdW1iZXJPZlBvbGljaWVzID4gMTAgPyB0aGlzLnJlbmRlclBhZ2VyKCkgOiBudWxsKSkpOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIFBvbGljeVRhYmxlOwp9KF9yZWFjdC5Db21wb25lbnQpOwoKZXhwb3J0cy5Qb2xpY3lUYWJsZSA9IFBvbGljeVRhYmxlOw=="},null]}