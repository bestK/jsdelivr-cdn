/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License; you may not use this file except in compliance with the Elastic License. */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[53],{12:function(module,exports,__webpack_require__){module.exports=__webpack_require__(34)(1761)},151:function(module,exports,__webpack_require__){module.exports=__webpack_require__(17)(2986)},2304:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.checkLicense=checkLicense;var _i18n=__webpack_require__(2);var _types=__webpack_require__(698);var _utils=__webpack_require__(152);function checkLicense(license){if(!license||!license.isAvailable){return{showAppLink:true,enableAppLink:false,message:_i18n.i18n.translate("xpack.graph.serverSideErrors.unavailableLicenseInformationErrorMessage",{defaultMessage:"Graph is unavailable - license information is not available at this time."})}}var graphFeature=license.getFeature("graph");if(!graphFeature.isEnabled){return{showAppLink:false,enableAppLink:false,message:_i18n.i18n.translate("xpack.graph.serverSideErrors.unavailableGraphErrorMessage",{defaultMessage:"Graph is unavailable"})}}var check=license.check("graph","platinum");switch(check.state){case _types.LICENSE_CHECK_STATE.Expired:return{showAppLink:true,enableAppLink:false,message:check.message||""};case _types.LICENSE_CHECK_STATE.Invalid:case _types.LICENSE_CHECK_STATE.Unavailable:return{showAppLink:false,enableAppLink:false,message:check.message||""};case _types.LICENSE_CHECK_STATE.Valid:return{showAppLink:true,enableAppLink:true,message:""};default:return(0,_utils.assertNever)(check.state)}}},2305:function(module,exports,__webpack_require__){module.exports=__webpack_require__(34)(1908)},252:function(module,exports,__webpack_require__){module.exports=__webpack_require__(26)(1108)},331:function(module,exports,__webpack_require__){module.exports=__webpack_require__(34)(1365)},333:function(module,exports,__webpack_require__){module.exports=__webpack_require__(26)(2677)},696:function(module,exports,__webpack_require__){module.exports=__webpack_require__(17)(3123)},698:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.LICENSE_TYPE=exports.LICENSE_CHECK_STATE=void 0;var LICENSE_CHECK_STATE;exports.LICENSE_CHECK_STATE=LICENSE_CHECK_STATE;(function(LICENSE_CHECK_STATE){LICENSE_CHECK_STATE["Unavailable"]="UNAVAILABLE";LICENSE_CHECK_STATE["Invalid"]="INVALID";LICENSE_CHECK_STATE["Expired"]="EXPIRED";LICENSE_CHECK_STATE["Valid"]="VALID"})(LICENSE_CHECK_STATE||(exports.LICENSE_CHECK_STATE=LICENSE_CHECK_STATE={}));var LICENSE_TYPE;exports.LICENSE_TYPE=LICENSE_TYPE;(function(LICENSE_TYPE){LICENSE_TYPE[LICENSE_TYPE["basic"]=10]="basic";LICENSE_TYPE[LICENSE_TYPE["standard"]=20]="standard";LICENSE_TYPE[LICENSE_TYPE["gold"]=30]="gold";LICENSE_TYPE[LICENSE_TYPE["platinum"]=40]="platinum";LICENSE_TYPE[LICENSE_TYPE["enterprise"]=50]="enterprise";LICENSE_TYPE[LICENSE_TYPE["trial"]=60]="trial"})(LICENSE_TYPE||(exports.LICENSE_TYPE=LICENSE_TYPE={}))},7006:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.renderApp=void 0;var _eui=__webpack_require__(1);var _angular=_interopRequireDefault(__webpack_require__(40));var _angular2=__webpack_require__(78);var _legacy_imports=__webpack_require__(7239);var _app=__webpack_require__(7895);var _check_license=__webpack_require__(2304);var _saved_workspace_loader=__webpack_require__(7934);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _objectWithoutProperties(source,excluded){if(source==null)return{};var target=_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function _objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}var renderApp=function renderApp(_ref){var appBasePath=_ref.appBasePath,element=_ref.element,deps=_objectWithoutProperties(_ref,["appBasePath","element"]);var graphAngularModule=createLocalAngularModule(deps.navigation);(0,_legacy_imports.configureAppAngularModule)(graphAngularModule,deps.coreStart,true);var licenseSubscription=deps.licensing.license$.subscribe((function(license){var info=(0,_check_license.checkLicense)(license);var licenseAllowsToShowThisPage=info.showAppLink&&info.enableAppLink;if(!licenseAllowsToShowThisPage){var newUrl=(0,_legacy_imports.addAppRedirectMessageToUrl)(deps.addBasePath("/app/kibana"),info.message);window.location.href=newUrl}}));var savedWorkspaceLoader=(0,_saved_workspace_loader.createSavedWorkspacesLoader)({chrome:deps.coreStart.chrome,indexPatterns:deps.npData.indexPatterns,overlays:deps.coreStart.overlays,savedObjectsClient:deps.coreStart.savedObjects.client,basePath:deps.coreStart.http.basePath});(0,_app.initGraphApp)(graphAngularModule,_objectSpread({},deps,{savedWorkspaceLoader:savedWorkspaceLoader}));var $injector=mountGraphApp(appBasePath,element);return function(){licenseSubscription.unsubscribe();$injector.get("$rootScope").$destroy()}};exports.renderApp=renderApp;var mainTemplate=function mainTemplate(basePath){return'<div ng-view class="kbnLocalApplicationWrapper">\n  <base href="'.concat(basePath,'" />\n</div>\n')};var moduleName="app/graph";var thirdPartyAngularDependencies=["ngSanitize","ngRoute","react","ui.bootstrap","ui.ace"];function mountGraphApp(appBasePath,element){var mountpoint=document.createElement("div");mountpoint.setAttribute("class","kbnLocalApplicationWrapper");mountpoint.innerHTML=mainTemplate(appBasePath);var $injector=_angular.default.bootstrap(mountpoint,[moduleName]);element.appendChild(mountpoint);return $injector}function createLocalAngularModule(navigation){createLocalI18nModule();createLocalTopNavModule(navigation);createLocalConfirmModalModule();var graphAngularModule=_angular.default.module(moduleName,[].concat(thirdPartyAngularDependencies,["graphI18n","graphTopNav","graphConfirmModal"]));return graphAngularModule}function createLocalConfirmModalModule(){_angular.default.module("graphConfirmModal",["react"]).factory("confirmModal",_legacy_imports.confirmModalFactory).directive("confirmModal",(function(reactDirective){return reactDirective(_eui.EuiConfirmModal)}))}function createLocalTopNavModule(navigation){_angular.default.module("graphTopNav",["react"]).directive("kbnTopNav",_legacy_imports.createTopNavDirective).directive("kbnTopNavHelper",(0,_legacy_imports.createTopNavHelper)(navigation.ui))}function createLocalI18nModule(){_angular.default.module("graphI18n",[]).provider("i18n",_angular2.I18nProvider).filter("i18n",_angular2.i18nFilter).directive("i18nId",_angular2.i18nDirective)}},7086:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.hasDatasourceSelector=exports.datasourceSelector=exports.datasourceReducer=exports.datasourceLoaded=exports.requestDatasource=exports.setDatasource=void 0;var _typescriptFsa=_interopRequireDefault(__webpack_require__(252));var _dist=__webpack_require__(333);var _reselect=__webpack_require__(151);var _global=__webpack_require__(7118);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var actionCreator=(0,_typescriptFsa.default)("x-pack/graph/datasource");var setDatasource=actionCreator("SET_DATASOURCE");exports.setDatasource=setDatasource;var requestDatasource=actionCreator("SET_DATASOURCE_REQUEST");exports.requestDatasource=requestDatasource;var datasourceLoaded=actionCreator("SET_DATASOURCE_SUCCESS");exports.datasourceLoaded=datasourceLoaded;var initialDatasource={current:{type:"none"},loading:false};var datasourceReducer=(0,_dist.reducerWithInitialState)(initialDatasource).case(_global.reset,(function(){return initialDatasource})).case(setDatasource,(function(_oldDatasource,newDatasource){return{current:newDatasource,loading:false}})).case(requestDatasource,(function(_oldDatasource,newDatasource){return{current:newDatasource,loading:true}})).case(datasourceLoaded,(function(datasource){return _objectSpread({},datasource,{loading:false})})).build();exports.datasourceReducer=datasourceReducer;var datasourceSelector=function datasourceSelector(state){return state.datasource};exports.datasourceSelector=datasourceSelector;var hasDatasourceSelector=(0,_reselect.createSelector)(datasourceSelector,(function(datasource){return datasource.current.type!=="none"}));exports.hasDatasourceSelector=hasDatasourceSelector},7117:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _fields=__webpack_require__(7140);Object.keys(_fields).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _fields[key]}})}));var _url_templates=__webpack_require__(7241);Object.keys(_url_templates).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _url_templates[key]}})}));var _advanced_settings=__webpack_require__(7172);Object.keys(_advanced_settings).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _advanced_settings[key]}})}));var _datasource=__webpack_require__(7086);Object.keys(_datasource).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _datasource[key]}})}));var _datasource2=__webpack_require__(7421);Object.keys(_datasource2).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _datasource2[key]}})}));var _meta_data=__webpack_require__(7245);Object.keys(_meta_data).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _meta_data[key]}})}));var _persistence=__webpack_require__(7422);Object.keys(_persistence).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _persistence[key]}})}));var _workspace=__webpack_require__(7423);Object.keys(_workspace).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _workspace[key]}})}));var _global=__webpack_require__(7118);Object.keys(_global).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _global[key]}})}));var _store=__webpack_require__(7911);Object.keys(_store).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _store[key]}})}))},7118:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.reset=void 0;var _typescriptFsa=_interopRequireDefault(__webpack_require__(252));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var actionCreator=(0,_typescriptFsa.default)("x-pack/graph");var reset=actionCreator("RESET");exports.reset=reset},7140:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.syncNodeStyleSaga=exports.syncFieldsSaga=exports.updateSaveButtonSaga=exports.hasFieldsSelector=exports.liveResponseFieldsSelector=exports.selectedFieldsSelector=exports.fieldsSelector=exports.fieldMapSelector=exports.fieldsReducer=exports.deselectField=exports.selectField=exports.updateFieldProperties=exports.loadFields=void 0;var _typescriptFsa=_interopRequireDefault(__webpack_require__(252));var _dist=__webpack_require__(333);var _reselect=__webpack_require__(151);var _effects=__webpack_require__(331);var _global=__webpack_require__(7118);var _datasource=__webpack_require__(7086);var _helpers=__webpack_require__(7420);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var actionCreator=(0,_typescriptFsa.default)("x-pack/graph/fields");var loadFields=actionCreator("LOAD_FIELDS");exports.loadFields=loadFields;var updateFieldProperties=actionCreator("UPDATE_FIELD_PROPERTIES");exports.updateFieldProperties=updateFieldProperties;var selectField=actionCreator("SELECT_FIELD");exports.selectField=selectField;var deselectField=actionCreator("DESELECT_FIELD");exports.deselectField=deselectField;var initialFields={};var fieldsReducer=(0,_dist.reducerWithInitialState)(initialFields).case(_global.reset,(function(){return initialFields})).case(_datasource.setDatasource,(function(){return initialFields})).case(loadFields,(function(_currentFields,newFields){var newFieldMap={};newFields.forEach((function(field){newFieldMap[field.name]=field}));return newFieldMap})).case(updateFieldProperties,(function(fields,_ref){var fieldName=_ref.fieldName,fieldProperties=_ref.fieldProperties;return _objectSpread({},fields,_defineProperty({},fieldName,_objectSpread({},fields[fieldName],{},fieldProperties)))})).case(selectField,(function(fields,fieldName){return _objectSpread({},fields,_defineProperty({},fieldName,_objectSpread({},fields[fieldName],{selected:true})))})).case(deselectField,(function(fields,fieldName){return _objectSpread({},fields,_defineProperty({},fieldName,_objectSpread({},fields[fieldName],{selected:false})))})).build();exports.fieldsReducer=fieldsReducer;var fieldMapSelector=function fieldMapSelector(state){return state.fields};exports.fieldMapSelector=fieldMapSelector;var fieldsSelector=(0,_reselect.createSelector)(fieldMapSelector,(function(fields){return Object.values(fields)}));exports.fieldsSelector=fieldsSelector;var selectedFieldsSelector=(0,_reselect.createSelector)(fieldsSelector,(function(fields){return fields.filter((function(field){return field.selected}))}));exports.selectedFieldsSelector=selectedFieldsSelector;var liveResponseFieldsSelector=(0,_reselect.createSelector)(selectedFieldsSelector,(function(fields){return fields.filter((function(field){return field.hopSize&&field.hopSize>0}))}));exports.liveResponseFieldsSelector=liveResponseFieldsSelector;var hasFieldsSelector=(0,_reselect.createSelector)(selectedFieldsSelector,(function(fields){return fields.length>0}));exports.hasFieldsSelector=hasFieldsSelector;var updateSaveButtonSaga=function updateSaveButtonSaga(_ref2){var _marked=regeneratorRuntime.mark(notify);var notifyAngular=_ref2.notifyAngular;function notify(){return regeneratorRuntime.wrap((function notify$(_context){while(1){switch(_context.prev=_context.next){case 0:notifyAngular();case 1:case"end":return _context.stop()}}}),_marked)}return(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return(0,_effects.takeLatest)((0,_helpers.matchesOne)(selectField,deselectField),notify);case 2:case"end":return _context2.stop()}}}),_callee)})))};exports.updateSaveButtonSaga=updateSaveButtonSaga;var syncFieldsSaga=function syncFieldsSaga(_ref3){var _marked2=regeneratorRuntime.mark(syncFields);var getWorkspace=_ref3.getWorkspace,setLiveResponseFields=_ref3.setLiveResponseFields;function syncFields(){var workspace,currentState;return regeneratorRuntime.wrap((function syncFields$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:workspace=getWorkspace();if(workspace){_context3.next=3;break}return _context3.abrupt("return");case 3:_context3.next=5;return(0,_effects.select)();case 5:currentState=_context3.sent;workspace.options.vertex_fields=selectedFieldsSelector(currentState);setLiveResponseFields(liveResponseFieldsSelector(currentState));case 8:case"end":return _context3.stop()}}}),_marked2)}return(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return(0,_effects.takeEvery)((0,_helpers.matchesOne)(loadFields,selectField,deselectField,updateFieldProperties),syncFields);case 2:case"end":return _context4.stop()}}}),_callee2)})))};exports.syncFieldsSaga=syncFieldsSaga;var syncNodeStyleSaga=function syncNodeStyleSaga(_ref4){var _marked3=regeneratorRuntime.mark(syncNodeStyle);var getWorkspace=_ref4.getWorkspace,notifyAngular=_ref4.notifyAngular;function syncNodeStyle(action){var workspace,newColor,newIcon,selectedFields;return regeneratorRuntime.wrap((function syncNodeStyle$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:workspace=getWorkspace();if(workspace){_context5.next=3;break}return _context5.abrupt("return");case 3:newColor=action.payload.fieldProperties.color;if(newColor){workspace.nodes.forEach((function(node){if(node.data.field===action.payload.fieldName){node.color=newColor}}))}newIcon=action.payload.fieldProperties.icon;if(newIcon){workspace.nodes.forEach((function(node){if(node.data.field===action.payload.fieldName){node.icon=newIcon}}))}notifyAngular();_context5.t0=selectedFieldsSelector;_context5.next=11;return(0,_effects.select)();case 11:_context5.t1=_context5.sent;selectedFields=(0,_context5.t0)(_context5.t1);workspace.options.vertex_fields=selectedFields;case 14:case"end":return _context5.stop()}}}),_marked3)}return(regeneratorRuntime.mark((function _callee3(){return regeneratorRuntime.wrap((function _callee3$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return(0,_effects.takeLatest)(updateFieldProperties.match,syncNodeStyle);case 2:case"end":return _context6.stop()}}}),_callee3)})))};exports.syncNodeStyleSaga=syncNodeStyleSaga},7171:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.colorChoices=exports.urlTemplateIconChoicesByClass=exports.urlTemplateIconChoices=exports.iconChoicesByClass=exports.getSuitableIcon=exports.iconChoices=void 0;var _i18n=__webpack_require__(2);var _services=__webpack_require__(51);var iconChoices=[{class:"fa-folder-open-o",code:"",patterns:[/category/i,/folder/i,/group/i],label:_i18n.i18n.translate("xpack.graph.icon.folderOpen",{defaultMessage:"Folder open"})},{class:"fa-cube",code:"",patterns:[/prod/i,/sku/i],label:_i18n.i18n.translate("xpack.graph.icon.cube",{defaultMessage:"Cube"})},{class:"fa-key",code:"",patterns:[/key/i],label:_i18n.i18n.translate("xpack.graph.icon.key",{defaultMessage:"Key"})},{class:"fa-bank",code:"",patterns:[/bank/i,/account/i],label:_i18n.i18n.translate("xpack.graph.icon.bank",{defaultMessage:"Bank"})},{class:"fa-automobile",code:"",patterns:[/car/i,/veh/i],label:_i18n.i18n.translate("xpack.graph.icon.automobile",{defaultMessage:"Automobile"})},{class:"fa-home",code:"",patterns:[/address/i,/home/i],label:_i18n.i18n.translate("xpack.graph.icon.home",{defaultMessage:"Home"})},{class:"fa-question",code:"",patterns:[/query/i,/search/i],label:_i18n.i18n.translate("xpack.graph.icon.question",{defaultMessage:"Question"})},{class:"fa-plane",code:"",patterns:[/flight/i,/plane/i],label:_i18n.i18n.translate("xpack.graph.icon.plane",{defaultMessage:"Plane"})},{class:"fa-file-o",code:"",patterns:[/file/i,/doc/i],label:_i18n.i18n.translate("xpack.graph.icon.file",{defaultMessage:"File open"})},{class:"fa-user",code:"",patterns:[/user/i,/person/i,/people/i,/owner/i,/cust/i,/participant/i,/party/i,/member/i],label:_i18n.i18n.translate("xpack.graph.icon.user",{defaultMessage:"User"})},{class:"fa-users",code:"",patterns:[/group/i,/team/i,/meeting/i],label:_i18n.i18n.translate("xpack.graph.icon.users",{defaultMessage:"Users"})},{class:"fa-music",code:"",patterns:[/artist/i,/sound/i,/music/i],label:_i18n.i18n.translate("xpack.graph.icon.music",{defaultMessage:"Music"})},{class:"fa-flag",code:"",patterns:[/country/i,/warn/i,/flag/i],label:_i18n.i18n.translate("xpack.graph.icon.flag",{defaultMessage:"Flag"})},{class:"fa-tag",code:"",patterns:[/tag/i,/label/i],label:"Tag"},{class:"fa-phone",code:"",patterns:[/phone/i],label:_i18n.i18n.translate("xpack.graph.icon.phone",{defaultMessage:"Phone"})},{class:"fa-desktop",code:"",patterns:[/host/i,/server/i],label:_i18n.i18n.translate("xpack.graph.icon.desktop",{defaultMessage:"Desktop"})},{class:"fa-font",code:"",patterns:[/text/i,/title/i,/body/i,/desc/i],label:_i18n.i18n.translate("xpack.graph.icon.font",{defaultMessage:"Font"})},{class:"fa-at",code:"",patterns:[/account/i,/email/i],label:_i18n.i18n.translate("xpack.graph.icon.at",{defaultMessage:"At"})},{class:"fa-heart",code:"",patterns:[/like/i,/favourite/i,/favorite/i],label:_i18n.i18n.translate("xpack.graph.icon.heart",{defaultMessage:"Heart"})},{class:"fa-bolt",code:"",patterns:[/action/i],label:_i18n.i18n.translate("xpack.graph.icon.bolt",{defaultMessage:"Bolt"})},{class:"fa-map-marker",code:"",patterns:[/location/i,/geo/i,/position/i],label:_i18n.i18n.translate("xpack.graph.icon.mapMarker",{defaultMessage:"Map marker"})},{class:"fa-exclamation",code:"",patterns:[/risk/i,/error/i,/warn/i],label:_i18n.i18n.translate("xpack.graph.icon.exclamation",{defaultMessage:"Exclamation"})},{class:"fa-industry",code:"",patterns:[/business/i,/company/i,/industry/i,/organisation/i],label:_i18n.i18n.translate("xpack.graph.icon.industry",{defaultMessage:"Industry"})}];exports.iconChoices=iconChoices;var getSuitableIcon=function getSuitableIcon(fieldName){return iconChoices.find((function(choice){return choice.patterns.some((function(pattern){return pattern.test(fieldName)}))}))||iconChoices[0]};exports.getSuitableIcon=getSuitableIcon;var iconChoicesByClass={};exports.iconChoicesByClass=iconChoicesByClass;iconChoices.forEach((function(icon){iconChoicesByClass[icon.class]=icon}));var urlTemplateIconChoices=[{class:"fa-line-chart",code:"",label:_i18n.i18n.translate("xpack.graph.icon.lineChart",{defaultMessage:"Line chart"})},{class:"fa-pie-chart",code:"",label:_i18n.i18n.translate("xpack.graph.icon.pieChart",{defaultMessage:"Pie chart"})},{class:"fa-area-chart",code:"",label:_i18n.i18n.translate("xpack.graph.icon.areaChart",{defaultMessage:"Area chart"})},{class:"fa-bar-chart",code:"",label:_i18n.i18n.translate("xpack.graph.icon.barChart",{defaultMessage:"Bar chart"})},{class:"fa-globe",code:"",label:_i18n.i18n.translate("xpack.graph.icon.globe",{defaultMessage:"Globe"})},{class:"fa-file-text-o",code:"",label:_i18n.i18n.translate("xpack.graph.icon.fileText",{defaultMessage:"File"})},{class:"fa-google",code:"",label:_i18n.i18n.translate("xpack.graph.icon.google",{defaultMessage:"Google"})},{class:"fa-eye",code:"",label:_i18n.i18n.translate("xpack.graph.icon.eye",{defaultMessage:"Eye"})},{class:"fa-tachometer",code:"",label:_i18n.i18n.translate("xpack.graph.icon.tachometer",{defaultMessage:"Tachometer"})},{class:"fa-info",code:"",label:_i18n.i18n.translate("xpack.graph.icon.info",{defaultMessage:"Info"})},{class:"fa-external-link",code:"",label:_i18n.i18n.translate("xpack.graph.icon.externalLink",{defaultMessage:"External link"})},{class:"fa-table",code:"",label:_i18n.i18n.translate("xpack.graph.icon.table",{defaultMessage:"Table"})},{class:"fa-list",code:"",label:_i18n.i18n.translate("xpack.graph.icon.list",{defaultMessage:"List"})},{class:"fa-share-alt",code:"",label:_i18n.i18n.translate("xpack.graph.icon.shareAlt",{defaultMessage:"Share alt"})}];exports.urlTemplateIconChoices=urlTemplateIconChoices;var urlTemplateIconChoicesByClass={};exports.urlTemplateIconChoicesByClass=urlTemplateIconChoicesByClass;urlTemplateIconChoices.forEach((function(icon){urlTemplateIconChoicesByClass[icon.class]=icon}));var colorChoices=(0,_services.euiPaletteColorBlind)();exports.colorChoices=colorChoices},7172:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.syncSettingsSaga=exports.settingsSelector=exports.advancedSettingsReducer=exports.updateSettings=void 0;var _typescriptFsa=_interopRequireDefault(__webpack_require__(252));var _dist=__webpack_require__(333);var _effects=__webpack_require__(331);var _global=__webpack_require__(7118);var _datasource=__webpack_require__(7086);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _objectWithoutProperties(source,excluded){if(source==null)return{};var target=_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function _objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}var actionCreator=(0,_typescriptFsa.default)("x-pack/graph/advancedSettings");var updateSettings=actionCreator("UPDATE_SETTINGS");exports.updateSettings=updateSettings;var initialSettings={useSignificance:true,sampleSize:2e3,timeoutMillis:5e3,sampleDiversityField:undefined,maxValuesPerDoc:1,minDocCount:3};var advancedSettingsReducer=(0,_dist.reducerWithInitialState)(initialSettings).case(_global.reset,(function(){return initialSettings})).cases([_datasource.requestDatasource,_datasource.setDatasource],(function(_ref){var sampleDiversityField=_ref.sampleDiversityField,restSettings=_objectWithoutProperties(_ref,["sampleDiversityField"]);return _objectSpread({},restSettings)})).case(updateSettings,(function(_oldSettings,newSettings){return newSettings})).build();exports.advancedSettingsReducer=advancedSettingsReducer;var settingsSelector=function settingsSelector(state){return state.advancedSettings};exports.settingsSelector=settingsSelector;var syncSettingsSaga=function syncSettingsSaga(_ref2){var _marked=regeneratorRuntime.mark(syncSettings);var getWorkspace=_ref2.getWorkspace,notifyAngular=_ref2.notifyAngular;function syncSettings(action){var workspace;return regeneratorRuntime.wrap((function syncSettings$(_context){while(1){switch(_context.prev=_context.next){case 0:workspace=getWorkspace();if(workspace){_context.next=3;break}return _context.abrupt("return");case 3:workspace.options.exploreControls=action.payload;notifyAngular();case 5:case"end":return _context.stop()}}}),_marked)}return(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return(0,_effects.takeLatest)(updateSettings.match,syncSettings);case 2:case"end":return _context2.stop()}}}),_callee)})))};exports.syncSettingsSaga=syncSettingsSaga},7239:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"SavedObject",{enumerable:true,get:function get(){return _types.SavedObject}});Object.defineProperty(exports,"SavedObjectKibanaServices",{enumerable:true,get:function get(){return _types.SavedObjectKibanaServices}});Object.defineProperty(exports,"configureAppAngularModule",{enumerable:true,get:function get(){return _legacy_compat.configureAppAngularModule}});Object.defineProperty(exports,"createTopNavDirective",{enumerable:true,get:function get(){return _kbn_top_nav.createTopNavDirective}});Object.defineProperty(exports,"createTopNavHelper",{enumerable:true,get:function get(){return _kbn_top_nav.createTopNavHelper}});Object.defineProperty(exports,"confirmModalFactory",{enumerable:true,get:function get(){return _confirm_modal.confirmModalFactory}});Object.defineProperty(exports,"addAppRedirectMessageToUrl",{enumerable:true,get:function get(){return _notify.addAppRedirectMessageToUrl}});Object.defineProperty(exports,"SaveResult",{enumerable:true,get:function get(){return _show_saved_object_save_modal.SaveResult}});Object.defineProperty(exports,"showSaveModal",{enumerable:true,get:function get(){return _show_saved_object_save_modal.showSaveModal}});Object.defineProperty(exports,"createSavedObjectClass",{enumerable:true,get:function get(){return _saved_object.createSavedObjectClass}});__webpack_require__(702);__webpack_require__(696);var _types=__webpack_require__(2309);var _legacy_compat=__webpack_require__(336);var _kbn_top_nav=__webpack_require__(532);var _confirm_modal=__webpack_require__(703);var _notify=__webpack_require__(15);var _show_saved_object_save_modal=__webpack_require__(531);var _saved_object=__webpack_require__(412)},7240:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _legacy_icon=__webpack_require__(7904);Object.keys(_legacy_icon).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _legacy_icon[key]}})}))},7241:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.syncTemplatesSaga=exports.templatesSelector=exports.urlTemplatesReducer=exports.removeTemplate=exports.saveTemplate=exports.loadTemplates=void 0;var _typescriptFsa=_interopRequireDefault(__webpack_require__(252));var _dist=__webpack_require__(333);var _kibana_parsed_url=__webpack_require__(1070);var _i18n=__webpack_require__(2);var _risonNode=_interopRequireDefault(__webpack_require__(163));var _effects=__webpack_require__(331);var _global=__webpack_require__(7118);var _datasource=__webpack_require__(7086);var _outlink_encoders=__webpack_require__(7242);var _url_template=__webpack_require__(7243);var _helpers=__webpack_require__(7420);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}var actionCreator=(0,_typescriptFsa.default)("x-pack/graph/urlTemplates");var loadTemplates=actionCreator("LOAD_TEMPLATES");exports.loadTemplates=loadTemplates;var saveTemplate=actionCreator("SAVE_TEMPLATE");exports.saveTemplate=saveTemplate;var removeTemplate=actionCreator("REMOVE_TEMPLATE");exports.removeTemplate=removeTemplate;var initialTemplates=[];function generateDefaultTemplate(datasource,basePath){var kUrl=new _kibana_parsed_url.KibanaParsedUrl({appId:"kibana",basePath:basePath,appPath:"/discover"});kUrl.addQueryParameter("_a",_risonNode.default.encode({columns:["_source"],index:datasource.id,interval:"auto",query:{language:"kuery",query:_url_template.urlTemplatePlaceholder},sort:["_score","desc"]}));var discoverUrl=kUrl.getRootRelativePath().replace(encodeURIComponent(_url_template.urlTemplatePlaceholder),_url_template.urlTemplatePlaceholder);return{url:discoverUrl,description:_i18n.i18n.translate("xpack.graph.settings.drillDowns.defaultUrlTemplateTitle",{defaultMessage:"Raw documents"}),encoder:_outlink_encoders.outlinkEncoders[0],isDefault:true,icon:null}}var urlTemplatesReducer=function urlTemplatesReducer(basePath){return(0,_dist.reducerWithInitialState)(initialTemplates).case(_global.reset,(function(){return initialTemplates})).cases([_datasource.requestDatasource,_datasource.setDatasource],(function(templates,datasource){if(datasource.type==="none"){return initialTemplates}var customTemplates=templates.filter((function(template){return!template.isDefault}));return[].concat(_toConsumableArray(customTemplates),[generateDefaultTemplate(datasource,basePath)])})).case(loadTemplates,(function(_currentTemplates,newTemplates){return newTemplates})).case(saveTemplate,(function(templates,_ref){var indexToUpdate=_ref.index,updatedTemplate=_ref.template;var newTemplate=_objectSpread({},updatedTemplate,{isDefault:false});return indexToUpdate===-1?[].concat(_toConsumableArray(templates),[newTemplate]):templates.map((function(template,index){return index===indexToUpdate?newTemplate:template}))})).case(removeTemplate,(function(templates,templateToDelete){return templates.filter((function(template){return template!==templateToDelete}))})).build()};exports.urlTemplatesReducer=urlTemplatesReducer;var templatesSelector=function templatesSelector(state){return state.urlTemplates};exports.templatesSelector=templatesSelector;var syncTemplatesSaga=function syncTemplatesSaga(_ref2){var _marked=regeneratorRuntime.mark(syncTemplates);var setUrlTemplates=_ref2.setUrlTemplates,notifyAngular=_ref2.notifyAngular;function syncTemplates(){var templates;return regeneratorRuntime.wrap((function syncTemplates$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.t0=templatesSelector;_context.next=3;return(0,_effects.select)();case 3:_context.t1=_context.sent;templates=(0,_context.t0)(_context.t1);setUrlTemplates(templates);notifyAngular();case 7:case"end":return _context.stop()}}}),_marked)}return(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return(0,_effects.takeEvery)((0,_helpers.matchesOne)(loadTemplates,saveTemplate,removeTemplate,_datasource.requestDatasource,_datasource.setDatasource),syncTemplates);case 2:case"end":return _context2.stop()}}}),_callee)})))};exports.syncTemplatesSaga=syncTemplatesSaga},7242:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.outlinkEncoders=void 0;var _risonNode=_interopRequireDefault(__webpack_require__(163));var _i18n=__webpack_require__(2);var _kql_encoder=__webpack_require__(7905);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var outlinkEncoders=[{id:"kql-loose",title:_i18n.i18n.translate("xpack.graph.outlinkEncoders.kqlLooseTitle",{defaultMessage:"KQL OR query"}),description:_i18n.i18n.translate("xpack.graph.outlinkEncoders.kqlLooseDescription",{defaultMessage:"KQL query, compatible with Discover, Visualize, and Dashboards"}),encode:function encode(workspace){return(0,_kql_encoder.asKQL)(workspace,"or")},type:"kql"},{id:"kql",title:_i18n.i18n.translate("xpack.graph.outlinkEncoders.kqlTitle",{defaultMessage:"KQL AND query"}),description:_i18n.i18n.translate("xpack.graph.outlinkEncoders.kqlLooseDescription",{defaultMessage:"KQL query, compatible with Discover, Visualize, and Dashboards"}),encode:function encode(workspace){return(0,_kql_encoder.asKQL)(workspace,"and")},type:"kql"},{id:"esq-rison-loose",title:_i18n.i18n.translate("xpack.graph.outlinkEncoders.esqRisonLooseTitle",{defaultMessage:"elasticsearch OR query (rison encoded)"}),description:_i18n.i18n.translate("xpack.graph.outlinkEncoders.esqRisonLooseDescription",{defaultMessage:"rison-encoded JSON, minimum_should_match=1, compatible with most Kibana URLs"}),encode:function encode(workspace){return encodeURIComponent(_risonNode.default.encode(workspace.getQuery(workspace.getSelectedOrAllNodes(),true)))},type:"esq"},{id:"esq-rison",title:_i18n.i18n.translate("xpack.graph.outlinkEncoders.esqRisonTitle",{defaultMessage:"elasticsearch AND query (rison encoded)"}),description:_i18n.i18n.translate("xpack.graph.outlinkEncoders.esqRisonDescription",{defaultMessage:"rison-encoded JSON, minimum_should_match=2, compatible with most Kibana URLs"}),encode:function encode(workspace){return encodeURIComponent(_risonNode.default.encode(workspace.getQuery(workspace.getSelectedOrAllNodes())))},type:"esq"},{id:"esq-similar-rison",title:_i18n.i18n.translate("xpack.graph.outlinkEncoders.esqSimilarRisonTitle",{defaultMessage:"elasticsearch more like this query (rison encoded)"}),description:_i18n.i18n.translate("xpack.graph.outlinkEncoders.esqSimilarRisonDescription",{defaultMessage:'rison-encoded JSON, "like this but not this" type query to find missing docs'}),encode:function encode(workspace){return encodeURIComponent(_risonNode.default.encode(workspace.getLikeThisButNotThisQuery(workspace.getSelectedOrAllNodes())))},type:"esq"},{id:"esq-plain",title:_i18n.i18n.translate("xpack.graph.outlinkEncoders.esqPlainTitle",{defaultMessage:"elasticsearch query (plain encoding)"}),description:_i18n.i18n.translate("xpack.graph.outlinkEncoders.esqPlainDescription",{defaultMessage:"JSON encoded using standard url encoding"}),encode:function encode(workspace){return encodeURIComponent(JSON.stringify(workspace.getQuery(workspace.getSelectedOrAllNodes())))},type:"esq"},{id:"text-plain",title:_i18n.i18n.translate("xpack.graph.outlinkEncoders.textPlainTitle",{defaultMessage:"plain text"}),description:_i18n.i18n.translate("xpack.graph.outlinkEncoders.textPlainDescription",{defaultMessage:"Text of selected vertex labels as a plain url-encoded string"}),encode:function encode(workspace){var q="";var nodes=workspace.getSelectedOrAllNodes();for(var i=0;i<nodes.length;i++){var node=nodes[i];if(i>0){q+=" "}q+=node.label}return encodeURIComponent(q)},type:"plain"},{id:"text-lucene",title:_i18n.i18n.translate("xpack.graph.outlinkEncoders.textLuceneTitle",{defaultMessage:"Lucene-escaped text"}),description:_i18n.i18n.translate("xpack.graph.outlinkEncoders.textLuceneDescription",{defaultMessage:"Text of selected vertex labels with any Lucene special characters encoded"}),encode:function encode(workspace){var q="";var nodes=workspace.getSelectedOrAllNodes();for(var i=0;i<nodes.length;i++){var node=nodes[i];if(i>0){q+=" "}q+=node.label}var luceneChars='+-&|!(){}[]^"~*?:\\';q=q.split("").map((function(char){return luceneChars.includes(char)?"\\".concat(char):char})).join("");return encodeURIComponent(q)},type:"lucene"}];exports.outlinkEncoders=outlinkEncoders},7243:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.isUrlTemplateValid=isUrlTemplateValid;exports.isKibanaUrl=isKibanaUrl;exports.replaceKibanaUrlParam=replaceKibanaUrlParam;exports.urlTemplateRegex=exports.urlTemplatePlaceholder=void 0;var urlTemplatePlaceholder="{{gquery}}";exports.urlTemplatePlaceholder=urlTemplatePlaceholder;var urlTemplateRegex=/\{\{gquery\}\}/g;exports.urlTemplateRegex=urlTemplateRegex;var defaultKibanaQuery=/,query:\(language:kuery,query:'.*?'\)/g;function isUrlTemplateValid(url){return url.search(urlTemplateRegex)>-1}function isKibanaUrl(url){return url.search(defaultKibanaQuery)>-1}function replaceKibanaUrlParam(url){return url.replace(defaultKibanaQuery,",query:(language:kuery,query:{{".concat(urlTemplatePlaceholder,"}})"))}},7244:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _serialize=__webpack_require__(7906);Object.keys(_serialize).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _serialize[key]}})}));var _deserialize=__webpack_require__(7907);Object.keys(_deserialize).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _deserialize[key]}})}))},7245:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.syncBreadcrumbSaga=exports.metaDataSelector=exports.metaDataReducer=exports.updateMetaData=void 0;var _typescriptFsa=_interopRequireDefault(__webpack_require__(252));var _typescriptFsaReducers=__webpack_require__(333);var _effects=__webpack_require__(331);var _i18n=__webpack_require__(2);var _global=__webpack_require__(7118);var _url=__webpack_require__(7246);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var actionCreator=(0,_typescriptFsa.default)("x-pack/graph/metaData");var updateMetaData=actionCreator("UPDATE_META_DATA");exports.updateMetaData=updateMetaData;var initialMetaData={title:_i18n.i18n.translate("xpack.graph.newGraphTitle",{defaultMessage:"Unsaved graph"}),description:""};var metaDataReducer=(0,_typescriptFsaReducers.reducerWithInitialState)(initialMetaData).case(_global.reset,(function(){return initialMetaData})).case(updateMetaData,(function(oldMetaData,newMetaData){return _objectSpread({},oldMetaData,{},newMetaData)})).build();exports.metaDataReducer=metaDataReducer;var metaDataSelector=function metaDataSelector(state){return state.metaData};exports.metaDataSelector=metaDataSelector;var syncBreadcrumbSaga=function syncBreadcrumbSaga(_ref){var _marked=regeneratorRuntime.mark(syncBreadcrumb);var chrome=_ref.chrome,changeUrl=_ref.changeUrl;function syncBreadcrumb(){var metaData;return regeneratorRuntime.wrap((function syncBreadcrumb$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.t0=metaDataSelector;_context.next=3;return(0,_effects.select)();case 3:_context.t1=_context.sent;metaData=(0,_context.t0)(_context.t1);(0,_url.setBreadcrumbs)({chrome:chrome,metaData:metaData,navigateTo:function navigateTo(path){changeUrl(path)}});case 6:case"end":return _context.stop()}}}),_marked)}return(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return(0,_effects.call)(syncBreadcrumb);case 2:_context2.next=4;return(0,_effects.takeLatest)(updateMetaData.match,syncBreadcrumb);case 4:case"end":return _context2.stop()}}}),_callee)})))};exports.syncBreadcrumbSaga=syncBreadcrumbSaga},7246:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getHomePath=getHomePath;exports.getNewPath=getNewPath;exports.getEditPath=getEditPath;exports.getEditUrl=getEditUrl;exports.setBreadcrumbs=setBreadcrumbs;var _i18n=__webpack_require__(2);function getHomePath(){return"/home"}function getNewPath(){return"/workspace"}function getEditPath(_ref){var id=_ref.id;return"/workspace/".concat(id)}function getEditUrl(addBasePath,workspace){return addBasePath("#".concat(getEditPath(workspace)))}function setBreadcrumbs(options){if("metaData"in options){options.chrome.setBreadcrumbs([{text:_i18n.i18n.translate("xpack.graph.home.breadcrumb",{defaultMessage:"Graph"}),onClick:function onClick(){options.navigateTo(getHomePath())},"data-test-subj":"graphHomeBreadcrumb"},{text:options.metaData.title,"data-test-subj":"graphCurrentGraphBreadcrumb"}])}else{options.chrome.setBreadcrumbs([{text:_i18n.i18n.translate("xpack.graph.home.breadcrumb",{defaultMessage:"Graph"}),href:"#".concat(getHomePath()),"data-test-subj":"graphHomeBreadcrumb"}])}}},7419:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.isEqual=isEqual;function isEqual(a,b){return Object.keys(a).every((function(key){return a[key]===b[key]}))}},7420:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.matchesOne=void 0;var matchesOne=function matchesOne(){for(var _len=arguments.length,actionCreators=new Array(_len),_key=0;_key<_len;_key++){actionCreators[_key]=arguments[_key]}return function(action){return actionCreators.some((function(actionCreator){return actionCreator.match(action)}))}};exports.matchesOne=matchesOne},7421:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.datasourceSaga=void 0;var _effects=__webpack_require__(331);var _i18n=__webpack_require__(2);var _fields=__webpack_require__(7140);var _persistence=__webpack_require__(7244);var _advanced_settings=__webpack_require__(7172);var _datasource=__webpack_require__(7086);var datasourceSaga=function datasourceSaga(_ref){var _marked=regeneratorRuntime.mark(fetchFields);var indexPatternProvider=_ref.indexPatternProvider,notifications=_ref.notifications,createWorkspace=_ref.createWorkspace,notifyAngular=_ref.notifyAngular;function fetchFields(action){var indexPattern,advancedSettings;return regeneratorRuntime.wrap((function fetchFields$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return(0,_effects.call)(indexPatternProvider.get,action.payload.id);case 3:indexPattern=_context.sent;_context.next=6;return(0,_effects.put)((0,_fields.loadFields)((0,_persistence.mapFields)(indexPattern)));case 6:_context.next=8;return(0,_effects.put)((0,_datasource.datasourceLoaded)());case 8:_context.t0=_advanced_settings.settingsSelector;_context.next=11;return(0,_effects.select)();case 11:_context.t1=_context.sent;advancedSettings=(0,_context.t0)(_context.t1);createWorkspace(indexPattern.title,advancedSettings);notifyAngular();_context.next=22;break;case 17:_context.prev=17;_context.t2=_context["catch"](0);_context.next=21;return(0,_effects.put)((0,_datasource.setDatasource)({type:"none"}));case 21:notifications.toasts.addDanger(_i18n.i18n.translate("xpack.graph.loadWorkspace.missingIndexPatternErrorMessage",{defaultMessage:"Index pattern not found"}));case 22:case"end":return _context.stop()}}}),_marked,null,[[0,17]])}return(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return(0,_effects.takeLatest)(_datasource.requestDatasource.match,fetchFields);case 2:case"end":return _context2.stop()}}}),_callee)})))};exports.datasourceSaga=datasourceSaga},7422:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.savingSaga=exports.loadingSaga=exports.saveWorkspace=exports.loadSavedWorkspace=void 0;var _typescriptFsa=_interopRequireDefault(__webpack_require__(252));var _i18n=__webpack_require__(2);var _effects=__webpack_require__(331);var _datasource=__webpack_require__(7086);var _fields=__webpack_require__(7140);var _advanced_settings=__webpack_require__(7172);var _url_templates=__webpack_require__(7241);var _persistence=__webpack_require__(7244);var _meta_data=__webpack_require__(7245);var _save_modal=__webpack_require__(7908);var _url=__webpack_require__(7246);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var actionCreator=(0,_typescriptFsa.default)("x-pack/graph");var loadSavedWorkspace=actionCreator("LOAD_WORKSPACE");exports.loadSavedWorkspace=loadSavedWorkspace;var saveWorkspace=actionCreator("SAVE_WORKSPACE");exports.saveWorkspace=saveWorkspace;var loadingSaga=function loadingSaga(_ref){var _marked=regeneratorRuntime.mark(deserializeWorkspace);var createWorkspace=_ref.createWorkspace,getWorkspace=_ref.getWorkspace,indexPatterns=_ref.indexPatterns,notifications=_ref.notifications,indexPatternProvider=_ref.indexPatternProvider;function deserializeWorkspace(action){var selectedIndex,indexPattern,initialSettings,_savedWorkspaceToAppS,urlTemplates,advancedSettings,allFields;return regeneratorRuntime.wrap((function deserializeWorkspace$(_context){while(1){switch(_context.prev=_context.next){case 0:selectedIndex=(0,_persistence.lookupIndexPattern)(action.payload,indexPatterns);if(selectedIndex){_context.next=4;break}notifications.toasts.addDanger(_i18n.i18n.translate("xpack.graph.loadWorkspace.missingIndexPatternErrorMessage",{defaultMessage:"Index pattern not found"}));return _context.abrupt("return");case 4:_context.next=6;return(0,_effects.call)(indexPatternProvider.get,selectedIndex.id);case 6:indexPattern=_context.sent;_context.t0=_advanced_settings.settingsSelector;_context.next=10;return(0,_effects.select)();case 10:_context.t1=_context.sent;initialSettings=(0,_context.t0)(_context.t1);createWorkspace(selectedIndex.attributes.title,initialSettings);_savedWorkspaceToAppS=(0,_persistence.savedWorkspaceToAppState)(action.payload,indexPattern,getWorkspace()),urlTemplates=_savedWorkspaceToAppS.urlTemplates,advancedSettings=_savedWorkspaceToAppS.advancedSettings,allFields=_savedWorkspaceToAppS.allFields;_context.next=16;return(0,_effects.put)((0,_meta_data.updateMetaData)({title:action.payload.title,description:action.payload.description,savedObjectId:action.payload.id}));case 16:_context.next=18;return(0,_effects.put)((0,_datasource.setDatasource)({type:"indexpattern",id:selectedIndex.id,title:selectedIndex.attributes.title}));case 18:_context.next=20;return(0,_effects.put)((0,_fields.loadFields)(allFields));case 20:_context.next=22;return(0,_effects.put)((0,_advanced_settings.updateSettings)(advancedSettings));case 22:_context.next=24;return(0,_effects.put)((0,_url_templates.loadTemplates)(urlTemplates));case 24:getWorkspace().runLayout();case 25:case"end":return _context.stop()}}}),_marked)}return(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return(0,_effects.takeLatest)(loadSavedWorkspace.match,deserializeWorkspace);case 2:case"end":return _context2.stop()}}}),_callee)})))};exports.loadingSaga=loadingSaga;var savingSaga=function savingSaga(deps){var _marked2=regeneratorRuntime.mark(persistWorkspace);function persistWorkspace(){var savedWorkspace,state,workspace,selectedDatasource,savedObjectId;return regeneratorRuntime.wrap((function persistWorkspace$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:savedWorkspace=deps.getSavedWorkspace();_context3.next=3;return(0,_effects.select)();case 3:state=_context3.sent;workspace=deps.getWorkspace();selectedDatasource=(0,_datasource.datasourceSelector)(state).current;if(!(!workspace||selectedDatasource.type==="none")){_context3.next=8;break}return _context3.abrupt("return");case 8:_context3.next=10;return(0,_effects.cps)(showModal,{deps:deps,workspace:workspace,savedWorkspace:savedWorkspace,state:state,selectedDatasource:selectedDatasource});case 10:savedObjectId=_context3.sent;if(!savedObjectId){_context3.next=14;break}_context3.next=14;return(0,_effects.put)((0,_meta_data.updateMetaData)({savedObjectId:savedObjectId}));case 14:case"end":return _context3.stop()}}}),_marked2)}return(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return(0,_effects.takeLatest)(saveWorkspace.match,persistWorkspace);case 2:case"end":return _context4.stop()}}}),_callee2)})))};exports.savingSaga=savingSaga;function showModal(_ref2,savingCallback){var deps=_ref2.deps,workspace=_ref2.workspace,savedWorkspace=_ref2.savedWorkspace,state=_ref2.state,selectedDatasource=_ref2.selectedDatasource;var saveWorkspaceHandler=function saveWorkspaceHandler(saveOptions,userHasConfirmedSaveWorkspaceData){var canSaveData,_id,title,text;return regeneratorRuntime.async((function saveWorkspaceHandler$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:canSaveData=deps.savePolicy==="configAndData"||deps.savePolicy==="configAndDataWithConsent"&&userHasConfirmedSaveWorkspaceData;(0,_persistence.appStateToSavedWorkspace)(savedWorkspace,{workspace:workspace,urlTemplates:(0,_url_templates.templatesSelector)(state),advancedSettings:(0,_advanced_settings.settingsSelector)(state),selectedIndex:selectedDatasource,selectedFields:(0,_fields.selectedFieldsSelector)(state)},canSaveData);_context5.prev=2;_context5.next=5;return regeneratorRuntime.awrap(savedWorkspace.save(saveOptions));case 5:_id=_context5.sent;if(_id){title=_i18n.i18n.translate("xpack.graph.saveWorkspace.successNotificationTitle",{defaultMessage:'Saved "{workspaceTitle}"',values:{workspaceTitle:savedWorkspace.title}});if(!canSaveData&&workspace.nodes.length>0){text=_i18n.i18n.translate("xpack.graph.saveWorkspace.successNotification.noDataSavedText",{defaultMessage:"The configuration was saved, but the data was not saved"})}deps.notifications.toasts.addSuccess({title:title,text:text,"data-test-subj":"saveGraphSuccess"});if(savedWorkspace.id!==(0,_meta_data.metaDataSelector)(state).savedObjectId){deps.changeUrl((0,_url.getEditPath)(savedWorkspace))}}savingCallback(null,_id);return _context5.abrupt("return",{id:_id});case 11:_context5.prev=11;_context5.t0=_context5["catch"](2);deps.notifications.toasts.addDanger(_i18n.i18n.translate("xpack.graph.saveWorkspace.savingErrorMessage",{defaultMessage:"Failed to save workspace: {message}",values:{message:_context5.t0}}));return _context5.abrupt("return",{error:_context5.t0});case 15:case"end":return _context5.stop()}}}),null,null,[[2,11]])};(0,_save_modal.openSaveModal)({savePolicy:deps.savePolicy,hasData:workspace.nodes.length>0||workspace.blacklistedNodes.length>0,workspace:savedWorkspace,showSaveModal:deps.showSaveModal,saveWorkspace:saveWorkspaceHandler})}},7423:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.fillWorkspaceSaga=exports.fillWorkspace=void 0;var _typescriptFsa=_interopRequireDefault(__webpack_require__(252));var _i18n=__webpack_require__(2);var _effects=__webpack_require__(331);var _datasource=__webpack_require__(7086);var _fields=__webpack_require__(7140);var _fetch_top_nodes=__webpack_require__(7910);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var actionCreator=(0,_typescriptFsa.default)("x-pack/graph");var fillWorkspace=actionCreator("FILL_WORKSPACE");exports.fillWorkspace=fillWorkspace;var fillWorkspaceSaga=function fillWorkspaceSaga(_ref){var _marked=regeneratorRuntime.mark(fetchNodes);var getWorkspace=_ref.getWorkspace,setWorkspaceInitialized=_ref.setWorkspaceInitialized,notifyAngular=_ref.notifyAngular,http=_ref.http,notifications=_ref.notifications;function fetchNodes(){var workspace,state,fields,datasource,topTermNodes,message;return regeneratorRuntime.wrap((function fetchNodes$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;workspace=getWorkspace();if(workspace){_context.next=4;break}return _context.abrupt("return");case 4:_context.next=6;return(0,_effects.select)();case 6:state=_context.sent;fields=(0,_fields.selectedFieldsSelector)(state);datasource=(0,_datasource.datasourceSelector)(state).current;if(!(datasource.type==="none")){_context.next=11;break}return _context.abrupt("return");case 11:_context.next=13;return(0,_effects.call)(_fetch_top_nodes.fetchTopNodes,http.post,datasource.title,fields);case 13:topTermNodes=_context.sent;workspace.mergeGraph({nodes:topTermNodes,edges:[]});setWorkspaceInitialized();notifyAngular();workspace.fillInGraph(fields.length*10);_context.next=24;break;case 20:_context.prev=20;_context.t0=_context["catch"](0);message="body"in _context.t0?_context.t0.body.message:_context.t0.message;notifications.toasts.addDanger({title:_i18n.i18n.translate("xpack.graph.fillWorkspaceError",{defaultMessage:"Fetching top terms failed: {message}",values:{message:message}})});case 24:case"end":return _context.stop()}}}),_marked,null,[[0,20]])}return(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return(0,_effects.takeLatest)(fillWorkspace.match,fetchNodes);case 2:case"end":return _context2.stop()}}}),_callee)})))};exports.fillWorkspaceSaga=fillWorkspaceSaga},7424:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.openSourceModal=openSourceModal;var _react=_interopRequireDefault(__webpack_require__(0));var _source_modal=__webpack_require__(7913);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function openSourceModal(_ref,onSelected){var overlays=_ref.overlays,savedObjects=_ref.savedObjects,uiSettings=_ref.uiSettings;var modalRef=overlays.openModal(_react.default.createElement(_source_modal.SourceModal,{uiSettings:uiSettings,savedObjects:savedObjects,onIndexPatternSelected:function onIndexPatternSelected(indexPattern){onSelected(indexPattern);modalRef.close()}}))}},7425:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.useListKeys=useListKeys;var _react=__webpack_require__(0);var _eui=__webpack_require__(1);var generateId=(0,_eui.htmlIdGenerator)();function useListKeys(list){var idStore=(0,_react.useRef)(new Map);var currentIdMap=(0,_react.useMemo)((function(){var newMap=new Map;list.forEach((function(item){if(idStore.current.has(item)){newMap.set(item,idStore.current.get(item))}else{var newId=generateId();newMap.set(item,newId)}}));idStore.current=newMap;return idStore.current}),[list]);return(0,_react.useCallback)((function(item){var itemId=currentIdMap.get(item);if(itemId){return itemId}throw new Error("Object not found. Make sure to pass the whole list to the hook and don't mutate the list with functions like push")}),[currentIdMap])}},7895:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.initGraphApp=initGraphApp;var _lodash=_interopRequireDefault(__webpack_require__(3));var _i18n=__webpack_require__(2);__webpack_require__(696);var _react=_interopRequireDefault(__webpack_require__(0));var _reactRedux=__webpack_require__(12);var _eui=__webpack_require__(1);var _public=__webpack_require__(16);var _legacy_imports=__webpack_require__(7239);var _index=_interopRequireDefault(__webpack_require__(7896));var _listing_ng_wrapper=_interopRequireDefault(__webpack_require__(7897));var _badge=__webpack_require__(7898);var _app=__webpack_require__(7899);var _venn_diagram=__webpack_require__(7918);var _listing=__webpack_require__(7921);var _settings=__webpack_require__(7922);var _graph_visualization=__webpack_require__(7928);var _graph_client_workspace=_interopRequireDefault(__webpack_require__(7930));var _url=__webpack_require__(7246);var _index_pattern_cache=__webpack_require__(7931);var _url_template=__webpack_require__(7243);var _as_observable=__webpack_require__(7932);var _style_choices=__webpack_require__(7171);var _state_management=__webpack_require__(7117);var _format_http_error=__webpack_require__(7933);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function initGraphApp(angularModule,deps){var chrome=deps.chrome,toastNotifications=deps.toastNotifications,savedObjectsClient=deps.savedObjectsClient,indexPatterns=deps.indexPatterns,addBasePath=deps.addBasePath,getBasePath=deps.getBasePath,npData=deps.npData,config=deps.config,savedWorkspaceLoader=deps.savedWorkspaceLoader,capabilities=deps.capabilities,coreStart=deps.coreStart,storage=deps.storage,canEditDrillDownUrls=deps.canEditDrillDownUrls,graphSavePolicy=deps.graphSavePolicy;var app=angularModule;app.directive("vennDiagram",(function(reactDirective){return reactDirective(_venn_diagram.VennDiagram)}));app.directive("graphVisualization",(function(reactDirective){return reactDirective(_graph_visualization.GraphVisualization)}));app.directive("graphListing",(function(reactDirective){return reactDirective(_listing.Listing,[["coreStart",{watchDepth:"reference"}],["createItem",{watchDepth:"reference"}],["findItems",{watchDepth:"reference"}],["deleteItems",{watchDepth:"reference"}],["editItem",{watchDepth:"reference"}],["getViewUrl",{watchDepth:"reference"}],["listingLimit",{watchDepth:"reference"}],["hideWriteControls",{watchDepth:"reference"}],["capabilities",{watchDepth:"reference"}],["initialFilter",{watchDepth:"reference"}]])}));app.directive("graphApp",(function(reactDirective){return reactDirective(_app.GraphApp,[["storage",{watchDepth:"reference"}],["isInitialized",{watchDepth:"reference"}],["currentIndexPattern",{watchDepth:"reference"}],["indexPatternProvider",{watchDepth:"reference"}],["isLoading",{watchDepth:"reference"}],["onQuerySubmit",{watchDepth:"reference"}],["initialQuery",{watchDepth:"reference"}],["confirmWipeWorkspace",{watchDepth:"reference"}],["coreStart",{watchDepth:"reference"}],["noIndexPatterns",{watchDepth:"reference"}],["reduxStore",{watchDepth:"reference"}],["pluginDataStart",{watchDepth:"reference"}]],{restrict:"A"})}));app.directive("graphVisualization",(function(reactDirective){return reactDirective(_graph_visualization.GraphVisualization,undefined,{restrict:"A"})}));app.config((function($routeProvider){$routeProvider.when("/home",{template:_listing_ng_wrapper.default,badge:_badge.getReadonlyBadge,controller:function controller($location,$scope){$scope.listingLimit=config.get("savedObjects:listingLimit");$scope.create=function(){$location.url((0,_url.getNewPath)())};$scope.find=function(search){return savedWorkspaceLoader.find(search,$scope.listingLimit)};$scope.editItem=function(workspace){$location.url((0,_url.getEditPath)(workspace))};$scope.getViewUrl=function(workspace){return(0,_url.getEditUrl)(addBasePath,workspace)};$scope.delete=function(workspaces){return savedWorkspaceLoader.delete(workspaces.map((function(_ref){var id=_ref.id;return id})))};$scope.capabilities=capabilities;$scope.initialFilter=$location.search().filter||"";$scope.coreStart=coreStart;(0,_url.setBreadcrumbs)({chrome:chrome})}}).when("/workspace/:id?",{template:_index.default,badge:_badge.getReadonlyBadge,resolve:{savedWorkspace:function savedWorkspace($route){return $route.current.params.id?savedWorkspaceLoader.get($route.current.params.id).catch((function(){toastNotifications.addDanger(_i18n.i18n.translate("xpack.graph.missingWorkspaceErrorMessage",{defaultMessage:"Missing workspace"}))})):savedWorkspaceLoader.get()},indexPatterns:function indexPatterns(){return savedObjectsClient.find({type:"index-pattern",fields:["title","type"],perPage:1e4}).then((function(response){return response.savedObjects}))},GetIndexPatternProvider:function GetIndexPatternProvider(){return indexPatterns}}}).otherwise({redirectTo:"/home"})}));app.controller("graphuiPlugin",(function($scope,$route,$location,confirmModal){function handleError(err){var toastTitle=_i18n.i18n.translate("xpack.graph.errorToastTitle",{defaultMessage:"Graph Error",description:'"Graph" is a product name and should not be translated.'});if(err instanceof Error){toastNotifications.addError(err,{title:toastTitle})}else{toastNotifications.addDanger({title:toastTitle,text:String(err)})}}function handleHttpError(error){return regeneratorRuntime.async((function handleHttpError$(_context){while(1){switch(_context.prev=_context.next){case 0:toastNotifications.addDanger((0,_format_http_error.formatHttpError)(error));case 1:case"end":return _context.stop()}}}))}function callNodeProxy(indexName,query,responseHandler){var request={body:JSON.stringify({index:indexName,query:query})};$scope.loading=true;return coreStart.http.post("../api/graph/graphExplore",request).then((function(data){var response=data.resp;if(response.timed_out){toastNotifications.addWarning(_i18n.i18n.translate("xpack.graph.exploreGraph.timedOutWarningText",{defaultMessage:"Exploration timed out"}))}responseHandler(response)})).catch(handleHttpError).finally((function(){$scope.loading=false;$scope.$digest()}))}var callSearchNodeProxy=function callSearchNodeProxy(indexName,query,responseHandler){var request={body:JSON.stringify({index:indexName,body:query})};$scope.loading=true;coreStart.http.post("../api/graph/searchProxy",request).then((function(data){var response=data.resp;responseHandler(response)})).catch(handleHttpError).finally((function(){$scope.loading=false;$scope.$digest()}))};$scope.indexPatternProvider=(0,_index_pattern_cache.createCachedIndexPatternProvider)($route.current.locals.GetIndexPatternProvider.get);var store=(0,_state_management.createGraphStore)({basePath:getBasePath(),indexPatternProvider:$scope.indexPatternProvider,indexPatterns:$route.current.locals.indexPatterns,createWorkspace:function createWorkspace(indexPattern,exploreControls){var options={indexName:indexPattern,vertex_fields:[],nodeLabeller:function nodeLabeller(){},changeHandler:function changeHandler(){$scope.$apply()},graphExploreProxy:callNodeProxy,searchProxy:callSearchNodeProxy,exploreControls:exploreControls};$scope.workspace=_graph_client_workspace.default.createWorkspace(options)},setLiveResponseFields:function setLiveResponseFields(fields){$scope.liveResponseFields=fields},setUrlTemplates:function setUrlTemplates(urlTemplates){$scope.urlTemplates=urlTemplates},getWorkspace:function getWorkspace(){return $scope.workspace},getSavedWorkspace:function getSavedWorkspace(){return $route.current.locals.savedWorkspace},notifications:coreStart.notifications,http:coreStart.http,showSaveModal:_legacy_imports.showSaveModal,setWorkspaceInitialized:function setWorkspaceInitialized(){$scope.workspaceInitialized=true},savePolicy:graphSavePolicy,changeUrl:function changeUrl(newUrl){$scope.$evalAsync((function(){$location.url(newUrl)}))},notifyAngular:function notifyAngular(){$scope.$digest()},chrome:chrome});$scope.pluginDataStart=npData;$scope.storage=storage;$scope.coreStart=coreStart;$scope.loading=false;$scope.reduxStore=store;$scope.savedWorkspace=$route.current.locals.savedWorkspace;var allSavingDisabled=graphSavePolicy==="none";$scope.spymode="request";$scope.colors=_style_choices.colorChoices;$scope.isColorDark=function(color){return _eui.isColorDark.apply(void 0,_toConsumableArray((0,_eui.hexToRgb)(color)))};$scope.nodeClick=function(n,$event){if(!$event.shiftKey){var prevSelection=n.isSelected;$scope.workspace.selectNone();n.isSelected=prevSelection}if($scope.workspace.toggleNodeSelection(n)){$scope.selectSelected(n)}else{$scope.detail=null}};$scope.clickEdge=function(edge){$scope.workspace.getAllIntersections($scope.handleMergeCandidatesCallback,[edge.topSrc,edge.topTarget])};$scope.submit=function(searchTerm){$scope.workspaceInitialized=true;var numHops=2;if(searchTerm.startsWith("{")){try{var query=JSON.parse(searchTerm);if(query.vertices){$scope.workspace.callElasticsearch(query)}else{$scope.workspace.search(query,$scope.liveResponseFields,numHops)}}catch(err){handleError(err)}return}$scope.workspace.simpleSearch(searchTerm,$scope.liveResponseFields,numHops)};$scope.selectSelected=function(node){$scope.detail={latestNodeSelection:node};return $scope.selectedSelectedVertex=node};$scope.isSelectedSelected=function(node){return $scope.selectedSelectedVertex===node};$scope.openUrlTemplate=function(template){var url=template.url;var newUrl=url.replace(_url_template.urlTemplateRegex,template.encoder.encode($scope.workspace));window.open(newUrl,"_blank")};$scope.aceLoaded=function(editor){editor.$blockScrolling=Infinity};$scope.setDetail=function(data){$scope.detail=data};function canWipeWorkspace(callback,text,options){if(!(0,_state_management.hasFieldsSelector)(store.getState())){callback();return}var confirmModalOptions=_objectSpread({onConfirm:callback,onCancel:function onCancel(){},confirmButtonText:_i18n.i18n.translate("xpack.graph.leaveWorkspace.confirmButtonLabel",{defaultMessage:"Leave anyway"}),title:_i18n.i18n.translate("xpack.graph.leaveWorkspace.modalTitle",{defaultMessage:"Unsaved changes"})},options);confirmModal(text||_i18n.i18n.translate("xpack.graph.leaveWorkspace.confirmText",{defaultMessage:"If you leave now, you will lose unsaved changes."}),confirmModalOptions)}$scope.confirmWipeWorkspace=canWipeWorkspace;$scope.performMerge=function(parentId,childId){var found=true;while(found){found=false;for(var i in $scope.detail.mergeCandidates){var mc=$scope.detail.mergeCandidates[i];if(mc.id1===childId||mc.id2===childId){$scope.detail.mergeCandidates.splice(i,1);found=true;break}}}$scope.workspace.mergeIds(parentId,childId);$scope.detail=null};$scope.handleMergeCandidatesCallback=function(termIntersects){var mergeCandidates=[];for(var i in termIntersects){var ti=termIntersects[i];mergeCandidates.push({id1:ti.id1,id2:ti.id2,term1:ti.term1,term2:ti.term2,v1:ti.v1,v2:ti.v2,overlap:ti.overlap})}$scope.detail={mergeCandidates:mergeCandidates}};$scope.topNavMenu=[];$scope.topNavMenu.push({key:"new",label:_i18n.i18n.translate("xpack.graph.topNavMenu.newWorkspaceLabel",{defaultMessage:"New"}),description:_i18n.i18n.translate("xpack.graph.topNavMenu.newWorkspaceAriaLabel",{defaultMessage:"New Workspace"}),tooltip:_i18n.i18n.translate("xpack.graph.topNavMenu.newWorkspaceTooltip",{defaultMessage:"Create a new workspace"}),run:function run(){canWipeWorkspace((function(){$scope.$evalAsync((function(){if($location.url()==="/workspace/"){$route.reload()}else{$location.url("/workspace/")}}))}))},testId:"graphNewButton"});if(capabilities.save){$scope.topNavMenu.push({key:"save",label:_i18n.i18n.translate("xpack.graph.topNavMenu.saveWorkspace.enabledLabel",{defaultMessage:"Save"}),description:_i18n.i18n.translate("xpack.graph.topNavMenu.saveWorkspace.enabledAriaLabel",{defaultMessage:"Save workspace"}),tooltip:function tooltip(){if(allSavingDisabled){return _i18n.i18n.translate("xpack.graph.topNavMenu.saveWorkspace.disabledTooltip",{defaultMessage:"No changes to saved workspaces are permitted by the current save policy"})}else{return _i18n.i18n.translate("xpack.graph.topNavMenu.saveWorkspace.enabledTooltip",{defaultMessage:"Save this workspace"})}},disableButton:function disableButton(){return allSavingDisabled||!(0,_state_management.hasFieldsSelector)(store.getState())},run:function run(){store.dispatch({type:"x-pack/graph/SAVE_WORKSPACE",payload:$route.current.locals.savedWorkspace})},testId:"graphSaveButton"})}$scope.topNavMenu.push({key:"inspect",disableButton:function disableButton(){return $scope.workspace===null},label:_i18n.i18n.translate("xpack.graph.topNavMenu.inspectLabel",{defaultMessage:"Inspect"}),description:_i18n.i18n.translate("xpack.graph.topNavMenu.inspectAriaLabel",{defaultMessage:"Inspect"}),run:function run(){$scope.$evalAsync((function(){var curState=$scope.menus.showInspect;$scope.closeMenus();$scope.menus.showInspect=!curState}))}});$scope.topNavMenu.push({key:"settings",disableButton:function disableButton(){return(0,_state_management.datasourceSelector)(store.getState()).type==="none"},label:_i18n.i18n.translate("xpack.graph.topNavMenu.settingsLabel",{defaultMessage:"Settings"}),description:_i18n.i18n.translate("xpack.graph.topNavMenu.settingsAriaLabel",{defaultMessage:"Settings"}),run:function run(){var settingsObservable=(0,_as_observable.asAngularSyncedObservable)((function(){return{blacklistedNodes:$scope.workspace?_toConsumableArray($scope.workspace.blacklistedNodes):undefined,unblacklistNode:$scope.workspace?$scope.workspace.unblacklist:undefined,canEditDrillDownUrls:canEditDrillDownUrls}}),$scope.$digest.bind($scope));coreStart.overlays.openFlyout((0,_public.toMountPoint)(_react.default.createElement(_reactRedux.Provider,{store:store},_react.default.createElement(_settings.Settings,{observable:settingsObservable}))),{size:"m",closeButtonAriaLabel:_i18n.i18n.translate("xpack.graph.settings.closeLabel",{defaultMessage:"Close"}),"data-test-subj":"graphSettingsFlyout",ownFocus:true,className:"gphSettingsFlyout",maxWidth:520})}});if($route.current.params.query){$scope.initialQuery=$route.current.params.query;var unbind=$scope.$watch("workspace",(function(){if(!$scope.workspace){return}unbind();$scope.submit($route.current.params.query)}))}$scope.menus={showSettings:false};$scope.closeMenus=function(){_lodash.default.forOwn($scope.menus,(function(_,key){$scope.menus[key]=false}))};if($route.current.locals.savedWorkspace.id){store.dispatch({type:"x-pack/graph/LOAD_WORKSPACE",payload:$route.current.locals.savedWorkspace})}else{$scope.noIndexPatterns=$route.current.locals.indexPatterns.length===0}}))}},7896:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_exports__["default"]='<main id="graphBasic" ng-controller="graphuiPlugin" aria-labelledby="graphHeading">\n  \x3c!-- Local nav. --\x3e\n  <kbn-top-nav name="workspacesTopNav" config="topNavMenu">\n  </kbn-top-nav>\n\n  <div class="gphGraph__menus" ng-show="menus.showInspect">\n    <div>\n      <div\n        class="kuiLocalDropdownTitle"\n        i18n-id="xpack.graph.inspect.title"\n        i18n-default-message="Inspect"\n      ></div>\n\n      <div\n        class="list-group-item"\n        ng-if="(workspace !== null)"\n      >\n        <small class="help-block">http://host:port/{{ selectedIndex.name }}/_graph/explore</small>\n        <ul class="nav nav-tabs">\n          <li ng-class="{active: spymode === \'request\'}">\n            <a\n              ng-click="spymode=\'request\'"\n              i18n-id="xpack.graph.inspect.requestTabTitle"\n              i18n-default-message="Request"\n            ></a>\n          </li>\n          <li ng-class="{active: spymode === \'response\'}">\n            <a\n              ng-click="spymode=\'response\'"\n              i18n-id="xpack.graph.inspect.responseTabTitle"\n              i18n-default-message="Response"\n            ></a>\n          </li>\n        </ul>\n\n        <div\n          ng-show="spymode == \'request\'"\n          ui-ace="{ onLoad: aceLoaded, mode: \'json\', advanced: { readOnly: true } }"\n          ng-model="workspace.lastRequest"\n          class="gphSettings__jsonView"\n        ></div>\n        <div\n          ng-show="spymode == \'response\'"\n          ui-ace="{ onLoad: aceLoaded, mode: \'json\', advanced: { readOnly: true } }"\n          ng-model="workspace.lastResponse"\n          class="gphSettings__jsonView"\n        ></div>\n      </div>\n    </div>\n  </div>\n\n  <div\n    graph-app\n    current-index-pattern="selectedIndex"\n    on-query-submit="submit"\n    index-pattern-provider="indexPatternProvider"\n    redux-store="reduxStore"\n    confirm-wipe-workspace="confirmWipeWorkspace"\n    is-loading="loading"\n    is-initialized="workspaceInitialized || savedWorkspace.id"\n    initial-query="initialQuery"\n    plugin-data-start="pluginDataStart"\n    core-start="coreStart"\n    storage="storage"\n    no-index-patterns="noIndexPatterns"\n  ></div>\n\n  <div class="gphGraph__container" id="GraphSvgContainer" ng-if="workspaceInitialized || savedWorkspace.id">\n    <div\n      class="gphVisualization"\n      graph-visualization\n      nodes="workspace.nodes"\n      edges="workspace.edges"\n      edge-click="clickEdge"\n      node-click="nodeClick"\n    ></div>\n\n    <div id="sidebar" class="gphSidebar" ng-if="workspace !== null">\n\n      <div>\n        <button\n          class="kuiButton kuiButton--basic kuiButton--small"\n          tooltip="{{ ::\'xpack.graph.sidebar.topMenu.undoButtonTooltip\' | i18n: { defaultMessage: \'Undo\' } }}"\n          aria-label="{{ ::\'xpack.graph.sidebar.topMenu.undoButtonTooltip\' | i18n: { defaultMessage: \'Undo\' } }}"\n          type="button"\n          ng-click="workspace.undo()"\n          ng-disabled="workspace === null||workspace.undoLog.length <1"\n        >\n          <span class="kuiIcon fa-history"></span>\n        </button>\n\n        <button\n          class="kuiButton kuiButton--basic kuiButton--small"\n          tooltip="{{ ::\'xpack.graph.sidebar.topMenu.redoButtonTooltip\' | i18n: { defaultMessage: \'Redo\' } }}"\n          aria-label="{{ ::\'xpack.graph.sidebar.topMenu.redoButtonTooltip\' | i18n: { defaultMessage: \'Redo\' } }}"\n          type="button"\n          ng-disabled="workspace === null ||workspace.redoLog.length === 0"\n          ng-click="workspace.redo()"\n        >\n          <span class="kuiIcon fa-repeat"></span>\n        </button>\n\n        <button class="kuiButton kuiButton--basic kuiButton--small" ng-disabled="workspace === null ||liveResponseFields.length === 0||workspace.nodes.length === 0"\n          tooltip="{{ ::\'xpack.graph.sidebar.topMenu.expandSelectionButtonTooltip\' | i18n: { defaultMessage: \'Expand selection\' } }}"\n          aria-label="{{ ::\'xpack.graph.sidebar.topMenu.expandSelectionButtonTooltip\' | i18n: { defaultMessage: \'Expand selection\' } }}"\n          ng-click="setDetail(null);workspace.expandSelecteds({toFields:liveResponseFields});">\n          <span class="kuiIcon fa-plus"></span>\n        </button>\n\n        <button class="kuiButton kuiButton--basic kuiButton--small" ng-disabled="workspace === null ||workspace.nodes.length === 0"\n          tooltip="{{ ::\'xpack.graph.sidebar.topMenu.addLinksButtonTooltip\' | i18n: { defaultMessage: \'Add links between existing terms\' } }}"\n          aria-label="{{ ::\'xpack.graph.sidebar.topMenu.addLinksButtonTooltip\' | i18n: { defaultMessage: \'Add links between existing terms\' } }}"\n          ng-click="workspace.fillInGraph();">\n          <span class="kuiIcon fa-link"></span>\n        </button>\n\n        <button class="kuiButton kuiButton--basic kuiButton--small" ng-disabled="workspace === null ||workspace.nodes.length === 0"\n          tooltip="{{ ::\'xpack.graph.sidebar.topMenu.removeVerticesButtonTooltip\' | i18n: { defaultMessage: \'Remove vertices from workspace\' } }}"\n          aria-label="{{ ::\'xpack.graph.sidebar.topMenu.removeVerticesButtonTooltip\' | i18n: { defaultMessage: \'Remove vertices from workspace\' } }}"\n          ng-click="setDetail(null);workspace.deleteSelection();" data-test-subj="graphRemoveSelection">\n          <span class="kuiIcon fa-trash"></span>\n        </button>\n\n        <button class="kuiButton kuiButton--basic kuiButton--small" ng-disabled="workspace === null ||workspace.selectedNodes.length === 0"\n          tooltip="{{ ::\'xpack.graph.sidebar.topMenu.blacklistButtonTooltip\' | i18n: { defaultMessage: \'Blacklist selection from return to workspace\' } }}"\n          aria-label="{{ ::\'xpack.graph.sidebar.topMenu.blacklistButtonTooltip\' | i18n: { defaultMessage: \'Blacklist selection from return to workspace\' } }}"\n          ng-click="workspace.blacklistSelection();">\n          <span class="kuiIcon fa-ban"></span>\n        </button>\n\n        <button class="kuiButton kuiButton--basic kuiButton--small" ng-disabled="workspace === null ||workspace.selectedNodes.length === 0"\n          tooltip="{{ ::\'xpack.graph.sidebar.topMenu.customStyleButtonTooltip\' | i18n: { defaultMessage: \'Custom style selected vertices\' } }}"\n          aria-label="{{ ::\'xpack.graph.sidebar.topMenu.customStyleButtonTooltip\' | i18n: { defaultMessage: \'Custom style selected vertices\' } }}"\n          ng-click="setDetail({showStyle:true})">\n          <span class="kuiIcon fa-paint-brush"></span>\n        </button>\n\n        <button class="kuiButton kuiButton--basic kuiButton--small" ng-disabled="workspace === null||workspace.nodes.length === 0"\n          tooltip="{{ ::\'xpack.graph.sidebar.topMenu.drillDownButtonTooltip\' | i18n: { defaultMessage: \'Drill down\' } }}"\n          aria-label="{{ ::\'xpack.graph.sidebar.topMenu.drillDownButtonTooltip\' | i18n: { defaultMessage: \'Drill down\' } }}"\n          ng-click="setDetail({showDrillDowns:true})">\n          <span class="kuiIcon fa-info"></span>\n        </button>\n\n        <button class="kuiButton kuiButton--basic kuiButton--small" ng-disabled="workspace.nodes.length === 0" ng-if="workspace.nodes.length === 0||workspace.force === null"\n          tooltip="{{ ::\'xpack.graph.sidebar.topMenu.runLayoutButtonTooltip\' | i18n: { defaultMessage: \'Run layout\' } }}"\n          aria-label="{{ ::\'xpack.graph.sidebar.topMenu.runLayoutButtonTooltip\' | i18n: { defaultMessage: \'Run layout\' } }}"\n          ng-click="workspace.runLayout()" data-test-subj="graphResumeLayout">\n          <span class="kuiIcon fa-play"></span>\n        </button>\n\n        <button class="kuiButton kuiButton--basic kuiButton--small" ng-if="workspace.force !== null&&workspace.nodes.length>0"\n          tooltip="{{ ::\'xpack.graph.sidebar.topMenu.pauseLayoutButtonTooltip\' | i18n: { defaultMessage: \'Pause layout\' } }}"\n          aria-label="{{ ::\'xpack.graph.sidebar.topMenu.pauseLayoutButtonTooltip\' | i18n: { defaultMessage: \'Pause layout\' } }}"\n          ng-click="workspace.stopLayout()" data-test-subj="graphPauseLayout">\n          <span class="kuiIcon fa-pause"></span>\n        </button>\n      </div>\n\n      <div>\n        <div class="gphSidebar__header">\n          {{ ::\'xpack.graph.sidebar.selectionsTitle\' | i18n: { defaultMessage: \'Selections\' } }}\n        </div>\n\n        <div id="vertexSelectionTypesBar">\n          <button\n            tooltip="{{ ::\'xpack.graph.sidebar.selections.selectAllButtonTooltip\' | i18n: { defaultMessage: \'Select all\' } }}"\n            type="button" class="kuiButton kuiButton--basic kuiButton--small gphVertexSelect__button"\n            ng-disabled="workspace.nodes.length === 0" ng-click="setDetail(null);workspace.selectAll()"\n            i18n-id="xpack.graph.sidebar.selections.selectAllButtonLabel"\n            i18n-default-message="all" data-test-subj="graphSelectAll"\n          ></button>\n\n          <button\n            tooltip="{{ ::\'xpack.graph.sidebar.selections.selectNoneButtonTooltip\' | i18n: { defaultMessage: \'Select none\' } }}"\n            type="button" class="kuiButton kuiButton--basic kuiButton--small gphVertexSelect__button"\n            ng-disabled="workspace.nodes.length === 0" ng-click="setDetail(null);workspace.selectNone()"\n            i18n-id="xpack.graph.sidebar.selections.selectNoneButtonLabel"\n            i18n-default-message="none"\n          ></button>\n\n          <button\n            tooltip="{{ ::\'xpack.graph.sidebar.selections.invertSelectionButtonTooltip\' | i18n: { defaultMessage: \'Invert selection\' } }}"\n            type="button" class="kuiButton kuiButton--basic kuiButton--small gphVertexSelect__button"\n            ng-disabled="workspace.nodes.length === 0" ng-click="setDetail(null);workspace.selectInvert()"\n            i18n-id="xpack.graph.sidebar.selections.invertSelectionButtonLabel"\n            i18n-default-message="invert" data-test-subj="graphInvertSelection"\n          ></button>\n\n          <button\n            tooltip="{{ ::\'xpack.graph.sidebar.selections.selectNeighboursButtonTooltip\' | i18n: { defaultMessage: \'Select neighbours\' } }}"\n            type="button" class="kuiButton kuiButton--basic kuiButton--small gphVertexSelect__button"\n            ng-disabled="workspace.selectedNodes.length === 0" ng-click="setDetail(null);workspace.selectNeighbours()"\n            i18n-id="xpack.graph.sidebar.selections.selectNeighboursButtonLabel"\n            i18n-default-message="linked" data-test-subj="graphLinkedSelection"\n          ></button>\n        </div>\n\n        <div class="gphSelectionList">\n          <p\n            ng-if="workspace.selectedNodes.length === 0"\n            class="help-block"\n            i18n-id="xpack.graph.sidebar.selections.noSelectionsHelpText"\n            i18n-default-message="No selections. Click on vertices to add."\n          ></p>\n\n          <div ng-repeat="n in workspace.selectedNodes" class="gphSelectionList__field" ng-class="{\'gphSelectionList__field--selected\': isSelectedSelected(n)}"\n            ng-click="selectSelected(n)">\n            <svg width="24" height="24">\n              <circle class="gphNode__circle " r="10" cx="12" cy="12" ng-attr-style="fill:{{n.color}}"\n                ng-click="workspace.deselectNode(n)" />\n\n              <text\n                ng-if="n.icon"\n                class="fa gphNode__text gphSelectionList__icon"\n                text-anchor="middle"\n                x="12"\n                y="16"\n                ng-click="workspace.deselectNode(n)"\n                ng-class="{\'gphNode__text--inverse\': isColorDark(n.color)}"\n              >{{n.icon.code}}</text>\n            </svg>\n            <span>{{n.label}}</span>\n            <span ng-if="n.numChildren>0"> (+{{n.numChildren}})</span>\n\n          </div>\n        </div>\n      </div>\n\n      \x3c!-- Any drill-downs with a choice of button icon appear here for quick access --\x3e\n      <div ng-if="(urlTemplates | filter:{icon: {class:\'\'}}).length > 0">\n        <button ng-repeat="urlTemplate in urlTemplates  | filter:{icon: {class:\'\'}}" class="kuiButton kuiButton--basic kuiButton--small gphVertexSelect__button"\n          tooltip="{{urlTemplate.description}}" type="button" ng-disabled="workspace === null ||workspace.nodes.length === 0"\n          ng-click="openUrlTemplate(urlTemplate)">\n          <span class="kuiIcon" ng-class="urlTemplate.icon.class"></span>\n        </button>\n      </div>\n\n      <div ng-if="detail.showDrillDowns">\n        <div class="gphSidebar__header">\n          <span class="kuiIcon fa-info"></span>\n          {{ ::\'xpack.graph.sidebar.drillDownsTitle\' | i18n: { defaultMessage: \'Drill-downs\' } }}\n        </div>\n\n        <div class="gphSidebar__panel">\n          <p\n            ng-if="urlTemplates.length === 0"\n            class="help-block"\n            i18n-id="xpack.graph.sidebar.drillDowns.noDrillDownsHelpText"\n            i18n-default-message="Configure drill-downs from the settings menu"\n          ></p>\n\n          <ul class="list-group">\n            <li class="list-group-item" ng-repeat="urlTemplate in urlTemplates">\n              <span ng-if="urlTemplate.icon" class="kuiIcon gphNoUserSelect">\n                {{urlTemplate.icon.code}}</span>\n              <a ng-click="openUrlTemplate(urlTemplate)">{{urlTemplate.description}}</a>\n            </li>\n          </ul>\n        </div>\n      </div>\n\n      <div class="gphSidebar__panel" ng-if="(detail.showStyle)&&(workspace.selectedNodes.length>0)">\n        <div class="gphSidebar__header">\n          <span class="kuiIcon fa-paint-brush"></span>\n          {{ ::\'xpack.graph.sidebar.styleVerticesTitle\' | i18n: { defaultMessage: \'Style selected vertices\' } }}\n        </div>\n\n        <div class="form-group form-group-sm gphFormGroup--small">\n          <span ng-repeat="c in colors" ng-disabled="!selectedField.selected" ng-click="workspace.colorSelected(c)"\n            ng-style="{color: c}" class="kuiIcon gphColorPicker__color fa-circle">\n          </span>\n        </div>\n      </div>\n\n      <div class="gphSidebar__panel" ng-if="detail.latestNodeSelection">\n        <div class="gphSidebar__header">\n          <span class="kuiIcon {{detail.latestNodeSelection.icon.class}}" ng-if="detail.latestNodeSelection.icon"></span>\n          {{detail.latestNodeSelection.data.field}} {{detail.latestNodeSelection.data.term}}\n        </div>\n\n        <button\n          class="kuiButton kuiButton--basic kuiButton--iconText kuiButton--small"\n          ng-if="workspace.selectedNodes.length>1||(workspace.selectedNodes.length>0&&workspace.selectedNodes[0] !== detail.latestNodeSelection)"\n          tooltip="{{ \'xpack.graph.sidebar.groupButtonTooltip\' | i18n: {\n            defaultMessage: \'group the currently selected items into {latestSelectionLabel}\',\n            values: { latestSelectionLabel: detail.latestNodeSelection.label },\n          } }}"\n          ng-click="workspace.groupSelections(detail.latestNodeSelection)"\n        >\n          <span class="kuiButton__icon kuiIcon fa-object-group"></span>\n          <span\n            i18n-id="xpack.graph.sidebar.groupButtonLabel"\n            i18n-default-message="group"\n          ></span>\n        </button>\n\n        <button\n          class="kuiButton kuiButton--basic kuiButton--iconText kuiButton--small"\n          ng-if="detail.latestNodeSelection.numChildren>0"\n          tooltip="{{ \'xpack.graph.sidebar.ungroupButtonTooltip\' | i18n: {\n            defaultMessage: \'ungroup {latestSelectionLabel}\',\n            values: { latestSelectionLabel: detail.latestNodeSelection.label },\n          } }}"\n          ng-click="workspace.ungroup(detail.latestNodeSelection)"\n        >\n          <span class="kuiIcon fa-object-ungroup"></span>\n          <span\n            i18n-id="xpack.graph.sidebar.ungroupButtonLabel"\n            i18n-default-message="ungroup"\n          ></span>\n        </button>\n\n        <form class="form-horizontal">\n          <div class="form-group form-group-sm gphFormGroup--small">\n            <label\n              for="labelEdit"\n              class="col-sm-3 control-label"\n              i18n-id="xpack.graph.sidebar.displayLabelLabel"\n              i18n-default-message="Display label"\n            ></label>\n            <div class="col-sm-9">\n              <input type="text" id="labelEdit" class="form-control input-sm" ng-model="detail.latestNodeSelection.label">\n              <div\n                class="help-block"\n                i18n-id="xpack.graph.sidebar.displayLabelHelpText"\n                i18n-default-message="Change the label for this vertex."\n              ></div>\n            </div>\n          </div>\n        </form>\n      </div>\n\n      <div ng-if="detail.mergeCandidates.length>0" class="gphSidebar__panel">\n        <div class="gphSidebar__header">\n          <span class="kuiIcon fa-link"></span>\n          {{ ::\'xpack.graph.sidebar.linkSummaryTitle\' | i18n: { defaultMessage: \'Link summary\' } }}\n        </div>\n        <div ng-repeat="mc in detail.mergeCandidates">\n          <span>\n            <button\n              tooltip="{{ ::\'xpack.graph.sidebar.linkSummary.mergeTerm1ToTerm2ButtonTooltip\' | i18n: {\n                  defaultMessage: \'Merge {term1} into {term2}\',\n                  values: { term1: mc.term1, term2: mc.term2 },\n                } }}"\n              type="button" ng-attr-style="opacity:{{0.2+(mc.overlap/mc.v1)}};"\n              class="kuiButton kuiButton--basic kuiButton--small" ng-click="performMerge(mc.id2, mc.id1)">\n              <span class="kuiIcon fa-chevron-circle-right"></span>\n            </button>\n\n            <span class="gphLinkSummary__term--1">{{mc.term1}}</span>\n            <span class="gphLinkSummary__term--2">{{mc.term2}}</span>\n\n            <button\n              tooltip="{{ ::\'xpack.graph.sidebar.linkSummary.mergeTerm2ToTerm1ButtonTooltip\' | i18n: {\n                defaultMessage: \'Merge {term2} into {term1}\',\n                values: { term1: mc.term1, term2: mc.term2 },\n              } }}"\n              type="button" class="kuiButton kuiButton--basic kuiButton--small"\n              ng-attr-style="opacity:{{0.2+(mc.overlap/mc.v2)}};" ng-click="performMerge(mc.id1, mc.id2)">\n              <span class="kuiIcon fa-chevron-circle-left"></span>\n            </button>\n          </span>\n\n          \x3c!-- Venn diagram of term/shared doc intersections --\x3e\n          <venn-diagram left-value="mc.v1" right-value="mc.v2" overlap="mc.overlap"></venn-diagram>\n\n          <small\n            class="gphLinkSummary__term--1"\n            tooltip="{{ ::\'xpack.graph.sidebar.linkSummary.leftTermCountTooltip\' | i18n: {\n              defaultMessage: \'{count} documents have term {term}\',\n              values: { count: mc.v1, term: mc.term1 },\n            } }}"\n          >{{mc.v1}}</small>\n          <small\n            class="gphLinkSummary__term--1-2"\n            tooltip="{{ ::\'xpack.graph.sidebar.linkSummary.bothTermsCountTooltip\' | i18n: {\n              defaultMessage: \'{count} documents have both terms\',\n              values: { count: mc.overlap },\n            } }}"\n          >&nbsp;({{mc.overlap}})&nbsp;</small>\n          <small\n            class="gphLinkSummary__term--2"\n            tooltip="{{ ::\'xpack.graph.sidebar.linkSummary.rightTermCountTooltip\' | i18n: {\n              defaultMessage: \'{count} documents have term {term}\',\n              values: { count: mc.v2, term: mc.term2 },\n            } }}"\n          >{{mc.v2}}</small>\n        </div>\n      </div>\n      \x3c!-- end edge-merge detail panel --\x3e\n\n    </div>\n    \x3c!-- end sidebar --\x3e\n\n  </div>\n  \x3c!--end svg container--\x3e\n\n</main>\n'},7897:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_exports__["default"]='<graph-listing\n  create-item="create"\n  get-view-url="getViewUrl"\n  edit-item="editItem"\n  find-items="find"\n  delete-items="delete"\n  listing-limit="listingLimit"\n  capabilities="capabilities"\n  initial-filter="initialFilter"\n  core-start="coreStart"\n/>\n'},7898:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getReadonlyBadge=getReadonlyBadge;var _i18n=__webpack_require__(2);function getReadonlyBadge(uiCapabilities){if(uiCapabilities.graph.save){return null}return{text:_i18n.i18n.translate("xpack.graph.badge.readOnly.text",{defaultMessage:"Read only"}),tooltip:_i18n.i18n.translate("xpack.graph.badge.readOnly.tooltip",{defaultMessage:"Unable to save Graph workspaces"}),iconType:"glasses"}}},7899:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.GraphApp=GraphApp;var _eui=__webpack_require__(1);var _reactRedux=__webpack_require__(12);var _react=_interopRequireWildcard(__webpack_require__(0));var _react2=__webpack_require__(4);var _field_manager=__webpack_require__(7900);var _search_bar=__webpack_require__(7912);var _guidance_panel=__webpack_require__(7915);var _graph_title=__webpack_require__(7917);var _public=__webpack_require__(16);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _objectWithoutProperties(source,excluded){if(source==null)return{};var target=_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function _objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function GraphApp(props){var _useState=(0,_react.useState)(false),_useState2=_slicedToArray(_useState,2),pickerOpen=_useState2[0],setPickerOpen=_useState2[1];var coreStart=props.coreStart,pluginDataStart=props.pluginDataStart,storage=props.storage,reduxStore=props.reduxStore,noIndexPatterns=props.noIndexPatterns,searchBarProps=_objectWithoutProperties(props,["coreStart","pluginDataStart","storage","reduxStore","noIndexPatterns"]);return _react.default.createElement(_react2.I18nProvider,null,_react.default.createElement(_public.KibanaContextProvider,{services:_objectSpread({appName:"graph",storage:storage,data:pluginDataStart},coreStart)},_react.default.createElement(_reactRedux.Provider,{store:reduxStore},_react.default.createElement(_react.default.Fragment,null,props.isInitialized&&_react.default.createElement(_graph_title.GraphTitle,null),_react.default.createElement("div",{className:"gphGraph__bar"},_react.default.createElement(_search_bar.SearchBar,searchBarProps),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_field_manager.FieldManager,{pickerOpen:pickerOpen,setPickerOpen:setPickerOpen})),!props.isInitialized&&_react.default.createElement(_guidance_panel.GuidancePanel,{noIndexPatterns:noIndexPatterns,onOpenFieldPicker:function onOpenFieldPicker(){setPickerOpen(true)}})))))}},7900:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _field_manager=__webpack_require__(7901);Object.keys(_field_manager).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _field_manager[key]}})}))},7901:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FieldManagerComponent=FieldManagerComponent;exports.FieldManager=void 0;var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _redux=__webpack_require__(93);var _reactRedux=__webpack_require__(12);var _field_picker=__webpack_require__(7902);var _field_editor=__webpack_require__(7903);var _state_management=__webpack_require__(7117);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}function FieldManagerComponent(props){return _react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"s",className:"gphFieldManager",alignItems:"center"},props.selectedFields.map((function(field){return _react.default.createElement(_eui.EuiFlexItem,{key:field.name,grow:false},_react.default.createElement(_field_editor.FieldEditor,_extends({},props,{field:field})))})),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_field_picker.FieldPicker,_extends({},props,{open:props.pickerOpen,setOpen:props.setPickerOpen}))))}var FieldManager=(0,_reactRedux.connect)((function(state){return{fieldMap:(0,_state_management.fieldMapSelector)(state),allFields:(0,_state_management.fieldsSelector)(state),selectedFields:(0,_state_management.selectedFieldsSelector)(state)}}),(function(dispatch){return(0,_redux.bindActionCreators)({updateFieldProperties:_state_management.updateFieldProperties,selectField:_state_management.selectField,deselectField:_state_management.deselectField},dispatch)}))(FieldManagerComponent);exports.FieldManager=FieldManager},7902:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FieldPicker=FieldPicker;var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _i18n=__webpack_require__(2);var _classnames=_interopRequireDefault(__webpack_require__(63));var _public=__webpack_require__(16);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function FieldPicker(_ref){var fieldMap=_ref.fieldMap,selectField=_ref.selectField,deselectField=_ref.deselectField,open=_ref.open,setOpen=_ref.setOpen;var allFields=Object.values(fieldMap);var hasFields=allFields.length>0;var _useState=(0,_react.useState)(toOptions(allFields)),_useState2=_slicedToArray(_useState,2),fieldOptions=_useState2[0],setFieldOptions=_useState2[1];(0,_react.useEffect)((function(){if(!open){setFieldOptions(toOptions(Object.values(fieldMap)))}}),[fieldMap,open]);var badgeDescription=_i18n.i18n.translate("xpack.graph.bar.pickFieldsLabel",{defaultMessage:"Add fields"});return _react.default.createElement(_eui.EuiPopover,{id:"graphFieldPicker",anchorPosition:"downLeft",ownFocus:true,panelPaddingSize:"none",button:_react.default.createElement(_eui.EuiBadge,{"data-test-subj":"graph-add-field-button",className:(0,_classnames.default)("gphFieldPicker__button",{"gphFieldPicker__button--disabled":!hasFields}),color:"hollow",iconType:"plusInCircleFilled","aria-disabled":!hasFields,onClick:function onClick(){if(hasFields){setOpen(true)}},onClickAriaLabel:badgeDescription},badgeDescription),isOpen:open,closePopover:function closePopover(){return setOpen(false)},panelClassName:"gphFieldPicker__popoverPanel"},open&&_react.default.createElement(_eui.EuiSelectable,{searchProps:{placeholder:_i18n.i18n.translate("xpack.graph.fieldManager.fieldSearchPlaceholder",{defaultMessage:"Filter by"}),compressed:true,"data-test-subj":"graph-field-search"},listProps:{className:"gphFieldPicker__selectableList"},searchable:true,options:fieldOptions,onChange:function onChange(newOptions){newOptions.forEach((function(option){if(option.checked==="on"&&!fieldMap[option.label].selected){selectField(option.label)}else if(option.checked!=="on"&&fieldMap[option.label].selected){deselectField(option.label)}}));setFieldOptions(newOptions)}},(function(list,search){return _react.default.createElement(_react.default.Fragment,null,search,list)})))}function toOptions(fields){return fields.filter((function(field){return isExplorable(field)||field.selected})).map((function(field){return{label:field.name,prepend:_react.default.createElement(_public.FieldIcon,{type:field.type,size:"m",useColor:true}),checked:field.selected?"on":undefined}}))}var explorableTypes=["string","number","date","ip","boolean"];function isExplorable(field){if(!field.aggregatable){return false}return explorableTypes.includes(field.type)}},7903:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FieldEditor=FieldEditor;var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _i18n=__webpack_require__(2);var _classnames=_interopRequireDefault(__webpack_require__(63));var _style_choices=__webpack_require__(7171);var _legacy_icon=__webpack_require__(7240);var _public=__webpack_require__(16);var _helpers=__webpack_require__(7419);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _objectWithoutProperties(source,excluded){if(source==null)return{};var target=_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function _objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function FieldEditor(_ref){var initialField=_ref.field,updateFieldProperties=_ref.updateFieldProperties,selectField=_ref.selectField,deselectField=_ref.deselectField,allFields=_ref.allFields;var _useState=(0,_react.useState)(false),_useState2=_slicedToArray(_useState,2),open=_useState2[0],setOpen=_useState2[1];var _useState3=(0,_react.useState)(initialField),_useState4=_slicedToArray(_useState3,2),currentField=_useState4[0],setCurrentField=_useState4[1];var color=currentField.color,hopSize=currentField.hopSize,lastValidHopSize=currentField.lastValidHopSize,icon=currentField.icon,fieldName=currentField.name;var isDisabled=initialField.hopSize===0;(0,_react.useEffect)((function(){if(currentField!==initialField){setCurrentField(initialField)}}),[initialField]);function updateField(){var name=currentField.name,selected=currentField.selected,type=currentField.type,updatableProperties=_objectWithoutProperties(currentField,["name","selected","type"]);if(fieldName!==initialField.name){deselectField(initialField.name);selectField(fieldName)}updateFieldProperties({fieldName:fieldName,fieldProperties:updatableProperties});setOpen(false)}function updateProp(name,value){setCurrentField(_objectSpread({},currentField,_defineProperty({},name,value)))}function toggleDisabledState(){updateFieldProperties({fieldName:initialField.name,fieldProperties:{hopSize:isDisabled?initialField.lastValidHopSize:0,lastValidHopSize:isDisabled?0:initialField.hopSize}});setOpen(false)}var badgeDescription=isDisabled?_i18n.i18n.translate("xpack.graph.fieldManager.disabledFieldBadgeDescription",{defaultMessage:"Disabled field {field}: Click to configure. Shift+click to enable",values:{field:fieldName}}):_i18n.i18n.translate("xpack.graph.fieldManager.fieldBadgeDescription",{defaultMessage:"Field {field}: Click to configure. Shift+click to disable",values:{field:fieldName}});return _react.default.createElement(_eui.EuiPopover,{id:"graphFieldEditor",anchorPosition:"downLeft",ownFocus:true,panelPaddingSize:"none",button:_react.default.createElement(_eui.EuiBadge,{color:initialField.color,iconSide:"right",className:(0,_classnames.default)("gphFieldEditor__badge",{"gphFieldEditor__badge--disabled":isDisabled}),onClickAriaLabel:badgeDescription,title:"",onClick:function onClick(e){if(e.shiftKey){toggleDisabledState()}else{setOpen(true)}}},_react.default.createElement(_legacy_icon.LegacyIcon,{className:"gphFieldEditor__badgeIcon",icon:initialField.icon}),initialField.name),isOpen:open,closePopover:function closePopover(){return setOpen(false)}},_react.default.createElement(_eui.EuiContextMenu,{initialPanelId:"root",panels:[{id:"root",items:[{name:_i18n.i18n.translate("xpack.graph.fieldManager.settingsLabel",{defaultMessage:"Edit settings"}),icon:_react.default.createElement(_eui.EuiIcon,{type:"pencil",size:"m"}),panel:"settings"},{name:isDisabled?_i18n.i18n.translate("xpack.graph.fieldManager.enableFieldLabel",{defaultMessage:"Enable field"}):_i18n.i18n.translate("xpack.graph.fieldManager.disableFieldLabel",{defaultMessage:"Disable field"}),icon:_react.default.createElement(_eui.EuiIcon,{type:isDisabled?"eye":"eyeClosed",size:"m"}),onClick:toggleDisabledState,toolTipContent:isDisabled?_i18n.i18n.translate("xpack.graph.fieldManager.enableFieldTooltipContent",{defaultMessage:"Turn on discovery of vertices for this field. You can also Shift+click the field to enable it."}):_i18n.i18n.translate("xpack.graph.fieldManager.disableFieldTooltipContent",{defaultMessage:"Turn off discovery of vertices for this field. You can also Shift+click the field to disable it."})},{name:_i18n.i18n.translate("xpack.graph.fieldManager.deleteFieldLabel",{defaultMessage:"Deselect field"}),toolTipContent:_i18n.i18n.translate("xpack.graph.fieldManager.deleteFieldTooltipContent",{defaultMessage:"No new vertices for this field will be discovered.  Existing vertices remain in the graph."}),icon:_react.default.createElement(_eui.EuiIcon,{type:"trash",size:"m"}),onClick:function onClick(){deselectField(initialField.name);setOpen(false)}}]},{id:"settings",title:_i18n.i18n.translate("xpack.graph.fieldManager.settingsFormTitle",{defaultMessage:"Edit"}),width:380,content:_react.default.createElement(_eui.EuiForm,{className:"gphFieldEditor__displayForm"},_react.default.createElement(_eui.EuiKeyboardAccessible,null,_react.default.createElement("span",{style:{opacity:0},onClick:function onClick(){},onKeyPress:function onKeyPress(){}})),_react.default.createElement(_eui.EuiFormRow,{display:"columnCompressed",label:_i18n.i18n.translate("xpack.graph.fieldManager.fieldLabel",{defaultMessage:"Field"})},_react.default.createElement(_eui.EuiComboBox,{onChange:function onChange(choices){var newFieldName=choices[0].value;updateProp("name",newFieldName)},singleSelection:{asPlainText:true},isClearable:false,options:toOptions(allFields,initialField),selectedOptions:[{value:currentField.name,label:currentField.name,type:currentField.type}],renderOption:function renderOption(option,searchValue,contentClassName){var type=option.type,label=option.label;return _react.default.createElement("span",{className:contentClassName},_react.default.createElement(_public.FieldIcon,{type:type,size:"m",useColor:true})," ",_react.default.createElement(_eui.EuiHighlight,{search:searchValue},label))},compressed:true})),_react.default.createElement(_eui.EuiFormRow,{display:"columnCompressed",label:_i18n.i18n.translate("xpack.graph.fieldManager.colorLabel",{defaultMessage:"Color"})},_react.default.createElement(_eui.EuiColorPicker,{color:color,onChange:function onChange(newColor){updateProp("color",newColor)},compressed:true})),_react.default.createElement(_eui.EuiFormRow,{display:"columnCompressed",label:_i18n.i18n.translate("xpack.graph.fieldManager.iconLabel",{defaultMessage:"Icon"})},_react.default.createElement(_eui.EuiComboBox,{fullWidth:true,singleSelection:{asPlainText:true},isClearable:false,renderOption:function renderOption(option,searchValue,contentClassName){var label=option.label,value=option.value;return _react.default.createElement("span",{className:contentClassName},_react.default.createElement(_legacy_icon.LegacyIcon,{icon:value})," ",_react.default.createElement(_eui.EuiHighlight,{search:searchValue},label))},options:_style_choices.iconChoices.map((function(currentIcon){return{label:currentIcon.label,value:currentIcon}})),selectedOptions:[{label:icon.label,value:icon}],onChange:function onChange(choices){updateProp("icon",choices[0].value)},compressed:true})),_react.default.createElement(_eui.EuiFormRow,{display:"columnCompressed",label:_react.default.createElement(_react.default.Fragment,null,_i18n.i18n.translate("xpack.graph.fieldManager.maxTermsPerHopLabel",{defaultMessage:"Terms per hop"})," ",_react.default.createElement(_eui.EuiIconTip,{content:_i18n.i18n.translate("xpack.graph.fieldManager.maxTermsPerHopDescription",{defaultMessage:"Controls the maximum number of terms to return for each search step."}),position:"right"}))},_react.default.createElement(_eui.EuiFieldNumber,{step:1,min:1,value:isDisabled?lastValidHopSize:hopSize,onChange:function onChange(_ref2){var valueAsNumber=_ref2.target.valueAsNumber;var updatedHopSize=Number.isNaN(valueAsNumber)?1:valueAsNumber;updateProp(isDisabled?"lastValidHopSize":"hopSize",updatedHopSize)},compressed:true})),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_eui.EuiFlexGroup,{direction:"row",justifyContent:"flexEnd"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButtonEmpty,{size:"s",onClick:function onClick(){setCurrentField(initialField);setOpen(false)}},_i18n.i18n.translate("xpack.graph.fieldManager.cancelLabel",{defaultMessage:"Cancel"}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButton,{size:"s",fill:true,disabled:(0,_helpers.isEqual)(initialField,currentField),onClick:updateField},_i18n.i18n.translate("xpack.graph.fieldManager.updateLabel",{defaultMessage:"Save changes"})))))}]}))}function toOptions(fields,currentField){return fields.filter((function(field){return!field.selected||field===currentField})).map((function(_ref3){var name=_ref3.name,type=_ref3.type;return{label:name,value:name,type:type}}))}},7904:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.LegacyIcon=LegacyIcon;var _classnames=_interopRequireDefault(__webpack_require__(63));var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function LegacyIcon(props){var icon=_react.default.createElement("i",{className:(0,_classnames.default)("fa",props.className,"gphLegacyIcon",{"gphLegacyIcon--selected":props.selected,"gphLegacyIcon--pickable":!!props.onClick,"gphLegacyIcon--list":props.asListIcon}),"aria-label":props.icon.label},props.icon.code);if(props.onClick){return _react.default.createElement(_eui.EuiButtonEmpty,{role:"option","aria-selected":props.selected,color:props.selected?"primary":"text",onClick:props.onClick},icon)}else{return icon}}},7905:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.asKQL=asKQL;var _risonNode=_interopRequireDefault(__webpack_require__(163));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function escapeQuotes(str){return str.replace(/"/g,'\\"')}function asKQL(workspace,joinBy){var nodes=workspace.returnUnpackedGroupeds(workspace.getSelectedOrAllNodes());var clauses=nodes.map((function(node){return'"'.concat(escapeQuotes(node.data.field),'" : "').concat(escapeQuotes(node.data.term),'"')}));var expression=clauses.join(" ".concat(joinBy," "));return encodeURIComponent(_risonNode.default.encode(expression))}},7906:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.appStateToSavedWorkspace=appStateToSavedWorkspace;function serializeNode(_ref){var data=_ref.data,scaledSize=_ref.scaledSize,parent=_ref.parent,x=_ref.x,y=_ref.y,label=_ref.label,color=_ref.color;var allNodes=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return{x:x,y:y,label:label,color:color,field:data.field,term:data.term,parent:parent?allNodes.indexOf(parent):null,size:scaledSize}}function serializeEdge(_ref2){var source=_ref2.source,target=_ref2.target,weight=_ref2.weight,width=_ref2.width,label=_ref2.label;var allNodes=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return{weight:weight,width:width,label:label,source:allNodes.indexOf(source),target:allNodes.indexOf(target)}}function serializeUrlTemplate(_ref3){var encoder=_ref3.encoder,icon=_ref3.icon,url=_ref3.url,description=_ref3.description,isDefault=_ref3.isDefault;var serializedTemplate={url:url,description:description,isDefault:isDefault,encoderID:encoder.id};if(icon){serializedTemplate.iconClass=icon.class}return serializedTemplate}function serializeField(_ref4){var name=_ref4.name,icon=_ref4.icon,hopSize=_ref4.hopSize,lastValidHopSize=_ref4.lastValidHopSize,color=_ref4.color,selected=_ref4.selected;return{name:name,hopSize:hopSize,lastValidHopSize:lastValidHopSize,color:color,selected:selected,iconClass:icon.class}}function appStateToSavedWorkspace(currentSavedWorkspace,_ref5,canSaveData){var workspace=_ref5.workspace,urlTemplates=_ref5.urlTemplates,advancedSettings=_ref5.advancedSettings,selectedIndex=_ref5.selectedIndex,selectedFields=_ref5.selectedFields;var blacklist=canSaveData?workspace.blacklistedNodes.map((function(node){return serializeNode(node)})):[];var vertices=canSaveData?workspace.nodes.map((function(node){return serializeNode(node,workspace.nodes)})):[];var links=canSaveData?workspace.edges.map((function(edge){return serializeEdge(edge,workspace.nodes)})):[];var mappedUrlTemplates=urlTemplates.map(serializeUrlTemplate);var persistedWorkspaceState={indexPattern:selectedIndex.title,selectedFields:selectedFields.map(serializeField),blacklist:blacklist,vertices:vertices,links:links,urlTemplates:mappedUrlTemplates,exploreControls:advancedSettings};currentSavedWorkspace.wsState=JSON.stringify(persistedWorkspaceState);currentSavedWorkspace.numVertices=vertices.length;currentSavedWorkspace.numLinks=links.length}},7907:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.lookupIndexPattern=lookupIndexPattern;exports.mapFields=mapFields;exports.makeNodeId=makeNodeId;exports.savedWorkspaceToAppState=savedWorkspaceToAppState;var _outlink_encoders=__webpack_require__(7242);var _style_choices=__webpack_require__(7171);var _public=__webpack_require__(11);function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _objectWithoutProperties(source,excluded){if(source==null)return{};var target=_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function _objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}var defaultAdvancedSettings={useSignificance:true,sampleSize:2e3,timeoutMillis:5e3,maxValuesPerDoc:1,minDocCount:3};function deserializeUrlTemplate(_ref){var encoderID=_ref.encoderID,iconClass=_ref.iconClass,serializableProps=_objectWithoutProperties(_ref,["encoderID","iconClass"]);var encoder=_outlink_encoders.outlinkEncoders.find((function(outlinkEncoder){return outlinkEncoder.id===encoderID}));if(!encoder){return}var template=_objectSpread({},serializableProps,{encoder:encoder,icon:null});if(iconClass){var iconCandidate=_style_choices.urlTemplateIconChoicesByClass[iconClass];template.icon=iconCandidate?iconCandidate:null}return template}function lookupIndexPattern(savedWorkspace,indexPatterns){var serializedWorkspaceState=JSON.parse(savedWorkspace.wsState);var indexPattern=indexPatterns.find((function(pattern){return pattern.attributes.title===serializedWorkspaceState.indexPattern}));if(indexPattern){return indexPattern}}function mapFields(indexPattern){var blockedFieldNames=["_id","_index","_score","_source","_type"];var defaultHopSize=5;return indexPattern.getNonScriptedFields().filter((function(field){return!blockedFieldNames.includes(field.name)&&!(0,_public.isNestedField)(field)})).map((function(field,index){return{name:field.name,hopSize:defaultHopSize,lastValidHopSize:defaultHopSize,icon:(0,_style_choices.getSuitableIcon)(field.name),color:_style_choices.colorChoices[index%_style_choices.colorChoices.length],selected:false,type:field.type,aggregatable:Boolean(field.aggregatable)}})).sort((function(a,b){if(a.name<b.name){return-1}else if(a.name>b.name){return 1}return 0}))}function getFieldsWithWorkspaceSettings(indexPattern,selectedFields){var allFields=mapFields(indexPattern);selectedFields.forEach((function(serializedField){var workspaceField=allFields.find((function(field){return field.name===serializedField.name}));if(!workspaceField){return}workspaceField.hopSize=serializedField.hopSize;workspaceField.lastValidHopSize=serializedField.lastValidHopSize;workspaceField.color=serializedField.color;workspaceField.icon=_style_choices.iconChoicesByClass[serializedField.iconClass];workspaceField.selected=true}));return allFields}function getBlacklistedNodes(serializedWorkspaceState,allFields){return serializedWorkspaceState.blacklist.map((function(serializedNode){var currentField=allFields.find((function(field){return field.name===serializedNode.field}));return{x:0,y:0,label:serializedNode.label,color:serializedNode.color,icon:currentField.icon,parent:null,scaledSize:0,data:{field:serializedNode.field,term:serializedNode.term}}}))}function resolveGroups(nodes,workspaceInstance){nodes.forEach((function(_ref2){var field=_ref2.field,term=_ref2.term,x=_ref2.x,y=_ref2.y,parent=_ref2.parent;var nodeId=makeNodeId(field,term);var workspaceNode=workspaceInstance.nodesMap[nodeId];workspaceNode.x=x;workspaceNode.y=y;if(parent!==null){var _nodes$parent=nodes[parent],parentField=_nodes$parent.field,parentTerm=_nodes$parent.term;var parentId=makeNodeId(parentField,parentTerm);workspaceNode.parent=workspaceInstance.nodesMap[parentId]}}))}function getNodesAndEdges(persistedWorkspaceState,allFields){return{nodes:persistedWorkspaceState.vertices.map((function(serializedNode){return _objectSpread({},serializedNode,{id:"",icon:allFields.find((function(field){return field.name===serializedNode.field})).icon,data:{field:serializedNode.field,term:serializedNode.term}})})),edges:persistedWorkspaceState.links.map((function(serializedEdge){return _objectSpread({},serializedEdge,{id:""})}))}}function makeNodeId(field,term){return field+".."+term}function savedWorkspaceToAppState(savedWorkspace,indexPattern,workspaceInstance){var _workspaceInstance$bl;var persistedWorkspaceState=JSON.parse(savedWorkspace.wsState);var urlTemplates=persistedWorkspaceState.urlTemplates.map(deserializeUrlTemplate).filter((function(template){return Boolean(template)}));var allFields=getFieldsWithWorkspaceSettings(indexPattern,persistedWorkspaceState.selectedFields);var selectedFields=allFields.filter((function(field){return field.selected}));workspaceInstance.options.vertex_fields=selectedFields;var advancedSettings=Object.assign({},defaultAdvancedSettings,persistedWorkspaceState.exploreControls);if(advancedSettings.sampleDiversityField){var serializedField=advancedSettings.sampleDiversityField;advancedSettings.sampleDiversityField=allFields.find((function(field){return field.name===serializedField.name}))}workspaceInstance.options.exploreControls=advancedSettings;var graph=getNodesAndEdges(persistedWorkspaceState,allFields);workspaceInstance.mergeGraph(graph);resolveGroups(persistedWorkspaceState.vertices,workspaceInstance);var blacklistedNodes=getBlacklistedNodes(persistedWorkspaceState,allFields);(_workspaceInstance$bl=workspaceInstance.blacklistedNodes).push.apply(_workspaceInstance$bl,_toConsumableArray(blacklistedNodes));return{urlTemplates:urlTemplates,advancedSettings:advancedSettings,allFields:allFields}}},7908:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.openSaveModal=openSaveModal;var _react=_interopRequireDefault(__webpack_require__(0));var _save_modal=__webpack_require__(7909);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function openSaveModal(_ref){var savePolicy=_ref.savePolicy,hasData=_ref.hasData,workspace=_ref.workspace,saveWorkspace=_ref.saveWorkspace,showSaveModal=_ref.showSaveModal;var currentTitle=workspace.title;var currentDescription=workspace.description;var onSave=function onSave(_ref2){var newTitle=_ref2.newTitle,newDescription=_ref2.newDescription,newCopyOnSave=_ref2.newCopyOnSave,isTitleDuplicateConfirmed=_ref2.isTitleDuplicateConfirmed,onTitleDuplicate=_ref2.onTitleDuplicate,dataConsent=_ref2.dataConsent;workspace.title=newTitle;workspace.description=newDescription;workspace.copyOnSave=newCopyOnSave;var saveOptions={confirmOverwrite:false,isTitleDuplicateConfirmed:isTitleDuplicateConfirmed,onTitleDuplicate:onTitleDuplicate};return saveWorkspace(saveOptions,dataConsent).then((function(response){if(!("id"in response)||!Boolean(response.id)){workspace.title=currentTitle;workspace.description=currentDescription}return response}))};showSaveModal(_react.default.createElement(_save_modal.SaveModal,{savePolicy:savePolicy,hasData:hasData,onSave:onSave,onClose:function onClose(){},title:workspace.title,description:workspace.description,showCopyOnSave:Boolean(workspace.id)}))}},7909:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SaveModal=SaveModal;var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _i18n=__webpack_require__(2);var _public=__webpack_require__(16);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function SaveModal(_ref){var _onSave=_ref.onSave,onClose=_ref.onClose,title=_ref.title,description=_ref.description,showCopyOnSave=_ref.showCopyOnSave,savePolicy=_ref.savePolicy,hasData=_ref.hasData;var _useState=(0,_react.useState)(description),_useState2=_slicedToArray(_useState,2),newDescription=_useState2[0],setDescription=_useState2[1];var _useState3=(0,_react.useState)(false),_useState4=_slicedToArray(_useState3,2),dataConsent=_useState4[0],setDataConsent=_useState4[1];return _react.default.createElement(_public.SavedObjectSaveModal,{onSave:function onSave(props){_onSave(_objectSpread({},props,{newDescription:newDescription,dataConsent:dataConsent}))},onClose:onClose,title:title,showCopyOnSave:showCopyOnSave,objectType:_i18n.i18n.translate("xpack.graph.topNavMenu.save.objectType",{defaultMessage:"graph"}),options:_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiFormRow,{fullWidth:true,label:_i18n.i18n.translate("xpack.graph.topNavMenu.save.descriptionInputLabel",{defaultMessage:"Description"})},_react.default.createElement(_eui.EuiTextArea,{"data-test-subj":"dashboardDescription",value:newDescription,onChange:function onChange(e){setDescription(e.target.value)},fullWidth:true,rows:5})),savePolicy==="configAndDataWithConsent"&&hasData&&_react.default.createElement(_eui.EuiFormRow,{fullWidth:true,label:"",helpText:_i18n.i18n.translate("xpack.graph.topNavMenu.save.saveConfigurationOnlyWarning",{defaultMessage:"Without this setting, the data in this workspace will be cleared and only the configuration will be saved."})},_react.default.createElement(_eui.EuiSwitch,{id:"graphDataConsent",label:_i18n.i18n.translate("xpack.graph.topNavMenu.save.saveGraphContentCheckboxLabel",{defaultMessage:"Save graph content"}),checked:dataConsent,onChange:function onChange(e){setDataConsent(e.target.checked)}})),savePolicy==="config"&&hasData&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiSpacer,null),_react.default.createElement(_eui.EuiCallOut,{"data-test-subj":"graphNoDataSavedMsg"},_react.default.createElement("p",null,_i18n.i18n.translate("xpack.graph.topNavMenu.save.saveConfigurationOnlyText",{defaultMessage:"The data in this workspace will be cleared and only the configuration will be saved."}))),_react.default.createElement(_eui.EuiSpacer,null)))})}},7910:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.createServerResultNode=createServerResultNode;exports.fetchTopNodes=fetchTopNodes;function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var DEFAULT_SHARD_SIZE=5e3;function createSamplerSearchBody(aggs){var shardSize=arguments.length>1&&arguments[1]!==undefined?arguments[1]:DEFAULT_SHARD_SIZE;return{size:0,aggs:{sample:{sampler:{shard_size:shardSize},aggs:aggs}}}}function createTopTermsAggName(fieldName){return"top_values_".concat(fieldName)}function createTopTermsSubAgg(field){var size=arguments.length>1&&arguments[1]!==undefined?arguments[1]:10;return _defineProperty({},createTopTermsAggName(field),{terms:{field:field,size:size}})}function getTopTermsResult(response,fieldName){if(!response.aggregations){return[]}return response.aggregations.sample[createTopTermsAggName(fieldName)].buckets.map((function(bucket){return bucket.key}))}function createServerResultNode(fieldName,term,allFields){var field=allFields.find((function(_ref2){var name=_ref2.name;return name===fieldName}));if(!field){throw new Error("Invariant error: field not found")}return{field:fieldName,term:term,id:"",color:field.color,icon:field.icon,data:{field:fieldName,term:term},label:term}}function fetchTopNodes(post,index,fields){var aggs,body,response,nodes;return regeneratorRuntime.async((function fetchTopNodes$(_context){while(1){switch(_context.prev=_context.next){case 0:aggs=fields.map((function(_ref3){var name=_ref3.name;return name})).map((function(fieldName){return createTopTermsSubAgg(fieldName)})).reduce((function(allAggs,subAgg){return _objectSpread({},allAggs,{},subAgg)}));body=createSamplerSearchBody(aggs);_context.next=4;return regeneratorRuntime.awrap(post("../api/graph/searchProxy",{body:JSON.stringify({index:index,body:body})}));case 4:response=_context.sent.resp;nodes=[];fields.forEach((function(_ref4){var name=_ref4.name;var topTerms=getTopTermsResult(response,name);var fieldNodes=topTerms.map((function(term){return createServerResultNode(name,term,fields)}));nodes.push.apply(nodes,_toConsumableArray(fieldNodes))}));return _context.abrupt("return",nodes);case 8:case"end":return _context.stop()}}}))}},7911:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.createRootReducer=createRootReducer;exports.createGraphStore=void 0;var _reduxSaga=_interopRequireDefault(__webpack_require__(2305));var _redux=__webpack_require__(93);var _fields=__webpack_require__(7140);var _url_templates=__webpack_require__(7241);var _advanced_settings=__webpack_require__(7172);var _datasource=__webpack_require__(7086);var _datasource2=__webpack_require__(7421);var _persistence=__webpack_require__(7422);var _meta_data=__webpack_require__(7245);var _workspace=__webpack_require__(7423);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function createRootReducer(basePath){return(0,_redux.combineReducers)({fields:_fields.fieldsReducer,urlTemplates:(0,_url_templates.urlTemplatesReducer)(basePath),advancedSettings:_advanced_settings.advancedSettingsReducer,datasource:_datasource.datasourceReducer,metaData:_meta_data.metaDataReducer})}function registerSagas(sagaMiddleware,deps){sagaMiddleware.run((0,_datasource2.datasourceSaga)(deps));sagaMiddleware.run((0,_persistence.loadingSaga)(deps));sagaMiddleware.run((0,_persistence.savingSaga)(deps));sagaMiddleware.run((0,_fields.syncFieldsSaga)(deps));sagaMiddleware.run((0,_fields.syncNodeStyleSaga)(deps));sagaMiddleware.run((0,_advanced_settings.syncSettingsSaga)(deps));sagaMiddleware.run((0,_fields.updateSaveButtonSaga)(deps));sagaMiddleware.run((0,_meta_data.syncBreadcrumbSaga)(deps));sagaMiddleware.run((0,_url_templates.syncTemplatesSaga)(deps));sagaMiddleware.run((0,_workspace.fillWorkspaceSaga)(deps))}var createGraphStore=function createGraphStore(deps){var sagaMiddleware=(0,_reduxSaga.default)();var rootReducer=createRootReducer(deps.basePath);var store=(0,_redux.createStore)(rootReducer,(0,_redux.applyMiddleware)(sagaMiddleware));registerSagas(sagaMiddleware,deps);return store};exports.createGraphStore=createGraphStore},7912:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SearchBarComponent=SearchBarComponent;exports.SearchBar=void 0;var _eui=__webpack_require__(1);var _react=_interopRequireWildcard(__webpack_require__(0));var _i18n=__webpack_require__(2);var _reactRedux=__webpack_require__(12);var _source_modal=__webpack_require__(7424);var _state_management=__webpack_require__(7117);var _public=__webpack_require__(16);var _public2=__webpack_require__(11);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function queryToString(query,indexPattern){if(query.language==="kuery"&&typeof query.query==="string"){var dsl=_public2.esKuery.toElasticsearchQuery(_public2.esKuery.fromKueryExpression(query.query),indexPattern);return JSON.stringify(dsl)}if(typeof query.query==="string"){return query.query}return JSON.stringify(query.query)}function SearchBarComponent(props){var currentDatasource=props.currentDatasource,onQuerySubmit=props.onQuerySubmit,isLoading=props.isLoading,onIndexPatternSelected=props.onIndexPatternSelected,initialQuery=props.initialQuery,indexPatternProvider=props.indexPatternProvider,confirmWipeWorkspace=props.confirmWipeWorkspace;var _useState=(0,_react.useState)({language:"kuery",query:initialQuery||""}),_useState2=_slicedToArray(_useState,2),query=_useState2[0],setQuery=_useState2[1];var _useState3=(0,_react.useState)(undefined),_useState4=_slicedToArray(_useState3,2),currentIndexPattern=_useState4[0],setCurrentIndexPattern=_useState4[1];(0,_react.useEffect)((function(){function fetchPattern(){return regeneratorRuntime.async((function fetchPattern$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!currentDatasource){_context.next=8;break}_context.t0=setCurrentIndexPattern;_context.next=4;return regeneratorRuntime.awrap(indexPatternProvider.get(currentDatasource.id));case 4:_context.t1=_context.sent;(0,_context.t0)(_context.t1);_context.next=9;break;case 8:setCurrentIndexPattern(undefined);case 9:case"end":return _context.stop()}}}))}fetchPattern()}),[currentDatasource,indexPatternProvider]);var kibana=(0,_public.useKibana)();var services=kibana.services,overlays=kibana.overlays;var savedObjects=services.savedObjects,uiSettings=services.uiSettings;if(!overlays)return null;return _react.default.createElement("form",{onSubmit:function onSubmit(e){e.preventDefault();if(!isLoading&&currentIndexPattern){onQuerySubmit(queryToString(query,currentIndexPattern))}}},_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"m"},_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_public2.QueryStringInput,{disableAutoFocus:true,bubbleSubmitEvent:true,indexPatterns:currentIndexPattern?[currentIndexPattern]:[],placeholder:_i18n.i18n.translate("xpack.graph.bar.searchFieldPlaceholder",{defaultMessage:"Search your data and add to graph"}),query:query,prepend:_react.default.createElement(_eui.EuiToolTip,{content:_i18n.i18n.translate("xpack.graph.bar.pickSourceTooltip",{defaultMessage:"Select a data source to begin graphing relationships."})},_react.default.createElement(_eui.EuiButtonEmpty,{size:"xs",className:"gphSearchBar__datasourceButton","data-test-subj":"graphDatasourceButton",onClick:function onClick(){confirmWipeWorkspace((function(){return(0,_source_modal.openSourceModal)({overlays:overlays,savedObjects:savedObjects,uiSettings:uiSettings},onIndexPatternSelected)}),_i18n.i18n.translate("xpack.graph.clearWorkspace.confirmText",{defaultMessage:"If you change data sources, your current fields and vertices will be reset."}),{confirmButtonText:_i18n.i18n.translate("xpack.graph.clearWorkspace.confirmButtonLabel",{defaultMessage:"Change data source"}),title:_i18n.i18n.translate("xpack.graph.clearWorkspace.modalTitle",{defaultMessage:"Unsaved changes"})})}},currentIndexPattern?currentIndexPattern.title:_i18n.i18n.translate("xpack.graph.bar.pickSourceLabel",{defaultMessage:"Select a data source"}))),onChange:setQuery})),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButton,{fill:true,type:"submit",disabled:isLoading||!currentIndexPattern,"data-test-subj":"graph-explore-button"},_i18n.i18n.translate("xpack.graph.bar.exploreLabel",{defaultMessage:"Graph"})))))}var SearchBar=(0,_reactRedux.connect)((function(state){var datasource=(0,_state_management.datasourceSelector)(state);return{currentDatasource:datasource.current.type==="indexpattern"?datasource.current:undefined}}),(function(dispatch){return{onIndexPatternSelected:function onIndexPatternSelected(indexPattern){dispatch((0,_state_management.requestDatasource)({type:"indexpattern",id:indexPattern.id,title:indexPattern.attributes.title}))}}}))(SearchBarComponent);exports.SearchBar=SearchBar},7913:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SourceModal=SourceModal;var _eui=__webpack_require__(1);var _react=__webpack_require__(4);var _react2=_interopRequireDefault(__webpack_require__(0));var _source_picker=__webpack_require__(7914);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function SourceModal(props){return _react2.default.createElement("div",{className:"gphSourceModal"},_react2.default.createElement(_eui.EuiModalHeader,null,_react2.default.createElement(_eui.EuiModalHeaderTitle,null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.graph.sourceModal.title",defaultMessage:"Select a data source"}))),_react2.default.createElement(_eui.EuiModalBody,null,_react2.default.createElement(_source_picker.SourcePicker,props)))}},7914:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SourcePicker=SourcePicker;var _i18n=__webpack_require__(2);var _react=_interopRequireDefault(__webpack_require__(0));var _public=__webpack_require__(16);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var fixedPageSize=8;function SourcePicker(_ref){var savedObjects=_ref.savedObjects,uiSettings=_ref.uiSettings,onIndexPatternSelected=_ref.onIndexPatternSelected;return _react.default.createElement(_public.SavedObjectFinderUi,{savedObjects:savedObjects,uiSettings:uiSettings,onChoose:function onChoose(_id,_type,_name,indexPattern){onIndexPatternSelected(indexPattern)},showFilter:false,noItemsMessage:_i18n.i18n.translate("xpack.graph.sourceModal.notFoundLabel",{defaultMessage:"No data sources found."}),savedObjectMetaData:[{type:"index-pattern",getIconForSavedObject:function getIconForSavedObject(){return"indexPatternApp"},name:_i18n.i18n.translate("xpack.graph.sourceModal.savedObjectType.indexPattern",{defaultMessage:"Index pattern"}),showSavedObject:function showSavedObject(indexPattern){return!indexPattern.attributes.type},includeFields:["type"]}],fixedPageSize:fixedPageSize})}},7915:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _guidance_panel=__webpack_require__(7916);Object.keys(_guidance_panel).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _guidance_panel[key]}})}))},7916:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.GuidancePanel=void 0;var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _i18n=__webpack_require__(2);var _classnames=_interopRequireDefault(__webpack_require__(63));var _react2=__webpack_require__(4);var _reactRedux=__webpack_require__(12);var _state_management=__webpack_require__(7117);var _source_modal=__webpack_require__(7424);var _public=__webpack_require__(16);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ListItem(_ref){var children=_ref.children,state=_ref.state;return _react.default.createElement("li",{className:(0,_classnames.default)("gphGuidancePanel__item",{"gphGuidancePanel__item--disabled":state==="disabled"}),"aria-disabled":state==="disabled","aria-current":state==="active"?"step":undefined},state!=="disabled"&&_react.default.createElement("span",{className:(0,_classnames.default)("gphGuidancePanel__itemIcon",{"gphGuidancePanel__itemIcon--done":state==="done"}),"aria-hidden":true},_react.default.createElement(_eui.EuiIcon,{type:state==="active"?"sortRight":"check"})),_react.default.createElement(_eui.EuiText,null,children))}function GuidancePanelComponent(props){var onFillWorkspace=props.onFillWorkspace,onOpenFieldPicker=props.onOpenFieldPicker,onIndexPatternSelected=props.onIndexPatternSelected,hasDatasource=props.hasDatasource,hasFields=props.hasFields,noIndexPatterns=props.noIndexPatterns;var kibana=(0,_public.useKibana)();var services=kibana.services,overlays=kibana.overlays;var savedObjects=services.savedObjects,uiSettings=services.uiSettings,chrome=services.chrome,application=services.application;if(!overlays||!chrome||!application)return null;var onOpenDatasourcePicker=function onOpenDatasourcePicker(){(0,_source_modal.openSourceModal)({overlays:overlays,savedObjects:savedObjects,uiSettings:uiSettings},onIndexPatternSelected)};var content=_react.default.createElement(_eui.EuiPanel,{"data-test-subj":"graphGuidancePanel"},_react.default.createElement(_eui.EuiFlexGroup,{direction:"column",alignItems:"center"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiIcon,{type:"graphApp",size:"xxl"})),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiText,null,_react.default.createElement("h1",{id:"graphHeading"},_i18n.i18n.translate("xpack.graph.guidancePanel.title",{defaultMessage:"Three steps to your graph"})))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement("ol",{className:"gphGuidancePanel__list","aria-labelledby":"graphHeading"},_react.default.createElement(ListItem,{state:hasDatasource?"done":"active"},_react.default.createElement(_eui.EuiLink,{onClick:onOpenDatasourcePicker},_i18n.i18n.translate("xpack.graph.guidancePanel.datasourceItem.indexPatternButtonLabel",{defaultMessage:"Select a data source."}))),_react.default.createElement(ListItem,{state:hasFields?"done":hasDatasource?"active":"disabled"},_react.default.createElement(_eui.EuiLink,{onClick:onOpenFieldPicker,disabled:!hasFields&&!hasDatasource},_i18n.i18n.translate("xpack.graph.guidancePanel.fieldsItem.fieldsButtonLabel",{defaultMessage:"Add fields."}))),_react.default.createElement(ListItem,{state:hasFields?"active":"disabled"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.graph.guidancePanel.nodesItem.description",defaultMessage:"Enter a query in the search bar to start exploring. Don't know where to start? {topTerms}.",values:{topTerms:_react.default.createElement(_eui.EuiLink,{onClick:onFillWorkspace,disabled:!hasFields},_i18n.i18n.translate("xpack.graph.guidancePanel.nodesItem.topTermsButtonLabel",{defaultMessage:"Graph the top terms"}))}}))))));if(noIndexPatterns){var managementUrl=chrome.navLinks.get("kibana:management").url;var indexPatternUrl="".concat(managementUrl,"/kibana/index_patterns");var sampleDataUrl="".concat(application.getUrlForApp("kibana"),"#/home/tutorial_directory/sampleData");content=_react.default.createElement(_eui.EuiPanel,{paddingSize:"none"},_react.default.createElement(_eui.EuiCallOut,{color:"warning",iconType:"help",title:_i18n.i18n.translate("xpack.graph.noDataSourceNotificationMessageTitle",{defaultMessage:"No data source"}),heading:"h1"},_react.default.createElement(_eui.EuiScreenReaderOnly,null,_react.default.createElement("p",{id:"graphHeading"},_i18n.i18n.translate("xpack.graph.noDataSourceNotificationMessageTitle",{defaultMessage:"No data source"}))),_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.graph.noDataSourceNotificationMessageText",defaultMessage:"No data sources found. Go to {managementIndexPatternsLink} and create an index pattern for your Elasticsearch indices.",values:{managementIndexPatternsLink:_react.default.createElement("a",{href:indexPatternUrl},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.graph.noDataSourceNotificationMessageText.managementIndexPatternLinkText",defaultMessage:"Management > Index Patterns"}))}})),_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.graph.listing.noDataSource.newToKibanaDescription",defaultMessage:"New to Kibana? You can also use our {sampleDataInstallLink}.",values:{sampleDataInstallLink:_react.default.createElement(_eui.EuiLink,{href:sampleDataUrl},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.graph.listing.noDataSource.sampleDataInstallLinkText",defaultMessage:"sample data"}))}}))))}return _react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"center"},_react.default.createElement(_eui.EuiFlexItem,{className:"gphGuidancePanel"},content))}var GuidancePanel=(0,_reactRedux.connect)((function(state){return{hasDatasource:(0,_state_management.hasDatasourceSelector)(state),hasFields:(0,_state_management.hasFieldsSelector)(state)}}),(function(dispatch){return{onIndexPatternSelected:function onIndexPatternSelected(indexPattern){dispatch((0,_state_management.requestDatasource)({type:"indexpattern",id:indexPattern.id,title:indexPattern.attributes.title}))},onFillWorkspace:function onFillWorkspace(){dispatch((0,_state_management.fillWorkspace)())}}}))(GuidancePanelComponent);exports.GuidancePanel=GuidancePanel},7917:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.GraphTitle=void 0;var _reactRedux=__webpack_require__(12);var _eui=__webpack_require__(1);var _react=_interopRequireDefault(__webpack_require__(0));var _state_management=__webpack_require__(7117);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var GraphTitle=(0,_reactRedux.connect)((function(state){return{title:(0,_state_management.metaDataSelector)(state).title}}))((function(_ref){var title=_ref.title;return _react.default.createElement(_eui.EuiScreenReaderOnly,null,_react.default.createElement("h1",{id:"graphHeading"},title))}));exports.GraphTitle=GraphTitle},7918:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _venn_diagram=__webpack_require__(7919);Object.keys(_venn_diagram).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _venn_diagram[key]}})}))},7919:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.VennDiagram=VennDiagram;var _venn=__webpack_require__(9249);var _react=_interopRequireDefault(__webpack_require__(0));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function getRadius(area){return Math.sqrt(area/Math.PI)}function VennDiagram(_ref){var leftValue=_ref.leftValue,rightValue=_ref.rightValue,overlap=_ref.overlap;var leftRadius=getRadius(leftValue);var rightRadius=getRadius(rightValue);var maxRadius=Math.max(leftRadius,rightRadius);var imageHeight=maxRadius*2;var imageWidth=maxRadius*4;var leftCenter=leftRadius;var rightCenter=leftCenter+(0,_venn.distanceFromIntersectArea)(leftRadius,rightRadius,overlap);var blankWidth=imageWidth-(rightCenter+rightRadius);var padding=blankWidth/2;var viewBoxDims="0 0 ".concat(imageWidth," ").concat(imageHeight);return _react.default.createElement("div",null,_react.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:100,height:60,viewBox:viewBoxDims},_react.default.createElement("g",null,_react.default.createElement("circle",{cx:leftCenter+padding,cy:maxRadius,r:leftRadius,className:"gphVennDiagram__left"}),_react.default.createElement("circle",{cx:rightCenter+padding,cy:maxRadius,r:rightRadius,className:"gphVennDiagram__right"}))))}},7921:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Listing=Listing;var _i18n=__webpack_require__(2);var _react=__webpack_require__(4);var _react2=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _public=__webpack_require__(16);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function Listing(props){return _react2.default.createElement(_react.I18nProvider,null,_react2.default.createElement(_public.TableListView,{headingId:"graphListingHeading",createItem:props.capabilities.save?props.createItem:undefined,findItems:props.findItems,deleteItems:props.capabilities.delete?props.deleteItems:undefined,editItem:props.capabilities.save?props.editItem:undefined,tableColumns:getTableColumns(props.getViewUrl),listingLimit:props.listingLimit,initialFilter:props.initialFilter,noItemsFragment:getNoItemsMessage(props.capabilities.save===false,props.createItem,props.coreStart.application),toastNotifications:props.coreStart.notifications.toasts,entityName:_i18n.i18n.translate("xpack.graph.listing.table.entityName",{defaultMessage:"graph"}),entityNamePlural:_i18n.i18n.translate("xpack.graph.listing.table.entityNamePlural",{defaultMessage:"graphs"}),tableListTitle:_i18n.i18n.translate("xpack.graph.listing.graphsTitle",{defaultMessage:"Graphs"}),uiSettings:props.coreStart.uiSettings}))}function getNoItemsMessage(hideWriteControls,createItem,application){if(hideWriteControls){return _react2.default.createElement("div",null,_react2.default.createElement(_eui.EuiEmptyPrompt,{iconType:"graphApp",title:_react2.default.createElement("h1",{id:"graphListingHeading"},_react2.default.createElement(_react.FormattedMessage,{id:"xpack.graph.listing.noItemsMessage",defaultMessage:"Looks like you don't have any graphs."}))}))}var sampleDataUrl="".concat(application.getUrlForApp("kibana"),"#/home/tutorial_directory/sampleData");return _react2.default.createElement("div",null,_react2.default.createElement(_eui.EuiEmptyPrompt,{iconType:"graphApp",title:_react2.default.createElement("h1",{id:"graphListingHeading"},_react2.default.createElement(_react.FormattedMessage,{id:"xpack.graph.listing.createNewGraph.title",defaultMessage:"Create your first graph"})),body:_react2.default.createElement(_react2.Fragment,null,_react2.default.createElement("p",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.graph.listing.createNewGraph.combineDataViewFromKibanaAppDescription",defaultMessage:"Discover patterns and relationships in your Elasticsearch indices."})),_react2.default.createElement("p",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.graph.listing.createNewGraph.newToKibanaDescription",defaultMessage:"New to Kibana? Get started with {sampleDataInstallLink}.",values:{sampleDataInstallLink:_react2.default.createElement(_eui.EuiLink,{href:sampleDataUrl},_react2.default.createElement(_react.FormattedMessage,{id:"xpack.graph.listing.createNewGraph.sampleDataInstallLinkText",defaultMessage:"sample data"}))}}))),actions:_react2.default.createElement(_eui.EuiButton,{onClick:createItem,fill:true,iconType:"plusInCircle","data-test-subj":"graphCreateGraphPromptButton"},_react2.default.createElement(_react.FormattedMessage,{id:"xpack.graph.listing.createNewGraph.createButtonLabel",defaultMessage:"Create graph"}))}))}function getTableColumns(getViewUrl){return[{field:"title",name:_i18n.i18n.translate("xpack.graph.listing.table.titleColumnName",{defaultMessage:"Title"}),sortable:true,render:function render(field,record){return _react2.default.createElement(_eui.EuiLink,{href:getViewUrl(record),"data-test-subj":"graphListingTitleLink-".concat(record.title.split(" ").join("-"))},field)}},{field:"description",name:_i18n.i18n.translate("xpack.graph.listing.table.descriptionColumnName",{defaultMessage:"Description"}),dataType:"string",sortable:true}]}},7922:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _settings=__webpack_require__(7923);Object.keys(_settings).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _settings[key]}})}))},7923:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SettingsComponent=SettingsComponent;exports.Settings=void 0;var _i18n=__webpack_require__(2);var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _reactRedux=__webpack_require__(12);var _redux=__webpack_require__(93);var _advanced_settings_form=__webpack_require__(7924);var _blacklist_form=__webpack_require__(7925);var _url_template_list=__webpack_require__(7926);var _state_management=__webpack_require__(7117);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _objectWithoutProperties(source,excluded){if(source==null)return{};var target=_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function _objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}var tabs=[{id:"advancedSettings",title:_i18n.i18n.translate("xpack.graph.settings.advancedSettingsTitle",{defaultMessage:"Advanced settings"}),component:_advanced_settings_form.AdvancedSettingsForm},{id:"blacklist",title:_i18n.i18n.translate("xpack.graph.settings.blacklistTitle",{defaultMessage:"Block list"}),component:_blacklist_form.BlacklistForm},{id:"drillDowns",title:_i18n.i18n.translate("xpack.graph.settings.drillDownsTitle",{defaultMessage:"Drilldowns"}),component:_url_template_list.UrlTemplateList}];function SettingsComponent(_ref){var observable=_ref.observable,props=_objectWithoutProperties(_ref,["observable"]);var _useState=(0,_react.useState)(undefined),_useState2=_slicedToArray(_useState,2),angularProps=_useState2[0],setAngularProps=_useState2[1];var _useState3=(0,_react.useState)(0),_useState4=_slicedToArray(_useState3,2),activeTab=_useState4[0],setActiveTab=_useState4[1];(0,_react.useEffect)((function(){observable.subscribe(setAngularProps)}),[observable]);if(!angularProps)return null;var ActiveTabContent=tabs[activeTab].component;return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiFlyoutHeader,{hasBorder:true},_react.default.createElement(_eui.EuiTitle,{size:"m"},_react.default.createElement("h2",null,_i18n.i18n.translate("xpack.graph.settings.title",{defaultMessage:"Settings"}))),_react.default.createElement(_eui.EuiTabs,{style:{margin:"0 -16px -25px"}},tabs.filter((function(_ref2){var id=_ref2.id;return id!=="drillDowns"||angularProps.canEditDrillDownUrls})).map((function(_ref3,index){var title=_ref3.title;return _react.default.createElement(_eui.EuiTab,{key:title,isSelected:activeTab===index,onClick:function onClick(){setActiveTab(index)}},title)})))),_react.default.createElement(_eui.EuiFlyoutBody,null,_react.default.createElement(ActiveTabContent,_extends({},angularProps,props))))}var Settings=(0,_reactRedux.connect)((function(state){return{advancedSettings:(0,_state_management.settingsSelector)(state),urlTemplates:(0,_state_management.templatesSelector)(state),allFields:(0,_state_management.fieldsSelector)(state)}}),(function(dispatch){return(0,_redux.bindActionCreators)({updateSettings:_state_management.updateSettings,saveTemplate:_state_management.saveTemplate,removeTemplate:_state_management.removeTemplate},dispatch)}))(SettingsComponent);exports.Settings=Settings},7924:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AdvancedSettingsForm=AdvancedSettingsForm;var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _i18n=__webpack_require__(2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function AdvancedSettingsForm(_ref){var advancedSettings=_ref.advancedSettings,updateSettings=_ref.updateSettings,allFields=_ref.allFields;function updateSetting(key,value){updateSettings(_objectSpread({},advancedSettings,_defineProperty({},key,value)))}function getNumberUpdater(key){return function(_ref2){var valueAsNumber=_ref2.target.valueAsNumber;updateSetting(key,Number.isNaN(valueAsNumber)?1:valueAsNumber)}}return _react.default.createElement("form",null,_react.default.createElement(_eui.EuiFormRow,{fullWidth:true,helpText:_i18n.i18n.translate("xpack.graph.settings.advancedSettings.sampleSizeInputHelpText",{defaultMessage:"Terms are identified from samples of the most relevant documents. Bigger samples are not necessarily better—they can be slower and less relevant."}),label:_i18n.i18n.translate("xpack.graph.settings.advancedSettings.sampleSizeInputLabel",{defaultMessage:"Sample size"})},_react.default.createElement(_eui.EuiFieldNumber,{fullWidth:true,min:1,step:1,value:advancedSettings.sampleSize,onChange:getNumberUpdater("sampleSize")})),_react.default.createElement(_eui.EuiFormRow,{fullWidth:true,helpText:_i18n.i18n.translate("xpack.graph.settings.advancedSettings.significantLinksCheckboxHelpText",{defaultMessage:"Identify terms that are significant rather than popular."}),label:""},_react.default.createElement(_eui.EuiSwitch,{label:_i18n.i18n.translate("xpack.graph.settings.advancedSettings.significantLinksCheckboxLabel",{defaultMessage:"Significant links"}),id:"graphSignificance",checked:advancedSettings.useSignificance,onChange:function onChange(_ref3){var checked=_ref3.target.checked;return updateSetting("useSignificance",checked)}})),_react.default.createElement(_eui.EuiFormRow,{fullWidth:true,helpText:_i18n.i18n.translate("xpack.graph.settings.advancedSettings.certaintyInputHelpText",{defaultMessage:"The minimum number of documents before introducing a related term."}),label:_i18n.i18n.translate("xpack.graph.settings.advancedSettings.certaintyInputLabel",{defaultMessage:"Certainty"})},_react.default.createElement(_eui.EuiFieldNumber,{fullWidth:true,min:1,step:1,value:advancedSettings.minDocCount,onChange:getNumberUpdater("minDocCount")})),_react.default.createElement(_eui.EuiFormRow,{fullWidth:true,helpText:_react.default.createElement(_react.default.Fragment,null,_i18n.i18n.translate("xpack.graph.settings.advancedSettings.diversityFieldInputHelpText1",{defaultMessage:"To avoid dominating samples with a single voice, select a field to help identify the source of bias."})," ",_react.default.createElement("em",null,_i18n.i18n.translate("xpack.graph.settings.advancedSettings.diversityFieldInputHelpText2",{defaultMessage:"This must be a single-term field, or searches will be rejected."}))),label:_i18n.i18n.translate("xpack.graph.settings.advancedSettings.diversityFieldInputLabel",{defaultMessage:"Diversity field"})},_react.default.createElement(_eui.EuiComboBox,{fullWidth:true,placeholder:_i18n.i18n.translate("xpack.graph.settings.advancedSettings.diversityFieldInputOptionLabel",{defaultMessage:"No diversification"}),singleSelection:{asPlainText:true},options:allFields.map((function(field){return{label:field.name,value:field}})),selectedOptions:advancedSettings.sampleDiversityField?[{label:advancedSettings.sampleDiversityField.name,value:advancedSettings.sampleDiversityField}]:[],onChange:function onChange(choices){updateSetting("sampleDiversityField",choices.length===1?choices[0].value:undefined)}})),advancedSettings.sampleDiversityField&&_react.default.createElement(_eui.EuiFormRow,{fullWidth:true,helpText:_react.default.createElement(_react.default.Fragment,null,_i18n.i18n.translate("xpack.graph.settings.advancedSettings.maxValuesInputHelpText",{defaultMessage:"Max number of documents in a sample that can contain the same value for the"})," ",_react.default.createElement("em",null,advancedSettings.sampleDiversityField.name)," ",_i18n.i18n.translate("xpack.graph.settings.advancedSettings.maxValuesInputHelpText.fieldText",{defaultMessage:"field"})),label:_i18n.i18n.translate("xpack.graph.settings.advancedSettings.maxValuesInputLabel",{defaultMessage:"Max docs per field"})},_react.default.createElement(_eui.EuiFieldNumber,{fullWidth:true,min:1,step:1,value:advancedSettings.maxValuesPerDoc,onChange:getNumberUpdater("maxValuesPerDoc")})),_react.default.createElement(_eui.EuiFormRow,{fullWidth:true,helpText:_i18n.i18n.translate("xpack.graph.settings.advancedSettings.timeoutInputHelpText",{defaultMessage:"The maximum number of milliseconds that a request can run."}),label:_i18n.i18n.translate("xpack.graph.settings.advancedSettings.timeoutInputLabel",{defaultMessage:"Timeout"})},_react.default.createElement(_eui.EuiFieldNumber,{fullWidth:true,min:1,step:1,value:advancedSettings.timeoutMillis,onChange:getNumberUpdater("timeoutMillis"),append:_react.default.createElement(_eui.EuiText,{size:"xs"},_react.default.createElement("strong",null,_i18n.i18n.translate("xpack.graph.settings.advancedSettings.timeoutUnit",{defaultMessage:"ms"})))})))}},7925:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.BlacklistForm=BlacklistForm;var _react=_interopRequireDefault(__webpack_require__(0));var _i18n=__webpack_require__(2);var _react2=__webpack_require__(4);var _eui=__webpack_require__(1);var _legacy_icon=__webpack_require__(7240);var _use_list_keys=__webpack_require__(7425);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function BlacklistForm(_ref){var blacklistedNodes=_ref.blacklistedNodes,unblacklistNode=_ref.unblacklistNode;var getListKey=(0,_use_list_keys.useListKeys)(blacklistedNodes||[]);return _react.default.createElement(_react.default.Fragment,null,blacklistedNodes&&blacklistedNodes.length>0?_react.default.createElement(_eui.EuiText,{size:"s"},_i18n.i18n.translate("xpack.graph.settings.blacklist.blacklistHelpText",{defaultMessage:"These terms are not allowed in the graph."})):_react.default.createElement(_eui.EuiCallOut,{title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.graph.blacklist.noEntriesDescription",defaultMessage:"You don't have any blocked terms. Select vertices and click {stopSign} in the control panel on the right to block them. Documents that match blocked terms are no longer explored and relationships to them are hidden.",values:{stopSign:_react.default.createElement("span",{className:"kuiIcon fa-ban"})}})}),_react.default.createElement(_eui.EuiSpacer,null),blacklistedNodes&&unblacklistNode&&blacklistedNodes.length>0&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiListGroup,{bordered:true,maxWidth:false},blacklistedNodes.map((function(node){return _react.default.createElement(_eui.EuiListGroupItem,{icon:_react.default.createElement(_legacy_icon.LegacyIcon,{icon:node.icon,asListIcon:true}),key:getListKey(node),label:node.label,extraAction:{iconType:"trash","aria-label":_i18n.i18n.translate("xpack.graph.blacklist.removeButtonAriaLabel",{defaultMessage:"Delete"}),title:_i18n.i18n.translate("xpack.graph.blacklist.removeButtonAriaLabel",{defaultMessage:"Delete"}),color:"danger",onClick:function onClick(){unblacklistNode(node)}}})}))),_react.default.createElement(_eui.EuiSpacer,null),_react.default.createElement(_eui.EuiButton,{"data-test-subj":"graphUnblacklistAll",color:"danger",iconType:"trash",size:"s",fill:true,onClick:function onClick(){blacklistedNodes.forEach((function(node){unblacklistNode(node)}))}},_i18n.i18n.translate("xpack.graph.settings.blacklist.clearButtonLabel",{defaultMessage:"Delete all"}))))}},7926:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.UrlTemplateList=UrlTemplateList;var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _i18n=__webpack_require__(2);var _url_template_form=__webpack_require__(7927);var _use_list_keys=__webpack_require__(7425);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var generateId=(0,_eui.htmlIdGenerator)();function UrlTemplateList(_ref){var removeTemplate=_ref.removeTemplate,saveTemplate=_ref.saveTemplate,urlTemplates=_ref.urlTemplates;var _useState=(0,_react.useState)([]),_useState2=_slicedToArray(_useState,2),uncommittedForms=_useState2[0],setUncommittedForms=_useState2[1];var getListKey=(0,_use_list_keys.useListKeys)(urlTemplates);function removeUncommittedForm(id){setUncommittedForms(uncommittedForms.filter((function(formId){return formId!==id})))}return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiText,{size:"s"},_i18n.i18n.translate("xpack.graph.drilldowns.description",{defaultMessage:"Use drilldowns to link to other applications. The selected vertices become part of the URL."})),_react.default.createElement(_eui.EuiSpacer,null),urlTemplates.map((function(template,index){return _react.default.createElement(_url_template_form.UrlTemplateForm,{key:getListKey(template),id:getListKey(template),initialTemplate:template,onSubmit:function onSubmit(newTemplate){saveTemplate({index:index,template:newTemplate})},onRemove:function onRemove(){removeTemplate(template)}})})),uncommittedForms.map((function(id){return _react.default.createElement(_url_template_form.UrlTemplateForm,{id:"accordion-new-".concat(id),key:id,onSubmit:function onSubmit(newTemplate){saveTemplate({index:-1,template:newTemplate});removeUncommittedForm(id)},onRemove:removeUncommittedForm.bind(undefined,id)})})),_react.default.createElement(_eui.EuiSpacer,null),_react.default.createElement(_eui.EuiTextAlign,{textAlign:"center"},_react.default.createElement(_eui.EuiButton,{size:"s",fill:true,iconType:"plusInCircle","data-test-subj":"graphAddNewTemplate",onClick:function onClick(){setUncommittedForms([].concat(_toConsumableArray(uncommittedForms),[generateId()]))}},_i18n.i18n.translate("xpack.graph.templates.newTemplateFormLabel",{defaultMessage:"Add drilldown"}))))}},7927:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.UrlTemplateForm=UrlTemplateForm;var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _i18n=__webpack_require__(2);var _classnames=_interopRequireDefault(__webpack_require__(63));var _legacy_icon=__webpack_require__(7240);var _outlink_encoders=__webpack_require__(7242);var _style_choices=__webpack_require__(7171);var _url_template=__webpack_require__(7243);var _helpers=__webpack_require__(7419);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function isUpdateForm(props){return"initialTemplate"in props}function UrlTemplateForm(props){var _onSubmit=props.onSubmit;var getInitialTemplate=function getInitialTemplate(){return isUpdateForm(props)?props.initialTemplate:{encoder:_outlink_encoders.outlinkEncoders[0],icon:null,description:"",url:""}};var _useState=(0,_react.useState)(getInitialTemplate),_useState2=_slicedToArray(_useState,2),currentTemplate=_useState2[0],setCurrentTemplate=_useState2[1];var persistedTemplateState=isUpdateForm(props)&&props.initialTemplate;(0,_react.useEffect)((function(){if(isUpdateForm(props)&&currentTemplate!==props.initialTemplate){setCurrentTemplate(props.initialTemplate)}}),[persistedTemplateState]);var _useState3=(0,_react.useState)({description:false,url:false}),_useState4=_slicedToArray(_useState3,2),touched=_useState4[0],setTouched=_useState4[1];var _useState5=(0,_react.useState)(!isUpdateForm(props)),_useState6=_slicedToArray(_useState5,2),open=_useState6[0],setOpen=_useState6[1];var _useState7=(0,_react.useState)(false),_useState8=_slicedToArray(_useState7,2),autoformatUrl=_useState8[0],setAutoformatUrl=_useState8[1];function setValue(key,value){setCurrentTemplate(_objectSpread({},currentTemplate,_defineProperty({},key,value)))}function reset(){setTouched({description:false,url:false});setCurrentTemplate(getInitialTemplate());setAutoformatUrl(false)}function convertUrl(){setCurrentTemplate(_objectSpread({},currentTemplate,{url:(0,_url_template.replaceKibanaUrlParam)(currentTemplate.url),encoder:currentTemplate.encoder.type==="kql"?currentTemplate.encoder:_outlink_encoders.outlinkEncoders.find((function(enc){return enc.type==="kql"}))}));setAutoformatUrl(false)}var urlPlaceholderMissing=Boolean(currentTemplate.url&&!(0,_url_template.isUrlTemplateValid)(currentTemplate.url));var formIncomplete=!Boolean(currentTemplate.description&&currentTemplate.url);var formUntouched=(0,_helpers.isEqual)(currentTemplate,getInitialTemplate());return _react.default.createElement(_eui.EuiAccordion,{id:props.id,initialIsOpen:!isUpdateForm(props),buttonContent:isUpdateForm(props)?props.initialTemplate.description:_i18n.i18n.translate("xpack.graph.templates.addLabel",{defaultMessage:"New drilldown"}),extraAction:isUpdateForm(props)&&props.initialTemplate.icon&&_react.default.createElement(_legacy_icon.LegacyIcon,{asListIcon:true,icon:props.initialTemplate.icon}),className:(0,_classnames.default)("gphUrlTemplateList__accordion",{"gphUrlTemplateList__accordion--isOpen":open}),buttonClassName:"gphUrlTemplateList__accordionbutton",onToggle:function onToggle(isOpen){setOpen(isOpen)},paddingSize:"m"},_react.default.createElement("form",{onSubmit:function onSubmit(e){e.preventDefault();_onSubmit(currentTemplate);if(!isUpdateForm(props)){reset()}}},_react.default.createElement(_eui.EuiFormRow,{fullWidth:true,label:_i18n.i18n.translate("xpack.graph.settings.drillDowns.urlDescriptionInputLabel",{defaultMessage:"Title"}),isInvalid:touched.description&&!currentTemplate.description,onBlur:function onBlur(){return setTouched(_objectSpread({},touched,{description:true}))}},_react.default.createElement(_eui.EuiFieldText,{fullWidth:true,value:currentTemplate.description,isInvalid:touched.description&&!currentTemplate.description,onChange:function onChange(e){return setValue("description",e.target.value)},placeholder:_i18n.i18n.translate("xpack.graph.settings.drillDowns.urlDescriptionInputPlaceholder",{defaultMessage:"Search on Google"})})),_react.default.createElement(_eui.EuiFormRow,{fullWidth:true,label:_i18n.i18n.translate("xpack.graph.settings.drillDowns.urlInputLabel",{defaultMessage:"URL"}),helpText:_react.default.createElement(_react.default.Fragment,null,autoformatUrl&&_react.default.createElement("p",null,_react.default.createElement("strong",null,_i18n.i18n.translate("xpack.graph.settings.drillDowns.kibanaUrlWarningText",{defaultMessage:"Possible Kibana URL pasted, "}),_react.default.createElement(_eui.EuiLink,{onClick:convertUrl},_react.default.createElement("strong",null,_i18n.i18n.translate("xpack.graph.settings.drillDowns.kibanaUrlWarningConvertOptionLinkText",{defaultMessage:"convert it."}))))),_i18n.i18n.translate("xpack.graph.settings.drillDowns.urlInputHelpText",{defaultMessage:"Define template URLs using {gquery} where the selected vertex terms are inserted.",values:{gquery:"{{gquery}}"}})),onBlur:function onBlur(){return setTouched(_objectSpread({},touched,{url:true}))},isInvalid:urlPlaceholderMissing||touched.url&&!currentTemplate.url,error:urlPlaceholderMissing?[_i18n.i18n.translate("xpack.graph.settings.drillDowns.invalidUrlWarningText",{defaultMessage:"The URL must contain a {placeholder} string.",values:{placeholder:"{{gquery}}"}})]:[]},_react.default.createElement(_eui.EuiFieldText,{fullWidth:true,placeholder:"https://www.google.co.uk/#q={{gquery}}",value:currentTemplate.url,onChange:function onChange(e){setValue("url",e.target.value);setAutoformatUrl(false)},onPaste:function onPaste(e){e.preventDefault();var pastedUrl=e.clipboardData.getData("text/plain");if((0,_url_template.isKibanaUrl)(pastedUrl)){setAutoformatUrl(true)}setValue("url",pastedUrl)},isInvalid:urlPlaceholderMissing||touched.url&&!currentTemplate.url})),_react.default.createElement(_eui.EuiFormRow,{fullWidth:true,helpText:currentTemplate.encoder.description,label:_i18n.i18n.translate("xpack.graph.settings.drillDowns.urlEncoderInputLabel",{defaultMessage:"URL parameter type"})},_react.default.createElement(_eui.EuiComboBox,{fullWidth:true,singleSelection:{asPlainText:true},isClearable:false,options:_outlink_encoders.outlinkEncoders.map((function(encoder){return{label:encoder.title,value:encoder}})),selectedOptions:[{label:currentTemplate.encoder.title,value:currentTemplate.encoder}],onChange:function onChange(choices){setValue("encoder",choices[0].value)}})),_react.default.createElement(_eui.EuiFormRow,{fullWidth:true,label:_i18n.i18n.translate("xpack.graph.settings.drillDowns.toolbarIconPickerLabel",{defaultMessage:"Toolbar icon"})},_react.default.createElement("div",{role:"listbox"},_style_choices.urlTemplateIconChoices.map((function(icon){return _react.default.createElement(_legacy_icon.LegacyIcon,{key:icon.class,selected:icon===currentTemplate.icon,icon:icon,onClick:function onClick(){if(currentTemplate.icon===icon){setValue("icon",null)}else{setValue("icon",icon)}}})})))),_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"flexEnd",responsive:false},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButtonEmpty,{color:"danger",onClick:function onClick(){props.onRemove()},"data-test-subj":"graphRemoveUrlTemplate"},isUpdateForm(props)?_i18n.i18n.translate("xpack.graph.settings.drillDowns.removeButtonLabel",{defaultMessage:"Remove"}):_i18n.i18n.translate("xpack.graph.settings.drillDowns.cancelButtonLabel",{defaultMessage:"Cancel"}))),_react.default.createElement(_eui.EuiFlexItem,null),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButtonEmpty,{onClick:reset,disabled:formUntouched},_i18n.i18n.translate("xpack.graph.settings.drillDowns.resetButtonLabel",{defaultMessage:"Reset"}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButton,{type:"submit",fill:true,isDisabled:urlPlaceholderMissing||formIncomplete},isUpdateForm(props)?_i18n.i18n.translate("xpack.graph.settings.drillDowns.updateSaveButtonLabel",{defaultMessage:"Update drilldown"}):_i18n.i18n.translate("xpack.graph.settings.drillDowns.newSaveButtonLabel",{defaultMessage:"Save drilldown"}))))))}},7928:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _graph_visualization=__webpack_require__(7929);Object.keys(_graph_visualization).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _graph_visualization[key]}})}))},7929:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.GraphVisualization=GraphVisualization;var _react=_interopRequireWildcard(__webpack_require__(0));var _classnames=_interopRequireDefault(__webpack_require__(63));var _d=_interopRequireDefault(__webpack_require__(48));var _eui=__webpack_require__(1);var _persistence=__webpack_require__(7244);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function registerZooming(element){var blockScroll=function blockScroll(){_d.default.event.preventDefault()};_d.default.select(element).on("mousewheel",blockScroll).on("DOMMouseScroll",blockScroll).call(_d.default.behavior.zoom().on("zoom",(function(){var event=_d.default.event;_d.default.select(element).select("g").attr("transform","translate("+event.translate+")"+"scale("+event.scale+")").attr("style","stroke-width: "+1/event.scale)})))}function GraphVisualization(_ref){var nodes=_ref.nodes,edges=_ref.edges,edgeClick=_ref.edgeClick,nodeClick=_ref.nodeClick;var svgRoot=(0,_react.useRef)(null);return _react.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"gphGraph",width:"100%",height:"100%",pointerEvents:"all",id:"graphSvg",ref:function ref(element){if(element&&svgRoot.current!==element){svgRoot.current=element;registerZooming(element)}}},_react.default.createElement("g",null,_react.default.createElement("g",null,edges&&edges.map((function(edge){return _react.default.createElement("line",{key:"".concat((0,_persistence.makeNodeId)(edge.source.data.field,edge.source.data.term),"-").concat((0,_persistence.makeNodeId)(edge.target.data.field,edge.target.data.term)),x1:edge.topSrc.kx,y1:edge.topSrc.ky,x2:edge.topTarget.kx,y2:edge.topTarget.ky,onClick:function onClick(){edgeClick(edge)},className:(0,_classnames.default)("gphEdge",{"gphEdge--selected":edge.isSelected}),style:{strokeWidth:edge.width},strokeLinecap:"round"})}))),nodes&&nodes.filter((function(node){return!node.parent})).map((function(node){return _react.default.createElement("g",{key:(0,_persistence.makeNodeId)(node.data.field,node.data.term),onClick:function onClick(e){nodeClick(node,e)},onMouseDown:function onMouseDown(e){if(e.ctrlKey||e.shiftKey){e.preventDefault()}},className:"gphNode"},_react.default.createElement("circle",{cx:node.kx,cy:node.ky,r:node.scaledSize,className:(0,_classnames.default)("gphNode__circle",{"gphNode__circle--selected":node.isSelected}),style:{fill:node.color}}),node.icon&&_react.default.createElement("text",{className:(0,_classnames.default)("fa gphNode__text",{"gphNode__text--inverse":_eui.isColorDark.apply(void 0,_toConsumableArray((0,_eui.hexToRgb)(node.color)))}),transform:"translate(0,5)",textAnchor:"middle",x:node.kx,y:node.ky},node.icon.code),node.label.length<30&&_react.default.createElement("text",{className:"gphNode__label",textAnchor:"middle",transform:"translate(0,22)",x:node.kx,y:node.ky},node.label),node.label.length>=30&&_react.default.createElement("foreignObject",{width:"100",height:"20",transform:"translate(-50,15)",x:node.kx,y:node.ky},_react.default.createElement("p",{className:"gphNode__label gphNode__label--html gphNoUserSelect"},node.label)),node.numChildren>0&&_react.default.createElement("g",null,_react.default.createElement("circle",{r:"5",className:"gphNode__markerCircle",transform:"translate(10,10)",cx:node.kx,cy:node.ky}),_react.default.createElement("text",{className:"gphNode__markerText",textAnchor:"middle",transform:"translate(10,12)",x:node.kx,y:node.ky},node.numChildren)))}))))}},7930:function(module,exports,__webpack_require__){"use strict";var d3=__webpack_require__(48);module.exports=function(){var graphExplorer=function graphExplorer(indexName,typeName,request,responseHandler){var dataForServer=JSON.stringify(request);$.ajax({type:"POST",url:"http://localhost:9200/"+indexName+"/_graph/explore",dataType:"json",contentType:"application/json;charset=utf-8",async:true,data:dataForServer,success:function success(data){responseHandler(data)}})};var searcher=function searcher(indexName,request,responseHandler){var dataForServer=JSON.stringify(request);$.ajax({type:"POST",url:"http://localhost:9200/"+indexName+"/_search?rest_total_hits_as_int=true",dataType:"json",contentType:"application/json;charset=utf-8",async:true,data:dataForServer,success:function success(data){responseHandler(data)}})};function AddNodeOperation(node,owner){var self=this;var vm=owner;self.node=node;self.undo=function(){vm.arrRemove(vm.nodes,self.node);vm.arrRemove(vm.selectedNodes,self.node);self.node.isSelected=false;delete vm.nodesMap[self.node.id]};self.redo=function(){vm.nodes.push(self.node);vm.nodesMap[self.node.id]=self.node}}function AddEdgeOperation(edge,owner){var self=this;var vm=owner;self.edge=edge;self.undo=function(){vm.arrRemove(vm.edges,self.edge);delete vm.edgesMap[self.edge.id]};self.redo=function(){vm.edges.push(self.edge);vm.edgesMap[self.edge.id]=self.edge}}function ReverseOperation(operation){var self=this;var reverseOperation=operation;self.undo=reverseOperation.redo;self.redo=reverseOperation.undo}function GroupOperation(receiver,orphan,vm){var self=this;self.receiver=receiver;self.orphan=orphan;self.undo=function(){self.orphan.parent=undefined};self.redo=function(){self.orphan.parent=self.receiver}}function UnGroupOperation(parent,child,vm){var self=this;self.parent=parent;self.child=child;self.undo=function(){self.child.parent=self.parent};self.redo=function(){self.child.parent=undefined}}function createWorkspace(options){return new GraphWorkspace(options)}function GraphWorkspace(options){var self=this;this.blacklistedNodes=[];this.options=options;this.undoLog=[];this.redoLog=[];this.selectedNodes=[];if(!options){this.options={}}this.nodesMap={};this.edgesMap={};this.searchTerm="";this.seqNumber=0;this.nodes=[];this.edges=[];this.lastRequest=null;this.lastResponse=null;this.changeHandler=options.changeHandler;if(options.graphExploreProxy){graphExplorer=options.graphExploreProxy}if(options.searchProxy){searcher=options.searchProxy}this.addUndoLogEntry=function(undoOperations){self.undoLog.push(undoOperations);if(self.undoLog.length>50){self.undoLog.splice(0,1)}self.redoLog=[]};this.undo=function(){var lastOps=this.undoLog.pop();if(lastOps){this.stopLayout();this.redoLog.push(lastOps);for(var i in lastOps){lastOps[i].undo()}this.runLayout()}};this.redo=function(){var lastOps=this.redoLog.pop();if(lastOps){this.stopLayout();this.undoLog.push(lastOps);for(var i in lastOps){lastOps[i].redo()}this.runLayout()}};this.areLinked=function(a,b){if(a==b)return true;var allEdges=this.edges;for(var e in allEdges){if(e.source==a){if(e.target==b){return true}}if(e.source==b){if(e.target==a){return true}}}return false};this.selectAll=function(){self.selectedNodes=[];for(var n in self.nodes){var node=self.nodes[n];if(node.parent==undefined){node.isSelected=true;self.selectedNodes.push(node)}else{node.isSelected=false}}};this.selectNone=function(){self.selectedNodes=[];for(var n in self.nodes){var node=self.nodes[n];node.isSelected=false}};this.selectInvert=function(){self.selectedNodes=[];for(var n in self.nodes){var node=self.nodes[n];if(node.parent!=undefined){continue}node.isSelected=!node.isSelected;if(node.isSelected){self.selectedNodes.push(node)}}};this.selectNodes=function(nodes){for(var n in nodes){var node=nodes[n];node.isSelected=true;if(self.selectedNodes.indexOf(node)<0){self.selectedNodes.push(node)}}};this.selectNode=function(node){node.isSelected=true;if(self.selectedNodes.indexOf(node)<0){self.selectedNodes.push(node)}};this.deleteSelection=function(){var allAndGrouped=self.returnUnpackedGroupeds(self.selectedNodes);if(allAndGrouped.length==0){allAndGrouped=self.nodes.slice(0)}var undoOperations=[];for(var i in allAndGrouped){var node=allAndGrouped[i];node.isSelected=false;delete self.nodesMap[node.id];undoOperations.push(new ReverseOperation(new AddNodeOperation(node,self)))}self.arrRemoveAll(self.nodes,allAndGrouped);self.arrRemoveAll(self.selectedNodes,allAndGrouped);var danglingEdges=self.edges.filter((function(edge){return self.nodes.indexOf(edge.source)<0||self.nodes.indexOf(edge.target)<0}));for(var _i in danglingEdges){var edge=danglingEdges[_i];delete self.edgesMap[edge.id];undoOperations.push(new ReverseOperation(new AddEdgeOperation(edge,self)))}self.addUndoLogEntry(undoOperations);self.arrRemoveAll(self.edges,danglingEdges);self.runLayout()};this.selectNeighbours=function(){var newSelections=[];for(var n in self.edges){var edge=self.edges[n];if(!edge.topSrc.isSelected){if(self.selectedNodes.indexOf(edge.topTarget)>=0){if(newSelections.indexOf(edge.topSrc)<0){newSelections.push(edge.topSrc)}}}if(!edge.topTarget.isSelected){if(self.selectedNodes.indexOf(edge.topSrc)>=0){if(newSelections.indexOf(edge.topTarget)<0){newSelections.push(edge.topTarget)}}}}for(var i in newSelections){var newlySelectedNode=newSelections[i];self.selectedNodes.push(newlySelectedNode);newlySelectedNode.isSelected=true}};this.selectNone=function(){for(var n in self.selectedNodes){self.selectedNodes[n].isSelected=false}self.selectedNodes=[]};this.deselectNode=function(node){node.isSelected=false;self.arrRemove(self.selectedNodes,node)};this.getAllSelectedNodes=function(){return this.returnUnpackedGroupeds(self.selectedNodes)};this.colorSelected=function(colorNum){var selections=self.getAllSelectedNodes();for(var i in selections){selections[i].color=colorNum}};this.getSelectionsThatAreGrouped=function(){var result=[];var selections=self.selectedNodes;for(var i in selections){var node=selections[i];if(node.numChildren>0){result.push(node)}}return result};this.ungroupSelection=function(){var selections=self.getSelectionsThatAreGrouped();for(var i in selections){var node=selections[i];self.ungroup(node)}};this.toggleNodeSelection=function(node){if(node.isSelected){self.deselectNode(node)}else{node.isSelected=true;self.selectedNodes.push(node)}return node.isSelected};this.returnUnpackedGroupeds=function(topLevelNodeArray){var result=topLevelNodeArray.slice();var edges=this.edges;for(var i=0;i<edges.length;i++){var edge=edges[i];var topLevelSource=edge.topSrc;var topLevelTarget=edge.topTarget;if(result.indexOf(topLevelTarget)>=0){var target=edge.target;while(target.parent!=undefined){if(result.indexOf(target)<0){result.push(target)}target=target.parent}}if(result.indexOf(topLevelSource)>=0){var source=edge.source;while(source.parent!=undefined){if(result.indexOf(source)<0){result.push(source)}source=source.parent}}}return result};this.clearGraph=function(){this.stopLayout();this.nodes=[];this.edges=[];this.undoLog=[];this.redoLog=[];this.nodesMap={};this.edgesMap={};this.blacklistedNodes=[];this.selectedNodes=[];this.lastResponse=null};this.arrRemoveAll=function remove(arr,items){for(var i=items.length;i--;){self.arrRemove(arr,items[i])}};this.arrRemove=function remove(arr,item){for(var i=arr.length;i--;){if(arr[i]===item){arr.splice(i,1)}}};this.getNeighbours=function(node){var neighbourNodes=[];for(var e in self.edges){var edge=self.edges[e];if(edge.topSrc==edge.topTarget){continue}if(edge.topSrc==node){if(neighbourNodes.indexOf(edge.topTarget)<0){neighbourNodes.push(edge.topTarget)}}if(edge.topTarget==node){if(neighbourNodes.indexOf(edge.topSrc)<0){neighbourNodes.push(edge.topSrc)}}}return neighbourNodes};this.buildNodeQuery=function(topLevelNode){var containedNodes=[topLevelNode];containedNodes=self.returnUnpackedGroupeds(containedNodes);if(containedNodes.length==1){var tq={};tq[topLevelNode.data.field]=topLevelNode.data.term;return{term:tq}}var termsByField={};for(var i in containedNodes){var node=containedNodes[i];var termsList=termsByField[node.data.field];if(!termsList){termsList=[];termsByField[node.data.field]=termsList}termsList.push(node.data.term)}if(Object.keys(termsByField).length==1){return{terms:termsByField}}var q={bool:{should:[]}};for(var field in termsByField){var _tq={};_tq[field]=termsByField[field];q.bool.should.push({terms:_tq})}return q};this.stopLayout=function(){if(this.force){this.force.stop()}this.force=null};this.runLayout=function(){this.stopLayout();var effectiveEdges=[];var edges=self.edges;for(var e in edges){var edge=edges[e];var topSrc=edge.source;var topTarget=edge.target;while(topSrc.parent!=undefined){topSrc=topSrc.parent}while(topTarget.parent!=undefined){topTarget=topTarget.parent}edge.topSrc=topSrc;edge.topTarget=topTarget;if(topSrc!=topTarget){effectiveEdges.push({source:topSrc,target:topTarget})}}var visibleNodes=self.nodes.filter((function(n){return n.parent==undefined}));var allNodes=self.nodes;for(var n in allNodes){var node=allNodes[n];node.numChildren=0}for(var _n in allNodes){var _node=allNodes[_n];while(_node.parent!=undefined){_node=_node.parent;_node.numChildren=_node.numChildren+1}}this.force=d3.layout.force().nodes(visibleNodes).links(effectiveEdges).friction(.8).linkDistance(100).charge(-1500).gravity(.15).theta(.99).alpha(.5).size([800,600]).on("tick",(function(e){var nodeArray=self.nodes;var hasRollups=false;for(var i in nodeArray){var _n2=nodeArray[i];if(_n2.parent==undefined){_n2.kx=_n2.x;_n2.ky=_n2.y}else{hasRollups=true}}if(hasRollups){for(var _i2 in nodeArray){var _n3=nodeArray[_i2];if(_n3.parent!=undefined){var topLevelNode=_n3.parent;while(topLevelNode.parent!=undefined){topLevelNode=topLevelNode.parent}_n3.kx=topLevelNode.x;_n3.ky=topLevelNode.y}}}if(self.changeHandler){self.changeHandler()}}));this.force.start()};this.groupSelections=function(node){var ops=[];self.nodes.forEach((function(otherNode){if(otherNode!=node&&otherNode.isSelected&&otherNode.parent==undefined){otherNode.parent=node;otherNode.isSelected=false;self.arrRemove(self.selectedNodes,otherNode);ops.push(new GroupOperation(node,otherNode,self))}}));self.selectNone();self.selectNode(node);self.addUndoLogEntry(ops);self.runLayout()};this.mergeNeighbours=function(node){var neighbours=self.getNeighbours(node);var ops=[];neighbours.forEach((function(otherNode){if(otherNode!=node&&otherNode.parent==undefined){otherNode.parent=node;otherNode.isSelected=false;self.arrRemove(self.selectedNodes,otherNode);ops.push(new GroupOperation(node,otherNode,self))}}));self.addUndoLogEntry(ops);self.runLayout()};this.mergeSelections=function(targetNode){if(!targetNode){console.log("Error - merge called on undefined target");return}var selClone=self.selectedNodes.slice();var ops=[];selClone.forEach((function(otherNode){if(otherNode!=targetNode&&otherNode.parent==undefined){otherNode.parent=targetNode;otherNode.isSelected=false;self.arrRemove(self.selectedNodes,otherNode);ops.push(new GroupOperation(targetNode,otherNode,self))}}));self.addUndoLogEntry(ops);self.runLayout()};this.ungroup=function(node){var ops=[];self.nodes.forEach((function(other){if(other.parent==node){other.parent=undefined;ops.push(new UnGroupOperation(node,other,self))}}));self.addUndoLogEntry(ops);self.runLayout()};this.unblacklist=function(node){self.arrRemove(self.blacklistedNodes,node)};this.blacklistSelection=function(){var selection=self.getAllSelectedNodes();var danglingEdges=[];self.edges.forEach((function(edge){if(selection.indexOf(edge.source)>=0||selection.indexOf(edge.target)>=0){delete self.edgesMap[edge.id];danglingEdges.push(edge)}}));for(var n in selection){var node=selection[n];delete self.nodesMap[node.id];self.blacklistedNodes.push(node);node.isSelected=false}self.arrRemoveAll(self.nodes,selection);self.arrRemoveAll(self.edges,danglingEdges);self.selectedNodes=[];self.runLayout()};this.simpleSearch=function(searchTerm,fieldsChoice,numHops){var qs={query_string:{query:searchTerm}};return this.search(qs,fieldsChoice,numHops)};this.search=function(query,fieldsChoice,numHops){if(!fieldsChoice){fieldsChoice=self.options.vertex_fields}var step={};var excludeNodesByField={};var nots=[];var avoidNodes=this.blacklistedNodes;for(var i=0;i<avoidNodes.length;i++){var n=avoidNodes[i];var arr=excludeNodesByField[n.data.field];if(!arr){arr=[];excludeNodesByField[n.data.field]=arr}arr.push(n.data.term);var tq={};tq[n.data.field]=n.data.term;nots.push({term:tq})}var rootStep=step;for(var hopNum=0;hopNum<numHops;hopNum++){var _arr=[];for(var f in fieldsChoice){var field=fieldsChoice[f].name;var hopSize=fieldsChoice[f].hopSize;var excludes=excludeNodesByField[field];var stepField={field:field,size:hopSize,min_doc_count:parseInt(self.options.exploreControls.minDocCount)};if(excludes){stepField.exclude=excludes}_arr.push(stepField)}step.vertices=_arr;if(hopNum<numHops-1){var nextStep={};step.connections=nextStep;step=nextStep}}if(nots.length>0){query={bool:{must:[query],must_not:nots}}}var request={query:query,controls:self.buildControls(),connections:rootStep.connections,vertices:rootStep.vertices};self.callElasticsearch(request)};this.buildControls=function(){var guiSettingsObj=self.options.exploreControls;var controls={use_significance:guiSettingsObj.useSignificance,sample_size:guiSettingsObj.sampleSize,timeout:parseInt(guiSettingsObj.timeoutMillis)};if(guiSettingsObj.sampleDiversityField!=null){controls.sample_diversity={field:guiSettingsObj.sampleDiversityField.name,max_docs_per_value:guiSettingsObj.maxValuesPerDoc}}return controls};this.makeNodeId=function(field,term){return field+".."+term};this.makeEdgeId=function(srcId,targetId){var id=srcId+"->"+targetId;if(srcId>targetId){id=targetId+"->"+srcId}return id};this.mergeGraph=function(newData){this.stopLayout();if(!newData.nodes){newData.nodes=[]}var lastOps=[];var dedupedNodes=[];for(var o in newData.nodes){var node=newData.nodes[o];node.id=self.makeNodeId(node.field,node.term);if(!this.nodesMap[node.id]){if(!node.label){node.label=node.term}dedupedNodes.push(node)}}if(dedupedNodes.length>0&&this.options.nodeLabeller){this.options.nodeLabeller(dedupedNodes)}for(var _o in dedupedNodes){var dedupedNode=dedupedNodes[_o];var label=dedupedNode.term;if(dedupedNode.label){label=dedupedNode.label}var _node2={x:1,y:1,numChildren:0,parent:undefined,isSelected:false,id:dedupedNode.id,label:label,color:dedupedNode.color,icon:dedupedNode.icon,data:dedupedNode};_node2.scaledSize=15;_node2.seqNumber=this.seqNumber++;this.nodes.push(_node2);lastOps.push(new AddNodeOperation(_node2,self));this.nodesMap[_node2.id]=_node2}for(var _o2 in newData.edges){var edge=newData.edges[_o2];var src=newData.nodes[edge.source];var target=newData.nodes[edge.target];edge.id=this.makeEdgeId(src.id,target.id);var srcWrapperObj=this.nodesMap[src.id];var targetWrapperObj=this.nodesMap[target.id];var existingEdge=this.edgesMap[edge.id];if(existingEdge){existingEdge.weight=Math.max(existingEdge.weight,edge.weight);existingEdge.doc_count=Math.max(existingEdge.doc_count,edge.doc_count);continue}var newEdge={source:srcWrapperObj,target:targetWrapperObj,weight:edge.weight,width:edge.width,id:edge.id,doc_count:edge.doc_count};if(edge.label){newEdge.label=edge.label}this.edgesMap[newEdge.id]=newEdge;this.edges.push(newEdge);lastOps.push(new AddEdgeOperation(newEdge,self))}if(lastOps.length>0){self.addUndoLogEntry(lastOps)}this.runLayout()};this.mergeIds=function(parentId,childId){var parent=self.getNode(parentId);var child=self.getNode(childId);if(child.isSelected){child.isSelected=false;self.arrRemove(self.selectedNodes,child)}child.parent=parent;self.addUndoLogEntry([new GroupOperation(parent,child,self)]);self.runLayout()};this.getNode=function(nodeId){return this.nodesMap[nodeId]};this.getEdge=function(edgeId){return this.edgesMap[edgeId]};this.expandSelecteds=function(){var targetOptions=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var startNodes=self.getAllSelectedNodes();if(startNodes.length==0){startNodes=self.nodes}var clone=startNodes.slice();self.expand(clone,targetOptions)};this.expandGraph=function(){self.expandSelecteds()};this.expandNode=function(node){self.expand(self.returnUnpackedGroupeds([node]),{})};this.expand=function(startNodes,targetOptions){var nodesByField={};var excludeNodesByField={};var avoidNodes=this.blacklistedNodes;for(var i=0;i<avoidNodes.length;i++){var n=avoidNodes[i];var arr=excludeNodesByField[n.data.field];if(!arr){arr=[];excludeNodesByField[n.data.field]=arr}if(arr.indexOf(n.data.term)<0){arr.push(n.data.term)}}var allExistingNodes=this.nodes;for(var _i3=0;_i3<allExistingNodes.length;_i3++){var _n4=allExistingNodes[_i3];var _arr2=excludeNodesByField[_n4.data.field];if(!_arr2){_arr2=[];excludeNodesByField[_n4.data.field]=_arr2}_arr2.push(_n4.data.term)}for(var _i4=0;_i4<startNodes.length;_i4++){var _n5=startNodes[_i4];var _arr3=nodesByField[_n5.data.field];if(!_arr3){_arr3=[];nodesByField[_n5.data.field]=_arr3}_arr3.push({term:_n5.data.term,boost:_n5.data.weight});_arr3=excludeNodesByField[_n5.data.field];if(!_arr3){_arr3=[];excludeNodesByField[_n5.data.field]=_arr3}if(_arr3.indexOf(_n5.data.term)<0){_arr3.push(_n5.data.term)}}var primaryVertices=[];var secondaryVertices=[];for(var fieldName in nodesByField){primaryVertices.push({field:fieldName,include:nodesByField[fieldName],min_doc_count:parseInt(self.options.exploreControls.minDocCount)})}var targetFields=this.options.vertex_fields;if(targetOptions.toFields){targetFields=targetOptions.toFields}for(var f in targetFields){var _fieldName=targetFields[f].name;var hopSize=targetFields[f].hopSize>0?targetFields[f].hopSize:targetFields[f].lastValidHopSize;var fieldHop={field:_fieldName,size:hopSize,min_doc_count:parseInt(self.options.exploreControls.minDocCount)};fieldHop.exclude=excludeNodesByField[_fieldName];secondaryVertices.push(fieldHop)}var request={controls:self.buildControls(),vertices:primaryVertices,connections:{vertices:secondaryVertices}};self.lastRequest=JSON.stringify(request,null,"\t");graphExplorer(self.options.indexName,request,(function(data){self.lastResponse=JSON.stringify(data,null,"\t");var nodes=[];var edges=[];for(var _n6 in data.vertices){var node=data.vertices[_n6];for(var _f in targetFields){var fieldDef=targetFields[_f];if(node.field==fieldDef.name){node.color=fieldDef.color;node.icon=fieldDef.icon;node.fieldDef=fieldDef;break}}}var minLineSize=2;var maxLineSize=10;var maxEdgeWeight=1e-8;for(var e in data.connections){var edge=data.connections[e];maxEdgeWeight=Math.max(maxEdgeWeight,edge.weight)}for(var _e in data.connections){var _edge=data.connections[_e];edges.push({source:_edge.source,target:_edge.target,doc_count:_edge.doc_count,weight:_edge.weight,width:Math.max(minLineSize,_edge.weight/maxEdgeWeight*maxLineSize)})}self.mergeGraph({nodes:data.vertices,edges:edges})}))};this.trimExcessNewEdges=function(newNodes,newEdges){var trimmedEdges=[];var maxNumEdgesToReturn=5;for(var o in newEdges){var edge=newEdges[o];var src=newNodes[edge.source];var target=newNodes[edge.target];var srcId=src.field+".."+src.term;var targetId=target.field+".."+target.term;var id=this.makeEdgeId(srcId,targetId);var existingSrcNode=self.nodesMap[srcId];var existingTargetNode=self.nodesMap[targetId];if(existingSrcNode!=null&&existingTargetNode!=null){if(existingSrcNode.parent!=undefined&&existingTargetNode.parent!=undefined){continue}}else{console.log("Error? Missing nodes "+srcId+" or "+targetId,self.nodesMap);continue}var existingEdge=self.edgesMap[id];if(existingEdge){existingEdge.weight=Math.max(existingEdge.weight,edge.weight);existingEdge.doc_count=Math.max(existingEdge.doc_count,edge.doc_count);continue}else{trimmedEdges.push(edge)}}if(trimmedEdges.length>maxNumEdgesToReturn){trimmedEdges.sort((function(a,b){return b.weight-a.weight}));trimmedEdges=trimmedEdges.splice(0,maxNumEdgesToReturn)}return trimmedEdges};this.getQuery=function(startNodes,loose){var shoulds=[];var nodes=startNodes;if(!startNodes){nodes=self.nodes}for(var bs in nodes){var node=nodes[bs];if(node.parent==undefined){shoulds.push(self.buildNodeQuery(node))}}return{bool:{should:shoulds,minimum_should_match:Math.min(shoulds.length,loose?1:2)}}};this.getSelectedOrAllNodes=function(){var startNodes=self.getAllSelectedNodes();if(startNodes.length===0){startNodes=self.nodes}return startNodes};this.getSelectedOrAllTopNodes=function(){return self.getSelectedOrAllNodes().filter((function(node){return node.parent===undefined}))};function addTermToFieldList(map,field,term){var arr=map[field];if(!arr){arr=[];map[field]=arr}arr.push(term)}this.fillInGraph=function(){var maxNewEdges=arguments.length>0&&arguments[0]!==undefined?arguments[0]:10;var nodesForLinking=self.getSelectedOrAllTopNodes();var maxNumVerticesSearchable=100;if(nodesForLinking.length>maxNumVerticesSearchable){for(var i=0;i<maxNumVerticesSearchable;i++){var oldNode=nodesForLinking[i];var randomIndex=Math.floor(Math.random()*(nodesForLinking.length-i))+i;nodesForLinking[i]=nodesForLinking[randomIndex];nodesForLinking[randomIndex]=oldNode}nodesForLinking=nodesForLinking.slice(0,maxNumVerticesSearchable-1)}var shoulds=[];var filterMap={};nodesForLinking.forEach((function(node,nodeNum){var nodeQuery=self.buildNodeQuery(node);shoulds.push(nodeQuery);filterMap[nodeNum]=nodeQuery}));var searchReq={size:0,query:{bool:{minimum_should_match:2,should:shoulds}},aggs:{matrix:{adjacency_matrix:{separator:"|",filters:filterMap}}}};searcher(self.options.indexName,searchReq,(function(data){var numDocsMatched=data.hits.total;var buckets=data.aggregations.matrix.buckets;var vertices=nodesForLinking.map((function(existingNode){return{field:existingNode.data.field,term:existingNode.data.term,weight:1,depth:0}}));var connections=[];var maxEdgeWeight=0;var keyedBuckets={};buckets.forEach((function(bucket){keyedBuckets[bucket.key]=bucket}));buckets.forEach((function(bucket){var ids=bucket.key.split("|");if(ids.length===2){if(self.options.exploreControls.useSignificance){var t1=keyedBuckets[ids[0]].doc_count;var t2=keyedBuckets[ids[1]].doc_count;var t1AndT2=bucket.doc_count;bucket.weight=self.JLHScore(t1AndT2,Math.max(t1,t2),Math.min(t1,t2),numDocsMatched)}else{bucket.weight=bucket.doc_count}maxEdgeWeight=Math.max(maxEdgeWeight,bucket.weight)}}));var backFilledMinLineSize=2;var backFilledMaxLineSize=5;buckets.forEach((function(bucket){if(bucket.doc_count<parseInt(self.options.exploreControls.minDocCount)){return}var ids=bucket.key.split("|");if(ids.length==2){var srcNode=nodesForLinking[ids[0]];var targetNode=nodesForLinking[ids[1]];var edgeId=self.makeEdgeId(srcNode.id,targetNode.id);var existingEdge=self.edgesMap[edgeId];if(existingEdge){existingEdge.doc_count=Math.max(existingEdge.doc_count,bucket.doc_count)}else{connections.push({source:parseInt(ids[0]),target:parseInt(ids[1]),weight:bucket.weight,width:Math.max(backFilledMinLineSize,bucket.weight/maxEdgeWeight*backFilledMaxLineSize),doc_count:bucket.doc_count})}}}));if(connections.length>maxNewEdges){connections=connections.sort((function(a,b){return b.weight-a.weight}));connections=connections.slice(0,maxNewEdges)}self.mergeGraph({nodes:vertices,edges:connections})}))};this.getLikeThisButNotThisQuery=function(startNodes){var likeQueries=[];var txtsByFieldType={};startNodes.forEach((function(node){var txt=txtsByFieldType[node.data.field];if(txt){txt=txt+" "+node.label}else{txt=node.label}txtsByFieldType[node.data.field]=txt}));for(var field in txtsByFieldType){likeQueries.push({more_like_this:{like:txtsByFieldType[field],min_term_freq:1,minimum_should_match:"20%",min_doc_freq:1,boost_terms:2,max_query_terms:25}})}var excludeNodesByField={};var allExistingNodes=self.nodes;allExistingNodes.forEach((function(existingNode){addTermToFieldList(excludeNodesByField,existingNode.data.field,existingNode.data.term)}));var blacklistedNodes=self.blacklistedNodes;blacklistedNodes.forEach((function(blacklistedNode){addTermToFieldList(excludeNodesByField,blacklistedNode.data.field,blacklistedNode.data.term)}));var notExistingNodes=[];Object.keys(excludeNodesByField).forEach((function(fieldName){var termsQuery={};termsQuery[fieldName]=excludeNodesByField[fieldName];notExistingNodes.push({terms:termsQuery})}));var result={boosting:{negative_boost:1e-4,negative:{bool:{should:notExistingNodes}},positive:{bool:{should:likeQueries}}}};return result};this.getSelectedIntersections=function(callback){if(self.selectedNodes.length==0){return self.getAllIntersections(callback,self.nodes)}if(self.selectedNodes.length==1){var selectedNode=self.selectedNodes[0];var neighbourNodes=self.getNeighbours(selectedNode);neighbourNodes.push(selectedNode);return self.getAllIntersections(callback,neighbourNodes)}return self.getAllIntersections(callback,self.getAllSelectedNodes())};this.JLHScore=function(subsetFreq,subsetSize,supersetFreq,supersetSize){var subsetProbability=subsetFreq/subsetSize;var supersetProbability=supersetFreq/supersetSize;var absoluteProbabilityChange=subsetProbability-supersetProbability;if(absoluteProbabilityChange<=0){return 0}var relativeProbabilityChange=subsetProbability/supersetProbability;return absoluteProbabilityChange*relativeProbabilityChange};this.getAllIntersections=function(callback,nodes){nodes=nodes.filter((function(n){return n.parent==undefined}));var allQueries=nodes.map((function(node){return self.buildNodeQuery(node)}));var allQuery={bool:{should:allQueries}};var request={query:allQuery,size:0,aggs:{all:{global:{}},sources:{filters:{filters:{}},aggs:{targets:{filters:{filters:{}}}}}}};for(var n in allQueries){request.aggs.sources.filters.filters["bg"+n]=allQueries[n];request.aggs.sources.aggs.targets.filters.filters["fg"+n]=allQueries[n]}var dataForServer=JSON.stringify(request);searcher(self.options.indexName,request,(function(data){var termIntersects=[];var fullDocCounts=[];var allDocCount=data.aggregations.all.doc_count;for(var _n7 in nodes){fullDocCounts.push(data.aggregations.sources.buckets["bg"+_n7].doc_count)}for(var _n8 in nodes){var rootNode=nodes[_n8];var t1=fullDocCounts[_n8];var baseAgg=data.aggregations.sources.buckets["bg"+_n8].targets.buckets;for(var l in nodes){var t2=fullDocCounts[l];var leafNode=nodes[l];if(l==_n8){continue}if(t1>t2){continue}if(t1==t2){if(rootNode.id>leafNode.id){continue}}var t1AndT2=baseAgg["fg"+l].doc_count;if(t1AndT2==0){continue}var neighbourNode=nodes[l];var t1Label=rootNode.data.label;if(rootNode.numChildren>0){t1Label+="(+"+rootNode.numChildren+")"}var t2Label=neighbourNode.data.label;if(neighbourNode.numChildren>0){t2Label+="(+"+neighbourNode.numChildren+")"}var mergeConfidence=self.JLHScore(t1AndT2,t2,t1,allDocCount);var termIntersect={id1:rootNode.id,id2:neighbourNode.id,term1:t1Label,term2:t2Label,v1:t1,v2:t2,mergeLeftConfidence:t1AndT2/t1,mergeRightConfidence:t1AndT2/t2,mergeConfidence:mergeConfidence,overlap:t1AndT2};termIntersects.push(termIntersect)}}termIntersects.sort((function(a,b){if(b.mergeConfidence!=a.mergeConfidence){return b.mergeConfidence-a.mergeConfidence}if(b.overlap!=a.overlap){return b.overlap-a.overlap}return a.v2-b.v2}));if(callback){callback(termIntersects)}}))};this.callElasticsearch=function(request){self.lastRequest=JSON.stringify(request,null,"\t");graphExplorer(self.options.indexName,request,(function(data){self.lastResponse=JSON.stringify(data,null,"\t");var nodes=[];var edges=[];for(var n in data.vertices){var node=data.vertices[n];for(var f in self.options.vertex_fields){var fieldDef=self.options.vertex_fields[f];if(node.field==fieldDef.name){node.color=fieldDef.color;node.icon=fieldDef.icon;node.fieldDef=fieldDef;break}}}var minLineSize=2;var maxLineSize=10;var maxEdgeWeight=1e-8;for(var e in data.connections){var edge=data.connections[e];maxEdgeWeight=Math.max(maxEdgeWeight,edge.weight)}for(var _e2 in data.connections){var _edge2=data.connections[_e2];edges.push({source:_edge2.source,target:_edge2.target,doc_count:_edge2.doc_count,weight:_edge2.weight,width:Math.max(minLineSize,_edge2.weight/maxEdgeWeight*maxLineSize)})}self.mergeGraph({nodes:data.vertices,edges:edges},{labeller:self.options.labeller})}))}}return{createWorkspace:createWorkspace}}()},7931:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.createCachedIndexPatternProvider=createCachedIndexPatternProvider;function createCachedIndexPatternProvider(indexPatternGetter){var cache=new Map;return{get:function get(id){return regeneratorRuntime.async((function get$(_context){while(1){switch(_context.prev=_context.next){case 0:if(cache.has(id)){_context.next=7;break}_context.t0=cache;_context.t1=id;_context.next=5;return regeneratorRuntime.awrap(indexPatternGetter(id));case 5:_context.t2=_context.sent;_context.t0.set.call(_context.t0,_context.t1,_context.t2);case 7:return _context.abrupt("return",Promise.resolve(cache.get(id)));case 8:case"end":return _context.stop()}}}))}}}},7932:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.asAngularSyncedObservable=asAngularSyncedObservable;var Rx=_interopRequireWildcard(__webpack_require__(37));function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function asAngularSyncedObservable(collectProps,angularDigest){var boundCollectProps=function boundCollectProps(){var collectedProps=collectProps();Object.keys(collectedProps).forEach((function(key){var currentValue=collectedProps[key];if(typeof currentValue==="function"){collectedProps[key]=function(){currentValue.apply(void 0,arguments);angularDigest();subject$.next(boundCollectProps())}}}));return collectedProps};var subject$=new Rx.BehaviorSubject(boundCollectProps());return subject$.asObservable()}},7933:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.formatHttpError=formatHttpError;var _i18n=__webpack_require__(2);function formatHttpError(error){if(!error.response){return _i18n.i18n.translate("xpack.graph.fatalError.unavailableServerErrorMessage",{defaultMessage:"An HTTP request has failed to connect. "+"Please check if the Kibana server is running and that your browser has a working connection, "+"or contact your system administrator."})}return _i18n.i18n.translate("xpack.graph.fatalError.errorStatusMessage",{defaultMessage:"Error {errStatus} {errStatusText}: {errMessage}",values:{errStatus:error.body.status,errStatusText:error.body.statusText,errMessage:error.body.message}})}},7934:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.createSavedWorkspacesLoader=createSavedWorkspacesLoader;var _i18n=__webpack_require__(2);var _saved_workspace=__webpack_require__(7935);function createSavedWorkspacesLoader(services){var savedObjectsClient=services.savedObjectsClient,basePath=services.basePath;var SavedWorkspace=(0,_saved_workspace.createSavedWorkspaceClass)(services);var urlFor=function urlFor(id){return basePath.prepend("/app/graph#/workspace/".concat(encodeURIComponent(id)))};var mapHits=function mapHits(hit){var source=hit.attributes;source.id=hit.id;source.url=urlFor(hit.id);source.icon="fa-share-alt";return source};return{type:SavedWorkspace.type,Class:SavedWorkspace,loaderProperties:{name:"Graph workspace",noun:_i18n.i18n.translate("xpack.graph.savedWorkspaces.graphWorkspaceLabel",{defaultMessage:"Graph workspace"}),nouns:_i18n.i18n.translate("xpack.graph.savedWorkspaces.graphWorkspacesLabel",{defaultMessage:"Graph workspaces"})},get:function get(id){return new SavedWorkspace(id).init()},urlFor:urlFor,delete:function _delete(ids){var idArr=Array.isArray(ids)?ids:[ids];return Promise.all(idArr.map((function(id){return savedObjectsClient.delete(SavedWorkspace.type,id)})))},find:function find(searchString){var size=arguments.length>1&&arguments[1]!==undefined?arguments[1]:100;return savedObjectsClient.find({type:SavedWorkspace.type,search:searchString?"".concat(searchString,"*"):undefined,perPage:size,searchFields:["title^3","description"]}).then((function(resp){return{total:resp.total,hits:resp.savedObjects.map((function(hit){return mapHits(hit)}))}}))}}}},7935:function(module,exports,__webpack_require__){"use strict";function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}Object.defineProperty(exports,"__esModule",{value:true});exports.createSavedWorkspaceClass=createSavedWorkspaceClass;var _i18n=__webpack_require__(2);var _saved_workspace_references=__webpack_require__(7936);var _legacy_imports=__webpack_require__(7239);function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function createSavedWorkspaceClass(services){var SavedObjectClass=(0,_legacy_imports.createSavedObjectClass)(services);var SavedWorkspaceClass=function(_SavedObjectClass){_inherits(SavedWorkspaceClass,_SavedObjectClass);function SavedWorkspaceClass(id){var _this;_classCallCheck(this,SavedWorkspaceClass);_this=_possibleConstructorReturn(this,_getPrototypeOf(SavedWorkspaceClass).call(this,{type:SavedWorkspaceClass.type,mapping:SavedWorkspaceClass.mapping,searchSource:SavedWorkspaceClass.searchSource,extractReferences:_saved_workspace_references.extractReferences,injectReferences:_saved_workspace_references.injectReferences,id:id,defaults:{title:_i18n.i18n.translate("xpack.graph.savedWorkspace.workspaceNameTitle",{defaultMessage:"New Graph Workspace"}),numLinks:0,numVertices:0,wsState:"{}",version:1}}));_defineProperty(_assertThisInitialized(_this),"wsState",void 0);_defineProperty(_assertThisInitialized(_this),"getDisplayName",(function(){return"graph workspace"}));return _this}return SavedWorkspaceClass}(SavedObjectClass);_defineProperty(SavedWorkspaceClass,"type","graph-workspace");_defineProperty(SavedWorkspaceClass,"mapping",{title:"text",description:"text",numLinks:"integer",numVertices:"integer",version:"integer",wsState:"json"});_defineProperty(SavedWorkspaceClass,"fieldOrder",["title","description"]);_defineProperty(SavedWorkspaceClass,"searchSource",false);return SavedWorkspaceClass}},7936:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.extractReferences=extractReferences;exports.injectReferences=injectReferences;function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function extractReferences(_ref){var attributes=_ref.attributes,_ref$references=_ref.references,references=_ref$references===void 0?[]:_ref$references;var state=JSON.parse(JSON.parse(String(attributes.wsState)));var indexPattern=state.indexPattern;if(!indexPattern){throw new Error('indexPattern attribute is missing in "wsState"')}state.indexPatternRefName="indexPattern_0";delete state.indexPattern;return{references:[].concat(_toConsumableArray(references),[{name:"indexPattern_0",type:"index-pattern",id:indexPattern}]),attributes:_objectSpread({},attributes,{wsState:JSON.stringify(JSON.stringify(state))})}}function injectReferences(savedObject,references){if(typeof savedObject.wsState!=="string"){return}var state=JSON.parse(savedObject.wsState);if(!state.indexPatternRefName){return}var indexPatternReference=references.find((function(reference){return reference.name===state.indexPatternRefName}));if(!indexPatternReference){throw new Error('Could not find reference "'.concat(state.indexPatternRefName,'"'))}state.indexPattern=indexPatternReference.id;delete state.indexPatternRefName;savedObject.wsState=JSON.stringify(state)}},9249:function(module,exports,__webpack_require__){module.exports=__webpack_require__(36)(2656)},93:function(module,exports,__webpack_require__){module.exports=__webpack_require__(34)(915)}}]);